<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 Non-linear Least Squares Estimation | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 Non-linear Least Squares Estimation | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Non-linear Least Squares Estimation | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2025-04-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="inference.html"/>
<link rel="next" href="practical-considerations-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="more-books.html"><a href="more-books.html"><i class="fa fa-check"></i>More books</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
<li class="chapter" data-level="2.1.6" data-path="matrix-theory.html"><a href="matrix-theory.html#cholesky-decomposition"><i class="fa fa-check"></i><b>2.1.6</b> Cholesky Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#skewness"><i class="fa fa-check"></i><b>2.2.6</b> Skewness</a></li>
<li class="chapter" data-level="2.2.7" data-path="probability-theory.html"><a href="probability-theory.html#kurtosis"><i class="fa fa-check"></i><b>2.2.7</b> Kurtosis</a></li>
<li class="chapter" data-level="2.2.8" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.8</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.5</b> Convergence</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.6</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.7</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.1</b> Medium size</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.2</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
<li class="chapter" data-level="3.4.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#general-approach-to-bivariate-statistics"><i class="fa fa-check"></i><b>3.4.4</b> General Approach to Bivariate Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Testing Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i><b>4.1.1</b> Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> Errors in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-role-of-distributions-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> The Role of Distributions in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-test-statistic"><i class="fa fa-check"></i><b>4.1.4</b> The Test Statistic</a></li>
<li class="chapter" data-level="4.1.5" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#critical-values-and-rejection-regions-1"><i class="fa fa-check"></i><b>4.1.5</b> Critical Values and Rejection Regions</a></li>
<li class="chapter" data-level="4.1.6" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#visualizing-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.6</b> Visualizing Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html"><i class="fa fa-check"></i><b>4.2</b> Key Concepts and Definitions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#random-sample"><i class="fa fa-check"></i><b>4.2.1</b> Random Sample</a></li>
<li class="chapter" data-level="4.2.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#sample-statistics"><i class="fa fa-check"></i><b>4.2.2</b> Sample Statistics</a></li>
<li class="chapter" data-level="4.2.3" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#distribution-of-the-sample-mean"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-mean"><i class="fa fa-check"></i><b>4.3.1</b> For Single Mean</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-independent-samples"><i class="fa fa-check"></i><b>4.3.2</b> For Difference of Means, Independent Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-paired-samples"><i class="fa fa-check"></i><b>4.3.3</b> For Difference of Means, Paired Samples</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-two-proportions"><i class="fa fa-check"></i><b>4.3.4</b> For Difference of Two Proportions</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-proportion"><i class="fa fa-check"></i><b>4.3.5</b> For Single Proportion</a></li>
<li class="chapter" data-level="4.3.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-variance"><i class="fa fa-check"></i><b>4.3.6</b> For Single Variance</a></li>
<li class="chapter" data-level="4.3.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.3.7</b> Non-parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.4</b> Two-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-means"><i class="fa fa-check"></i><b>4.4.1</b> For Means</a></li>
<li class="chapter" data-level="4.4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-variances"><i class="fa fa-check"></i><b>4.4.2</b> For Variances</a></li>
<li class="chapter" data-level="4.4.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power"><i class="fa fa-check"></i><b>4.4.3</b> Power</a></li>
<li class="chapter" data-level="4.4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.4.4</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.4.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.4.5</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.5</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#association-tests"><i class="fa fa-check"></i><b>4.5.1</b> Association Tests</a></li>
<li class="chapter" data-level="4.5.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.5.2</b> Ordinal Association</a></li>
<li class="chapter" data-level="4.5.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-trend"><i class="fa fa-check"></i><b>4.5.3</b> Ordinal Trend</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.6</b> Divergence Metrics and Tests for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kolmogorov-smirnov-test-1"><i class="fa fa-check"></i><b>4.6.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#anderson-darling-test-1"><i class="fa fa-check"></i><b>4.6.2</b> Anderson-Darling Test</a></li>
<li class="chapter" data-level="4.6.3" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.6.3</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.6.4" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#cramér-von-mises-test"><i class="fa fa-check"></i><b>4.6.4</b> Cramér-von Mises Test</a></li>
<li class="chapter" data-level="4.6.5" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.6.5</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.6.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.6.6</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.6.7" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#hellinger-distance"><i class="fa fa-check"></i><b>4.6.7</b> Hellinger Distance</a></li>
<li class="chapter" data-level="4.6.8" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#bhattacharyya-distance"><i class="fa fa-check"></i><b>4.6.8</b> Bhattacharyya Distance</a></li>
<li class="chapter" data-level="4.6.9" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#wasserstein-distance"><i class="fa fa-check"></i><b>4.6.9</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.6.10" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#energy-distance"><i class="fa fa-check"></i><b>4.6.10</b> Energy Distance</a></li>
<li class="chapter" data-level="4.6.11" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#total-variation-distance"><i class="fa fa-check"></i><b>4.6.11</b> Total Variation Distance</a></li>
<li class="chapter" data-level="4.6.12" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#summary"><i class="fa fa-check"></i><b>4.6.12</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic) Model</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#infeasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.1</b> Infeasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#feasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.2</b> Feasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.3" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#weighted-least-squares"><i class="fa fa-check"></i><b>5.2.3</b> Weighted Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html"><i class="fa fa-check"></i><b>5.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.3.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#key-quantities-for-inference"><i class="fa fa-check"></i><b>5.3.2</b> Key Quantities for Inference</a></li>
<li class="chapter" data-level="5.3.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#assumptions-of-mle"><i class="fa fa-check"></i><b>5.3.3</b> Assumptions of MLE</a></li>
<li class="chapter" data-level="5.3.4" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#properties-of-mle"><i class="fa fa-check"></i><b>5.3.4</b> Properties of MLE</a></li>
<li class="chapter" data-level="5.3.5" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#practical-considerations"><i class="fa fa-check"></i><b>5.3.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="5.3.6" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#comparison-of-mle-and-ols"><i class="fa fa-check"></i><b>5.3.6</b> Comparison of MLE and OLS</a></li>
<li class="chapter" data-level="5.3.7" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#applications-of-mle"><i class="fa fa-check"></i><b>5.3.7</b> Applications of MLE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html"><i class="fa fa-check"></i><b>5.4</b> Penalized (Regularized) Estimators</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#motivation-for-penalized-estimators"><i class="fa fa-check"></i><b>5.4.1</b> Motivation for Penalized Estimators</a></li>
<li class="chapter" data-level="5.4.2" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#ridge-regression"><i class="fa fa-check"></i><b>5.4.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.4.3" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#lasso-regression"><i class="fa fa-check"></i><b>5.4.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="5.4.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#elastic-net"><i class="fa fa-check"></i><b>5.4.4</b> Elastic Net</a></li>
<li class="chapter" data-level="5.4.5" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#tuning-parameter-selection"><i class="fa fa-check"></i><b>5.4.5</b> Tuning Parameter Selection</a></li>
<li class="chapter" data-level="5.4.6" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#properties-of-penalized-estimators"><i class="fa fa-check"></i><b>5.4.6</b> Properties of Penalized Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="robust-estimators.html"><a href="robust-estimators.html"><i class="fa fa-check"></i><b>5.5</b> Robust Estimators</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="robust-estimators.html"><a href="robust-estimators.html#motivation-for-robust-estimation"><i class="fa fa-check"></i><b>5.5.1</b> Motivation for Robust Estimation</a></li>
<li class="chapter" data-level="5.5.2" data-path="robust-estimators.html"><a href="robust-estimators.html#m-estimators"><i class="fa fa-check"></i><b>5.5.2</b> <span class="math inline">\(M\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.3" data-path="robust-estimators.html"><a href="robust-estimators.html#r-estimators"><i class="fa fa-check"></i><b>5.5.3</b> <span class="math inline">\(R\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.4" data-path="robust-estimators.html"><a href="robust-estimators.html#l-estimators"><i class="fa fa-check"></i><b>5.5.4</b> <span class="math inline">\(L\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.5" data-path="robust-estimators.html"><a href="robust-estimators.html#least-trimmed-squares-lts"><i class="fa fa-check"></i><b>5.5.5</b> Least Trimmed Squares (LTS)</a></li>
<li class="chapter" data-level="5.5.6" data-path="robust-estimators.html"><a href="robust-estimators.html#s-estimators"><i class="fa fa-check"></i><b>5.5.6</b> <span class="math inline">\(S\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.7" data-path="robust-estimators.html"><a href="robust-estimators.html#mm-estimators"><i class="fa fa-check"></i><b>5.5.7</b> <span class="math inline">\(MM\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.8" data-path="robust-estimators.html"><a href="robust-estimators.html#practical-considerations-1"><i class="fa fa-check"></i><b>5.5.8</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="partial-least-squares.html"><a href="partial-least-squares.html"><i class="fa fa-check"></i><b>5.6</b> Partial Least Squares</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="partial-least-squares.html"><a href="partial-least-squares.html#motivation-for-pls"><i class="fa fa-check"></i><b>5.6.1</b> Motivation for PLS</a></li>
<li class="chapter" data-level="5.6.2" data-path="partial-least-squares.html"><a href="partial-least-squares.html#steps-to-construct-pls-components"><i class="fa fa-check"></i><b>5.6.2</b> Steps to Construct PLS Components</a></li>
<li class="chapter" data-level="5.6.3" data-path="partial-least-squares.html"><a href="partial-least-squares.html#properties-of-pls"><i class="fa fa-check"></i><b>5.6.3</b> Properties of PLS</a></li>
<li class="chapter" data-level="5.6.4" data-path="partial-least-squares.html"><a href="partial-least-squares.html#comparison-with-related-methods"><i class="fa fa-check"></i><b>5.6.4</b> Comparison with Related Methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference.html"><a href="inference.html#linear-functions-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Functions of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference.html"><a href="inference.html#nonlinear-functions-of-parameters"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear Functions of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Iterative Optimization</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#derivative-free"><i class="fa fa-check"></i><b>6.2.2</b> Derivative-Free</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic Heuristic</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.4</b> Linearization</a></li>
<li class="chapter" data-level="6.2.5" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.5</b> Hybrid</a></li>
<li class="chapter" data-level="6.2.6" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#comparison-of-nonlinear-optimizers"><i class="fa fa-check"></i><b>6.2.6</b> Comparison of Nonlinear Optimizers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html"><i class="fa fa-check"></i><b>6.3</b> Practical Considerations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#selecting-starting-values"><i class="fa fa-check"></i><b>6.3.1</b> Selecting Starting Values</a></li>
<li class="chapter" data-level="6.3.2" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#handling-constrained-parameters"><i class="fa fa-check"></i><b>6.3.2</b> Handling Constrained Parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#failure-to-converge"><i class="fa fa-check"></i><b>6.3.3</b> Failure to Converge</a></li>
<li class="chapter" data-level="6.3.4" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#convergence-to-a-local-minimum"><i class="fa fa-check"></i><b>6.3.4</b> Convergence to a Local Minimum</a></li>
<li class="chapter" data-level="6.3.5" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#model-adequacy-and-estimation-considerations"><i class="fa fa-check"></i><b>6.3.5</b> Model Adequacy and Estimation Considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>6.4</b> Application</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="application.html"><a href="application.html#nonlinear-estimation-using-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.4.1</b> Nonlinear Estimation Using Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.4.2" data-path="application.html"><a href="application.html#logistic-growth-model"><i class="fa fa-check"></i><b>6.4.2</b> Logistic Growth Model</a></li>
<li class="chapter" data-level="6.4.3" data-path="application.html"><a href="application.html#nonlinear-plateau-model"><i class="fa fa-check"></i><b>6.4.3</b> Nonlinear Plateau Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#logistic-model"><i class="fa fa-check"></i><b>7.1.1</b> Logistic Model</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#sec-likelihood-function-logistic"><i class="fa fa-check"></i><b>7.1.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="7.1.3" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#fisher-information-matrix"><i class="fa fa-check"></i><b>7.1.3</b> Fisher Information Matrix</a></li>
<li class="chapter" data-level="7.1.4" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#inference-in-logistic-regression"><i class="fa fa-check"></i><b>7.1.4</b> Inference in Logistic Regression</a></li>
<li class="chapter" data-level="7.1.5" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#application-logistic-regression"><i class="fa fa-check"></i><b>7.1.5</b> Application: Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#probit-model"><i class="fa fa-check"></i><b>7.2.1</b> Probit Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#application-probit-regression"><i class="fa fa-check"></i><b>7.2.2</b> Application: Probit Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#dataset-overview"><i class="fa fa-check"></i><b>7.3.1</b> Dataset Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-logistic-model"><i class="fa fa-check"></i><b>7.3.2</b> Apply Logistic Model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-probit-model"><i class="fa fa-check"></i><b>7.3.3</b> Apply Probit Model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#the-poisson-distribution"><i class="fa fa-check"></i><b>7.4.1</b> The Poisson Distribution</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#poisson-model"><i class="fa fa-check"></i><b>7.4.2</b> Poisson Model</a></li>
<li class="chapter" data-level="7.4.3" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#link-function-choices"><i class="fa fa-check"></i><b>7.4.3</b> Link Function Choices</a></li>
<li class="chapter" data-level="7.4.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#application-poisson-regression"><i class="fa fa-check"></i><b>7.4.4</b> Application: Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>7.5.1</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#application-negative-binomial-regression"><i class="fa fa-check"></i><b>7.5.2</b> Application: Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.5.3" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#fitting-a-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>7.5.3</b> Fitting a Zero-Inflated Negative Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html"><i class="fa fa-check"></i><b>7.6</b> Quasi-Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#is-quasi-poisson-regression-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.6.1</b> Is Quasi-Poisson Regression a Generalized Linear Model?</a></li>
<li class="chapter" data-level="7.6.2" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#application-quasi-poisson-regression"><i class="fa fa-check"></i><b>7.6.2</b> Application: Quasi-Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.7</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#the-multinomial-distribution"><i class="fa fa-check"></i><b>7.7.1</b> The Multinomial Distribution</a></li>
<li class="chapter" data-level="7.7.2" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#modeling-probabilities-using-log-odds"><i class="fa fa-check"></i><b>7.7.2</b> Modeling Probabilities Using Log-Odds</a></li>
<li class="chapter" data-level="7.7.3" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#softmax-representation"><i class="fa fa-check"></i><b>7.7.3</b> Softmax Representation</a></li>
<li class="chapter" data-level="7.7.4" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#log-odds-ratio-between-two-categories"><i class="fa fa-check"></i><b>7.7.4</b> Log-Odds Ratio Between Two Categories</a></li>
<li class="chapter" data-level="7.7.5" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#estimation"><i class="fa fa-check"></i><b>7.7.5</b> Estimation</a></li>
<li class="chapter" data-level="7.7.6" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#interpretation-of-coefficients"><i class="fa fa-check"></i><b>7.7.6</b> Interpretation of Coefficients</a></li>
<li class="chapter" data-level="7.7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-multinomial-logistic-regression"><i class="fa fa-check"></i><b>7.7.7</b> Application: Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.7.8" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-gamma-regression"><i class="fa fa-check"></i><b>7.7.8</b> Application: Gamma Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html"><i class="fa fa-check"></i><b>7.8</b> Generalization of Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#exponential-family"><i class="fa fa-check"></i><b>7.8.1</b> Exponential Family</a></li>
<li class="chapter" data-level="7.8.2" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#properties-of-glm-exponential-families"><i class="fa fa-check"></i><b>7.8.2</b> Properties of GLM Exponential Families</a></li>
<li class="chapter" data-level="7.8.3" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#structure-of-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.8.3</b> Structure of a Generalized Linear Model</a></li>
<li class="chapter" data-level="7.8.4" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#components-of-a-glm"><i class="fa fa-check"></i><b>7.8.4</b> Components of a GLM</a></li>
<li class="chapter" data-level="7.8.5" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#canonical-link"><i class="fa fa-check"></i><b>7.8.5</b> Canonical Link</a></li>
<li class="chapter" data-level="7.8.6" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inverse-link-functions"><i class="fa fa-check"></i><b>7.8.6</b> Inverse Link Functions</a></li>
<li class="chapter" data-level="7.8.7" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#estimation-of-parameters-in-glms"><i class="fa fa-check"></i><b>7.8.7</b> Estimation of Parameters in GLMs</a></li>
<li class="chapter" data-level="7.8.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inference-1"><i class="fa fa-check"></i><b>7.8.8</b> Inference</a></li>
<li class="chapter" data-level="7.8.9" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#deviance"><i class="fa fa-check"></i><b>7.8.9</b> Deviance</a></li>
<li class="chapter" data-level="7.8.10" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.8.10</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.8.11" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.8.11</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.8.12" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#over-dispersion"><i class="fa fa-check"></i><b>7.8.12</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-linear-mixed-models.html"><a href="sec-linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#motivation-a-repeated-measurements-example"><i class="fa fa-check"></i><b>8.1.1</b> Motivation: A Repeated Measurements Example</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#example-linear-mixed-model-for-repeated-measurements"><i class="fa fa-check"></i><b>8.1.2</b> Example: Linear Mixed Model for Repeated Measurements</a></li>
<li class="chapter" data-level="8.1.3" data-path="dependent-data.html"><a href="dependent-data.html#sec-random-intercepts-model-lmm"><i class="fa fa-check"></i><b>8.1.3</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.4" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models-in-linear-mixed-models"><i class="fa fa-check"></i><b>8.1.4</b> Covariance Models in Linear Mixed Models</a></li>
<li class="chapter" data-level="8.1.5" data-path="dependent-data.html"><a href="dependent-data.html#covariance-structures-in-mixed-models"><i class="fa fa-check"></i><b>8.1.5</b> Covariance Structures in Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.2</b> Estimation in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#interpretation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.1</b> Interpretation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#derivation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.2</b> Derivation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#bayesian-interpretation-of-linear-mixed-models"><i class="fa fa-check"></i><b>8.2.3</b> Bayesian Interpretation of Linear Mixed Models</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>8.2.4</b> Estimating the Variance-Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.3</b> Inference in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-fixed-effects-beta"><i class="fa fa-check"></i><b>8.3.1</b> Inference for Fixed Effects (<span class="math inline">\(\beta\)</span>)</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-variance-components-theta"><i class="fa fa-check"></i><b>8.3.2</b> Inference for Variance Components (<span class="math inline">\(\theta\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria for Model Selection</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-akaike-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.1</b> Akaike Information Criterion</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-corrected-aic-lmm"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-bayesian-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="8.4.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#practical-example-with-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.4</b> Practical Example with Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#example-setup"><i class="fa fa-check"></i><b>8.5.1</b> Example Setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#statistical-model-for-split-plot-designs"><i class="fa fa-check"></i><b>8.5.2</b> Statistical Model for Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#approaches-to-analyzing-split-plot-designs"><i class="fa fa-check"></i><b>8.5.3</b> Approaches to Analyzing Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-split-plot-design"><i class="fa fa-check"></i><b>8.5.4</b> Application: Split-Plot Design</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html#variance-covariance-structure-power-model"><i class="fa fa-check"></i><b>8.7.1</b> Variance-Covariance Structure: Power Model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html"><i class="fa fa-check"></i><b>8.8</b> Application: Mixed Models in Practice</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-1-pulp-brightness-analysis"><i class="fa fa-check"></i><b>8.8.1</b> Example 1: Pulp Brightness Analysis</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-2-penicillin-yield-glmm-with-blocking"><i class="fa fa-check"></i><b>8.8.2</b> Example 2: Penicillin Yield (GLMM with Blocking)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-3-growth-in-rats-over-time"><i class="fa fa-check"></i><b>8.8.3</b> Example 3: Growth in Rats Over Time</a></li>
<li class="chapter" data-level="8.8.4" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-4-tree-water-use-agridat"><i class="fa fa-check"></i><b>8.8.4</b> Example 4: Tree Water Use (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-nonlinear-and-generalized-linear-mixed-models.html"><a href="sec-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-nonlinear-mixed-models.html"><a href="sec-nonlinear-mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Nonlinear Mixed Models</a></li>
<li class="chapter" data-level="9.2" data-path="sec-generalized-linear-mixed-models.html"><a href="sec-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.2</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="9.3" data-path="relationship-between-nlmms-and-glmms.html"><a href="relationship-between-nlmms-and-glmms.html"><i class="fa fa-check"></i><b>9.3</b> Relationship Between NLMMs and GLMMs</a></li>
<li class="chapter" data-level="9.4" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html"><i class="fa fa-check"></i><b>9.4</b> Marginal Properties of GLMMs</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-mean-of-y_i"><i class="fa fa-check"></i><b>9.4.1</b> Marginal Mean of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-variance-of-y_i"><i class="fa fa-check"></i><b>9.4.2</b> Marginal Variance of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.3" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-covariance-of-mathbfy"><i class="fa fa-check"></i><b>9.4.3</b> Marginal Covariance of <span class="math inline">\(\mathbf{y}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.5</b> Estimation in Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.5.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.5.2" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#sec-estimation-by-linearization-glmm"><i class="fa fa-check"></i><b>9.5.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.5.3" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.5.3</b> Estimation by Bayesian Hierarchical Models</a></li>
<li class="chapter" data-level="9.5.4" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#practical-implementation-in-r"><i class="fa fa-check"></i><b>9.5.4</b> Practical Implementation in R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.6</b> Application: Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-data-cbpp-dataset"><i class="fa fa-check"></i><b>9.6.1</b> Binomial Data: CBPP Dataset</a></li>
<li class="chapter" data-level="9.6.2" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#count-data-owl-dataset"><i class="fa fa-check"></i><b>9.6.2</b> Count Data: Owl Dataset</a></li>
<li class="chapter" data-level="9.6.3" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-example-gotway-hessian-fly-data"><i class="fa fa-check"></i><b>9.6.3</b> Binomial Example: Gotway Hessian Fly Data</a></li>
<li class="chapter" data-level="9.6.4" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#nonlinear-mixed-model-yellow-poplar-data"><i class="fa fa-check"></i><b>9.6.4</b> Nonlinear Mixed Model: Yellow Poplar Data</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-nonparametric-regression.html"><a href="sec-nonparametric-regression.html"><i class="fa fa-check"></i><b>10</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html"><i class="fa fa-check"></i><b>10.1</b> Why Nonparametric?</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html#flexibility"><i class="fa fa-check"></i><b>10.1.1</b> Flexibility</a></li>
<li class="chapter" data-level="10.1.2" data-path="why-nonparametric.html"><a href="why-nonparametric.html#fewer-assumptions"><i class="fa fa-check"></i><b>10.1.2</b> Fewer Assumptions</a></li>
<li class="chapter" data-level="10.1.3" data-path="why-nonparametric.html"><a href="why-nonparametric.html#interpretability"><i class="fa fa-check"></i><b>10.1.3</b> Interpretability</a></li>
<li class="chapter" data-level="10.1.4" data-path="why-nonparametric.html"><a href="why-nonparametric.html#practical-considerations-3"><i class="fa fa-check"></i><b>10.1.4</b> Practical Considerations</a></li>
<li class="chapter" data-level="10.1.5" data-path="why-nonparametric.html"><a href="why-nonparametric.html#balancing-parametric-and-nonparametric-approaches"><i class="fa fa-check"></i><b>10.1.5</b> Balancing Parametric and Nonparametric Approaches</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html"><i class="fa fa-check"></i><b>10.2</b> Basic Concepts in Nonparametric Estimation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>10.2.1</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="10.2.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#kernel-smoothing-and-local-averages"><i class="fa fa-check"></i><b>10.2.2</b> Kernel Smoothing and Local Averages</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html"><i class="fa fa-check"></i><b>10.3</b> Kernel Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#basic-setup"><i class="fa fa-check"></i><b>10.3.1</b> Basic Setup</a></li>
<li class="chapter" data-level="10.3.2" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-nadaraya-watson-kernel-estimator"><i class="fa fa-check"></i><b>10.3.2</b> Nadaraya-Watson Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-priestley-chao-kernel-estimator"><i class="fa fa-check"></i><b>10.3.3</b> Priestley–Chao Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.4" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-gasser-mueller-kernel-estimator"><i class="fa fa-check"></i><b>10.3.4</b> Gasser–Müller Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.5" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#comparison-of-kernel-based-estimators"><i class="fa fa-check"></i><b>10.3.5</b> Comparison of Kernel-Based Estimators</a></li>
<li class="chapter" data-level="10.3.6" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#bandwidth-selection"><i class="fa fa-check"></i><b>10.3.6</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.3.7" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#asymptotic-properties"><i class="fa fa-check"></i><b>10.3.7</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="10.3.8" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#derivation-of-the-nadaraya-watson-estimator"><i class="fa fa-check"></i><b>10.3.8</b> Derivation of the Nadaraya-Watson Estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html"><i class="fa fa-check"></i><b>10.4</b> Local Polynomial Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#local-polynomial-fitting"><i class="fa fa-check"></i><b>10.4.1</b> Local Polynomial Fitting</a></li>
<li class="chapter" data-level="10.4.2" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#mathematical-form-of-the-solution"><i class="fa fa-check"></i><b>10.4.2</b> Mathematical Form of the Solution</a></li>
<li class="chapter" data-level="10.4.3" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bias-variance-and-asymptotics"><i class="fa fa-check"></i><b>10.4.3</b> Bias, Variance, and Asymptotics</a></li>
<li class="chapter" data-level="10.4.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#sec-special-case-local-linear-regression"><i class="fa fa-check"></i><b>10.4.4</b> Special Case: Local Linear Regression</a></li>
<li class="chapter" data-level="10.4.5" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bandwidth-selection-1"><i class="fa fa-check"></i><b>10.4.5</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.4.6" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#asymptotic-properties-summary"><i class="fa fa-check"></i><b>10.4.6</b> Asymptotic Properties Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html"><i class="fa fa-check"></i><b>10.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#properties-and-form-of-the-smoothing-spline"><i class="fa fa-check"></i><b>10.5.1</b> Properties and Form of the Smoothing Spline</a></li>
<li class="chapter" data-level="10.5.2" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#choice-of-lambda"><i class="fa fa-check"></i><b>10.5.2</b> Choice of <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="10.5.3" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#connection-to-reproducing-kernel-hilbert-spaces"><i class="fa fa-check"></i><b>10.5.3</b> Connection to Reproducing Kernel Hilbert Spaces</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.6</b> Confidence Intervals in Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#asymptotic-normality"><i class="fa fa-check"></i><b>10.6.1</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="10.6.2" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#bootstrap-methods"><i class="fa fa-check"></i><b>10.6.2</b> Bootstrap Methods</a></li>
<li class="chapter" data-level="10.6.3" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#practical-considerations-4"><i class="fa fa-check"></i><b>10.6.3</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html"><i class="fa fa-check"></i><b>10.7</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#estimation-via-penalized-likelihood"><i class="fa fa-check"></i><b>10.7.1</b> Estimation via Penalized Likelihood</a></li>
<li class="chapter" data-level="10.7.2" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#interpretation-of-gams"><i class="fa fa-check"></i><b>10.7.2</b> Interpretation of GAMs</a></li>
<li class="chapter" data-level="10.7.3" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#model-selection-and-smoothing-parameter-estimation"><i class="fa fa-check"></i><b>10.7.3</b> Model Selection and Smoothing Parameter Estimation</a></li>
<li class="chapter" data-level="10.7.4" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#extensions-of-gams"><i class="fa fa-check"></i><b>10.7.4</b> Extensions of GAMs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html"><i class="fa fa-check"></i><b>10.8</b> Regression Trees and Random Forests</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-regression-trees"><i class="fa fa-check"></i><b>10.8.1</b> Regression Trees</a></li>
<li class="chapter" data-level="10.8.2" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-random-forests"><i class="fa fa-check"></i><b>10.8.2</b> Random Forests</a></li>
<li class="chapter" data-level="10.8.3" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#theoretical-insights"><i class="fa fa-check"></i><b>10.8.3</b> Theoretical Insights</a></li>
<li class="chapter" data-level="10.8.4" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#feature-importance-in-random-forests"><i class="fa fa-check"></i><b>10.8.4</b> Feature Importance in Random Forests</a></li>
<li class="chapter" data-level="10.8.5" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#advantages-and-limitations-of-tree-based-methods"><i class="fa fa-check"></i><b>10.8.5</b> Advantages and Limitations of Tree-Based Methods</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html"><i class="fa fa-check"></i><b>10.9</b> Wavelet Regression</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-series-expansion"><i class="fa fa-check"></i><b>10.9.1</b> Wavelet Series Expansion</a></li>
<li class="chapter" data-level="10.9.2" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-regression-model"><i class="fa fa-check"></i><b>10.9.2</b> Wavelet Regression Model</a></li>
<li class="chapter" data-level="10.9.3" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-shrinkage-and-thresholding"><i class="fa fa-check"></i><b>10.9.3</b> Wavelet Shrinkage and Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.10</b> Multivariate Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#the-curse-of-dimensionality"><i class="fa fa-check"></i><b>10.10.1</b> The Curse of Dimensionality</a></li>
<li class="chapter" data-level="10.10.2" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-kernel-regression"><i class="fa fa-check"></i><b>10.10.2</b> Multivariate Kernel Regression</a></li>
<li class="chapter" data-level="10.10.3" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-splines"><i class="fa fa-check"></i><b>10.10.3</b> Multivariate Splines</a></li>
<li class="chapter" data-level="10.10.4" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#additive-models-gams"><i class="fa fa-check"></i><b>10.10.4</b> Additive Models (GAMs)</a></li>
<li class="chapter" data-level="10.10.5" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#radial-basis-functions"><i class="fa fa-check"></i><b>10.10.5</b> Radial Basis Functions</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html"><i class="fa fa-check"></i><b>10.11</b> Conclusion: The Evolving Landscape of Regression Analysis</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#key-takeaways-1"><i class="fa fa-check"></i><b>10.11.1</b> Key Takeaways</a></li>
<li class="chapter" data-level="10.11.2" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#the-art-and-science-of-regression"><i class="fa fa-check"></i><b>10.11.2</b> The Art and Science of Regression</a></li>
<li class="chapter" data-level="10.11.3" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#looking-forward"><i class="fa fa-check"></i><b>10.11.3</b> Looking Forward</a></li>
<li class="chapter" data-level="10.11.4" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#final-thoughts"><i class="fa fa-check"></i><b>10.11.4</b> Final Thoughts</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="11" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>11</b> Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>11.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-types.html"><a href="data-types.html#qualitative-vs.-quantitative-data"><i class="fa fa-check"></i><b>11.1.1</b> Qualitative vs. Quantitative Data</a></li>
<li class="chapter" data-level="11.1.2" data-path="data-types.html"><a href="data-types.html#other-ways-to-classify-data"><i class="fa fa-check"></i><b>11.1.2</b> Other Ways to Classify Data</a></li>
<li class="chapter" data-level="11.1.3" data-path="data-types.html"><a href="data-types.html#data-by-observational-structure-over-time"><i class="fa fa-check"></i><b>11.1.3</b> Data by Observational Structure Over Time</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sec-cross-sectional-data.html"><a href="sec-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.2</b> Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html"><i class="fa fa-check"></i><b>11.3</b> Time Series Data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#statistical-properties-of-time-series-models"><i class="fa fa-check"></i><b>11.3.1</b> Statistical Properties of Time Series Models</a></li>
<li class="chapter" data-level="11.3.2" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#common-time-series-processes"><i class="fa fa-check"></i><b>11.3.2</b> Common Time Series Processes</a></li>
<li class="chapter" data-level="11.3.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#deterministic-time-trends"><i class="fa fa-check"></i><b>11.3.3</b> Deterministic Time Trends</a></li>
<li class="chapter" data-level="11.3.4" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#violations-of-exogeneity-in-time-series-models"><i class="fa fa-check"></i><b>11.3.4</b> Violations of Exogeneity in Time Series Models</a></li>
<li class="chapter" data-level="11.3.5" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#consequences-of-exogeneity-violations"><i class="fa fa-check"></i><b>11.3.5</b> Consequences of Exogeneity Violations</a></li>
<li class="chapter" data-level="11.3.6" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#highly-persistent-data"><i class="fa fa-check"></i><b>11.3.6</b> Highly Persistent Data</a></li>
<li class="chapter" data-level="11.3.7" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-unit-root-testing"><i class="fa fa-check"></i><b>11.3.7</b> Unit Root Testing</a></li>
<li class="chapter" data-level="11.3.8" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-newey-west-standard-errors"><i class="fa fa-check"></i><b>11.3.8</b> Newey-West Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.4</b> Repeated Cross-Sectional Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#key-characteristics"><i class="fa fa-check"></i><b>11.4.1</b> Key Characteristics</a></li>
<li class="chapter" data-level="11.4.2" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#statistical-modeling-for-repeated-cross-sections"><i class="fa fa-check"></i><b>11.4.2</b> Statistical Modeling for Repeated Cross-Sections</a></li>
<li class="chapter" data-level="11.4.3" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#advantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.3</b> Advantages of Repeated Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.4.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#disadvantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.4</b> Disadvantages of Repeated Cross-Sectional Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html"><i class="fa fa-check"></i><b>11.5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sec-panel-data.html"><a href="sec-panel-data.html#advantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.1</b> Advantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.2" data-path="sec-panel-data.html"><a href="sec-panel-data.html#disadvantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.2</b> Disadvantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.3" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sources-of-variation-in-panel-data"><i class="fa fa-check"></i><b>11.5.3</b> Sources of Variation in Panel Data</a></li>
<li class="chapter" data-level="11.5.4" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-pooled-ols-estimator"><i class="fa fa-check"></i><b>11.5.4</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="11.5.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>11.5.5</b> Individual-Specific Effects Model</a></li>
<li class="chapter" data-level="11.5.6" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-random-effects-estimator"><i class="fa fa-check"></i><b>11.5.6</b> Random Effects Estimator</a></li>
<li class="chapter" data-level="11.5.7" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-fixed-effects-estimator"><i class="fa fa-check"></i><b>11.5.7</b> Fixed Effects Estimator</a></li>
<li class="chapter" data-level="11.5.8" data-path="sec-panel-data.html"><a href="sec-panel-data.html#tests-for-assumptions-in-panel-data-analysis"><i class="fa fa-check"></i><b>11.5.8</b> Tests for Assumptions in Panel Data Analysis</a></li>
<li class="chapter" data-level="11.5.9" data-path="sec-panel-data.html"><a href="sec-panel-data.html#model-selection-in-panel-data"><i class="fa fa-check"></i><b>11.5.9</b> Model Selection in Panel Data</a></li>
<li class="chapter" data-level="11.5.10" data-path="sec-panel-data.html"><a href="sec-panel-data.html#alternative-estimators"><i class="fa fa-check"></i><b>11.5.10</b> Alternative Estimators</a></li>
<li class="chapter" data-level="11.5.11" data-path="sec-panel-data.html"><a href="sec-panel-data.html#application-1"><i class="fa fa-check"></i><b>11.5.11</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="choosing-the-right-type-of-data.html"><a href="choosing-the-right-type-of-data.html"><i class="fa fa-check"></i><b>11.6</b> Choosing the Right Type of Data</a></li>
<li class="chapter" data-level="11.7" data-path="data-quality-and-ethical-considerations.html"><a href="data-quality-and-ethical-considerations.html"><i class="fa fa-check"></i><b>11.7</b> Data Quality and Ethical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>12</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>12.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization-z-score-normalization"><i class="fa fa-check"></i><b>12.1.1</b> Standardization (Z-score Normalization)</a></li>
<li class="chapter" data-level="12.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling-normalization"><i class="fa fa-check"></i><b>12.1.2</b> Min-Max Scaling (Normalization)</a></li>
<li class="chapter" data-level="12.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-root-and-cube-root-transformations"><i class="fa fa-check"></i><b>12.1.3</b> Square Root and Cube Root Transformations</a></li>
<li class="chapter" data-level="12.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-logarithmic-transformation"><i class="fa fa-check"></i><b>12.1.4</b> Logarithmic Transformation</a></li>
<li class="chapter" data-level="12.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential-transformation"><i class="fa fa-check"></i><b>12.1.5</b> Exponential Transformation</a></li>
<li class="chapter" data-level="12.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-transformation"><i class="fa fa-check"></i><b>12.1.6</b> Power Transformation</a></li>
<li class="chapter" data-level="12.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-reciprocal-transformation"><i class="fa fa-check"></i><b>12.1.7</b> Inverse (Reciprocal) Transformation</a></li>
<li class="chapter" data-level="12.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine-transformation"><i class="fa fa-check"></i><b>12.1.8</b> Hyperbolic Arcsine Transformation</a></li>
<li class="chapter" data-level="12.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-normalization-rank-based-transformation"><i class="fa fa-check"></i><b>12.1.9</b> Ordered Quantile Normalization (Rank-Based Transformation)</a></li>
<li class="chapter" data-level="12.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>12.1.10</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="12.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-transformation"><i class="fa fa-check"></i><b>12.1.11</b> Inverse Hyperbolic Sine Transformation</a></li>
<li class="chapter" data-level="12.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-box-cox-transformation"><i class="fa fa-check"></i><b>12.1.12</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="12.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>12.1.13</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="12.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss-transformation"><i class="fa fa-check"></i><b>12.1.14</b> RankGauss Transformation</a></li>
<li class="chapter" data-level="12.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#automatically-choosing-the-best-transformation"><i class="fa fa-check"></i><b>12.1.15</b> Automatically Choosing the Best Transformation</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>12.2</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="categorical-variables.html"><a href="categorical-variables.html#one-hot-encoding-dummy-variables"><i class="fa fa-check"></i><b>12.2.1</b> One-Hot Encoding (Dummy Variables)</a></li>
<li class="chapter" data-level="12.2.2" data-path="categorical-variables.html"><a href="categorical-variables.html#label-encoding"><i class="fa fa-check"></i><b>12.2.2</b> Label Encoding</a></li>
<li class="chapter" data-level="12.2.3" data-path="categorical-variables.html"><a href="categorical-variables.html#feature-hashing-hash-encoding"><i class="fa fa-check"></i><b>12.2.3</b> Feature Hashing (Hash Encoding)</a></li>
<li class="chapter" data-level="12.2.4" data-path="categorical-variables.html"><a href="categorical-variables.html#binary-encoding"><i class="fa fa-check"></i><b>12.2.4</b> Binary Encoding</a></li>
<li class="chapter" data-level="12.2.5" data-path="categorical-variables.html"><a href="categorical-variables.html#base-n-encoding-generalized-binary-encoding"><i class="fa fa-check"></i><b>12.2.5</b> Base-N Encoding (Generalized Binary Encoding)</a></li>
<li class="chapter" data-level="12.2.6" data-path="categorical-variables.html"><a href="categorical-variables.html#frequency-encoding"><i class="fa fa-check"></i><b>12.2.6</b> Frequency Encoding</a></li>
<li class="chapter" data-level="12.2.7" data-path="categorical-variables.html"><a href="categorical-variables.html#target-encoding-mean-encoding"><i class="fa fa-check"></i><b>12.2.7</b> Target Encoding (Mean Encoding)</a></li>
<li class="chapter" data-level="12.2.8" data-path="categorical-variables.html"><a href="categorical-variables.html#ordinal-encoding"><i class="fa fa-check"></i><b>12.2.8</b> Ordinal Encoding</a></li>
<li class="chapter" data-level="12.2.9" data-path="categorical-variables.html"><a href="categorical-variables.html#weight-of-evidence-encoding"><i class="fa fa-check"></i><b>12.2.9</b> Weight of Evidence Encoding</a></li>
<li class="chapter" data-level="12.2.10" data-path="categorical-variables.html"><a href="categorical-variables.html#helmert-encoding"><i class="fa fa-check"></i><b>12.2.10</b> Helmert Encoding</a></li>
<li class="chapter" data-level="12.2.11" data-path="categorical-variables.html"><a href="categorical-variables.html#probability-ratio-encoding"><i class="fa fa-check"></i><b>12.2.11</b> Probability Ratio Encoding</a></li>
<li class="chapter" data-level="12.2.12" data-path="categorical-variables.html"><a href="categorical-variables.html#backward-difference-encoding"><i class="fa fa-check"></i><b>12.2.12</b> Backward Difference Encoding</a></li>
<li class="chapter" data-level="12.2.13" data-path="categorical-variables.html"><a href="categorical-variables.html#leave-one-out-encoding"><i class="fa fa-check"></i><b>12.2.13</b> Leave-One-Out Encoding</a></li>
<li class="chapter" data-level="12.2.14" data-path="categorical-variables.html"><a href="categorical-variables.html#james-stein-encoding"><i class="fa fa-check"></i><b>12.2.14</b> James-Stein Encoding</a></li>
<li class="chapter" data-level="12.2.15" data-path="categorical-variables.html"><a href="categorical-variables.html#m-estimator-encoding"><i class="fa fa-check"></i><b>12.2.15</b> M-Estimator Encoding</a></li>
<li class="chapter" data-level="12.2.16" data-path="categorical-variables.html"><a href="categorical-variables.html#thermometer-encoding"><i class="fa fa-check"></i><b>12.2.16</b> Thermometer Encoding</a></li>
<li class="chapter" data-level="12.2.17" data-path="categorical-variables.html"><a href="categorical-variables.html#choosing-the-right-encoding-method"><i class="fa fa-check"></i><b>12.2.17</b> Choosing the Right Encoding Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>13</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html"><i class="fa fa-check"></i><b>13.1</b> Introduction to Missing Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#types-of-imputation"><i class="fa fa-check"></i><b>13.1.1</b> Types of Imputation</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#when-and-why-to-use-imputation"><i class="fa fa-check"></i><b>13.1.2</b> When and Why to Use Imputation</a></li>
<li class="chapter" data-level="13.1.3" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#importance-of-missing-data-treatment-in-statistical-modeling"><i class="fa fa-check"></i><b>13.1.3</b> Importance of Missing Data Treatment in Statistical Modeling</a></li>
<li class="chapter" data-level="13.1.4" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#prevalence-of-missing-data-across-domains"><i class="fa fa-check"></i><b>13.1.4</b> Prevalence of Missing Data Across Domains</a></li>
<li class="chapter" data-level="13.1.5" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#practical-considerations-for-imputation"><i class="fa fa-check"></i><b>13.1.5</b> Practical Considerations for Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html"><i class="fa fa-check"></i><b>13.2</b> Theoretical Foundations of Missing Data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#definition-and-classification-of-missing-data"><i class="fa fa-check"></i><b>13.2.1</b> Definition and Classification of Missing Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>13.2.2</b> Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.2.3" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#relationship-between-mechanisms-and-ignorability"><i class="fa fa-check"></i><b>13.2.3</b> Relationship Between Mechanisms and Ignorability</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html"><i class="fa fa-check"></i><b>13.3</b> Diagnosing the Missing Data Mechanism</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#descriptive-methods"><i class="fa fa-check"></i><b>13.3.1</b> Descriptive Methods</a></li>
<li class="chapter" data-level="13.3.2" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#statistical-tests-for-missing-data-mechanisms"><i class="fa fa-check"></i><b>13.3.2</b> Statistical Tests for Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.3.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#assessing-mar-and-mnar"><i class="fa fa-check"></i><b>13.3.3</b> Assessing MAR and MNAR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html"><i class="fa fa-check"></i><b>13.4</b> Methods for Handling Missing Data</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#basic-methods"><i class="fa fa-check"></i><b>13.4.1</b> Basic Methods</a></li>
<li class="chapter" data-level="13.4.2" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#single-imputation-techniques"><i class="fa fa-check"></i><b>13.4.2</b> Single Imputation Techniques</a></li>
<li class="chapter" data-level="13.4.3" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#machine-learning-and-modern-approaches"><i class="fa fa-check"></i><b>13.4.3</b> Machine Learning and Modern Approaches</a></li>
<li class="chapter" data-level="13.4.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>13.4.4</b> Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html"><i class="fa fa-check"></i><b>13.5</b> Evaluation of Imputation Methods</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#statistical-metrics-for-assessing-imputation-quality"><i class="fa fa-check"></i><b>13.5.1</b> Statistical Metrics for Assessing Imputation Quality</a></li>
<li class="chapter" data-level="13.5.2" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#bias-variance-tradeoff-in-imputation"><i class="fa fa-check"></i><b>13.5.2</b> Bias-Variance Tradeoff in Imputation</a></li>
<li class="chapter" data-level="13.5.3" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>13.5.3</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="13.5.4" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#validation-using-simulated-data-and-real-world-case-studies"><i class="fa fa-check"></i><b>13.5.4</b> Validation Using Simulated Data and Real-World Case Studies</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>13.6</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="13.7" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html"><i class="fa fa-check"></i><b>13.7</b> Challenges and Ethical Considerations</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#challenges-in-high-dimensional-data"><i class="fa fa-check"></i><b>13.7.1</b> Challenges in High-Dimensional Data</a></li>
<li class="chapter" data-level="13.7.2" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#missing-data-in-big-data-contexts"><i class="fa fa-check"></i><b>13.7.2</b> Missing Data in Big Data Contexts</a></li>
<li class="chapter" data-level="13.7.3" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#ethical-concerns"><i class="fa fa-check"></i><b>13.7.3</b> Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html"><i class="fa fa-check"></i><b>13.8</b> Emerging Trends in Missing Data Handling</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#advances-in-neural-network-approaches"><i class="fa fa-check"></i><b>13.8.1</b> Advances in Neural Network Approaches</a></li>
<li class="chapter" data-level="13.8.2" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#integration-with-reinforcement-learning"><i class="fa fa-check"></i><b>13.8.2</b> Integration with Reinforcement Learning</a></li>
<li class="chapter" data-level="13.8.3" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#synthetic-data-generation-for-missing-data"><i class="fa fa-check"></i><b>13.8.3</b> Synthetic Data Generation for Missing Data</a></li>
<li class="chapter" data-level="13.8.4" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#federated-learning-and-privacy-preserving-imputation"><i class="fa fa-check"></i><b>13.8.4</b> Federated Learning and Privacy-Preserving Imputation</a></li>
<li class="chapter" data-level="13.8.5" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#imputation-in-streaming-and-online-data-environments"><i class="fa fa-check"></i><b>13.8.5</b> Imputation in Streaming and Online Data Environments</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html"><i class="fa fa-check"></i><b>13.9</b> Application of Imputation</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="application-of-imputation.html"><a href="application-of-imputation.html#visualizing-missing-data"><i class="fa fa-check"></i><b>13.9.1</b> Visualizing Missing Data</a></li>
<li class="chapter" data-level="13.9.2" data-path="application-of-imputation.html"><a href="application-of-imputation.html#how-many-imputations"><i class="fa fa-check"></i><b>13.9.2</b> How Many Imputations?</a></li>
<li class="chapter" data-level="13.9.3" data-path="application-of-imputation.html"><a href="application-of-imputation.html#generating-missing-data-for-demonstration"><i class="fa fa-check"></i><b>13.9.3</b> Generating Missing Data for Demonstration</a></li>
<li class="chapter" data-level="13.9.4" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-mean-median-and-mode"><i class="fa fa-check"></i><b>13.9.4</b> Imputation with Mean, Median, and Mode</a></li>
<li class="chapter" data-level="13.9.5" data-path="application-of-imputation.html"><a href="application-of-imputation.html#k-nearest-neighbors-knn-imputation"><i class="fa fa-check"></i><b>13.9.5</b> K-Nearest Neighbors (KNN) Imputation</a></li>
<li class="chapter" data-level="13.9.6" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-decision-trees-rpart"><i class="fa fa-check"></i><b>13.9.6</b> Imputation with Decision Trees (rpart)</a></li>
<li class="chapter" data-level="13.9.7" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>13.9.7</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="13.9.8" data-path="application-of-imputation.html"><a href="application-of-imputation.html#amelia"><i class="fa fa-check"></i><b>13.9.8</b> Amelia</a></li>
<li class="chapter" data-level="13.9.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html#missforest"><i class="fa fa-check"></i><b>13.9.9</b> missForest</a></li>
<li class="chapter" data-level="13.9.10" data-path="application-of-imputation.html"><a href="application-of-imputation.html#hmisc"><i class="fa fa-check"></i><b>13.9.10</b> Hmisc</a></li>
<li class="chapter" data-level="13.9.11" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mi"><i class="fa fa-check"></i><b>13.9.11</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="model-specification-tests.html"><a href="model-specification-tests.html"><i class="fa fa-check"></i><b>14</b> Model Specification Tests</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html"><i class="fa fa-check"></i><b>14.1</b> Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-wald-test-nested"><i class="fa fa-check"></i><b>14.1.1</b> Wald Test</a></li>
<li class="chapter" data-level="14.1.2" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-likelihood-ratio-test-nested"><i class="fa fa-check"></i><b>14.1.2</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="14.1.3" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-f-test-for-linear-regression-nested"><i class="fa fa-check"></i><b>14.1.3</b> F-Test (for Linear Regression)</a></li>
<li class="chapter" data-level="14.1.4" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-chow-test"><i class="fa fa-check"></i><b>14.1.4</b> Chow Test</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html"><i class="fa fa-check"></i><b>14.2</b> Non-Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-vuong-test"><i class="fa fa-check"></i><b>14.2.1</b> Vuong Test</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-davidson--mackinnon-j-test"><i class="fa fa-check"></i><b>14.2.2</b> Davidson–MacKinnon J-Test</a></li>
<li class="chapter" data-level="14.2.3" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#adjusted-r2"><i class="fa fa-check"></i><b>14.2.3</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="14.2.4" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#comparing-models-with-transformed-dependent-variables"><i class="fa fa-check"></i><b>14.2.4</b> Comparing Models with Transformed Dependent Variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html"><i class="fa fa-check"></i><b>14.3</b> Heteroskedasticity Tests</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-breusch--pagan-test"><i class="fa fa-check"></i><b>14.3.1</b> Breusch–Pagan Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-white-test-hetero"><i class="fa fa-check"></i><b>14.3.2</b> White Test</a></li>
<li class="chapter" data-level="14.3.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-goldfeld--quandt-test"><i class="fa fa-check"></i><b>14.3.3</b> Goldfeld–Quandt Test</a></li>
<li class="chapter" data-level="14.3.4" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-park-test"><i class="fa fa-check"></i><b>14.3.4</b> Park Test</a></li>
<li class="chapter" data-level="14.3.5" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-glejser-test"><i class="fa fa-check"></i><b>14.3.5</b> Glejser Test</a></li>
<li class="chapter" data-level="14.3.6" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#summary-of-heteroskedasticity-tests"><i class="fa fa-check"></i><b>14.3.6</b> Summary of Heteroskedasticity Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html"><i class="fa fa-check"></i><b>14.4</b> Functional Form Tests</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-ramsey-reset-test"><i class="fa fa-check"></i><b>14.4.1</b> Ramsey RESET Test (Regression Equation Specification Error Test)</a></li>
<li class="chapter" data-level="14.4.2" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-harvey--collier-test"><i class="fa fa-check"></i><b>14.4.2</b> Harvey–Collier Test</a></li>
<li class="chapter" data-level="14.4.3" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-rainbow-test"><i class="fa fa-check"></i><b>14.4.3</b> Rainbow Test</a></li>
<li class="chapter" data-level="14.4.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html#summary-of-functional-form-tests"><i class="fa fa-check"></i><b>14.4.4</b> Summary of Functional Form Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html"><i class="fa fa-check"></i><b>14.5</b> Autocorrelation Tests</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-durbin--watson-test"><i class="fa fa-check"></i><b>14.5.1</b> Durbin–Watson Test</a></li>
<li class="chapter" data-level="14.5.2" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-breusch--godfrey-test"><i class="fa fa-check"></i><b>14.5.2</b> Breusch–Godfrey Test</a></li>
<li class="chapter" data-level="14.5.3" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-ljung--box-test"><i class="fa fa-check"></i><b>14.5.3</b> Ljung–Box Test (or Box–Pierce Test)</a></li>
<li class="chapter" data-level="14.5.4" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-runs-test"><i class="fa fa-check"></i><b>14.5.4</b> Runs Test</a></li>
<li class="chapter" data-level="14.5.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#summary-of-autocorrelation-tests"><i class="fa fa-check"></i><b>14.5.5</b> Summary of Autocorrelation Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html"><i class="fa fa-check"></i><b>14.6</b> Multicollinearity Diagnostics</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-variance-inflation-factor"><i class="fa fa-check"></i><b>14.6.1</b> Variance Inflation Factor</a></li>
<li class="chapter" data-level="14.6.2" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-tolerance-statistic"><i class="fa fa-check"></i><b>14.6.2</b> Tolerance Statistic</a></li>
<li class="chapter" data-level="14.6.3" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-condition-index-and-eigenvalue-decomposition"><i class="fa fa-check"></i><b>14.6.3</b> Condition Index and Eigenvalue Decomposition</a></li>
<li class="chapter" data-level="14.6.4" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-pairwise-correlation-matrix"><i class="fa fa-check"></i><b>14.6.4</b> Pairwise Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.5" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-determinant-of-the-correlation-matrix"><i class="fa fa-check"></i><b>14.6.5</b> Determinant of the Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#summary-of-multicollinearity-diagnostics"><i class="fa fa-check"></i><b>14.6.6</b> Summary of Multicollinearity Diagnostics</a></li>
<li class="chapter" data-level="14.6.7" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#addressing-multicollinearity"><i class="fa fa-check"></i><b>14.6.7</b> Addressing Multicollinearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>15</b> Variable Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html"><i class="fa fa-check"></i><b>15.1</b> Filter Methods (Statistical Criteria, Model-Agnostic)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#information-criteria-based-selection"><i class="fa fa-check"></i><b>15.1.1</b> Information Criteria-Based Selection</a></li>
<li class="chapter" data-level="15.1.2" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#univariate-selection-methods"><i class="fa fa-check"></i><b>15.1.2</b> Univariate Selection Methods</a></li>
<li class="chapter" data-level="15.1.3" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#correlation-based-feature-selection"><i class="fa fa-check"></i><b>15.1.3</b> Correlation-Based Feature Selection</a></li>
<li class="chapter" data-level="15.1.4" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#variance-thresholding"><i class="fa fa-check"></i><b>15.1.4</b> Variance Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html"><i class="fa fa-check"></i><b>15.2</b> Wrapper Methods (Model-Based Subset Evaluation)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#best-subsets-algorithm-1"><i class="fa fa-check"></i><b>15.2.1</b> Best Subsets Algorithm</a></li>
<li class="chapter" data-level="15.2.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#stepwise-selection-methods-1"><i class="fa fa-check"></i><b>15.2.2</b> Stepwise Selection Methods</a></li>
<li class="chapter" data-level="15.2.3" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#branch-and-bound-algorithm-1"><i class="fa fa-check"></i><b>15.2.3</b> Branch-and-Bound Algorithm</a></li>
<li class="chapter" data-level="15.2.4" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#recursive-feature-elimination"><i class="fa fa-check"></i><b>15.2.4</b> Recursive Feature Elimination</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html"><i class="fa fa-check"></i><b>15.3</b> Embedded Methods (Integrated into Model Training)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#regularization-based-selection"><i class="fa fa-check"></i><b>15.3.1</b> Regularization-Based Selection</a></li>
<li class="chapter" data-level="15.3.2" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#tree-based-feature-importance"><i class="fa fa-check"></i><b>15.3.2</b> Tree-Based Feature Importance</a></li>
<li class="chapter" data-level="15.3.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#genetic-algorithms-1"><i class="fa fa-check"></i><b>15.3.3</b> Genetic Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="summary-table-1.html"><a href="summary-table-1.html"><i class="fa fa-check"></i><b>15.4</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>16</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>16.1</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#error-types-in-hypothesis-testing"><i class="fa fa-check"></i><b>16.1.1</b> Error Types in Hypothesis Testing</a></li>
<li class="chapter" data-level="16.1.2" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#hypothesis-testing-framework-1"><i class="fa fa-check"></i><b>16.1.2</b> Hypothesis Testing Framework</a></li>
<li class="chapter" data-level="16.1.3" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#interpreting-hypothesis-testing-results"><i class="fa fa-check"></i><b>16.1.3</b> Interpreting Hypothesis Testing Results</a></li>
<li class="chapter" data-level="16.1.4" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#understanding-p-values"><i class="fa fa-check"></i><b>16.1.4</b> Understanding p-Values</a></li>
<li class="chapter" data-level="16.1.5" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#the-role-of-sample-size"><i class="fa fa-check"></i><b>16.1.5</b> The Role of Sample Size</a></li>
<li class="chapter" data-level="16.1.6" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#p-value-hacking"><i class="fa fa-check"></i><b>16.1.6</b> p-Value Hacking</a></li>
<li class="chapter" data-level="16.1.7" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#practical-vs.-statistical-significance"><i class="fa fa-check"></i><b>16.1.7</b> Practical vs. Statistical Significance</a></li>
<li class="chapter" data-level="16.1.8" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#mitigating-the-misuse-of-p-values"><i class="fa fa-check"></i><b>16.1.8</b> Mitigating the Misuse of p-Values</a></li>
<li class="chapter" data-level="16.1.9" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-wald-test"><i class="fa fa-check"></i><b>16.1.9</b> Wald Test</a></li>
<li class="chapter" data-level="16.1.10" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-likelihood-ratio-test"><i class="fa fa-check"></i><b>16.1.10</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="16.1.11" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#lagrange-multiplier-score"><i class="fa fa-check"></i><b>16.1.11</b> Lagrange Multiplier (Score) Test</a></li>
<li class="chapter" data-level="16.1.12" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#comparing-hypothesis-tests"><i class="fa fa-check"></i><b>16.1.12</b> Comparing Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html"><i class="fa fa-check"></i><b>16.2</b> Two One-Sided Tests Equivalence Testing</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-to-use-tost"><i class="fa fa-check"></i><b>16.2.1</b> When to Use TOST?</a></li>
<li class="chapter" data-level="16.2.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#interpretation-of-the-tost-procedure"><i class="fa fa-check"></i><b>16.2.2</b> Interpretation of the TOST Procedure</a></li>
<li class="chapter" data-level="16.2.3" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#relationship-to-confidence-intervals"><i class="fa fa-check"></i><b>16.2.3</b> Relationship to Confidence Intervals</a></li>
<li class="chapter" data-level="16.2.4" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#example-1-testing-the-equivalence-of-two-means"><i class="fa fa-check"></i><b>16.2.4</b> Example 1: Testing the Equivalence of Two Means</a></li>
<li class="chapter" data-level="16.2.5" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#advantages-of-tost-equivalence-testing"><i class="fa fa-check"></i><b>16.2.5</b> Advantages of TOST Equivalence Testing</a></li>
<li class="chapter" data-level="16.2.6" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-not-to-use-tost"><i class="fa fa-check"></i><b>16.2.6</b> When <em>Not</em> to Use TOST</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html"><i class="fa fa-check"></i><b>16.3</b> False Discovery Rate</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-hochberg-procedure"><i class="fa fa-check"></i><b>16.3.1</b> Benjamini-Hochberg Procedure</a></li>
<li class="chapter" data-level="16.3.2" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-yekutieli-procedure"><i class="fa fa-check"></i><b>16.3.2</b> Benjamini-Yekutieli Procedure</a></li>
<li class="chapter" data-level="16.3.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-storeys-q-value-approach"><i class="fa fa-check"></i><b>16.3.3</b> Storey’s q-value Approach</a></li>
<li class="chapter" data-level="16.3.4" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#summary-false-discovery-rate-methods"><i class="fa fa-check"></i><b>16.3.4</b> Summary: False Discovery Rate Methods</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="comparison-of-testing-frameworks.html"><a href="comparison-of-testing-frameworks.html"><i class="fa fa-check"></i><b>16.4</b> Comparison of Testing Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-marginal-effects.html"><a href="sec-marginal-effects.html"><i class="fa fa-check"></i><b>17</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html"><i class="fa fa-check"></i><b>17.1</b> Definition of Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-analytical-derivation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.1</b> Analytical Derivation of Marginal Effects</a></li>
<li class="chapter" data-level="17.1.2" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-numerical-approximation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.2</b> Numerical Approximation of Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="marginal-effects-in-different-contexts.html"><a href="marginal-effects-in-different-contexts.html"><i class="fa fa-check"></i><b>17.2</b> Marginal Effects in Different Contexts</a></li>
<li class="chapter" data-level="17.3" data-path="marginal-effects-interpretation.html"><a href="marginal-effects-interpretation.html"><i class="fa fa-check"></i><b>17.3</b> Marginal Effects Interpretation</a></li>
<li class="chapter" data-level="17.4" data-path="sec-delta-method.html"><a href="sec-delta-method.html"><i class="fa fa-check"></i><b>17.4</b> Delta Method</a></li>
<li class="chapter" data-level="17.5" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html"><i class="fa fa-check"></i><b>17.5</b> Comparison: Delta Method vs. Alternative Approaches</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html#example-applying-the-delta-method-in-a-logistic-regression"><i class="fa fa-check"></i><b>17.5.1</b> Example: Applying the Delta Method in a logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html"><i class="fa fa-check"></i><b>17.6</b> Types of Marginal Effect</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-average-marginal-effect"><i class="fa fa-check"></i><b>17.6.1</b> Average Marginal Effect</a></li>
<li class="chapter" data-level="17.6.2" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-mean"><i class="fa fa-check"></i><b>17.6.2</b> Marginal Effects at the Mean</a></li>
<li class="chapter" data-level="17.6.3" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-average"><i class="fa fa-check"></i><b>17.6.3</b> Marginal Effects at the Average</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html"><i class="fa fa-check"></i><b>17.7</b> Packages for Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#marginaleffects-package-recommended"><i class="fa fa-check"></i><b>17.7.1</b> <code>marginaleffects</code> Package (Recommended)</a></li>
<li class="chapter" data-level="17.7.2" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#margins-package"><i class="fa fa-check"></i><b>17.7.2</b> <code>margins</code> Package</a></li>
<li class="chapter" data-level="17.7.3" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#mfx-package"><i class="fa fa-check"></i><b>17.7.3</b> <code>mfx</code> Package</a></li>
<li class="chapter" data-level="17.7.4" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#comparison-of-packages"><i class="fa fa-check"></i><b>17.7.4</b> Comparison of Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>18</b> Moderation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="types-of-moderation-analyses.html"><a href="types-of-moderation-analyses.html"><i class="fa fa-check"></i><b>18.1</b> Types of Moderation Analyses</a></li>
<li class="chapter" data-level="18.2" data-path="key-terminology.html"><a href="key-terminology.html"><i class="fa fa-check"></i><b>18.2</b> Key Terminology</a></li>
<li class="chapter" data-level="18.3" data-path="moderation-model.html"><a href="moderation-model.html"><i class="fa fa-check"></i><b>18.3</b> Moderation Model</a></li>
<li class="chapter" data-level="18.4" data-path="types-of-interactions.html"><a href="types-of-interactions.html"><i class="fa fa-check"></i><b>18.4</b> Types of Interactions</a></li>
<li class="chapter" data-level="18.5" data-path="three-way-interactions.html"><a href="three-way-interactions.html"><i class="fa fa-check"></i><b>18.5</b> Three-Way Interactions</a></li>
<li class="chapter" data-level="18.6" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18.6</b> Additional Resources</a></li>
<li class="chapter" data-level="18.7" data-path="application-2.html"><a href="application-2.html"><i class="fa fa-check"></i><b>18.7</b> Application</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="application-2.html"><a href="application-2.html#emmeans-package"><i class="fa fa-check"></i><b>18.7.1</b> <code>emmeans</code> Package</a></li>
<li class="chapter" data-level="18.7.2" data-path="application-2.html"><a href="application-2.html#probemod-package"><i class="fa fa-check"></i><b>18.7.2</b> <code>probemod</code> Package</a></li>
<li class="chapter" data-level="18.7.3" data-path="application-2.html"><a href="application-2.html#interactions-package"><i class="fa fa-check"></i><b>18.7.3</b> <code>interactions</code> Package</a></li>
<li class="chapter" data-level="18.7.4" data-path="application-2.html"><a href="application-2.html#interactionr-package"><i class="fa fa-check"></i><b>18.7.4</b> <code>interactionR</code> Package</a></li>
<li class="chapter" data-level="18.7.5" data-path="application-2.html"><a href="application-2.html#sjplot-package"><i class="fa fa-check"></i><b>18.7.5</b> <code>sjPlot</code> Package</a></li>
<li class="chapter" data-level="18.7.6" data-path="application-2.html"><a href="application-2.html#summary-of-moderation-analysis-packages"><i class="fa fa-check"></i><b>18.7.6</b> Summary of Moderation Analysis Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>19</b> Mediation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>19.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#steps-in-the-traditional-mediation-model"><i class="fa fa-check"></i><b>19.1.1</b> Steps in the Traditional Mediation Model</a></li>
<li class="chapter" data-level="19.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#graphical-representation-of-mediation"><i class="fa fa-check"></i><b>19.1.2</b> Graphical Representation of Mediation</a></li>
<li class="chapter" data-level="19.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#measuring-mediation"><i class="fa fa-check"></i><b>19.1.3</b> Measuring Mediation</a></li>
<li class="chapter" data-level="19.1.4" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-linear-mediation-models"><i class="fa fa-check"></i><b>19.1.4</b> Assumptions in Linear Mediation Models</a></li>
<li class="chapter" data-level="19.1.5" data-path="traditional-approach.html"><a href="traditional-approach.html#testing-for-mediation"><i class="fa fa-check"></i><b>19.1.5</b> Testing for Mediation</a></li>
<li class="chapter" data-level="19.1.6" data-path="traditional-approach.html"><a href="traditional-approach.html#additional-considerations"><i class="fa fa-check"></i><b>19.1.6</b> Additional Considerations</a></li>
<li class="chapter" data-level="19.1.7" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-mediation-analysis"><i class="fa fa-check"></i><b>19.1.7</b> Assumptions in Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.8" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>19.1.8</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="19.1.9" data-path="traditional-approach.html"><a href="traditional-approach.html#power-analysis-for-mediation"><i class="fa fa-check"></i><b>19.1.9</b> Power Analysis for Mediation</a></li>
<li class="chapter" data-level="19.1.10" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation-analysis"><i class="fa fa-check"></i><b>19.1.10</b> Multiple Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.11" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-treatments-in-mediation"><i class="fa fa-check"></i><b>19.1.11</b> Multiple Treatments in Mediation</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html"><i class="fa fa-check"></i><b>19.2</b> Causal Inference Approach to Mediation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#sec-example-traditional-mediation-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Example: Traditional Mediation Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#two-approaches-in-causal-mediation-analysis"><i class="fa fa-check"></i><b>19.2.2</b> Two Approaches in Causal Mediation Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>20</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html"><i class="fa fa-check"></i><b>20.1</b> Conceptual Framing</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html#predictive-modeling"><i class="fa fa-check"></i><b>20.1.1</b> Predictive Modeling</a></li>
<li class="chapter" data-level="20.1.2" data-path="conceptual-framing.html"><a href="conceptual-framing.html#estimation-or-causal-inference"><i class="fa fa-check"></i><b>20.1.2</b> Estimation or Causal Inference</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html"><i class="fa fa-check"></i><b>20.2</b> Mathematical Setup</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="mathematical-setup.html"><a href="mathematical-setup.html#probability-space-and-data"><i class="fa fa-check"></i><b>20.2.1</b> Probability Space and Data</a></li>
<li class="chapter" data-level="20.2.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html#loss-functions-and-risk"><i class="fa fa-check"></i><b>20.2.2</b> Loss Functions and Risk</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html"><i class="fa fa-check"></i><b>20.3</b> Prediction in Detail</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#empirical-risk-minimization-and-generalization"><i class="fa fa-check"></i><b>20.3.1</b> Empirical Risk Minimization and Generalization</a></li>
<li class="chapter" data-level="20.3.2" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>20.3.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="20.3.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#example-linear-regression-for-prediction"><i class="fa fa-check"></i><b>20.3.3</b> Example: Linear Regression for Prediction</a></li>
<li class="chapter" data-level="20.3.4" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#applications-in-economics"><i class="fa fa-check"></i><b>20.3.4</b> Applications in Economics</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html"><i class="fa fa-check"></i><b>20.4</b> Parameter Estimation and Causal Inference</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#estimation-in-parametric-models"><i class="fa fa-check"></i><b>20.4.1</b> Estimation in Parametric Models</a></li>
<li class="chapter" data-level="20.4.2" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#causal-inference-fundamentals"><i class="fa fa-check"></i><b>20.4.2</b> Causal Inference Fundamentals</a></li>
<li class="chapter" data-level="20.4.3" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#role-of-identification"><i class="fa fa-check"></i><b>20.4.3</b> Role of Identification</a></li>
<li class="chapter" data-level="20.4.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#challenges-1"><i class="fa fa-check"></i><b>20.4.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>20.5</b> Causation versus Prediction</a></li>
<li class="chapter" data-level="20.6" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html"><i class="fa fa-check"></i><b>20.6</b> Illustrative Equations and Mathematical Contrasts</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#risk-minimization-vs.-consistency"><i class="fa fa-check"></i><b>20.6.1</b> Risk Minimization vs. Consistency</a></li>
<li class="chapter" data-level="20.6.2" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#partial-derivatives-vs.-predictions"><i class="fa fa-check"></i><b>20.6.2</b> Partial Derivatives vs. Predictions</a></li>
<li class="chapter" data-level="20.6.3" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#example-high-dimensional-regularization"><i class="fa fa-check"></i><b>20.6.3</b> Example: High-Dimensional Regularization</a></li>
<li class="chapter" data-level="20.6.4" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#potential-outcomes-notation"><i class="fa fa-check"></i><b>20.6.4</b> Potential Outcomes Notation</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html"><i class="fa fa-check"></i><b>20.7</b> Extended Mathematical Points</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#m-estimation-and-asymptotic-theory"><i class="fa fa-check"></i><b>20.7.1</b> M-Estimation and Asymptotic Theory</a></li>
<li class="chapter" data-level="20.7.2" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#the-danger-of-omitted-variables"><i class="fa fa-check"></i><b>20.7.2</b> The Danger of Omitted Variables</a></li>
<li class="chapter" data-level="20.7.3" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#cross-validation-vs.-statistical-testing"><i class="fa fa-check"></i><b>20.7.3</b> Cross-Validation vs. Statistical Testing</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="putting-it-all-together-comparing-objectives.html"><a href="putting-it-all-together-comparing-objectives.html"><i class="fa fa-check"></i><b>20.8</b> Putting It All Together: Comparing Objectives</a></li>
<li class="chapter" data-level="20.9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>20.9</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="21" data-path="sec-causal-inference.html"><a href="sec-causal-inference.html"><i class="fa fa-check"></i><b>21</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-the-ladder-of-causation.html"><a href="sec-the-ladder-of-causation.html"><i class="fa fa-check"></i><b>21.1</b> The Ladder of Causation</a></li>
<li class="chapter" data-level="21.2" data-path="the-formal-notation-of-causality.html"><a href="the-formal-notation-of-causality.html"><i class="fa fa-check"></i><b>21.2</b> The Formal Notation of Causality</a></li>
<li class="chapter" data-level="21.3" data-path="the-7-tools-of-structural-causal-models.html"><a href="the-7-tools-of-structural-causal-models.html"><i class="fa fa-check"></i><b>21.3</b> The 7 Tools of Structural Causal Models</a></li>
<li class="chapter" data-level="21.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html"><i class="fa fa-check"></i><b>21.4</b> Simpson’s Paradox</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#what-is-simpsons-paradox"><i class="fa fa-check"></i><b>21.4.1</b> What is Simpson’s Paradox?</a></li>
<li class="chapter" data-level="21.4.2" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-is-this-important"><i class="fa fa-check"></i><b>21.4.2</b> Why is this Important?</a></li>
<li class="chapter" data-level="21.4.3" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#comparison-between-simpsons-paradox-and-omitted-variable-bias"><i class="fa fa-check"></i><b>21.4.3</b> Comparison between Simpson’s Paradox and Omitted Variable Bias</a></li>
<li class="chapter" data-level="21.4.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#illustrating-simpsons-paradox-marketing-campaign-success-rates"><i class="fa fa-check"></i><b>21.4.4</b> Illustrating Simpson’s Paradox: Marketing Campaign Success Rates</a></li>
<li class="chapter" data-level="21.4.5" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-does-this-happen"><i class="fa fa-check"></i><b>21.4.5</b> Why Does This Happen?</a></li>
<li class="chapter" data-level="21.4.6" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#how-does-causal-inference-solve-this"><i class="fa fa-check"></i><b>21.4.6</b> How Does Causal Inference Solve This?</a></li>
<li class="chapter" data-level="21.4.7" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#correcting-simpsons-paradox-with-regression-adjustment"><i class="fa fa-check"></i><b>21.4.7</b> Correcting Simpson’s Paradox with Regression Adjustment</a></li>
<li class="chapter" data-level="21.4.8" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#key-takeaways-3"><i class="fa fa-check"></i><b>21.4.8</b> Key Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="additional-resources-1.html"><a href="additional-resources-1.html"><i class="fa fa-check"></i><b>21.5</b> Additional Resources</a></li>
<li class="chapter" data-level="21.6" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html"><i class="fa fa-check"></i><b>21.6</b> Experimental vs. Quasi-Experimental Designs</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html#criticisms-of-quasi-experimental-designs"><i class="fa fa-check"></i><b>21.6.1</b> Criticisms of Quasi-Experimental Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="hierarchical-ordering-of-causal-tools.html"><a href="hierarchical-ordering-of-causal-tools.html"><i class="fa fa-check"></i><b>21.7</b> Hierarchical Ordering of Causal Tools</a></li>
<li class="chapter" data-level="21.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html"><i class="fa fa-check"></i><b>21.8</b> Types of Validity in Research</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-measurement-validity"><i class="fa fa-check"></i><b>21.8.1</b> Measurement Validity</a></li>
<li class="chapter" data-level="21.8.2" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-construct-validity"><i class="fa fa-check"></i><b>21.8.2</b> Construct Validity</a></li>
<li class="chapter" data-level="21.8.3" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-criterion-validity"><i class="fa fa-check"></i><b>21.8.3</b> Criterion Validity</a></li>
<li class="chapter" data-level="21.8.4" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-internal-validity"><i class="fa fa-check"></i><b>21.8.4</b> Internal Validity</a></li>
<li class="chapter" data-level="21.8.5" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-external-validity"><i class="fa fa-check"></i><b>21.8.5</b> External Validity</a></li>
<li class="chapter" data-level="21.8.6" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-ecological-validity"><i class="fa fa-check"></i><b>21.8.6</b> Ecological Validity</a></li>
<li class="chapter" data-level="21.8.7" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-statistical-conclusion-validity"><i class="fa fa-check"></i><b>21.8.7</b> Statistical Conclusion Validity</a></li>
<li class="chapter" data-level="21.8.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#putting-it-all-together"><i class="fa fa-check"></i><b>21.8.8</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html"><i class="fa fa-check"></i><b>21.9</b> Types of Subjects in a Treatment Setting</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#non-switchers"><i class="fa fa-check"></i><b>21.9.1</b> Non-Switchers</a></li>
<li class="chapter" data-level="21.9.2" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#switchers"><i class="fa fa-check"></i><b>21.9.2</b> Switchers</a></li>
<li class="chapter" data-level="21.9.3" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#classification-of-individuals-based-on-treatment-assignment"><i class="fa fa-check"></i><b>21.9.3</b> Classification of Individuals Based on Treatment Assignment</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html"><i class="fa fa-check"></i><b>21.10</b> Types of Treatment Effects</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-average-treatment-effect"><i class="fa fa-check"></i><b>21.10.1</b> Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.2" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-conditional-average-treatment-effect-"><i class="fa fa-check"></i><b>21.10.2</b> Conditional Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.3" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-intention-to-treat-effect"><i class="fa fa-check"></i><b>21.10.3</b> Intention-to-Treat Effect</a></li>
<li class="chapter" data-level="21.10.4" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-local-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.5" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.6" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>21.10.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="21.10.7" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-quantile-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.8" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-log-odds-treatment-effects-for-binary-outcomes"><i class="fa fa-check"></i><b>21.10.8</b> Log-Odds Treatment Effects for Binary Outcomes</a></li>
<li class="chapter" data-level="21.10.9" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#summary-table-treatment-effect-estimands"><i class="fa fa-check"></i><b>21.10.9</b> Summary Table: Treatment Effect Estimands</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="22" data-path="sec-experimental-design.html"><a href="sec-experimental-design.html"><i class="fa fa-check"></i><b>22</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="22.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>22.1</b> Principles of Experimental Design</a></li>
<li class="chapter" data-level="22.2" data-path="sec-the-gold-standard-randomized-controlled-trials.html"><a href="sec-the-gold-standard-randomized-controlled-trials.html"><i class="fa fa-check"></i><b>22.2</b> The Gold Standard: Randomized Controlled Trials</a></li>
<li class="chapter" data-level="22.3" data-path="selection-problem.html"><a href="selection-problem.html"><i class="fa fa-check"></i><b>22.3</b> Selection Problem</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="selection-problem.html"><a href="selection-problem.html#the-observed-difference-in-outcomes"><i class="fa fa-check"></i><b>22.3.1</b> The Observed Difference in Outcomes</a></li>
<li class="chapter" data-level="22.3.2" data-path="selection-problem.html"><a href="selection-problem.html#eliminating-selection-bias-with-random-assignment"><i class="fa fa-check"></i><b>22.3.2</b> Eliminating Selection Bias with Random Assignment</a></li>
<li class="chapter" data-level="22.3.3" data-path="selection-problem.html"><a href="selection-problem.html#another-representation-under-regression"><i class="fa fa-check"></i><b>22.3.3</b> Another Representation Under Regression</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html"><i class="fa fa-check"></i><b>22.4</b> Classical Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.4.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="22.4.2" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#randomized-block-design"><i class="fa fa-check"></i><b>22.4.2</b> Randomized Block Design</a></li>
<li class="chapter" data-level="22.4.3" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#factorial-design"><i class="fa fa-check"></i><b>22.4.3</b> Factorial Design</a></li>
<li class="chapter" data-level="22.4.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#crossover-design"><i class="fa fa-check"></i><b>22.4.4</b> Crossover Design</a></li>
<li class="chapter" data-level="22.4.5" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#split-plot-design"><i class="fa fa-check"></i><b>22.4.5</b> Split-Plot Design</a></li>
<li class="chapter" data-level="22.4.6" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#latin-square-design"><i class="fa fa-check"></i><b>22.4.6</b> Latin Square Design</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html"><i class="fa fa-check"></i><b>22.5</b> Advanced Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#semi-random-experiments"><i class="fa fa-check"></i><b>22.5.1</b> Semi-Random Experiments</a></li>
<li class="chapter" data-level="22.5.2" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#re-randomization"><i class="fa fa-check"></i><b>22.5.2</b> Re-Randomization</a></li>
<li class="chapter" data-level="22.5.3" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments"><i class="fa fa-check"></i><b>22.5.3</b> Two-Stage Randomized Experiments</a></li>
<li class="chapter" data-level="22.5.4" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments-with-interference-and-noncompliance"><i class="fa fa-check"></i><b>22.5.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="emerging-research.html"><a href="emerging-research.html"><i class="fa fa-check"></i><b>22.6</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="emerging-research.html"><a href="emerging-research.html#covariate-balancing-in-online-ab-testing-the-pigeonhole-design"><i class="fa fa-check"></i><b>22.6.1</b> Covariate Balancing in Online A/B Testing: The Pigeonhole Design</a></li>
<li class="chapter" data-level="22.6.2" data-path="emerging-research.html"><a href="emerging-research.html#sec-handling-zero-valued-outcomes"><i class="fa fa-check"></i><b>22.6.2</b> Handling Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>23</b> Sampling</a>
<ul>
<li class="chapter" data-level="23.1" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>23.1</b> Population and Sample</a></li>
<li class="chapter" data-level="23.2" data-path="probability-sampling.html"><a href="probability-sampling.html"><i class="fa fa-check"></i><b>23.2</b> Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-simple-random-sampling"><i class="fa fa-check"></i><b>23.2.1</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="23.2.2" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-stratified-sampling"><i class="fa fa-check"></i><b>23.2.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="23.2.3" data-path="probability-sampling.html"><a href="probability-sampling.html#systematic-sampling"><i class="fa fa-check"></i><b>23.2.3</b> Systematic Sampling</a></li>
<li class="chapter" data-level="23.2.4" data-path="probability-sampling.html"><a href="probability-sampling.html#cluster-sampling"><i class="fa fa-check"></i><b>23.2.4</b> Cluster Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html"><i class="fa fa-check"></i><b>23.3</b> Non-Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#convenience-sampling"><i class="fa fa-check"></i><b>23.3.1</b> Convenience Sampling</a></li>
<li class="chapter" data-level="23.3.2" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#quota-sampling"><i class="fa fa-check"></i><b>23.3.2</b> Quota Sampling</a></li>
<li class="chapter" data-level="23.3.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#snowball-sampling"><i class="fa fa-check"></i><b>23.3.3</b> Snowball Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="sec-unequal-probability-sampling.html"><a href="sec-unequal-probability-sampling.html"><i class="fa fa-check"></i><b>23.4</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="23.5" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html"><i class="fa fa-check"></i><b>23.5</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#cube-method-for-balanced-sampling"><i class="fa fa-check"></i><b>23.5.1</b> Cube Method for Balanced Sampling</a></li>
<li class="chapter" data-level="23.5.2" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-with-stratification"><i class="fa fa-check"></i><b>23.5.2</b> Balanced Sampling with Stratification</a></li>
<li class="chapter" data-level="23.5.3" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-cluster-sampling"><i class="fa fa-check"></i><b>23.5.3</b> Balanced Sampling in Cluster Sampling</a></li>
<li class="chapter" data-level="23.5.4" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-two-stage-sampling"><i class="fa fa-check"></i><b>23.5.4</b> Balanced Sampling in Two-Stage Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="sample-size-determination.html"><a href="sample-size-determination.html"><i class="fa fa-check"></i><b>23.6</b> Sample Size Determination</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="sec-analysis-of-variance-anova.html"><a href="sec-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>24</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="24.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html"><i class="fa fa-check"></i><b>24.1</b> Completely Randomized Design</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>24.1.1</b> Single-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.2" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-random-effects-model"><i class="fa fa-check"></i><b>24.1.2</b> Single Factor Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.3" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-factor-fixed-effects-anova"><i class="fa fa-check"></i><b>24.1.3</b> Two-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.4" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-random-effects-anova"><i class="fa fa-check"></i><b>24.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.5" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>24.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html"><i class="fa fa-check"></i><b>24.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#kruskal-wallis-test-one-way-nonparametric-anova"><i class="fa fa-check"></i><b>24.2.1</b> Kruskal-Wallis Test (One-Way Nonparametric ANOVA)</a></li>
<li class="chapter" data-level="24.2.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#friedman-test-nonparametric-two-way-anova"><i class="fa fa-check"></i><b>24.2.2</b> Friedman Test (Nonparametric Two-Way ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="sec-randomized-block-designs.html"><a href="sec-randomized-block-designs.html"><i class="fa fa-check"></i><b>24.3</b> Randomized Block Designs</a></li>
<li class="chapter" data-level="24.4" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>24.4</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-design"><i class="fa fa-check"></i><b>24.4.1</b> Two-Factor Nested Design</a></li>
<li class="chapter" data-level="24.4.2" data-path="nested-designs.html"><a href="nested-designs.html#unbalanced-nested-two-factor-designs"><i class="fa fa-check"></i><b>24.4.2</b> Unbalanced Nested Two-Factor Designs</a></li>
<li class="chapter" data-level="24.4.3" data-path="nested-designs.html"><a href="nested-designs.html#random-factor-effects"><i class="fa fa-check"></i><b>24.4.3</b> Random Factor Effects</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>24.5</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>24.5.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="24.5.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#single-factor-studies"><i class="fa fa-check"></i><b>24.5.2</b> Single Factor Studies</a></li>
<li class="chapter" data-level="24.5.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#multi-factor-studies"><i class="fa fa-check"></i><b>24.5.3</b> Multi-Factor Studies</a></li>
<li class="chapter" data-level="24.5.4" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#procedure-for-sample-size-selection"><i class="fa fa-check"></i><b>24.5.4</b> Procedure for Sample Size Selection</a></li>
<li class="chapter" data-level="24.5.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>24.5.5</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>24.6</b> Single Factor Covariance Model</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#statistical-inference-for-treatment-effects"><i class="fa fa-check"></i><b>24.6.1</b> Statistical Inference for Treatment Effects</a></li>
<li class="chapter" data-level="24.6.2" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#testing-for-parallel-slopes"><i class="fa fa-check"></i><b>24.6.2</b> Testing for Parallel Slopes</a></li>
<li class="chapter" data-level="24.6.3" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#adjusted-means"><i class="fa fa-check"></i><b>24.6.3</b> Adjusted Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sec-multivariate-methods.html"><a href="sec-multivariate-methods.html"><i class="fa fa-check"></i><b>25</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="25.1" data-path="basic-understanding.html"><a href="basic-understanding.html"><i class="fa fa-check"></i><b>25.1</b> Basic Understanding</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-random-vectors"><i class="fa fa-check"></i><b>25.1.1</b> Multivariate Random Vectors</a></li>
<li class="chapter" data-level="25.1.2" data-path="basic-understanding.html"><a href="basic-understanding.html#sec-covariance-matrix-multivariate"><i class="fa fa-check"></i><b>25.1.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="25.1.3" data-path="basic-understanding.html"><a href="basic-understanding.html#equalities-in-expectation-and-variance"><i class="fa fa-check"></i><b>25.1.3</b> Equalities in Expectation and Variance</a></li>
<li class="chapter" data-level="25.1.4" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-normal-distribution-1"><i class="fa fa-check"></i><b>25.1.4</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="25.1.5" data-path="basic-understanding.html"><a href="basic-understanding.html#test-of-multivariate-normality"><i class="fa fa-check"></i><b>25.1.5</b> Test of Multivariate Normality</a></li>
<li class="chapter" data-level="25.1.6" data-path="basic-understanding.html"><a href="basic-understanding.html#mean-vector-inference"><i class="fa fa-check"></i><b>25.1.6</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="25.1.7" data-path="basic-understanding.html"><a href="basic-understanding.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>25.1.7</b> General Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>25.2</b> Multivariate Analysis of Variance</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#one-way-manova"><i class="fa fa-check"></i><b>25.2.1</b> One-Way MANOVA</a></li>
<li class="chapter" data-level="25.2.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#sec-profile-analysis"><i class="fa fa-check"></i><b>25.2.2</b> Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="statistical-test-selection-for-comparing-means.html"><a href="statistical-test-selection-for-comparing-means.html"><i class="fa fa-check"></i><b>25.3</b> Statistical Test Selection for Comparing Means</a></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="26" data-path="sec-quasi-experimental.html"><a href="sec-quasi-experimental.html"><i class="fa fa-check"></i><b>26</b> Quasi-Experimental Methods</a>
<ul>
<li class="chapter" data-level="26.1" data-path="identification-strategy-in-quasi-experiments.html"><a href="identification-strategy-in-quasi-experiments.html"><i class="fa fa-check"></i><b>26.1</b> Identification Strategy in Quasi-Experiments</a></li>
<li class="chapter" data-level="26.2" data-path="robustness-checks.html"><a href="robustness-checks.html"><i class="fa fa-check"></i><b>26.2</b> Robustness Checks</a></li>
<li class="chapter" data-level="26.3" data-path="establishing-mechanisms.html"><a href="establishing-mechanisms.html"><i class="fa fa-check"></i><b>26.3</b> Establishing Mechanisms</a></li>
<li class="chapter" data-level="26.4" data-path="limitations-of-quasi-experiments.html"><a href="limitations-of-quasi-experiments.html"><i class="fa fa-check"></i><b>26.4</b> Limitations of Quasi-Experiments</a></li>
<li class="chapter" data-level="26.5" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html"><i class="fa fa-check"></i><b>26.5</b> Assumptions for Identifying Treatment Effects</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-sutva"><i class="fa fa-check"></i><b>26.5.1</b> Stable Unit Treatment Value Assumption</a></li>
<li class="chapter" data-level="26.5.2" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-conditional-ignorability-assumption"><i class="fa fa-check"></i><b>26.5.2</b> Conditional Ignorability Assumption</a></li>
<li class="chapter" data-level="26.5.3" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-overlap-positivity-assumption"><i class="fa fa-check"></i><b>26.5.3</b> Overlap (Positivity) Assumption</a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html"><i class="fa fa-check"></i><b>26.6</b> Natural Experiments</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#the-problem-of-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.1</b> The Problem of Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.2" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#statistical-challenges-in-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.2</b> Statistical Challenges in Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.3" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#solutions-multiple-testing-corrections"><i class="fa fa-check"></i><b>26.6.3</b> Solutions: Multiple Testing Corrections</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html"><i class="fa fa-check"></i><b>26.7</b> Design vs. Model-Based Approaches</a>
<ul>
<li class="chapter" data-level="26.7.1" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-design-based"><i class="fa fa-check"></i><b>26.7.1</b> Design-Based Perspective</a></li>
<li class="chapter" data-level="26.7.2" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-model-based-perspective"><i class="fa fa-check"></i><b>26.7.2</b> Model-Based Perspective</a></li>
<li class="chapter" data-level="26.7.3" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#placing-methods-along-a-spectrum"><i class="fa fa-check"></i><b>26.7.3</b> Placing Methods Along a Spectrum</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="sec-regression-discontinuity.html"><a href="sec-regression-discontinuity.html"><i class="fa fa-check"></i><b>27</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="27.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html"><i class="fa fa-check"></i><b>27.1</b> Conceptual Framework</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html#types-of-regression-discontinuity-designs"><i class="fa fa-check"></i><b>27.1.1</b> Types of Regression Discontinuity Designs</a></li>
<li class="chapter" data-level="27.1.2" data-path="conceptual-framework.html"><a href="conceptual-framework.html#assumptions-for-rd-validity"><i class="fa fa-check"></i><b>27.1.2</b> Assumptions for RD Validity</a></li>
<li class="chapter" data-level="27.1.3" data-path="conceptual-framework.html"><a href="conceptual-framework.html#threats-to-rd-validity"><i class="fa fa-check"></i><b>27.1.3</b> Threats to RD Validity</a></li>
<li class="chapter" data-level="27.1.4" data-path="conceptual-framework.html"><a href="conceptual-framework.html#violation-of-continuity-in-covariates"><i class="fa fa-check"></i><b>27.1.4</b> Violation of Continuity in Covariates</a></li>
<li class="chapter" data-level="27.1.5" data-path="conceptual-framework.html"><a href="conceptual-framework.html#multiple-discontinuities"><i class="fa fa-check"></i><b>27.1.5</b> Multiple Discontinuities</a></li>
<li class="chapter" data-level="27.1.6" data-path="conceptual-framework.html"><a href="conceptual-framework.html#manipulation-of-the-running-variable"><i class="fa fa-check"></i><b>27.1.6</b> Manipulation of the Running Variable</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html"><i class="fa fa-check"></i><b>27.2</b> Model Estimation Strategies</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#parametric-models-polynomial-regression"><i class="fa fa-check"></i><b>27.2.1</b> Parametric Models: Polynomial Regression</a></li>
<li class="chapter" data-level="27.2.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#nonparametric-models-local-regression"><i class="fa fa-check"></i><b>27.2.2</b> Nonparametric Models: Local Regression</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="formal-definition.html"><a href="formal-definition.html"><i class="fa fa-check"></i><b>27.3</b> Formal Definition</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="formal-definition.html"><a href="formal-definition.html#identification-assumptions"><i class="fa fa-check"></i><b>27.3.1</b> Identification Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>27.4</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based-approach"><i class="fa fa-check"></i><b>27.4.1</b> Local Randomization-Based Approach</a></li>
<li class="chapter" data-level="27.4.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#sec-continuity-based-approach"><i class="fa fa-check"></i><b>27.4.2</b> Continuity-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>27.5</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="specification-checks.html"><a href="specification-checks.html#sec-balance-checks"><i class="fa fa-check"></i><b>27.5.1</b> Balance Checks</a></li>
<li class="chapter" data-level="27.5.2" data-path="specification-checks.html"><a href="specification-checks.html#sec-sorting-bunching-and-manipulation"><i class="fa fa-check"></i><b>27.5.2</b> Sorting, Bunching, and Manipulation</a></li>
<li class="chapter" data-level="27.5.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>27.5.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="27.5.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>27.5.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="27.5.5" data-path="specification-checks.html"><a href="specification-checks.html#assessing-sensitivity"><i class="fa fa-check"></i><b>27.5.5</b> Assessing Sensitivity</a></li>
<li class="chapter" data-level="27.5.6" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>27.5.6</b> Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.6</b> Fuzzy Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#compliance-types"><i class="fa fa-check"></i><b>27.6.1</b> Compliance Types</a></li>
<li class="chapter" data-level="27.6.2" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect"><i class="fa fa-check"></i><b>27.6.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.6.3" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#equivalent-representation-using-expectations"><i class="fa fa-check"></i><b>27.6.3</b> Equivalent Representation Using Expectations</a></li>
<li class="chapter" data-level="27.6.4" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimation-strategies"><i class="fa fa-check"></i><b>27.6.4</b> Estimation Strategies</a></li>
<li class="chapter" data-level="27.6.5" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#practical-considerations-6"><i class="fa fa-check"></i><b>27.6.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="27.6.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#steps-for-fuzzy-rd"><i class="fa fa-check"></i><b>27.6.6</b> Steps for Fuzzy RD</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.7</b> Sharp Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.7.1" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#assumptions-for-identification"><i class="fa fa-check"></i><b>27.7.1</b> Assumptions for Identification</a></li>
<li class="chapter" data-level="27.7.2" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect-1"><i class="fa fa-check"></i><b>27.7.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.7.3" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimation-methods"><i class="fa fa-check"></i><b>27.7.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="27.7.4" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#steps-for-sharp-rd"><i class="fa fa-check"></i><b>27.7.4</b> Steps for Sharp RD</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html"><i class="fa fa-check"></i><b>27.8</b> Regression Kink Design</a>
<ul>
<li class="chapter" data-level="27.8.1" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-sharp-regression-kink-design"><i class="fa fa-check"></i><b>27.8.1</b> Identification in Sharp Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.2" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-fuzzy-regression-kink-design"><i class="fa fa-check"></i><b>27.8.2</b> Identification in Fuzzy Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.3" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#estimation-of-rkd-effects"><i class="fa fa-check"></i><b>27.8.3</b> Estimation of RKD Effects</a></li>
<li class="chapter" data-level="27.8.4" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#robustness-checks-1"><i class="fa fa-check"></i><b>27.8.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.9" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.9</b> Multi-Cutoff Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.9.1" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#identification"><i class="fa fa-check"></i><b>27.9.1</b> Identification</a></li>
<li class="chapter" data-level="27.9.2" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#key-assumptions-1"><i class="fa fa-check"></i><b>27.9.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.9.3" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#estimation-approaches"><i class="fa fa-check"></i><b>27.9.3</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.9.4" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#robustness-checks-2"><i class="fa fa-check"></i><b>27.9.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.10" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.10</b> Multi-Score Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.10.1" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#general-framework"><i class="fa fa-check"></i><b>27.10.1</b> General Framework</a></li>
<li class="chapter" data-level="27.10.2" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#identification-1"><i class="fa fa-check"></i><b>27.10.2</b> Identification</a></li>
<li class="chapter" data-level="27.10.3" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#key-assumptions-2"><i class="fa fa-check"></i><b>27.10.3</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.10.4" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#estimation-approaches-1"><i class="fa fa-check"></i><b>27.10.4</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.10.5" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#robustness-checks-3"><i class="fa fa-check"></i><b>27.10.5</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.11" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.11</b> Evaluation of a Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.11.1" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#graphical-and-formal-evidence"><i class="fa fa-check"></i><b>27.11.1</b> Graphical and Formal Evidence</a></li>
<li class="chapter" data-level="27.11.2" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#functional-form-of-the-running-variable"><i class="fa fa-check"></i><b>27.11.2</b> Functional Form of the Running Variable</a></li>
<li class="chapter" data-level="27.11.3" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#bandwidth-selection-2"><i class="fa fa-check"></i><b>27.11.3</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="27.11.4" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#addressing-potential-confounders"><i class="fa fa-check"></i><b>27.11.4</b> Addressing Potential Confounders</a></li>
<li class="chapter" data-level="27.11.5" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#external-validity-in-rd"><i class="fa fa-check"></i><b>27.11.5</b> External Validity in RD</a></li>
</ul></li>
<li class="chapter" data-level="27.12" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html"><i class="fa fa-check"></i><b>27.12</b> Applications of RD Designs</a>
<ul>
<li class="chapter" data-level="27.12.1" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#applications-in-marketing"><i class="fa fa-check"></i><b>27.12.1</b> Applications in Marketing</a></li>
<li class="chapter" data-level="27.12.2" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#r-packages-for-rd-estimation"><i class="fa fa-check"></i><b>27.12.2</b> R Packages for RD Estimation</a></li>
<li class="chapter" data-level="27.12.3" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-regression-discontinuity-in-education"><i class="fa fa-check"></i><b>27.12.3</b> Example of Regression Discontinuity in Education</a></li>
<li class="chapter" data-level="27.12.4" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-occupational-licensing-and-market-efficiency"><i class="fa fa-check"></i><b>27.12.4</b> Example of Occupational Licensing and Market Efficiency</a></li>
<li class="chapter" data-level="27.12.5" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#replicating-carpenter2009effect"><i class="fa fa-check"></i><b>27.12.5</b> Replicating <span class="citation">(Carpenter and Dobkin 2009)</span></a></li>
<li class="chapter" data-level="27.12.6" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#additional-rd-applications"><i class="fa fa-check"></i><b>27.12.6</b> Additional RD Applications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="temporal-discontinuity-designs.html"><a href="temporal-discontinuity-designs.html"><i class="fa fa-check"></i><b>28</b> Temporal Discontinuity Designs</a>
<ul>
<li class="chapter" data-level="28.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>28.1</b> Regression Discontinuity in Time</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>28.1.1</b> Estimation and Model Selection</a></li>
<li class="chapter" data-level="28.1.2" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#strengths-of-rdit"><i class="fa fa-check"></i><b>28.1.2</b> Strengths of RDiT</a></li>
<li class="chapter" data-level="28.1.3" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#limitations-and-challenges-of-rdit"><i class="fa fa-check"></i><b>28.1.3</b> Limitations and Challenges of RDiT</a></li>
<li class="chapter" data-level="28.1.4" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#recommendations-for-robustness-checks"><i class="fa fa-check"></i><b>28.1.4</b> Recommendations for Robustness Checks</a></li>
<li class="chapter" data-level="28.1.5" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#applications-of-rdit"><i class="fa fa-check"></i><b>28.1.5</b> Applications of RDiT</a></li>
<li class="chapter" data-level="28.1.6" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#empirical-example"><i class="fa fa-check"></i><b>28.1.6</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html"><i class="fa fa-check"></i><b>28.2</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#advantages-of-its"><i class="fa fa-check"></i><b>28.2.1</b> Advantages of ITS</a></li>
<li class="chapter" data-level="28.2.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#limitations-of-its"><i class="fa fa-check"></i><b>28.2.2</b> Limitations of ITS</a></li>
<li class="chapter" data-level="28.2.3" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#empirical-example-1"><i class="fa fa-check"></i><b>28.2.3</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html"><i class="fa fa-check"></i><b>28.3</b> Combining both RDiT and ITS</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#augment-an-its-model-with-a-local-discontinuity-term"><i class="fa fa-check"></i><b>28.3.1</b> Augment an ITS Model with a Local Discontinuity Term</a></li>
<li class="chapter" data-level="28.3.2" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#two-stage-or-multi-stage-modeling"><i class="fa fa-check"></i><b>28.3.2</b> Two-Stage (or Multi-Stage) Modeling</a></li>
<li class="chapter" data-level="28.3.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#hierarchical-or-multi-level-modeling"><i class="fa fa-check"></i><b>28.3.3</b> Hierarchical or Multi-Level Modeling</a></li>
<li class="chapter" data-level="28.3.4" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#empirical-example-2"><i class="fa fa-check"></i><b>28.3.4</b> Empirical Example</a></li>
<li class="chapter" data-level="28.3.5" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#practical-guidance"><i class="fa fa-check"></i><b>28.3.5</b> Practical Guidance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="sec-synthetic-difference-in-differences.html"><a href="sec-synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>29</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="29.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>29.1</b> Understanding</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="understanding.html"><a href="understanding.html#steps-in-sdid-estimation"><i class="fa fa-check"></i><b>29.1.1</b> Steps in SDID Estimation</a></li>
<li class="chapter" data-level="29.1.2" data-path="understanding.html"><a href="understanding.html#comparison-of-methods-1"><i class="fa fa-check"></i><b>29.1.2</b> Comparison of Methods</a></li>
<li class="chapter" data-level="29.1.3" data-path="understanding.html"><a href="understanding.html#why-use-weights"><i class="fa fa-check"></i><b>29.1.3</b> <strong>Why Use Weights?</strong></a></li>
<li class="chapter" data-level="29.1.4" data-path="understanding.html"><a href="understanding.html#benefits-of-localization-in-sdid"><i class="fa fa-check"></i><b>29.1.4</b> <strong>Benefits of Localization in SDID</strong></a></li>
<li class="chapter" data-level="29.1.5" data-path="understanding.html"><a href="understanding.html#designing-sdid-weights"><i class="fa fa-check"></i><b>29.1.5</b> <strong>Designing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.6" data-path="understanding.html"><a href="understanding.html#how-sdid-enhances-dids-plausibility"><i class="fa fa-check"></i><b>29.1.6</b> <strong>How SDID Enhances DID’s Plausibility</strong></a></li>
<li class="chapter" data-level="29.1.7" data-path="understanding.html"><a href="understanding.html#choosing-sdid-weights"><i class="fa fa-check"></i><b>29.1.7</b> <strong>Choosing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.8" data-path="understanding.html"><a href="understanding.html#accounting-for-time-varying-covariates-in-weight-estimation"><i class="fa fa-check"></i><b>29.1.8</b> <strong>Accounting for Time-Varying Covariates in Weight Estimation</strong></a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="application-3.html"><a href="application-3.html"><i class="fa fa-check"></i><b>29.2</b> Application</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="application-3.html"><a href="application-3.html#block-treatment"><i class="fa fa-check"></i><b>29.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="29.2.2" data-path="application-3.html"><a href="application-3.html#staggered-adoption"><i class="fa fa-check"></i><b>29.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="sec-difference-in-differences.html"><a href="sec-difference-in-differences.html"><i class="fa fa-check"></i><b>30</b> Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.1" data-path="empirical-studies.html"><a href="empirical-studies.html"><i class="fa fa-check"></i><b>30.1</b> Empirical Studies</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-marketing"><i class="fa fa-check"></i><b>30.1.1</b> Applications of DID in Marketing</a></li>
<li class="chapter" data-level="30.1.2" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-economics"><i class="fa fa-check"></i><b>30.1.2</b> Applications of DID in Economics</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>30.2</b> Visualization</a></li>
<li class="chapter" data-level="30.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html"><i class="fa fa-check"></i><b>30.3</b> Simple Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#basic-setup-of-did"><i class="fa fa-check"></i><b>30.3.1</b> Basic Setup of DID</a></li>
<li class="chapter" data-level="30.3.2" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#extensions-of-did"><i class="fa fa-check"></i><b>30.3.2</b> Extensions of DID</a></li>
<li class="chapter" data-level="30.3.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#goals-of-did"><i class="fa fa-check"></i><b>30.3.3</b> Goals of DID</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html"><i class="fa fa-check"></i><b>30.4</b> Empirical Research Walkthrough</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-unintended-consequences-of-ban-the-box-policies"><i class="fa fa-check"></i><b>30.4.1</b> Example: The Unintended Consequences of “Ban the Box” Policies</a></li>
<li class="chapter" data-level="30.4.2" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-minimum-wage-and-employment"><i class="fa fa-check"></i><b>30.4.2</b> Example: Minimum Wage and Employment</a></li>
<li class="chapter" data-level="30.4.3" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-effects-of-grade-policies-on-major-choice"><i class="fa fa-check"></i><b>30.4.3</b> Example: The Effects of Grade Policies on Major Choice</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>30.5</b> One Difference</a></li>
<li class="chapter" data-level="30.6" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html"><i class="fa fa-check"></i><b>30.6</b> Two-Way Fixed Effects</a>
<ul>
<li class="chapter" data-level="30.6.1" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#canonical-twfe-model"><i class="fa fa-check"></i><b>30.6.1</b> Canonical TWFE Model</a></li>
<li class="chapter" data-level="30.6.2" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#limitations-of-twfe"><i class="fa fa-check"></i><b>30.6.2</b> Limitations of TWFE</a></li>
<li class="chapter" data-level="30.6.3" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#diagnosing-and-addressing-bias-in-twfe"><i class="fa fa-check"></i><b>30.6.3</b> Diagnosing and Addressing Bias in TWFE</a></li>
<li class="chapter" data-level="30.6.4" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#remedies-for-twfes-shortcomings"><i class="fa fa-check"></i><b>30.6.4</b> Remedies for TWFE’s Shortcomings</a></li>
<li class="chapter" data-level="30.6.5" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#best-practices-and-recommendations"><i class="fa fa-check"></i><b>30.6.5</b> Best Practices and Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>30.7</b> Multiple Periods and Variation in Treatment Timing</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html#sec-staggered-difference-in-differences"><i class="fa fa-check"></i><b>30.7.1</b> Staggered Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html"><i class="fa fa-check"></i><b>30.8</b> Modern Estimators for Staggered Adoption</a>
<ul>
<li class="chapter" data-level="30.8.1" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-group-time-average-treatment-effects-callaway2021difference"><i class="fa fa-check"></i><b>30.8.1</b> Group-Time Average Treatment Effects <span class="citation">(Callaway and Sant’Anna 2021)</span></a></li>
<li class="chapter" data-level="30.8.2" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-cohort-average-treatment-effects-sun2021estimating"><i class="fa fa-check"></i><b>30.8.2</b> Cohort Average Treatment Effects <span class="citation">(L. Sun and Abraham 2021)</span></a></li>
<li class="chapter" data-level="30.8.3" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-stacked-difference-in-differences"><i class="fa fa-check"></i><b>30.8.3</b> Stacked Difference-in-Differences</a></li>
<li class="chapter" data-level="30.8.4" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#did-with-in-and-out-treatment-condition"><i class="fa fa-check"></i><b>30.8.4</b> DID with in and out treatment condition</a></li>
<li class="chapter" data-level="30.8.5" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-reshaped-inverse-probability-weighting-twfe-estimator"><i class="fa fa-check"></i><b>30.8.5</b> Reshaped Inverse Probability Weighting - TWFE Estimator</a></li>
<li class="chapter" data-level="30.8.6" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#gardner2022two-and-borusyak2024revisiting"><i class="fa fa-check"></i><b>30.8.6</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2024)</span></a></li>
<li class="chapter" data-level="30.8.7" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#de2020two"><i class="fa fa-check"></i><b>30.8.7</b> <span class="citation">Clément De Chaisemartin and d’Haultfoeuille (2020)</span></a></li>
<li class="chapter" data-level="30.8.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#augmentedforward-did"><i class="fa fa-check"></i><b>30.8.8</b> Augmented/Forward DID</a></li>
<li class="chapter" data-level="30.8.9" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#doubly-robust-difference-in-differences-estimators"><i class="fa fa-check"></i><b>30.8.9</b> Doubly Robust Difference-in-Differences Estimators</a></li>
<li class="chapter" data-level="30.8.10" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#nonlinear-difference-in-differences"><i class="fa fa-check"></i><b>30.8.10</b> Nonlinear Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.9" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>30.9</b> Multiple Treatments</a>
<ul>
<li class="chapter" data-level="30.9.1" data-path="multiple-treatments.html"><a href="multiple-treatments.html#multiple-treatment-groups-model-specification"><i class="fa fa-check"></i><b>30.9.1</b> Multiple Treatment Groups: Model Specification</a></li>
<li class="chapter" data-level="30.9.2" data-path="multiple-treatments.html"><a href="multiple-treatments.html#understanding-the-control-group-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.2</b> Understanding the Control Group in Multiple Treatment DiD</a></li>
<li class="chapter" data-level="30.9.3" data-path="multiple-treatments.html"><a href="multiple-treatments.html#alternative-approaches-separate-regressions-vs.-one-model"><i class="fa fa-check"></i><b>30.9.3</b> Alternative Approaches: Separate Regressions vs. One Model</a></li>
<li class="chapter" data-level="30.9.4" data-path="multiple-treatments.html"><a href="multiple-treatments.html#handling-treatment-intensity"><i class="fa fa-check"></i><b>30.9.4</b> Handling Treatment Intensity</a></li>
<li class="chapter" data-level="30.9.5" data-path="multiple-treatments.html"><a href="multiple-treatments.html#considerations-when-individuals-can-move-between-treatment-groups"><i class="fa fa-check"></i><b>30.9.5</b> Considerations When Individuals Can Move Between Treatment Groups</a></li>
<li class="chapter" data-level="30.9.6" data-path="multiple-treatments.html"><a href="multiple-treatments.html#parallel-trends-assumption-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.6</b> Parallel Trends Assumption in Multiple-Treatment DiD</a></li>
</ul></li>
<li class="chapter" data-level="30.10" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>30.10</b> Mediation Under DiD</a>
<ul>
<li class="chapter" data-level="30.10.1" data-path="mediation-under-did.html"><a href="mediation-under-did.html#mediation-model-in-did"><i class="fa fa-check"></i><b>30.10.1</b> Mediation Model in DiD</a></li>
<li class="chapter" data-level="30.10.2" data-path="mediation-under-did.html"><a href="mediation-under-did.html#interpreting-the-results"><i class="fa fa-check"></i><b>30.10.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="30.10.3" data-path="mediation-under-did.html"><a href="mediation-under-did.html#challenges-in-mediation-analysis-for-did"><i class="fa fa-check"></i><b>30.10.3</b> Challenges in Mediation Analysis for DiD</a></li>
<li class="chapter" data-level="30.10.4" data-path="mediation-under-did.html"><a href="mediation-under-did.html#alternative-approach-instrumental-variables-for-mediation"><i class="fa fa-check"></i><b>30.10.4</b> Alternative Approach: Instrumental Variables for Mediation</a></li>
</ul></li>
<li class="chapter" data-level="30.11" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>30.11</b> Assumptions</a>
<ul>
<li class="chapter" data-level="30.11.1" data-path="assumptions-2.html"><a href="assumptions-2.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>30.11.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="30.11.2" data-path="assumptions-2.html"><a href="assumptions-2.html#sec-placebo-test-did"><i class="fa fa-check"></i><b>30.11.2</b> Placebo Test</a></li>
</ul></li>
<li class="chapter" data-level="30.12" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html"><i class="fa fa-check"></i><b>30.12</b> Robustness Checks</a>
<ul>
<li class="chapter" data-level="30.12.1" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#robustness-checks-to-strengthen-causal-interpretation"><i class="fa fa-check"></i><b>30.12.1</b> Robustness Checks to Strengthen Causal Interpretation</a></li>
<li class="chapter" data-level="30.12.2" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#best-practices-for-reliable-did-implementation"><i class="fa fa-check"></i><b>30.12.2</b> Best Practices for Reliable DiD Implementation</a></li>
</ul></li>
<li class="chapter" data-level="30.13" data-path="concerns-in-did.html"><a href="concerns-in-did.html"><i class="fa fa-check"></i><b>30.13</b> Concerns in DID</a>
<ul>
<li class="chapter" data-level="30.13.1" data-path="concerns-in-did.html"><a href="concerns-in-did.html#matching-methods-in-did"><i class="fa fa-check"></i><b>30.13.1</b> Matching Methods in DID</a></li>
<li class="chapter" data-level="30.13.2" data-path="concerns-in-did.html"><a href="concerns-in-did.html#control-variables-in-did"><i class="fa fa-check"></i><b>30.13.2</b> Control Variables in DID</a></li>
<li class="chapter" data-level="30.13.3" data-path="concerns-in-did.html"><a href="concerns-in-did.html#did-for-count-data-fixed-effects-poisson-model"><i class="fa fa-check"></i><b>30.13.3</b> DID for Count Data: Fixed-Effects Poisson Model</a></li>
<li class="chapter" data-level="30.13.4" data-path="concerns-in-did.html"><a href="concerns-in-did.html#handling-zero-valued-outcomes-in-did"><i class="fa fa-check"></i><b>30.13.4</b> Handling Zero-Valued Outcomes in DID</a></li>
<li class="chapter" data-level="30.13.5" data-path="concerns-in-did.html"><a href="concerns-in-did.html#standard-errors-1"><i class="fa fa-check"></i><b>30.13.5</b> Standard Errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="sec-changes-in-changes.html"><a href="sec-changes-in-changes.html"><i class="fa fa-check"></i><b>31</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="31.1" data-path="key-concepts.html"><a href="key-concepts.html"><i class="fa fa-check"></i><b>31.1</b> Key Concepts</a></li>
<li class="chapter" data-level="31.2" data-path="estimating-qtt-with-cic.html"><a href="estimating-qtt-with-cic.html"><i class="fa fa-check"></i><b>31.2</b> Estimating QTT with CiC</a></li>
<li class="chapter" data-level="31.3" data-path="application-4.html"><a href="application-4.html"><i class="fa fa-check"></i><b>31.3</b> Application</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="application-4.html"><a href="application-4.html#ecic-package"><i class="fa fa-check"></i><b>31.3.1</b> ECIC package</a></li>
<li class="chapter" data-level="31.3.2" data-path="application-4.html"><a href="application-4.html#qte-package"><i class="fa fa-check"></i><b>31.3.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="sec-synthetic-control.html"><a href="sec-synthetic-control.html"><i class="fa fa-check"></i><b>32</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.1" data-path="marketing-applications.html"><a href="marketing-applications.html"><i class="fa fa-check"></i><b>32.1</b> Marketing Applications</a></li>
<li class="chapter" data-level="32.2" data-path="key-features-of-scm.html"><a href="key-features-of-scm.html"><i class="fa fa-check"></i><b>32.2</b> Key Features of SCM</a></li>
<li class="chapter" data-level="32.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html"><i class="fa fa-check"></i><b>32.3</b> Advantages of SCM</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-did"><i class="fa fa-check"></i><b>32.3.1</b> Compared to DiD</a></li>
<li class="chapter" data-level="32.3.2" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-linear-regression"><i class="fa fa-check"></i><b>32.3.2</b> Compared to Linear Regression</a></li>
<li class="chapter" data-level="32.3.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#additional-advantages"><i class="fa fa-check"></i><b>32.3.3</b> Additional Advantages</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="disadvantages-of-scm.html"><a href="disadvantages-of-scm.html"><i class="fa fa-check"></i><b>32.4</b> Disadvantages of SCM</a></li>
<li class="chapter" data-level="32.5" data-path="assumptions-3.html"><a href="assumptions-3.html"><i class="fa fa-check"></i><b>32.5</b> Assumptions</a></li>
<li class="chapter" data-level="32.6" data-path="estimation-3.html"><a href="estimation-3.html"><i class="fa fa-check"></i><b>32.6</b> Estimation</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="estimation-3.html"><a href="estimation-3.html#constructing-the-synthetic-control"><i class="fa fa-check"></i><b>32.6.1</b> Constructing the Synthetic Control</a></li>
<li class="chapter" data-level="32.6.2" data-path="estimation-3.html"><a href="estimation-3.html#penalized-synthetic-control"><i class="fa fa-check"></i><b>32.6.2</b> Penalized Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="theoretical-considerations.html"><a href="theoretical-considerations.html"><i class="fa fa-check"></i><b>32.7</b> Theoretical Considerations</a></li>
<li class="chapter" data-level="32.8" data-path="inference-in-scm.html"><a href="inference-in-scm.html"><i class="fa fa-check"></i><b>32.8</b> Inference in SCM</a>
<ul>
<li class="chapter" data-level="32.8.1" data-path="inference-in-scm.html"><a href="inference-in-scm.html#permutation-placebo-inference"><i class="fa fa-check"></i><b>32.8.1</b> Permutation (Placebo) Inference</a></li>
<li class="chapter" data-level="32.8.2" data-path="inference-in-scm.html"><a href="inference-in-scm.html#one-sided-inference"><i class="fa fa-check"></i><b>32.8.2</b> One-Sided Inference</a></li>
</ul></li>
<li class="chapter" data-level="32.9" data-path="sec-augmented-synthetic-control.html"><a href="sec-augmented-synthetic-control.html"><i class="fa fa-check"></i><b>32.9</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="32.10" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>32.10</b> Synthetic Control with Staggered Adoption</a>
<ul>
<li class="chapter" data-level="32.10.1" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html#partially-pooled-synthetic-control"><i class="fa fa-check"></i><b>32.10.1</b> Partially Pooled Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.11" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>32.11</b> Generalized Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.11.1" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#the-problem-with-traditional-methods"><i class="fa fa-check"></i><b>32.11.1</b> The Problem with Traditional Methods</a></li>
<li class="chapter" data-level="32.11.2" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#generalized-synthetic-control-model"><i class="fa fa-check"></i><b>32.11.2</b> Generalized Synthetic Control Model</a></li>
<li class="chapter" data-level="32.11.3" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#identification-and-estimation"><i class="fa fa-check"></i><b>32.11.3</b> Identification and Estimation</a></li>
<li class="chapter" data-level="32.11.4" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#bootstrap-procedure-for-standard-errors"><i class="fa fa-check"></i><b>32.11.4</b> Bootstrap Procedure for Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="32.12" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>32.12</b> Bayesian Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.12.1" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-causal-inference-framework"><i class="fa fa-check"></i><b>32.12.1</b> Bayesian Causal Inference Framework</a></li>
<li class="chapter" data-level="32.12.2" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-dynamic-multilevel-factor-model"><i class="fa fa-check"></i><b>32.12.2</b> Bayesian Dynamic Multilevel Factor Model</a></li>
<li class="chapter" data-level="32.12.3" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-sparse-synthetic-control"><i class="fa fa-check"></i><b>32.12.3</b> Bayesian Sparse Synthetic Control</a></li>
<li class="chapter" data-level="32.12.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-inference-and-mcmc-estimation"><i class="fa fa-check"></i><b>32.12.4</b> Bayesian Inference and MCMC Estimation</a></li>
</ul></li>
<li class="chapter" data-level="32.13" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><i class="fa fa-check"></i><b>32.13</b> Using Multiple Outcomes to Improve the Synthetic Control Method</a>
<ul>
<li class="chapter" data-level="32.13.1" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#standard-synthetic-control-method"><i class="fa fa-check"></i><b>32.13.1</b> Standard Synthetic Control Method</a></li>
<li class="chapter" data-level="32.13.2" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#using-multiple-outcomes-for-bias-reduction"><i class="fa fa-check"></i><b>32.13.2</b> Using Multiple Outcomes for Bias Reduction</a></li>
<li class="chapter" data-level="32.13.3" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#estimation-methods-1"><i class="fa fa-check"></i><b>32.13.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="32.13.4" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#empirical-application-flint-water-crisis"><i class="fa fa-check"></i><b>32.13.4</b> Empirical Application: Flint Water Crisis</a></li>
</ul></li>
<li class="chapter" data-level="32.14" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>32.14</b> Applications</a>
<ul>
<li class="chapter" data-level="32.14.1" data-path="applications.html"><a href="applications.html#synthetic-control-estimation"><i class="fa fa-check"></i><b>32.14.1</b> Synthetic Control Estimation</a></li>
<li class="chapter" data-level="32.14.2" data-path="applications.html"><a href="applications.html#the-basque-country-policy-change"><i class="fa fa-check"></i><b>32.14.2</b> The Basque Country Policy Change</a></li>
<li class="chapter" data-level="32.14.3" data-path="applications.html"><a href="applications.html#micro-synthetic-control-with-microsynth"><i class="fa fa-check"></i><b>32.14.3</b> Micro-Synthetic Control with <code>microsynth</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="sec-event-studies.html"><a href="sec-event-studies.html"><i class="fa fa-check"></i><b>33</b> Event Studies</a>
<ul>
<li class="chapter" data-level="33.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html"><i class="fa fa-check"></i><b>33.1</b> Review of Event Studies Across Disciplines</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#finance-applications"><i class="fa fa-check"></i><b>33.1.1</b> Finance Applications</a></li>
<li class="chapter" data-level="33.1.2" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#management-applications"><i class="fa fa-check"></i><b>33.1.2</b> Management Applications</a></li>
<li class="chapter" data-level="33.1.3" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#marketing-applications-1"><i class="fa fa-check"></i><b>33.1.3</b> Marketing Applications</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="key-assumptions-3.html"><a href="key-assumptions-3.html"><i class="fa fa-check"></i><b>33.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="33.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html"><i class="fa fa-check"></i><b>33.3</b> Steps for Conducting an Event Study</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-1-event-identification"><i class="fa fa-check"></i><b>33.3.1</b> Step 1: Event Identification</a></li>
<li class="chapter" data-level="33.3.2" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-2-define-the-event-and-estimation-windows"><i class="fa fa-check"></i><b>33.3.2</b> Step 2: Define the Event and Estimation Windows</a></li>
<li class="chapter" data-level="33.3.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-3-compute-normal-vs.-abnormal-returns"><i class="fa fa-check"></i><b>33.3.3</b> Step 3: Compute Normal vs. Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.4" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-4-compute-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.3.4</b> Step 4: Compute Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.5" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-5-statistical-tests-for-significance"><i class="fa fa-check"></i><b>33.3.5</b> Step 5: Statistical Tests for Significance</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html"><i class="fa fa-check"></i><b>33.4</b> Event Studies in Marketing</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#definition"><i class="fa fa-check"></i><b>33.4.1</b> Definition</a></li>
<li class="chapter" data-level="33.4.2" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#when-can-marketing-events-affect-non-operating-assets-or-debt"><i class="fa fa-check"></i><b>33.4.2</b> When Can Marketing Events Affect Non-Operating Assets or Debt?</a></li>
<li class="chapter" data-level="33.4.3" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#calculating-the-leverage-effect"><i class="fa fa-check"></i><b>33.4.3</b> Calculating the Leverage Effect</a></li>
<li class="chapter" data-level="33.4.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#computing-leverage-effect-from-compustat-data"><i class="fa fa-check"></i><b>33.4.4</b> Computing Leverage Effect from Compustat Data</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="economic-significance.html"><a href="economic-significance.html"><i class="fa fa-check"></i><b>33.5</b> Economic Significance</a></li>
<li class="chapter" data-level="33.6" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html"><i class="fa fa-check"></i><b>33.6</b> Testing in Event Studies</a>
<ul>
<li class="chapter" data-level="33.6.1" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#statistical-power-in-event-studies"><i class="fa fa-check"></i><b>33.6.1</b> Statistical Power in Event Studies</a></li>
<li class="chapter" data-level="33.6.2" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#parametric-tests"><i class="fa fa-check"></i><b>33.6.2</b> Parametric Tests</a></li>
<li class="chapter" data-level="33.6.3" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#non-parametric-tests-1"><i class="fa fa-check"></i><b>33.6.3</b> Non-Parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.7" data-path="sample-in-event-studies.html"><a href="sample-in-event-studies.html"><i class="fa fa-check"></i><b>33.7</b> Sample in Event Studies</a></li>
<li class="chapter" data-level="33.8" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html"><i class="fa fa-check"></i><b>33.8</b> Confounders in Event Studies</a>
<ul>
<li class="chapter" data-level="33.8.1" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#types-of-confounding-events"><i class="fa fa-check"></i><b>33.8.1</b> Types of Confounding Events</a></li>
<li class="chapter" data-level="33.8.2" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#should-we-exclude-confounded-observations"><i class="fa fa-check"></i><b>33.8.2</b> Should We Exclude Confounded Observations?</a></li>
<li class="chapter" data-level="33.8.3" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#simulation-study-should-we-exclude-correlated-and-uncorrelated-events"><i class="fa fa-check"></i><b>33.8.3</b> Simulation Study: Should We Exclude Correlated and Uncorrelated Events?</a></li>
</ul></li>
<li class="chapter" data-level="33.9" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html"><i class="fa fa-check"></i><b>33.9</b> Biases in Event Studies</a>
<ul>
<li class="chapter" data-level="33.9.1" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#timing-bias-different-market-closing-times"><i class="fa fa-check"></i><b>33.9.1</b> Timing Bias: Different Market Closing Times</a></li>
<li class="chapter" data-level="33.9.2" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#upward-bias-in-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.9.2</b> Upward Bias in Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.9.3" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#cross-sectional-dependence-bias"><i class="fa fa-check"></i><b>33.9.3</b> Cross-Sectional Dependence Bias</a></li>
<li class="chapter" data-level="33.9.4" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#sample-selection-bias"><i class="fa fa-check"></i><b>33.9.4</b> Sample Selection Bias</a></li>
<li class="chapter" data-level="33.9.5" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#corrections-for-sample-selection-bias"><i class="fa fa-check"></i><b>33.9.5</b> Corrections for Sample Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="33.10" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>33.10</b> Long-run Event Studies</a>
<ul>
<li class="chapter" data-level="33.10.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#sec-buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>33.10.1</b> Buy-and-Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="33.10.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>33.10.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="33.10.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>33.10.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="33.11" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>33.11</b> Aggregation</a>
<ul>
<li class="chapter" data-level="33.11.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>33.11.1</b> Over Time</a></li>
<li class="chapter" data-level="33.11.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-and-over-time"><i class="fa fa-check"></i><b>33.11.2</b> Across Firms and Over Time</a></li>
<li class="chapter" data-level="33.11.3" data-path="aggregation.html"><a href="aggregation.html#statistical-tests-1"><i class="fa fa-check"></i><b>33.11.3</b> Statistical Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.12" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>33.12</b> Heterogeneity in the Event Effect</a>
<ul>
<li class="chapter" data-level="33.12.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-affecting-car-in-marketing-and-finance"><i class="fa fa-check"></i><b>33.12.1</b> Common Variables Affecting CAR in Marketing and Finance</a></li>
</ul></li>
<li class="chapter" data-level="33.13" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>33.13</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="33.13.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.1</b> <strong>Statistical Models for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.13.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.2</b> <strong>Economic Models for Expected Returns</strong></a></li>
</ul></li>
<li class="chapter" data-level="33.14" data-path="application-of-event-study.html"><a href="application-of-event-study.html"><i class="fa fa-check"></i><b>33.14</b> Application of Event Study</a>
<ul>
<li class="chapter" data-level="33.14.1" data-path="application-of-event-study.html"><a href="application-of-event-study.html#sorting-portfolios-for-expected-returns"><i class="fa fa-check"></i><b>33.14.1</b> <strong>Sorting Portfolios for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.14.2" data-path="application-of-event-study.html"><a href="application-of-event-study.html#erer-package"><i class="fa fa-check"></i><b>33.14.2</b> <strong><code>erer</code> Package</strong></a></li>
<li class="chapter" data-level="33.14.3" data-path="application-of-event-study.html"><a href="application-of-event-study.html#eventus"><i class="fa fa-check"></i><b>33.14.3</b> Eventus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="sec-instrumental-variables.html"><a href="sec-instrumental-variables.html"><i class="fa fa-check"></i><b>34</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.1" data-path="challenges-with-instrumental-variables.html"><a href="challenges-with-instrumental-variables.html"><i class="fa fa-check"></i><b>34.1</b> Challenges with Instrumental Variables</a></li>
<li class="chapter" data-level="34.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html"><i class="fa fa-check"></i><b>34.2</b> Framework for Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#constant-treatment-effect-model"><i class="fa fa-check"></i><b>34.2.1</b> Constant-Treatment-Effect Model</a></li>
<li class="chapter" data-level="34.2.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#instrumental-variable-solution"><i class="fa fa-check"></i><b>34.2.2</b> Instrumental Variable Solution</a></li>
<li class="chapter" data-level="34.2.3" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#heterogeneous-treatment-effects-and-the-late-framework"><i class="fa fa-check"></i><b>34.2.3</b> Heterogeneous Treatment Effects and the LATE Framework</a></li>
<li class="chapter" data-level="34.2.4" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#assumptions-for-late-identification"><i class="fa fa-check"></i><b>34.2.4</b> Assumptions for LATE Identification</a></li>
<li class="chapter" data-level="34.2.5" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#local-average-treatment-effect-theorem"><i class="fa fa-check"></i><b>34.2.5</b> Local Average Treatment Effect Theorem</a></li>
<li class="chapter" data-level="34.2.6" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#iv-in-randomized-trials-noncompliance"><i class="fa fa-check"></i><b>34.2.6</b> IV in Randomized Trials (Noncompliance)</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="sec-estimation.html"><a href="sec-estimation.html"><i class="fa fa-check"></i><b>34.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-two-stage-least-squares-estimation"><i class="fa fa-check"></i><b>34.3.1</b> Two-Stage Least Squares Estimation</a></li>
<li class="chapter" data-level="34.3.2" data-path="sec-estimation.html"><a href="sec-estimation.html#iv-gmm"><i class="fa fa-check"></i><b>34.3.2</b> IV-GMM</a></li>
<li class="chapter" data-level="34.3.3" data-path="sec-estimation.html"><a href="sec-estimation.html#limited-information-maximum-likelihood"><i class="fa fa-check"></i><b>34.3.3</b> Limited Information Maximum Likelihood</a></li>
<li class="chapter" data-level="34.3.4" data-path="sec-estimation.html"><a href="sec-estimation.html#jackknife-iv"><i class="fa fa-check"></i><b>34.3.4</b> Jackknife IV</a></li>
<li class="chapter" data-level="34.3.5" data-path="sec-estimation.html"><a href="sec-estimation.html#control-function-approach"><i class="fa fa-check"></i><b>34.3.5</b> Control Function Approach</a></li>
<li class="chapter" data-level="34.3.6" data-path="sec-estimation.html"><a href="sec-estimation.html#fuller-and-bias-reduced-iv"><i class="fa fa-check"></i><b>34.3.6</b> Fuller and Bias-Reduced IV</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html"><i class="fa fa-check"></i><b>34.4</b> Asymptotic Properties of the IV Estimator</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#sec-consistency-iv"><i class="fa fa-check"></i><b>34.4.1</b> Consistency</a></li>
<li class="chapter" data-level="34.4.2" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-normality-1"><i class="fa fa-check"></i><b>34.4.2</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="34.4.3" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-efficiency-1"><i class="fa fa-check"></i><b>34.4.3</b> Asymptotic Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html"><i class="fa fa-check"></i><b>34.5</b> Inference</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#weak-instruments-problem"><i class="fa fa-check"></i><b>34.5.1</b> Weak Instruments Problem</a></li>
<li class="chapter" data-level="34.5.2" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#solutions-and-approaches-for-valid-inference"><i class="fa fa-check"></i><b>34.5.2</b> Solutions and Approaches for Valid Inference</a></li>
<li class="chapter" data-level="34.5.3" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-anderson-rubin-approach"><i class="fa fa-check"></i><b>34.5.3</b> Anderson-Rubin Approach</a></li>
<li class="chapter" data-level="34.5.4" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-tf-procedure"><i class="fa fa-check"></i><b>34.5.4</b> tF Procedure</a></li>
<li class="chapter" data-level="34.5.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-ak-approach"><i class="fa fa-check"></i><b>34.5.5</b> AK Approach</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>34.6</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="34.6.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-relevance-assumption"><i class="fa fa-check"></i><b>34.6.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="34.6.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#independence-unconfoundedness"><i class="fa fa-check"></i><b>34.6.2</b> Independence (Unconfoundedness)</a></li>
<li class="chapter" data-level="34.6.3" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-monotonicity-assumption"><i class="fa fa-check"></i><b>34.6.3</b> Monotonicity Assumption</a></li>
<li class="chapter" data-level="34.6.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html#homogeneous-treatment-effects-optional"><i class="fa fa-check"></i><b>34.6.4</b> Homogeneous Treatment Effects (Optional)</a></li>
<li class="chapter" data-level="34.6.5" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-linearity-and-additivity"><i class="fa fa-check"></i><b>34.6.5</b> Linearity and Additivity</a></li>
<li class="chapter" data-level="34.6.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html#instrument-exogeneity-exclusion-restriction"><i class="fa fa-check"></i><b>34.6.6</b> Instrument Exogeneity (Exclusion Restriction)</a></li>
<li class="chapter" data-level="34.6.7" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-exogeneity-assumption"><i class="fa fa-check"></i><b>34.6.7</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html"><i class="fa fa-check"></i><b>34.7</b> Negative <span class="math inline">\(R^2\)</span> in IV</a>
<ul>
<li class="chapter" data-level="34.7.1" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-does-r2-lose-its-meaning-in-iv-regression"><i class="fa fa-check"></i><b>34.7.1</b> Why Does <span class="math inline">\(R^2\)</span> Lose Its Meaning in IV Regression?</a></li>
<li class="chapter" data-level="34.7.2" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-r2-can-be-negative"><i class="fa fa-check"></i><b>34.7.2</b> Why <span class="math inline">\(R^2\)</span> Can Be Negative:</a></li>
<li class="chapter" data-level="34.7.3" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-we-dont-care-about-r2-in-iv"><i class="fa fa-check"></i><b>34.7.3</b> Why We Don’t Care About <span class="math inline">\(R^2\)</span> in IV</a></li>
<li class="chapter" data-level="34.7.4" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#technical-details-on-r2"><i class="fa fa-check"></i><b>34.7.4</b> Technical Details on <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="34.8" data-path="treatment-intensity.html"><a href="treatment-intensity.html"><i class="fa fa-check"></i><b>34.8</b> Treatment Intensity</a>
<ul>
<li class="chapter" data-level="34.8.1" data-path="treatment-intensity.html"><a href="treatment-intensity.html#example-schooling-and-earnings"><i class="fa fa-check"></i><b>34.8.1</b> Example: Schooling and Earnings</a></li>
<li class="chapter" data-level="34.8.2" data-path="treatment-intensity.html"><a href="treatment-intensity.html#causal-interpretation-of-rho"><i class="fa fa-check"></i><b>34.8.2</b> Causal Interpretation of <span class="math inline">\(\rho\)</span></a></li>
</ul></li>
<li class="chapter" data-level="34.9" data-path="emerging-research-1.html"><a href="emerging-research-1.html"><i class="fa fa-check"></i><b>34.9</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="34.9.1" data-path="emerging-research-1.html"><a href="emerging-research-1.html#heterogeneous-effects-in-iv-estimation"><i class="fa fa-check"></i><b>34.9.1</b> Heterogeneous Effects in IV Estimation</a></li>
<li class="chapter" data-level="34.9.2" data-path="emerging-research-1.html"><a href="emerging-research-1.html#zero-valued-outcomes"><i class="fa fa-check"></i><b>34.9.2</b> Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="sec-matching-methods.html"><a href="sec-matching-methods.html"><i class="fa fa-check"></i><b>35</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="35.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html"><i class="fa fa-check"></i><b>35.1</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchit"><i class="fa fa-check"></i><b>35.1.1</b> MatchIt</a></li>
<li class="chapter" data-level="35.1.2" data-path="selection-on-observables.html"><a href="selection-on-observables.html#designmatch"><i class="fa fa-check"></i><b>35.1.2</b> designmatch</a></li>
<li class="chapter" data-level="35.1.3" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>35.1.3</b> MatchingFrontier</a></li>
<li class="chapter" data-level="35.1.4" data-path="selection-on-observables.html"><a href="selection-on-observables.html#sec-propensity-scores"><i class="fa fa-check"></i><b>35.1.4</b> Propensity Scores</a></li>
<li class="chapter" data-level="35.1.5" data-path="selection-on-observables.html"><a href="selection-on-observables.html#mahalanobis-distance"><i class="fa fa-check"></i><b>35.1.5</b> Mahalanobis Distance</a></li>
<li class="chapter" data-level="35.1.6" data-path="selection-on-observables.html"><a href="selection-on-observables.html#coarsened-exact-matching"><i class="fa fa-check"></i><b>35.1.6</b> Coarsened Exact Matching</a></li>
<li class="chapter" data-level="35.1.7" data-path="selection-on-observables.html"><a href="selection-on-observables.html#genetic-matching"><i class="fa fa-check"></i><b>35.1.7</b> Genetic Matching</a></li>
<li class="chapter" data-level="35.1.8" data-path="selection-on-observables.html"><a href="selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>35.1.8</b> Entropy Balancing</a></li>
<li class="chapter" data-level="35.1.9" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>35.1.9</b> Matching for high-dimensional data</a></li>
<li class="chapter" data-level="35.1.10" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-time-series-cross-section-data"><i class="fa fa-check"></i><b>35.1.10</b> Matching for time series-cross-section data</a></li>
<li class="chapter" data-level="35.1.11" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>35.1.11</b> Matching for multiple treatments</a></li>
<li class="chapter" data-level="35.1.12" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>35.1.12</b> Matching for multi-level treatments</a></li>
<li class="chapter" data-level="35.1.13" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-repeated-treatments"><i class="fa fa-check"></i><b>35.1.13</b> Matching for repeated treatments</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html"><i class="fa fa-check"></i><b>35.2</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#sec-rosenbaum-bounds"><i class="fa fa-check"></i><b>35.2.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="35.2.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#relative-correlation-restrictions"><i class="fa fa-check"></i><b>35.2.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="35.2.3" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#coefficient-stability-bounds"><i class="fa fa-check"></i><b>35.2.3</b> Coefficient-stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="36" data-path="endogeneity.html"><a href="endogeneity.html"><i class="fa fa-check"></i><b>36</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="36.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html"><i class="fa fa-check"></i><b>36.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#measurement-error"><i class="fa fa-check"></i><b>36.1.1</b> Measurement Error</a></li>
<li class="chapter" data-level="36.1.2" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#simultaneity"><i class="fa fa-check"></i><b>36.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="36.1.3" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#endogenous-treatment-solutions"><i class="fa fa-check"></i><b>36.1.3</b> Endogenous Treatment Solutions</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html"><i class="fa fa-check"></i><b>36.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#unifying-model-frameworks"><i class="fa fa-check"></i><b>36.2.1</b> Unifying Model Frameworks</a></li>
<li class="chapter" data-level="36.2.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#estimation-methods-2"><i class="fa fa-check"></i><b>36.2.2</b> Estimation Methods</a></li>
<li class="chapter" data-level="36.2.3" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#theoretical-connections"><i class="fa fa-check"></i><b>36.2.3</b> Theoretical Connections</a></li>
<li class="chapter" data-level="36.2.4" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-2-heckmans-sample-selection-model"><i class="fa fa-check"></i><b>36.2.4</b> Tobit-2: Heckman’s Sample Selection Model</a></li>
<li class="chapter" data-level="36.2.5" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-5-switching-regression-model"><i class="fa fa-check"></i><b>36.2.5</b> Tobit-5: Switching Regression Model</a></li>
<li class="chapter" data-level="36.2.6" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#pattern-mixture-models"><i class="fa fa-check"></i><b>36.2.6</b> Pattern-Mixture Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>37</b> Other Biases</a>
<ul>
<li class="chapter" data-level="37.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html"><i class="fa fa-check"></i><b>37.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html#simpsons-paradox-1"><i class="fa fa-check"></i><b>37.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="contamination-bias.html"><a href="contamination-bias.html"><i class="fa fa-check"></i><b>37.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="37.3" data-path="survivorship-bias.html"><a href="survivorship-bias.html"><i class="fa fa-check"></i><b>37.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="37.4" data-path="publication-bias.html"><a href="publication-bias.html"><i class="fa fa-check"></i><b>37.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="controls.html"><a href="controls.html"><i class="fa fa-check"></i><b>38</b> Controls</a>
<ul>
<li class="chapter" data-level="38.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>38.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="38.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>38.1.1</b> M-bias</a></li>
<li class="chapter" data-level="38.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification-1"><i class="fa fa-check"></i><b>38.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="38.1.3" data-path="bad-controls.html"><a href="bad-controls.html#overcontrol-bias"><i class="fa fa-check"></i><b>38.1.3</b> Overcontrol bias</a></li>
<li class="chapter" data-level="38.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>38.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="38.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>38.1.5</b> Case-control Bias</a></li>
</ul></li>
<li class="chapter" data-level="38.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>38.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>38.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="38.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>38.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>38.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="38.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>38.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="38.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>38.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="38.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>38.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="38.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>38.3.4</b> Bad Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="38.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>38.4</b> Choosing Controls</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="directed-acyclic-graph.html"><a href="directed-acyclic-graph.html"><i class="fa fa-check"></i><b>39</b> Directed Acyclic Graph</a>
<ul>
<li class="chapter" data-level="39.1" data-path="basic-notations.html"><a href="basic-notations.html"><i class="fa fa-check"></i><b>39.1</b> Basic Notations</a></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="40" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>40</b> Report</a>
<ul>
<li class="chapter" data-level="40.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>40.1</b> One summary table</a></li>
<li class="chapter" data-level="40.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>40.2</b> Model Comparison</a></li>
<li class="chapter" data-level="40.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>40.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="40.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>40.4</b> Standard Errors</a></li>
<li class="chapter" data-level="40.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>40.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="40.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>40.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="40.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>40.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>41</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="42" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>42</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="42.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>42.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="42.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>42.1.1</b> starbility</a></li>
<li class="chapter" data-level="42.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>42.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="42.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>42.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="42.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>42.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>43</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>43.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>43.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="43.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>43.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="43.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>43.1.3</b> Exceptions to Replication</a></li>
<li class="chapter" data-level="43.1.4" data-path="the-replication-standard.html"><a href="the-replication-standard.html#replication-landscape"><i class="fa fa-check"></i><b>43.1.4</b> Replication Landscape</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="synthetic-data.html"><a href="synthetic-data.html"><i class="fa fa-check"></i><b>43.2</b> Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="synthetic-data.html"><a href="synthetic-data.html#benefits-of-synthetic-data"><i class="fa fa-check"></i><b>43.2.1</b> Benefits of Synthetic Data</a></li>
<li class="chapter" data-level="43.2.2" data-path="synthetic-data.html"><a href="synthetic-data.html#concerns-and-limitations"><i class="fa fa-check"></i><b>43.2.2</b> Concerns and Limitations</a></li>
<li class="chapter" data-level="43.2.3" data-path="synthetic-data.html"><a href="synthetic-data.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>43.2.3</b> Further Insights on Synthetic Data</a></li>
<li class="chapter" data-level="43.2.4" data-path="synthetic-data.html"><a href="synthetic-data.html#generating-synthetic-data"><i class="fa fa-check"></i><b>43.2.4</b> Generating Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>43.3</b> Application</a>
<ul>
<li class="chapter" data-level="43.3.1" data-path="application-5.html"><a href="application-5.html#original-dataset"><i class="fa fa-check"></i><b>43.3.1</b> Original Dataset</a></li>
<li class="chapter" data-level="43.3.2" data-path="application-5.html"><a href="application-5.html#restricted-dataset"><i class="fa fa-check"></i><b>43.3.2</b> Restricted Dataset</a></li>
<li class="chapter" data-level="43.3.3" data-path="application-5.html"><a href="application-5.html#synthpop"><i class="fa fa-check"></i><b>43.3.3</b> Synthpop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>44</b> High-Performance Computing</a>
<ul>
<li class="chapter" data-level="44.1" data-path="best-practices-for-hpc-in-data-analysis.html"><a href="best-practices-for-hpc-in-data-analysis.html"><i class="fa fa-check"></i><b>44.1</b> Best Practices for HPC in Data Analysis</a></li>
<li class="chapter" data-level="44.2" data-path="example-workflow-in-r.html"><a href="example-workflow-in-r.html"><i class="fa fa-check"></i><b>44.2</b> Example Workflow in R</a></li>
<li class="chapter" data-level="44.3" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>44.3</b> Recommendations</a></li>
<li class="chapter" data-level="44.4" data-path="demonstration.html"><a href="demonstration.html"><i class="fa fa-check"></i><b>44.4</b> Demonstration</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packageslibaries-on-your-local-machine.html"><a href="install-all-necessary-packageslibaries-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-linear-least-squares-estimation" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Non-linear Least Squares Estimation<a href="non-linear-least-squares-estimation.html#non-linear-least-squares-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The least squares (LS) estimate of <span class="math inline">\(\theta\)</span>, denoted as <span class="math inline">\(\hat{\theta}\)</span>, minimizes the residual sum of squares:</p>
<p><span class="math display">\[
S(\hat{\theta}) = SSE(\hat{\theta}) = \sum_{i=1}^{n} \{Y_i - f(\mathbf{x}_i; \hat{\theta})\}^2
\]</span></p>
<p>To solve this, we consider the partial derivatives of <span class="math inline">\(S(\theta)\)</span> with respect to each <span class="math inline">\(\theta_j\)</span> and set them to zero, leading to the normal equations:</p>
<p><span class="math display">\[
\frac{\partial S(\theta)}{\partial \theta_j} = -2 \sum_{i=1}^{n} \{Y_i - f(\mathbf{x}_i; \theta)\} \frac{\partial f(\mathbf{x}_i; \theta)}{\partial \theta_j} = 0
\]</span></p>
<p>However, these equations are inherently non-linear and, in most cases, cannot be solved analytically. As a result, various estimation techniques are employed to approximate solutions efficiently. These approaches include:</p>
<ul>
<li><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression">Iterative Optimization</a> – Methods that refine estimates through successive iterations to minimize error.</li>
<li><a href="non-linear-least-squares-estimation.html#derivative-free">Derivative-Free</a> Methods – Techniques that do not rely on gradient information, useful for complex or non-smooth functions.</li>
<li><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression">Stochastic Heuristic</a> – Algorithms that incorporate randomness, such as genetic algorithms or simulated annealing, to explore solution spaces.</li>
<li><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization">Linearization</a>– Approximating non-linear models with linear ones to enable analytical or numerical solutions.</li>
<li><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization">Hybrid</a> Approaches – Combining multiple methods to leverage their respective strengths for improved estimation.</li>
</ul>
<table style="width:100%;">
<colgroup>
<col width="30%" />
<col width="15%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>Category</strong></th>
<th align="left"><strong>Method</strong></th>
<th align="left"><strong>Best For</strong></th>
<th align="left"><strong>Derivative?</strong></th>
<th align="left"><strong>Optimization</strong></th>
<th align="left"><strong>Comp. Cost</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression">Iterative Optimization</a></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a></td>
<td align="left">Simple problems, slow convergence</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="left"><strong>Iterative Optimization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a></td>
<td align="left">Faster than GD, ignores exact second-order info</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="odd">
<td align="left"><strong>Iterative Optimization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#levenberg-marquardt">Levenberg-Marquardt Algorithm</a></td>
<td align="left">Balances GN &amp; GD, robust</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Iterative Optimization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#newton-raphson">Newton-Raphson Method</a></td>
<td align="left">Quadratic convergence, needs Hessian</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><strong>Iterative Optimization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#quasi-newton-method">Quasi-Newton Method</a></td>
<td align="left">Approximates Hessian for large problems</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Iterative Optimization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#trust-region-reflective-algorithm">Trust-Region Reflective Algorithm</a></td>
<td align="left">Handles constraints, robust</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><a href="Techniques%20that%20do%20not%20rely%20on%20gradient%20information,%20useful%20for%20complex%20or%20non-smooth%20functions.">Derivative-Free</a></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#secant-method">Secant Method</a></td>
<td align="left">Approximates derivative from function evaluations</td>
<td align="left">No</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Derivative-Free</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#nelder-mead">Nelder-Mead (Simplex)</a></td>
<td align="left">No derivatives, heuristic</td>
<td align="left">No</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="odd">
<td align="left"><strong>Derivative-Free</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#powells-method">Powell’s Method</a></td>
<td align="left">Line search, no explicit gradient</td>
<td align="left">No</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Derivative-Free</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#grid-search">Grid Search</a></td>
<td align="left">Exhaustive search (best in low dims)</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">Very High</td>
</tr>
<tr class="odd">
<td align="left"><strong>Derivative-Free</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#hooke-jeeves">Hooke-Jeeves Pattern Search</a></td>
<td align="left">Pattern-based, black-box optimization</td>
<td align="left">No</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Derivative-Free</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#bisection-method">Bisection Method</a></td>
<td align="left">Simple root/interval-based approach</td>
<td align="left">No</td>
<td align="left">Local</td>
<td align="left">Low</td>
</tr>
<tr class="odd">
<td align="left"><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression">Stochastic Heuristic</a></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#simulated-annealing">Simulated Annealing</a></td>
<td align="left">Escapes local minima, non-smooth problems</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="left"><strong>Stochastic Heuristic</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#genetic-algorithm">Genetic Algorithm</a></td>
<td align="left">Large search spaces, evolving parameters</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><strong>Stochastic Heuristic</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#particle-swarm-optimization">Particle Swarm Optimization</a></td>
<td align="left">Swarm-based, often fast global convergence</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Stochastic Heuristic</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#evolutionary-strategies">Evolutionary Strategies</a></td>
<td align="left">High-dimensional, adaptive step-size</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><strong>Stochastic Heuristic</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#differential-evolution-algorithm">Differential Evolution Algorithm</a></td>
<td align="left">Robust global optimizer, population-based</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="left"><strong>Stochastic Heuristic</strong></td>
<td align="left">Ant Colony Optimization (ACO)</td>
<td align="left">Discrete / combinatorial problems</td>
<td align="left">No</td>
<td align="left">Global</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization">Linearization</a></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#taylor-series-approximation-nonlinear-optimization">Taylor Series Approximation</a></td>
<td align="left">Local approximation of non-linearity</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Low</td>
</tr>
<tr class="even">
<td align="left"><strong>Linearization</strong></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#log-linearization-nonlinear-optimization">Log-Linearization</a></td>
<td align="left">Transforms non-linear equations</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Low</td>
</tr>
<tr class="odd">
<td align="left"><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization">Hybrid</a></td>
<td align="left"><a href="non-linear-least-squares-estimation.html#adaptive-levenberg-marquardt">Adaptive Levenberg-Marquardt</a></td>
<td align="left">Dynamically adjusts damping in LM</td>
<td align="left">Yes</td>
<td align="left">Local</td>
<td align="left">Medium</td>
</tr>
<tr class="even">
<td align="left"><strong>Hybrid</strong></td>
<td align="left">Hybrid Genetic Algorithm &amp; LM (GA-LM)</td>
<td align="left">GA for coarse search, LM for fine-tuning</td>
<td align="left">No</td>
<td align="left">Hybrid</td>
<td align="left">High</td>
</tr>
<tr class="odd">
<td align="left"><strong>Hybrid</strong></td>
<td align="left">Neural Network-Based NLLS</td>
<td align="left">Deep learning for complex non-linear least squares</td>
<td align="left">No</td>
<td align="left">Hybrid</td>
<td align="left">Very High</td>
</tr>
</tbody>
</table>
<div id="iterative-optimization-nonlinear-regression" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Iterative Optimization<a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gauss-newton-algorithm" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Gauss-Newton Algorithm<a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Gauss-Newton Algorithm is an iterative optimization method used to estimate parameters in nonlinear least squares problems. It refines parameter estimates by approximating the Hessian matrix using first-order derivatives, making it computationally efficient for many practical applications (e.g., regression models in finance and marketing analytics). The objective is to minimize the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} [Y_i - f_i(\theta)]^2,
\]</span></p>
<p>where <span class="math inline">\(\mathbf{Y} = [Y_1, \dots, Y_n]&#39;\)</span> are the observed responses, and <span class="math inline">\(f_i(\theta)\)</span> are the model-predicted values.</p>
<hr />
<p><strong>Iterative Refinement via Taylor Expansion</strong></p>
<p>The Gauss-Newton algorithm iteratively refines an initial estimate <span class="math inline">\(\hat{\theta}^{(0)}\)</span> using the <strong>Taylor series expansion</strong> of <span class="math inline">\(f(\mathbf{x}_i; \theta)\)</span> about <span class="math inline">\(\hat{\theta}^{(0)}\)</span>. We start with the observation model:</p>
<p><span class="math display">\[
Y_i = f(\mathbf{x}_i; \theta) + \epsilon_i.
\]</span></p>
<p>By expanding <span class="math inline">\(f(\mathbf{x}_i; \theta)\)</span> around <span class="math inline">\(\hat{\theta}^{(0)}\)</span> and ignoring higher-order terms (assuming the remainder is small), we get:</p>
<p><span class="math display">\[
\begin{aligned}
Y_i &amp;\approx f(\mathbf{x}_i; \hat{\theta}^{(0)})
+ \sum_{j=1}^{p} \frac{\partial f(\mathbf{x}_i; \theta)}{\partial \theta_j} \bigg|_{\theta = \hat{\theta}^{(0)}}
\bigl(\theta_j - \hat{\theta}_j^{(0)}\bigr)
+ \epsilon_i.
\end{aligned}
\]</span></p>
<p>In <strong>matrix form</strong>, let</p>
<p><span class="math display">\[
\mathbf{Y} =
\begin{bmatrix}
Y_1 \\ \vdots \\ Y_n
\end{bmatrix},
\quad
\mathbf{f}(\hat{\theta}^{(0)}) =
\begin{bmatrix}
f(\mathbf{x}_1, \hat{\theta}^{(0)}) \\ \vdots \\ f(\mathbf{x}_n, \hat{\theta}^{(0)})
\end{bmatrix},
\]</span></p>
<p>and define the <strong>Jacobian matrix</strong> of partial derivatives</p>
<p><span class="math display">\[
\mathbf{F}(\hat{\theta}^{(0)}) =
\begin{bmatrix}
\frac{\partial f(\mathbf{x}_1, \theta)}{\partial \theta_1} &amp; \cdots &amp; \frac{\partial f(\mathbf{x}_1, \theta)}{\partial \theta_p} \\
\vdots &amp; \ddots &amp; \vdots \\
\frac{\partial f(\mathbf{x}_n, \theta)}{\partial \theta_1} &amp; \cdots &amp; \frac{\partial f(\mathbf{x}_n, \theta)}{\partial \theta_p}
\end{bmatrix}_{\theta = \hat{\theta}^{(0)}}.
\]</span></p>
<p>Then,</p>
<p><span class="math display">\[
\mathbf{Y} \approx \mathbf{f}(\hat{\theta}^{(0)})
+ \mathbf{F}(\hat{\theta}^{(0)})\,(\theta - \hat{\theta}^{(0)}) + \epsilon,
\]</span></p>
<p>with <span class="math inline">\(\epsilon = [\epsilon_1, \dots, \epsilon_n]&#39;\)</span> assumed i.i.d. with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>From this linear approximation,</p>
<p><span class="math display">\[
\mathbf{Y} - \mathbf{f}(\hat{\theta}^{(0)})
\approx \mathbf{F}(\hat{\theta}^{(0)})\,(\theta - \hat{\theta}^{(0)}).
\]</span></p>
<p>Solving for <span class="math inline">\(\theta - \hat{\theta}^{(0)}\)</span> in the <strong>least squares</strong> sense gives the Gauss increment <span class="math inline">\(\hat{\delta}^{(1)}\)</span>, so we can update:</p>
<p><span class="math display">\[
\hat{\theta}^{(1)} = \hat{\theta}^{(0)} + \hat{\delta}^{(1)}.
\]</span></p>
<hr />
<p><strong>Step-by-Step Procedure</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Initialize</strong>: Start with an initial estimate <span class="math inline">\(\hat{\theta}^{(0)}\)</span> and set <span class="math inline">\(j = 0\)</span>.<br />
</li>
<li><strong>Compute Taylor Expansion</strong>: Calculate <span class="math inline">\(\mathbf{f}(\hat{\theta}^{(j)})\)</span> and <span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span>.<br />
</li>
<li><strong>Solve for Increment</strong>: Treating <span class="math inline">\(\mathbf{Y} - \mathbf{f}(\hat{\theta}^{(j)}) \approx \mathbf{F}(\hat{\theta}^{(j)})\, (\theta - \hat{\theta}^{(j)})\)</span> as a linear model, use Ordinary Least Squares to compute <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span>.<br />
</li>
<li><strong>Update Parameters</strong>: Set <span class="math inline">\(\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} + \hat{\delta}^{(j+1)}\)</span>.<br />
</li>
<li><strong>Check for Convergence</strong>: If the convergence criteria are met (see below), stop; otherwise, return to Step 2.<br />
</li>
<li><strong>Estimate Variance</strong>: After convergence, we assume <span class="math inline">\(\epsilon \sim (\mathbf{0}, \sigma^2 \mathbf{I})\)</span>. The variance <span class="math inline">\(\sigma^2\)</span> can be estimated by</li>
</ol>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n-p} \bigl(\mathbf{Y} - \mathbf{f}(\mathbf{x}; \hat{\theta})\bigr)&#39; \bigl(\mathbf{Y} - \mathbf{f}(\mathbf{x}; \hat{\theta})\bigr).
\]</span></p>
<hr />
<p><strong>Convergence Criteria</strong></p>
<p>Common criteria for deciding when to stop iterating include:</p>
<ol style="list-style-type: decimal">
<li><strong>Objective Function Change</strong>: <span class="math display">\[
\frac{\bigl|SSE(\hat{\theta}^{(j+1)}) - SSE(\hat{\theta}^{(j)})\bigr|}{SSE(\hat{\theta}^{(j)})} &lt; \gamma_1.
\]</span></li>
<li><strong>Parameter Change</strong>: <span class="math display">\[
\bigl|\hat{\theta}^{(j+1)} - \hat{\theta}^{(j)}\bigr| &lt; \gamma_2.
\]</span></li>
<li><strong>Residual Projection Criterion</strong>: The residuals satisfy convergence as defined in <span class="citation">(<a href="#ref-bates1981relative">D. M. Bates and Watts 1981</a>)</span>.</li>
</ol>
<hr />
<p>Another way to see the update step is by viewing the <strong>necessary condition for a minimum</strong>: the gradient of <span class="math inline">\(SSE(\theta)\)</span> with respect to <span class="math inline">\(\theta\)</span> should be zero. For</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} [Y_i - f_i(\theta)]^2,
\]</span></p>
<p>the gradient is</p>
<p><span class="math display">\[
\frac{\partial SSE(\theta)}{\partial \theta}
= 2\,\mathbf{F}(\theta)&#39; \bigl[\mathbf{Y} - \mathbf{f}(\theta)\bigr].
\]</span></p>
<p>Using the Gauss-Newton update rule from iteration <span class="math inline">\(j\)</span> to <span class="math inline">\(j+1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\theta}^{(j+1)}
&amp;= \hat{\theta}^{(j)} + \hat{\delta}^{(j+1)} \\
&amp;= \hat{\theta}^{(j)} + \bigl[\mathbf{F}(\hat{\theta}^{(j)})&#39; \,\mathbf{F}(\hat{\theta}^{(j)})\bigr]^{-1}
\,\mathbf{F}(\hat{\theta}^{(j)})&#39; \bigl[\mathbf{Y} - \mathbf{f}(\hat{\theta}^{(j)})\bigr] \\
&amp;= \hat{\theta}^{(j)}
- \frac{1}{2} \bigl[\mathbf{F}(\hat{\theta}^{(j)})&#39; \,\mathbf{F}(\hat{\theta}^{(j)})\bigr]^{-1}
\, \frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta},
\end{aligned}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong>, pointing in the direction of <strong>steepest ascent</strong> of SSE.<br />
</li>
<li><span class="math inline">\(\bigl[\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})\bigr]^{-1}\)</span> determines the <strong>step size</strong>, controlling how far to move in the direction of improvement.<br />
</li>
<li>The factor <span class="math inline">\(-\tfrac{1}{2}\)</span> ensures movement in the <strong>direction of steepest descent</strong>, helping to <strong>minimize</strong> the SSE.</li>
</ul>
<p>The Gauss-Newton method works well when the nonlinear model can be approximated accurately by a <strong>first-order Taylor expansion</strong> near the solution. If the assumption of near-linearity in the residual function <span class="math inline">\(\mathbf{r}(\theta) = \mathbf{Y} - \mathbf{f}(\theta)\)</span> is violated, convergence may be slow or fail altogether. In such cases, more robust methods like <a href="non-linear-least-squares-estimation.html#levenberg-marquardt">Levenberg-Marquardt Algorithm</a> (which modifies Gauss-Newton with a damping parameter) are often preferred.</p>
<hr />
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="non-linear-least-squares-estimation.html#cb199-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb199-2"><a href="non-linear-least-squares-estimation.html#cb199-2" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)  <span class="co"># Provides nonlinear least squares functions</span></span>
<span id="cb199-3"><a href="non-linear-least-squares-estimation.html#cb199-3" tabindex="-1"></a></span>
<span id="cb199-4"><a href="non-linear-least-squares-estimation.html#cb199-4" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb199-5"><a href="non-linear-least-squares-estimation.html#cb199-5" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb199-6"><a href="non-linear-least-squares-estimation.html#cb199-6" tabindex="-1"></a>    <span class="co"># theta is a vector of parameters: theta[1] = A, theta[2] = B</span></span>
<span id="cb199-7"><a href="non-linear-least-squares-estimation.html#cb199-7" tabindex="-1"></a>    <span class="co"># x is the independent variable</span></span>
<span id="cb199-8"><a href="non-linear-least-squares-estimation.html#cb199-8" tabindex="-1"></a>    <span class="co"># The model is A * exp(B * x)</span></span>
<span id="cb199-9"><a href="non-linear-least-squares-estimation.html#cb199-9" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb199-10"><a href="non-linear-least-squares-estimation.html#cb199-10" tabindex="-1"></a>}</span>
<span id="cb199-11"><a href="non-linear-least-squares-estimation.html#cb199-11" tabindex="-1"></a></span>
<span id="cb199-12"><a href="non-linear-least-squares-estimation.html#cb199-12" tabindex="-1"></a><span class="co"># Define SSE function for clarity</span></span>
<span id="cb199-13"><a href="non-linear-least-squares-estimation.html#cb199-13" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb199-14"><a href="non-linear-least-squares-estimation.html#cb199-14" tabindex="-1"></a>    <span class="co"># SSE = sum of squared errors between actual y and model predictions</span></span>
<span id="cb199-15"><a href="non-linear-least-squares-estimation.html#cb199-15" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb199-16"><a href="non-linear-least-squares-estimation.html#cb199-16" tabindex="-1"></a>}</span>
<span id="cb199-17"><a href="non-linear-least-squares-estimation.html#cb199-17" tabindex="-1"></a></span>
<span id="cb199-18"><a href="non-linear-least-squares-estimation.html#cb199-18" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb199-19"><a href="non-linear-least-squares-estimation.html#cb199-19" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)                     <span class="co"># for reproducibility</span></span>
<span id="cb199-20"><a href="non-linear-least-squares-estimation.html#cb199-20" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>) <span class="co"># 100 points from 0 to 10</span></span>
<span id="cb199-21"><a href="non-linear-least-squares-estimation.html#cb199-21" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)           <span class="co"># true parameter values</span></span>
<span id="cb199-22"><a href="non-linear-least-squares-estimation.html#cb199-22" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb199-23"><a href="non-linear-least-squares-estimation.html#cb199-23" tabindex="-1"></a></span>
<span id="cb199-24"><a href="non-linear-least-squares-estimation.html#cb199-24" tabindex="-1"></a><span class="co"># Display the first few data points</span></span>
<span id="cb199-25"><a href="non-linear-least-squares-estimation.html#cb199-25" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(x, y))</span>
<span id="cb199-26"><a href="non-linear-least-squares-estimation.html#cb199-26" tabindex="-1"></a><span class="co">#&gt;           x        y</span></span>
<span id="cb199-27"><a href="non-linear-least-squares-estimation.html#cb199-27" tabindex="-1"></a><span class="co">#&gt; 1 0.0000000 1.719762</span></span>
<span id="cb199-28"><a href="non-linear-least-squares-estimation.html#cb199-28" tabindex="-1"></a><span class="co">#&gt; 2 0.1010101 1.946445</span></span>
<span id="cb199-29"><a href="non-linear-least-squares-estimation.html#cb199-29" tabindex="-1"></a><span class="co">#&gt; 3 0.2020202 2.904315</span></span>
<span id="cb199-30"><a href="non-linear-least-squares-estimation.html#cb199-30" tabindex="-1"></a><span class="co">#&gt; 4 0.3030303 2.225593</span></span>
<span id="cb199-31"><a href="non-linear-least-squares-estimation.html#cb199-31" tabindex="-1"></a><span class="co">#&gt; 5 0.4040404 2.322373</span></span>
<span id="cb199-32"><a href="non-linear-least-squares-estimation.html#cb199-32" tabindex="-1"></a><span class="co">#&gt; 6 0.5050505 3.184724</span></span>
<span id="cb199-33"><a href="non-linear-least-squares-estimation.html#cb199-33" tabindex="-1"></a></span>
<span id="cb199-34"><a href="non-linear-least-squares-estimation.html#cb199-34" tabindex="-1"></a><span class="co"># Gauss-Newton optimization using nls.lm (Levenberg-Marquardt as extension).</span></span>
<span id="cb199-35"><a href="non-linear-least-squares-estimation.html#cb199-35" tabindex="-1"></a><span class="co"># Initial guess for theta: c(1, 0.1)</span></span>
<span id="cb199-36"><a href="non-linear-least-squares-estimation.html#cb199-36" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">nls.lm</span>(</span>
<span id="cb199-37"><a href="non-linear-least-squares-estimation.html#cb199-37" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb199-38"><a href="non-linear-least-squares-estimation.html#cb199-38" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(theta)</span>
<span id="cb199-39"><a href="non-linear-least-squares-estimation.html#cb199-39" tabindex="-1"></a>        y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb199-40"><a href="non-linear-least-squares-estimation.html#cb199-40" tabindex="-1"></a>)</span>
<span id="cb199-41"><a href="non-linear-least-squares-estimation.html#cb199-41" tabindex="-1"></a></span>
<span id="cb199-42"><a href="non-linear-least-squares-estimation.html#cb199-42" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb199-43"><a href="non-linear-least-squares-estimation.html#cb199-43" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb199-44"><a href="non-linear-least-squares-estimation.html#cb199-44" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B):</span></span>
<span id="cb199-45"><a href="non-linear-least-squares-estimation.html#cb199-45" tabindex="-1"></a><span class="fu">print</span>(fit<span class="sc">$</span>par)</span>
<span id="cb199-46"><a href="non-linear-least-squares-estimation.html#cb199-46" tabindex="-1"></a><span class="co">#&gt; [1] 1.9934188 0.3008742</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>We defined the model “nonlinear_model(theta, x)” which returns A<em>exp(B</em>x).</li>
<li>We generated synthetic data using the “true_theta” values and added random noise.</li>
<li>We used <code>nls.lm(...)</code> from the <code>minpack.lm</code> package to fit the data:
<ul>
<li><code>par = c(1, 0.1)</code> is our initial parameter guess.</li>
<li><code>fn = function(theta) y - nonlinear_model(theta, x)</code> is the residual function, i.e., observed minus predicted.</li>
</ul></li>
<li>The <code>fit$par</code> provides the estimated parameters after the algorithm converges.</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="non-linear-least-squares-estimation.html#cb200-1" tabindex="-1"></a><span class="co"># Visualize the data and the fitted model</span></span>
<span id="cb200-2"><a href="non-linear-least-squares-estimation.html#cb200-2" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb200-3"><a href="non-linear-least-squares-estimation.html#cb200-3" tabindex="-1"></a>  x,</span>
<span id="cb200-4"><a href="non-linear-least-squares-estimation.html#cb200-4" tabindex="-1"></a>  y,</span>
<span id="cb200-5"><a href="non-linear-least-squares-estimation.html#cb200-5" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Data and Fitted Curve (Gauss-Newton/Levenberg-Marquardt)&quot;</span>,</span>
<span id="cb200-6"><a href="non-linear-least-squares-estimation.html#cb200-6" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb200-7"><a href="non-linear-least-squares-estimation.html#cb200-7" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb200-8"><a href="non-linear-least-squares-estimation.html#cb200-8" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb200-9"><a href="non-linear-least-squares-estimation.html#cb200-9" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.5</span></span>
<span id="cb200-10"><a href="non-linear-least-squares-estimation.html#cb200-10" tabindex="-1"></a>)</span>
<span id="cb200-11"><a href="non-linear-least-squares-estimation.html#cb200-11" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb200-12"><a href="non-linear-least-squares-estimation.html#cb200-12" tabindex="-1"></a>  <span class="fu">nonlinear_model</span>(fit<span class="sc">$</span>par, x),</span>
<span id="cb200-13"><a href="non-linear-least-squares-estimation.html#cb200-13" tabindex="-1"></a>  <span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb200-14"><a href="non-linear-least-squares-estimation.html#cb200-14" tabindex="-1"></a>  <span class="at">to =</span> <span class="dv">10</span>,</span>
<span id="cb200-15"><a href="non-linear-least-squares-estimation.html#cb200-15" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb200-16"><a href="non-linear-least-squares-estimation.html#cb200-16" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb200-17"><a href="non-linear-least-squares-estimation.html#cb200-17" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb200-18"><a href="non-linear-least-squares-estimation.html#cb200-18" tabindex="-1"></a>)</span>
<span id="cb200-19"><a href="non-linear-least-squares-estimation.html#cb200-19" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb200-20"><a href="non-linear-least-squares-estimation.html#cb200-20" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb200-21"><a href="non-linear-least-squares-estimation.html#cb200-21" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb200-22"><a href="non-linear-least-squares-estimation.html#cb200-22" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb200-23"><a href="non-linear-least-squares-estimation.html#cb200-23" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb200-24"><a href="non-linear-least-squares-estimation.html#cb200-24" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb200-25"><a href="non-linear-least-squares-estimation.html#cb200-25" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="modified-gauss-newton-algorithm" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Modified Gauss-Newton Algorithm<a href="non-linear-least-squares-estimation.html#modified-gauss-newton-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Modified Gauss-Newton Algorithm introduces a learning rate <span class="math inline">\(\alpha_j\)</span> to control step size and prevent overshooting the local minimum. The standard <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> assumes that the full step direction <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span> is optimal, but in practice, especially for highly nonlinear problems, it can overstep the minimum or cause numerical instability. The modification introduces a step size reduction, making it more robust.</p>
<p>We redefine the update step as:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} + \alpha_j \hat{\delta}^{(j+1)}, \quad 0 &lt; \alpha_j &lt; 1,
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\alpha_j\)</span> is a <strong>learning rate</strong>, controlling how much of the step <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span> is taken.</li>
<li>If <span class="math inline">\(\alpha_j = 1\)</span>, we recover the standard Gauss-Newton method.</li>
<li>If <span class="math inline">\(\alpha_j\)</span> is too small, convergence is slow; if too large, the algorithm may diverge.</li>
</ul>
<p>This learning rate <span class="math inline">\(\alpha_j\)</span> allows for <strong>adaptive step size adjustments</strong>, helping prevent excessive parameter jumps and ensuring that SSE decreases at each iteration.</p>
<hr />
<p>A common approach to determine <span class="math inline">\(\alpha_j\)</span> is <strong>step halving</strong>, ensuring that each iteration moves in a direction that reduces SSE. Instead of using a fixed <span class="math inline">\(\alpha_j\)</span>, we iteratively reduce the step size until SSE decreases:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} + \frac{1}{2^k}\hat{\delta}^{(j+1)},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(k\)</span> is the smallest non-negative integer such that</li>
</ul>
<p><span class="math display">\[
SSE(\hat{\theta}^{(j)} + \frac{1}{2^k} \hat{\delta}^{(j+1)}) &lt; SSE(\hat{\theta}^{(j)}).
\]</span></p>
<p>This means we start with the full step <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span>, then try <span class="math inline">\(\hat{\delta}^{(j+1)}/2\)</span>, then <span class="math inline">\(\hat{\delta}^{(j+1)}/4\)</span>, and so on, until SSE is reduced.</p>
<p><strong>Algorithm for Step Halving:</strong></p>
<ol style="list-style-type: decimal">
<li>Compute the Gauss-Newton step <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span>.</li>
<li>Set an initial <span class="math inline">\(\alpha_j = 1\)</span>.</li>
<li>If the updated parameters <span class="math inline">\(\hat{\theta}^{(j)} + \alpha_j \hat{\delta}^{(j+1)}\)</span> increase SSE, divide <span class="math inline">\(\alpha_j\)</span> by 2.</li>
<li>Repeat until SSE decreases.</li>
</ol>
<p>This <strong>ensures monotonic SSE reduction</strong>, preventing divergence due to an overly aggressive step.</p>
<hr />
<p><strong>Generalized Form of the Modified Algorithm</strong></p>
<p>A more general form of the update rule, incorporating step size control and a matrix <span class="math inline">\(\mathbf{A}_j\)</span>, is:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{A}_j \frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{A}_j\)</span> is a <strong>positive definite matrix</strong> that preconditions the update direction.</li>
<li><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>.</li>
<li><span class="math inline">\(\frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient</strong> of the objective function <span class="math inline">\(Q(\theta)\)</span>, typically SSE in nonlinear regression.</li>
</ul>
<hr />
<p><strong>Connection to the Modified Gauss-Newton Algorithm</strong></p>
<p>The <strong>Modified Gauss-Newton Algorithm</strong> fits this framework:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j [\mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)})]^{-1} \frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta}.
\]</span></p>
<p>Here, we recognize:</p>
<ul>
<li><strong>Objective function</strong>: <span class="math inline">\(Q = SSE\)</span>.</li>
<li><strong>Preconditioner matrix</strong>: <span class="math inline">\([\mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)})]^{-1} = \mathbf{A}\)</span>.</li>
</ul>
<p>Thus, the standard Gauss-Newton method can be interpreted as a special case of this broader optimization framework, with a preconditioned gradient descent approach.</p>
<hr />
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="non-linear-least-squares-estimation.html#cb201-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb201-2"><a href="non-linear-least-squares-estimation.html#cb201-2" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb201-3"><a href="non-linear-least-squares-estimation.html#cb201-3" tabindex="-1"></a></span>
<span id="cb201-4"><a href="non-linear-least-squares-estimation.html#cb201-4" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb201-5"><a href="non-linear-least-squares-estimation.html#cb201-5" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb201-6"><a href="non-linear-least-squares-estimation.html#cb201-6" tabindex="-1"></a>  theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb201-7"><a href="non-linear-least-squares-estimation.html#cb201-7" tabindex="-1"></a>}</span>
<span id="cb201-8"><a href="non-linear-least-squares-estimation.html#cb201-8" tabindex="-1"></a></span>
<span id="cb201-9"><a href="non-linear-least-squares-estimation.html#cb201-9" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors function</span></span>
<span id="cb201-10"><a href="non-linear-least-squares-estimation.html#cb201-10" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb201-11"><a href="non-linear-least-squares-estimation.html#cb201-11" tabindex="-1"></a>  <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb201-12"><a href="non-linear-least-squares-estimation.html#cb201-12" tabindex="-1"></a>}</span>
<span id="cb201-13"><a href="non-linear-least-squares-estimation.html#cb201-13" tabindex="-1"></a></span>
<span id="cb201-14"><a href="non-linear-least-squares-estimation.html#cb201-14" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb201-15"><a href="non-linear-least-squares-estimation.html#cb201-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb201-16"><a href="non-linear-least-squares-estimation.html#cb201-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb201-17"><a href="non-linear-least-squares-estimation.html#cb201-17" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb201-18"><a href="non-linear-least-squares-estimation.html#cb201-18" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb201-19"><a href="non-linear-least-squares-estimation.html#cb201-19" tabindex="-1"></a></span>
<span id="cb201-20"><a href="non-linear-least-squares-estimation.html#cb201-20" tabindex="-1"></a><span class="co"># Gauss-Newton with Step Halving</span></span>
<span id="cb201-21"><a href="non-linear-least-squares-estimation.html#cb201-21" tabindex="-1"></a>gauss_newton_modified <span class="ot">&lt;-</span></span>
<span id="cb201-22"><a href="non-linear-least-squares-estimation.html#cb201-22" tabindex="-1"></a>  <span class="cf">function</span>(theta_init,</span>
<span id="cb201-23"><a href="non-linear-least-squares-estimation.html#cb201-23" tabindex="-1"></a>           x,</span>
<span id="cb201-24"><a href="non-linear-least-squares-estimation.html#cb201-24" tabindex="-1"></a>           y,</span>
<span id="cb201-25"><a href="non-linear-least-squares-estimation.html#cb201-25" tabindex="-1"></a>           <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb201-26"><a href="non-linear-least-squares-estimation.html#cb201-26" tabindex="-1"></a>           <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb201-27"><a href="non-linear-least-squares-estimation.html#cb201-27" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb201-28"><a href="non-linear-least-squares-estimation.html#cb201-28" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb201-29"><a href="non-linear-least-squares-estimation.html#cb201-29" tabindex="-1"></a>      <span class="co"># Compute Jacobian matrix numerically</span></span>
<span id="cb201-30"><a href="non-linear-least-squares-estimation.html#cb201-30" tabindex="-1"></a>      epsilon <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb201-31"><a href="non-linear-least-squares-estimation.html#cb201-31" tabindex="-1"></a>      F_matrix <span class="ot">&lt;-</span></span>
<span id="cb201-32"><a href="non-linear-least-squares-estimation.html#cb201-32" tabindex="-1"></a>        <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(y), <span class="at">ncol =</span> <span class="fu">length</span>(theta))</span>
<span id="cb201-33"><a href="non-linear-least-squares-estimation.html#cb201-33" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)) {</span>
<span id="cb201-34"><a href="non-linear-least-squares-estimation.html#cb201-34" tabindex="-1"></a>        theta_perturb <span class="ot">&lt;-</span> theta</span>
<span id="cb201-35"><a href="non-linear-least-squares-estimation.html#cb201-35" tabindex="-1"></a>        theta_perturb[p] <span class="ot">&lt;-</span> theta[p] <span class="sc">+</span> epsilon</span>
<span id="cb201-36"><a href="non-linear-least-squares-estimation.html#cb201-36" tabindex="-1"></a>        F_matrix[, p] <span class="ot">&lt;-</span></span>
<span id="cb201-37"><a href="non-linear-least-squares-estimation.html#cb201-37" tabindex="-1"></a>          (<span class="fu">nonlinear_model</span>(theta_perturb, x)<span class="sc">-</span><span class="fu">nonlinear_model</span>(theta, x))<span class="sc">/</span>epsilon</span>
<span id="cb201-38"><a href="non-linear-least-squares-estimation.html#cb201-38" tabindex="-1"></a>      }</span>
<span id="cb201-39"><a href="non-linear-least-squares-estimation.html#cb201-39" tabindex="-1"></a>      </span>
<span id="cb201-40"><a href="non-linear-least-squares-estimation.html#cb201-40" tabindex="-1"></a>      <span class="co"># Compute residuals</span></span>
<span id="cb201-41"><a href="non-linear-least-squares-estimation.html#cb201-41" tabindex="-1"></a>      residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb201-42"><a href="non-linear-least-squares-estimation.html#cb201-42" tabindex="-1"></a>      </span>
<span id="cb201-43"><a href="non-linear-least-squares-estimation.html#cb201-43" tabindex="-1"></a>      <span class="co"># Compute Gauss-Newton step</span></span>
<span id="cb201-44"><a href="non-linear-least-squares-estimation.html#cb201-44" tabindex="-1"></a>      delta <span class="ot">&lt;-</span></span>
<span id="cb201-45"><a href="non-linear-least-squares-estimation.html#cb201-45" tabindex="-1"></a>        <span class="fu">solve</span>(<span class="fu">t</span>(F_matrix) <span class="sc">%*%</span> F_matrix) <span class="sc">%*%</span> <span class="fu">t</span>(F_matrix) <span class="sc">%*%</span> residuals</span>
<span id="cb201-46"><a href="non-linear-least-squares-estimation.html#cb201-46" tabindex="-1"></a>      </span>
<span id="cb201-47"><a href="non-linear-least-squares-estimation.html#cb201-47" tabindex="-1"></a>      <span class="co"># Step Halving Implementation</span></span>
<span id="cb201-48"><a href="non-linear-least-squares-estimation.html#cb201-48" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb201-49"><a href="non-linear-least-squares-estimation.html#cb201-49" tabindex="-1"></a>      k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb201-50"><a href="non-linear-least-squares-estimation.html#cb201-50" tabindex="-1"></a>      <span class="cf">while</span> (<span class="fu">sse</span>(theta <span class="sc">+</span> alpha <span class="sc">*</span> delta, x, y) <span class="sc">&gt;=</span> <span class="fu">sse</span>(theta, x, y) <span class="sc">&amp;&amp;</span></span>
<span id="cb201-51"><a href="non-linear-least-squares-estimation.html#cb201-51" tabindex="-1"></a>             k <span class="sc">&lt;</span> <span class="dv">10</span>) {</span>
<span id="cb201-52"><a href="non-linear-least-squares-estimation.html#cb201-52" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> alpha <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb201-53"><a href="non-linear-least-squares-estimation.html#cb201-53" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb201-54"><a href="non-linear-least-squares-estimation.html#cb201-54" tabindex="-1"></a>      }</span>
<span id="cb201-55"><a href="non-linear-least-squares-estimation.html#cb201-55" tabindex="-1"></a>      </span>
<span id="cb201-56"><a href="non-linear-least-squares-estimation.html#cb201-56" tabindex="-1"></a>      <span class="co"># Update theta</span></span>
<span id="cb201-57"><a href="non-linear-least-squares-estimation.html#cb201-57" tabindex="-1"></a>      theta_new <span class="ot">&lt;-</span> theta <span class="sc">+</span> alpha <span class="sc">*</span> delta</span>
<span id="cb201-58"><a href="non-linear-least-squares-estimation.html#cb201-58" tabindex="-1"></a>      </span>
<span id="cb201-59"><a href="non-linear-least-squares-estimation.html#cb201-59" tabindex="-1"></a>      <span class="co"># Check for convergence</span></span>
<span id="cb201-60"><a href="non-linear-least-squares-estimation.html#cb201-60" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb201-61"><a href="non-linear-least-squares-estimation.html#cb201-61" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb201-62"><a href="non-linear-least-squares-estimation.html#cb201-62" tabindex="-1"></a>      }</span>
<span id="cb201-63"><a href="non-linear-least-squares-estimation.html#cb201-63" tabindex="-1"></a>      </span>
<span id="cb201-64"><a href="non-linear-least-squares-estimation.html#cb201-64" tabindex="-1"></a>      theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb201-65"><a href="non-linear-least-squares-estimation.html#cb201-65" tabindex="-1"></a>    }</span>
<span id="cb201-66"><a href="non-linear-least-squares-estimation.html#cb201-66" tabindex="-1"></a>    <span class="fu">return</span>(theta)</span>
<span id="cb201-67"><a href="non-linear-least-squares-estimation.html#cb201-67" tabindex="-1"></a>  }</span>
<span id="cb201-68"><a href="non-linear-least-squares-estimation.html#cb201-68" tabindex="-1"></a></span>
<span id="cb201-69"><a href="non-linear-least-squares-estimation.html#cb201-69" tabindex="-1"></a><span class="co"># Run Modified Gauss-Newton Algorithm</span></span>
<span id="cb201-70"><a href="non-linear-least-squares-estimation.html#cb201-70" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial parameter guess</span></span>
<span id="cb201-71"><a href="non-linear-least-squares-estimation.html#cb201-71" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">gauss_newton_modified</span>(theta_init, x, y)</span>
<span id="cb201-72"><a href="non-linear-least-squares-estimation.html#cb201-72" tabindex="-1"></a></span>
<span id="cb201-73"><a href="non-linear-least-squares-estimation.html#cb201-73" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb201-74"><a href="non-linear-least-squares-estimation.html#cb201-74" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) with Modified Gauss-Newton:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb201-75"><a href="non-linear-least-squares-estimation.html#cb201-75" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) with Modified Gauss-Newton:</span></span>
<span id="cb201-76"><a href="non-linear-least-squares-estimation.html#cb201-76" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb201-77"><a href="non-linear-least-squares-estimation.html#cb201-77" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb201-78"><a href="non-linear-least-squares-estimation.html#cb201-78" tabindex="-1"></a><span class="co">#&gt; [1,] 1.9934188</span></span>
<span id="cb201-79"><a href="non-linear-least-squares-estimation.html#cb201-79" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3008742</span></span>
<span id="cb201-80"><a href="non-linear-least-squares-estimation.html#cb201-80" tabindex="-1"></a></span>
<span id="cb201-81"><a href="non-linear-least-squares-estimation.html#cb201-81" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb201-82"><a href="non-linear-least-squares-estimation.html#cb201-82" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb201-83"><a href="non-linear-least-squares-estimation.html#cb201-83" tabindex="-1"></a>  x,</span>
<span id="cb201-84"><a href="non-linear-least-squares-estimation.html#cb201-84" tabindex="-1"></a>  y,</span>
<span id="cb201-85"><a href="non-linear-least-squares-estimation.html#cb201-85" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Modified Gauss-Newton: Data &amp; Fitted Curve&quot;</span>,</span>
<span id="cb201-86"><a href="non-linear-least-squares-estimation.html#cb201-86" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb201-87"><a href="non-linear-least-squares-estimation.html#cb201-87" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb201-88"><a href="non-linear-least-squares-estimation.html#cb201-88" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb201-89"><a href="non-linear-least-squares-estimation.html#cb201-89" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb201-90"><a href="non-linear-least-squares-estimation.html#cb201-90" tabindex="-1"></a>)</span>
<span id="cb201-91"><a href="non-linear-least-squares-estimation.html#cb201-91" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb201-92"><a href="non-linear-least-squares-estimation.html#cb201-92" tabindex="-1"></a>  <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb201-93"><a href="non-linear-least-squares-estimation.html#cb201-93" tabindex="-1"></a>  <span class="at">from =</span> <span class="dv">0</span>,</span>
<span id="cb201-94"><a href="non-linear-least-squares-estimation.html#cb201-94" tabindex="-1"></a>  <span class="at">to =</span> <span class="dv">10</span>,</span>
<span id="cb201-95"><a href="non-linear-least-squares-estimation.html#cb201-95" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-96"><a href="non-linear-least-squares-estimation.html#cb201-96" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb201-97"><a href="non-linear-least-squares-estimation.html#cb201-97" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb201-98"><a href="non-linear-least-squares-estimation.html#cb201-98" tabindex="-1"></a>)</span>
<span id="cb201-99"><a href="non-linear-least-squares-estimation.html#cb201-99" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb201-100"><a href="non-linear-least-squares-estimation.html#cb201-100" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb201-101"><a href="non-linear-least-squares-estimation.html#cb201-101" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb201-102"><a href="non-linear-least-squares-estimation.html#cb201-102" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb201-103"><a href="non-linear-least-squares-estimation.html#cb201-103" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb201-104"><a href="non-linear-least-squares-estimation.html#cb201-104" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb201-105"><a href="non-linear-least-squares-estimation.html#cb201-105" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="steepest-descent" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> Steepest Descent (Gradient Descent)<a href="non-linear-least-squares-estimation.html#steepest-descent" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Steepest Descent Method, commonly known as Gradient Descent, is a fundamental iterative optimization technique used for finding parameter estimates that minimize an objective function <span class="math inline">\(\mathbf{Q}(\theta)\)</span>. It is a special case of the <a href="non-linear-least-squares-estimation.html#modified-gauss-newton-algorithm">Modified Gauss-Newton Algorithm</a>, where the preconditioning matrix <span class="math inline">\(\mathbf{A}_j\)</span> is replaced by the identity matrix.</p>
<p>The update rule is given by:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{I}_{p \times p}\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>, determining the step size.</li>
<li><span class="math inline">\(\mathbf{I}_{p \times p}\)</span> is the <strong>identity matrix</strong>, meaning updates occur in the direction of the <strong>negative gradient</strong>.</li>
<li><span class="math inline">\(\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong>, which provides the direction of <strong>steepest ascent</strong>; its negation ensures movement toward the minimum.</li>
</ul>
<p>Characteristics of Steepest Descent</p>
<ul>
<li><strong>Slow to converge:</strong> The algorithm moves in the direction of the gradient but does not take into account curvature, which may result in slow convergence, especially in ill-conditioned problems.</li>
<li><strong>Moves rapidly initially:</strong> The method can exhibit <strong>fast initial progress</strong>, but as it approaches the minimum, step sizes become small, leading to slow convergence.</li>
<li><strong>Useful for initialization:</strong> Due to its simplicity and ease of implementation, it is often used to obtain <strong>starting values</strong> for more advanced methods like <strong>Newton’s method</strong> or <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a>.</li>
</ul>
<hr />
<p>Comparison with Gauss-Newton</p>
<table style="width:100%;">
<colgroup>
<col width="20%" />
<col width="38%" />
<col width="20%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>Method</th>
<th>Update Rule</th>
<th>Advantages</th>
<th>Disadvantages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Steepest Descent</strong></td>
<td><span class="math inline">\(\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{I} \nabla Q(\theta)\)</span></td>
<td>Simple, requires only first derivatives</td>
<td>Slow convergence, sensitive to <span class="math inline">\(\alpha_j\)</span></td>
</tr>
<tr class="even">
<td><strong>Gauss-Newton</strong></td>
<td><span class="math inline">\(\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \mathbf{H}^{-1} \nabla Q(\theta)\)</span></td>
<td>Uses curvature, faster near solution</td>
<td>Requires Jacobian computation, may diverge</td>
</tr>
</tbody>
</table>
<p>The <strong>key difference</strong> is that Steepest Descent <strong>only</strong> considers the gradient direction, while Gauss-Newton and Newton’s method incorporate curvature information.</p>
<hr />
<p>Choosing the Learning Rate <span class="math inline">\(\alpha_j\)</span></p>
<p>A well-chosen <strong>learning rate</strong> is crucial for the success of gradient descent:</p>
<ul>
<li><strong>Too large</strong>: The algorithm may overshoot the minimum and diverge.</li>
<li><strong>Too small</strong>: Convergence is <strong>very slow</strong>.</li>
<li><strong>Adaptive strategies</strong>:
<ul>
<li><strong>Fixed step size</strong>: <span class="math inline">\(\alpha_j\)</span> is constant.</li>
<li><strong>Step size decay</strong>: <span class="math inline">\(\alpha_j\)</span> decreases over iterations (e.g., <span class="math inline">\(\alpha_j = \frac{1}{j}\)</span>).</li>
<li><strong>Line search</strong>: Choose <span class="math inline">\(\alpha_j\)</span> by minimizing <span class="math inline">\(\mathbf{Q}(\theta^{(j+1)})\)</span> along the gradient direction.</li>
</ul></li>
</ul>
<p>A common approach is <strong>backtracking line search</strong>, where <span class="math inline">\(\alpha_j\)</span> is reduced iteratively until a decrease in <span class="math inline">\(\mathbf{Q}(\theta)\)</span> is observed.</p>
<hr />
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="non-linear-least-squares-estimation.html#cb202-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb202-2"><a href="non-linear-least-squares-estimation.html#cb202-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-3"><a href="non-linear-least-squares-estimation.html#cb202-3" tabindex="-1"></a></span>
<span id="cb202-4"><a href="non-linear-least-squares-estimation.html#cb202-4" tabindex="-1"></a></span>
<span id="cb202-5"><a href="non-linear-least-squares-estimation.html#cb202-5" tabindex="-1"></a><span class="co"># Define the nonlinear function (exponential model)</span></span>
<span id="cb202-6"><a href="non-linear-least-squares-estimation.html#cb202-6" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb202-7"><a href="non-linear-least-squares-estimation.html#cb202-7" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb202-8"><a href="non-linear-least-squares-estimation.html#cb202-8" tabindex="-1"></a>}</span>
<span id="cb202-9"><a href="non-linear-least-squares-estimation.html#cb202-9" tabindex="-1"></a></span>
<span id="cb202-10"><a href="non-linear-least-squares-estimation.html#cb202-10" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors function</span></span>
<span id="cb202-11"><a href="non-linear-least-squares-estimation.html#cb202-11" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb202-12"><a href="non-linear-least-squares-estimation.html#cb202-12" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb202-13"><a href="non-linear-least-squares-estimation.html#cb202-13" tabindex="-1"></a>}</span>
<span id="cb202-14"><a href="non-linear-least-squares-estimation.html#cb202-14" tabindex="-1"></a></span>
<span id="cb202-15"><a href="non-linear-least-squares-estimation.html#cb202-15" tabindex="-1"></a><span class="co"># Define Gradient of SSE w.r.t theta (computed numerically)</span></span>
<span id="cb202-16"><a href="non-linear-least-squares-estimation.html#cb202-16" tabindex="-1"></a>gradient_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb202-17"><a href="non-linear-least-squares-estimation.html#cb202-17" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb202-18"><a href="non-linear-least-squares-estimation.html#cb202-18" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb202-19"><a href="non-linear-least-squares-estimation.html#cb202-19" tabindex="-1"></a>    </span>
<span id="cb202-20"><a href="non-linear-least-squares-estimation.html#cb202-20" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_1</span></span>
<span id="cb202-21"><a href="non-linear-least-squares-estimation.html#cb202-21" tabindex="-1"></a>    grad_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb202-22"><a href="non-linear-least-squares-estimation.html#cb202-22" tabindex="-1"></a>    </span>
<span id="cb202-23"><a href="non-linear-least-squares-estimation.html#cb202-23" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_2</span></span>
<span id="cb202-24"><a href="non-linear-least-squares-estimation.html#cb202-24" tabindex="-1"></a>    grad_2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> theta[<span class="dv">1</span>] <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb202-25"><a href="non-linear-least-squares-estimation.html#cb202-25" tabindex="-1"></a>    </span>
<span id="cb202-26"><a href="non-linear-least-squares-estimation.html#cb202-26" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(grad_1, grad_2))</span>
<span id="cb202-27"><a href="non-linear-least-squares-estimation.html#cb202-27" tabindex="-1"></a>}</span>
<span id="cb202-28"><a href="non-linear-least-squares-estimation.html#cb202-28" tabindex="-1"></a></span>
<span id="cb202-29"><a href="non-linear-least-squares-estimation.html#cb202-29" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb202-30"><a href="non-linear-least-squares-estimation.html#cb202-30" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb202-31"><a href="non-linear-least-squares-estimation.html#cb202-31" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb202-32"><a href="non-linear-least-squares-estimation.html#cb202-32" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb202-33"><a href="non-linear-least-squares-estimation.html#cb202-33" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb202-34"><a href="non-linear-least-squares-estimation.html#cb202-34" tabindex="-1"></a></span>
<span id="cb202-35"><a href="non-linear-least-squares-estimation.html#cb202-35" tabindex="-1"></a><span class="co"># Safe Gradient Descent Implementation</span></span>
<span id="cb202-36"><a href="non-linear-least-squares-estimation.html#cb202-36" tabindex="-1"></a>gradient_descent <span class="ot">&lt;-</span></span>
<span id="cb202-37"><a href="non-linear-least-squares-estimation.html#cb202-37" tabindex="-1"></a>    <span class="cf">function</span>(theta_init,</span>
<span id="cb202-38"><a href="non-linear-least-squares-estimation.html#cb202-38" tabindex="-1"></a>             x,</span>
<span id="cb202-39"><a href="non-linear-least-squares-estimation.html#cb202-39" tabindex="-1"></a>             y,</span>
<span id="cb202-40"><a href="non-linear-least-squares-estimation.html#cb202-40" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.01</span>,</span>
<span id="cb202-41"><a href="non-linear-least-squares-estimation.html#cb202-41" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb202-42"><a href="non-linear-least-squares-estimation.html#cb202-42" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">500</span>) {</span>
<span id="cb202-43"><a href="non-linear-least-squares-estimation.html#cb202-43" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb202-44"><a href="non-linear-least-squares-estimation.html#cb202-44" tabindex="-1"></a>        sse_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_iter)</span>
<span id="cb202-45"><a href="non-linear-least-squares-estimation.html#cb202-45" tabindex="-1"></a>        </span>
<span id="cb202-46"><a href="non-linear-least-squares-estimation.html#cb202-46" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb202-47"><a href="non-linear-least-squares-estimation.html#cb202-47" tabindex="-1"></a>            grad <span class="ot">&lt;-</span> <span class="fu">gradient_sse</span>(theta, x, y)</span>
<span id="cb202-48"><a href="non-linear-least-squares-estimation.html#cb202-48" tabindex="-1"></a>            </span>
<span id="cb202-49"><a href="non-linear-least-squares-estimation.html#cb202-49" tabindex="-1"></a>            <span class="co"># Check for NaN or Inf values in the gradient (prevents divergence)</span></span>
<span id="cb202-50"><a href="non-linear-least-squares-estimation.html#cb202-50" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(grad)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.infinite</span>(grad))) {</span>
<span id="cb202-51"><a href="non-linear-least-squares-estimation.html#cb202-51" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Numerical instability detected at iteration&quot;</span>,</span>
<span id="cb202-52"><a href="non-linear-least-squares-estimation.html#cb202-52" tabindex="-1"></a>                    j,</span>
<span id="cb202-53"><a href="non-linear-least-squares-estimation.html#cb202-53" tabindex="-1"></a>                    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-54"><a href="non-linear-least-squares-estimation.html#cb202-54" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb202-55"><a href="non-linear-least-squares-estimation.html#cb202-55" tabindex="-1"></a>            }</span>
<span id="cb202-56"><a href="non-linear-least-squares-estimation.html#cb202-56" tabindex="-1"></a>            </span>
<span id="cb202-57"><a href="non-linear-least-squares-estimation.html#cb202-57" tabindex="-1"></a>            <span class="co"># Update step</span></span>
<span id="cb202-58"><a href="non-linear-least-squares-estimation.html#cb202-58" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> alpha <span class="sc">*</span> grad</span>
<span id="cb202-59"><a href="non-linear-least-squares-estimation.html#cb202-59" tabindex="-1"></a>            sse_values[j] <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_new, x, y)</span>
<span id="cb202-60"><a href="non-linear-least-squares-estimation.html#cb202-60" tabindex="-1"></a>            </span>
<span id="cb202-61"><a href="non-linear-least-squares-estimation.html#cb202-61" tabindex="-1"></a>            <span class="co"># Check for convergence</span></span>
<span id="cb202-62"><a href="non-linear-least-squares-estimation.html#cb202-62" tabindex="-1"></a>            <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(sse_values[j])) {</span>
<span id="cb202-63"><a href="non-linear-least-squares-estimation.html#cb202-63" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Divergence detected at iteration&quot;</span>, j, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-64"><a href="non-linear-least-squares-estimation.html#cb202-64" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb202-65"><a href="non-linear-least-squares-estimation.html#cb202-65" tabindex="-1"></a>            }</span>
<span id="cb202-66"><a href="non-linear-least-squares-estimation.html#cb202-66" tabindex="-1"></a>            </span>
<span id="cb202-67"><a href="non-linear-least-squares-estimation.html#cb202-67" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb202-68"><a href="non-linear-least-squares-estimation.html#cb202-68" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Converged in&quot;</span>, j, <span class="st">&quot;iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-69"><a href="non-linear-least-squares-estimation.html#cb202-69" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta_new, <span class="at">sse_values =</span> sse_values[<span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb202-70"><a href="non-linear-least-squares-estimation.html#cb202-70" tabindex="-1"></a>            }</span>
<span id="cb202-71"><a href="non-linear-least-squares-estimation.html#cb202-71" tabindex="-1"></a>            </span>
<span id="cb202-72"><a href="non-linear-least-squares-estimation.html#cb202-72" tabindex="-1"></a>            theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb202-73"><a href="non-linear-least-squares-estimation.html#cb202-73" tabindex="-1"></a>        }</span>
<span id="cb202-74"><a href="non-linear-least-squares-estimation.html#cb202-74" tabindex="-1"></a>        </span>
<span id="cb202-75"><a href="non-linear-least-squares-estimation.html#cb202-75" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta, <span class="at">sse_values =</span> sse_values))</span>
<span id="cb202-76"><a href="non-linear-least-squares-estimation.html#cb202-76" tabindex="-1"></a>    }</span>
<span id="cb202-77"><a href="non-linear-least-squares-estimation.html#cb202-77" tabindex="-1"></a></span>
<span id="cb202-78"><a href="non-linear-least-squares-estimation.html#cb202-78" tabindex="-1"></a><span class="co"># Run Gradient Descent with a Safe Implementation</span></span>
<span id="cb202-79"><a href="non-linear-least-squares-estimation.html#cb202-79" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial guess</span></span>
<span id="cb202-80"><a href="non-linear-least-squares-estimation.html#cb202-80" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.001</span>           <span class="co"># Learning rate</span></span>
<span id="cb202-81"><a href="non-linear-least-squares-estimation.html#cb202-81" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gradient_descent</span>(theta_init, x, y, alpha)</span>
<span id="cb202-82"><a href="non-linear-least-squares-estimation.html#cb202-82" tabindex="-1"></a><span class="co">#&gt; Divergence detected at iteration 1</span></span>
<span id="cb202-83"><a href="non-linear-least-squares-estimation.html#cb202-83" tabindex="-1"></a></span>
<span id="cb202-84"><a href="non-linear-least-squares-estimation.html#cb202-84" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb202-85"><a href="non-linear-least-squares-estimation.html#cb202-85" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> result<span class="sc">$</span>theta</span>
<span id="cb202-86"><a href="non-linear-least-squares-estimation.html#cb202-86" tabindex="-1"></a>sse_values <span class="ot">&lt;-</span> result<span class="sc">$</span>sse_values</span>
<span id="cb202-87"><a href="non-linear-least-squares-estimation.html#cb202-87" tabindex="-1"></a></span>
<span id="cb202-88"><a href="non-linear-least-squares-estimation.html#cb202-88" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb202-89"><a href="non-linear-least-squares-estimation.html#cb202-89" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) using Gradient Descent:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb202-90"><a href="non-linear-least-squares-estimation.html#cb202-90" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) using Gradient Descent:</span></span>
<span id="cb202-91"><a href="non-linear-least-squares-estimation.html#cb202-91" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb202-92"><a href="non-linear-least-squares-estimation.html#cb202-92" tabindex="-1"></a><span class="co">#&gt; [1] 1.0 0.1</span></span>
<span id="cb202-93"><a href="non-linear-least-squares-estimation.html#cb202-93" tabindex="-1"></a></span>
<span id="cb202-94"><a href="non-linear-least-squares-estimation.html#cb202-94" tabindex="-1"></a><span class="co"># Plot convergence of SSE over iterations</span></span>
<span id="cb202-95"><a href="non-linear-least-squares-estimation.html#cb202-95" tabindex="-1"></a><span class="co"># Ensure sse_values has valid data</span></span>
<span id="cb202-96"><a href="non-linear-least-squares-estimation.html#cb202-96" tabindex="-1"></a>sse_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb202-97"><a href="non-linear-least-squares-estimation.html#cb202-97" tabindex="-1"></a>  <span class="at">Iteration =</span> <span class="fu">seq_along</span>(sse_values),</span>
<span id="cb202-98"><a href="non-linear-least-squares-estimation.html#cb202-98" tabindex="-1"></a>  <span class="at">SSE =</span> sse_values</span>
<span id="cb202-99"><a href="non-linear-least-squares-estimation.html#cb202-99" tabindex="-1"></a>)</span>
<span id="cb202-100"><a href="non-linear-least-squares-estimation.html#cb202-100" tabindex="-1"></a></span>
<span id="cb202-101"><a href="non-linear-least-squares-estimation.html#cb202-101" tabindex="-1"></a><span class="co"># Generate improved plot using ggplot()</span></span>
<span id="cb202-102"><a href="non-linear-least-squares-estimation.html#cb202-102" tabindex="-1"></a><span class="fu">ggplot</span>(sse_df, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> SSE)) <span class="sc">+</span></span>
<span id="cb202-103"><a href="non-linear-least-squares-estimation.html#cb202-103" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb202-104"><a href="non-linear-least-squares-estimation.html#cb202-104" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb202-105"><a href="non-linear-least-squares-estimation.html#cb202-105" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Gradient Descent Convergence&quot;</span>,</span>
<span id="cb202-106"><a href="non-linear-least-squares-estimation.html#cb202-106" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb202-107"><a href="non-linear-least-squares-estimation.html#cb202-107" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;SSE&quot;</span></span>
<span id="cb202-108"><a href="non-linear-least-squares-estimation.html#cb202-108" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb202-109"><a href="non-linear-least-squares-estimation.html#cb202-109" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li><a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a> moves in the direction of steepest descent, which can lead to zigzagging behavior.</li>
<li>Slow convergence occurs when the curvature of the function varies significantly across dimensions.</li>
<li>Learning rate tuning is critical:
<ul>
<li><p>If too large, the algorithm diverges.</p></li>
<li><p>If too small, progress is very slow.</p></li>
</ul></li>
<li>Useful for initialization: It is often used to get close to the optimal solution before switching to more advanced methods like <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> or Newton’s method.</li>
</ol>
<p>Several advanced techniques improve the performance of steepest descent:</p>
<ul>
<li><p><strong>Momentum Gradient Descent</strong>: Adds a momentum term to smooth updates, reducing oscillations.</p></li>
<li><p><strong>Adaptive Learning Rates</strong>:</p>
<ul>
<li><p>AdaGrad: Adjusts <span class="math inline">\(\alpha_j\)</span> per parameter based on historical gradients.</p></li>
<li><p>RMSprop: Uses a moving average of past gradients to scale updates.</p></li>
<li><p>Adam (Adaptive Moment Estimation): Combines momentum and adaptive learning rates.</p></li>
</ul></li>
</ul>
<p>In practice, Adam is widely used in machine learning and deep learning, while Newton-based methods (including Gauss-Newton) are preferred for nonlinear regression.</p>
</div>
<div id="levenberg-marquardt" class="section level4 hasAnchor" number="6.2.1.4">
<h4><span class="header-section-number">6.2.1.4</span> Levenberg-Marquardt Algorithm<a href="non-linear-least-squares-estimation.html#levenberg-marquardt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Levenberg-Marquardt Algorithm is a widely used optimization method for solving nonlinear least squares problems. It is an adaptive technique that blends the <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> and <a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a>, dynamically switching between them based on problem conditions.</p>
<p>The update rule is:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j [\mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)}) + \tau \mathbf{I}_{p \times p}]\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\tau\)</span> is the <strong>damping parameter</strong>, controlling whether the step behaves like <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> or <a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a>.</li>
<li><span class="math inline">\(\mathbf{I}_{p \times p}\)</span> is the <strong>identity matrix</strong>, ensuring numerical stability.</li>
<li><span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span> is the <strong>Jacobian matrix</strong> of partial derivatives.</li>
<li><span class="math inline">\(\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong>.</li>
<li><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>, determining step size.</li>
</ul>
<p>The Levenberg-Marquardt algorithm is particularly useful when the Jacobian matrix <span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span> is nearly singular, meaning that <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> alone may fail.</p>
<ul>
<li>When <span class="math inline">\(\tau\)</span> is large, the method behaves like Steepest Descent, ensuring stability.</li>
<li>When <span class="math inline">\(\tau\)</span> is small, it behaves like Gauss-Newton, accelerating convergence.</li>
<li>Adaptive control of <span class="math inline">\(\tau\)</span>:
<ul>
<li>If <span class="math inline">\(SSE(\hat{\theta}^{(j+1)}) &lt; SSE(\hat{\theta}^{(j)})\)</span>, reduce <span class="math inline">\(\tau\)</span>: <span class="math display">\[
\tau \gets \tau / 10
\]</span></li>
<li>Otherwise, increase <span class="math inline">\(\tau\)</span> to stabilize: <span class="math display">\[
\tau \gets 10\tau
\]</span></li>
</ul></li>
</ul>
<p>This adjustment ensures that the algorithm moves efficiently while avoiding instability.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="non-linear-least-squares-estimation.html#cb203-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb203-2"><a href="non-linear-least-squares-estimation.html#cb203-2" tabindex="-1"></a><span class="fu">library</span>(minpack.lm)</span>
<span id="cb203-3"><a href="non-linear-least-squares-estimation.html#cb203-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb203-4"><a href="non-linear-least-squares-estimation.html#cb203-4" tabindex="-1"></a></span>
<span id="cb203-5"><a href="non-linear-least-squares-estimation.html#cb203-5" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb203-6"><a href="non-linear-least-squares-estimation.html#cb203-6" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb203-7"><a href="non-linear-least-squares-estimation.html#cb203-7" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb203-8"><a href="non-linear-least-squares-estimation.html#cb203-8" tabindex="-1"></a>}</span>
<span id="cb203-9"><a href="non-linear-least-squares-estimation.html#cb203-9" tabindex="-1"></a></span>
<span id="cb203-10"><a href="non-linear-least-squares-estimation.html#cb203-10" tabindex="-1"></a><span class="co"># Define SSE function</span></span>
<span id="cb203-11"><a href="non-linear-least-squares-estimation.html#cb203-11" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb203-12"><a href="non-linear-least-squares-estimation.html#cb203-12" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb203-13"><a href="non-linear-least-squares-estimation.html#cb203-13" tabindex="-1"></a>}</span>
<span id="cb203-14"><a href="non-linear-least-squares-estimation.html#cb203-14" tabindex="-1"></a></span>
<span id="cb203-15"><a href="non-linear-least-squares-estimation.html#cb203-15" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb203-16"><a href="non-linear-least-squares-estimation.html#cb203-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb203-17"><a href="non-linear-least-squares-estimation.html#cb203-17" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb203-18"><a href="non-linear-least-squares-estimation.html#cb203-18" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb203-19"><a href="non-linear-least-squares-estimation.html#cb203-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb203-20"><a href="non-linear-least-squares-estimation.html#cb203-20" tabindex="-1"></a></span>
<span id="cb203-21"><a href="non-linear-least-squares-estimation.html#cb203-21" tabindex="-1"></a><span class="co"># Robust Levenberg-Marquardt Optimization Implementation</span></span>
<span id="cb203-22"><a href="non-linear-least-squares-estimation.html#cb203-22" tabindex="-1"></a>levenberg_marquardt <span class="ot">&lt;-</span></span>
<span id="cb203-23"><a href="non-linear-least-squares-estimation.html#cb203-23" tabindex="-1"></a>    <span class="cf">function</span>(theta_init,</span>
<span id="cb203-24"><a href="non-linear-least-squares-estimation.html#cb203-24" tabindex="-1"></a>             x,</span>
<span id="cb203-25"><a href="non-linear-least-squares-estimation.html#cb203-25" tabindex="-1"></a>             y,</span>
<span id="cb203-26"><a href="non-linear-least-squares-estimation.html#cb203-26" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb203-27"><a href="non-linear-least-squares-estimation.html#cb203-27" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">500</span>,</span>
<span id="cb203-28"><a href="non-linear-least-squares-estimation.html#cb203-28" tabindex="-1"></a>             <span class="at">tau_init =</span> <span class="dv">1</span>) {</span>
<span id="cb203-29"><a href="non-linear-least-squares-estimation.html#cb203-29" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb203-30"><a href="non-linear-least-squares-estimation.html#cb203-30" tabindex="-1"></a>        tau <span class="ot">&lt;-</span> tau_init</span>
<span id="cb203-31"><a href="non-linear-least-squares-estimation.html#cb203-31" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> <span class="fl">1e-8</span>  <span class="co"># Small regularization term</span></span>
<span id="cb203-32"><a href="non-linear-least-squares-estimation.html#cb203-32" tabindex="-1"></a>        sse_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_iter)</span>
<span id="cb203-33"><a href="non-linear-least-squares-estimation.html#cb203-33" tabindex="-1"></a>        </span>
<span id="cb203-34"><a href="non-linear-least-squares-estimation.html#cb203-34" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb203-35"><a href="non-linear-least-squares-estimation.html#cb203-35" tabindex="-1"></a>            <span class="co"># Compute Jacobian matrix numerically</span></span>
<span id="cb203-36"><a href="non-linear-least-squares-estimation.html#cb203-36" tabindex="-1"></a>            epsilon <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb203-37"><a href="non-linear-least-squares-estimation.html#cb203-37" tabindex="-1"></a>            F_matrix <span class="ot">&lt;-</span></span>
<span id="cb203-38"><a href="non-linear-least-squares-estimation.html#cb203-38" tabindex="-1"></a>                <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(y), <span class="at">ncol =</span> <span class="fu">length</span>(theta))</span>
<span id="cb203-39"><a href="non-linear-least-squares-estimation.html#cb203-39" tabindex="-1"></a>            <span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)) {</span>
<span id="cb203-40"><a href="non-linear-least-squares-estimation.html#cb203-40" tabindex="-1"></a>                theta_perturb <span class="ot">&lt;-</span> theta</span>
<span id="cb203-41"><a href="non-linear-least-squares-estimation.html#cb203-41" tabindex="-1"></a>                theta_perturb[p] <span class="ot">&lt;-</span> theta[p] <span class="sc">+</span> epsilon</span>
<span id="cb203-42"><a href="non-linear-least-squares-estimation.html#cb203-42" tabindex="-1"></a>                F_matrix[, p] <span class="ot">&lt;-</span></span>
<span id="cb203-43"><a href="non-linear-least-squares-estimation.html#cb203-43" tabindex="-1"></a>                    (<span class="fu">nonlinear_model</span>(theta_perturb, x) </span>
<span id="cb203-44"><a href="non-linear-least-squares-estimation.html#cb203-44" tabindex="-1"></a>                     <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">/</span> epsilon</span>
<span id="cb203-45"><a href="non-linear-least-squares-estimation.html#cb203-45" tabindex="-1"></a>            }</span>
<span id="cb203-46"><a href="non-linear-least-squares-estimation.html#cb203-46" tabindex="-1"></a>            </span>
<span id="cb203-47"><a href="non-linear-least-squares-estimation.html#cb203-47" tabindex="-1"></a>            <span class="co"># Compute residuals</span></span>
<span id="cb203-48"><a href="non-linear-least-squares-estimation.html#cb203-48" tabindex="-1"></a>            residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb203-49"><a href="non-linear-least-squares-estimation.html#cb203-49" tabindex="-1"></a>            </span>
<span id="cb203-50"><a href="non-linear-least-squares-estimation.html#cb203-50" tabindex="-1"></a>            <span class="co"># Compute Levenberg-Marquardt update</span></span>
<span id="cb203-51"><a href="non-linear-least-squares-estimation.html#cb203-51" tabindex="-1"></a>            A <span class="ot">&lt;-</span></span>
<span id="cb203-52"><a href="non-linear-least-squares-estimation.html#cb203-52" tabindex="-1"></a>                <span class="fu">t</span>(F_matrix) <span class="sc">%*%</span> F_matrix <span class="sc">+</span> tau <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">length</span>(theta)) </span>
<span id="cb203-53"><a href="non-linear-least-squares-estimation.html#cb203-53" tabindex="-1"></a>            <span class="sc">+</span> lambda <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">length</span>(theta))  <span class="co"># Regularized A</span></span>
<span id="cb203-54"><a href="non-linear-least-squares-estimation.html#cb203-54" tabindex="-1"></a>            delta <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb203-55"><a href="non-linear-least-squares-estimation.html#cb203-55" tabindex="-1"></a>                <span class="fu">solve</span>(A) <span class="sc">%*%</span> <span class="fu">t</span>(F_matrix) <span class="sc">%*%</span> residuals,</span>
<span id="cb203-56"><a href="non-linear-least-squares-estimation.html#cb203-56" tabindex="-1"></a>                <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb203-57"><a href="non-linear-least-squares-estimation.html#cb203-57" tabindex="-1"></a>                    <span class="fu">cat</span>(<span class="st">&quot;Singular matrix detected at iteration&quot;</span>,</span>
<span id="cb203-58"><a href="non-linear-least-squares-estimation.html#cb203-58" tabindex="-1"></a>                        j,</span>
<span id="cb203-59"><a href="non-linear-least-squares-estimation.html#cb203-59" tabindex="-1"></a>                        <span class="st">&quot;- Increasing tau</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb203-60"><a href="non-linear-least-squares-estimation.html#cb203-60" tabindex="-1"></a>                    tau <span class="ot">&lt;&lt;-</span> tau <span class="sc">*</span> <span class="dv">10</span>  <span class="co"># Increase tau to stabilize</span></span>
<span id="cb203-61"><a href="non-linear-least-squares-estimation.html#cb203-61" tabindex="-1"></a>                    <span class="co"># Return zero delta to avoid NaN updates</span></span>
<span id="cb203-62"><a href="non-linear-least-squares-estimation.html#cb203-62" tabindex="-1"></a>                    <span class="fu">return</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(theta)))  </span>
<span id="cb203-63"><a href="non-linear-least-squares-estimation.html#cb203-63" tabindex="-1"></a>                }</span>
<span id="cb203-64"><a href="non-linear-least-squares-estimation.html#cb203-64" tabindex="-1"></a>            )</span>
<span id="cb203-65"><a href="non-linear-least-squares-estimation.html#cb203-65" tabindex="-1"></a>            </span>
<span id="cb203-66"><a href="non-linear-least-squares-estimation.html#cb203-66" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">+</span> delta</span>
<span id="cb203-67"><a href="non-linear-least-squares-estimation.html#cb203-67" tabindex="-1"></a>            </span>
<span id="cb203-68"><a href="non-linear-least-squares-estimation.html#cb203-68" tabindex="-1"></a>            <span class="co"># Compute new SSE</span></span>
<span id="cb203-69"><a href="non-linear-least-squares-estimation.html#cb203-69" tabindex="-1"></a>            sse_values[j] <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_new, x, y)</span>
<span id="cb203-70"><a href="non-linear-least-squares-estimation.html#cb203-70" tabindex="-1"></a>            </span>
<span id="cb203-71"><a href="non-linear-least-squares-estimation.html#cb203-71" tabindex="-1"></a>            <span class="co"># Adjust tau dynamically</span></span>
<span id="cb203-72"><a href="non-linear-least-squares-estimation.html#cb203-72" tabindex="-1"></a>            <span class="cf">if</span> (sse_values[j] <span class="sc">&lt;</span> <span class="fu">sse</span>(theta, x, y)) {</span>
<span id="cb203-73"><a href="non-linear-least-squares-estimation.html#cb203-73" tabindex="-1"></a>                <span class="co"># Reduce tau but prevent it from going too low</span></span>
<span id="cb203-74"><a href="non-linear-least-squares-estimation.html#cb203-74" tabindex="-1"></a>                tau <span class="ot">&lt;-</span></span>
<span id="cb203-75"><a href="non-linear-least-squares-estimation.html#cb203-75" tabindex="-1"></a>                    <span class="fu">max</span>(tau <span class="sc">/</span> <span class="dv">10</span>, <span class="fl">1e-8</span>)  </span>
<span id="cb203-76"><a href="non-linear-least-squares-estimation.html#cb203-76" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb203-77"><a href="non-linear-least-squares-estimation.html#cb203-77" tabindex="-1"></a>                tau <span class="ot">&lt;-</span> tau <span class="sc">*</span> <span class="dv">10</span>  <span class="co"># Increase tau if SSE increases</span></span>
<span id="cb203-78"><a href="non-linear-least-squares-estimation.html#cb203-78" tabindex="-1"></a>            }</span>
<span id="cb203-79"><a href="non-linear-least-squares-estimation.html#cb203-79" tabindex="-1"></a>            </span>
<span id="cb203-80"><a href="non-linear-least-squares-estimation.html#cb203-80" tabindex="-1"></a>            <span class="co"># Check for convergence</span></span>
<span id="cb203-81"><a href="non-linear-least-squares-estimation.html#cb203-81" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(delta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb203-82"><a href="non-linear-least-squares-estimation.html#cb203-82" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Converged in&quot;</span>, j, <span class="st">&quot;iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb203-83"><a href="non-linear-least-squares-estimation.html#cb203-83" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta_new, <span class="at">sse_values =</span> sse_values[<span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb203-84"><a href="non-linear-least-squares-estimation.html#cb203-84" tabindex="-1"></a>            }</span>
<span id="cb203-85"><a href="non-linear-least-squares-estimation.html#cb203-85" tabindex="-1"></a>            </span>
<span id="cb203-86"><a href="non-linear-least-squares-estimation.html#cb203-86" tabindex="-1"></a>            theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb203-87"><a href="non-linear-least-squares-estimation.html#cb203-87" tabindex="-1"></a>        }</span>
<span id="cb203-88"><a href="non-linear-least-squares-estimation.html#cb203-88" tabindex="-1"></a>        </span>
<span id="cb203-89"><a href="non-linear-least-squares-estimation.html#cb203-89" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta, <span class="at">sse_values =</span> sse_values))</span>
<span id="cb203-90"><a href="non-linear-least-squares-estimation.html#cb203-90" tabindex="-1"></a>    }</span>
<span id="cb203-91"><a href="non-linear-least-squares-estimation.html#cb203-91" tabindex="-1"></a></span>
<span id="cb203-92"><a href="non-linear-least-squares-estimation.html#cb203-92" tabindex="-1"></a><span class="co"># Run Levenberg-Marquardt</span></span>
<span id="cb203-93"><a href="non-linear-least-squares-estimation.html#cb203-93" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial guess</span></span>
<span id="cb203-94"><a href="non-linear-least-squares-estimation.html#cb203-94" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">levenberg_marquardt</span>(theta_init, x, y)</span>
<span id="cb203-95"><a href="non-linear-least-squares-estimation.html#cb203-95" tabindex="-1"></a><span class="co">#&gt; Singular matrix detected at iteration 11 - Increasing tau</span></span>
<span id="cb203-96"><a href="non-linear-least-squares-estimation.html#cb203-96" tabindex="-1"></a><span class="co">#&gt; Converged in 11 iterations.</span></span>
<span id="cb203-97"><a href="non-linear-least-squares-estimation.html#cb203-97" tabindex="-1"></a></span>
<span id="cb203-98"><a href="non-linear-least-squares-estimation.html#cb203-98" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb203-99"><a href="non-linear-least-squares-estimation.html#cb203-99" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> result<span class="sc">$</span>theta</span>
<span id="cb203-100"><a href="non-linear-least-squares-estimation.html#cb203-100" tabindex="-1"></a>sse_values <span class="ot">&lt;-</span> result<span class="sc">$</span>sse_values</span>
<span id="cb203-101"><a href="non-linear-least-squares-estimation.html#cb203-101" tabindex="-1"></a></span>
<span id="cb203-102"><a href="non-linear-least-squares-estimation.html#cb203-102" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb203-103"><a href="non-linear-least-squares-estimation.html#cb203-103" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) using Levenberg-Marquardt:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb203-104"><a href="non-linear-least-squares-estimation.html#cb203-104" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) using Levenberg-Marquardt:</span></span>
<span id="cb203-105"><a href="non-linear-least-squares-estimation.html#cb203-105" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb203-106"><a href="non-linear-least-squares-estimation.html#cb203-106" tabindex="-1"></a><span class="co">#&gt;               [,1]</span></span>
<span id="cb203-107"><a href="non-linear-least-squares-estimation.html#cb203-107" tabindex="-1"></a><span class="co">#&gt; [1,] -6.473440e-09</span></span>
<span id="cb203-108"><a href="non-linear-least-squares-estimation.html#cb203-108" tabindex="-1"></a><span class="co">#&gt; [2,]  1.120637e+01</span></span>
<span id="cb203-109"><a href="non-linear-least-squares-estimation.html#cb203-109" tabindex="-1"></a></span>
<span id="cb203-110"><a href="non-linear-least-squares-estimation.html#cb203-110" tabindex="-1"></a><span class="co"># Plot convergence of SSE over iterations</span></span>
<span id="cb203-111"><a href="non-linear-least-squares-estimation.html#cb203-111" tabindex="-1"></a>sse_df <span class="ot">&lt;-</span></span>
<span id="cb203-112"><a href="non-linear-least-squares-estimation.html#cb203-112" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Iteration =</span> <span class="fu">seq_along</span>(sse_values), <span class="at">SSE =</span> sse_values)</span>
<span id="cb203-113"><a href="non-linear-least-squares-estimation.html#cb203-113" tabindex="-1"></a></span>
<span id="cb203-114"><a href="non-linear-least-squares-estimation.html#cb203-114" tabindex="-1"></a><span class="fu">ggplot</span>(sse_df, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> SSE)) <span class="sc">+</span></span>
<span id="cb203-115"><a href="non-linear-least-squares-estimation.html#cb203-115" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb203-116"><a href="non-linear-least-squares-estimation.html#cb203-116" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Levenberg-Marquardt Convergence&quot;</span>,</span>
<span id="cb203-117"><a href="non-linear-least-squares-estimation.html#cb203-117" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb203-118"><a href="non-linear-least-squares-estimation.html#cb203-118" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;SSE&quot;</span>) <span class="sc">+</span></span>
<span id="cb203-119"><a href="non-linear-least-squares-estimation.html#cb203-119" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li><p>Early Stability (Flat SSE)</p>
<ul>
<li><p>The SSE remains near zero for the first few iterations, which suggests that the algorithm is initially behaving stably.</p></li>
<li><p>This might indicate that the initial parameter guess is reasonable, or that the updates are too small to significantly affect SSE.</p></li>
</ul></li>
<li><p>Sudden Explosion in SSE (Iteration ~8-9)</p>
<ul>
<li><p>The sharp spike in SSE at iteration 9 indicates a numerical instability or divergence in the optimization process.</p></li>
<li><p>This could be due to:</p>
<ul>
<li><p>An ill-conditioned Jacobian matrix: The step direction is poorly estimated, leading to an unstable jump.</p></li>
<li><p>A sudden large update (<code>delta</code>): The damping parameter (<code>tau</code>) might have been reduced too aggressively, causing an uncontrolled step.</p></li>
<li><p>Floating-point issues: If <code>A</code> becomes nearly singular, solving <code>A \ delta = residuals</code> may produce excessively large values.</p></li>
</ul></li>
</ul></li>
<li><p>Return to Stability (After Iteration 9)</p>
<ul>
<li><p>The SSE immediately returns to a low value after the spike, which suggests that the damping parameter (<code>tau</code>) might have been increased after detecting instability.</p></li>
<li><p>This is consistent with the adaptive nature of Levenberg-Marquardt:</p>
<ul>
<li><p>If a step leads to a bad SSE increase, the algorithm increases <code>tau</code> to make the next step more conservative.</p></li>
<li><p>If the next step stabilizes, <code>tau</code> may be reduced again.</p></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="newton-raphson" class="section level4 hasAnchor" number="6.2.1.5">
<h4><span class="header-section-number">6.2.1.5</span> Newton-Raphson Algorithm<a href="non-linear-least-squares-estimation.html#newton-raphson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Newton-Raphson method is a second-order optimization technique used for nonlinear least squares problems. Unlike first-order methods (such as <a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a> and <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a>), Newton-Raphson uses both first and second derivatives of the objective function for faster convergence.</p>
<p>The update rule is:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \left[\frac{\partial^2 Q(\hat{\theta}^{(j)})}{\partial \theta \partial \theta&#39;}\right]^{-1} \frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong> (first derivative of the objective function).</li>
<li><span class="math inline">\(\frac{\partial^2 Q(\hat{\theta}^{(j)})}{\partial \theta \partial \theta&#39;}\)</span> is the <strong>Hessian matrix</strong> (second derivative of the objective function).</li>
<li><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>, controlling step size.</li>
</ul>
<p>The <strong>Hessian matrix</strong> in nonlinear least squares problems is:</p>
<p><span class="math display">\[
\frac{\partial^2 Q(\hat{\theta}^{(j)})}{\partial \theta \partial \theta&#39;} = 2 \mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)}) - 2\sum_{i=1}^{n} [Y_i - f(x_i;\theta)] \frac{\partial^2 f(x_i;\theta)}{\partial \theta \partial \theta&#39;}
\]</span></p>
<p>where:</p>
<ul>
<li>The first term <span class="math inline">\(2 \mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)})\)</span> is the same as in the <a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a>.</li>
<li>The second term <span class="math inline">\(-2\sum_{i=1}^{n} [Y_i - f(x_i;\theta)] \frac{\partial^2 f(x_i;\theta)}{\partial \theta \partial \theta&#39;}\)</span> contains second-order derivatives.</li>
</ul>
<p><strong>Key Observations</strong></p>
<ul>
<li>Gauss-Newton vs. Newton-Raphson:
<ul>
<li>Gauss-Newton approximates the Hessian by ignoring the second term.</li>
<li>Newton-Raphson explicitly incorporates second-order derivatives, making it more precise but computationally expensive.</li>
</ul></li>
<li>Challenges:
<ul>
<li>The Hessian matrix may be singular, making it impossible to invert.</li>
<li>Computing second derivatives is often difficult for complex functions.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="non-linear-least-squares-estimation.html#cb204-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb204-2"><a href="non-linear-least-squares-estimation.html#cb204-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb204-3"><a href="non-linear-least-squares-estimation.html#cb204-3" tabindex="-1"></a></span>
<span id="cb204-4"><a href="non-linear-least-squares-estimation.html#cb204-4" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb204-5"><a href="non-linear-least-squares-estimation.html#cb204-5" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb204-6"><a href="non-linear-least-squares-estimation.html#cb204-6" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb204-7"><a href="non-linear-least-squares-estimation.html#cb204-7" tabindex="-1"></a>}</span>
<span id="cb204-8"><a href="non-linear-least-squares-estimation.html#cb204-8" tabindex="-1"></a></span>
<span id="cb204-9"><a href="non-linear-least-squares-estimation.html#cb204-9" tabindex="-1"></a><span class="co"># Define SSE function</span></span>
<span id="cb204-10"><a href="non-linear-least-squares-estimation.html#cb204-10" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb204-11"><a href="non-linear-least-squares-estimation.html#cb204-11" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb204-12"><a href="non-linear-least-squares-estimation.html#cb204-12" tabindex="-1"></a>}</span>
<span id="cb204-13"><a href="non-linear-least-squares-estimation.html#cb204-13" tabindex="-1"></a></span>
<span id="cb204-14"><a href="non-linear-least-squares-estimation.html#cb204-14" tabindex="-1"></a><span class="co"># Compute Gradient (First Derivative) of SSE</span></span>
<span id="cb204-15"><a href="non-linear-least-squares-estimation.html#cb204-15" tabindex="-1"></a>gradient_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb204-16"><a href="non-linear-least-squares-estimation.html#cb204-16" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb204-17"><a href="non-linear-least-squares-estimation.html#cb204-17" tabindex="-1"></a>    </span>
<span id="cb204-18"><a href="non-linear-least-squares-estimation.html#cb204-18" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_1</span></span>
<span id="cb204-19"><a href="non-linear-least-squares-estimation.html#cb204-19" tabindex="-1"></a>    grad_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb204-20"><a href="non-linear-least-squares-estimation.html#cb204-20" tabindex="-1"></a>    </span>
<span id="cb204-21"><a href="non-linear-least-squares-estimation.html#cb204-21" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_2</span></span>
<span id="cb204-22"><a href="non-linear-least-squares-estimation.html#cb204-22" tabindex="-1"></a>    grad_2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> theta[<span class="dv">1</span>] <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb204-23"><a href="non-linear-least-squares-estimation.html#cb204-23" tabindex="-1"></a>    </span>
<span id="cb204-24"><a href="non-linear-least-squares-estimation.html#cb204-24" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(grad_1, grad_2))</span>
<span id="cb204-25"><a href="non-linear-least-squares-estimation.html#cb204-25" tabindex="-1"></a>}</span>
<span id="cb204-26"><a href="non-linear-least-squares-estimation.html#cb204-26" tabindex="-1"></a></span>
<span id="cb204-27"><a href="non-linear-least-squares-estimation.html#cb204-27" tabindex="-1"></a><span class="co"># Compute Hessian (Second Derivative) of SSE</span></span>
<span id="cb204-28"><a href="non-linear-least-squares-estimation.html#cb204-28" tabindex="-1"></a>hessian_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb204-29"><a href="non-linear-least-squares-estimation.html#cb204-29" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb204-30"><a href="non-linear-least-squares-estimation.html#cb204-30" tabindex="-1"></a>    </span>
<span id="cb204-31"><a href="non-linear-least-squares-estimation.html#cb204-31" tabindex="-1"></a>    <span class="co"># Compute second derivatives</span></span>
<span id="cb204-32"><a href="non-linear-least-squares-estimation.html#cb204-32" tabindex="-1"></a>    H_11 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb204-33"><a href="non-linear-least-squares-estimation.html#cb204-33" tabindex="-1"></a>    H_12 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(x <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x) <span class="sc">*</span> theta[<span class="dv">1</span>])</span>
<span id="cb204-34"><a href="non-linear-least-squares-estimation.html#cb204-34" tabindex="-1"></a>    H_21 <span class="ot">&lt;-</span> H_12</span>
<span id="cb204-35"><a href="non-linear-least-squares-estimation.html#cb204-35" tabindex="-1"></a>    </span>
<span id="cb204-36"><a href="non-linear-least-squares-estimation.html#cb204-36" tabindex="-1"></a>    term1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x) <span class="sc">*</span> theta[<span class="dv">1</span>] <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb204-37"><a href="non-linear-least-squares-estimation.html#cb204-37" tabindex="-1"></a>    term2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> (x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb204-38"><a href="non-linear-least-squares-estimation.html#cb204-38" tabindex="-1"></a>    </span>
<span id="cb204-39"><a href="non-linear-least-squares-estimation.html#cb204-39" tabindex="-1"></a>    H_22 <span class="ot">&lt;-</span> term1 <span class="sc">-</span> term2</span>
<span id="cb204-40"><a href="non-linear-least-squares-estimation.html#cb204-40" tabindex="-1"></a>    </span>
<span id="cb204-41"><a href="non-linear-least-squares-estimation.html#cb204-41" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">matrix</span>(</span>
<span id="cb204-42"><a href="non-linear-least-squares-estimation.html#cb204-42" tabindex="-1"></a>        <span class="fu">c</span>(H_11, H_12, H_21, H_22),</span>
<span id="cb204-43"><a href="non-linear-least-squares-estimation.html#cb204-43" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb204-44"><a href="non-linear-least-squares-estimation.html#cb204-44" tabindex="-1"></a>        <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb204-45"><a href="non-linear-least-squares-estimation.html#cb204-45" tabindex="-1"></a>    ))</span>
<span id="cb204-46"><a href="non-linear-least-squares-estimation.html#cb204-46" tabindex="-1"></a>}</span>
<span id="cb204-47"><a href="non-linear-least-squares-estimation.html#cb204-47" tabindex="-1"></a></span>
<span id="cb204-48"><a href="non-linear-least-squares-estimation.html#cb204-48" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb204-49"><a href="non-linear-least-squares-estimation.html#cb204-49" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb204-50"><a href="non-linear-least-squares-estimation.html#cb204-50" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb204-51"><a href="non-linear-least-squares-estimation.html#cb204-51" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb204-52"><a href="non-linear-least-squares-estimation.html#cb204-52" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb204-53"><a href="non-linear-least-squares-estimation.html#cb204-53" tabindex="-1"></a></span>
<span id="cb204-54"><a href="non-linear-least-squares-estimation.html#cb204-54" tabindex="-1"></a><span class="co"># Newton-Raphson Optimization Implementation</span></span>
<span id="cb204-55"><a href="non-linear-least-squares-estimation.html#cb204-55" tabindex="-1"></a>newton_raphson <span class="ot">&lt;-</span></span>
<span id="cb204-56"><a href="non-linear-least-squares-estimation.html#cb204-56" tabindex="-1"></a>    <span class="cf">function</span>(theta_init,</span>
<span id="cb204-57"><a href="non-linear-least-squares-estimation.html#cb204-57" tabindex="-1"></a>             x,</span>
<span id="cb204-58"><a href="non-linear-least-squares-estimation.html#cb204-58" tabindex="-1"></a>             y,</span>
<span id="cb204-59"><a href="non-linear-least-squares-estimation.html#cb204-59" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb204-60"><a href="non-linear-least-squares-estimation.html#cb204-60" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">500</span>) {</span>
<span id="cb204-61"><a href="non-linear-least-squares-estimation.html#cb204-61" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb204-62"><a href="non-linear-least-squares-estimation.html#cb204-62" tabindex="-1"></a>        sse_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_iter)</span>
<span id="cb204-63"><a href="non-linear-least-squares-estimation.html#cb204-63" tabindex="-1"></a>        </span>
<span id="cb204-64"><a href="non-linear-least-squares-estimation.html#cb204-64" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb204-65"><a href="non-linear-least-squares-estimation.html#cb204-65" tabindex="-1"></a>            grad <span class="ot">&lt;-</span> <span class="fu">gradient_sse</span>(theta, x, y)</span>
<span id="cb204-66"><a href="non-linear-least-squares-estimation.html#cb204-66" tabindex="-1"></a>            hessian <span class="ot">&lt;-</span> <span class="fu">hessian_sse</span>(theta, x, y)</span>
<span id="cb204-67"><a href="non-linear-least-squares-estimation.html#cb204-67" tabindex="-1"></a>            </span>
<span id="cb204-68"><a href="non-linear-least-squares-estimation.html#cb204-68" tabindex="-1"></a>            <span class="co"># Check if Hessian is invertible</span></span>
<span id="cb204-69"><a href="non-linear-least-squares-estimation.html#cb204-69" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">det</span>(hessian) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb204-70"><a href="non-linear-least-squares-estimation.html#cb204-70" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Hessian is singular at iteration&quot;</span>,</span>
<span id="cb204-71"><a href="non-linear-least-squares-estimation.html#cb204-71" tabindex="-1"></a>                    j,</span>
<span id="cb204-72"><a href="non-linear-least-squares-estimation.html#cb204-72" tabindex="-1"></a>                    <span class="st">&quot;- Using identity matrix instead.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb204-73"><a href="non-linear-least-squares-estimation.html#cb204-73" tabindex="-1"></a>                <span class="co"># Replace with identity matrix if singular</span></span>
<span id="cb204-74"><a href="non-linear-least-squares-estimation.html#cb204-74" tabindex="-1"></a>                hessian <span class="ot">&lt;-</span></span>
<span id="cb204-75"><a href="non-linear-least-squares-estimation.html#cb204-75" tabindex="-1"></a>                    <span class="fu">diag</span>(<span class="fu">length</span>(theta))  </span>
<span id="cb204-76"><a href="non-linear-least-squares-estimation.html#cb204-76" tabindex="-1"></a>            }</span>
<span id="cb204-77"><a href="non-linear-least-squares-estimation.html#cb204-77" tabindex="-1"></a>            </span>
<span id="cb204-78"><a href="non-linear-least-squares-estimation.html#cb204-78" tabindex="-1"></a>            <span class="co"># Compute Newton update</span></span>
<span id="cb204-79"><a href="non-linear-least-squares-estimation.html#cb204-79" tabindex="-1"></a>            delta <span class="ot">&lt;-</span> <span class="fu">solve</span>(hessian) <span class="sc">%*%</span> grad</span>
<span id="cb204-80"><a href="non-linear-least-squares-estimation.html#cb204-80" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> delta</span>
<span id="cb204-81"><a href="non-linear-least-squares-estimation.html#cb204-81" tabindex="-1"></a>            sse_values[j] <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_new, x, y)</span>
<span id="cb204-82"><a href="non-linear-least-squares-estimation.html#cb204-82" tabindex="-1"></a>            </span>
<span id="cb204-83"><a href="non-linear-least-squares-estimation.html#cb204-83" tabindex="-1"></a>            <span class="co"># Check for convergence</span></span>
<span id="cb204-84"><a href="non-linear-least-squares-estimation.html#cb204-84" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(delta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb204-85"><a href="non-linear-least-squares-estimation.html#cb204-85" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Converged in&quot;</span>, j, <span class="st">&quot;iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb204-86"><a href="non-linear-least-squares-estimation.html#cb204-86" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta_new, <span class="at">sse_values =</span> sse_values[<span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb204-87"><a href="non-linear-least-squares-estimation.html#cb204-87" tabindex="-1"></a>            }</span>
<span id="cb204-88"><a href="non-linear-least-squares-estimation.html#cb204-88" tabindex="-1"></a>            </span>
<span id="cb204-89"><a href="non-linear-least-squares-estimation.html#cb204-89" tabindex="-1"></a>            theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb204-90"><a href="non-linear-least-squares-estimation.html#cb204-90" tabindex="-1"></a>        }</span>
<span id="cb204-91"><a href="non-linear-least-squares-estimation.html#cb204-91" tabindex="-1"></a>        </span>
<span id="cb204-92"><a href="non-linear-least-squares-estimation.html#cb204-92" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta, <span class="at">sse_values =</span> sse_values))</span>
<span id="cb204-93"><a href="non-linear-least-squares-estimation.html#cb204-93" tabindex="-1"></a>    }</span>
<span id="cb204-94"><a href="non-linear-least-squares-estimation.html#cb204-94" tabindex="-1"></a></span>
<span id="cb204-95"><a href="non-linear-least-squares-estimation.html#cb204-95" tabindex="-1"></a><span class="co"># Run Newton-Raphson</span></span>
<span id="cb204-96"><a href="non-linear-least-squares-estimation.html#cb204-96" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial guess</span></span>
<span id="cb204-97"><a href="non-linear-least-squares-estimation.html#cb204-97" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">newton_raphson</span>(theta_init, x, y)</span>
<span id="cb204-98"><a href="non-linear-least-squares-estimation.html#cb204-98" tabindex="-1"></a><span class="co">#&gt; Converged in 222 iterations.</span></span>
<span id="cb204-99"><a href="non-linear-least-squares-estimation.html#cb204-99" tabindex="-1"></a></span>
<span id="cb204-100"><a href="non-linear-least-squares-estimation.html#cb204-100" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb204-101"><a href="non-linear-least-squares-estimation.html#cb204-101" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> result<span class="sc">$</span>theta</span>
<span id="cb204-102"><a href="non-linear-least-squares-estimation.html#cb204-102" tabindex="-1"></a>sse_values <span class="ot">&lt;-</span> result<span class="sc">$</span>sse_values</span>
<span id="cb204-103"><a href="non-linear-least-squares-estimation.html#cb204-103" tabindex="-1"></a></span>
<span id="cb204-104"><a href="non-linear-least-squares-estimation.html#cb204-104" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb204-105"><a href="non-linear-least-squares-estimation.html#cb204-105" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) using Newton-Raphson:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb204-106"><a href="non-linear-least-squares-estimation.html#cb204-106" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) using Newton-Raphson:</span></span>
<span id="cb204-107"><a href="non-linear-least-squares-estimation.html#cb204-107" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb204-108"><a href="non-linear-least-squares-estimation.html#cb204-108" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb204-109"><a href="non-linear-least-squares-estimation.html#cb204-109" tabindex="-1"></a><span class="co">#&gt; [1,] 1.9934188</span></span>
<span id="cb204-110"><a href="non-linear-least-squares-estimation.html#cb204-110" tabindex="-1"></a><span class="co">#&gt; [2,] 0.3008742</span></span>
<span id="cb204-111"><a href="non-linear-least-squares-estimation.html#cb204-111" tabindex="-1"></a></span>
<span id="cb204-112"><a href="non-linear-least-squares-estimation.html#cb204-112" tabindex="-1"></a><span class="co"># Plot convergence of SSE over iterations</span></span>
<span id="cb204-113"><a href="non-linear-least-squares-estimation.html#cb204-113" tabindex="-1"></a>sse_df <span class="ot">&lt;-</span></span>
<span id="cb204-114"><a href="non-linear-least-squares-estimation.html#cb204-114" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Iteration =</span> <span class="fu">seq_along</span>(sse_values), <span class="at">SSE =</span> sse_values)</span>
<span id="cb204-115"><a href="non-linear-least-squares-estimation.html#cb204-115" tabindex="-1"></a></span>
<span id="cb204-116"><a href="non-linear-least-squares-estimation.html#cb204-116" tabindex="-1"></a><span class="fu">ggplot</span>(sse_df, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> SSE)) <span class="sc">+</span></span>
<span id="cb204-117"><a href="non-linear-least-squares-estimation.html#cb204-117" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb204-118"><a href="non-linear-least-squares-estimation.html#cb204-118" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Newton-Raphson Convergence&quot;</span>,</span>
<span id="cb204-119"><a href="non-linear-least-squares-estimation.html#cb204-119" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb204-120"><a href="non-linear-least-squares-estimation.html#cb204-120" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;SSE&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-121"><a href="non-linear-least-squares-estimation.html#cb204-121" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="quasi-newton-method" class="section level4 hasAnchor" number="6.2.1.6">
<h4><span class="header-section-number">6.2.1.6</span> Quasi-Newton Method<a href="non-linear-least-squares-estimation.html#quasi-newton-method" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Quasi-Newton method is an optimization technique that approximates Newton’s method without requiring explicit computation of the Hessian matrix. Instead, it iteratively constructs an approximation <span class="math inline">\(\mathbf{H}_j\)</span> to the Hessian based on the first derivative information.</p>
<p>The update rule is:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{H}_j^{-1}\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{H}_j\)</span> is a <strong>symmetric positive definite approximation</strong> to the <strong>Hessian matrix</strong>.</li>
<li>As <span class="math inline">\(j \to \infty\)</span>, <span class="math inline">\(\mathbf{H}_j\)</span> gets closer to the <strong>true Hessian</strong>.</li>
<li><span class="math inline">\(\frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong>.</li>
<li><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>, controlling step size.</li>
</ul>
<p>Why Use Quasi-Newton Instead of <a href="non-linear-least-squares-estimation.html#newton-raphson">Newton-Raphson Method</a>?</p>
<ul>
<li>Newton-Raphson requires computing the Hessian matrix explicitly, which is computationally expensive and may be singular.</li>
<li>Quasi-Newton avoids computing the Hessian directly by approximating it iteratively.</li>
<li>Among first-order methods (which only require gradients, not Hessians), Quasi-Newton methods perform best.</li>
</ul>
<hr />
<p><strong>Hessian Approximation</strong></p>
<p>Instead of directly computing the Hessian <span class="math inline">\(\mathbf{H}_j\)</span>, Quasi-Newton methods update an approximation <span class="math inline">\(\mathbf{H}_j\)</span> iteratively.</p>
<p>One of the most widely used formulas is the <strong>Broyden-Fletcher-Goldfarb-Shanno (BFGS) update</strong>:</p>
<p><span class="math display">\[
\mathbf{H}_{j+1} = \mathbf{H}_j + \frac{(\mathbf{s}_j \mathbf{s}_j&#39;)}{\mathbf{s}_j&#39; \mathbf{y}_j} - \frac{\mathbf{H}_j \mathbf{y}_j \mathbf{y}_j&#39; \mathbf{H}_j}{\mathbf{y}_j&#39; \mathbf{H}_j \mathbf{y}_j}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mathbf{s}_j = \hat{\theta}^{(j+1)} - \hat{\theta}^{(j)}\)</span> (change in parameters).</li>
<li><span class="math inline">\(\mathbf{y}_j = \nabla Q(\hat{\theta}^{(j+1)}) - \nabla Q(\hat{\theta}^{(j)})\)</span> (change in gradient).</li>
<li><span class="math inline">\(\mathbf{H}_j\)</span> is the current <strong>inverse Hessian approximation</strong>.</li>
</ul>
<hr />
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="non-linear-least-squares-estimation.html#cb205-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb205-2"><a href="non-linear-least-squares-estimation.html#cb205-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb205-3"><a href="non-linear-least-squares-estimation.html#cb205-3" tabindex="-1"></a></span>
<span id="cb205-4"><a href="non-linear-least-squares-estimation.html#cb205-4" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb205-5"><a href="non-linear-least-squares-estimation.html#cb205-5" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb205-6"><a href="non-linear-least-squares-estimation.html#cb205-6" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb205-7"><a href="non-linear-least-squares-estimation.html#cb205-7" tabindex="-1"></a>}</span>
<span id="cb205-8"><a href="non-linear-least-squares-estimation.html#cb205-8" tabindex="-1"></a></span>
<span id="cb205-9"><a href="non-linear-least-squares-estimation.html#cb205-9" tabindex="-1"></a><span class="co"># Define SSE function</span></span>
<span id="cb205-10"><a href="non-linear-least-squares-estimation.html#cb205-10" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb205-11"><a href="non-linear-least-squares-estimation.html#cb205-11" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb205-12"><a href="non-linear-least-squares-estimation.html#cb205-12" tabindex="-1"></a>}</span>
<span id="cb205-13"><a href="non-linear-least-squares-estimation.html#cb205-13" tabindex="-1"></a></span>
<span id="cb205-14"><a href="non-linear-least-squares-estimation.html#cb205-14" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb205-15"><a href="non-linear-least-squares-estimation.html#cb205-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb205-16"><a href="non-linear-least-squares-estimation.html#cb205-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb205-17"><a href="non-linear-least-squares-estimation.html#cb205-17" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb205-18"><a href="non-linear-least-squares-estimation.html#cb205-18" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb205-19"><a href="non-linear-least-squares-estimation.html#cb205-19" tabindex="-1"></a></span>
<span id="cb205-20"><a href="non-linear-least-squares-estimation.html#cb205-20" tabindex="-1"></a><span class="co"># Run BFGS Optimization using `optim()`</span></span>
<span id="cb205-21"><a href="non-linear-least-squares-estimation.html#cb205-21" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial guess</span></span>
<span id="cb205-22"><a href="non-linear-least-squares-estimation.html#cb205-22" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb205-23"><a href="non-linear-least-squares-estimation.html#cb205-23" tabindex="-1"></a>    <span class="at">par =</span> theta_init,</span>
<span id="cb205-24"><a href="non-linear-least-squares-estimation.html#cb205-24" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(theta) <span class="fu">sse</span>(theta, x, y),  <span class="co"># Minimize SSE</span></span>
<span id="cb205-25"><a href="non-linear-least-squares-estimation.html#cb205-25" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>,</span>
<span id="cb205-26"><a href="non-linear-least-squares-estimation.html#cb205-26" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">trace =</span> <span class="dv">0</span>)  <span class="co"># Suppress optimization progress</span></span>
<span id="cb205-27"><a href="non-linear-least-squares-estimation.html#cb205-27" tabindex="-1"></a>    <span class="co"># control = list(trace = 1, REPORT = 1)  # Print optimization progress</span></span>
<span id="cb205-28"><a href="non-linear-least-squares-estimation.html#cb205-28" tabindex="-1"></a>)</span>
<span id="cb205-29"><a href="non-linear-least-squares-estimation.html#cb205-29" tabindex="-1"></a></span>
<span id="cb205-30"><a href="non-linear-least-squares-estimation.html#cb205-30" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb205-31"><a href="non-linear-least-squares-estimation.html#cb205-31" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> result<span class="sc">$</span>par</span>
<span id="cb205-32"><a href="non-linear-least-squares-estimation.html#cb205-32" tabindex="-1"></a>sse_final <span class="ot">&lt;-</span> result<span class="sc">$</span>value</span>
<span id="cb205-33"><a href="non-linear-least-squares-estimation.html#cb205-33" tabindex="-1"></a>convergence_status <span class="ot">&lt;-</span> result<span class="sc">$</span>convergence  <span class="co"># 0 means successful convergence</span></span>
<span id="cb205-34"><a href="non-linear-least-squares-estimation.html#cb205-34" tabindex="-1"></a></span>
<span id="cb205-35"><a href="non-linear-least-squares-estimation.html#cb205-35" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb205-36"><a href="non-linear-least-squares-estimation.html#cb205-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">=== Optimization Results ===</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb205-37"><a href="non-linear-least-squares-estimation.html#cb205-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-38"><a href="non-linear-least-squares-estimation.html#cb205-38" tabindex="-1"></a><span class="co">#&gt; === Optimization Results ===</span></span>
<span id="cb205-39"><a href="non-linear-least-squares-estimation.html#cb205-39" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) using Quasi-Newton BFGS:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb205-40"><a href="non-linear-least-squares-estimation.html#cb205-40" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) using Quasi-Newton BFGS:</span></span>
<span id="cb205-41"><a href="non-linear-least-squares-estimation.html#cb205-41" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb205-42"><a href="non-linear-least-squares-estimation.html#cb205-42" tabindex="-1"></a><span class="co">#&gt; [1] 1.9954216 0.3007569</span></span>
<span id="cb205-43"><a href="non-linear-least-squares-estimation.html#cb205-43" tabindex="-1"></a></span>
<span id="cb205-44"><a href="non-linear-least-squares-estimation.html#cb205-44" tabindex="-1"></a><span class="co"># Display final SSE</span></span>
<span id="cb205-45"><a href="non-linear-least-squares-estimation.html#cb205-45" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Final SSE:&quot;</span>, sse_final, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb205-46"><a href="non-linear-least-squares-estimation.html#cb205-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb205-47"><a href="non-linear-least-squares-estimation.html#cb205-47" tabindex="-1"></a><span class="co">#&gt; Final SSE: 20.3227</span></span></code></pre></div>
</div>
<div id="trust-region-reflective-algorithm" class="section level4 hasAnchor" number="6.2.1.7">
<h4><span class="header-section-number">6.2.1.7</span> Trust-Region Reflective Algorithm<a href="non-linear-least-squares-estimation.html#trust-region-reflective-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Trust-Region Reflective (TRR) algorithm is an optimization technique used for nonlinear least squares problems. Unlike Newton’s method and gradient-based approaches, TRR dynamically restricts updates to a trust region, ensuring stability and preventing overshooting.</p>
<p>The goal is to minimize the objective function <span class="math inline">\(Q(\theta)\)</span> (e.g., Sum of Squared Errors, SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} Q(\theta)
\]</span></p>
<p>Instead of taking a full Newton step, TRR solves the following <strong>quadratic subproblem</strong>:</p>
<p><span class="math display">\[
\min_{\delta} m_j(\delta) = Q(\hat{\theta}^{(j)}) + \nabla Q(\hat{\theta}^{(j)})&#39; \delta + \frac{1}{2} \delta&#39; \mathbf{H}_j \delta
\]</span></p>
<p>subject to:</p>
<p><span class="math display">\[
\|\delta\| \leq \Delta_j
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\mathbf{H}_j\)</span> is an <strong>approximation of the Hessian matrix</strong>.</p></li>
<li><p><span class="math inline">\(\nabla Q(\hat{\theta}^{(j)})\)</span> is the <strong>gradient vector</strong>.</p></li>
<li><p><span class="math inline">\(\Delta_j\)</span> is the <strong>trust-region radius</strong>, which is adjusted dynamically.</p></li>
</ul>
<hr />
<p><strong>Trust-Region Adjustments</strong></p>
<p>The algorithm <strong>modifies the step size dynamically</strong> based on the ratio <span class="math inline">\(\rho_j\)</span>:</p>
<p><span class="math display">\[
\rho_j = \frac{Q(\hat{\theta}^{(j)}) - Q(\hat{\theta}^{(j)} + \delta)}{m_j(0) - m_j(\delta)}
\]</span></p>
<ul>
<li><p><strong>If</strong> <span class="math inline">\(\rho_j &gt; 0.75\)</span> and <span class="math inline">\(\|\delta\| = \Delta_j\)</span>, then expand the trust region: <span class="math display">\[
\Delta_{j+1} = 2 \Delta_j
\]</span></p></li>
<li><p><strong>If</strong> <span class="math inline">\(\rho_j &lt; 0.25\)</span>, shrink the trust region: <span class="math display">\[
\Delta_{j+1} = \frac{1}{2} \Delta_j
\]</span></p></li>
<li><p><strong>If</strong> <span class="math inline">\(\rho_j &gt; 0\)</span>, accept the step; otherwise, reject it.</p></li>
</ul>
<p>If a step <strong>violates a constraint</strong>, it is <strong>reflected back</strong> into the feasible region:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \max(\hat{\theta}^{(j)} + \delta, \theta_{\min})
\]</span></p>
<p>This ensures that the optimization <strong>respects parameter bounds</strong>.</p>
<hr />
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="non-linear-least-squares-estimation.html#cb206-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb206-2"><a href="non-linear-least-squares-estimation.html#cb206-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb206-3"><a href="non-linear-least-squares-estimation.html#cb206-3" tabindex="-1"></a></span>
<span id="cb206-4"><a href="non-linear-least-squares-estimation.html#cb206-4" tabindex="-1"></a></span>
<span id="cb206-5"><a href="non-linear-least-squares-estimation.html#cb206-5" tabindex="-1"></a><span class="co"># Define a nonlinear function (exponential model)</span></span>
<span id="cb206-6"><a href="non-linear-least-squares-estimation.html#cb206-6" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb206-7"><a href="non-linear-least-squares-estimation.html#cb206-7" tabindex="-1"></a>    theta[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x)</span>
<span id="cb206-8"><a href="non-linear-least-squares-estimation.html#cb206-8" tabindex="-1"></a>}</span>
<span id="cb206-9"><a href="non-linear-least-squares-estimation.html#cb206-9" tabindex="-1"></a></span>
<span id="cb206-10"><a href="non-linear-least-squares-estimation.html#cb206-10" tabindex="-1"></a><span class="co"># Define SSE function</span></span>
<span id="cb206-11"><a href="non-linear-least-squares-estimation.html#cb206-11" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb206-12"><a href="non-linear-least-squares-estimation.html#cb206-12" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb206-13"><a href="non-linear-least-squares-estimation.html#cb206-13" tabindex="-1"></a>}</span>
<span id="cb206-14"><a href="non-linear-least-squares-estimation.html#cb206-14" tabindex="-1"></a></span>
<span id="cb206-15"><a href="non-linear-least-squares-estimation.html#cb206-15" tabindex="-1"></a><span class="co"># Compute Gradient (First Derivative) of SSE</span></span>
<span id="cb206-16"><a href="non-linear-least-squares-estimation.html#cb206-16" tabindex="-1"></a>gradient_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb206-17"><a href="non-linear-least-squares-estimation.html#cb206-17" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb206-18"><a href="non-linear-least-squares-estimation.html#cb206-18" tabindex="-1"></a>    </span>
<span id="cb206-19"><a href="non-linear-least-squares-estimation.html#cb206-19" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_1</span></span>
<span id="cb206-20"><a href="non-linear-least-squares-estimation.html#cb206-20" tabindex="-1"></a>    grad_1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb206-21"><a href="non-linear-least-squares-estimation.html#cb206-21" tabindex="-1"></a>    </span>
<span id="cb206-22"><a href="non-linear-least-squares-estimation.html#cb206-22" tabindex="-1"></a>    <span class="co"># Partial derivative w.r.t theta_2</span></span>
<span id="cb206-23"><a href="non-linear-least-squares-estimation.html#cb206-23" tabindex="-1"></a>    grad_2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> theta[<span class="dv">1</span>] <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb206-24"><a href="non-linear-least-squares-estimation.html#cb206-24" tabindex="-1"></a>    </span>
<span id="cb206-25"><a href="non-linear-least-squares-estimation.html#cb206-25" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(grad_1, grad_2))</span>
<span id="cb206-26"><a href="non-linear-least-squares-estimation.html#cb206-26" tabindex="-1"></a>}</span>
<span id="cb206-27"><a href="non-linear-least-squares-estimation.html#cb206-27" tabindex="-1"></a></span>
<span id="cb206-28"><a href="non-linear-least-squares-estimation.html#cb206-28" tabindex="-1"></a><span class="co"># Compute Hessian Approximation of SSE</span></span>
<span id="cb206-29"><a href="non-linear-least-squares-estimation.html#cb206-29" tabindex="-1"></a>hessian_sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb206-30"><a href="non-linear-least-squares-estimation.html#cb206-30" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb206-31"><a href="non-linear-least-squares-estimation.html#cb206-31" tabindex="-1"></a>    </span>
<span id="cb206-32"><a href="non-linear-least-squares-estimation.html#cb206-32" tabindex="-1"></a>    <span class="co"># Compute second derivatives</span></span>
<span id="cb206-33"><a href="non-linear-least-squares-estimation.html#cb206-33" tabindex="-1"></a>    H_11 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb206-34"><a href="non-linear-least-squares-estimation.html#cb206-34" tabindex="-1"></a>    H_12 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(x <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x) <span class="sc">*</span> theta[<span class="dv">1</span>])</span>
<span id="cb206-35"><a href="non-linear-least-squares-estimation.html#cb206-35" tabindex="-1"></a>    H_21 <span class="ot">&lt;-</span> H_12</span>
<span id="cb206-36"><a href="non-linear-least-squares-estimation.html#cb206-36" tabindex="-1"></a>    </span>
<span id="cb206-37"><a href="non-linear-least-squares-estimation.html#cb206-37" tabindex="-1"></a>    term1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">*</span> theta[<span class="dv">2</span>] <span class="sc">*</span> x) <span class="sc">*</span> theta[<span class="dv">1</span>] <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb206-38"><a href="non-linear-least-squares-estimation.html#cb206-38" tabindex="-1"></a>    term2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(residuals <span class="sc">*</span> (x <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(theta[<span class="dv">2</span>] <span class="sc">*</span> x))</span>
<span id="cb206-39"><a href="non-linear-least-squares-estimation.html#cb206-39" tabindex="-1"></a>    </span>
<span id="cb206-40"><a href="non-linear-least-squares-estimation.html#cb206-40" tabindex="-1"></a>    H_22 <span class="ot">&lt;-</span> term1 <span class="sc">-</span> term2</span>
<span id="cb206-41"><a href="non-linear-least-squares-estimation.html#cb206-41" tabindex="-1"></a>    </span>
<span id="cb206-42"><a href="non-linear-least-squares-estimation.html#cb206-42" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">matrix</span>(</span>
<span id="cb206-43"><a href="non-linear-least-squares-estimation.html#cb206-43" tabindex="-1"></a>        <span class="fu">c</span>(H_11, H_12, H_21, H_22),</span>
<span id="cb206-44"><a href="non-linear-least-squares-estimation.html#cb206-44" tabindex="-1"></a>        <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb206-45"><a href="non-linear-least-squares-estimation.html#cb206-45" tabindex="-1"></a>        <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb206-46"><a href="non-linear-least-squares-estimation.html#cb206-46" tabindex="-1"></a>    ))</span>
<span id="cb206-47"><a href="non-linear-least-squares-estimation.html#cb206-47" tabindex="-1"></a>}</span>
<span id="cb206-48"><a href="non-linear-least-squares-estimation.html#cb206-48" tabindex="-1"></a></span>
<span id="cb206-49"><a href="non-linear-least-squares-estimation.html#cb206-49" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb206-50"><a href="non-linear-least-squares-estimation.html#cb206-50" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb206-51"><a href="non-linear-least-squares-estimation.html#cb206-51" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb206-52"><a href="non-linear-least-squares-estimation.html#cb206-52" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>)</span>
<span id="cb206-53"><a href="non-linear-least-squares-estimation.html#cb206-53" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb206-54"><a href="non-linear-least-squares-estimation.html#cb206-54" tabindex="-1"></a></span>
<span id="cb206-55"><a href="non-linear-least-squares-estimation.html#cb206-55" tabindex="-1"></a><span class="co"># Manual Trust-Region Reflective Optimization Implementation</span></span>
<span id="cb206-56"><a href="non-linear-least-squares-estimation.html#cb206-56" tabindex="-1"></a>trust_region_reflective <span class="ot">&lt;-</span></span>
<span id="cb206-57"><a href="non-linear-least-squares-estimation.html#cb206-57" tabindex="-1"></a>    <span class="cf">function</span>(theta_init,</span>
<span id="cb206-58"><a href="non-linear-least-squares-estimation.html#cb206-58" tabindex="-1"></a>             x,</span>
<span id="cb206-59"><a href="non-linear-least-squares-estimation.html#cb206-59" tabindex="-1"></a>             y,</span>
<span id="cb206-60"><a href="non-linear-least-squares-estimation.html#cb206-60" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb206-61"><a href="non-linear-least-squares-estimation.html#cb206-61" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">500</span>,</span>
<span id="cb206-62"><a href="non-linear-least-squares-estimation.html#cb206-62" tabindex="-1"></a>             <span class="at">delta_max =</span> <span class="fl">1.0</span>) {</span>
<span id="cb206-63"><a href="non-linear-least-squares-estimation.html#cb206-63" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb206-64"><a href="non-linear-least-squares-estimation.html#cb206-64" tabindex="-1"></a>        delta_j <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Initial trust-region size</span></span>
<span id="cb206-65"><a href="non-linear-least-squares-estimation.html#cb206-65" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb206-66"><a href="non-linear-least-squares-estimation.html#cb206-66" tabindex="-1"></a>        sse_values <span class="ot">&lt;-</span> <span class="fu">numeric</span>(max_iter)</span>
<span id="cb206-67"><a href="non-linear-least-squares-estimation.html#cb206-67" tabindex="-1"></a>        </span>
<span id="cb206-68"><a href="non-linear-least-squares-estimation.html#cb206-68" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb206-69"><a href="non-linear-least-squares-estimation.html#cb206-69" tabindex="-1"></a>            grad <span class="ot">&lt;-</span> <span class="fu">gradient_sse</span>(theta, x, y)</span>
<span id="cb206-70"><a href="non-linear-least-squares-estimation.html#cb206-70" tabindex="-1"></a>            hessian <span class="ot">&lt;-</span> <span class="fu">hessian_sse</span>(theta, x, y)</span>
<span id="cb206-71"><a href="non-linear-least-squares-estimation.html#cb206-71" tabindex="-1"></a>            </span>
<span id="cb206-72"><a href="non-linear-least-squares-estimation.html#cb206-72" tabindex="-1"></a>            <span class="co"># Check if Hessian is invertible</span></span>
<span id="cb206-73"><a href="non-linear-least-squares-estimation.html#cb206-73" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">det</span>(hessian) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb206-74"><a href="non-linear-least-squares-estimation.html#cb206-74" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Hessian is singular at iteration&quot;</span>,</span>
<span id="cb206-75"><a href="non-linear-least-squares-estimation.html#cb206-75" tabindex="-1"></a>                    j,</span>
<span id="cb206-76"><a href="non-linear-least-squares-estimation.html#cb206-76" tabindex="-1"></a>                    <span class="st">&quot;- Using identity matrix instead.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb206-77"><a href="non-linear-least-squares-estimation.html#cb206-77" tabindex="-1"></a>                hessian <span class="ot">&lt;-</span></span>
<span id="cb206-78"><a href="non-linear-least-squares-estimation.html#cb206-78" tabindex="-1"></a>                    <span class="fu">diag</span>(n)  <span class="co"># Replace with identity matrix if singular</span></span>
<span id="cb206-79"><a href="non-linear-least-squares-estimation.html#cb206-79" tabindex="-1"></a>            }</span>
<span id="cb206-80"><a href="non-linear-least-squares-estimation.html#cb206-80" tabindex="-1"></a>            </span>
<span id="cb206-81"><a href="non-linear-least-squares-estimation.html#cb206-81" tabindex="-1"></a>            <span class="co"># Compute Newton step</span></span>
<span id="cb206-82"><a href="non-linear-least-squares-estimation.html#cb206-82" tabindex="-1"></a>            delta_full <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">solve</span>(hessian) <span class="sc">%*%</span> grad</span>
<span id="cb206-83"><a href="non-linear-least-squares-estimation.html#cb206-83" tabindex="-1"></a>            </span>
<span id="cb206-84"><a href="non-linear-least-squares-estimation.html#cb206-84" tabindex="-1"></a>            <span class="co"># Apply trust-region constraint</span></span>
<span id="cb206-85"><a href="non-linear-least-squares-estimation.html#cb206-85" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sqrt</span>(<span class="fu">sum</span>(delta_full <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">&gt;</span> delta_j) {</span>
<span id="cb206-86"><a href="non-linear-least-squares-estimation.html#cb206-86" tabindex="-1"></a>                <span class="co"># Scale step</span></span>
<span id="cb206-87"><a href="non-linear-least-squares-estimation.html#cb206-87" tabindex="-1"></a>                delta <span class="ot">&lt;-</span></span>
<span id="cb206-88"><a href="non-linear-least-squares-estimation.html#cb206-88" tabindex="-1"></a>                    (delta_j <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(delta_full <span class="sc">^</span> <span class="dv">2</span>))) <span class="sc">*</span> delta_full  </span>
<span id="cb206-89"><a href="non-linear-least-squares-estimation.html#cb206-89" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb206-90"><a href="non-linear-least-squares-estimation.html#cb206-90" tabindex="-1"></a>                delta <span class="ot">&lt;-</span> delta_full</span>
<span id="cb206-91"><a href="non-linear-least-squares-estimation.html#cb206-91" tabindex="-1"></a>            }</span>
<span id="cb206-92"><a href="non-linear-least-squares-estimation.html#cb206-92" tabindex="-1"></a>            </span>
<span id="cb206-93"><a href="non-linear-least-squares-estimation.html#cb206-93" tabindex="-1"></a>            <span class="co"># Compute new theta and ensure it respects constraints</span></span>
<span id="cb206-94"><a href="non-linear-least-squares-estimation.html#cb206-94" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span></span>
<span id="cb206-95"><a href="non-linear-least-squares-estimation.html#cb206-95" tabindex="-1"></a>                <span class="fu">pmax</span>(theta <span class="sc">+</span> delta, <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="cn">Inf</span>))  <span class="co"># Reflect to lower bound</span></span>
<span id="cb206-96"><a href="non-linear-least-squares-estimation.html#cb206-96" tabindex="-1"></a>            sse_new <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_new, x, y)</span>
<span id="cb206-97"><a href="non-linear-least-squares-estimation.html#cb206-97" tabindex="-1"></a>            </span>
<span id="cb206-98"><a href="non-linear-least-squares-estimation.html#cb206-98" tabindex="-1"></a>            <span class="co"># Compute agreement ratio (rho_j)</span></span>
<span id="cb206-99"><a href="non-linear-least-squares-estimation.html#cb206-99" tabindex="-1"></a>            predicted_reduction <span class="ot">&lt;-</span></span>
<span id="cb206-100"><a href="non-linear-least-squares-estimation.html#cb206-100" tabindex="-1"></a>                <span class="sc">-</span><span class="fu">t</span>(grad) <span class="sc">%*%</span> delta <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">t</span>(delta) <span class="sc">%*%</span> hessian <span class="sc">%*%</span> delta</span>
<span id="cb206-101"><a href="non-linear-least-squares-estimation.html#cb206-101" tabindex="-1"></a>            actual_reduction <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y) <span class="sc">-</span> sse_new</span>
<span id="cb206-102"><a href="non-linear-least-squares-estimation.html#cb206-102" tabindex="-1"></a>            rho_j <span class="ot">&lt;-</span> actual_reduction <span class="sc">/</span> predicted_reduction</span>
<span id="cb206-103"><a href="non-linear-least-squares-estimation.html#cb206-103" tabindex="-1"></a>            </span>
<span id="cb206-104"><a href="non-linear-least-squares-estimation.html#cb206-104" tabindex="-1"></a>            <span class="co"># Adjust trust region size</span></span>
<span id="cb206-105"><a href="non-linear-least-squares-estimation.html#cb206-105" tabindex="-1"></a>            <span class="cf">if</span> (rho_j <span class="sc">&lt;</span> <span class="fl">0.25</span>) {</span>
<span id="cb206-106"><a href="non-linear-least-squares-estimation.html#cb206-106" tabindex="-1"></a>                delta_j <span class="ot">&lt;-</span> <span class="fu">max</span>(delta_j <span class="sc">/</span> <span class="dv">2</span>, <span class="fl">1e-4</span>)  <span class="co"># Shrink</span></span>
<span id="cb206-107"><a href="non-linear-least-squares-estimation.html#cb206-107" tabindex="-1"></a>            } <span class="cf">else</span> <span class="cf">if</span> (rho_j <span class="sc">&gt;</span> <span class="fl">0.75</span> <span class="sc">&amp;&amp;</span></span>
<span id="cb206-108"><a href="non-linear-least-squares-estimation.html#cb206-108" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">sum</span>(delta <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">==</span> delta_j) {</span>
<span id="cb206-109"><a href="non-linear-least-squares-estimation.html#cb206-109" tabindex="-1"></a>                delta_j <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">2</span> <span class="sc">*</span> delta_j, delta_max)  <span class="co"># Expand</span></span>
<span id="cb206-110"><a href="non-linear-least-squares-estimation.html#cb206-110" tabindex="-1"></a>            }</span>
<span id="cb206-111"><a href="non-linear-least-squares-estimation.html#cb206-111" tabindex="-1"></a>            </span>
<span id="cb206-112"><a href="non-linear-least-squares-estimation.html#cb206-112" tabindex="-1"></a>            <span class="co"># Accept or reject step</span></span>
<span id="cb206-113"><a href="non-linear-least-squares-estimation.html#cb206-113" tabindex="-1"></a>            <span class="cf">if</span> (rho_j <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb206-114"><a href="non-linear-least-squares-estimation.html#cb206-114" tabindex="-1"></a>                theta <span class="ot">&lt;-</span> theta_new  <span class="co"># Accept step</span></span>
<span id="cb206-115"><a href="non-linear-least-squares-estimation.html#cb206-115" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb206-116"><a href="non-linear-least-squares-estimation.html#cb206-116" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Step rejected at iteration&quot;</span>, j, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb206-117"><a href="non-linear-least-squares-estimation.html#cb206-117" tabindex="-1"></a>            }</span>
<span id="cb206-118"><a href="non-linear-least-squares-estimation.html#cb206-118" tabindex="-1"></a>            </span>
<span id="cb206-119"><a href="non-linear-least-squares-estimation.html#cb206-119" tabindex="-1"></a>            sse_values[j] <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y)</span>
<span id="cb206-120"><a href="non-linear-least-squares-estimation.html#cb206-120" tabindex="-1"></a>            </span>
<span id="cb206-121"><a href="non-linear-least-squares-estimation.html#cb206-121" tabindex="-1"></a>            <span class="co"># Check for convergence</span></span>
<span id="cb206-122"><a href="non-linear-least-squares-estimation.html#cb206-122" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(delta)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb206-123"><a href="non-linear-least-squares-estimation.html#cb206-123" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Converged in&quot;</span>, j, <span class="st">&quot;iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb206-124"><a href="non-linear-least-squares-estimation.html#cb206-124" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta, <span class="at">sse_values =</span> sse_values[<span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb206-125"><a href="non-linear-least-squares-estimation.html#cb206-125" tabindex="-1"></a>            }</span>
<span id="cb206-126"><a href="non-linear-least-squares-estimation.html#cb206-126" tabindex="-1"></a>        }</span>
<span id="cb206-127"><a href="non-linear-least-squares-estimation.html#cb206-127" tabindex="-1"></a>        </span>
<span id="cb206-128"><a href="non-linear-least-squares-estimation.html#cb206-128" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">theta =</span> theta, <span class="at">sse_values =</span> sse_values))</span>
<span id="cb206-129"><a href="non-linear-least-squares-estimation.html#cb206-129" tabindex="-1"></a>    }</span>
<span id="cb206-130"><a href="non-linear-least-squares-estimation.html#cb206-130" tabindex="-1"></a></span>
<span id="cb206-131"><a href="non-linear-least-squares-estimation.html#cb206-131" tabindex="-1"></a><span class="co"># Run Manual Trust-Region Reflective Algorithm</span></span>
<span id="cb206-132"><a href="non-linear-least-squares-estimation.html#cb206-132" tabindex="-1"></a>theta_init <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>)  <span class="co"># Initial guess</span></span>
<span id="cb206-133"><a href="non-linear-least-squares-estimation.html#cb206-133" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">trust_region_reflective</span>(theta_init, x, y)</span>
<span id="cb206-134"><a href="non-linear-least-squares-estimation.html#cb206-134" tabindex="-1"></a></span>
<span id="cb206-135"><a href="non-linear-least-squares-estimation.html#cb206-135" tabindex="-1"></a><span class="co"># Extract results</span></span>
<span id="cb206-136"><a href="non-linear-least-squares-estimation.html#cb206-136" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> result<span class="sc">$</span>theta</span>
<span id="cb206-137"><a href="non-linear-least-squares-estimation.html#cb206-137" tabindex="-1"></a>sse_values <span class="ot">&lt;-</span> result<span class="sc">$</span>sse_values</span>
<span id="cb206-138"><a href="non-linear-least-squares-estimation.html#cb206-138" tabindex="-1"></a></span>
<span id="cb206-139"><a href="non-linear-least-squares-estimation.html#cb206-139" tabindex="-1"></a><span class="co"># Plot convergence of SSE over iterations</span></span>
<span id="cb206-140"><a href="non-linear-least-squares-estimation.html#cb206-140" tabindex="-1"></a>sse_df <span class="ot">&lt;-</span></span>
<span id="cb206-141"><a href="non-linear-least-squares-estimation.html#cb206-141" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">Iteration =</span> <span class="fu">seq_along</span>(sse_values), <span class="at">SSE =</span> sse_values)</span>
<span id="cb206-142"><a href="non-linear-least-squares-estimation.html#cb206-142" tabindex="-1"></a></span>
<span id="cb206-143"><a href="non-linear-least-squares-estimation.html#cb206-143" tabindex="-1"></a><span class="fu">ggplot</span>(sse_df, <span class="fu">aes</span>(<span class="at">x =</span> Iteration, <span class="at">y =</span> SSE)) <span class="sc">+</span></span>
<span id="cb206-144"><a href="non-linear-least-squares-estimation.html#cb206-144" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb206-145"><a href="non-linear-least-squares-estimation.html#cb206-145" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Trust-Region Reflective Convergence&quot;</span>,</span>
<span id="cb206-146"><a href="non-linear-least-squares-estimation.html#cb206-146" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;Iteration&quot;</span>,</span>
<span id="cb206-147"><a href="non-linear-least-squares-estimation.html#cb206-147" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;SSE&quot;</span>) <span class="sc">+</span></span>
<span id="cb206-148"><a href="non-linear-least-squares-estimation.html#cb206-148" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="derivative-free" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Derivative-Free<a href="non-linear-least-squares-estimation.html#derivative-free" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="secant-method" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Secant Method<a href="non-linear-least-squares-estimation.html#secant-method" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Secant Method is a root-finding algorithm that approximates the derivative using finite differences, making it a derivative-free alternative to Newton’s method. It is particularly useful when the exact gradient (or Jacobian in the case of optimization problems) is unavailable or expensive to compute.</p>
<p>In nonlinear optimization, we apply the Secant Method to iteratively refine parameter estimates without explicitly computing second-order derivatives.</p>
<hr />
<p>In one dimension, the Secant Method approximates the derivative as:</p>
<p><span class="math display">\[
f&#39;(\theta) \approx \frac{f(\theta_{j}) - f(\theta_{j-1})}{\theta_{j} - \theta_{j-1}}.
\]</span></p>
<p>Using this approximation, the <strong>update step</strong> in the Secant Method follows:</p>
<p><span class="math display">\[
\theta_{j+1} = \theta_j - f(\theta_j) \frac{\theta_j - \theta_{j-1}}{f(\theta_j) - f(\theta_{j-1})}.
\]</span></p>
<p>Instead of computing the exact derivative (as in Newton’s method), we use the difference between the last two iterates to approximate it. This makes the Secant Method <strong>more efficient</strong> in cases where gradient computation is expensive or infeasible.</p>
<hr />
<p>In <strong>higher dimensions</strong>, the Secant Method extends to an approximate <a href="non-linear-least-squares-estimation.html#quasi-newton-method">Quasi-Newton Method</a>, often referred to as <strong>Broyden’s Method</strong>. We iteratively approximate the inverse Hessian matrix using past updates.</p>
<p>The update formula for a vector-valued function <span class="math inline">\(F(\theta)\)</span> is:</p>
<p><span class="math display">\[
\theta^{(j+1)} = \theta^{(j)} - \mathbf{B}^{(j)} F(\theta^{(j)}),
\]</span></p>
<p>where <span class="math inline">\(\mathbf{B}^{(j)}\)</span> is an approximation of the inverse Jacobian matrix, updated at each step using:</p>
<p><span class="math display">\[
\mathbf{B}^{(j+1)} = \mathbf{B}^{(j)} + \frac{(\Delta \theta^{(j)} - \mathbf{B}^{(j)} \Delta F^{(j)}) (\Delta \theta^{(j)})&#39;}{(\Delta \theta^{(j)})&#39; \Delta F^{(j)}},
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\Delta \theta^{(j)} = \theta^{(j+1)} - \theta^{(j)}\)</span>,</li>
<li><span class="math inline">\(\Delta F^{(j)} = F(\theta^{(j+1)}) - F(\theta^{(j)})\)</span>.</li>
</ul>
<p>This <strong>secant-based update</strong> approximates the behavior of the <strong>true Jacobian inverse</strong>, reducing computational cost compared to full Newton’s method.</p>
<hr />
<p><strong>Algorithm: Secant Method for Nonlinear Optimization</strong></p>
<p>The <strong>Secant Method</strong> for nonlinear optimization follows these steps:</p>
<ol style="list-style-type: decimal">
<li>Initialize parameters <span class="math inline">\(\theta^{(0)}\)</span> and <span class="math inline">\(\theta^{(1)}\)</span> (two starting points).</li>
<li>Compute the function values <span class="math inline">\(F(\theta^{(0)})\)</span> and <span class="math inline">\(F(\theta^{(1)})\)</span>.</li>
<li>Use the Secant update formula to compute the next iterate <span class="math inline">\(\theta^{(j+1)}\)</span>.</li>
<li>Update the approximate inverse Jacobian <span class="math inline">\(\mathbf{B}^{(j)}\)</span>.</li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="non-linear-least-squares-estimation.html#cb207-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb207-2"><a href="non-linear-least-squares-estimation.html#cb207-2" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb207-3"><a href="non-linear-least-squares-estimation.html#cb207-3" tabindex="-1"></a></span>
<span id="cb207-4"><a href="non-linear-least-squares-estimation.html#cb207-4" tabindex="-1"></a></span>
<span id="cb207-5"><a href="non-linear-least-squares-estimation.html#cb207-5" tabindex="-1"></a><span class="co"># Define a nonlinear function (logistic model)</span></span>
<span id="cb207-6"><a href="non-linear-least-squares-estimation.html#cb207-6" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb207-7"><a href="non-linear-least-squares-estimation.html#cb207-7" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb207-8"><a href="non-linear-least-squares-estimation.html#cb207-8" tabindex="-1"></a>}</span>
<span id="cb207-9"><a href="non-linear-least-squares-estimation.html#cb207-9" tabindex="-1"></a></span>
<span id="cb207-10"><a href="non-linear-least-squares-estimation.html#cb207-10" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb207-11"><a href="non-linear-least-squares-estimation.html#cb207-11" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb207-12"><a href="non-linear-least-squares-estimation.html#cb207-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb207-13"><a href="non-linear-least-squares-estimation.html#cb207-13" tabindex="-1"></a>}</span>
<span id="cb207-14"><a href="non-linear-least-squares-estimation.html#cb207-14" tabindex="-1"></a></span>
<span id="cb207-15"><a href="non-linear-least-squares-estimation.html#cb207-15" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb207-16"><a href="non-linear-least-squares-estimation.html#cb207-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb207-17"><a href="non-linear-least-squares-estimation.html#cb207-17" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb207-18"><a href="non-linear-least-squares-estimation.html#cb207-18" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb207-19"><a href="non-linear-least-squares-estimation.html#cb207-19" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb207-20"><a href="non-linear-least-squares-estimation.html#cb207-20" tabindex="-1"></a></span>
<span id="cb207-21"><a href="non-linear-least-squares-estimation.html#cb207-21" tabindex="-1"></a><span class="co"># Improved Secant Method with Line Search</span></span>
<span id="cb207-22"><a href="non-linear-least-squares-estimation.html#cb207-22" tabindex="-1"></a>secant_method_improved <span class="ot">&lt;-</span></span>
<span id="cb207-23"><a href="non-linear-least-squares-estimation.html#cb207-23" tabindex="-1"></a>    <span class="cf">function</span>(theta0,</span>
<span id="cb207-24"><a href="non-linear-least-squares-estimation.html#cb207-24" tabindex="-1"></a>             theta1,</span>
<span id="cb207-25"><a href="non-linear-least-squares-estimation.html#cb207-25" tabindex="-1"></a>             x,</span>
<span id="cb207-26"><a href="non-linear-least-squares-estimation.html#cb207-26" tabindex="-1"></a>             y,</span>
<span id="cb207-27"><a href="non-linear-least-squares-estimation.html#cb207-27" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb207-28"><a href="non-linear-least-squares-estimation.html#cb207-28" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb207-29"><a href="non-linear-least-squares-estimation.html#cb207-29" tabindex="-1"></a>        theta_prev <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(theta0)  <span class="co"># Convert to column vector</span></span>
<span id="cb207-30"><a href="non-linear-least-squares-estimation.html#cb207-30" tabindex="-1"></a>        theta_curr <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(theta1)</span>
<span id="cb207-31"><a href="non-linear-least-squares-estimation.html#cb207-31" tabindex="-1"></a>        </span>
<span id="cb207-32"><a href="non-linear-least-squares-estimation.html#cb207-32" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Initial step size</span></span>
<span id="cb207-33"><a href="non-linear-least-squares-estimation.html#cb207-33" tabindex="-1"></a>        step_reduction_factor <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Reduce step if SSE increases</span></span>
<span id="cb207-34"><a href="non-linear-least-squares-estimation.html#cb207-34" tabindex="-1"></a>        B_inv <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">length</span>(theta0))  <span class="co"># Identity matrix initialization</span></span>
<span id="cb207-35"><a href="non-linear-least-squares-estimation.html#cb207-35" tabindex="-1"></a>        </span>
<span id="cb207-36"><a href="non-linear-least-squares-estimation.html#cb207-36" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb207-37"><a href="non-linear-least-squares-estimation.html#cb207-37" tabindex="-1"></a>            <span class="co"># Compute function values using numerical gradient</span></span>
<span id="cb207-38"><a href="non-linear-least-squares-estimation.html#cb207-38" tabindex="-1"></a>            F_prev <span class="ot">&lt;-</span></span>
<span id="cb207-39"><a href="non-linear-least-squares-estimation.html#cb207-39" tabindex="-1"></a>                <span class="fu">as.matrix</span>(<span class="fu">grad</span>(<span class="cf">function</span>(theta)</span>
<span id="cb207-40"><a href="non-linear-least-squares-estimation.html#cb207-40" tabindex="-1"></a>                    <span class="fu">sse</span>(theta, x, y), theta_prev))</span>
<span id="cb207-41"><a href="non-linear-least-squares-estimation.html#cb207-41" tabindex="-1"></a>            F_curr <span class="ot">&lt;-</span></span>
<span id="cb207-42"><a href="non-linear-least-squares-estimation.html#cb207-42" tabindex="-1"></a>                <span class="fu">as.matrix</span>(<span class="fu">grad</span>(<span class="cf">function</span>(theta)</span>
<span id="cb207-43"><a href="non-linear-least-squares-estimation.html#cb207-43" tabindex="-1"></a>                    <span class="fu">sse</span>(theta, x, y), theta_curr))</span>
<span id="cb207-44"><a href="non-linear-least-squares-estimation.html#cb207-44" tabindex="-1"></a>            </span>
<span id="cb207-45"><a href="non-linear-least-squares-estimation.html#cb207-45" tabindex="-1"></a>            <span class="co"># Compute secant step update (convert to column vectors)</span></span>
<span id="cb207-46"><a href="non-linear-least-squares-estimation.html#cb207-46" tabindex="-1"></a>            delta_theta <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(theta_curr <span class="sc">-</span> theta_prev)</span>
<span id="cb207-47"><a href="non-linear-least-squares-estimation.html#cb207-47" tabindex="-1"></a>            delta_F <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(F_curr <span class="sc">-</span> F_prev)</span>
<span id="cb207-48"><a href="non-linear-least-squares-estimation.html#cb207-48" tabindex="-1"></a>            </span>
<span id="cb207-49"><a href="non-linear-least-squares-estimation.html#cb207-49" tabindex="-1"></a>            <span class="co"># Prevent division by zero</span></span>
<span id="cb207-50"><a href="non-linear-least-squares-estimation.html#cb207-50" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(delta_F)) <span class="sc">&lt;</span> <span class="fl">1e-8</span>) {</span>
<span id="cb207-51"><a href="non-linear-least-squares-estimation.html#cb207-51" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Gradient diff is too small, stopping optimization.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb207-52"><a href="non-linear-least-squares-estimation.html#cb207-52" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb207-53"><a href="non-linear-least-squares-estimation.html#cb207-53" tabindex="-1"></a>            }</span>
<span id="cb207-54"><a href="non-linear-least-squares-estimation.html#cb207-54" tabindex="-1"></a>            </span>
<span id="cb207-55"><a href="non-linear-least-squares-estimation.html#cb207-55" tabindex="-1"></a>            <span class="co"># Ensure correct dimensions for Broyden update</span></span>
<span id="cb207-56"><a href="non-linear-least-squares-estimation.html#cb207-56" tabindex="-1"></a>            numerator <span class="ot">&lt;-</span></span>
<span id="cb207-57"><a href="non-linear-least-squares-estimation.html#cb207-57" tabindex="-1"></a>                (delta_theta <span class="sc">-</span> B_inv <span class="sc">%*%</span> delta_F) <span class="sc">%*%</span> <span class="fu">t</span>(delta_theta)</span>
<span id="cb207-58"><a href="non-linear-least-squares-estimation.html#cb207-58" tabindex="-1"></a>            <span class="co"># Convert scalar to numeric</span></span>
<span id="cb207-59"><a href="non-linear-least-squares-estimation.html#cb207-59" tabindex="-1"></a>            denominator <span class="ot">&lt;-</span></span>
<span id="cb207-60"><a href="non-linear-least-squares-estimation.html#cb207-60" tabindex="-1"></a>                <span class="fu">as.numeric</span>(<span class="fu">t</span>(delta_theta) <span class="sc">%*%</span> delta_F)  </span>
<span id="cb207-61"><a href="non-linear-least-squares-estimation.html#cb207-61" tabindex="-1"></a>            </span>
<span id="cb207-62"><a href="non-linear-least-squares-estimation.html#cb207-62" tabindex="-1"></a>            <span class="co"># Updated inverse Jacobian approximation</span></span>
<span id="cb207-63"><a href="non-linear-least-squares-estimation.html#cb207-63" tabindex="-1"></a>            B_inv <span class="ot">&lt;-</span></span>
<span id="cb207-64"><a href="non-linear-least-squares-estimation.html#cb207-64" tabindex="-1"></a>                B_inv <span class="sc">+</span> numerator <span class="sc">/</span> denominator  </span>
<span id="cb207-65"><a href="non-linear-least-squares-estimation.html#cb207-65" tabindex="-1"></a>            </span>
<span id="cb207-66"><a href="non-linear-least-squares-estimation.html#cb207-66" tabindex="-1"></a>            <span class="co"># Compute next theta using secant update</span></span>
<span id="cb207-67"><a href="non-linear-least-squares-estimation.html#cb207-67" tabindex="-1"></a>            theta_next <span class="ot">&lt;-</span> theta_curr <span class="sc">-</span> alpha <span class="sc">*</span> B_inv <span class="sc">%*%</span> F_curr</span>
<span id="cb207-68"><a href="non-linear-least-squares-estimation.html#cb207-68" tabindex="-1"></a>            </span>
<span id="cb207-69"><a href="non-linear-least-squares-estimation.html#cb207-69" tabindex="-1"></a>            <span class="co"># Line search: Reduce step size if SSE increases</span></span>
<span id="cb207-70"><a href="non-linear-least-squares-estimation.html#cb207-70" tabindex="-1"></a>            <span class="cf">while</span> (<span class="fu">sse</span>(<span class="fu">as.vector</span>(theta_next), x, y) <span class="sc">&gt;</span> <span class="fu">sse</span>(<span class="fu">as.vector</span>(theta_curr), </span>
<span id="cb207-71"><a href="non-linear-least-squares-estimation.html#cb207-71" tabindex="-1"></a>                                                          x, y)) {</span>
<span id="cb207-72"><a href="non-linear-least-squares-estimation.html#cb207-72" tabindex="-1"></a>                alpha <span class="ot">&lt;-</span> alpha <span class="sc">*</span> step_reduction_factor</span>
<span id="cb207-73"><a href="non-linear-least-squares-estimation.html#cb207-73" tabindex="-1"></a>                theta_next <span class="ot">&lt;-</span> theta_curr <span class="sc">-</span> alpha <span class="sc">*</span> B_inv <span class="sc">%*%</span> F_curr</span>
<span id="cb207-74"><a href="non-linear-least-squares-estimation.html#cb207-74" tabindex="-1"></a>                </span>
<span id="cb207-75"><a href="non-linear-least-squares-estimation.html#cb207-75" tabindex="-1"></a>                <span class="co"># Print progress</span></span>
<span id="cb207-76"><a href="non-linear-least-squares-estimation.html#cb207-76" tabindex="-1"></a>                <span class="co"># cat(&quot;Reducing step size to&quot;, alpha, &quot;\n&quot;)</span></span>
<span id="cb207-77"><a href="non-linear-least-squares-estimation.html#cb207-77" tabindex="-1"></a>            }</span>
<span id="cb207-78"><a href="non-linear-least-squares-estimation.html#cb207-78" tabindex="-1"></a>            </span>
<span id="cb207-79"><a href="non-linear-least-squares-estimation.html#cb207-79" tabindex="-1"></a>            <span class="co"># Print intermediate results for debugging</span></span>
<span id="cb207-80"><a href="non-linear-least-squares-estimation.html#cb207-80" tabindex="-1"></a>            <span class="fu">cat</span>(</span>
<span id="cb207-81"><a href="non-linear-least-squares-estimation.html#cb207-81" tabindex="-1"></a>                <span class="fu">sprintf</span>(</span>
<span id="cb207-82"><a href="non-linear-least-squares-estimation.html#cb207-82" tabindex="-1"></a>                    <span class="st">&quot;Iteration %d: Theta = (%.4f, %.4f, %.4f), Alpha = %.4f</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb207-83"><a href="non-linear-least-squares-estimation.html#cb207-83" tabindex="-1"></a>                    j,</span>
<span id="cb207-84"><a href="non-linear-least-squares-estimation.html#cb207-84" tabindex="-1"></a>                    theta_next[<span class="dv">1</span>],</span>
<span id="cb207-85"><a href="non-linear-least-squares-estimation.html#cb207-85" tabindex="-1"></a>                    theta_next[<span class="dv">2</span>],</span>
<span id="cb207-86"><a href="non-linear-least-squares-estimation.html#cb207-86" tabindex="-1"></a>                    theta_next[<span class="dv">3</span>],</span>
<span id="cb207-87"><a href="non-linear-least-squares-estimation.html#cb207-87" tabindex="-1"></a>                    alpha</span>
<span id="cb207-88"><a href="non-linear-least-squares-estimation.html#cb207-88" tabindex="-1"></a>                )</span>
<span id="cb207-89"><a href="non-linear-least-squares-estimation.html#cb207-89" tabindex="-1"></a>            )</span>
<span id="cb207-90"><a href="non-linear-least-squares-estimation.html#cb207-90" tabindex="-1"></a>            </span>
<span id="cb207-91"><a href="non-linear-least-squares-estimation.html#cb207-91" tabindex="-1"></a>            <span class="co"># Check convergence</span></span>
<span id="cb207-92"><a href="non-linear-least-squares-estimation.html#cb207-92" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_next <span class="sc">-</span> theta_curr)) <span class="sc">&lt;</span> tol) {</span>
<span id="cb207-93"><a href="non-linear-least-squares-estimation.html#cb207-93" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Converged successfully.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb207-94"><a href="non-linear-least-squares-estimation.html#cb207-94" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb207-95"><a href="non-linear-least-squares-estimation.html#cb207-95" tabindex="-1"></a>            }</span>
<span id="cb207-96"><a href="non-linear-least-squares-estimation.html#cb207-96" tabindex="-1"></a>            </span>
<span id="cb207-97"><a href="non-linear-least-squares-estimation.html#cb207-97" tabindex="-1"></a>            <span class="co"># Update iterates</span></span>
<span id="cb207-98"><a href="non-linear-least-squares-estimation.html#cb207-98" tabindex="-1"></a>            theta_prev <span class="ot">&lt;-</span> theta_curr</span>
<span id="cb207-99"><a href="non-linear-least-squares-estimation.html#cb207-99" tabindex="-1"></a>            theta_curr <span class="ot">&lt;-</span> theta_next</span>
<span id="cb207-100"><a href="non-linear-least-squares-estimation.html#cb207-100" tabindex="-1"></a>        }</span>
<span id="cb207-101"><a href="non-linear-least-squares-estimation.html#cb207-101" tabindex="-1"></a>        </span>
<span id="cb207-102"><a href="non-linear-least-squares-estimation.html#cb207-102" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">as.vector</span>(theta_curr))  <span class="co"># Convert back to numeric vector</span></span>
<span id="cb207-103"><a href="non-linear-least-squares-estimation.html#cb207-103" tabindex="-1"></a>    }</span>
<span id="cb207-104"><a href="non-linear-least-squares-estimation.html#cb207-104" tabindex="-1"></a></span>
<span id="cb207-105"><a href="non-linear-least-squares-estimation.html#cb207-105" tabindex="-1"></a><span class="co"># Adjusted initial parameter guesses</span></span>
<span id="cb207-106"><a href="non-linear-least-squares-estimation.html#cb207-106" tabindex="-1"></a>theta0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.8</span>,<span class="sc">-</span><span class="dv">1</span>)   <span class="co"># Closer to true parameters</span></span>
<span id="cb207-107"><a href="non-linear-least-squares-estimation.html#cb207-107" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.2</span>,<span class="sc">-</span><span class="fl">0.5</span>)  <span class="co"># Slightly refined</span></span>
<span id="cb207-108"><a href="non-linear-least-squares-estimation.html#cb207-108" tabindex="-1"></a></span>
<span id="cb207-109"><a href="non-linear-least-squares-estimation.html#cb207-109" tabindex="-1"></a><span class="co"># Run Improved Secant Method</span></span>
<span id="cb207-110"><a href="non-linear-least-squares-estimation.html#cb207-110" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">secant_method_improved</span>(theta0, theta1, x, y)</span>
<span id="cb207-111"><a href="non-linear-least-squares-estimation.html#cb207-111" tabindex="-1"></a><span class="co">#&gt; Iteration 1: Theta = (3.8521, 1.3054, 0.0057), Alpha = 0.0156</span></span>
<span id="cb207-112"><a href="non-linear-least-squares-estimation.html#cb207-112" tabindex="-1"></a><span class="co">#&gt; Iteration 2: Theta = (3.8521, 1.3054, 0.0057), Alpha = 0.0000</span></span>
<span id="cb207-113"><a href="non-linear-least-squares-estimation.html#cb207-113" tabindex="-1"></a><span class="co">#&gt; Converged successfully.</span></span>
<span id="cb207-114"><a href="non-linear-least-squares-estimation.html#cb207-114" tabindex="-1"></a></span>
<span id="cb207-115"><a href="non-linear-least-squares-estimation.html#cb207-115" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb207-116"><a href="non-linear-least-squares-estimation.html#cb207-116" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Secant Method:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb207-117"><a href="non-linear-least-squares-estimation.html#cb207-117" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Secant Method:</span></span>
<span id="cb207-118"><a href="non-linear-least-squares-estimation.html#cb207-118" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb207-119"><a href="non-linear-least-squares-estimation.html#cb207-119" tabindex="-1"></a><span class="co">#&gt; [1] 3.85213912 1.30538435 0.00566417</span></span>
<span id="cb207-120"><a href="non-linear-least-squares-estimation.html#cb207-120" tabindex="-1"></a></span>
<span id="cb207-121"><a href="non-linear-least-squares-estimation.html#cb207-121" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb207-122"><a href="non-linear-least-squares-estimation.html#cb207-122" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb207-123"><a href="non-linear-least-squares-estimation.html#cb207-123" tabindex="-1"></a>    x,</span>
<span id="cb207-124"><a href="non-linear-least-squares-estimation.html#cb207-124" tabindex="-1"></a>    y,</span>
<span id="cb207-125"><a href="non-linear-least-squares-estimation.html#cb207-125" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Secant Method: Data &amp; Fitted Curve&quot;</span>,</span>
<span id="cb207-126"><a href="non-linear-least-squares-estimation.html#cb207-126" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb207-127"><a href="non-linear-least-squares-estimation.html#cb207-127" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb207-128"><a href="non-linear-least-squares-estimation.html#cb207-128" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb207-129"><a href="non-linear-least-squares-estimation.html#cb207-129" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb207-130"><a href="non-linear-least-squares-estimation.html#cb207-130" tabindex="-1"></a>)</span>
<span id="cb207-131"><a href="non-linear-least-squares-estimation.html#cb207-131" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb207-132"><a href="non-linear-least-squares-estimation.html#cb207-132" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb207-133"><a href="non-linear-least-squares-estimation.html#cb207-133" tabindex="-1"></a>    <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb207-134"><a href="non-linear-least-squares-estimation.html#cb207-134" tabindex="-1"></a>    <span class="at">to =</span> <span class="dv">5</span>,</span>
<span id="cb207-135"><a href="non-linear-least-squares-estimation.html#cb207-135" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb207-136"><a href="non-linear-least-squares-estimation.html#cb207-136" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb207-137"><a href="non-linear-least-squares-estimation.html#cb207-137" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb207-138"><a href="non-linear-least-squares-estimation.html#cb207-138" tabindex="-1"></a>)</span>
<span id="cb207-139"><a href="non-linear-least-squares-estimation.html#cb207-139" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb207-140"><a href="non-linear-least-squares-estimation.html#cb207-140" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb207-141"><a href="non-linear-least-squares-estimation.html#cb207-141" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb207-142"><a href="non-linear-least-squares-estimation.html#cb207-142" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb207-143"><a href="non-linear-least-squares-estimation.html#cb207-143" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb207-144"><a href="non-linear-least-squares-estimation.html#cb207-144" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb207-145"><a href="non-linear-least-squares-estimation.html#cb207-145" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="grid-search" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Grid Search<a href="non-linear-least-squares-estimation.html#grid-search" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Grid Search (GS) is a brute-force optimization method that systematically explores a grid of possible parameter values to identify the combination that minimizes the residual sum of squares (RSS). Unlike gradient-based optimization, which moves iteratively towards a minimum, grid search evaluates all predefined parameter combinations, making it robust but computationally expensive.</p>
<p>Grid search is particularly useful when:</p>
<ul>
<li><p><strong>The function is highly nonlinear</strong>, making gradient methods unreliable.</p></li>
<li><p><strong>The parameter space is small</strong>, allowing exhaustive search.</p></li>
<li><p><strong>A global minimum is needed</strong>, and prior knowledge about parameter ranges exists.</p></li>
</ul>
<hr />
<p>The goal of Grid Search is to find an optimal parameter set <span class="math inline">\(\hat{\theta}\)</span> that minimizes the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta \in \Theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p>Grid search <strong>discretizes</strong> the search space <span class="math inline">\(\Theta\)</span> into a finite set of candidate values for each parameter:</p>
<p><span class="math display">\[
\Theta = \theta_1 \times \theta_2 \times \dots \times \theta_p.
\]</span></p>
<p>The <strong>accuracy</strong> of the solution depends on the <strong>grid resolution</strong>—a finer grid leads to <strong>better accuracy</strong> but <strong>higher computational cost</strong>.</p>
<hr />
<p><strong>Grid Search Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Define a grid of possible values for each parameter.</li>
<li>Evaluate SSE for each combination of parameters.</li>
<li>Select the parameter set that minimizes SSE.</li>
</ol>
<hr />
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="non-linear-least-squares-estimation.html#cb208-1" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb208-2"><a href="non-linear-least-squares-estimation.html#cb208-2" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb208-3"><a href="non-linear-least-squares-estimation.html#cb208-3" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb208-4"><a href="non-linear-least-squares-estimation.html#cb208-4" tabindex="-1"></a>}</span>
<span id="cb208-5"><a href="non-linear-least-squares-estimation.html#cb208-5" tabindex="-1"></a></span>
<span id="cb208-6"><a href="non-linear-least-squares-estimation.html#cb208-6" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb208-7"><a href="non-linear-least-squares-estimation.html#cb208-7" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb208-8"><a href="non-linear-least-squares-estimation.html#cb208-8" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb208-9"><a href="non-linear-least-squares-estimation.html#cb208-9" tabindex="-1"></a>}</span>
<span id="cb208-10"><a href="non-linear-least-squares-estimation.html#cb208-10" tabindex="-1"></a></span>
<span id="cb208-11"><a href="non-linear-least-squares-estimation.html#cb208-11" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb208-12"><a href="non-linear-least-squares-estimation.html#cb208-12" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb208-13"><a href="non-linear-least-squares-estimation.html#cb208-13" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb208-14"><a href="non-linear-least-squares-estimation.html#cb208-14" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb208-15"><a href="non-linear-least-squares-estimation.html#cb208-15" tabindex="-1"></a>}</span>
<span id="cb208-16"><a href="non-linear-least-squares-estimation.html#cb208-16" tabindex="-1"></a></span>
<span id="cb208-17"><a href="non-linear-least-squares-estimation.html#cb208-17" tabindex="-1"></a><span class="co"># Grid Search Optimization</span></span>
<span id="cb208-18"><a href="non-linear-least-squares-estimation.html#cb208-18" tabindex="-1"></a>grid_search_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">grid_size =</span> <span class="dv">10</span>) {</span>
<span id="cb208-19"><a href="non-linear-least-squares-estimation.html#cb208-19" tabindex="-1"></a>    <span class="co"># Define grid of parameter values</span></span>
<span id="cb208-20"><a href="non-linear-least-squares-estimation.html#cb208-20" tabindex="-1"></a>    A_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb208-21"><a href="non-linear-least-squares-estimation.html#cb208-21" tabindex="-1"></a>    B_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb208-22"><a href="non-linear-least-squares-estimation.html#cb208-22" tabindex="-1"></a>    C_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb208-23"><a href="non-linear-least-squares-estimation.html#cb208-23" tabindex="-1"></a>    </span>
<span id="cb208-24"><a href="non-linear-least-squares-estimation.html#cb208-24" tabindex="-1"></a>    <span class="co"># Generate all combinations of parameters</span></span>
<span id="cb208-25"><a href="non-linear-least-squares-estimation.html#cb208-25" tabindex="-1"></a>    param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">A =</span> A_values, <span class="at">B =</span> B_values, <span class="at">C =</span> C_values)</span>
<span id="cb208-26"><a href="non-linear-least-squares-estimation.html#cb208-26" tabindex="-1"></a>    </span>
<span id="cb208-27"><a href="non-linear-least-squares-estimation.html#cb208-27" tabindex="-1"></a>    <span class="co"># Evaluate SSE for each parameter combination</span></span>
<span id="cb208-28"><a href="non-linear-least-squares-estimation.html#cb208-28" tabindex="-1"></a>    param_grid<span class="sc">$</span>SSE <span class="ot">&lt;-</span> <span class="fu">apply</span>(param_grid, <span class="dv">1</span>, <span class="cf">function</span>(theta) {</span>
<span id="cb208-29"><a href="non-linear-least-squares-estimation.html#cb208-29" tabindex="-1"></a>        <span class="fu">sse</span>(<span class="fu">as.numeric</span>(theta[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]), x, y)</span>
<span id="cb208-30"><a href="non-linear-least-squares-estimation.html#cb208-30" tabindex="-1"></a>    })</span>
<span id="cb208-31"><a href="non-linear-least-squares-estimation.html#cb208-31" tabindex="-1"></a>    </span>
<span id="cb208-32"><a href="non-linear-least-squares-estimation.html#cb208-32" tabindex="-1"></a>    <span class="co"># Select the best parameter set</span></span>
<span id="cb208-33"><a href="non-linear-least-squares-estimation.html#cb208-33" tabindex="-1"></a>    best_params <span class="ot">&lt;-</span> param_grid[<span class="fu">which.min</span>(param_grid<span class="sc">$</span>SSE), <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb208-34"><a href="non-linear-least-squares-estimation.html#cb208-34" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">as.numeric</span>(best_params))</span>
<span id="cb208-35"><a href="non-linear-least-squares-estimation.html#cb208-35" tabindex="-1"></a>}</span>
<span id="cb208-36"><a href="non-linear-least-squares-estimation.html#cb208-36" tabindex="-1"></a></span>
<span id="cb208-37"><a href="non-linear-least-squares-estimation.html#cb208-37" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb208-38"><a href="non-linear-least-squares-estimation.html#cb208-38" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb208-39"><a href="non-linear-least-squares-estimation.html#cb208-39" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb208-40"><a href="non-linear-least-squares-estimation.html#cb208-40" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb208-41"><a href="non-linear-least-squares-estimation.html#cb208-41" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb208-42"><a href="non-linear-least-squares-estimation.html#cb208-42" tabindex="-1"></a></span>
<span id="cb208-43"><a href="non-linear-least-squares-estimation.html#cb208-43" tabindex="-1"></a><span class="co"># Run Grid Search</span></span>
<span id="cb208-44"><a href="non-linear-least-squares-estimation.html#cb208-44" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">grid_search_optimization</span>(x, y, <span class="at">grid_size =</span> <span class="dv">20</span>)</span>
<span id="cb208-45"><a href="non-linear-least-squares-estimation.html#cb208-45" tabindex="-1"></a></span>
<span id="cb208-46"><a href="non-linear-least-squares-estimation.html#cb208-46" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb208-47"><a href="non-linear-least-squares-estimation.html#cb208-47" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Grid Search:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb208-48"><a href="non-linear-least-squares-estimation.html#cb208-48" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Grid Search:</span></span>
<span id="cb208-49"><a href="non-linear-least-squares-estimation.html#cb208-49" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb208-50"><a href="non-linear-least-squares-estimation.html#cb208-50" tabindex="-1"></a><span class="co">#&gt; [1] 4.1052632 1.4210526 0.1052632</span></span>
<span id="cb208-51"><a href="non-linear-least-squares-estimation.html#cb208-51" tabindex="-1"></a></span>
<span id="cb208-52"><a href="non-linear-least-squares-estimation.html#cb208-52" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb208-53"><a href="non-linear-least-squares-estimation.html#cb208-53" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb208-54"><a href="non-linear-least-squares-estimation.html#cb208-54" tabindex="-1"></a>    x, y,</span>
<span id="cb208-55"><a href="non-linear-least-squares-estimation.html#cb208-55" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Grid Search: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb208-56"><a href="non-linear-least-squares-estimation.html#cb208-56" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb208-57"><a href="non-linear-least-squares-estimation.html#cb208-57" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb208-58"><a href="non-linear-least-squares-estimation.html#cb208-58" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb208-59"><a href="non-linear-least-squares-estimation.html#cb208-59" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb208-60"><a href="non-linear-least-squares-estimation.html#cb208-60" tabindex="-1"></a>)</span>
<span id="cb208-61"><a href="non-linear-least-squares-estimation.html#cb208-61" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb208-62"><a href="non-linear-least-squares-estimation.html#cb208-62" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb208-63"><a href="non-linear-least-squares-estimation.html#cb208-63" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb208-64"><a href="non-linear-least-squares-estimation.html#cb208-64" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb208-65"><a href="non-linear-least-squares-estimation.html#cb208-65" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb208-66"><a href="non-linear-least-squares-estimation.html#cb208-66" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb208-67"><a href="non-linear-least-squares-estimation.html#cb208-67" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb208-68"><a href="non-linear-least-squares-estimation.html#cb208-68" tabindex="-1"></a>)</span>
<span id="cb208-69"><a href="non-linear-least-squares-estimation.html#cb208-69" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb208-70"><a href="non-linear-least-squares-estimation.html#cb208-70" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb208-71"><a href="non-linear-least-squares-estimation.html#cb208-71" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb208-72"><a href="non-linear-least-squares-estimation.html#cb208-72" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb208-73"><a href="non-linear-least-squares-estimation.html#cb208-73" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb208-74"><a href="non-linear-least-squares-estimation.html#cb208-74" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb208-75"><a href="non-linear-least-squares-estimation.html#cb208-75" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="nelder-mead" class="section level4 hasAnchor" number="6.2.2.3">
<h4><span class="header-section-number">6.2.2.3</span> Nelder-Mead (Simplex)<a href="non-linear-least-squares-estimation.html#nelder-mead" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Nelder-Mead algorithm, also known as the Simplex method, is a derivative-free optimization algorithm that iteratively adjusts a geometric shape (simplex) to find the minimum of an objective function. It is particularly useful for nonlinear regression when gradient-based methods fail due to non-differentiability or noisy function evaluations.</p>
<p>Nelder-Mead is particularly useful when:</p>
<ul>
<li><p>The function is non-differentiable or noisy.</p></li>
<li><p>Gradient-based methods are unreliable.</p></li>
<li><p>The parameter space is low-dimensional.</p></li>
</ul>
<hr />
<p>The goal of Nelder-Mead is to find an optimal parameter set <span class="math inline">\(\hat{\theta}\)</span> that minimizes the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Simplex Representation</strong></p>
<p>The algorithm maintains a simplex, a geometric shape with <span class="math inline">\(p+1\)</span> vertices for a <span class="math inline">\(p\)</span>-dimensional parameter space.</p>
<p>Each vertex represents a parameter vector:</p>
<p><span class="math display">\[
S = \{ \theta_1, \theta_2, \dots, \theta_{p+1} \}.
\]</span></p>
<p><strong>2. Simplex Operations</strong></p>
<p>At each iteration, the algorithm <strong>updates the simplex</strong> based on the objective function values at each vertex:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Reflection</strong>: Reflect the worst point <span class="math inline">\(\theta_h\)</span> across the centroid.</p>
<p><span class="math display">\[
\theta_r = \theta_c + \alpha (\theta_c - \theta_h)
\]</span></p></li>
<li><p><strong>Expansion</strong>: If reflection improves the objective, expand the step.</p>
<p><span class="math display">\[
\theta_e = \theta_c + \gamma (\theta_r - \theta_c)
\]</span></p></li>
<li><p><strong>Contraction</strong>: If reflection worsens the objective, contract towards the centroid.</p>
<p><span class="math display">\[
\theta_c = \theta_c + \rho (\theta_h - \theta_c)
\]</span></p></li>
<li><p><strong>Shrink</strong>: If contraction fails, shrink the simplex.</p>
<p><span class="math display">\[
\theta_i = \theta_1 + \sigma (\theta_i - \theta_1), \quad \forall i &gt; 1
\]</span></p></li>
</ol>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\alpha = 1\)</span> (reflection coefficient),</p></li>
<li><p><span class="math inline">\(\gamma = 2\)</span> (expansion coefficient),</p></li>
<li><p><span class="math inline">\(\rho = 0.5\)</span> (contraction coefficient),</p></li>
<li><p><span class="math inline">\(\sigma = 0.5\)</span> (shrink coefficient).</p></li>
</ul>
<p>The process continues until convergence.</p>
<hr />
<p><strong>Nelder-Mead Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize a simplex with <span class="math inline">\(p+1\)</span> vertices.</li>
<li>Evaluate SSE at each vertex.</li>
<li>Perform reflection, expansion, contraction, or shrink operations.</li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="non-linear-least-squares-estimation.html#cb209-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb209-2"><a href="non-linear-least-squares-estimation.html#cb209-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb209-3"><a href="non-linear-least-squares-estimation.html#cb209-3" tabindex="-1"></a></span>
<span id="cb209-4"><a href="non-linear-least-squares-estimation.html#cb209-4" tabindex="-1"></a></span>
<span id="cb209-5"><a href="non-linear-least-squares-estimation.html#cb209-5" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb209-6"><a href="non-linear-least-squares-estimation.html#cb209-6" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb209-7"><a href="non-linear-least-squares-estimation.html#cb209-7" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb209-8"><a href="non-linear-least-squares-estimation.html#cb209-8" tabindex="-1"></a>}</span>
<span id="cb209-9"><a href="non-linear-least-squares-estimation.html#cb209-9" tabindex="-1"></a></span>
<span id="cb209-10"><a href="non-linear-least-squares-estimation.html#cb209-10" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb209-11"><a href="non-linear-least-squares-estimation.html#cb209-11" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb209-12"><a href="non-linear-least-squares-estimation.html#cb209-12" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb209-13"><a href="non-linear-least-squares-estimation.html#cb209-13" tabindex="-1"></a>}</span>
<span id="cb209-14"><a href="non-linear-least-squares-estimation.html#cb209-14" tabindex="-1"></a></span>
<span id="cb209-15"><a href="non-linear-least-squares-estimation.html#cb209-15" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb209-16"><a href="non-linear-least-squares-estimation.html#cb209-16" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb209-17"><a href="non-linear-least-squares-estimation.html#cb209-17" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb209-18"><a href="non-linear-least-squares-estimation.html#cb209-18" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb209-19"><a href="non-linear-least-squares-estimation.html#cb209-19" tabindex="-1"></a>}</span>
<span id="cb209-20"><a href="non-linear-least-squares-estimation.html#cb209-20" tabindex="-1"></a></span>
<span id="cb209-21"><a href="non-linear-least-squares-estimation.html#cb209-21" tabindex="-1"></a><span class="co"># Nelder-Mead Optimization</span></span>
<span id="cb209-22"><a href="non-linear-least-squares-estimation.html#cb209-22" tabindex="-1"></a>nelder_mead_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb209-23"><a href="non-linear-least-squares-estimation.html#cb209-23" tabindex="-1"></a>    <span class="co"># Initial guess for parameters</span></span>
<span id="cb209-24"><a href="non-linear-least-squares-estimation.html#cb209-24" tabindex="-1"></a>    initial_guess <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb209-25"><a href="non-linear-least-squares-estimation.html#cb209-25" tabindex="-1"></a>    </span>
<span id="cb209-26"><a href="non-linear-least-squares-estimation.html#cb209-26" tabindex="-1"></a>    <span class="co"># Run Nelder-Mead optimization</span></span>
<span id="cb209-27"><a href="non-linear-least-squares-estimation.html#cb209-27" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb209-28"><a href="non-linear-least-squares-estimation.html#cb209-28" tabindex="-1"></a>        <span class="at">par =</span> initial_guess,</span>
<span id="cb209-29"><a href="non-linear-least-squares-estimation.html#cb209-29" tabindex="-1"></a>        <span class="at">fn =</span> sse,</span>
<span id="cb209-30"><a href="non-linear-least-squares-estimation.html#cb209-30" tabindex="-1"></a>        <span class="at">x =</span> x,</span>
<span id="cb209-31"><a href="non-linear-least-squares-estimation.html#cb209-31" tabindex="-1"></a>        <span class="at">y =</span> y,</span>
<span id="cb209-32"><a href="non-linear-least-squares-estimation.html#cb209-32" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>,</span>
<span id="cb209-33"><a href="non-linear-least-squares-estimation.html#cb209-33" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">500</span>)</span>
<span id="cb209-34"><a href="non-linear-least-squares-estimation.html#cb209-34" tabindex="-1"></a>    )</span>
<span id="cb209-35"><a href="non-linear-least-squares-estimation.html#cb209-35" tabindex="-1"></a>    </span>
<span id="cb209-36"><a href="non-linear-least-squares-estimation.html#cb209-36" tabindex="-1"></a>    <span class="fu">return</span>(result<span class="sc">$</span>par)  <span class="co"># Return optimized parameters</span></span>
<span id="cb209-37"><a href="non-linear-least-squares-estimation.html#cb209-37" tabindex="-1"></a>}</span>
<span id="cb209-38"><a href="non-linear-least-squares-estimation.html#cb209-38" tabindex="-1"></a></span>
<span id="cb209-39"><a href="non-linear-least-squares-estimation.html#cb209-39" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb209-40"><a href="non-linear-least-squares-estimation.html#cb209-40" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb209-41"><a href="non-linear-least-squares-estimation.html#cb209-41" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb209-42"><a href="non-linear-least-squares-estimation.html#cb209-42" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb209-43"><a href="non-linear-least-squares-estimation.html#cb209-43" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb209-44"><a href="non-linear-least-squares-estimation.html#cb209-44" tabindex="-1"></a></span>
<span id="cb209-45"><a href="non-linear-least-squares-estimation.html#cb209-45" tabindex="-1"></a><span class="co"># Run Nelder-Mead Optimization</span></span>
<span id="cb209-46"><a href="non-linear-least-squares-estimation.html#cb209-46" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">nelder_mead_optimization</span>(x, y)</span>
<span id="cb209-47"><a href="non-linear-least-squares-estimation.html#cb209-47" tabindex="-1"></a></span>
<span id="cb209-48"><a href="non-linear-least-squares-estimation.html#cb209-48" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb209-49"><a href="non-linear-least-squares-estimation.html#cb209-49" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Nelder-Mead:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb209-50"><a href="non-linear-least-squares-estimation.html#cb209-50" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Nelder-Mead:</span></span>
<span id="cb209-51"><a href="non-linear-least-squares-estimation.html#cb209-51" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb209-52"><a href="non-linear-least-squares-estimation.html#cb209-52" tabindex="-1"></a><span class="co">#&gt; [1] 4.06873116 1.42759898 0.01119379</span></span>
<span id="cb209-53"><a href="non-linear-least-squares-estimation.html#cb209-53" tabindex="-1"></a></span>
<span id="cb209-54"><a href="non-linear-least-squares-estimation.html#cb209-54" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb209-55"><a href="non-linear-least-squares-estimation.html#cb209-55" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb209-56"><a href="non-linear-least-squares-estimation.html#cb209-56" tabindex="-1"></a>    x,</span>
<span id="cb209-57"><a href="non-linear-least-squares-estimation.html#cb209-57" tabindex="-1"></a>    y,</span>
<span id="cb209-58"><a href="non-linear-least-squares-estimation.html#cb209-58" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Nelder-Mead: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb209-59"><a href="non-linear-least-squares-estimation.html#cb209-59" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb209-60"><a href="non-linear-least-squares-estimation.html#cb209-60" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb209-61"><a href="non-linear-least-squares-estimation.html#cb209-61" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb209-62"><a href="non-linear-least-squares-estimation.html#cb209-62" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb209-63"><a href="non-linear-least-squares-estimation.html#cb209-63" tabindex="-1"></a>)</span>
<span id="cb209-64"><a href="non-linear-least-squares-estimation.html#cb209-64" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb209-65"><a href="non-linear-least-squares-estimation.html#cb209-65" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb209-66"><a href="non-linear-least-squares-estimation.html#cb209-66" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb209-67"><a href="non-linear-least-squares-estimation.html#cb209-67" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb209-68"><a href="non-linear-least-squares-estimation.html#cb209-68" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb209-69"><a href="non-linear-least-squares-estimation.html#cb209-69" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb209-70"><a href="non-linear-least-squares-estimation.html#cb209-70" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb209-71"><a href="non-linear-least-squares-estimation.html#cb209-71" tabindex="-1"></a>)</span>
<span id="cb209-72"><a href="non-linear-least-squares-estimation.html#cb209-72" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb209-73"><a href="non-linear-least-squares-estimation.html#cb209-73" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb209-74"><a href="non-linear-least-squares-estimation.html#cb209-74" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb209-75"><a href="non-linear-least-squares-estimation.html#cb209-75" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb209-76"><a href="non-linear-least-squares-estimation.html#cb209-76" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb209-77"><a href="non-linear-least-squares-estimation.html#cb209-77" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb209-78"><a href="non-linear-least-squares-estimation.html#cb209-78" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="powells-method" class="section level4 hasAnchor" number="6.2.2.4">
<h4><span class="header-section-number">6.2.2.4</span> Powell’s Method<a href="non-linear-least-squares-estimation.html#powells-method" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Powell’s Method is a derivative-free optimization algorithm that minimizes a function without using gradients. It works by iteratively refining a set of search directions to efficiently navigate the parameter space. Unlike <a href="non-linear-least-squares-estimation.html#nelder-mead">Nelder-Mead (Simplex)</a>, which adapts a simplex, Powell’s method builds an orthogonal basis of search directions.</p>
<p>Powell’s method is particularly useful when:</p>
<ul>
<li><p>The function is non-differentiable or noisy.</p></li>
<li><p>Gradient-based methods are unreliable.</p></li>
<li><p>The parameter space is low-to-moderate dimensional.</p></li>
</ul>
<hr />
<p>The goal of Powell’s Method is to find an optimal parameter set <span class="math inline">\(\hat{\theta}\)</span> that minimizes the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Search Directions</strong></p>
<p>Powell’s method <strong>maintains a set of search directions</strong> <span class="math inline">\(\mathbf{d}_1, \mathbf{d}_2, \dots, \mathbf{d}_p\)</span>:</p>
<p><span class="math display">\[
D = \{ \mathbf{d}_1, \mathbf{d}_2, ..., \mathbf{d}_p \}.
\]</span></p>
<p>Initially, these directions are chosen as <strong>unit basis vectors</strong> (each optimizing a single parameter independently).</p>
<p><strong>2. Line Minimization</strong></p>
<p>For each direction <span class="math inline">\(\mathbf{d}_j\)</span>, Powell’s method <strong>performs a 1D optimization</strong>:</p>
<p><span class="math display">\[
\theta&#39; = \theta + \lambda \mathbf{d}_j,
\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is chosen to minimize <span class="math inline">\(SSE(\theta&#39;)\)</span>.</p>
<p><strong>3. Updating Search Directions</strong></p>
<p>After optimizing along all directions:</p>
<ol style="list-style-type: decimal">
<li>The <strong>largest improvement</strong> direction <span class="math inline">\(\mathbf{d}_{\max}\)</span> is replaced with:</li>
</ol>
<p><span class="math display">\[
\mathbf{d}_{\text{new}} = \theta_{\text{final}} - \theta_{\text{initial}}.
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>The <strong>new direction set is orthogonalized</strong> using Gram-Schmidt.</li>
</ol>
<p>This ensures <strong>efficient exploration</strong> of the parameter space.</p>
<p><strong>4. Convergence Criteria</strong></p>
<p>Powell’s method <strong>stops when function improvement is below a tolerance level</strong>:</p>
<p><span class="math display">\[
|SSE(\theta_{t+1}) - SSE(\theta_t)| &lt; \epsilon.
\]</span></p>
<hr />
<p><strong>Powell’s Method Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize search directions (standard basis vectors).</li>
<li>Perform 1D line searches along each direction.</li>
<li>Update the search directions based on the largest improvement.</li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="non-linear-least-squares-estimation.html#cb210-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb210-2"><a href="non-linear-least-squares-estimation.html#cb210-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb210-3"><a href="non-linear-least-squares-estimation.html#cb210-3" tabindex="-1"></a></span>
<span id="cb210-4"><a href="non-linear-least-squares-estimation.html#cb210-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb210-5"><a href="non-linear-least-squares-estimation.html#cb210-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb210-6"><a href="non-linear-least-squares-estimation.html#cb210-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb210-7"><a href="non-linear-least-squares-estimation.html#cb210-7" tabindex="-1"></a>}</span>
<span id="cb210-8"><a href="non-linear-least-squares-estimation.html#cb210-8" tabindex="-1"></a></span>
<span id="cb210-9"><a href="non-linear-least-squares-estimation.html#cb210-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb210-10"><a href="non-linear-least-squares-estimation.html#cb210-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb210-11"><a href="non-linear-least-squares-estimation.html#cb210-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb210-12"><a href="non-linear-least-squares-estimation.html#cb210-12" tabindex="-1"></a>}</span>
<span id="cb210-13"><a href="non-linear-least-squares-estimation.html#cb210-13" tabindex="-1"></a></span>
<span id="cb210-14"><a href="non-linear-least-squares-estimation.html#cb210-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb210-15"><a href="non-linear-least-squares-estimation.html#cb210-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb210-16"><a href="non-linear-least-squares-estimation.html#cb210-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb210-17"><a href="non-linear-least-squares-estimation.html#cb210-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb210-18"><a href="non-linear-least-squares-estimation.html#cb210-18" tabindex="-1"></a>}</span>
<span id="cb210-19"><a href="non-linear-least-squares-estimation.html#cb210-19" tabindex="-1"></a></span>
<span id="cb210-20"><a href="non-linear-least-squares-estimation.html#cb210-20" tabindex="-1"></a><span class="co"># Powell&#39;s Method Optimization</span></span>
<span id="cb210-21"><a href="non-linear-least-squares-estimation.html#cb210-21" tabindex="-1"></a>powell_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb210-22"><a href="non-linear-least-squares-estimation.html#cb210-22" tabindex="-1"></a>    <span class="co"># Initial guess for parameters</span></span>
<span id="cb210-23"><a href="non-linear-least-squares-estimation.html#cb210-23" tabindex="-1"></a>    initial_guess <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb210-24"><a href="non-linear-least-squares-estimation.html#cb210-24" tabindex="-1"></a>    </span>
<span id="cb210-25"><a href="non-linear-least-squares-estimation.html#cb210-25" tabindex="-1"></a>    <span class="co"># Run Powell’s optimization (via BFGS without gradient)</span></span>
<span id="cb210-26"><a href="non-linear-least-squares-estimation.html#cb210-26" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb210-27"><a href="non-linear-least-squares-estimation.html#cb210-27" tabindex="-1"></a>        <span class="at">par =</span> initial_guess,</span>
<span id="cb210-28"><a href="non-linear-least-squares-estimation.html#cb210-28" tabindex="-1"></a>        <span class="at">fn =</span> sse,</span>
<span id="cb210-29"><a href="non-linear-least-squares-estimation.html#cb210-29" tabindex="-1"></a>        <span class="at">x =</span> x,</span>
<span id="cb210-30"><a href="non-linear-least-squares-estimation.html#cb210-30" tabindex="-1"></a>        <span class="at">y =</span> y,</span>
<span id="cb210-31"><a href="non-linear-least-squares-estimation.html#cb210-31" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>,</span>
<span id="cb210-32"><a href="non-linear-least-squares-estimation.html#cb210-32" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">500</span>),</span>
<span id="cb210-33"><a href="non-linear-least-squares-estimation.html#cb210-33" tabindex="-1"></a>        <span class="at">gr =</span> <span class="cn">NULL</span>  <span class="co"># No gradient used</span></span>
<span id="cb210-34"><a href="non-linear-least-squares-estimation.html#cb210-34" tabindex="-1"></a>    )</span>
<span id="cb210-35"><a href="non-linear-least-squares-estimation.html#cb210-35" tabindex="-1"></a>    </span>
<span id="cb210-36"><a href="non-linear-least-squares-estimation.html#cb210-36" tabindex="-1"></a>    <span class="fu">return</span>(result<span class="sc">$</span>par)  <span class="co"># Return optimized parameters</span></span>
<span id="cb210-37"><a href="non-linear-least-squares-estimation.html#cb210-37" tabindex="-1"></a>}</span>
<span id="cb210-38"><a href="non-linear-least-squares-estimation.html#cb210-38" tabindex="-1"></a></span>
<span id="cb210-39"><a href="non-linear-least-squares-estimation.html#cb210-39" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb210-40"><a href="non-linear-least-squares-estimation.html#cb210-40" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb210-41"><a href="non-linear-least-squares-estimation.html#cb210-41" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb210-42"><a href="non-linear-least-squares-estimation.html#cb210-42" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb210-43"><a href="non-linear-least-squares-estimation.html#cb210-43" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb210-44"><a href="non-linear-least-squares-estimation.html#cb210-44" tabindex="-1"></a></span>
<span id="cb210-45"><a href="non-linear-least-squares-estimation.html#cb210-45" tabindex="-1"></a><span class="co"># Run Powell&#39;s Method Optimization</span></span>
<span id="cb210-46"><a href="non-linear-least-squares-estimation.html#cb210-46" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">powell_optimization</span>(x, y)</span>
<span id="cb210-47"><a href="non-linear-least-squares-estimation.html#cb210-47" tabindex="-1"></a></span>
<span id="cb210-48"><a href="non-linear-least-squares-estimation.html#cb210-48" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb210-49"><a href="non-linear-least-squares-estimation.html#cb210-49" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Powell’s Method:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb210-50"><a href="non-linear-least-squares-estimation.html#cb210-50" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Powell’s Method:</span></span>
<span id="cb210-51"><a href="non-linear-least-squares-estimation.html#cb210-51" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb210-52"><a href="non-linear-least-squares-estimation.html#cb210-52" tabindex="-1"></a><span class="co">#&gt; [1] 4.06876538 1.42765687 0.01128753</span></span>
<span id="cb210-53"><a href="non-linear-least-squares-estimation.html#cb210-53" tabindex="-1"></a></span>
<span id="cb210-54"><a href="non-linear-least-squares-estimation.html#cb210-54" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb210-55"><a href="non-linear-least-squares-estimation.html#cb210-55" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb210-56"><a href="non-linear-least-squares-estimation.html#cb210-56" tabindex="-1"></a>    x,</span>
<span id="cb210-57"><a href="non-linear-least-squares-estimation.html#cb210-57" tabindex="-1"></a>    y,</span>
<span id="cb210-58"><a href="non-linear-least-squares-estimation.html#cb210-58" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Powell&#39;s Method: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb210-59"><a href="non-linear-least-squares-estimation.html#cb210-59" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb210-60"><a href="non-linear-least-squares-estimation.html#cb210-60" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb210-61"><a href="non-linear-least-squares-estimation.html#cb210-61" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb210-62"><a href="non-linear-least-squares-estimation.html#cb210-62" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb210-63"><a href="non-linear-least-squares-estimation.html#cb210-63" tabindex="-1"></a>)</span>
<span id="cb210-64"><a href="non-linear-least-squares-estimation.html#cb210-64" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb210-65"><a href="non-linear-least-squares-estimation.html#cb210-65" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb210-66"><a href="non-linear-least-squares-estimation.html#cb210-66" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb210-67"><a href="non-linear-least-squares-estimation.html#cb210-67" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb210-68"><a href="non-linear-least-squares-estimation.html#cb210-68" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb210-69"><a href="non-linear-least-squares-estimation.html#cb210-69" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb210-70"><a href="non-linear-least-squares-estimation.html#cb210-70" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb210-71"><a href="non-linear-least-squares-estimation.html#cb210-71" tabindex="-1"></a>)</span>
<span id="cb210-72"><a href="non-linear-least-squares-estimation.html#cb210-72" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb210-73"><a href="non-linear-least-squares-estimation.html#cb210-73" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb210-74"><a href="non-linear-least-squares-estimation.html#cb210-74" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb210-75"><a href="non-linear-least-squares-estimation.html#cb210-75" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb210-76"><a href="non-linear-least-squares-estimation.html#cb210-76" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb210-77"><a href="non-linear-least-squares-estimation.html#cb210-77" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb210-78"><a href="non-linear-least-squares-estimation.html#cb210-78" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="random-search" class="section level4 hasAnchor" number="6.2.2.5">
<h4><span class="header-section-number">6.2.2.5</span> Random Search<a href="non-linear-least-squares-estimation.html#random-search" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Random Search (RS) is a simple yet effective optimization algorithm that explores the search space by randomly sampling candidate solutions. Unlike <a href="non-linear-least-squares-estimation.html#grid-search">grid search</a>, which evaluates all predefined parameter combinations, random search selects a random subset, reducing computational cost.</p>
<p>Random search is particularly useful when:</p>
<ul>
<li><p>The search space is large, making grid search impractical.</p></li>
<li><p>Gradient-based methods fail due to non-differentiability or noisy data.</p></li>
<li><p>The optimal region is unknown, making global exploration essential.</p></li>
</ul>
<hr />
<p>The goal of Random Search is to find an optimal parameter set <span class="math inline">\(\hat{\theta}\)</span> that minimizes the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta \in \Theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p>Unlike <a href="non-linear-least-squares-estimation.html#grid-search">grid search</a>, <strong>random search does not evaluate all parameter combinations</strong> but instead <strong>randomly samples a subset</strong>:</p>
<p><span class="math display">\[
\Theta_{\text{sampled}} \subset \Theta.
\]</span></p>
<p>The <strong>accuracy</strong> of the solution depends on the <strong>number of random samples</strong>—a higher number increases <strong>the likelihood of finding a good solution</strong>.</p>
<hr />
<p><strong>Random Search Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Define a random sampling range for each parameter.</li>
<li>Randomly sample <span class="math inline">\(N\)</span> parameter sets.</li>
<li>Evaluate SSE for each sampled set.</li>
<li>Select the parameter set that minimizes SSE.</li>
</ol>
<hr />
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="non-linear-least-squares-estimation.html#cb211-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb211-2"><a href="non-linear-least-squares-estimation.html#cb211-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb211-3"><a href="non-linear-least-squares-estimation.html#cb211-3" tabindex="-1"></a></span>
<span id="cb211-4"><a href="non-linear-least-squares-estimation.html#cb211-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb211-5"><a href="non-linear-least-squares-estimation.html#cb211-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb211-6"><a href="non-linear-least-squares-estimation.html#cb211-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb211-7"><a href="non-linear-least-squares-estimation.html#cb211-7" tabindex="-1"></a>}</span>
<span id="cb211-8"><a href="non-linear-least-squares-estimation.html#cb211-8" tabindex="-1"></a></span>
<span id="cb211-9"><a href="non-linear-least-squares-estimation.html#cb211-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb211-10"><a href="non-linear-least-squares-estimation.html#cb211-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb211-11"><a href="non-linear-least-squares-estimation.html#cb211-11" tabindex="-1"></a>  <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb211-12"><a href="non-linear-least-squares-estimation.html#cb211-12" tabindex="-1"></a>}</span>
<span id="cb211-13"><a href="non-linear-least-squares-estimation.html#cb211-13" tabindex="-1"></a></span>
<span id="cb211-14"><a href="non-linear-least-squares-estimation.html#cb211-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb211-15"><a href="non-linear-least-squares-estimation.html#cb211-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb211-16"><a href="non-linear-least-squares-estimation.html#cb211-16" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb211-17"><a href="non-linear-least-squares-estimation.html#cb211-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb211-18"><a href="non-linear-least-squares-estimation.html#cb211-18" tabindex="-1"></a>}</span>
<span id="cb211-19"><a href="non-linear-least-squares-estimation.html#cb211-19" tabindex="-1"></a></span>
<span id="cb211-20"><a href="non-linear-least-squares-estimation.html#cb211-20" tabindex="-1"></a><span class="co"># Random Search Optimization</span></span>
<span id="cb211-21"><a href="non-linear-least-squares-estimation.html#cb211-21" tabindex="-1"></a>random_search_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">num_samples =</span> <span class="dv">100</span>) {</span>
<span id="cb211-22"><a href="non-linear-least-squares-estimation.html#cb211-22" tabindex="-1"></a>  <span class="co"># Define parameter ranges</span></span>
<span id="cb211-23"><a href="non-linear-least-squares-estimation.html#cb211-23" tabindex="-1"></a>  A_range <span class="ot">&lt;-</span></span>
<span id="cb211-24"><a href="non-linear-least-squares-estimation.html#cb211-24" tabindex="-1"></a>    <span class="fu">runif</span>(num_samples, <span class="dv">2</span>, <span class="dv">6</span>)   <span class="co"># Random values between 2 and 6</span></span>
<span id="cb211-25"><a href="non-linear-least-squares-estimation.html#cb211-25" tabindex="-1"></a>  B_range <span class="ot">&lt;-</span></span>
<span id="cb211-26"><a href="non-linear-least-squares-estimation.html#cb211-26" tabindex="-1"></a>    <span class="fu">runif</span>(num_samples, <span class="fl">0.5</span>, <span class="dv">3</span>) <span class="co"># Random values between 0.5 and 3</span></span>
<span id="cb211-27"><a href="non-linear-least-squares-estimation.html#cb211-27" tabindex="-1"></a>  C_range <span class="ot">&lt;-</span></span>
<span id="cb211-28"><a href="non-linear-least-squares-estimation.html#cb211-28" tabindex="-1"></a>    <span class="fu">runif</span>(num_samples,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># Random values between -2 and 2</span></span>
<span id="cb211-29"><a href="non-linear-least-squares-estimation.html#cb211-29" tabindex="-1"></a>  </span>
<span id="cb211-30"><a href="non-linear-least-squares-estimation.html#cb211-30" tabindex="-1"></a>  <span class="co"># Initialize best parameters</span></span>
<span id="cb211-31"><a href="non-linear-least-squares-estimation.html#cb211-31" tabindex="-1"></a>  best_theta <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb211-32"><a href="non-linear-least-squares-estimation.html#cb211-32" tabindex="-1"></a>  best_sse <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb211-33"><a href="non-linear-least-squares-estimation.html#cb211-33" tabindex="-1"></a>  </span>
<span id="cb211-34"><a href="non-linear-least-squares-estimation.html#cb211-34" tabindex="-1"></a>  <span class="co"># Evaluate randomly sampled parameter sets</span></span>
<span id="cb211-35"><a href="non-linear-least-squares-estimation.html#cb211-35" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb211-36"><a href="non-linear-least-squares-estimation.html#cb211-36" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="fu">c</span>(A_range[i], B_range[i], C_range[i])</span>
<span id="cb211-37"><a href="non-linear-least-squares-estimation.html#cb211-37" tabindex="-1"></a>    current_sse <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y)</span>
<span id="cb211-38"><a href="non-linear-least-squares-estimation.html#cb211-38" tabindex="-1"></a>    </span>
<span id="cb211-39"><a href="non-linear-least-squares-estimation.html#cb211-39" tabindex="-1"></a>    <span class="cf">if</span> (current_sse <span class="sc">&lt;</span> best_sse) {</span>
<span id="cb211-40"><a href="non-linear-least-squares-estimation.html#cb211-40" tabindex="-1"></a>      best_sse <span class="ot">&lt;-</span> current_sse</span>
<span id="cb211-41"><a href="non-linear-least-squares-estimation.html#cb211-41" tabindex="-1"></a>      best_theta <span class="ot">&lt;-</span> theta</span>
<span id="cb211-42"><a href="non-linear-least-squares-estimation.html#cb211-42" tabindex="-1"></a>    }</span>
<span id="cb211-43"><a href="non-linear-least-squares-estimation.html#cb211-43" tabindex="-1"></a>  }</span>
<span id="cb211-44"><a href="non-linear-least-squares-estimation.html#cb211-44" tabindex="-1"></a>  </span>
<span id="cb211-45"><a href="non-linear-least-squares-estimation.html#cb211-45" tabindex="-1"></a>  <span class="fu">return</span>(best_theta)</span>
<span id="cb211-46"><a href="non-linear-least-squares-estimation.html#cb211-46" tabindex="-1"></a>}</span>
<span id="cb211-47"><a href="non-linear-least-squares-estimation.html#cb211-47" tabindex="-1"></a></span>
<span id="cb211-48"><a href="non-linear-least-squares-estimation.html#cb211-48" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb211-49"><a href="non-linear-least-squares-estimation.html#cb211-49" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb211-50"><a href="non-linear-least-squares-estimation.html#cb211-50" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb211-51"><a href="non-linear-least-squares-estimation.html#cb211-51" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb211-52"><a href="non-linear-least-squares-estimation.html#cb211-52" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb211-53"><a href="non-linear-least-squares-estimation.html#cb211-53" tabindex="-1"></a></span>
<span id="cb211-54"><a href="non-linear-least-squares-estimation.html#cb211-54" tabindex="-1"></a><span class="co"># Run Random Search</span></span>
<span id="cb211-55"><a href="non-linear-least-squares-estimation.html#cb211-55" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span></span>
<span id="cb211-56"><a href="non-linear-least-squares-estimation.html#cb211-56" tabindex="-1"></a>  <span class="fu">random_search_optimization</span>(x, y, <span class="at">num_samples =</span> <span class="dv">500</span>)</span>
<span id="cb211-57"><a href="non-linear-least-squares-estimation.html#cb211-57" tabindex="-1"></a></span>
<span id="cb211-58"><a href="non-linear-least-squares-estimation.html#cb211-58" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb211-59"><a href="non-linear-least-squares-estimation.html#cb211-59" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Random Search:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb211-60"><a href="non-linear-least-squares-estimation.html#cb211-60" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Random Search:</span></span>
<span id="cb211-61"><a href="non-linear-least-squares-estimation.html#cb211-61" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb211-62"><a href="non-linear-least-squares-estimation.html#cb211-62" tabindex="-1"></a><span class="co">#&gt; [1] 4.0893431 1.4687456 0.1024474</span></span>
<span id="cb211-63"><a href="non-linear-least-squares-estimation.html#cb211-63" tabindex="-1"></a></span>
<span id="cb211-64"><a href="non-linear-least-squares-estimation.html#cb211-64" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb211-65"><a href="non-linear-least-squares-estimation.html#cb211-65" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb211-66"><a href="non-linear-least-squares-estimation.html#cb211-66" tabindex="-1"></a>  x,</span>
<span id="cb211-67"><a href="non-linear-least-squares-estimation.html#cb211-67" tabindex="-1"></a>  y,</span>
<span id="cb211-68"><a href="non-linear-least-squares-estimation.html#cb211-68" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Random Search: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb211-69"><a href="non-linear-least-squares-estimation.html#cb211-69" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb211-70"><a href="non-linear-least-squares-estimation.html#cb211-70" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb211-71"><a href="non-linear-least-squares-estimation.html#cb211-71" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb211-72"><a href="non-linear-least-squares-estimation.html#cb211-72" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb211-73"><a href="non-linear-least-squares-estimation.html#cb211-73" tabindex="-1"></a>)</span>
<span id="cb211-74"><a href="non-linear-least-squares-estimation.html#cb211-74" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb211-75"><a href="non-linear-least-squares-estimation.html#cb211-75" tabindex="-1"></a>  <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb211-76"><a href="non-linear-least-squares-estimation.html#cb211-76" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb211-77"><a href="non-linear-least-squares-estimation.html#cb211-77" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb211-78"><a href="non-linear-least-squares-estimation.html#cb211-78" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb211-79"><a href="non-linear-least-squares-estimation.html#cb211-79" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb211-80"><a href="non-linear-least-squares-estimation.html#cb211-80" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb211-81"><a href="non-linear-least-squares-estimation.html#cb211-81" tabindex="-1"></a>)</span>
<span id="cb211-82"><a href="non-linear-least-squares-estimation.html#cb211-82" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb211-83"><a href="non-linear-least-squares-estimation.html#cb211-83" tabindex="-1"></a>  <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb211-84"><a href="non-linear-least-squares-estimation.html#cb211-84" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb211-85"><a href="non-linear-least-squares-estimation.html#cb211-85" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb211-86"><a href="non-linear-least-squares-estimation.html#cb211-86" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb211-87"><a href="non-linear-least-squares-estimation.html#cb211-87" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb211-88"><a href="non-linear-least-squares-estimation.html#cb211-88" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-13-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="hooke-jeeves" class="section level4 hasAnchor" number="6.2.2.6">
<h4><span class="header-section-number">6.2.2.6</span> Hooke-Jeeves Pattern Search<a href="non-linear-least-squares-estimation.html#hooke-jeeves" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Hooke-Jeeves Pattern Search is a derivative-free optimization algorithm that searches for an optimal solution by exploring and adjusting parameter values iteratively. Unlike gradient-based methods, it does not require differentiability, making it effective for non-smooth and noisy functions.</p>
<p>Hooke-Jeeves is particularly useful when:</p>
<ul>
<li><p>The function is non-differentiable or noisy.</p></li>
<li><p>Gradient-based methods are unreliable.</p></li>
<li><p>The parameter space is low-to-moderate dimensional.</p></li>
</ul>
<hr />
<p>The goal of Hooke-Jeeves Pattern Search is to find an optimal parameter set <span class="math inline">\(\hat{\theta}\)</span> that minimizes the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Exploratory Moves</strong></p>
<p>At each iteration, the algorithm <strong>perturbs each parameter</strong> to find a lower SSE:</p>
<p><span class="math display">\[
\theta&#39; = \theta \pm \delta.
\]</span></p>
<p>If a new parameter <span class="math inline">\(\theta&#39;\)</span> reduces SSE, it becomes the new base point.</p>
<p><strong>2. Pattern Moves</strong></p>
<p>After an improvement, the algorithm <strong>accelerates movement</strong> in the promising direction:</p>
<p><span class="math display">\[
\theta_{\text{new}} = \theta_{\text{old}} + (\theta_{\text{old}} - \theta_{\text{prev}}).
\]</span></p>
<p>This <strong>speeds up convergence</strong> towards an optimum.</p>
<p><strong>3. Step Size Adaptation</strong></p>
<p>If no improvement is found, the step size <span class="math inline">\(\delta\)</span> is reduced:</p>
<p><span class="math display">\[
\delta_{\text{new}} = \beta \cdot \delta.
\]</span></p>
<p>where <span class="math inline">\(\beta &lt; 1\)</span> is a reduction factor.</p>
<p><strong>4. Convergence Criteria</strong></p>
<p>The algorithm <strong>stops when step size is sufficiently small</strong>:</p>
<p><span class="math display">\[
\delta &lt; \epsilon.
\]</span></p>
<hr />
<p><strong>Hooke-Jeeves Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize a starting point <span class="math inline">\(\theta\)</span> and step size <span class="math inline">\(\delta\)</span>.</li>
<li>Perform exploratory moves in each parameter direction.</li>
<li>If improvement is found, perform pattern moves.</li>
<li>Reduce step size if no improvement is found.</li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="non-linear-least-squares-estimation.html#cb212-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb212-2"><a href="non-linear-least-squares-estimation.html#cb212-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb212-3"><a href="non-linear-least-squares-estimation.html#cb212-3" tabindex="-1"></a></span>
<span id="cb212-4"><a href="non-linear-least-squares-estimation.html#cb212-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb212-5"><a href="non-linear-least-squares-estimation.html#cb212-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb212-6"><a href="non-linear-least-squares-estimation.html#cb212-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb212-7"><a href="non-linear-least-squares-estimation.html#cb212-7" tabindex="-1"></a>}</span>
<span id="cb212-8"><a href="non-linear-least-squares-estimation.html#cb212-8" tabindex="-1"></a></span>
<span id="cb212-9"><a href="non-linear-least-squares-estimation.html#cb212-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb212-10"><a href="non-linear-least-squares-estimation.html#cb212-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb212-11"><a href="non-linear-least-squares-estimation.html#cb212-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb212-12"><a href="non-linear-least-squares-estimation.html#cb212-12" tabindex="-1"></a>}</span>
<span id="cb212-13"><a href="non-linear-least-squares-estimation.html#cb212-13" tabindex="-1"></a></span>
<span id="cb212-14"><a href="non-linear-least-squares-estimation.html#cb212-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb212-15"><a href="non-linear-least-squares-estimation.html#cb212-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb212-16"><a href="non-linear-least-squares-estimation.html#cb212-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb212-17"><a href="non-linear-least-squares-estimation.html#cb212-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb212-18"><a href="non-linear-least-squares-estimation.html#cb212-18" tabindex="-1"></a>}</span>
<span id="cb212-19"><a href="non-linear-least-squares-estimation.html#cb212-19" tabindex="-1"></a></span>
<span id="cb212-20"><a href="non-linear-least-squares-estimation.html#cb212-20" tabindex="-1"></a><span class="co"># Hooke-Jeeves Pattern Search Optimization</span></span>
<span id="cb212-21"><a href="non-linear-least-squares-estimation.html#cb212-21" tabindex="-1"></a>hooke_jeeves_optimization <span class="ot">&lt;-</span></span>
<span id="cb212-22"><a href="non-linear-least-squares-estimation.html#cb212-22" tabindex="-1"></a>    <span class="cf">function</span>(x,</span>
<span id="cb212-23"><a href="non-linear-least-squares-estimation.html#cb212-23" tabindex="-1"></a>             y,</span>
<span id="cb212-24"><a href="non-linear-least-squares-estimation.html#cb212-24" tabindex="-1"></a>             <span class="at">step_size =</span> <span class="fl">0.5</span>,</span>
<span id="cb212-25"><a href="non-linear-least-squares-estimation.html#cb212-25" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb212-26"><a href="non-linear-least-squares-estimation.html#cb212-26" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">500</span>) {</span>
<span id="cb212-27"><a href="non-linear-least-squares-estimation.html#cb212-27" tabindex="-1"></a>        <span class="co"># Initial guess for parameters</span></span>
<span id="cb212-28"><a href="non-linear-least-squares-estimation.html#cb212-28" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb212-29"><a href="non-linear-least-squares-estimation.html#cb212-29" tabindex="-1"></a>        best_sse <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y)</span>
<span id="cb212-30"><a href="non-linear-least-squares-estimation.html#cb212-30" tabindex="-1"></a>        step <span class="ot">&lt;-</span> step_size</span>
<span id="cb212-31"><a href="non-linear-least-squares-estimation.html#cb212-31" tabindex="-1"></a>        iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb212-32"><a href="non-linear-least-squares-estimation.html#cb212-32" tabindex="-1"></a>        </span>
<span id="cb212-33"><a href="non-linear-least-squares-estimation.html#cb212-33" tabindex="-1"></a>        <span class="cf">while</span> (step <span class="sc">&gt;</span> tol <span class="sc">&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb212-34"><a href="non-linear-least-squares-estimation.html#cb212-34" tabindex="-1"></a>            iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb212-35"><a href="non-linear-least-squares-estimation.html#cb212-35" tabindex="-1"></a>            improved <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb212-36"><a href="non-linear-least-squares-estimation.html#cb212-36" tabindex="-1"></a>            new_theta <span class="ot">&lt;-</span> theta</span>
<span id="cb212-37"><a href="non-linear-least-squares-estimation.html#cb212-37" tabindex="-1"></a>            </span>
<span id="cb212-38"><a href="non-linear-least-squares-estimation.html#cb212-38" tabindex="-1"></a>            <span class="co"># Exploratory move in each parameter direction</span></span>
<span id="cb212-39"><a href="non-linear-least-squares-estimation.html#cb212-39" tabindex="-1"></a>            <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)) {</span>
<span id="cb212-40"><a href="non-linear-least-squares-estimation.html#cb212-40" tabindex="-1"></a>                <span class="cf">for</span> (delta <span class="cf">in</span> <span class="fu">c</span>(step,<span class="sc">-</span>step)) {</span>
<span id="cb212-41"><a href="non-linear-least-squares-estimation.html#cb212-41" tabindex="-1"></a>                    theta_test <span class="ot">&lt;-</span> new_theta</span>
<span id="cb212-42"><a href="non-linear-least-squares-estimation.html#cb212-42" tabindex="-1"></a>                    theta_test[i] <span class="ot">&lt;-</span> theta_test[i] <span class="sc">+</span> delta</span>
<span id="cb212-43"><a href="non-linear-least-squares-estimation.html#cb212-43" tabindex="-1"></a>                    sse_test <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_test, x, y)</span>
<span id="cb212-44"><a href="non-linear-least-squares-estimation.html#cb212-44" tabindex="-1"></a>                    </span>
<span id="cb212-45"><a href="non-linear-least-squares-estimation.html#cb212-45" tabindex="-1"></a>                    <span class="cf">if</span> (sse_test <span class="sc">&lt;</span> best_sse) {</span>
<span id="cb212-46"><a href="non-linear-least-squares-estimation.html#cb212-46" tabindex="-1"></a>                        best_sse <span class="ot">&lt;-</span> sse_test</span>
<span id="cb212-47"><a href="non-linear-least-squares-estimation.html#cb212-47" tabindex="-1"></a>                        new_theta <span class="ot">&lt;-</span> theta_test</span>
<span id="cb212-48"><a href="non-linear-least-squares-estimation.html#cb212-48" tabindex="-1"></a>                        improved <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb212-49"><a href="non-linear-least-squares-estimation.html#cb212-49" tabindex="-1"></a>                    }</span>
<span id="cb212-50"><a href="non-linear-least-squares-estimation.html#cb212-50" tabindex="-1"></a>                }</span>
<span id="cb212-51"><a href="non-linear-least-squares-estimation.html#cb212-51" tabindex="-1"></a>            }</span>
<span id="cb212-52"><a href="non-linear-least-squares-estimation.html#cb212-52" tabindex="-1"></a>            </span>
<span id="cb212-53"><a href="non-linear-least-squares-estimation.html#cb212-53" tabindex="-1"></a>            <span class="co"># Pattern move if improvement found</span></span>
<span id="cb212-54"><a href="non-linear-least-squares-estimation.html#cb212-54" tabindex="-1"></a>            <span class="cf">if</span> (improved) {</span>
<span id="cb212-55"><a href="non-linear-least-squares-estimation.html#cb212-55" tabindex="-1"></a>                theta <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> new_theta <span class="sc">-</span> theta</span>
<span id="cb212-56"><a href="non-linear-least-squares-estimation.html#cb212-56" tabindex="-1"></a>                best_sse <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y)</span>
<span id="cb212-57"><a href="non-linear-least-squares-estimation.html#cb212-57" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb212-58"><a href="non-linear-least-squares-estimation.html#cb212-58" tabindex="-1"></a>                step <span class="ot">&lt;-</span> step <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Reduce step size</span></span>
<span id="cb212-59"><a href="non-linear-least-squares-estimation.html#cb212-59" tabindex="-1"></a>            }</span>
<span id="cb212-60"><a href="non-linear-least-squares-estimation.html#cb212-60" tabindex="-1"></a>        }</span>
<span id="cb212-61"><a href="non-linear-least-squares-estimation.html#cb212-61" tabindex="-1"></a>        </span>
<span id="cb212-62"><a href="non-linear-least-squares-estimation.html#cb212-62" tabindex="-1"></a>        <span class="fu">return</span>(theta)</span>
<span id="cb212-63"><a href="non-linear-least-squares-estimation.html#cb212-63" tabindex="-1"></a>    }</span>
<span id="cb212-64"><a href="non-linear-least-squares-estimation.html#cb212-64" tabindex="-1"></a></span>
<span id="cb212-65"><a href="non-linear-least-squares-estimation.html#cb212-65" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb212-66"><a href="non-linear-least-squares-estimation.html#cb212-66" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb212-67"><a href="non-linear-least-squares-estimation.html#cb212-67" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb212-68"><a href="non-linear-least-squares-estimation.html#cb212-68" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb212-69"><a href="non-linear-least-squares-estimation.html#cb212-69" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb212-70"><a href="non-linear-least-squares-estimation.html#cb212-70" tabindex="-1"></a></span>
<span id="cb212-71"><a href="non-linear-least-squares-estimation.html#cb212-71" tabindex="-1"></a><span class="co"># Run Hooke-Jeeves Optimization</span></span>
<span id="cb212-72"><a href="non-linear-least-squares-estimation.html#cb212-72" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">hooke_jeeves_optimization</span>(x, y)</span>
<span id="cb212-73"><a href="non-linear-least-squares-estimation.html#cb212-73" tabindex="-1"></a></span>
<span id="cb212-74"><a href="non-linear-least-squares-estimation.html#cb212-74" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb212-75"><a href="non-linear-least-squares-estimation.html#cb212-75" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Hooke-Jeeves:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb212-76"><a href="non-linear-least-squares-estimation.html#cb212-76" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Hooke-Jeeves:</span></span>
<span id="cb212-77"><a href="non-linear-least-squares-estimation.html#cb212-77" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb212-78"><a href="non-linear-least-squares-estimation.html#cb212-78" tabindex="-1"></a><span class="co">#&gt; [1] 4 1 0</span></span>
<span id="cb212-79"><a href="non-linear-least-squares-estimation.html#cb212-79" tabindex="-1"></a></span>
<span id="cb212-80"><a href="non-linear-least-squares-estimation.html#cb212-80" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb212-81"><a href="non-linear-least-squares-estimation.html#cb212-81" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb212-82"><a href="non-linear-least-squares-estimation.html#cb212-82" tabindex="-1"></a>    x,</span>
<span id="cb212-83"><a href="non-linear-least-squares-estimation.html#cb212-83" tabindex="-1"></a>    y,</span>
<span id="cb212-84"><a href="non-linear-least-squares-estimation.html#cb212-84" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Hooke-Jeeves: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb212-85"><a href="non-linear-least-squares-estimation.html#cb212-85" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb212-86"><a href="non-linear-least-squares-estimation.html#cb212-86" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb212-87"><a href="non-linear-least-squares-estimation.html#cb212-87" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb212-88"><a href="non-linear-least-squares-estimation.html#cb212-88" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb212-89"><a href="non-linear-least-squares-estimation.html#cb212-89" tabindex="-1"></a>)</span>
<span id="cb212-90"><a href="non-linear-least-squares-estimation.html#cb212-90" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb212-91"><a href="non-linear-least-squares-estimation.html#cb212-91" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb212-92"><a href="non-linear-least-squares-estimation.html#cb212-92" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb212-93"><a href="non-linear-least-squares-estimation.html#cb212-93" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb212-94"><a href="non-linear-least-squares-estimation.html#cb212-94" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-95"><a href="non-linear-least-squares-estimation.html#cb212-95" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb212-96"><a href="non-linear-least-squares-estimation.html#cb212-96" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb212-97"><a href="non-linear-least-squares-estimation.html#cb212-97" tabindex="-1"></a>)</span>
<span id="cb212-98"><a href="non-linear-least-squares-estimation.html#cb212-98" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb212-99"><a href="non-linear-least-squares-estimation.html#cb212-99" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb212-100"><a href="non-linear-least-squares-estimation.html#cb212-100" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb212-101"><a href="non-linear-least-squares-estimation.html#cb212-101" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb212-102"><a href="non-linear-least-squares-estimation.html#cb212-102" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb212-103"><a href="non-linear-least-squares-estimation.html#cb212-103" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb212-104"><a href="non-linear-least-squares-estimation.html#cb212-104" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="bisection-method" class="section level4 hasAnchor" number="6.2.2.7">
<h4><span class="header-section-number">6.2.2.7</span> Bisection Method<a href="non-linear-least-squares-estimation.html#bisection-method" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>Bisection Method</strong> is a fundamental numerical technique primarily used for <strong>root finding</strong>, but it can also be adapted for <strong>optimization problems</strong> where the goal is to minimize or maximize a nonlinear function.</p>
<p>In nonlinear regression, optimization often involves <strong>finding the parameter values that minimize the sum of squared errors (SSE)</strong>:</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta)
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} \left( y_i - f(x_i; \theta) \right)^2.
\]</span></p>
<p>Since the minimum of a function occurs where the derivative equals zero, we apply the <strong>Bisection Method</strong> to the <strong>derivative of the SSE function</strong>:</p>
<p><span class="math display">\[
\frac{d}{d\theta} SSE(\theta) = 0.
\]</span></p>
<p>This transforms the <strong>optimization problem</strong> into a <strong>root-finding problem</strong>.</p>
<hr />
<p>The <strong>Bisection Method</strong> is based on the <strong>Intermediate Value Theorem</strong>, which states:</p>
<blockquote>
<p>If a continuous function <span class="math inline">\(f(\theta)\)</span> satisfies <span class="math inline">\(f(\theta_a) \cdot f(\theta_b) &lt; 0\)</span>,<br />
then there exists at least one root in the interval <span class="math inline">\((\theta_a, \theta_b)\)</span>.</p>
</blockquote>
<p>For <strong>optimization</strong>, we apply this principle to the <strong>first derivative</strong> of the objective function <span class="math inline">\(Q(\theta)\)</span>:</p>
<p><span class="math display">\[
Q&#39;(\theta) = 0.
\]</span></p>
<p><strong>Step-by-Step Algorithm for Optimization</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Choose an interval</strong> <span class="math inline">\([\theta_a, \theta_b]\)</span> such that: <span class="math display">\[ Q&#39;(\theta_a) \cdot Q&#39;(\theta_b) &lt; 0. \]</span></li>
<li><strong>Compute the midpoint</strong>: <span class="math display">\[
\theta_m = \frac{\theta_a + \theta_b}{2}.
\]</span></li>
<li><strong>Evaluate</strong> <span class="math inline">\(Q&#39;(\theta_m)\)</span>:
<ul>
<li>If <span class="math inline">\(Q&#39;(\theta_m) = 0\)</span>, then <span class="math inline">\(\theta_m\)</span> is the optimal point.</li>
<li>If <span class="math inline">\(Q&#39;(\theta_a) \cdot Q&#39;(\theta_m) &lt; 0\)</span>, set <span class="math inline">\(\theta_b = \theta_m\)</span>.</li>
<li>Otherwise, set <span class="math inline">\(\theta_a = \theta_m\)</span>.</li>
</ul></li>
<li><strong>Repeat</strong> until convergence: <span class="math display">\[
|\theta_b - \theta_a| &lt; \epsilon.
\]</span></li>
</ol>
<p><strong>Determining the Nature of the Critical Point</strong></p>
<p>Since the Bisection Method finds a <strong>stationary point</strong>, we use the <strong>second derivative test</strong> to classify it:</p>
<ul>
<li>If <span class="math inline">\(Q&#39;&#39;(\theta) &gt; 0\)</span>, the point is a <strong>local minimum</strong>.</li>
<li>If <span class="math inline">\(Q&#39;&#39;(\theta) &lt; 0\)</span>, the point is a <strong>local maximum</strong>.</li>
</ul>
<p>For <strong>nonlinear regression</strong>, we expect <span class="math inline">\(Q(\theta) = SSE(\theta)\)</span>, so the solution found by Bisection should be a <strong>minimum</strong>.</p>
<hr />
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="non-linear-least-squares-estimation.html#cb213-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb213-2"><a href="non-linear-least-squares-estimation.html#cb213-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb213-3"><a href="non-linear-least-squares-estimation.html#cb213-3" tabindex="-1"></a></span>
<span id="cb213-4"><a href="non-linear-least-squares-estimation.html#cb213-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb213-5"><a href="non-linear-least-squares-estimation.html#cb213-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb213-6"><a href="non-linear-least-squares-estimation.html#cb213-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb213-7"><a href="non-linear-least-squares-estimation.html#cb213-7" tabindex="-1"></a>}</span>
<span id="cb213-8"><a href="non-linear-least-squares-estimation.html#cb213-8" tabindex="-1"></a></span>
<span id="cb213-9"><a href="non-linear-least-squares-estimation.html#cb213-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb213-10"><a href="non-linear-least-squares-estimation.html#cb213-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb213-11"><a href="non-linear-least-squares-estimation.html#cb213-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb213-12"><a href="non-linear-least-squares-estimation.html#cb213-12" tabindex="-1"></a>}</span>
<span id="cb213-13"><a href="non-linear-least-squares-estimation.html#cb213-13" tabindex="-1"></a></span>
<span id="cb213-14"><a href="non-linear-least-squares-estimation.html#cb213-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function for optimization</span></span>
<span id="cb213-15"><a href="non-linear-least-squares-estimation.html#cb213-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb213-16"><a href="non-linear-least-squares-estimation.html#cb213-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb213-17"><a href="non-linear-least-squares-estimation.html#cb213-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb213-18"><a href="non-linear-least-squares-estimation.html#cb213-18" tabindex="-1"></a>}</span>
<span id="cb213-19"><a href="non-linear-least-squares-estimation.html#cb213-19" tabindex="-1"></a></span>
<span id="cb213-20"><a href="non-linear-least-squares-estimation.html#cb213-20" tabindex="-1"></a><span class="co"># Optimize all three parameters simultaneously</span></span>
<span id="cb213-21"><a href="non-linear-least-squares-estimation.html#cb213-21" tabindex="-1"></a>find_optimal_parameters <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb213-22"><a href="non-linear-least-squares-estimation.html#cb213-22" tabindex="-1"></a>    <span class="co"># Initial guess for parameters (based on data)</span></span>
<span id="cb213-23"><a href="non-linear-least-squares-estimation.html#cb213-23" tabindex="-1"></a>    initial_guess <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(y), <span class="dv">1</span>, <span class="fu">median</span>(x))  </span>
<span id="cb213-24"><a href="non-linear-least-squares-estimation.html#cb213-24" tabindex="-1"></a></span>
<span id="cb213-25"><a href="non-linear-least-squares-estimation.html#cb213-25" tabindex="-1"></a>    <span class="co"># Bounds for parameters</span></span>
<span id="cb213-26"><a href="non-linear-least-squares-estimation.html#cb213-26" tabindex="-1"></a>    lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fu">min</span>(x))  <span class="co"># Ensure positive scaling</span></span>
<span id="cb213-27"><a href="non-linear-least-squares-estimation.html#cb213-27" tabindex="-1"></a>    upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(y) <span class="sc">*</span> <span class="dv">2</span>, <span class="dv">10</span>, <span class="fu">max</span>(x))</span>
<span id="cb213-28"><a href="non-linear-least-squares-estimation.html#cb213-28" tabindex="-1"></a></span>
<span id="cb213-29"><a href="non-linear-least-squares-estimation.html#cb213-29" tabindex="-1"></a>    <span class="co"># Run optim() with L-BFGS-B (bounded optimization)</span></span>
<span id="cb213-30"><a href="non-linear-least-squares-estimation.html#cb213-30" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb213-31"><a href="non-linear-least-squares-estimation.html#cb213-31" tabindex="-1"></a>        <span class="at">par =</span> initial_guess,</span>
<span id="cb213-32"><a href="non-linear-least-squares-estimation.html#cb213-32" tabindex="-1"></a>        <span class="at">fn =</span> sse,</span>
<span id="cb213-33"><a href="non-linear-least-squares-estimation.html#cb213-33" tabindex="-1"></a>        <span class="at">x =</span> x, <span class="at">y =</span> y,</span>
<span id="cb213-34"><a href="non-linear-least-squares-estimation.html#cb213-34" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb213-35"><a href="non-linear-least-squares-estimation.html#cb213-35" tabindex="-1"></a>        <span class="at">lower =</span> lower_bounds,</span>
<span id="cb213-36"><a href="non-linear-least-squares-estimation.html#cb213-36" tabindex="-1"></a>        <span class="at">upper =</span> upper_bounds</span>
<span id="cb213-37"><a href="non-linear-least-squares-estimation.html#cb213-37" tabindex="-1"></a>    )</span>
<span id="cb213-38"><a href="non-linear-least-squares-estimation.html#cb213-38" tabindex="-1"></a>    </span>
<span id="cb213-39"><a href="non-linear-least-squares-estimation.html#cb213-39" tabindex="-1"></a>    <span class="fu">return</span>(result<span class="sc">$</span>par)  <span class="co"># Extract optimized parameters</span></span>
<span id="cb213-40"><a href="non-linear-least-squares-estimation.html#cb213-40" tabindex="-1"></a>}</span>
<span id="cb213-41"><a href="non-linear-least-squares-estimation.html#cb213-41" tabindex="-1"></a></span>
<span id="cb213-42"><a href="non-linear-least-squares-estimation.html#cb213-42" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb213-43"><a href="non-linear-least-squares-estimation.html#cb213-43" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb213-44"><a href="non-linear-least-squares-estimation.html#cb213-44" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb213-45"><a href="non-linear-least-squares-estimation.html#cb213-45" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb213-46"><a href="non-linear-least-squares-estimation.html#cb213-46" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb213-47"><a href="non-linear-least-squares-estimation.html#cb213-47" tabindex="-1"></a></span>
<span id="cb213-48"><a href="non-linear-least-squares-estimation.html#cb213-48" tabindex="-1"></a><span class="co"># Find optimal parameters using optim()</span></span>
<span id="cb213-49"><a href="non-linear-least-squares-estimation.html#cb213-49" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">find_optimal_parameters</span>(x, y)</span>
<span id="cb213-50"><a href="non-linear-least-squares-estimation.html#cb213-50" tabindex="-1"></a></span>
<span id="cb213-51"><a href="non-linear-least-squares-estimation.html#cb213-51" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb213-52"><a href="non-linear-least-squares-estimation.html#cb213-52" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using optim():</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb213-53"><a href="non-linear-least-squares-estimation.html#cb213-53" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using optim():</span></span>
<span id="cb213-54"><a href="non-linear-least-squares-estimation.html#cb213-54" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb213-55"><a href="non-linear-least-squares-estimation.html#cb213-55" tabindex="-1"></a><span class="co">#&gt; [1] 4.06876536 1.42765688 0.01128756</span></span>
<span id="cb213-56"><a href="non-linear-least-squares-estimation.html#cb213-56" tabindex="-1"></a></span>
<span id="cb213-57"><a href="non-linear-least-squares-estimation.html#cb213-57" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb213-58"><a href="non-linear-least-squares-estimation.html#cb213-58" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb213-59"><a href="non-linear-least-squares-estimation.html#cb213-59" tabindex="-1"></a>    x, y,</span>
<span id="cb213-60"><a href="non-linear-least-squares-estimation.html#cb213-60" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Optim(): Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb213-61"><a href="non-linear-least-squares-estimation.html#cb213-61" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb213-62"><a href="non-linear-least-squares-estimation.html#cb213-62" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb213-63"><a href="non-linear-least-squares-estimation.html#cb213-63" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb213-64"><a href="non-linear-least-squares-estimation.html#cb213-64" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb213-65"><a href="non-linear-least-squares-estimation.html#cb213-65" tabindex="-1"></a>)</span>
<span id="cb213-66"><a href="non-linear-least-squares-estimation.html#cb213-66" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb213-67"><a href="non-linear-least-squares-estimation.html#cb213-67" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb213-68"><a href="non-linear-least-squares-estimation.html#cb213-68" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb213-69"><a href="non-linear-least-squares-estimation.html#cb213-69" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb213-70"><a href="non-linear-least-squares-estimation.html#cb213-70" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb213-71"><a href="non-linear-least-squares-estimation.html#cb213-71" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb213-72"><a href="non-linear-least-squares-estimation.html#cb213-72" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb213-73"><a href="non-linear-least-squares-estimation.html#cb213-73" tabindex="-1"></a>)</span>
<span id="cb213-74"><a href="non-linear-least-squares-estimation.html#cb213-74" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb213-75"><a href="non-linear-least-squares-estimation.html#cb213-75" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb213-76"><a href="non-linear-least-squares-estimation.html#cb213-76" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb213-77"><a href="non-linear-least-squares-estimation.html#cb213-77" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb213-78"><a href="non-linear-least-squares-estimation.html#cb213-78" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb213-79"><a href="non-linear-least-squares-estimation.html#cb213-79" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb213-80"><a href="non-linear-least-squares-estimation.html#cb213-80" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-15-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="stochastic-heuristic-nolinear-regression" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Stochastic Heuristic<a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="differential-evolution-algorithm" class="section level4 hasAnchor" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> Differential Evolution Algorithm<a href="non-linear-least-squares-estimation.html#differential-evolution-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>Differential Evolution (DE) Algorithm</strong> is a <strong>stochastic, population-based optimization algorithm</strong> that is widely used for solving complex <strong>global optimization problems</strong>. Unlike gradient-based methods such as Newton’s method or the <a href="non-linear-least-squares-estimation.html#secant-method">Secant method</a>, DE does not require derivatives and is well-suited for optimizing <strong>non-differentiable, nonlinear, and multimodal functions</strong>.</p>
<hr />
<p><strong>Key Features of Differential Evolution</strong></p>
<ul>
<li><strong>Population-based approach:</strong> Maintains a population of candidate solutions instead of a single point.</li>
<li><strong>Mutation and crossover:</strong> Introduces variations to explore the search space.</li>
<li><strong>Selection mechanism:</strong> Retains the best candidates for the next generation.</li>
<li><strong>Global optimization:</strong> Avoids local minima by using <strong>stochastic search strategies</strong>.</li>
</ul>
<hr />
<p><strong>Mathematical Formulation of Differential Evolution</strong></p>
<p>Differential Evolution operates on a <strong>population</strong> of candidate solutions <span class="math inline">\(\{\theta_i\}\)</span>, where each <span class="math inline">\(\theta_i\)</span> is a <strong>vector of parameters</strong>. The algorithm iteratively updates the population using three main operations:</p>
<p><strong>1. Mutation</strong></p>
<p>For each candidate solution <span class="math inline">\(\theta_i\)</span>, a <strong>mutant vector</strong> <span class="math inline">\(\mathbf{v}_i^{(j)}\)</span> is generated as:</p>
<p><span class="math display">\[
\mathbf{v}_i^{(j)} = \mathbf{\theta}_{r_1}^{(j)} + F \cdot (\mathbf{\theta}_{r_2}^{(j)} - \mathbf{\theta}_{r_3}^{(j)})
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\mathbf{\theta}_{r_1}, \mathbf{\theta}_{r_2}, \mathbf{\theta}_{r_3}\)</span> are <strong>randomly selected distinct vectors</strong> from the population.</p></li>
<li><p><span class="math inline">\(F \in (0,2)\)</span> is the <strong>mutation factor</strong> controlling the step size.</p></li>
</ul>
<p><strong>2. Crossover</strong></p>
<p>A trial vector <span class="math inline">\(\mathbf{u}_i^{(j)}\)</span> is generated by combining the mutant vector <span class="math inline">\(\mathbf{v}_i^{(j)}\)</span> with the original solution <span class="math inline">\(\mathbf{\theta}_i^{(j)}\)</span>:</p>
<p><span class="math display">\[
u_{i,k}^{(j)} =
\begin{cases}
v_{i,k}^{(j)}  &amp; \text{if } rand_k \leq C_r \text{ or } k = k_{\text{rand}}, \\
\theta_{i,k}^{(j)}  &amp; \text{otherwise}.
\end{cases}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(C_r \in (0,1)\)</span> is the <strong>crossover probability</strong>.</p></li>
<li><p><span class="math inline">\(rand_k\)</span> is a <strong>random value between 0 and 1</strong>.</p></li>
<li><p><span class="math inline">\(k_{\text{rand}}\)</span> ensures at least <strong>one parameter is mutated</strong>.</p></li>
</ul>
<p><strong>3. Selection</strong></p>
<p>The new candidate solution is accepted only if it improves the objective function:</p>
<p><span class="math display">\[
\mathbf{\theta}_i^{(j+1)} =
\begin{cases}
\mathbf{u}_i^{(j)} &amp; \text{if } Q(\mathbf{u}_i^{(j)}) &lt; Q(\mathbf{\theta}_i^{(j)}), \\
\mathbf{\theta}_i^{(j)} &amp; \text{otherwise}.
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(Q(\theta)\)</span> is the <strong>objective function</strong> (e.g., sum of squared errors in regression problems).</p>
<hr />
<p><strong>Algorithm: Differential Evolution for Nonlinear Optimization</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize a population of candidate solutions.</li>
<li>Evaluate the objective function for each candidate.</li>
<li>Mutate individuals using a difference strategy.</li>
<li>Apply crossover to create trial solutions.</li>
<li>Select individuals based on their fitness (objective function value).</li>
<li>Repeat until convergence (or a stopping criterion is met).</li>
</ol>
<hr />
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="non-linear-least-squares-estimation.html#cb214-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb214-2"><a href="non-linear-least-squares-estimation.html#cb214-2" tabindex="-1"></a><span class="fu">library</span>(DEoptim)</span>
<span id="cb214-3"><a href="non-linear-least-squares-estimation.html#cb214-3" tabindex="-1"></a></span>
<span id="cb214-4"><a href="non-linear-least-squares-estimation.html#cb214-4" tabindex="-1"></a><span class="co"># Define a nonlinear function (logistic model)</span></span>
<span id="cb214-5"><a href="non-linear-least-squares-estimation.html#cb214-5" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb214-6"><a href="non-linear-least-squares-estimation.html#cb214-6" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb214-7"><a href="non-linear-least-squares-estimation.html#cb214-7" tabindex="-1"></a>}</span>
<span id="cb214-8"><a href="non-linear-least-squares-estimation.html#cb214-8" tabindex="-1"></a></span>
<span id="cb214-9"><a href="non-linear-least-squares-estimation.html#cb214-9" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb214-10"><a href="non-linear-least-squares-estimation.html#cb214-10" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb214-11"><a href="non-linear-least-squares-estimation.html#cb214-11" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb214-12"><a href="non-linear-least-squares-estimation.html#cb214-12" tabindex="-1"></a>}</span>
<span id="cb214-13"><a href="non-linear-least-squares-estimation.html#cb214-13" tabindex="-1"></a></span>
<span id="cb214-14"><a href="non-linear-least-squares-estimation.html#cb214-14" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb214-15"><a href="non-linear-least-squares-estimation.html#cb214-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb214-16"><a href="non-linear-least-squares-estimation.html#cb214-16" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb214-17"><a href="non-linear-least-squares-estimation.html#cb214-17" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb214-18"><a href="non-linear-least-squares-estimation.html#cb214-18" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb214-19"><a href="non-linear-least-squares-estimation.html#cb214-19" tabindex="-1"></a></span>
<span id="cb214-20"><a href="non-linear-least-squares-estimation.html#cb214-20" tabindex="-1"></a><span class="co"># Define the objective function for DEoptim</span></span>
<span id="cb214-21"><a href="non-linear-least-squares-estimation.html#cb214-21" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb214-22"><a href="non-linear-least-squares-estimation.html#cb214-22" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sse</span>(theta, x, y))</span>
<span id="cb214-23"><a href="non-linear-least-squares-estimation.html#cb214-23" tabindex="-1"></a>}</span>
<span id="cb214-24"><a href="non-linear-least-squares-estimation.html#cb214-24" tabindex="-1"></a></span>
<span id="cb214-25"><a href="non-linear-least-squares-estimation.html#cb214-25" tabindex="-1"></a><span class="co"># Define parameter bounds</span></span>
<span id="cb214-26"><a href="non-linear-least-squares-estimation.html#cb214-26" tabindex="-1"></a>lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>)</span>
<span id="cb214-27"><a href="non-linear-least-squares-estimation.html#cb214-27" tabindex="-1"></a>upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb214-28"><a href="non-linear-least-squares-estimation.html#cb214-28" tabindex="-1"></a></span>
<span id="cb214-29"><a href="non-linear-least-squares-estimation.html#cb214-29" tabindex="-1"></a><span class="co"># Run Differential Evolution Algorithm</span></span>
<span id="cb214-30"><a href="non-linear-least-squares-estimation.html#cb214-30" tabindex="-1"></a>de_result <span class="ot">&lt;-</span></span>
<span id="cb214-31"><a href="non-linear-least-squares-estimation.html#cb214-31" tabindex="-1"></a>    <span class="fu">DEoptim</span>(</span>
<span id="cb214-32"><a href="non-linear-least-squares-estimation.html#cb214-32" tabindex="-1"></a>        objective_function,</span>
<span id="cb214-33"><a href="non-linear-least-squares-estimation.html#cb214-33" tabindex="-1"></a>        lower_bounds,</span>
<span id="cb214-34"><a href="non-linear-least-squares-estimation.html#cb214-34" tabindex="-1"></a>        upper_bounds,</span>
<span id="cb214-35"><a href="non-linear-least-squares-estimation.html#cb214-35" tabindex="-1"></a>        <span class="fu">DEoptim.control</span>(</span>
<span id="cb214-36"><a href="non-linear-least-squares-estimation.html#cb214-36" tabindex="-1"></a>            <span class="at">NP =</span> <span class="dv">50</span>,</span>
<span id="cb214-37"><a href="non-linear-least-squares-estimation.html#cb214-37" tabindex="-1"></a>            <span class="at">itermax =</span> <span class="dv">100</span>,</span>
<span id="cb214-38"><a href="non-linear-least-squares-estimation.html#cb214-38" tabindex="-1"></a>            <span class="at">F =</span> <span class="fl">0.8</span>,</span>
<span id="cb214-39"><a href="non-linear-least-squares-estimation.html#cb214-39" tabindex="-1"></a>            <span class="at">CR =</span> <span class="fl">0.9</span>, </span>
<span id="cb214-40"><a href="non-linear-least-squares-estimation.html#cb214-40" tabindex="-1"></a>            <span class="at">trace =</span> F</span>
<span id="cb214-41"><a href="non-linear-least-squares-estimation.html#cb214-41" tabindex="-1"></a>        )</span>
<span id="cb214-42"><a href="non-linear-least-squares-estimation.html#cb214-42" tabindex="-1"></a>    )</span>
<span id="cb214-43"><a href="non-linear-least-squares-estimation.html#cb214-43" tabindex="-1"></a></span>
<span id="cb214-44"><a href="non-linear-least-squares-estimation.html#cb214-44" tabindex="-1"></a><span class="co"># Extract optimized parameters</span></span>
<span id="cb214-45"><a href="non-linear-least-squares-estimation.html#cb214-45" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> de_result<span class="sc">$</span>optim<span class="sc">$</span>bestmem</span>
<span id="cb214-46"><a href="non-linear-least-squares-estimation.html#cb214-46" tabindex="-1"></a></span>
<span id="cb214-47"><a href="non-linear-least-squares-estimation.html#cb214-47" tabindex="-1"></a><span class="co"># Display estimated parameters</span></span>
<span id="cb214-48"><a href="non-linear-least-squares-estimation.html#cb214-48" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Differential Evolution:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb214-49"><a href="non-linear-least-squares-estimation.html#cb214-49" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Differential Evolution:</span></span>
<span id="cb214-50"><a href="non-linear-least-squares-estimation.html#cb214-50" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb214-51"><a href="non-linear-least-squares-estimation.html#cb214-51" tabindex="-1"></a><span class="co">#&gt;       par1       par2       par3 </span></span>
<span id="cb214-52"><a href="non-linear-least-squares-estimation.html#cb214-52" tabindex="-1"></a><span class="co">#&gt; 4.06876562 1.42765614 0.01128768</span></span>
<span id="cb214-53"><a href="non-linear-least-squares-estimation.html#cb214-53" tabindex="-1"></a></span>
<span id="cb214-54"><a href="non-linear-least-squares-estimation.html#cb214-54" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb214-55"><a href="non-linear-least-squares-estimation.html#cb214-55" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb214-56"><a href="non-linear-least-squares-estimation.html#cb214-56" tabindex="-1"></a>    x,</span>
<span id="cb214-57"><a href="non-linear-least-squares-estimation.html#cb214-57" tabindex="-1"></a>    y,</span>
<span id="cb214-58"><a href="non-linear-least-squares-estimation.html#cb214-58" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Differential Evolution: Data &amp; Fitted Curve&quot;</span>,</span>
<span id="cb214-59"><a href="non-linear-least-squares-estimation.html#cb214-59" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb214-60"><a href="non-linear-least-squares-estimation.html#cb214-60" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb214-61"><a href="non-linear-least-squares-estimation.html#cb214-61" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb214-62"><a href="non-linear-least-squares-estimation.html#cb214-62" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb214-63"><a href="non-linear-least-squares-estimation.html#cb214-63" tabindex="-1"></a>)</span>
<span id="cb214-64"><a href="non-linear-least-squares-estimation.html#cb214-64" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb214-65"><a href="non-linear-least-squares-estimation.html#cb214-65" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb214-66"><a href="non-linear-least-squares-estimation.html#cb214-66" tabindex="-1"></a>    <span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb214-67"><a href="non-linear-least-squares-estimation.html#cb214-67" tabindex="-1"></a>    <span class="at">to =</span> <span class="dv">5</span>,</span>
<span id="cb214-68"><a href="non-linear-least-squares-estimation.html#cb214-68" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb214-69"><a href="non-linear-least-squares-estimation.html#cb214-69" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb214-70"><a href="non-linear-least-squares-estimation.html#cb214-70" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb214-71"><a href="non-linear-least-squares-estimation.html#cb214-71" tabindex="-1"></a>)</span>
<span id="cb214-72"><a href="non-linear-least-squares-estimation.html#cb214-72" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb214-73"><a href="non-linear-least-squares-estimation.html#cb214-73" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb214-74"><a href="non-linear-least-squares-estimation.html#cb214-74" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb214-75"><a href="non-linear-least-squares-estimation.html#cb214-75" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb214-76"><a href="non-linear-least-squares-estimation.html#cb214-76" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb214-77"><a href="non-linear-least-squares-estimation.html#cb214-77" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb214-78"><a href="non-linear-least-squares-estimation.html#cb214-78" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="simulated-annealing" class="section level4 hasAnchor" number="6.2.3.2">
<h4><span class="header-section-number">6.2.3.2</span> Simulated Annealing<a href="non-linear-least-squares-estimation.html#simulated-annealing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Simulated Annealing (SA) is a probabilistic global optimization algorithm inspired by annealing in metallurgy, where a material is heated and slowly cooled to remove defects. In optimization, SA gradually refines a solution by exploring the search space, allowing occasional jumps to escape local minima, before converging to an optimal solution.</p>
<p>Simulated Annealing is particularly useful when:</p>
<ul>
<li><p>The function is highly nonlinear and multimodal.</p></li>
<li><p>Gradient-based methods struggle due to non-differentiability or poor initialization.</p></li>
<li><p>A global minimum is needed, rather than a local one.</p></li>
</ul>
<hr />
<p><strong>1. Energy Function (Objective Function)</strong></p>
<p>The goal of SA is to minimize an objective function <span class="math inline">\(Q(\theta)\)</span>. For nonlinear regression, this is the Sum of Squared Errors (SSE):</p>
<p><span class="math display">\[
Q(\theta) = SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>2. Probability of Acceptance</strong></p>
<p>At each step, SA randomly perturbs the parameters <span class="math inline">\(\theta\)</span> to create a <strong>new candidate solution</strong> <span class="math inline">\(\theta&#39;\)</span> and evaluates the change in SSE:</p>
<p><span class="math display">\[
\Delta Q = Q(\theta&#39;) - Q(\theta).
\]</span></p>
<p>The <strong>Metropolis Criterion</strong> determines whether to accept the new solution:</p>
<p><span class="math display">\[
P(\text{accept}) =
\begin{cases}
1, &amp; \text{if } \Delta Q &lt; 0 \quad \text{(new solution improves fit)} \\
\exp\left( -\frac{\Delta Q}{T} \right), &amp; \text{if } \Delta Q \geq 0 \quad \text{(accept with probability)}.
\end{cases}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(T\)</span> is the <strong>temperature</strong> that <strong>gradually decreases</strong> over iterations.</p></li>
<li><p><strong>Worse solutions</strong> are accepted <strong>with small probability</strong> to escape local minima.</p></li>
</ul>
<p><strong>3. Cooling Schedule</strong></p>
<p>The <strong>temperature</strong> follows a cooling schedule:</p>
<p><span class="math display">\[
T_k = \alpha T_{k-1},
\]</span></p>
<p>where <span class="math inline">\(\alpha \in (0,1)\)</span> is a decay factor that controls cooling speed.</p>
<hr />
<p><strong>Simulated Annealing Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize parameters <span class="math inline">\(\theta\)</span> randomly.</li>
<li>Set an initial temperature <span class="math inline">\(T_0\)</span> and cooling rate <span class="math inline">\(\alpha\)</span>.</li>
<li>Repeat for max iterations:
<ul>
<li>Generate perturbed candidate <span class="math inline">\(\theta&#39;\)</span>.</li>
<li>Compute <span class="math inline">\(\Delta Q = Q(\theta&#39;) - Q(\theta)\)</span>.</li>
<li>Accept if <span class="math inline">\(\Delta Q &lt; 0\)</span> or with probability <span class="math inline">\(\exp(-\Delta Q / T)\)</span>.</li>
<li>Reduce temperature: <span class="math inline">\(T \leftarrow \alpha T\)</span>.</li>
</ul></li>
<li>Return the best solution found.</li>
</ol>
<hr />
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="non-linear-least-squares-estimation.html#cb215-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb215-2"><a href="non-linear-least-squares-estimation.html#cb215-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb215-3"><a href="non-linear-least-squares-estimation.html#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="non-linear-least-squares-estimation.html#cb215-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb215-5"><a href="non-linear-least-squares-estimation.html#cb215-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb215-6"><a href="non-linear-least-squares-estimation.html#cb215-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb215-7"><a href="non-linear-least-squares-estimation.html#cb215-7" tabindex="-1"></a>}</span>
<span id="cb215-8"><a href="non-linear-least-squares-estimation.html#cb215-8" tabindex="-1"></a></span>
<span id="cb215-9"><a href="non-linear-least-squares-estimation.html#cb215-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb215-10"><a href="non-linear-least-squares-estimation.html#cb215-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb215-11"><a href="non-linear-least-squares-estimation.html#cb215-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb215-12"><a href="non-linear-least-squares-estimation.html#cb215-12" tabindex="-1"></a>}</span>
<span id="cb215-13"><a href="non-linear-least-squares-estimation.html#cb215-13" tabindex="-1"></a></span>
<span id="cb215-14"><a href="non-linear-least-squares-estimation.html#cb215-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb215-15"><a href="non-linear-least-squares-estimation.html#cb215-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb215-16"><a href="non-linear-least-squares-estimation.html#cb215-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb215-17"><a href="non-linear-least-squares-estimation.html#cb215-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb215-18"><a href="non-linear-least-squares-estimation.html#cb215-18" tabindex="-1"></a>}</span>
<span id="cb215-19"><a href="non-linear-least-squares-estimation.html#cb215-19" tabindex="-1"></a></span>
<span id="cb215-20"><a href="non-linear-least-squares-estimation.html#cb215-20" tabindex="-1"></a><span class="co"># Simulated Annealing Algorithm</span></span>
<span id="cb215-21"><a href="non-linear-least-squares-estimation.html#cb215-21" tabindex="-1"></a>simulated_annealing <span class="ot">&lt;-</span></span>
<span id="cb215-22"><a href="non-linear-least-squares-estimation.html#cb215-22" tabindex="-1"></a>    <span class="cf">function</span>(x,</span>
<span id="cb215-23"><a href="non-linear-least-squares-estimation.html#cb215-23" tabindex="-1"></a>             y,</span>
<span id="cb215-24"><a href="non-linear-least-squares-estimation.html#cb215-24" tabindex="-1"></a>             initial_theta,</span>
<span id="cb215-25"><a href="non-linear-least-squares-estimation.html#cb215-25" tabindex="-1"></a>             <span class="at">T_init =</span> <span class="fl">1.0</span>,</span>
<span id="cb215-26"><a href="non-linear-least-squares-estimation.html#cb215-26" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.99</span>,</span>
<span id="cb215-27"><a href="non-linear-least-squares-estimation.html#cb215-27" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">5000</span>) {</span>
<span id="cb215-28"><a href="non-linear-least-squares-estimation.html#cb215-28" tabindex="-1"></a>        <span class="co"># Initialize parameters</span></span>
<span id="cb215-29"><a href="non-linear-least-squares-estimation.html#cb215-29" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> initial_theta</span>
<span id="cb215-30"><a href="non-linear-least-squares-estimation.html#cb215-30" tabindex="-1"></a>        best_theta <span class="ot">&lt;-</span> theta</span>
<span id="cb215-31"><a href="non-linear-least-squares-estimation.html#cb215-31" tabindex="-1"></a>        best_sse <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta, x, y)</span>
<span id="cb215-32"><a href="non-linear-least-squares-estimation.html#cb215-32" tabindex="-1"></a>        T <span class="ot">&lt;-</span> T_init  <span class="co"># Initial temperature</span></span>
<span id="cb215-33"><a href="non-linear-least-squares-estimation.html#cb215-33" tabindex="-1"></a>        </span>
<span id="cb215-34"><a href="non-linear-least-squares-estimation.html#cb215-34" tabindex="-1"></a>        <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb215-35"><a href="non-linear-least-squares-estimation.html#cb215-35" tabindex="-1"></a>            <span class="co"># Generate new candidate solution (small random perturbation)</span></span>
<span id="cb215-36"><a href="non-linear-least-squares-estimation.html#cb215-36" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(theta), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> T)</span>
<span id="cb215-37"><a href="non-linear-least-squares-estimation.html#cb215-37" tabindex="-1"></a>            </span>
<span id="cb215-38"><a href="non-linear-least-squares-estimation.html#cb215-38" tabindex="-1"></a>            <span class="co"># Compute new SSE</span></span>
<span id="cb215-39"><a href="non-linear-least-squares-estimation.html#cb215-39" tabindex="-1"></a>            sse_new <span class="ot">&lt;-</span> <span class="fu">sse</span>(theta_new, x, y)</span>
<span id="cb215-40"><a href="non-linear-least-squares-estimation.html#cb215-40" tabindex="-1"></a>            </span>
<span id="cb215-41"><a href="non-linear-least-squares-estimation.html#cb215-41" tabindex="-1"></a>            <span class="co"># Compute change in SSE</span></span>
<span id="cb215-42"><a href="non-linear-least-squares-estimation.html#cb215-42" tabindex="-1"></a>            delta_Q <span class="ot">&lt;-</span> sse_new <span class="sc">-</span> best_sse</span>
<span id="cb215-43"><a href="non-linear-least-squares-estimation.html#cb215-43" tabindex="-1"></a>            </span>
<span id="cb215-44"><a href="non-linear-least-squares-estimation.html#cb215-44" tabindex="-1"></a>            <span class="co"># Acceptance criteria</span></span>
<span id="cb215-45"><a href="non-linear-least-squares-estimation.html#cb215-45" tabindex="-1"></a>            <span class="cf">if</span> (delta_Q <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">exp</span>(<span class="sc">-</span>delta_Q <span class="sc">/</span> T)) {</span>
<span id="cb215-46"><a href="non-linear-least-squares-estimation.html#cb215-46" tabindex="-1"></a>                theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb215-47"><a href="non-linear-least-squares-estimation.html#cb215-47" tabindex="-1"></a>                best_sse <span class="ot">&lt;-</span> sse_new</span>
<span id="cb215-48"><a href="non-linear-least-squares-estimation.html#cb215-48" tabindex="-1"></a>                best_theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb215-49"><a href="non-linear-least-squares-estimation.html#cb215-49" tabindex="-1"></a>            }</span>
<span id="cb215-50"><a href="non-linear-least-squares-estimation.html#cb215-50" tabindex="-1"></a>            </span>
<span id="cb215-51"><a href="non-linear-least-squares-estimation.html#cb215-51" tabindex="-1"></a>            <span class="co"># Reduce temperature</span></span>
<span id="cb215-52"><a href="non-linear-least-squares-estimation.html#cb215-52" tabindex="-1"></a>            T <span class="ot">&lt;-</span> alpha <span class="sc">*</span> T</span>
<span id="cb215-53"><a href="non-linear-least-squares-estimation.html#cb215-53" tabindex="-1"></a>            </span>
<span id="cb215-54"><a href="non-linear-least-squares-estimation.html#cb215-54" tabindex="-1"></a>            <span class="co"># Stopping condition (very low temperature)</span></span>
<span id="cb215-55"><a href="non-linear-least-squares-estimation.html#cb215-55" tabindex="-1"></a>            <span class="cf">if</span> (T <span class="sc">&lt;</span> <span class="fl">1e-6</span>)</span>
<span id="cb215-56"><a href="non-linear-least-squares-estimation.html#cb215-56" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb215-57"><a href="non-linear-least-squares-estimation.html#cb215-57" tabindex="-1"></a>        }</span>
<span id="cb215-58"><a href="non-linear-least-squares-estimation.html#cb215-58" tabindex="-1"></a>        </span>
<span id="cb215-59"><a href="non-linear-least-squares-estimation.html#cb215-59" tabindex="-1"></a>        <span class="fu">return</span>(best_theta)</span>
<span id="cb215-60"><a href="non-linear-least-squares-estimation.html#cb215-60" tabindex="-1"></a>    }</span>
<span id="cb215-61"><a href="non-linear-least-squares-estimation.html#cb215-61" tabindex="-1"></a></span>
<span id="cb215-62"><a href="non-linear-least-squares-estimation.html#cb215-62" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb215-63"><a href="non-linear-least-squares-estimation.html#cb215-63" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb215-64"><a href="non-linear-least-squares-estimation.html#cb215-64" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb215-65"><a href="non-linear-least-squares-estimation.html#cb215-65" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb215-66"><a href="non-linear-least-squares-estimation.html#cb215-66" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb215-67"><a href="non-linear-least-squares-estimation.html#cb215-67" tabindex="-1"></a></span>
<span id="cb215-68"><a href="non-linear-least-squares-estimation.html#cb215-68" tabindex="-1"></a><span class="co"># Initial guess</span></span>
<span id="cb215-69"><a href="non-linear-least-squares-estimation.html#cb215-69" tabindex="-1"></a>initial_theta <span class="ot">&lt;-</span></span>
<span id="cb215-70"><a href="non-linear-least-squares-estimation.html#cb215-70" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">runif</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="dv">3</span>), <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb215-71"><a href="non-linear-least-squares-estimation.html#cb215-71" tabindex="-1"></a></span>
<span id="cb215-72"><a href="non-linear-least-squares-estimation.html#cb215-72" tabindex="-1"></a><span class="co"># Run Simulated Annealing</span></span>
<span id="cb215-73"><a href="non-linear-least-squares-estimation.html#cb215-73" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">simulated_annealing</span>(x, y, initial_theta)</span>
<span id="cb215-74"><a href="non-linear-least-squares-estimation.html#cb215-74" tabindex="-1"></a></span>
<span id="cb215-75"><a href="non-linear-least-squares-estimation.html#cb215-75" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb215-76"><a href="non-linear-least-squares-estimation.html#cb215-76" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Simulated Annealing:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb215-77"><a href="non-linear-least-squares-estimation.html#cb215-77" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Simulated Annealing:</span></span>
<span id="cb215-78"><a href="non-linear-least-squares-estimation.html#cb215-78" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb215-79"><a href="non-linear-least-squares-estimation.html#cb215-79" tabindex="-1"></a><span class="co">#&gt; [1] 4.07180419 1.41457906 0.01422147</span></span>
<span id="cb215-80"><a href="non-linear-least-squares-estimation.html#cb215-80" tabindex="-1"></a></span>
<span id="cb215-81"><a href="non-linear-least-squares-estimation.html#cb215-81" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb215-82"><a href="non-linear-least-squares-estimation.html#cb215-82" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb215-83"><a href="non-linear-least-squares-estimation.html#cb215-83" tabindex="-1"></a>    x,</span>
<span id="cb215-84"><a href="non-linear-least-squares-estimation.html#cb215-84" tabindex="-1"></a>    y,</span>
<span id="cb215-85"><a href="non-linear-least-squares-estimation.html#cb215-85" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Simulated Annealing: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb215-86"><a href="non-linear-least-squares-estimation.html#cb215-86" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb215-87"><a href="non-linear-least-squares-estimation.html#cb215-87" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb215-88"><a href="non-linear-least-squares-estimation.html#cb215-88" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb215-89"><a href="non-linear-least-squares-estimation.html#cb215-89" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb215-90"><a href="non-linear-least-squares-estimation.html#cb215-90" tabindex="-1"></a>)</span>
<span id="cb215-91"><a href="non-linear-least-squares-estimation.html#cb215-91" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb215-92"><a href="non-linear-least-squares-estimation.html#cb215-92" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb215-93"><a href="non-linear-least-squares-estimation.html#cb215-93" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb215-94"><a href="non-linear-least-squares-estimation.html#cb215-94" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb215-95"><a href="non-linear-least-squares-estimation.html#cb215-95" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb215-96"><a href="non-linear-least-squares-estimation.html#cb215-96" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb215-97"><a href="non-linear-least-squares-estimation.html#cb215-97" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb215-98"><a href="non-linear-least-squares-estimation.html#cb215-98" tabindex="-1"></a>)</span>
<span id="cb215-99"><a href="non-linear-least-squares-estimation.html#cb215-99" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb215-100"><a href="non-linear-least-squares-estimation.html#cb215-100" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb215-101"><a href="non-linear-least-squares-estimation.html#cb215-101" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb215-102"><a href="non-linear-least-squares-estimation.html#cb215-102" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb215-103"><a href="non-linear-least-squares-estimation.html#cb215-103" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb215-104"><a href="non-linear-least-squares-estimation.html#cb215-104" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb215-105"><a href="non-linear-least-squares-estimation.html#cb215-105" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="genetic-algorithm" class="section level4 hasAnchor" number="6.2.3.3">
<h4><span class="header-section-number">6.2.3.3</span> Genetic Algorithm<a href="non-linear-least-squares-estimation.html#genetic-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Genetic Algorithms (GA) are a class of evolutionary algorithms inspired by the principles of natural selection and genetics. Unlike deterministic optimization techniques, GA evolves a population of candidate solutions over multiple generations, using genetic operators such as selection, crossover, and mutation.</p>
<p>GA is particularly useful when:</p>
<ul>
<li><p>The function is nonlinear, non-differentiable, or highly multimodal.</p></li>
<li><p>Gradient-based methods fail due to rugged function landscapes.</p></li>
<li><p>A global minimum is required, rather than a local one.</p></li>
</ul>
<p>The goal of a Genetic Algorithm is to find an optimal solution $\hat{\theta}$ that minimizes an objective function:</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Population Representation</strong></p>
<p>Each candidate solution (individual) is represented as a <strong>chromosome</strong>, which is simply a vector of parameters: <span class="math display">\[
\theta = (\theta_1, \theta_2, \theta_3)
\]</span></p>
<p>An entire <strong>population</strong> consists of multiple such solutions.</p>
<p><strong>2. Selection</strong></p>
<p>Each individual’s fitness is evaluated using:</p>
<p><span class="math display">\[
\text{Fitness}(\theta) = -SSE(\theta)
\]</span></p>
<p>We use <strong>Tournament Selection</strong> or <strong>Roulette Wheel Selection</strong> to choose parents for reproduction.</p>
<p><strong>3. Crossover (Recombination)</strong></p>
<p>A new solution <span class="math inline">\(\theta&#39;\)</span> is generated by <strong>combining</strong> two parents:</p>
<p><span class="math display">\[\theta&#39; = \alpha \theta_{\text{parent1}} + (1 - \alpha) \theta_{\text{parent2}}, \quad \alpha \sim U(0,1).\]</span></p>
<p><strong>4. Mutation</strong></p>
<p>Random small changes are introduced to <strong>increase diversity</strong>:</p>
<p><span class="math display">\[\theta_i&#39; = \theta_i + \mathcal{N}(0, \sigma),\]</span></p>
<p>where <span class="math inline">\(\mathcal{N}(0, \sigma)\)</span> is a <strong>small Gaussian perturbation</strong>.</p>
<p><strong>5. Evolutionary Cycle</strong></p>
<p>The <strong>algorithm iterates</strong> through:</p>
<ol style="list-style-type: decimal">
<li><p>Selection</p></li>
<li><p>Crossover</p></li>
<li><p>Mutation</p></li>
<li><p>Survival of the fittest</p></li>
<li><p>Termination when convergence is reached.</p></li>
</ol>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="non-linear-least-squares-estimation.html#cb216-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb216-2"><a href="non-linear-least-squares-estimation.html#cb216-2" tabindex="-1"></a><span class="fu">library</span>(GA)</span>
<span id="cb216-3"><a href="non-linear-least-squares-estimation.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="non-linear-least-squares-estimation.html#cb216-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb216-5"><a href="non-linear-least-squares-estimation.html#cb216-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb216-6"><a href="non-linear-least-squares-estimation.html#cb216-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb216-7"><a href="non-linear-least-squares-estimation.html#cb216-7" tabindex="-1"></a>}</span>
<span id="cb216-8"><a href="non-linear-least-squares-estimation.html#cb216-8" tabindex="-1"></a></span>
<span id="cb216-9"><a href="non-linear-least-squares-estimation.html#cb216-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb216-10"><a href="non-linear-least-squares-estimation.html#cb216-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb216-11"><a href="non-linear-least-squares-estimation.html#cb216-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb216-12"><a href="non-linear-least-squares-estimation.html#cb216-12" tabindex="-1"></a>}</span>
<span id="cb216-13"><a href="non-linear-least-squares-estimation.html#cb216-13" tabindex="-1"></a></span>
<span id="cb216-14"><a href="non-linear-least-squares-estimation.html#cb216-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function for optimization</span></span>
<span id="cb216-15"><a href="non-linear-least-squares-estimation.html#cb216-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb216-16"><a href="non-linear-least-squares-estimation.html#cb216-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb216-17"><a href="non-linear-least-squares-estimation.html#cb216-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb216-18"><a href="non-linear-least-squares-estimation.html#cb216-18" tabindex="-1"></a>}</span>
<span id="cb216-19"><a href="non-linear-least-squares-estimation.html#cb216-19" tabindex="-1"></a></span>
<span id="cb216-20"><a href="non-linear-least-squares-estimation.html#cb216-20" tabindex="-1"></a><span class="co"># Genetic Algorithm for Optimization</span></span>
<span id="cb216-21"><a href="non-linear-least-squares-estimation.html#cb216-21" tabindex="-1"></a>ga_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb216-22"><a href="non-linear-least-squares-estimation.html#cb216-22" tabindex="-1"></a>    <span class="co"># Define fitness function (negative SSE for maximization)</span></span>
<span id="cb216-23"><a href="non-linear-least-squares-estimation.html#cb216-23" tabindex="-1"></a>    fitness_function <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb216-24"><a href="non-linear-least-squares-estimation.html#cb216-24" tabindex="-1"></a>        <span class="co"># GA maximizes fitness, so we use negative SSE</span></span>
<span id="cb216-25"><a href="non-linear-least-squares-estimation.html#cb216-25" tabindex="-1"></a>        <span class="fu">return</span>(<span class="sc">-</span><span class="fu">sse</span>(theta, x, y))  </span>
<span id="cb216-26"><a href="non-linear-least-squares-estimation.html#cb216-26" tabindex="-1"></a>    }</span>
<span id="cb216-27"><a href="non-linear-least-squares-estimation.html#cb216-27" tabindex="-1"></a>    </span>
<span id="cb216-28"><a href="non-linear-least-squares-estimation.html#cb216-28" tabindex="-1"></a>    <span class="co"># Set parameter bounds</span></span>
<span id="cb216-29"><a href="non-linear-least-squares-estimation.html#cb216-29" tabindex="-1"></a>    lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fu">min</span>(x))  <span class="co"># Ensure positive scaling</span></span>
<span id="cb216-30"><a href="non-linear-least-squares-estimation.html#cb216-30" tabindex="-1"></a>    upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(y) <span class="sc">*</span> <span class="dv">2</span>, <span class="dv">10</span>, <span class="fu">max</span>(x))</span>
<span id="cb216-31"><a href="non-linear-least-squares-estimation.html#cb216-31" tabindex="-1"></a>    </span>
<span id="cb216-32"><a href="non-linear-least-squares-estimation.html#cb216-32" tabindex="-1"></a>    <span class="co"># Run GA optimization</span></span>
<span id="cb216-33"><a href="non-linear-least-squares-estimation.html#cb216-33" tabindex="-1"></a>    ga_result <span class="ot">&lt;-</span> <span class="fu">ga</span>(</span>
<span id="cb216-34"><a href="non-linear-least-squares-estimation.html#cb216-34" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;real-valued&quot;</span>,</span>
<span id="cb216-35"><a href="non-linear-least-squares-estimation.html#cb216-35" tabindex="-1"></a>        <span class="at">fitness =</span> fitness_function,</span>
<span id="cb216-36"><a href="non-linear-least-squares-estimation.html#cb216-36" tabindex="-1"></a>        <span class="at">lower =</span> lower_bounds,</span>
<span id="cb216-37"><a href="non-linear-least-squares-estimation.html#cb216-37" tabindex="-1"></a>        <span class="at">upper =</span> upper_bounds,</span>
<span id="cb216-38"><a href="non-linear-least-squares-estimation.html#cb216-38" tabindex="-1"></a>        <span class="at">popSize =</span> <span class="dv">50</span>,</span>
<span id="cb216-39"><a href="non-linear-least-squares-estimation.html#cb216-39" tabindex="-1"></a>        <span class="co"># Population size</span></span>
<span id="cb216-40"><a href="non-linear-least-squares-estimation.html#cb216-40" tabindex="-1"></a>        <span class="at">maxiter =</span> <span class="dv">200</span>,</span>
<span id="cb216-41"><a href="non-linear-least-squares-estimation.html#cb216-41" tabindex="-1"></a>        <span class="co"># Max generations</span></span>
<span id="cb216-42"><a href="non-linear-least-squares-estimation.html#cb216-42" tabindex="-1"></a>        <span class="at">pmutation =</span> <span class="fl">0.1</span>,</span>
<span id="cb216-43"><a href="non-linear-least-squares-estimation.html#cb216-43" tabindex="-1"></a>        <span class="co"># Mutation probability</span></span>
<span id="cb216-44"><a href="non-linear-least-squares-estimation.html#cb216-44" tabindex="-1"></a>        <span class="at">monitor =</span> <span class="cn">FALSE</span></span>
<span id="cb216-45"><a href="non-linear-least-squares-estimation.html#cb216-45" tabindex="-1"></a>    )</span>
<span id="cb216-46"><a href="non-linear-least-squares-estimation.html#cb216-46" tabindex="-1"></a>    </span>
<span id="cb216-47"><a href="non-linear-least-squares-estimation.html#cb216-47" tabindex="-1"></a>    <span class="fu">return</span>(ga_result<span class="sc">@</span>solution)  <span class="co"># Return optimized parameters</span></span>
<span id="cb216-48"><a href="non-linear-least-squares-estimation.html#cb216-48" tabindex="-1"></a>}</span>
<span id="cb216-49"><a href="non-linear-least-squares-estimation.html#cb216-49" tabindex="-1"></a></span>
<span id="cb216-50"><a href="non-linear-least-squares-estimation.html#cb216-50" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb216-51"><a href="non-linear-least-squares-estimation.html#cb216-51" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb216-52"><a href="non-linear-least-squares-estimation.html#cb216-52" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb216-53"><a href="non-linear-least-squares-estimation.html#cb216-53" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb216-54"><a href="non-linear-least-squares-estimation.html#cb216-54" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb216-55"><a href="non-linear-least-squares-estimation.html#cb216-55" tabindex="-1"></a></span>
<span id="cb216-56"><a href="non-linear-least-squares-estimation.html#cb216-56" tabindex="-1"></a><span class="co"># Run Genetic Algorithm</span></span>
<span id="cb216-57"><a href="non-linear-least-squares-estimation.html#cb216-57" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">ga_optimization</span>(x, y)</span>
<span id="cb216-58"><a href="non-linear-least-squares-estimation.html#cb216-58" tabindex="-1"></a></span>
<span id="cb216-59"><a href="non-linear-least-squares-estimation.html#cb216-59" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb216-60"><a href="non-linear-least-squares-estimation.html#cb216-60" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Genetic Algorithm:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb216-61"><a href="non-linear-least-squares-estimation.html#cb216-61" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Genetic Algorithm:</span></span>
<span id="cb216-62"><a href="non-linear-least-squares-estimation.html#cb216-62" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb216-63"><a href="non-linear-least-squares-estimation.html#cb216-63" tabindex="-1"></a><span class="co">#&gt;            x1       x2         x3</span></span>
<span id="cb216-64"><a href="non-linear-least-squares-estimation.html#cb216-64" tabindex="-1"></a><span class="co">#&gt; [1,] 4.066144 1.433886 0.00824126</span></span>
<span id="cb216-65"><a href="non-linear-least-squares-estimation.html#cb216-65" tabindex="-1"></a></span>
<span id="cb216-66"><a href="non-linear-least-squares-estimation.html#cb216-66" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb216-67"><a href="non-linear-least-squares-estimation.html#cb216-67" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb216-68"><a href="non-linear-least-squares-estimation.html#cb216-68" tabindex="-1"></a>    x,</span>
<span id="cb216-69"><a href="non-linear-least-squares-estimation.html#cb216-69" tabindex="-1"></a>    y,</span>
<span id="cb216-70"><a href="non-linear-least-squares-estimation.html#cb216-70" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Genetic Algorithm: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb216-71"><a href="non-linear-least-squares-estimation.html#cb216-71" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb216-72"><a href="non-linear-least-squares-estimation.html#cb216-72" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb216-73"><a href="non-linear-least-squares-estimation.html#cb216-73" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb216-74"><a href="non-linear-least-squares-estimation.html#cb216-74" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb216-75"><a href="non-linear-least-squares-estimation.html#cb216-75" tabindex="-1"></a>)</span>
<span id="cb216-76"><a href="non-linear-least-squares-estimation.html#cb216-76" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb216-77"><a href="non-linear-least-squares-estimation.html#cb216-77" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb216-78"><a href="non-linear-least-squares-estimation.html#cb216-78" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb216-79"><a href="non-linear-least-squares-estimation.html#cb216-79" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb216-80"><a href="non-linear-least-squares-estimation.html#cb216-80" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb216-81"><a href="non-linear-least-squares-estimation.html#cb216-81" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb216-82"><a href="non-linear-least-squares-estimation.html#cb216-82" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb216-83"><a href="non-linear-least-squares-estimation.html#cb216-83" tabindex="-1"></a>)</span>
<span id="cb216-84"><a href="non-linear-least-squares-estimation.html#cb216-84" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb216-85"><a href="non-linear-least-squares-estimation.html#cb216-85" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb216-86"><a href="non-linear-least-squares-estimation.html#cb216-86" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb216-87"><a href="non-linear-least-squares-estimation.html#cb216-87" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb216-88"><a href="non-linear-least-squares-estimation.html#cb216-88" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb216-89"><a href="non-linear-least-squares-estimation.html#cb216-89" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb216-90"><a href="non-linear-least-squares-estimation.html#cb216-90" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="particle-swarm-optimization" class="section level4 hasAnchor" number="6.2.3.4">
<h4><span class="header-section-number">6.2.3.4</span> Particle Swarm Optimization<a href="non-linear-least-squares-estimation.html#particle-swarm-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Particle Swarm Optimization (PSO) is a population-based global optimization algorithm inspired by the social behavior of birds and fish schools. Instead of using genetic operators (like in Genetic Algorithms), PSO models particles (solutions) flying through the search space, adjusting their position based on their own experience and the experience of their neighbors.</p>
<p>PSO is particularly useful when:</p>
<ul>
<li><p>The function is nonlinear, noisy, or lacks smooth gradients.</p></li>
<li><p>Gradient-based methods struggle due to non-differentiability.</p></li>
<li><p>A global minimum is needed, rather than a local one.</p></li>
</ul>
<hr />
<p>The goal of PSO is to find an optimal solution <span class="math inline">\(\hat{\theta}\)</span> that minimizes an objective function:</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Particle Representation</strong></p>
<p>Each <strong>particle</strong> represents a candidate solution:</p>
<p><span class="math display">\[
\theta_i = (\theta_{i1}, \theta_{i2}, \theta_{i3})
\]</span></p>
<p>where <span class="math inline">\(\theta_{ij}\)</span> is the <span class="math inline">\(j^{th}\)</span> parameter of particle <span class="math inline">\(i\)</span>.</p>
<p><strong>2. Particle Velocity and Position Updates</strong></p>
<p>Each particle moves in the search space with <strong>velocity</strong> <span class="math inline">\(v_i\)</span>, which is updated as:</p>
<p><span class="math display">\[
v_i^{(t+1)} = \omega v_i^{(t)} + c_1 r_1 (p_i - \theta_i^{(t)}) + c_2 r_2 (g - \theta_i^{(t)})
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\omega\)</span> is the <strong>inertia weight</strong> (controls exploration vs. exploitation),</p></li>
<li><p><span class="math inline">\(c_1, c_2\)</span> are <strong>acceleration coefficients</strong>,</p></li>
<li><p><span class="math inline">\(r_1, r_2 \sim U(0,1)\)</span> are random numbers,</p></li>
<li><p><span class="math inline">\(p_i\)</span> is the <strong>particle’s personal best position</strong>,</p></li>
<li><p><span class="math inline">\(g\)</span> is the <strong>global best position</strong>.</p></li>
</ul>
<p>Then, the <strong>position update</strong> is:</p>
<p><span class="math display">\[
\theta_i^{(t+1)} = \theta_i^{(t)} + v_i^{(t+1)}
\]</span></p>
<p>This process continues until <strong>convergence criteria</strong> (like a max number of iterations or minimum error) is met.</p>
<hr />
<p><strong>Particle Swarm Optimization Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize particles randomly within search bounds.</li>
<li>Set random initial velocities.</li>
<li>Evaluate SSE for each particle.</li>
<li>Update the personal and global best solutions.</li>
<li>Update velocities and positions using the update equations.</li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="non-linear-least-squares-estimation.html#cb217-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb217-2"><a href="non-linear-least-squares-estimation.html#cb217-2" tabindex="-1"></a><span class="fu">library</span>(pso)</span>
<span id="cb217-3"><a href="non-linear-least-squares-estimation.html#cb217-3" tabindex="-1"></a></span>
<span id="cb217-4"><a href="non-linear-least-squares-estimation.html#cb217-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb217-5"><a href="non-linear-least-squares-estimation.html#cb217-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb217-6"><a href="non-linear-least-squares-estimation.html#cb217-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb217-7"><a href="non-linear-least-squares-estimation.html#cb217-7" tabindex="-1"></a>}</span>
<span id="cb217-8"><a href="non-linear-least-squares-estimation.html#cb217-8" tabindex="-1"></a></span>
<span id="cb217-9"><a href="non-linear-least-squares-estimation.html#cb217-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb217-10"><a href="non-linear-least-squares-estimation.html#cb217-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb217-11"><a href="non-linear-least-squares-estimation.html#cb217-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb217-12"><a href="non-linear-least-squares-estimation.html#cb217-12" tabindex="-1"></a>}</span>
<span id="cb217-13"><a href="non-linear-least-squares-estimation.html#cb217-13" tabindex="-1"></a></span>
<span id="cb217-14"><a href="non-linear-least-squares-estimation.html#cb217-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function for optimization</span></span>
<span id="cb217-15"><a href="non-linear-least-squares-estimation.html#cb217-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb217-16"><a href="non-linear-least-squares-estimation.html#cb217-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb217-17"><a href="non-linear-least-squares-estimation.html#cb217-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb217-18"><a href="non-linear-least-squares-estimation.html#cb217-18" tabindex="-1"></a>}</span>
<span id="cb217-19"><a href="non-linear-least-squares-estimation.html#cb217-19" tabindex="-1"></a></span>
<span id="cb217-20"><a href="non-linear-least-squares-estimation.html#cb217-20" tabindex="-1"></a><span class="co"># Particle Swarm Optimization (PSO) for Nonlinear Regression</span></span>
<span id="cb217-21"><a href="non-linear-least-squares-estimation.html#cb217-21" tabindex="-1"></a>pso_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb217-22"><a href="non-linear-least-squares-estimation.html#cb217-22" tabindex="-1"></a>    <span class="co"># Define fitness function (minimize SSE)</span></span>
<span id="cb217-23"><a href="non-linear-least-squares-estimation.html#cb217-23" tabindex="-1"></a>    fitness_function <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb217-24"><a href="non-linear-least-squares-estimation.html#cb217-24" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sse</span>(theta, x, y))</span>
<span id="cb217-25"><a href="non-linear-least-squares-estimation.html#cb217-25" tabindex="-1"></a>    }</span>
<span id="cb217-26"><a href="non-linear-least-squares-estimation.html#cb217-26" tabindex="-1"></a>    </span>
<span id="cb217-27"><a href="non-linear-least-squares-estimation.html#cb217-27" tabindex="-1"></a>    <span class="co"># Set parameter bounds</span></span>
<span id="cb217-28"><a href="non-linear-least-squares-estimation.html#cb217-28" tabindex="-1"></a>    lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fu">min</span>(x))  <span class="co"># Ensure positive scaling</span></span>
<span id="cb217-29"><a href="non-linear-least-squares-estimation.html#cb217-29" tabindex="-1"></a>    upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(y) <span class="sc">*</span> <span class="dv">2</span>, <span class="dv">10</span>, <span class="fu">max</span>(x))</span>
<span id="cb217-30"><a href="non-linear-least-squares-estimation.html#cb217-30" tabindex="-1"></a>    </span>
<span id="cb217-31"><a href="non-linear-least-squares-estimation.html#cb217-31" tabindex="-1"></a>    <span class="co"># Run PSO optimization</span></span>
<span id="cb217-32"><a href="non-linear-least-squares-estimation.html#cb217-32" tabindex="-1"></a>    pso_result <span class="ot">&lt;-</span> <span class="fu">psoptim</span>(</span>
<span id="cb217-33"><a href="non-linear-least-squares-estimation.html#cb217-33" tabindex="-1"></a>        <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb217-34"><a href="non-linear-least-squares-estimation.html#cb217-34" tabindex="-1"></a>        <span class="co"># Initial guess</span></span>
<span id="cb217-35"><a href="non-linear-least-squares-estimation.html#cb217-35" tabindex="-1"></a>        <span class="at">fn =</span> fitness_function,</span>
<span id="cb217-36"><a href="non-linear-least-squares-estimation.html#cb217-36" tabindex="-1"></a>        <span class="at">lower =</span> lower_bounds,</span>
<span id="cb217-37"><a href="non-linear-least-squares-estimation.html#cb217-37" tabindex="-1"></a>        <span class="at">upper =</span> upper_bounds,</span>
<span id="cb217-38"><a href="non-linear-least-squares-estimation.html#cb217-38" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> <span class="dv">200</span>, <span class="at">s =</span> <span class="dv">50</span>)  <span class="co"># 200 iterations, 50 particles</span></span>
<span id="cb217-39"><a href="non-linear-least-squares-estimation.html#cb217-39" tabindex="-1"></a>    )</span>
<span id="cb217-40"><a href="non-linear-least-squares-estimation.html#cb217-40" tabindex="-1"></a>    </span>
<span id="cb217-41"><a href="non-linear-least-squares-estimation.html#cb217-41" tabindex="-1"></a>    <span class="fu">return</span>(pso_result<span class="sc">$</span>par)  <span class="co"># Return optimized parameters</span></span>
<span id="cb217-42"><a href="non-linear-least-squares-estimation.html#cb217-42" tabindex="-1"></a>}</span>
<span id="cb217-43"><a href="non-linear-least-squares-estimation.html#cb217-43" tabindex="-1"></a></span>
<span id="cb217-44"><a href="non-linear-least-squares-estimation.html#cb217-44" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb217-45"><a href="non-linear-least-squares-estimation.html#cb217-45" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb217-46"><a href="non-linear-least-squares-estimation.html#cb217-46" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb217-47"><a href="non-linear-least-squares-estimation.html#cb217-47" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb217-48"><a href="non-linear-least-squares-estimation.html#cb217-48" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb217-49"><a href="non-linear-least-squares-estimation.html#cb217-49" tabindex="-1"></a></span>
<span id="cb217-50"><a href="non-linear-least-squares-estimation.html#cb217-50" tabindex="-1"></a><span class="co"># Run Particle Swarm Optimization</span></span>
<span id="cb217-51"><a href="non-linear-least-squares-estimation.html#cb217-51" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">pso_optimization</span>(x, y)</span>
<span id="cb217-52"><a href="non-linear-least-squares-estimation.html#cb217-52" tabindex="-1"></a></span>
<span id="cb217-53"><a href="non-linear-least-squares-estimation.html#cb217-53" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb217-54"><a href="non-linear-least-squares-estimation.html#cb217-54" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Particle Swarm Optimization:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb217-55"><a href="non-linear-least-squares-estimation.html#cb217-55" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Particle Swarm Optimization:</span></span>
<span id="cb217-56"><a href="non-linear-least-squares-estimation.html#cb217-56" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb217-57"><a href="non-linear-least-squares-estimation.html#cb217-57" tabindex="-1"></a><span class="co">#&gt; [1] 4.06876562 1.42765613 0.01128767</span></span>
<span id="cb217-58"><a href="non-linear-least-squares-estimation.html#cb217-58" tabindex="-1"></a></span>
<span id="cb217-59"><a href="non-linear-least-squares-estimation.html#cb217-59" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb217-60"><a href="non-linear-least-squares-estimation.html#cb217-60" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb217-61"><a href="non-linear-least-squares-estimation.html#cb217-61" tabindex="-1"></a>    x,</span>
<span id="cb217-62"><a href="non-linear-least-squares-estimation.html#cb217-62" tabindex="-1"></a>    y,</span>
<span id="cb217-63"><a href="non-linear-least-squares-estimation.html#cb217-63" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Particle Swarm Optimization: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb217-64"><a href="non-linear-least-squares-estimation.html#cb217-64" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb217-65"><a href="non-linear-least-squares-estimation.html#cb217-65" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb217-66"><a href="non-linear-least-squares-estimation.html#cb217-66" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb217-67"><a href="non-linear-least-squares-estimation.html#cb217-67" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb217-68"><a href="non-linear-least-squares-estimation.html#cb217-68" tabindex="-1"></a>)</span>
<span id="cb217-69"><a href="non-linear-least-squares-estimation.html#cb217-69" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb217-70"><a href="non-linear-least-squares-estimation.html#cb217-70" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb217-71"><a href="non-linear-least-squares-estimation.html#cb217-71" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb217-72"><a href="non-linear-least-squares-estimation.html#cb217-72" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb217-73"><a href="non-linear-least-squares-estimation.html#cb217-73" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb217-74"><a href="non-linear-least-squares-estimation.html#cb217-74" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb217-75"><a href="non-linear-least-squares-estimation.html#cb217-75" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb217-76"><a href="non-linear-least-squares-estimation.html#cb217-76" tabindex="-1"></a>)</span>
<span id="cb217-77"><a href="non-linear-least-squares-estimation.html#cb217-77" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb217-78"><a href="non-linear-least-squares-estimation.html#cb217-78" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb217-79"><a href="non-linear-least-squares-estimation.html#cb217-79" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb217-80"><a href="non-linear-least-squares-estimation.html#cb217-80" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb217-81"><a href="non-linear-least-squares-estimation.html#cb217-81" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb217-82"><a href="non-linear-least-squares-estimation.html#cb217-82" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb217-83"><a href="non-linear-least-squares-estimation.html#cb217-83" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="evolutionary-strategies" class="section level4 hasAnchor" number="6.2.3.5">
<h4><span class="header-section-number">6.2.3.5</span> Evolutionary Strategies<a href="non-linear-least-squares-estimation.html#evolutionary-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Evolutionary Strategies (ES) are a class of evolutionary optimization algorithms that improve solutions by mutating and selecting individuals based on fitness. Unlike <a href="non-linear-least-squares-estimation.html#genetic-algorithm">Genetic Algorithm</a>, ES focuses on self-adaptive mutation rates and selection pressure rather than crossover. This makes ES particularly robust for continuous optimization problems like nonlinear regression.</p>
<p>ES is particularly useful when:</p>
<ul>
<li><p>The function is complex, noisy, or lacks smooth gradients.</p></li>
<li><p>Gradient-based methods fail due to non-differentiability.</p></li>
<li><p>An adaptive approach to exploration and exploitation is needed.</p></li>
</ul>
<hr />
<p>The goal of ES is to find an optimal solution <span class="math inline">\(\hat{\theta}\)</span> that minimizes an objective function:</p>
<p><span class="math display">\[
\hat{\theta} = \arg\min_{\theta} SSE(\theta),
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. Population Representation</strong></p>
<p>Each <strong>individual</strong> is a solution <span class="math inline">\(\theta_i\)</span> in the parameter space:</p>
<p><span class="math display">\[
\theta_i = (\theta_{i1}, \theta_{i2}, \theta_{i3}).
\]</span></p>
<p>The <strong>population</strong> consists of multiple individuals, each representing different candidate parameters.</p>
<p><strong>2. Mutation</strong></p>
<p>New candidate solutions are generated by <strong>adding random noise</strong>:</p>
<p><span class="math display">\[
\theta&#39;_i = \theta_i + \sigma \mathcal{N}(0, I),
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\sigma\)</span> is the <strong>mutation step size</strong>, which adapts over time.</p></li>
<li><p><span class="math inline">\(\mathcal{N}(0, I)\)</span> is a standard normal distribution.</p></li>
</ul>
<p><strong>3. Selection</strong></p>
<p>ES employs <span class="math inline">\((\mu, \lambda)\)</span>-selection:</p>
<ul>
<li><p><span class="math inline">\((\mu, \lambda)\)</span>-ES: Select the best <span class="math inline">\(\mu\)</span> solutions from <span class="math inline">\(\lambda\)</span> offspring.</p></li>
<li><p><span class="math inline">\((\mu + \lambda)\)</span>-ES: Combine parents and offspring, selecting the top <span class="math inline">\(\mu\)</span>.</p></li>
</ul>
<p><strong>4. Step-Size Adaptation</strong></p>
<p>Mutation strength <span class="math inline">\(\sigma\)</span> <strong>self-adapts</strong> using the <strong>1/5 success rule</strong>:</p>
<p><span class="math display">\[
\sigma_{t+1} =
\begin{cases}
\sigma_t / c, &amp; \text{if success rate } &gt; 1/5 \\
\sigma_t \cdot c, &amp; \text{if success rate } &lt; 1/5
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(c &gt; 1\)</span> is a scaling factor.</p>
<hr />
<p><strong>Evolutionary Strategies Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize a population of <span class="math inline">\(\lambda\)</span> solutions with random parameters.</li>
<li>Set mutation step size <span class="math inline">\(\sigma\)</span>.</li>
<li>Repeat for max iterations:
<ul>
<li>Generate <span class="math inline">\(\lambda\)</span> offspring by mutating parent solutions.</li>
<li>Evaluate fitness (SSE) of each offspring.</li>
<li>Select the best <span class="math inline">\(\mu\)</span> solutions for the next generation.</li>
<li>Adapt mutation step size based on success rate.</li>
</ul></li>
<li>Return the best solution found.</li>
</ol>
<hr />
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="non-linear-least-squares-estimation.html#cb218-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb218-2"><a href="non-linear-least-squares-estimation.html#cb218-2" tabindex="-1"></a><span class="fu">library</span>(DEoptim)</span>
<span id="cb218-3"><a href="non-linear-least-squares-estimation.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="non-linear-least-squares-estimation.html#cb218-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb218-5"><a href="non-linear-least-squares-estimation.html#cb218-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb218-6"><a href="non-linear-least-squares-estimation.html#cb218-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb218-7"><a href="non-linear-least-squares-estimation.html#cb218-7" tabindex="-1"></a>}</span>
<span id="cb218-8"><a href="non-linear-least-squares-estimation.html#cb218-8" tabindex="-1"></a></span>
<span id="cb218-9"><a href="non-linear-least-squares-estimation.html#cb218-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb218-10"><a href="non-linear-least-squares-estimation.html#cb218-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb218-11"><a href="non-linear-least-squares-estimation.html#cb218-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb218-12"><a href="non-linear-least-squares-estimation.html#cb218-12" tabindex="-1"></a>}</span>
<span id="cb218-13"><a href="non-linear-least-squares-estimation.html#cb218-13" tabindex="-1"></a></span>
<span id="cb218-14"><a href="non-linear-least-squares-estimation.html#cb218-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function for optimization</span></span>
<span id="cb218-15"><a href="non-linear-least-squares-estimation.html#cb218-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb218-16"><a href="non-linear-least-squares-estimation.html#cb218-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb218-17"><a href="non-linear-least-squares-estimation.html#cb218-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb218-18"><a href="non-linear-least-squares-estimation.html#cb218-18" tabindex="-1"></a>}</span>
<span id="cb218-19"><a href="non-linear-least-squares-estimation.html#cb218-19" tabindex="-1"></a></span>
<span id="cb218-20"><a href="non-linear-least-squares-estimation.html#cb218-20" tabindex="-1"></a><span class="co"># Evolutionary Strategies Optimization (Using Differential Evolution)</span></span>
<span id="cb218-21"><a href="non-linear-least-squares-estimation.html#cb218-21" tabindex="-1"></a>es_optimization <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb218-22"><a href="non-linear-least-squares-estimation.html#cb218-22" tabindex="-1"></a>    <span class="co"># Define fitness function (minimize SSE)</span></span>
<span id="cb218-23"><a href="non-linear-least-squares-estimation.html#cb218-23" tabindex="-1"></a>    fitness_function <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {</span>
<span id="cb218-24"><a href="non-linear-least-squares-estimation.html#cb218-24" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sse</span>(theta, x, y))</span>
<span id="cb218-25"><a href="non-linear-least-squares-estimation.html#cb218-25" tabindex="-1"></a>    }</span>
<span id="cb218-26"><a href="non-linear-least-squares-estimation.html#cb218-26" tabindex="-1"></a></span>
<span id="cb218-27"><a href="non-linear-least-squares-estimation.html#cb218-27" tabindex="-1"></a>    <span class="co"># Set parameter bounds</span></span>
<span id="cb218-28"><a href="non-linear-least-squares-estimation.html#cb218-28" tabindex="-1"></a>    lower_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fu">min</span>(x))  <span class="co"># Ensure positive scaling</span></span>
<span id="cb218-29"><a href="non-linear-least-squares-estimation.html#cb218-29" tabindex="-1"></a>    upper_bounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(y) <span class="sc">*</span> <span class="dv">2</span>, <span class="dv">10</span>, <span class="fu">max</span>(x))</span>
<span id="cb218-30"><a href="non-linear-least-squares-estimation.html#cb218-30" tabindex="-1"></a></span>
<span id="cb218-31"><a href="non-linear-least-squares-estimation.html#cb218-31" tabindex="-1"></a>    <span class="co"># Run Differential Evolution (mimicking ES)</span></span>
<span id="cb218-32"><a href="non-linear-least-squares-estimation.html#cb218-32" tabindex="-1"></a>    es_result <span class="ot">&lt;-</span> <span class="fu">DEoptim</span>(</span>
<span id="cb218-33"><a href="non-linear-least-squares-estimation.html#cb218-33" tabindex="-1"></a>        <span class="at">fn =</span> fitness_function,</span>
<span id="cb218-34"><a href="non-linear-least-squares-estimation.html#cb218-34" tabindex="-1"></a>        <span class="at">lower =</span> lower_bounds,</span>
<span id="cb218-35"><a href="non-linear-least-squares-estimation.html#cb218-35" tabindex="-1"></a>        <span class="at">upper =</span> upper_bounds,</span>
<span id="cb218-36"><a href="non-linear-least-squares-estimation.html#cb218-36" tabindex="-1"></a>        <span class="co"># 50 individuals, 200 generations, suppress iteration output</span></span>
<span id="cb218-37"><a href="non-linear-least-squares-estimation.html#cb218-37" tabindex="-1"></a>        <span class="fu">DEoptim.control</span>(<span class="at">NP =</span> <span class="dv">50</span>, <span class="at">itermax =</span> <span class="dv">200</span>, <span class="at">trace =</span> F)  </span>
<span id="cb218-38"><a href="non-linear-least-squares-estimation.html#cb218-38" tabindex="-1"></a>    )</span>
<span id="cb218-39"><a href="non-linear-least-squares-estimation.html#cb218-39" tabindex="-1"></a></span>
<span id="cb218-40"><a href="non-linear-least-squares-estimation.html#cb218-40" tabindex="-1"></a>    <span class="fu">return</span>(es_result<span class="sc">$</span>optim<span class="sc">$</span>bestmem)  <span class="co"># Return optimized parameters</span></span>
<span id="cb218-41"><a href="non-linear-least-squares-estimation.html#cb218-41" tabindex="-1"></a>}</span>
<span id="cb218-42"><a href="non-linear-least-squares-estimation.html#cb218-42" tabindex="-1"></a></span>
<span id="cb218-43"><a href="non-linear-least-squares-estimation.html#cb218-43" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb218-44"><a href="non-linear-least-squares-estimation.html#cb218-44" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb218-45"><a href="non-linear-least-squares-estimation.html#cb218-45" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb218-46"><a href="non-linear-least-squares-estimation.html#cb218-46" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb218-47"><a href="non-linear-least-squares-estimation.html#cb218-47" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb218-48"><a href="non-linear-least-squares-estimation.html#cb218-48" tabindex="-1"></a></span>
<span id="cb218-49"><a href="non-linear-least-squares-estimation.html#cb218-49" tabindex="-1"></a><span class="co"># Run Evolutionary Strategies Optimization</span></span>
<span id="cb218-50"><a href="non-linear-least-squares-estimation.html#cb218-50" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">es_optimization</span>(x, y)</span>
<span id="cb218-51"><a href="non-linear-least-squares-estimation.html#cb218-51" tabindex="-1"></a></span>
<span id="cb218-52"><a href="non-linear-least-squares-estimation.html#cb218-52" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb218-53"><a href="non-linear-least-squares-estimation.html#cb218-53" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Evolutionary Strategies:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb218-54"><a href="non-linear-least-squares-estimation.html#cb218-54" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Evolutionary Strategies:</span></span>
<span id="cb218-55"><a href="non-linear-least-squares-estimation.html#cb218-55" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb218-56"><a href="non-linear-least-squares-estimation.html#cb218-56" tabindex="-1"></a><span class="co">#&gt;       par1       par2       par3 </span></span>
<span id="cb218-57"><a href="non-linear-least-squares-estimation.html#cb218-57" tabindex="-1"></a><span class="co">#&gt; 4.06876561 1.42765613 0.01128767</span></span>
<span id="cb218-58"><a href="non-linear-least-squares-estimation.html#cb218-58" tabindex="-1"></a></span>
<span id="cb218-59"><a href="non-linear-least-squares-estimation.html#cb218-59" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb218-60"><a href="non-linear-least-squares-estimation.html#cb218-60" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb218-61"><a href="non-linear-least-squares-estimation.html#cb218-61" tabindex="-1"></a>    x, y,</span>
<span id="cb218-62"><a href="non-linear-least-squares-estimation.html#cb218-62" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Evolutionary Strategies: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb218-63"><a href="non-linear-least-squares-estimation.html#cb218-63" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb218-64"><a href="non-linear-least-squares-estimation.html#cb218-64" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb218-65"><a href="non-linear-least-squares-estimation.html#cb218-65" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb218-66"><a href="non-linear-least-squares-estimation.html#cb218-66" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb218-67"><a href="non-linear-least-squares-estimation.html#cb218-67" tabindex="-1"></a>)</span>
<span id="cb218-68"><a href="non-linear-least-squares-estimation.html#cb218-68" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb218-69"><a href="non-linear-least-squares-estimation.html#cb218-69" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb218-70"><a href="non-linear-least-squares-estimation.html#cb218-70" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb218-71"><a href="non-linear-least-squares-estimation.html#cb218-71" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb218-72"><a href="non-linear-least-squares-estimation.html#cb218-72" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb218-73"><a href="non-linear-least-squares-estimation.html#cb218-73" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb218-74"><a href="non-linear-least-squares-estimation.html#cb218-74" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb218-75"><a href="non-linear-least-squares-estimation.html#cb218-75" tabindex="-1"></a>)</span>
<span id="cb218-76"><a href="non-linear-least-squares-estimation.html#cb218-76" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb218-77"><a href="non-linear-least-squares-estimation.html#cb218-77" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb218-78"><a href="non-linear-least-squares-estimation.html#cb218-78" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb218-79"><a href="non-linear-least-squares-estimation.html#cb218-79" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb218-80"><a href="non-linear-least-squares-estimation.html#cb218-80" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb218-81"><a href="non-linear-least-squares-estimation.html#cb218-81" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb218-82"><a href="non-linear-least-squares-estimation.html#cb218-82" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="linearization-nonlinear-regression-optimization" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Linearization<a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="taylor-series-approximation-nonlinear-optimization" class="section level4 hasAnchor" number="6.2.4.1">
<h4><span class="header-section-number">6.2.4.1</span> Taylor Series Approximation<a href="non-linear-least-squares-estimation.html#taylor-series-approximation-nonlinear-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Taylor Series Approximation is a fundamental tool in nonlinear optimization, enabling local approximation of complex functions using polynomial expansions. It is widely used to linearize nonlinear models, facilitate derivative-based optimization, and derive Newton-type methods.</p>
<p>Taylor series approximation is particularly useful when:</p>
<ul>
<li><p>A nonlinear function is difficult to compute directly.</p></li>
<li><p>Optimization requires local gradient and curvature information.</p></li>
<li><p>A simpler, polynomial-based approximation improves computational efficiency.</p></li>
</ul>
<hr />
<p>Given a differentiable function <span class="math inline">\(f(\theta)\)</span>, its <strong>Taylor series expansion</strong> around a point <span class="math inline">\(\theta_0\)</span> is:</p>
<p><span class="math display">\[
f(\theta) = f(\theta_0) + f&#39;(\theta_0)(\theta - \theta_0) + \frac{1}{2} f&#39;&#39;(\theta_0)(\theta - \theta_0)^2 + \mathcal{O}((\theta - \theta_0)^3).
\]</span></p>
<p>For optimization, we often use:</p>
<ol style="list-style-type: decimal">
<li><strong>First-order approximation (Linear Approximation):</strong> <span class="math display">\[
   f(\theta) \approx f(\theta_0) + f&#39;(\theta_0)(\theta - \theta_0).
   \]</span></li>
<li><strong>Second-order approximation (Quadratic Approximation):</strong> <span class="math display">\[
f(\theta) \approx f(\theta_0) + f&#39;(\theta_0)(\theta - \theta_0) + \frac{1}{2} f&#39;&#39;(\theta_0)(\theta - \theta_0)^2.
\]</span></li>
</ol>
<p>For <strong>gradient-based optimization</strong>, we use the <strong>Newton-Raphson update</strong>:</p>
<p><span class="math display">\[
\theta^{(k+1)} = \theta^{(k)} - [H_f(\theta^{(k)})]^{-1} \nabla f(\theta^{(k)}),
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\nabla f(\theta)\)</span> is the <strong>gradient</strong> (first derivative),</p></li>
<li><p><span class="math inline">\(H_f(\theta)\)</span> is the <strong>Hessian matrix</strong> (second derivative).</p></li>
</ul>
<hr />
<p>For nonlinear regression, we approximate the <strong>Sum of Squared Errors (SSE)</strong>:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p><strong>1. First-Order Approximation (Gradient Descent)</strong></p>
<p>The <strong>gradient</strong> of SSE w.r.t. parameters <span class="math inline">\(\theta\)</span> is:</p>
<p><span class="math display">\[
\nabla SSE(\theta) = -2 \sum_{i=1}^{n} (y_i - f(x_i; \theta)) \nabla f(x_i; \theta).
\]</span></p>
<p>Using <strong>first-order Taylor approximation</strong>, we update parameters via <strong>gradient descent</strong>:</p>
<p><span class="math display">\[
\theta^{(k+1)} = \theta^{(k)} - \alpha \nabla SSE(\theta^{(k)}),
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the <strong>learning rate</strong>.</p>
<p><strong>2. Second-Order Approximation (Newton’s Method)</strong></p>
<p>The <strong>Hessian matrix</strong> of SSE is:</p>
<p><span class="math display">\[
H_{SSE}(\theta) = 2 \sum_{i=1}^{n} \nabla f(x_i; \theta) \nabla f(x_i; \theta)^T - 2 \sum_{i=1}^{n} (y_i - f(x_i; \theta)) H_f(x_i; \theta).
\]</span></p>
<p>The <strong>Newton-Raphson update</strong> becomes:</p>
<p><span class="math display">\[
\theta^{(k+1)} = \theta^{(k)} - H_{SSE}(\theta)^{-1} \nabla SSE(\theta).
\]</span></p>
<hr />
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="non-linear-least-squares-estimation.html#cb219-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb219-2"><a href="non-linear-least-squares-estimation.html#cb219-2" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb219-3"><a href="non-linear-least-squares-estimation.html#cb219-3" tabindex="-1"></a></span>
<span id="cb219-4"><a href="non-linear-least-squares-estimation.html#cb219-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb219-5"><a href="non-linear-least-squares-estimation.html#cb219-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb219-6"><a href="non-linear-least-squares-estimation.html#cb219-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(x) <span class="sc">|</span></span>
<span id="cb219-7"><a href="non-linear-least-squares-estimation.html#cb219-7" tabindex="-1"></a>                      x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb219-8"><a href="non-linear-least-squares-estimation.html#cb219-8" tabindex="-1"></a>}</span>
<span id="cb219-9"><a href="non-linear-least-squares-estimation.html#cb219-9" tabindex="-1"></a></span>
<span id="cb219-10"><a href="non-linear-least-squares-estimation.html#cb219-10" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb219-11"><a href="non-linear-least-squares-estimation.html#cb219-11" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb219-12"><a href="non-linear-least-squares-estimation.html#cb219-12" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb219-13"><a href="non-linear-least-squares-estimation.html#cb219-13" tabindex="-1"></a>}</span>
<span id="cb219-14"><a href="non-linear-least-squares-estimation.html#cb219-14" tabindex="-1"></a></span>
<span id="cb219-15"><a href="non-linear-least-squares-estimation.html#cb219-15" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb219-16"><a href="non-linear-least-squares-estimation.html#cb219-16" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb219-17"><a href="non-linear-least-squares-estimation.html#cb219-17" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb219-18"><a href="non-linear-least-squares-estimation.html#cb219-18" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))  <span class="co"># Avoid NA errors</span></span>
<span id="cb219-19"><a href="non-linear-least-squares-estimation.html#cb219-19" tabindex="-1"></a>}</span>
<span id="cb219-20"><a href="non-linear-least-squares-estimation.html#cb219-20" tabindex="-1"></a></span>
<span id="cb219-21"><a href="non-linear-least-squares-estimation.html#cb219-21" tabindex="-1"></a><span class="co"># First-Order Approximation: Gradient Descent Optimization</span></span>
<span id="cb219-22"><a href="non-linear-least-squares-estimation.html#cb219-22" tabindex="-1"></a>gradient_descent <span class="ot">&lt;-</span></span>
<span id="cb219-23"><a href="non-linear-least-squares-estimation.html#cb219-23" tabindex="-1"></a>    <span class="cf">function</span>(x,</span>
<span id="cb219-24"><a href="non-linear-least-squares-estimation.html#cb219-24" tabindex="-1"></a>             y,</span>
<span id="cb219-25"><a href="non-linear-least-squares-estimation.html#cb219-25" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.005</span>,</span>
<span id="cb219-26"><a href="non-linear-least-squares-estimation.html#cb219-26" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb219-27"><a href="non-linear-least-squares-estimation.html#cb219-27" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">5000</span>) {</span>
<span id="cb219-28"><a href="non-linear-least-squares-estimation.html#cb219-28" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Initial guess</span></span>
<span id="cb219-29"><a href="non-linear-least-squares-estimation.html#cb219-29" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb219-30"><a href="non-linear-least-squares-estimation.html#cb219-30" tabindex="-1"></a>            grad_sse <span class="ot">&lt;-</span></span>
<span id="cb219-31"><a href="non-linear-least-squares-estimation.html#cb219-31" tabindex="-1"></a>                <span class="fu">grad</span>(<span class="cf">function</span>(t)</span>
<span id="cb219-32"><a href="non-linear-least-squares-estimation.html#cb219-32" tabindex="-1"></a>                    <span class="fu">sse</span>(t, x, y), theta)  <span class="co"># Compute gradient</span></span>
<span id="cb219-33"><a href="non-linear-least-squares-estimation.html#cb219-33" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span></span>
<span id="cb219-34"><a href="non-linear-least-squares-estimation.html#cb219-34" tabindex="-1"></a>                theta <span class="sc">-</span> alpha <span class="sc">*</span> grad_sse  <span class="co"># Update parameters</span></span>
<span id="cb219-35"><a href="non-linear-least-squares-estimation.html#cb219-35" tabindex="-1"></a>            </span>
<span id="cb219-36"><a href="non-linear-least-squares-estimation.html#cb219-36" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb219-37"><a href="non-linear-least-squares-estimation.html#cb219-37" tabindex="-1"></a>                <span class="cf">break</span>  <span class="co"># Check convergence</span></span>
<span id="cb219-38"><a href="non-linear-least-squares-estimation.html#cb219-38" tabindex="-1"></a>            theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb219-39"><a href="non-linear-least-squares-estimation.html#cb219-39" tabindex="-1"></a>        }</span>
<span id="cb219-40"><a href="non-linear-least-squares-estimation.html#cb219-40" tabindex="-1"></a>        <span class="fu">return</span>(theta)</span>
<span id="cb219-41"><a href="non-linear-least-squares-estimation.html#cb219-41" tabindex="-1"></a>    }</span>
<span id="cb219-42"><a href="non-linear-least-squares-estimation.html#cb219-42" tabindex="-1"></a></span>
<span id="cb219-43"><a href="non-linear-least-squares-estimation.html#cb219-43" tabindex="-1"></a><span class="co"># Second-Order Approximation: Newton&#39;s Method with Regularization</span></span>
<span id="cb219-44"><a href="non-linear-least-squares-estimation.html#cb219-44" tabindex="-1"></a>newton_method <span class="ot">&lt;-</span></span>
<span id="cb219-45"><a href="non-linear-least-squares-estimation.html#cb219-45" tabindex="-1"></a>    <span class="cf">function</span>(x,</span>
<span id="cb219-46"><a href="non-linear-least-squares-estimation.html#cb219-46" tabindex="-1"></a>             y,</span>
<span id="cb219-47"><a href="non-linear-least-squares-estimation.html#cb219-47" tabindex="-1"></a>             <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb219-48"><a href="non-linear-least-squares-estimation.html#cb219-48" tabindex="-1"></a>             <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb219-49"><a href="non-linear-least-squares-estimation.html#cb219-49" tabindex="-1"></a>             <span class="at">lambda =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb219-50"><a href="non-linear-least-squares-estimation.html#cb219-50" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Initial guess</span></span>
<span id="cb219-51"><a href="non-linear-least-squares-estimation.html#cb219-51" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb219-52"><a href="non-linear-least-squares-estimation.html#cb219-52" tabindex="-1"></a>            grad_sse <span class="ot">&lt;-</span></span>
<span id="cb219-53"><a href="non-linear-least-squares-estimation.html#cb219-53" tabindex="-1"></a>                <span class="fu">grad</span>(<span class="cf">function</span>(t)</span>
<span id="cb219-54"><a href="non-linear-least-squares-estimation.html#cb219-54" tabindex="-1"></a>                    <span class="fu">sse</span>(t, x, y), theta)  <span class="co"># Compute gradient</span></span>
<span id="cb219-55"><a href="non-linear-least-squares-estimation.html#cb219-55" tabindex="-1"></a>            hessian_sse <span class="ot">&lt;-</span></span>
<span id="cb219-56"><a href="non-linear-least-squares-estimation.html#cb219-56" tabindex="-1"></a>                <span class="fu">hessian</span>(<span class="cf">function</span>(t)</span>
<span id="cb219-57"><a href="non-linear-least-squares-estimation.html#cb219-57" tabindex="-1"></a>                    <span class="fu">sse</span>(t, x, y), theta)  <span class="co"># Compute Hessian</span></span>
<span id="cb219-58"><a href="non-linear-least-squares-estimation.html#cb219-58" tabindex="-1"></a>            </span>
<span id="cb219-59"><a href="non-linear-least-squares-estimation.html#cb219-59" tabindex="-1"></a>            <span class="co"># Regularize Hessian to avoid singularity</span></span>
<span id="cb219-60"><a href="non-linear-least-squares-estimation.html#cb219-60" tabindex="-1"></a>            hessian_reg <span class="ot">&lt;-</span></span>
<span id="cb219-61"><a href="non-linear-least-squares-estimation.html#cb219-61" tabindex="-1"></a>                hessian_sse <span class="sc">+</span> lambda <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">length</span>(theta))</span>
<span id="cb219-62"><a href="non-linear-least-squares-estimation.html#cb219-62" tabindex="-1"></a>            </span>
<span id="cb219-63"><a href="non-linear-least-squares-estimation.html#cb219-63" tabindex="-1"></a>            <span class="co"># Ensure Hessian is invertible</span></span>
<span id="cb219-64"><a href="non-linear-least-squares-estimation.html#cb219-64" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">is.na</span>(<span class="fu">det</span>(hessian_reg)) <span class="sc">||</span></span>
<span id="cb219-65"><a href="non-linear-least-squares-estimation.html#cb219-65" tabindex="-1"></a>                <span class="fu">det</span>(hessian_reg) <span class="sc">&lt;</span> <span class="fl">1e-10</span>) {</span>
<span id="cb219-66"><a href="non-linear-least-squares-estimation.html#cb219-66" tabindex="-1"></a>                <span class="fu">message</span>(<span class="st">&quot;Singular Hessian found; increasing regularization.&quot;</span>)</span>
<span id="cb219-67"><a href="non-linear-least-squares-estimation.html#cb219-67" tabindex="-1"></a>                lambda <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="dv">10</span>  <span class="co"># Increase regularization</span></span>
<span id="cb219-68"><a href="non-linear-least-squares-estimation.html#cb219-68" tabindex="-1"></a>                <span class="cf">next</span></span>
<span id="cb219-69"><a href="non-linear-least-squares-estimation.html#cb219-69" tabindex="-1"></a>            }</span>
<span id="cb219-70"><a href="non-linear-least-squares-estimation.html#cb219-70" tabindex="-1"></a>            </span>
<span id="cb219-71"><a href="non-linear-least-squares-estimation.html#cb219-71" tabindex="-1"></a>            <span class="co"># Newton update</span></span>
<span id="cb219-72"><a href="non-linear-least-squares-estimation.html#cb219-72" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> <span class="fu">solve</span>(hessian_reg) <span class="sc">%*%</span> grad_sse</span>
<span id="cb219-73"><a href="non-linear-least-squares-estimation.html#cb219-73" tabindex="-1"></a>            </span>
<span id="cb219-74"><a href="non-linear-least-squares-estimation.html#cb219-74" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb219-75"><a href="non-linear-least-squares-estimation.html#cb219-75" tabindex="-1"></a>                <span class="cf">break</span>  <span class="co"># Check convergence</span></span>
<span id="cb219-76"><a href="non-linear-least-squares-estimation.html#cb219-76" tabindex="-1"></a>            theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb219-77"><a href="non-linear-least-squares-estimation.html#cb219-77" tabindex="-1"></a>        }</span>
<span id="cb219-78"><a href="non-linear-least-squares-estimation.html#cb219-78" tabindex="-1"></a>        <span class="fu">return</span>(theta)</span>
<span id="cb219-79"><a href="non-linear-least-squares-estimation.html#cb219-79" tabindex="-1"></a>    }</span>
<span id="cb219-80"><a href="non-linear-least-squares-estimation.html#cb219-80" tabindex="-1"></a></span>
<span id="cb219-81"><a href="non-linear-least-squares-estimation.html#cb219-81" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb219-82"><a href="non-linear-least-squares-estimation.html#cb219-82" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb219-83"><a href="non-linear-least-squares-estimation.html#cb219-83" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb219-84"><a href="non-linear-least-squares-estimation.html#cb219-84" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb219-85"><a href="non-linear-least-squares-estimation.html#cb219-85" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb219-86"><a href="non-linear-least-squares-estimation.html#cb219-86" tabindex="-1"></a></span>
<span id="cb219-87"><a href="non-linear-least-squares-estimation.html#cb219-87" tabindex="-1"></a><span class="co"># Run Gradient Descent</span></span>
<span id="cb219-88"><a href="non-linear-least-squares-estimation.html#cb219-88" tabindex="-1"></a>estimated_theta_gd <span class="ot">&lt;-</span> <span class="fu">gradient_descent</span>(x, y)</span>
<span id="cb219-89"><a href="non-linear-least-squares-estimation.html#cb219-89" tabindex="-1"></a></span>
<span id="cb219-90"><a href="non-linear-least-squares-estimation.html#cb219-90" tabindex="-1"></a><span class="co"># Run Newton&#39;s Method with Regularization</span></span>
<span id="cb219-91"><a href="non-linear-least-squares-estimation.html#cb219-91" tabindex="-1"></a>estimated_theta_newton <span class="ot">&lt;-</span> <span class="fu">newton_method</span>(x, y)</span>
<span id="cb219-92"><a href="non-linear-least-squares-estimation.html#cb219-92" tabindex="-1"></a></span>
<span id="cb219-93"><a href="non-linear-least-squares-estimation.html#cb219-93" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb219-94"><a href="non-linear-least-squares-estimation.html#cb219-94" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Gradient Descent:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb219-95"><a href="non-linear-least-squares-estimation.html#cb219-95" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Gradient Descent:</span></span>
<span id="cb219-96"><a href="non-linear-least-squares-estimation.html#cb219-96" tabindex="-1"></a><span class="fu">print</span>(estimated_theta_gd)</span>
<span id="cb219-97"><a href="non-linear-least-squares-estimation.html#cb219-97" tabindex="-1"></a><span class="co">#&gt; [1] 4.06876224 1.42766371 0.01128539</span></span>
<span id="cb219-98"><a href="non-linear-least-squares-estimation.html#cb219-98" tabindex="-1"></a></span>
<span id="cb219-99"><a href="non-linear-least-squares-estimation.html#cb219-99" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Newton&#39;s Method:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb219-100"><a href="non-linear-least-squares-estimation.html#cb219-100" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Newton&#39;s Method:</span></span>
<span id="cb219-101"><a href="non-linear-least-squares-estimation.html#cb219-101" tabindex="-1"></a><span class="fu">print</span>(estimated_theta_newton)</span>
<span id="cb219-102"><a href="non-linear-least-squares-estimation.html#cb219-102" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb219-103"><a href="non-linear-least-squares-estimation.html#cb219-103" tabindex="-1"></a><span class="co">#&gt; [1,] 4.06876368</span></span>
<span id="cb219-104"><a href="non-linear-least-squares-estimation.html#cb219-104" tabindex="-1"></a><span class="co">#&gt; [2,] 1.42766047</span></span>
<span id="cb219-105"><a href="non-linear-least-squares-estimation.html#cb219-105" tabindex="-1"></a><span class="co">#&gt; [3,] 0.01128636</span></span>
<span id="cb219-106"><a href="non-linear-least-squares-estimation.html#cb219-106" tabindex="-1"></a></span>
<span id="cb219-107"><a href="non-linear-least-squares-estimation.html#cb219-107" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb219-108"><a href="non-linear-least-squares-estimation.html#cb219-108" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb219-109"><a href="non-linear-least-squares-estimation.html#cb219-109" tabindex="-1"></a>    x,</span>
<span id="cb219-110"><a href="non-linear-least-squares-estimation.html#cb219-110" tabindex="-1"></a>    y,</span>
<span id="cb219-111"><a href="non-linear-least-squares-estimation.html#cb219-111" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Taylor Series Approximation: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb219-112"><a href="non-linear-least-squares-estimation.html#cb219-112" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb219-113"><a href="non-linear-least-squares-estimation.html#cb219-113" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb219-114"><a href="non-linear-least-squares-estimation.html#cb219-114" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb219-115"><a href="non-linear-least-squares-estimation.html#cb219-115" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb219-116"><a href="non-linear-least-squares-estimation.html#cb219-116" tabindex="-1"></a>)</span>
<span id="cb219-117"><a href="non-linear-least-squares-estimation.html#cb219-117" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb219-118"><a href="non-linear-least-squares-estimation.html#cb219-118" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta_gd, x),</span>
<span id="cb219-119"><a href="non-linear-least-squares-estimation.html#cb219-119" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb219-120"><a href="non-linear-least-squares-estimation.html#cb219-120" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb219-121"><a href="non-linear-least-squares-estimation.html#cb219-121" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb219-122"><a href="non-linear-least-squares-estimation.html#cb219-122" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb219-123"><a href="non-linear-least-squares-estimation.html#cb219-123" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb219-124"><a href="non-linear-least-squares-estimation.html#cb219-124" tabindex="-1"></a>    <span class="at">lty =</span> <span class="dv">2</span>  <span class="co"># Dashed line to differentiate Gradient Descent</span></span>
<span id="cb219-125"><a href="non-linear-least-squares-estimation.html#cb219-125" tabindex="-1"></a>)</span>
<span id="cb219-126"><a href="non-linear-least-squares-estimation.html#cb219-126" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb219-127"><a href="non-linear-least-squares-estimation.html#cb219-127" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta_newton, x),</span>
<span id="cb219-128"><a href="non-linear-least-squares-estimation.html#cb219-128" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb219-129"><a href="non-linear-least-squares-estimation.html#cb219-129" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb219-130"><a href="non-linear-least-squares-estimation.html#cb219-130" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb219-131"><a href="non-linear-least-squares-estimation.html#cb219-131" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb219-132"><a href="non-linear-least-squares-estimation.html#cb219-132" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb219-133"><a href="non-linear-least-squares-estimation.html#cb219-133" tabindex="-1"></a>)</span>
<span id="cb219-134"><a href="non-linear-least-squares-estimation.html#cb219-134" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb219-135"><a href="non-linear-least-squares-estimation.html#cb219-135" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb219-136"><a href="non-linear-least-squares-estimation.html#cb219-136" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Gradient Descent&quot;</span>, <span class="st">&quot;Newton&#39;s Method (Regularized)&quot;</span>),</span>
<span id="cb219-137"><a href="non-linear-least-squares-estimation.html#cb219-137" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb219-138"><a href="non-linear-least-squares-estimation.html#cb219-138" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb219-139"><a href="non-linear-least-squares-estimation.html#cb219-139" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb219-140"><a href="non-linear-least-squares-estimation.html#cb219-140" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="log-linearization-nonlinear-optimization" class="section level4 hasAnchor" number="6.2.4.2">
<h4><span class="header-section-number">6.2.4.2</span> Log-Linearization<a href="non-linear-least-squares-estimation.html#log-linearization-nonlinear-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Log-Linearization is a mathematical technique used to transform nonlinear models into linear models by taking the logarithm of both sides. This transformation simplifies parameter estimation and enables the use of linear regression techniques on originally nonlinear functions.</p>
<p>Log-linearization is particularly useful when:</p>
<ul>
<li><p>The model exhibits exponential, power-law, or logistic growth behavior.</p></li>
<li><p>Linear regression methods are preferred over nonlinear optimization.</p></li>
<li><p>A linearized version provides better interpretability and computational efficiency.</p></li>
</ul>
<hr />
<p>A <strong>nonlinear model</strong> can often be expressed in the form:</p>
<p><span class="math display">\[
y = f(x; \theta).
\]</span></p>
<p>Applying a <strong>log transformation</strong>, we obtain:</p>
<p><span class="math display">\[
\log y = g(x; \theta),
\]</span></p>
<p>where <span class="math inline">\(g(x; \theta)\)</span> is now <strong>linear in parameters</strong>. We then estimate <span class="math inline">\(\theta\)</span> using <a href="ordinary-least-squares.html#ordinary-least-squares">Ordinary Least Squares</a>.</p>
<p><strong>Example 1: Exponential Model</strong></p>
<p>Consider an <strong>exponential growth model</strong>:</p>
<p><span class="math display">\[
y = A e^{Bx}.
\]</span></p>
<p>Taking the natural logarithm:</p>
<p><span class="math display">\[
\log y = \log A + Bx.
\]</span></p>
<p>This is now <strong>linear in</strong> <span class="math inline">\(\log y\)</span>, allowing estimation via <strong>linear regression</strong>.</p>
<p><strong>Example 2: Power Law Model</strong></p>
<p>For a <strong>power law function</strong>:</p>
<p><span class="math display">\[
y = A x^B.
\]</span></p>
<p>Taking logs:</p>
<p><span class="math display">\[
\log y = \log A + B \log x.
\]</span></p>
<p>Again, this is <strong>linearized</strong>, making it solvable via <strong>OLS regression</strong>.</p>
<hr />
<p><strong>Log-Linearization Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Apply the logarithm transformation to the dependent variable.</li>
<li>Transform the equation into a linear form.</li>
<li>Use linear regression (OLS) to estimate parameters.</li>
<li>Convert parameters back to original scale if necessary.</li>
</ol>
<hr />
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="non-linear-least-squares-estimation.html#cb220-1" tabindex="-1"></a><span class="co"># Load required library</span></span>
<span id="cb220-2"><a href="non-linear-least-squares-estimation.html#cb220-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb220-3"><a href="non-linear-least-squares-estimation.html#cb220-3" tabindex="-1"></a></span>
<span id="cb220-4"><a href="non-linear-least-squares-estimation.html#cb220-4" tabindex="-1"></a><span class="co"># Generate synthetic data for an exponential model</span></span>
<span id="cb220-5"><a href="non-linear-least-squares-estimation.html#cb220-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb220-6"><a href="non-linear-least-squares-estimation.html#cb220-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb220-7"><a href="non-linear-least-squares-estimation.html#cb220-7" tabindex="-1"></a>true_A <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb220-8"><a href="non-linear-least-squares-estimation.html#cb220-8" tabindex="-1"></a>true_B <span class="ot">&lt;-</span> <span class="fl">0.3</span></span>
<span id="cb220-9"><a href="non-linear-least-squares-estimation.html#cb220-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> true_A <span class="sc">*</span> <span class="fu">exp</span>(true_B <span class="sc">*</span> x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb220-10"><a href="non-linear-least-squares-estimation.html#cb220-10" tabindex="-1"></a></span>
<span id="cb220-11"><a href="non-linear-least-squares-estimation.html#cb220-11" tabindex="-1"></a><span class="co"># Apply logarithmic transformation</span></span>
<span id="cb220-12"><a href="non-linear-least-squares-estimation.html#cb220-12" tabindex="-1"></a>log_y <span class="ot">&lt;-</span> <span class="fu">log</span>(y)</span>
<span id="cb220-13"><a href="non-linear-least-squares-estimation.html#cb220-13" tabindex="-1"></a></span>
<span id="cb220-14"><a href="non-linear-least-squares-estimation.html#cb220-14" tabindex="-1"></a><span class="co"># Fit linear regression model</span></span>
<span id="cb220-15"><a href="non-linear-least-squares-estimation.html#cb220-15" tabindex="-1"></a>log_linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_y <span class="sc">~</span> x)</span>
<span id="cb220-16"><a href="non-linear-least-squares-estimation.html#cb220-16" tabindex="-1"></a></span>
<span id="cb220-17"><a href="non-linear-least-squares-estimation.html#cb220-17" tabindex="-1"></a><span class="co"># Extract estimated parameters</span></span>
<span id="cb220-18"><a href="non-linear-least-squares-estimation.html#cb220-18" tabindex="-1"></a>estimated_B <span class="ot">&lt;-</span> <span class="fu">coef</span>(log_linear_model)[<span class="dv">2</span>]  <span class="co"># Slope in log-space</span></span>
<span id="cb220-19"><a href="non-linear-least-squares-estimation.html#cb220-19" tabindex="-1"></a>estimated_A <span class="ot">&lt;-</span></span>
<span id="cb220-20"><a href="non-linear-least-squares-estimation.html#cb220-20" tabindex="-1"></a>    <span class="fu">exp</span>(<span class="fu">coef</span>(log_linear_model)[<span class="dv">1</span>])  <span class="co"># Intercept (back-transformed)</span></span>
<span id="cb220-21"><a href="non-linear-least-squares-estimation.html#cb220-21" tabindex="-1"></a></span>
<span id="cb220-22"><a href="non-linear-least-squares-estimation.html#cb220-22" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb220-23"><a href="non-linear-least-squares-estimation.html#cb220-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B) using Log-Linearization:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb220-24"><a href="non-linear-least-squares-estimation.html#cb220-24" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B) using Log-Linearization:</span></span>
<span id="cb220-25"><a href="non-linear-least-squares-estimation.html#cb220-25" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(estimated_A, estimated_B))</span>
<span id="cb220-26"><a href="non-linear-least-squares-estimation.html#cb220-26" tabindex="-1"></a><span class="co">#&gt; (Intercept)           x </span></span>
<span id="cb220-27"><a href="non-linear-least-squares-estimation.html#cb220-27" tabindex="-1"></a><span class="co">#&gt;   2.0012577   0.3001223</span></span>
<span id="cb220-28"><a href="non-linear-least-squares-estimation.html#cb220-28" tabindex="-1"></a></span>
<span id="cb220-29"><a href="non-linear-least-squares-estimation.html#cb220-29" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb220-30"><a href="non-linear-least-squares-estimation.html#cb220-30" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb220-31"><a href="non-linear-least-squares-estimation.html#cb220-31" tabindex="-1"></a>    x,</span>
<span id="cb220-32"><a href="non-linear-least-squares-estimation.html#cb220-32" tabindex="-1"></a>    y,</span>
<span id="cb220-33"><a href="non-linear-least-squares-estimation.html#cb220-33" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Log-Linearization: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb220-34"><a href="non-linear-least-squares-estimation.html#cb220-34" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb220-35"><a href="non-linear-least-squares-estimation.html#cb220-35" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb220-36"><a href="non-linear-least-squares-estimation.html#cb220-36" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb220-37"><a href="non-linear-least-squares-estimation.html#cb220-37" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb220-38"><a href="non-linear-least-squares-estimation.html#cb220-38" tabindex="-1"></a>)</span>
<span id="cb220-39"><a href="non-linear-least-squares-estimation.html#cb220-39" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb220-40"><a href="non-linear-least-squares-estimation.html#cb220-40" tabindex="-1"></a>    estimated_A <span class="sc">*</span> <span class="fu">exp</span>(estimated_B <span class="sc">*</span> x),</span>
<span id="cb220-41"><a href="non-linear-least-squares-estimation.html#cb220-41" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb220-42"><a href="non-linear-least-squares-estimation.html#cb220-42" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb220-43"><a href="non-linear-least-squares-estimation.html#cb220-43" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb220-44"><a href="non-linear-least-squares-estimation.html#cb220-44" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb220-45"><a href="non-linear-least-squares-estimation.html#cb220-45" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb220-46"><a href="non-linear-least-squares-estimation.html#cb220-46" tabindex="-1"></a>)</span>
<span id="cb220-47"><a href="non-linear-least-squares-estimation.html#cb220-47" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb220-48"><a href="non-linear-least-squares-estimation.html#cb220-48" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb220-49"><a href="non-linear-least-squares-estimation.html#cb220-49" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Log-Linear Model&quot;</span>),</span>
<span id="cb220-50"><a href="non-linear-least-squares-estimation.html#cb220-50" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb220-51"><a href="non-linear-least-squares-estimation.html#cb220-51" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb220-52"><a href="non-linear-least-squares-estimation.html#cb220-52" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb220-53"><a href="non-linear-least-squares-estimation.html#cb220-53" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-22-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="hybrid-nonlinear-regression-optimization" class="section level3 hasAnchor" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Hybrid<a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="adaptive-levenberg-marquardt" class="section level4 hasAnchor" number="6.2.5.1">
<h4><span class="header-section-number">6.2.5.1</span> Adaptive Levenberg-Marquardt<a href="non-linear-least-squares-estimation.html#adaptive-levenberg-marquardt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>Levenberg-Marquardt Algorithm (LMA)</strong> is a powerful <strong>nonlinear least squares optimization method</strong> that adaptively combines:</p>
<ul>
<li><p><a href="non-linear-least-squares-estimation.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> for fast convergence near the solution.</p></li>
<li><p><a href="non-linear-least-squares-estimation.html#steepest-descent">Steepest Descent (Gradient Descent)</a> for stability when far from the solution.</p></li>
</ul>
<p>The Adaptive Levenberg-Marquardt Algorithm further adjusts the damping parameter <span class="math inline">\(\tau\)</span> dynamically, making it more efficient in practice.</p>
<hr />
<p>Given an objective function <strong>Sum of Squared Errors (SSE)</strong>:</p>
<p><span class="math display">\[
SSE(\theta) = \sum_{i=1}^{n} (y_i - f(x_i; \theta))^2.
\]</span></p>
<p>The <strong>update rule for LMA</strong> is:</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j [\mathbf{F}(\hat{\theta}^{(j)})&#39; \mathbf{F}(\hat{\theta}^{(j)}) + \tau \mathbf{I}_{p \times p}]\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\tau\)</span> is the <strong>adaptive damping parameter</strong>.</p></li>
<li><p><span class="math inline">\(\mathbf{I}_{p \times p}\)</span> is the <strong>identity matrix</strong>.</p></li>
<li><p><span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span> is the <strong>Jacobian matrix</strong> of partial derivatives.</p></li>
<li><p><span class="math inline">\(\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is the <strong>gradient vector</strong>.</p></li>
<li><p><span class="math inline">\(\alpha_j\)</span> is the <strong>learning rate</strong>.</p></li>
</ul>
<p>The key <strong>adaptation rule for</strong> <span class="math inline">\(\tau\)</span>:</p>
<ul>
<li><p><strong>If the new step decreases SSE</strong>, <strong>reduce</strong> <span class="math inline">\(\tau\)</span>: <span class="math display">\[
  \tau \gets \tau / 10.
  \]</span></p></li>
<li><p><strong>Otherwise, increase</strong> <span class="math inline">\(\tau\)</span> to ensure stability: <span class="math display">\[
  \tau \gets 10\tau.
  \]</span></p></li>
</ul>
<p>This adjustment <strong>ensures a balance between stability and efficiency</strong>.</p>
<hr />
<p><strong>Adaptive Levenberg-Marquardt Algorithm</strong></p>
<ol style="list-style-type: decimal">
<li>Initialize parameters <span class="math inline">\(\theta_0\)</span>, damping factor <span class="math inline">\(\tau\)</span>.</li>
<li>Compute Jacobian <span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span>.</li>
<li>Compute step direction using modified Gauss-Newton update.</li>
<li>Adjust <span class="math inline">\(\tau\)</span> dynamically:
<ul>
<li>Decrease <span class="math inline">\(\tau\)</span> if SSE improves.</li>
<li>Increase <span class="math inline">\(\tau\)</span> if SSE worsens.</li>
</ul></li>
<li>Repeat until convergence.</li>
</ol>
<hr />
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="non-linear-least-squares-estimation.html#cb221-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb221-2"><a href="non-linear-least-squares-estimation.html#cb221-2" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb221-3"><a href="non-linear-least-squares-estimation.html#cb221-3" tabindex="-1"></a></span>
<span id="cb221-4"><a href="non-linear-least-squares-estimation.html#cb221-4" tabindex="-1"></a><span class="co"># Define a numerically stable logistic function</span></span>
<span id="cb221-5"><a href="non-linear-least-squares-estimation.html#cb221-5" tabindex="-1"></a>safe_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb221-6"><a href="non-linear-least-squares-estimation.html#cb221-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="cn">Inf</span>, <span class="fu">exp</span>(<span class="fu">pmin</span>(x, <span class="dv">700</span>))))  <span class="co"># Prevent overflow</span></span>
<span id="cb221-7"><a href="non-linear-least-squares-estimation.html#cb221-7" tabindex="-1"></a>}</span>
<span id="cb221-8"><a href="non-linear-least-squares-estimation.html#cb221-8" tabindex="-1"></a></span>
<span id="cb221-9"><a href="non-linear-least-squares-estimation.html#cb221-9" tabindex="-1"></a><span class="co"># Define the logistic growth model</span></span>
<span id="cb221-10"><a href="non-linear-least-squares-estimation.html#cb221-10" tabindex="-1"></a>nonlinear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb221-11"><a href="non-linear-least-squares-estimation.html#cb221-11" tabindex="-1"></a>    <span class="fu">return</span>(theta[<span class="dv">1</span>] <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">safe_exp</span>(<span class="sc">-</span>theta[<span class="dv">2</span>] <span class="sc">*</span> (x <span class="sc">-</span> theta[<span class="dv">3</span>]))))</span>
<span id="cb221-12"><a href="non-linear-least-squares-estimation.html#cb221-12" tabindex="-1"></a>}</span>
<span id="cb221-13"><a href="non-linear-least-squares-estimation.html#cb221-13" tabindex="-1"></a></span>
<span id="cb221-14"><a href="non-linear-least-squares-estimation.html#cb221-14" tabindex="-1"></a><span class="co"># Define the Sum of Squared Errors (SSE) function</span></span>
<span id="cb221-15"><a href="non-linear-least-squares-estimation.html#cb221-15" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x, y) {</span>
<span id="cb221-16"><a href="non-linear-least-squares-estimation.html#cb221-16" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb221-17"><a href="non-linear-least-squares-estimation.html#cb221-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>((y <span class="sc">-</span> predictions) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb221-18"><a href="non-linear-least-squares-estimation.html#cb221-18" tabindex="-1"></a>}</span>
<span id="cb221-19"><a href="non-linear-least-squares-estimation.html#cb221-19" tabindex="-1"></a></span>
<span id="cb221-20"><a href="non-linear-least-squares-estimation.html#cb221-20" tabindex="-1"></a><span class="co"># Adaptive Levenberg-Marquardt Optimization</span></span>
<span id="cb221-21"><a href="non-linear-least-squares-estimation.html#cb221-21" tabindex="-1"></a>adaptive_lm_optimization <span class="ot">&lt;-</span></span>
<span id="cb221-22"><a href="non-linear-least-squares-estimation.html#cb221-22" tabindex="-1"></a>    <span class="cf">function</span>(x, y, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb221-23"><a href="non-linear-least-squares-estimation.html#cb221-23" tabindex="-1"></a>        theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)  <span class="co"># Initial parameter guess</span></span>
<span id="cb221-24"><a href="non-linear-least-squares-estimation.html#cb221-24" tabindex="-1"></a>        tau <span class="ot">&lt;-</span> <span class="fl">1e-3</span>  <span class="co"># Initial damping parameter</span></span>
<span id="cb221-25"><a href="non-linear-least-squares-estimation.html#cb221-25" tabindex="-1"></a>        alpha <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Step size scaling</span></span>
<span id="cb221-26"><a href="non-linear-least-squares-estimation.html#cb221-26" tabindex="-1"></a>        iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb221-27"><a href="non-linear-least-squares-estimation.html#cb221-27" tabindex="-1"></a>        </span>
<span id="cb221-28"><a href="non-linear-least-squares-estimation.html#cb221-28" tabindex="-1"></a>        <span class="cf">while</span> (iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb221-29"><a href="non-linear-least-squares-estimation.html#cb221-29" tabindex="-1"></a>            iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb221-30"><a href="non-linear-least-squares-estimation.html#cb221-30" tabindex="-1"></a>            </span>
<span id="cb221-31"><a href="non-linear-least-squares-estimation.html#cb221-31" tabindex="-1"></a>            <span class="co"># Compute Jacobian numerically</span></span>
<span id="cb221-32"><a href="non-linear-least-squares-estimation.html#cb221-32" tabindex="-1"></a>            J <span class="ot">&lt;-</span> <span class="fu">jacobian</span>(<span class="cf">function</span>(t)</span>
<span id="cb221-33"><a href="non-linear-least-squares-estimation.html#cb221-33" tabindex="-1"></a>                <span class="fu">nonlinear_model</span>(t, x), theta)</span>
<span id="cb221-34"><a href="non-linear-least-squares-estimation.html#cb221-34" tabindex="-1"></a>            </span>
<span id="cb221-35"><a href="non-linear-least-squares-estimation.html#cb221-35" tabindex="-1"></a>            <span class="co"># Compute gradient of SSE</span></span>
<span id="cb221-36"><a href="non-linear-least-squares-estimation.html#cb221-36" tabindex="-1"></a>            residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">nonlinear_model</span>(theta, x)</span>
<span id="cb221-37"><a href="non-linear-least-squares-estimation.html#cb221-37" tabindex="-1"></a>            grad_sse <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> residuals</span>
<span id="cb221-38"><a href="non-linear-least-squares-estimation.html#cb221-38" tabindex="-1"></a>            </span>
<span id="cb221-39"><a href="non-linear-least-squares-estimation.html#cb221-39" tabindex="-1"></a>            <span class="co"># Compute Hessian approximation</span></span>
<span id="cb221-40"><a href="non-linear-least-squares-estimation.html#cb221-40" tabindex="-1"></a>            H <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> J <span class="sc">+</span> tau <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">length</span>(theta))</span>
<span id="cb221-41"><a href="non-linear-least-squares-estimation.html#cb221-41" tabindex="-1"></a>            </span>
<span id="cb221-42"><a href="non-linear-least-squares-estimation.html#cb221-42" tabindex="-1"></a>            <span class="co"># Compute parameter update step</span></span>
<span id="cb221-43"><a href="non-linear-least-squares-estimation.html#cb221-43" tabindex="-1"></a>            delta_theta <span class="ot">&lt;-</span> <span class="fu">solve</span>(H, grad_sse)</span>
<span id="cb221-44"><a href="non-linear-least-squares-estimation.html#cb221-44" tabindex="-1"></a>            </span>
<span id="cb221-45"><a href="non-linear-least-squares-estimation.html#cb221-45" tabindex="-1"></a>            <span class="co"># Trial step</span></span>
<span id="cb221-46"><a href="non-linear-least-squares-estimation.html#cb221-46" tabindex="-1"></a>            theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> alpha <span class="sc">*</span> delta_theta</span>
<span id="cb221-47"><a href="non-linear-least-squares-estimation.html#cb221-47" tabindex="-1"></a>            </span>
<span id="cb221-48"><a href="non-linear-least-squares-estimation.html#cb221-48" tabindex="-1"></a>            <span class="co"># Compute SSE for new parameters</span></span>
<span id="cb221-49"><a href="non-linear-least-squares-estimation.html#cb221-49" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sse</span>(theta_new, x, y) <span class="sc">&lt;</span> <span class="fu">sse</span>(theta, x, y)) {</span>
<span id="cb221-50"><a href="non-linear-least-squares-estimation.html#cb221-50" tabindex="-1"></a>                <span class="co"># Accept step, decrease tau</span></span>
<span id="cb221-51"><a href="non-linear-least-squares-estimation.html#cb221-51" tabindex="-1"></a>                theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb221-52"><a href="non-linear-least-squares-estimation.html#cb221-52" tabindex="-1"></a>                tau <span class="ot">&lt;-</span> tau <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb221-53"><a href="non-linear-least-squares-estimation.html#cb221-53" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb221-54"><a href="non-linear-least-squares-estimation.html#cb221-54" tabindex="-1"></a>                <span class="co"># Reject step, increase tau</span></span>
<span id="cb221-55"><a href="non-linear-least-squares-estimation.html#cb221-55" tabindex="-1"></a>                tau <span class="ot">&lt;-</span> tau <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb221-56"><a href="non-linear-least-squares-estimation.html#cb221-56" tabindex="-1"></a>            }</span>
<span id="cb221-57"><a href="non-linear-least-squares-estimation.html#cb221-57" tabindex="-1"></a>            </span>
<span id="cb221-58"><a href="non-linear-least-squares-estimation.html#cb221-58" tabindex="-1"></a>            <span class="co"># Check convergence</span></span>
<span id="cb221-59"><a href="non-linear-least-squares-estimation.html#cb221-59" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(delta_theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb221-60"><a href="non-linear-least-squares-estimation.html#cb221-60" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb221-61"><a href="non-linear-least-squares-estimation.html#cb221-61" tabindex="-1"></a>        }</span>
<span id="cb221-62"><a href="non-linear-least-squares-estimation.html#cb221-62" tabindex="-1"></a>        </span>
<span id="cb221-63"><a href="non-linear-least-squares-estimation.html#cb221-63" tabindex="-1"></a>        <span class="fu">return</span>(theta)</span>
<span id="cb221-64"><a href="non-linear-least-squares-estimation.html#cb221-64" tabindex="-1"></a>    }</span>
<span id="cb221-65"><a href="non-linear-least-squares-estimation.html#cb221-65" tabindex="-1"></a></span>
<span id="cb221-66"><a href="non-linear-least-squares-estimation.html#cb221-66" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb221-67"><a href="non-linear-least-squares-estimation.html#cb221-67" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb221-68"><a href="non-linear-least-squares-estimation.html#cb221-68" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb221-69"><a href="non-linear-least-squares-estimation.html#cb221-69" tabindex="-1"></a>true_theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)  <span class="co"># True parameters (A, B, C)</span></span>
<span id="cb221-70"><a href="non-linear-least-squares-estimation.html#cb221-70" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">nonlinear_model</span>(true_theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb221-71"><a href="non-linear-least-squares-estimation.html#cb221-71" tabindex="-1"></a></span>
<span id="cb221-72"><a href="non-linear-least-squares-estimation.html#cb221-72" tabindex="-1"></a><span class="co"># Run Adaptive Levenberg-Marquardt Optimization</span></span>
<span id="cb221-73"><a href="non-linear-least-squares-estimation.html#cb221-73" tabindex="-1"></a>estimated_theta <span class="ot">&lt;-</span> <span class="fu">adaptive_lm_optimization</span>(x, y)</span>
<span id="cb221-74"><a href="non-linear-least-squares-estimation.html#cb221-74" tabindex="-1"></a></span>
<span id="cb221-75"><a href="non-linear-least-squares-estimation.html#cb221-75" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb221-76"><a href="non-linear-least-squares-estimation.html#cb221-76" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated parameters (A, B, C) using Adaptive Levenberg-Marquardt:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb221-77"><a href="non-linear-least-squares-estimation.html#cb221-77" tabindex="-1"></a><span class="co">#&gt; Estimated parameters (A, B, C) using Adaptive Levenberg-Marquardt:</span></span>
<span id="cb221-78"><a href="non-linear-least-squares-estimation.html#cb221-78" tabindex="-1"></a><span class="fu">print</span>(estimated_theta)</span>
<span id="cb221-79"><a href="non-linear-least-squares-estimation.html#cb221-79" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb221-80"><a href="non-linear-least-squares-estimation.html#cb221-80" tabindex="-1"></a><span class="co">#&gt; [1,] 4.06876562</span></span>
<span id="cb221-81"><a href="non-linear-least-squares-estimation.html#cb221-81" tabindex="-1"></a><span class="co">#&gt; [2,] 1.42765612</span></span>
<span id="cb221-82"><a href="non-linear-least-squares-estimation.html#cb221-82" tabindex="-1"></a><span class="co">#&gt; [3,] 0.01128767</span></span>
<span id="cb221-83"><a href="non-linear-least-squares-estimation.html#cb221-83" tabindex="-1"></a></span>
<span id="cb221-84"><a href="non-linear-least-squares-estimation.html#cb221-84" tabindex="-1"></a><span class="co"># Plot data and fitted curve</span></span>
<span id="cb221-85"><a href="non-linear-least-squares-estimation.html#cb221-85" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb221-86"><a href="non-linear-least-squares-estimation.html#cb221-86" tabindex="-1"></a>    x,</span>
<span id="cb221-87"><a href="non-linear-least-squares-estimation.html#cb221-87" tabindex="-1"></a>    y,</span>
<span id="cb221-88"><a href="non-linear-least-squares-estimation.html#cb221-88" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Adaptive Levenberg-Marquardt: Nonlinear Regression Optimization&quot;</span>,</span>
<span id="cb221-89"><a href="non-linear-least-squares-estimation.html#cb221-89" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb221-90"><a href="non-linear-least-squares-estimation.html#cb221-90" tabindex="-1"></a>    <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb221-91"><a href="non-linear-least-squares-estimation.html#cb221-91" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb221-92"><a href="non-linear-least-squares-estimation.html#cb221-92" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb221-93"><a href="non-linear-least-squares-estimation.html#cb221-93" tabindex="-1"></a>)</span>
<span id="cb221-94"><a href="non-linear-least-squares-estimation.html#cb221-94" tabindex="-1"></a><span class="fu">curve</span>(</span>
<span id="cb221-95"><a href="non-linear-least-squares-estimation.html#cb221-95" tabindex="-1"></a>    <span class="fu">nonlinear_model</span>(estimated_theta, x),</span>
<span id="cb221-96"><a href="non-linear-least-squares-estimation.html#cb221-96" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">min</span>(x),</span>
<span id="cb221-97"><a href="non-linear-least-squares-estimation.html#cb221-97" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">max</span>(x),</span>
<span id="cb221-98"><a href="non-linear-least-squares-estimation.html#cb221-98" tabindex="-1"></a>    <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb221-99"><a href="non-linear-least-squares-estimation.html#cb221-99" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb221-100"><a href="non-linear-least-squares-estimation.html#cb221-100" tabindex="-1"></a>    <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb221-101"><a href="non-linear-least-squares-estimation.html#cb221-101" tabindex="-1"></a>)</span>
<span id="cb221-102"><a href="non-linear-least-squares-estimation.html#cb221-102" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb221-103"><a href="non-linear-least-squares-estimation.html#cb221-103" tabindex="-1"></a>    <span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb221-104"><a href="non-linear-least-squares-estimation.html#cb221-104" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Fitted Curve&quot;</span>),</span>
<span id="cb221-105"><a href="non-linear-least-squares-estimation.html#cb221-105" tabindex="-1"></a>    <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="cn">NA</span>),</span>
<span id="cb221-106"><a href="non-linear-least-squares-estimation.html#cb221-106" tabindex="-1"></a>    <span class="at">lty =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>),</span>
<span id="cb221-107"><a href="non-linear-least-squares-estimation.html#cb221-107" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb221-108"><a href="non-linear-least-squares-estimation.html#cb221-108" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-23-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="comparison-of-nonlinear-optimizers" class="section level3 hasAnchor" number="6.2.6">
<h3><span class="header-section-number">6.2.6</span> Comparison of Nonlinear Optimizers<a href="non-linear-least-squares-estimation.html#comparison-of-nonlinear-optimizers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="non-linear-least-squares-estimation.html#cb222-1" tabindex="-1"></a><span class="co"># ALL-IN-ONE R SCRIPT COMPARING MULTIPLE NONLINEAR-REGRESSION OPTIMIZERS</span></span>
<span id="cb222-2"><a href="non-linear-least-squares-estimation.html#cb222-2" tabindex="-1"></a></span>
<span id="cb222-3"><a href="non-linear-least-squares-estimation.html#cb222-3" tabindex="-1"></a><span class="fu">library</span>(minpack.lm) <span class="co"># nlsLM (Levenberg-Marquardt)</span></span>
<span id="cb222-4"><a href="non-linear-least-squares-estimation.html#cb222-4" tabindex="-1"></a><span class="fu">library</span>(dfoptim)    <span class="co"># Powell (nmk), Hooke-Jeeves</span></span>
<span id="cb222-5"><a href="non-linear-least-squares-estimation.html#cb222-5" tabindex="-1"></a><span class="fu">library</span>(nloptr)     <span class="co"># trust-region reflective</span></span>
<span id="cb222-6"><a href="non-linear-least-squares-estimation.html#cb222-6" tabindex="-1"></a><span class="fu">library</span>(GA)         <span class="co"># genetic algorithm</span></span>
<span id="cb222-7"><a href="non-linear-least-squares-estimation.html#cb222-7" tabindex="-1"></a><span class="fu">library</span>(DEoptim)    <span class="co"># differential evolution</span></span>
<span id="cb222-8"><a href="non-linear-least-squares-estimation.html#cb222-8" tabindex="-1"></a><span class="fu">library</span>(GenSA)      <span class="co"># simulated annealing</span></span>
<span id="cb222-9"><a href="non-linear-least-squares-estimation.html#cb222-9" tabindex="-1"></a><span class="fu">library</span>(pso)        <span class="co"># particle swarm</span></span>
<span id="cb222-10"><a href="non-linear-least-squares-estimation.html#cb222-10" tabindex="-1"></a><span class="fu">library</span>(MASS)       <span class="co"># for ginv fallback</span></span>
<span id="cb222-11"><a href="non-linear-least-squares-estimation.html#cb222-11" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb222-12"><a href="non-linear-least-squares-estimation.html#cb222-12" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb222-13"><a href="non-linear-least-squares-estimation.html#cb222-13" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb222-14"><a href="non-linear-least-squares-estimation.html#cb222-14" tabindex="-1"></a></span>
<span id="cb222-15"><a href="non-linear-least-squares-estimation.html#cb222-15" tabindex="-1"></a><span class="co"># -- 1) DEFINE MODELS (SIMPLE VS COMPLEX) ---</span></span>
<span id="cb222-16"><a href="non-linear-least-squares-estimation.html#cb222-16" tabindex="-1"></a></span>
<span id="cb222-17"><a href="non-linear-least-squares-estimation.html#cb222-17" tabindex="-1"></a><span class="co"># 3-parameter logistic</span></span>
<span id="cb222-18"><a href="non-linear-least-squares-estimation.html#cb222-18" tabindex="-1"></a>f_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb222-19"><a href="non-linear-least-squares-estimation.html#cb222-19" tabindex="-1"></a>  A <span class="ot">&lt;-</span> theta[<span class="dv">1</span>]</span>
<span id="cb222-20"><a href="non-linear-least-squares-estimation.html#cb222-20" tabindex="-1"></a>  B <span class="ot">&lt;-</span> theta[<span class="dv">2</span>]</span>
<span id="cb222-21"><a href="non-linear-least-squares-estimation.html#cb222-21" tabindex="-1"></a>  C <span class="ot">&lt;-</span> theta[<span class="dv">3</span>]</span>
<span id="cb222-22"><a href="non-linear-least-squares-estimation.html#cb222-22" tabindex="-1"></a>  A <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>B <span class="sc">*</span> (x <span class="sc">-</span> C)))</span>
<span id="cb222-23"><a href="non-linear-least-squares-estimation.html#cb222-23" tabindex="-1"></a>}</span>
<span id="cb222-24"><a href="non-linear-least-squares-estimation.html#cb222-24" tabindex="-1"></a>sse_logistic <span class="ot">&lt;-</span></span>
<span id="cb222-25"><a href="non-linear-least-squares-estimation.html#cb222-25" tabindex="-1"></a>  <span class="cf">function</span>(theta, x, y)</span>
<span id="cb222-26"><a href="non-linear-least-squares-estimation.html#cb222-26" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">f_logistic</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb222-27"><a href="non-linear-least-squares-estimation.html#cb222-27" tabindex="-1"></a></span>
<span id="cb222-28"><a href="non-linear-least-squares-estimation.html#cb222-28" tabindex="-1"></a><span class="co"># 4-parameter &quot;extended&quot; model</span></span>
<span id="cb222-29"><a href="non-linear-least-squares-estimation.html#cb222-29" tabindex="-1"></a>f_complex <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, x) {</span>
<span id="cb222-30"><a href="non-linear-least-squares-estimation.html#cb222-30" tabindex="-1"></a>  A <span class="ot">&lt;-</span> theta[<span class="dv">1</span>]</span>
<span id="cb222-31"><a href="non-linear-least-squares-estimation.html#cb222-31" tabindex="-1"></a>  B <span class="ot">&lt;-</span> theta[<span class="dv">2</span>]</span>
<span id="cb222-32"><a href="non-linear-least-squares-estimation.html#cb222-32" tabindex="-1"></a>  C <span class="ot">&lt;-</span> theta[<span class="dv">3</span>]</span>
<span id="cb222-33"><a href="non-linear-least-squares-estimation.html#cb222-33" tabindex="-1"></a>  D <span class="ot">&lt;-</span> theta[<span class="dv">4</span>]</span>
<span id="cb222-34"><a href="non-linear-least-squares-estimation.html#cb222-34" tabindex="-1"></a>  A <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>B <span class="sc">*</span> (x <span class="sc">-</span> C))) <span class="sc">+</span> D <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x)</span>
<span id="cb222-35"><a href="non-linear-least-squares-estimation.html#cb222-35" tabindex="-1"></a>}</span>
<span id="cb222-36"><a href="non-linear-least-squares-estimation.html#cb222-36" tabindex="-1"></a>sse_complex <span class="ot">&lt;-</span></span>
<span id="cb222-37"><a href="non-linear-least-squares-estimation.html#cb222-37" tabindex="-1"></a>  <span class="cf">function</span>(theta, x, y)</span>
<span id="cb222-38"><a href="non-linear-least-squares-estimation.html#cb222-38" tabindex="-1"></a>    <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">f_complex</span>(theta, x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb222-39"><a href="non-linear-least-squares-estimation.html#cb222-39" tabindex="-1"></a></span>
<span id="cb222-40"><a href="non-linear-least-squares-estimation.html#cb222-40" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb222-41"><a href="non-linear-least-squares-estimation.html#cb222-41" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb222-42"><a href="non-linear-least-squares-estimation.html#cb222-42" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb222-43"><a href="non-linear-least-squares-estimation.html#cb222-43" tabindex="-1"></a>x_data <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length.out =</span> n)</span>
<span id="cb222-44"><a href="non-linear-least-squares-estimation.html#cb222-44" tabindex="-1"></a><span class="co"># &quot;simple&quot; scenario</span></span>
<span id="cb222-45"><a href="non-linear-least-squares-estimation.html#cb222-45" tabindex="-1"></a>true_theta_simple <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.5</span>, <span class="dv">0</span>)</span>
<span id="cb222-46"><a href="non-linear-least-squares-estimation.html#cb222-46" tabindex="-1"></a>y_data_simple <span class="ot">&lt;-</span></span>
<span id="cb222-47"><a href="non-linear-least-squares-estimation.html#cb222-47" tabindex="-1"></a>  <span class="fu">f_logistic</span>(true_theta_simple, x_data) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb222-48"><a href="non-linear-least-squares-estimation.html#cb222-48" tabindex="-1"></a><span class="co"># &quot;complex&quot; scenario</span></span>
<span id="cb222-49"><a href="non-linear-least-squares-estimation.html#cb222-49" tabindex="-1"></a>true_theta_complex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="fl">1.2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb222-50"><a href="non-linear-least-squares-estimation.html#cb222-50" tabindex="-1"></a>y_data_complex <span class="ot">&lt;-</span></span>
<span id="cb222-51"><a href="non-linear-least-squares-estimation.html#cb222-51" tabindex="-1"></a>  <span class="fu">f_complex</span>(true_theta_complex, x_data) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb222-52"><a href="non-linear-least-squares-estimation.html#cb222-52" tabindex="-1"></a></span>
<span id="cb222-53"><a href="non-linear-least-squares-estimation.html#cb222-53" tabindex="-1"></a><span class="co"># -- 2) OPTIMIZERS (EXCEPT BISECTION) ----</span></span>
<span id="cb222-54"><a href="non-linear-least-squares-estimation.html#cb222-54" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb222-55"><a href="non-linear-least-squares-estimation.html#cb222-55" tabindex="-1"></a><span class="co"># All methods share signature:</span></span>
<span id="cb222-56"><a href="non-linear-least-squares-estimation.html#cb222-56" tabindex="-1"></a><span class="co">#   FUN(par, x, y, sse_fn, model_fn, lower=NULL, upper=NULL, ...)</span></span>
<span id="cb222-57"><a href="non-linear-least-squares-estimation.html#cb222-57" tabindex="-1"></a><span class="co"># Some do not strictly use lower/upper if unconstrained.</span></span>
<span id="cb222-58"><a href="non-linear-least-squares-estimation.html#cb222-58" tabindex="-1"></a></span>
<span id="cb222-59"><a href="non-linear-least-squares-estimation.html#cb222-59" tabindex="-1"></a><span class="co"># 2.1 Gauss–Newton</span></span>
<span id="cb222-60"><a href="non-linear-least-squares-estimation.html#cb222-60" tabindex="-1"></a>gauss_newton_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-61"><a href="non-linear-least-squares-estimation.html#cb222-61" tabindex="-1"></a>                             x,</span>
<span id="cb222-62"><a href="non-linear-least-squares-estimation.html#cb222-62" tabindex="-1"></a>                             y,</span>
<span id="cb222-63"><a href="non-linear-least-squares-estimation.html#cb222-63" tabindex="-1"></a>                             sse_fn,</span>
<span id="cb222-64"><a href="non-linear-least-squares-estimation.html#cb222-64" tabindex="-1"></a>                             model_fn,</span>
<span id="cb222-65"><a href="non-linear-least-squares-estimation.html#cb222-65" tabindex="-1"></a>                             <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-66"><a href="non-linear-least-squares-estimation.html#cb222-66" tabindex="-1"></a>                             <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-67"><a href="non-linear-least-squares-estimation.html#cb222-67" tabindex="-1"></a>                             <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb222-68"><a href="non-linear-least-squares-estimation.html#cb222-68" tabindex="-1"></a>                             <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb222-69"><a href="non-linear-least-squares-estimation.html#cb222-69" tabindex="-1"></a>{</span>
<span id="cb222-70"><a href="non-linear-least-squares-estimation.html#cb222-70" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> par</span>
<span id="cb222-71"><a href="non-linear-least-squares-estimation.html#cb222-71" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="fu">seq_len</span>(max_iter)) {</span>
<span id="cb222-72"><a href="non-linear-least-squares-estimation.html#cb222-72" tabindex="-1"></a>    eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb222-73"><a href="non-linear-least-squares-estimation.html#cb222-73" tabindex="-1"></a>    nP  <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb222-74"><a href="non-linear-least-squares-estimation.html#cb222-74" tabindex="-1"></a>    Fmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x), <span class="at">ncol =</span> nP)</span>
<span id="cb222-75"><a href="non-linear-least-squares-estimation.html#cb222-75" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq_len</span>(nP)) {</span>
<span id="cb222-76"><a href="non-linear-least-squares-estimation.html#cb222-76" tabindex="-1"></a>      pert <span class="ot">&lt;-</span> theta</span>
<span id="cb222-77"><a href="non-linear-least-squares-estimation.html#cb222-77" tabindex="-1"></a>      pert[p] <span class="ot">&lt;-</span> pert[p] <span class="sc">+</span> eps</span>
<span id="cb222-78"><a href="non-linear-least-squares-estimation.html#cb222-78" tabindex="-1"></a>      Fmat[, p] <span class="ot">&lt;-</span></span>
<span id="cb222-79"><a href="non-linear-least-squares-estimation.html#cb222-79" tabindex="-1"></a>        (<span class="fu">model_fn</span>(pert, x) <span class="sc">-</span> <span class="fu">model_fn</span>(theta, x)) <span class="sc">/</span> eps</span>
<span id="cb222-80"><a href="non-linear-least-squares-estimation.html#cb222-80" tabindex="-1"></a>    }</span>
<span id="cb222-81"><a href="non-linear-least-squares-estimation.html#cb222-81" tabindex="-1"></a>    r <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">model_fn</span>(theta, x)</span>
<span id="cb222-82"><a href="non-linear-least-squares-estimation.html#cb222-82" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb222-83"><a href="non-linear-least-squares-estimation.html#cb222-83" tabindex="-1"></a>      <span class="fu">solve</span>(<span class="fu">t</span>(Fmat) <span class="sc">%*%</span> Fmat, <span class="fu">t</span>(Fmat) <span class="sc">%*%</span> r),</span>
<span id="cb222-84"><a href="non-linear-least-squares-estimation.html#cb222-84" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb222-85"><a href="non-linear-least-squares-estimation.html#cb222-85" tabindex="-1"></a>        <span class="co"># fallback to pseudoinverse</span></span>
<span id="cb222-86"><a href="non-linear-least-squares-estimation.html#cb222-86" tabindex="-1"></a>        MASS<span class="sc">::</span><span class="fu">ginv</span>(<span class="fu">t</span>(Fmat) <span class="sc">%*%</span> Fmat) <span class="sc">%*%</span> (<span class="fu">t</span>(Fmat) <span class="sc">%*%</span> r)</span>
<span id="cb222-87"><a href="non-linear-least-squares-estimation.html#cb222-87" tabindex="-1"></a>      }</span>
<span id="cb222-88"><a href="non-linear-least-squares-estimation.html#cb222-88" tabindex="-1"></a>    )</span>
<span id="cb222-89"><a href="non-linear-least-squares-estimation.html#cb222-89" tabindex="-1"></a>    theta_new <span class="ot">&lt;-</span> theta <span class="sc">+</span> delta</span>
<span id="cb222-90"><a href="non-linear-least-squares-estimation.html#cb222-90" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb222-91"><a href="non-linear-least-squares-estimation.html#cb222-91" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb222-92"><a href="non-linear-least-squares-estimation.html#cb222-92" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb222-93"><a href="non-linear-least-squares-estimation.html#cb222-93" tabindex="-1"></a>  }</span>
<span id="cb222-94"><a href="non-linear-least-squares-estimation.html#cb222-94" tabindex="-1"></a>  theta</span>
<span id="cb222-95"><a href="non-linear-least-squares-estimation.html#cb222-95" tabindex="-1"></a>}</span>
<span id="cb222-96"><a href="non-linear-least-squares-estimation.html#cb222-96" tabindex="-1"></a></span>
<span id="cb222-97"><a href="non-linear-least-squares-estimation.html#cb222-97" tabindex="-1"></a><span class="co"># 2.2 Modified Gauss-Newton (with step halving)</span></span>
<span id="cb222-98"><a href="non-linear-least-squares-estimation.html#cb222-98" tabindex="-1"></a>modified_gauss_newton_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-99"><a href="non-linear-least-squares-estimation.html#cb222-99" tabindex="-1"></a>                                      x,</span>
<span id="cb222-100"><a href="non-linear-least-squares-estimation.html#cb222-100" tabindex="-1"></a>                                      y,</span>
<span id="cb222-101"><a href="non-linear-least-squares-estimation.html#cb222-101" tabindex="-1"></a>                                      sse_fn,</span>
<span id="cb222-102"><a href="non-linear-least-squares-estimation.html#cb222-102" tabindex="-1"></a>                                      model_fn,</span>
<span id="cb222-103"><a href="non-linear-least-squares-estimation.html#cb222-103" tabindex="-1"></a>                                      <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-104"><a href="non-linear-least-squares-estimation.html#cb222-104" tabindex="-1"></a>                                      <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-105"><a href="non-linear-least-squares-estimation.html#cb222-105" tabindex="-1"></a>                                      <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb222-106"><a href="non-linear-least-squares-estimation.html#cb222-106" tabindex="-1"></a>                                      <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb222-107"><a href="non-linear-least-squares-estimation.html#cb222-107" tabindex="-1"></a>{</span>
<span id="cb222-108"><a href="non-linear-least-squares-estimation.html#cb222-108" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> par</span>
<span id="cb222-109"><a href="non-linear-least-squares-estimation.html#cb222-109" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="fu">seq_len</span>(max_iter)) {</span>
<span id="cb222-110"><a href="non-linear-least-squares-estimation.html#cb222-110" tabindex="-1"></a>    eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb222-111"><a href="non-linear-least-squares-estimation.html#cb222-111" tabindex="-1"></a>    nP  <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb222-112"><a href="non-linear-least-squares-estimation.html#cb222-112" tabindex="-1"></a>    Fmat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x), <span class="at">ncol =</span> nP)</span>
<span id="cb222-113"><a href="non-linear-least-squares-estimation.html#cb222-113" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq_len</span>(nP)) {</span>
<span id="cb222-114"><a href="non-linear-least-squares-estimation.html#cb222-114" tabindex="-1"></a>      pert <span class="ot">&lt;-</span> theta</span>
<span id="cb222-115"><a href="non-linear-least-squares-estimation.html#cb222-115" tabindex="-1"></a>      pert[p] <span class="ot">&lt;-</span> pert[p] <span class="sc">+</span> eps</span>
<span id="cb222-116"><a href="non-linear-least-squares-estimation.html#cb222-116" tabindex="-1"></a>      Fmat[, p] <span class="ot">&lt;-</span></span>
<span id="cb222-117"><a href="non-linear-least-squares-estimation.html#cb222-117" tabindex="-1"></a>        (<span class="fu">model_fn</span>(pert, x) <span class="sc">-</span> <span class="fu">model_fn</span>(theta, x)) <span class="sc">/</span> eps</span>
<span id="cb222-118"><a href="non-linear-least-squares-estimation.html#cb222-118" tabindex="-1"></a>    }</span>
<span id="cb222-119"><a href="non-linear-least-squares-estimation.html#cb222-119" tabindex="-1"></a>    r <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">model_fn</span>(theta, x)</span>
<span id="cb222-120"><a href="non-linear-least-squares-estimation.html#cb222-120" tabindex="-1"></a>    lhs <span class="ot">&lt;-</span> <span class="fu">t</span>(Fmat) <span class="sc">%*%</span> Fmat</span>
<span id="cb222-121"><a href="non-linear-least-squares-estimation.html#cb222-121" tabindex="-1"></a>    rhs <span class="ot">&lt;-</span> <span class="fu">t</span>(Fmat) <span class="sc">%*%</span> r</span>
<span id="cb222-122"><a href="non-linear-least-squares-estimation.html#cb222-122" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb222-123"><a href="non-linear-least-squares-estimation.html#cb222-123" tabindex="-1"></a>      <span class="fu">solve</span>(lhs, rhs),</span>
<span id="cb222-124"><a href="non-linear-least-squares-estimation.html#cb222-124" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb222-125"><a href="non-linear-least-squares-estimation.html#cb222-125" tabindex="-1"></a>        MASS<span class="sc">::</span><span class="fu">ginv</span>(lhs) <span class="sc">%*%</span> rhs</span>
<span id="cb222-126"><a href="non-linear-least-squares-estimation.html#cb222-126" tabindex="-1"></a>    )</span>
<span id="cb222-127"><a href="non-linear-least-squares-estimation.html#cb222-127" tabindex="-1"></a>    sse_old <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(theta, x, y)</span>
<span id="cb222-128"><a href="non-linear-least-squares-estimation.html#cb222-128" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb222-129"><a href="non-linear-least-squares-estimation.html#cb222-129" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb222-130"><a href="non-linear-least-squares-estimation.html#cb222-130" tabindex="-1"></a>      new_sse <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(theta <span class="sc">+</span> alpha <span class="sc">*</span> delta, x, y)</span>
<span id="cb222-131"><a href="non-linear-least-squares-estimation.html#cb222-131" tabindex="-1"></a>      <span class="cf">if</span> (new_sse <span class="sc">&lt;</span> sse_old)</span>
<span id="cb222-132"><a href="non-linear-least-squares-estimation.html#cb222-132" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb222-133"><a href="non-linear-least-squares-estimation.html#cb222-133" tabindex="-1"></a>      alpha <span class="ot">&lt;-</span> alpha <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb222-134"><a href="non-linear-least-squares-estimation.html#cb222-134" tabindex="-1"></a>    }</span>
<span id="cb222-135"><a href="non-linear-least-squares-estimation.html#cb222-135" tabindex="-1"></a>    theta_new <span class="ot">&lt;-</span> theta <span class="sc">+</span> alpha <span class="sc">*</span> delta</span>
<span id="cb222-136"><a href="non-linear-least-squares-estimation.html#cb222-136" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb222-137"><a href="non-linear-least-squares-estimation.html#cb222-137" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb222-138"><a href="non-linear-least-squares-estimation.html#cb222-138" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb222-139"><a href="non-linear-least-squares-estimation.html#cb222-139" tabindex="-1"></a>  }</span>
<span id="cb222-140"><a href="non-linear-least-squares-estimation.html#cb222-140" tabindex="-1"></a>  theta</span>
<span id="cb222-141"><a href="non-linear-least-squares-estimation.html#cb222-141" tabindex="-1"></a>}</span>
<span id="cb222-142"><a href="non-linear-least-squares-estimation.html#cb222-142" tabindex="-1"></a></span>
<span id="cb222-143"><a href="non-linear-least-squares-estimation.html#cb222-143" tabindex="-1"></a><span class="co"># 2.3 Steepest Descent (Gradient Descent)</span></span>
<span id="cb222-144"><a href="non-linear-least-squares-estimation.html#cb222-144" tabindex="-1"></a>steepest_descent_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-145"><a href="non-linear-least-squares-estimation.html#cb222-145" tabindex="-1"></a>                                 x,</span>
<span id="cb222-146"><a href="non-linear-least-squares-estimation.html#cb222-146" tabindex="-1"></a>                                 y,</span>
<span id="cb222-147"><a href="non-linear-least-squares-estimation.html#cb222-147" tabindex="-1"></a>                                 sse_fn,</span>
<span id="cb222-148"><a href="non-linear-least-squares-estimation.html#cb222-148" tabindex="-1"></a>                                 model_fn,</span>
<span id="cb222-149"><a href="non-linear-least-squares-estimation.html#cb222-149" tabindex="-1"></a>                                 <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-150"><a href="non-linear-least-squares-estimation.html#cb222-150" tabindex="-1"></a>                                 <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-151"><a href="non-linear-least-squares-estimation.html#cb222-151" tabindex="-1"></a>                                 <span class="at">lr =</span> <span class="fl">0.001</span>,</span>
<span id="cb222-152"><a href="non-linear-least-squares-estimation.html#cb222-152" tabindex="-1"></a>                                 <span class="at">max_iter =</span> <span class="dv">5000</span>,</span>
<span id="cb222-153"><a href="non-linear-least-squares-estimation.html#cb222-153" tabindex="-1"></a>                                 <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb222-154"><a href="non-linear-least-squares-estimation.html#cb222-154" tabindex="-1"></a>{</span>
<span id="cb222-155"><a href="non-linear-least-squares-estimation.html#cb222-155" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> par</span>
<span id="cb222-156"><a href="non-linear-least-squares-estimation.html#cb222-156" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="fu">seq_len</span>(max_iter)) {</span>
<span id="cb222-157"><a href="non-linear-least-squares-estimation.html#cb222-157" tabindex="-1"></a>    eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb222-158"><a href="non-linear-least-squares-estimation.html#cb222-158" tabindex="-1"></a>    f0  <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(theta, x, y)</span>
<span id="cb222-159"><a href="non-linear-least-squares-estimation.html#cb222-159" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(theta))</span>
<span id="cb222-160"><a href="non-linear-least-squares-estimation.html#cb222-160" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq_along</span>(theta)) {</span>
<span id="cb222-161"><a href="non-linear-least-squares-estimation.html#cb222-161" tabindex="-1"></a>      pert <span class="ot">&lt;-</span> theta</span>
<span id="cb222-162"><a href="non-linear-least-squares-estimation.html#cb222-162" tabindex="-1"></a>      pert[p] <span class="ot">&lt;-</span> pert[p] <span class="sc">+</span> eps</span>
<span id="cb222-163"><a href="non-linear-least-squares-estimation.html#cb222-163" tabindex="-1"></a>      grad[p] <span class="ot">&lt;-</span> (<span class="fu">sse_fn</span>(pert, x, y) <span class="sc">-</span> f0) <span class="sc">/</span> eps</span>
<span id="cb222-164"><a href="non-linear-least-squares-estimation.html#cb222-164" tabindex="-1"></a>    }</span>
<span id="cb222-165"><a href="non-linear-least-squares-estimation.html#cb222-165" tabindex="-1"></a>    theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> lr <span class="sc">*</span> grad</span>
<span id="cb222-166"><a href="non-linear-least-squares-estimation.html#cb222-166" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb222-167"><a href="non-linear-least-squares-estimation.html#cb222-167" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb222-168"><a href="non-linear-least-squares-estimation.html#cb222-168" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb222-169"><a href="non-linear-least-squares-estimation.html#cb222-169" tabindex="-1"></a>  }</span>
<span id="cb222-170"><a href="non-linear-least-squares-estimation.html#cb222-170" tabindex="-1"></a>  theta</span>
<span id="cb222-171"><a href="non-linear-least-squares-estimation.html#cb222-171" tabindex="-1"></a>}</span>
<span id="cb222-172"><a href="non-linear-least-squares-estimation.html#cb222-172" tabindex="-1"></a></span>
<span id="cb222-173"><a href="non-linear-least-squares-estimation.html#cb222-173" tabindex="-1"></a><span class="co"># 2.4 Levenberg–Marquardt (nlsLM)</span></span>
<span id="cb222-174"><a href="non-linear-least-squares-estimation.html#cb222-174" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-175"><a href="non-linear-least-squares-estimation.html#cb222-175" tabindex="-1"></a>                   x,</span>
<span id="cb222-176"><a href="non-linear-least-squares-estimation.html#cb222-176" tabindex="-1"></a>                   y,</span>
<span id="cb222-177"><a href="non-linear-least-squares-estimation.html#cb222-177" tabindex="-1"></a>                   sse_fn,</span>
<span id="cb222-178"><a href="non-linear-least-squares-estimation.html#cb222-178" tabindex="-1"></a>                   model_fn,</span>
<span id="cb222-179"><a href="non-linear-least-squares-estimation.html#cb222-179" tabindex="-1"></a>                   <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-180"><a href="non-linear-least-squares-estimation.html#cb222-180" tabindex="-1"></a>                   <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-181"><a href="non-linear-least-squares-estimation.html#cb222-181" tabindex="-1"></a>                   <span class="at">form =</span> <span class="fu">c</span>(<span class="st">&quot;simple&quot;</span>, <span class="st">&quot;complex&quot;</span>))</span>
<span id="cb222-182"><a href="non-linear-least-squares-estimation.html#cb222-182" tabindex="-1"></a>{</span>
<span id="cb222-183"><a href="non-linear-least-squares-estimation.html#cb222-183" tabindex="-1"></a>  form <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(form)</span>
<span id="cb222-184"><a href="non-linear-least-squares-estimation.html#cb222-184" tabindex="-1"></a>  <span class="cf">if</span> (form <span class="sc">==</span> <span class="st">&quot;simple&quot;</span>) {</span>
<span id="cb222-185"><a href="non-linear-least-squares-estimation.html#cb222-185" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> A <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>B <span class="sc">*</span> (x <span class="sc">-</span> C))),</span>
<span id="cb222-186"><a href="non-linear-least-squares-estimation.html#cb222-186" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(<span class="at">A =</span> par[<span class="dv">1</span>],</span>
<span id="cb222-187"><a href="non-linear-least-squares-estimation.html#cb222-187" tabindex="-1"></a>                              <span class="at">B =</span> par[<span class="dv">2</span>],</span>
<span id="cb222-188"><a href="non-linear-least-squares-estimation.html#cb222-188" tabindex="-1"></a>                              <span class="at">C =</span> par[<span class="dv">3</span>]))</span>
<span id="cb222-189"><a href="non-linear-least-squares-estimation.html#cb222-189" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb222-190"><a href="non-linear-least-squares-estimation.html#cb222-190" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">nlsLM</span>(y <span class="sc">~</span> A <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>B <span class="sc">*</span> (x <span class="sc">-</span> C))) <span class="sc">+</span> D <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">*</span> x),</span>
<span id="cb222-191"><a href="non-linear-least-squares-estimation.html#cb222-191" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb222-192"><a href="non-linear-least-squares-estimation.html#cb222-192" tabindex="-1"></a>                   <span class="at">A =</span> par[<span class="dv">1</span>],</span>
<span id="cb222-193"><a href="non-linear-least-squares-estimation.html#cb222-193" tabindex="-1"></a>                   <span class="at">B =</span> par[<span class="dv">2</span>],</span>
<span id="cb222-194"><a href="non-linear-least-squares-estimation.html#cb222-194" tabindex="-1"></a>                   <span class="at">C =</span> par[<span class="dv">3</span>],</span>
<span id="cb222-195"><a href="non-linear-least-squares-estimation.html#cb222-195" tabindex="-1"></a>                   <span class="at">D =</span> par[<span class="dv">4</span>]</span>
<span id="cb222-196"><a href="non-linear-least-squares-estimation.html#cb222-196" tabindex="-1"></a>                 ))</span>
<span id="cb222-197"><a href="non-linear-least-squares-estimation.html#cb222-197" tabindex="-1"></a>  }</span>
<span id="cb222-198"><a href="non-linear-least-squares-estimation.html#cb222-198" tabindex="-1"></a>  <span class="fu">coef</span>(fit)</span>
<span id="cb222-199"><a href="non-linear-least-squares-estimation.html#cb222-199" tabindex="-1"></a>}</span>
<span id="cb222-200"><a href="non-linear-least-squares-estimation.html#cb222-200" tabindex="-1"></a></span>
<span id="cb222-201"><a href="non-linear-least-squares-estimation.html#cb222-201" tabindex="-1"></a><span class="co"># 2.5 Newton–Raphson (with numeric Hessian, fallback if singular)</span></span>
<span id="cb222-202"><a href="non-linear-least-squares-estimation.html#cb222-202" tabindex="-1"></a>newton_raphson_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-203"><a href="non-linear-least-squares-estimation.html#cb222-203" tabindex="-1"></a>                               x,</span>
<span id="cb222-204"><a href="non-linear-least-squares-estimation.html#cb222-204" tabindex="-1"></a>                               y,</span>
<span id="cb222-205"><a href="non-linear-least-squares-estimation.html#cb222-205" tabindex="-1"></a>                               sse_fn,</span>
<span id="cb222-206"><a href="non-linear-least-squares-estimation.html#cb222-206" tabindex="-1"></a>                               model_fn,</span>
<span id="cb222-207"><a href="non-linear-least-squares-estimation.html#cb222-207" tabindex="-1"></a>                               <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-208"><a href="non-linear-least-squares-estimation.html#cb222-208" tabindex="-1"></a>                               <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-209"><a href="non-linear-least-squares-estimation.html#cb222-209" tabindex="-1"></a>                               <span class="at">max_iter =</span> <span class="dv">50</span>,</span>
<span id="cb222-210"><a href="non-linear-least-squares-estimation.html#cb222-210" tabindex="-1"></a>                               <span class="at">tol =</span> <span class="fl">1e-6</span>)</span>
<span id="cb222-211"><a href="non-linear-least-squares-estimation.html#cb222-211" tabindex="-1"></a>{</span>
<span id="cb222-212"><a href="non-linear-least-squares-estimation.html#cb222-212" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> par</span>
<span id="cb222-213"><a href="non-linear-least-squares-estimation.html#cb222-213" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(max_iter)) {</span>
<span id="cb222-214"><a href="non-linear-least-squares-estimation.html#cb222-214" tabindex="-1"></a>    eps <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb222-215"><a href="non-linear-least-squares-estimation.html#cb222-215" tabindex="-1"></a>    f0  <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(theta, x, y)</span>
<span id="cb222-216"><a href="non-linear-least-squares-estimation.html#cb222-216" tabindex="-1"></a>    grad <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(theta))</span>
<span id="cb222-217"><a href="non-linear-least-squares-estimation.html#cb222-217" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq_along</span>(theta)) {</span>
<span id="cb222-218"><a href="non-linear-least-squares-estimation.html#cb222-218" tabindex="-1"></a>      pert <span class="ot">&lt;-</span> theta</span>
<span id="cb222-219"><a href="non-linear-least-squares-estimation.html#cb222-219" tabindex="-1"></a>      pert[p] <span class="ot">&lt;-</span> pert[p] <span class="sc">+</span> eps</span>
<span id="cb222-220"><a href="non-linear-least-squares-estimation.html#cb222-220" tabindex="-1"></a>      grad[p] <span class="ot">&lt;-</span> (<span class="fu">sse_fn</span>(pert, x, y) <span class="sc">-</span> f0) <span class="sc">/</span> eps</span>
<span id="cb222-221"><a href="non-linear-least-squares-estimation.html#cb222-221" tabindex="-1"></a>    }</span>
<span id="cb222-222"><a href="non-linear-least-squares-estimation.html#cb222-222" tabindex="-1"></a>    Hess <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">length</span>(theta), <span class="fu">length</span>(theta))</span>
<span id="cb222-223"><a href="non-linear-least-squares-estimation.html#cb222-223" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> <span class="fu">seq_along</span>(theta)) {</span>
<span id="cb222-224"><a href="non-linear-least-squares-estimation.html#cb222-224" tabindex="-1"></a>      pert_p <span class="ot">&lt;-</span> theta</span>
<span id="cb222-225"><a href="non-linear-least-squares-estimation.html#cb222-225" tabindex="-1"></a>      pert_p[p] <span class="ot">&lt;-</span> pert_p[p] <span class="sc">+</span> eps</span>
<span id="cb222-226"><a href="non-linear-least-squares-estimation.html#cb222-226" tabindex="-1"></a>      f_p <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(pert_p, x, y)</span>
<span id="cb222-227"><a href="non-linear-least-squares-estimation.html#cb222-227" tabindex="-1"></a>      <span class="cf">for</span> (q <span class="cf">in</span> <span class="fu">seq_along</span>(theta)) {</span>
<span id="cb222-228"><a href="non-linear-least-squares-estimation.html#cb222-228" tabindex="-1"></a>        pert_q <span class="ot">&lt;-</span> pert_p</span>
<span id="cb222-229"><a href="non-linear-least-squares-estimation.html#cb222-229" tabindex="-1"></a>        pert_q[q] <span class="ot">&lt;-</span> pert_q[q] <span class="sc">+</span> eps</span>
<span id="cb222-230"><a href="non-linear-least-squares-estimation.html#cb222-230" tabindex="-1"></a>        Hess[p, q] <span class="ot">&lt;-</span> (<span class="fu">sse_fn</span>(pert_q, x, y) <span class="sc">-</span></span>
<span id="cb222-231"><a href="non-linear-least-squares-estimation.html#cb222-231" tabindex="-1"></a>                         f_p <span class="sc">-</span> (f0 <span class="sc">-</span> <span class="fu">sse_fn</span>(theta, x, y))) <span class="sc">/</span> (eps <span class="sc">^</span></span>
<span id="cb222-232"><a href="non-linear-least-squares-estimation.html#cb222-232" tabindex="-1"></a>                                                                <span class="dv">2</span>)</span>
<span id="cb222-233"><a href="non-linear-least-squares-estimation.html#cb222-233" tabindex="-1"></a>      }</span>
<span id="cb222-234"><a href="non-linear-least-squares-estimation.html#cb222-234" tabindex="-1"></a>    }</span>
<span id="cb222-235"><a href="non-linear-least-squares-estimation.html#cb222-235" tabindex="-1"></a>    delta <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb222-236"><a href="non-linear-least-squares-estimation.html#cb222-236" tabindex="-1"></a>      <span class="fu">solve</span>(Hess, grad),</span>
<span id="cb222-237"><a href="non-linear-least-squares-estimation.html#cb222-237" tabindex="-1"></a>      <span class="at">error =</span> <span class="cf">function</span>(e)</span>
<span id="cb222-238"><a href="non-linear-least-squares-estimation.html#cb222-238" tabindex="-1"></a>        MASS<span class="sc">::</span><span class="fu">ginv</span>(Hess) <span class="sc">%*%</span> grad</span>
<span id="cb222-239"><a href="non-linear-least-squares-estimation.html#cb222-239" tabindex="-1"></a>    )</span>
<span id="cb222-240"><a href="non-linear-least-squares-estimation.html#cb222-240" tabindex="-1"></a>    theta_new <span class="ot">&lt;-</span> theta <span class="sc">-</span> delta</span>
<span id="cb222-241"><a href="non-linear-least-squares-estimation.html#cb222-241" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">abs</span>(theta_new <span class="sc">-</span> theta)) <span class="sc">&lt;</span> tol)</span>
<span id="cb222-242"><a href="non-linear-least-squares-estimation.html#cb222-242" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb222-243"><a href="non-linear-least-squares-estimation.html#cb222-243" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> theta_new</span>
<span id="cb222-244"><a href="non-linear-least-squares-estimation.html#cb222-244" tabindex="-1"></a>  }</span>
<span id="cb222-245"><a href="non-linear-least-squares-estimation.html#cb222-245" tabindex="-1"></a>  theta</span>
<span id="cb222-246"><a href="non-linear-least-squares-estimation.html#cb222-246" tabindex="-1"></a>}</span>
<span id="cb222-247"><a href="non-linear-least-squares-estimation.html#cb222-247" tabindex="-1"></a></span>
<span id="cb222-248"><a href="non-linear-least-squares-estimation.html#cb222-248" tabindex="-1"></a><span class="co"># 2.6 Quasi–Newton (BFGS via optim)</span></span>
<span id="cb222-249"><a href="non-linear-least-squares-estimation.html#cb222-249" tabindex="-1"></a>quasi_newton_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-250"><a href="non-linear-least-squares-estimation.html#cb222-250" tabindex="-1"></a>                             x,</span>
<span id="cb222-251"><a href="non-linear-least-squares-estimation.html#cb222-251" tabindex="-1"></a>                             y,</span>
<span id="cb222-252"><a href="non-linear-least-squares-estimation.html#cb222-252" tabindex="-1"></a>                             sse_fn,</span>
<span id="cb222-253"><a href="non-linear-least-squares-estimation.html#cb222-253" tabindex="-1"></a>                             model_fn,</span>
<span id="cb222-254"><a href="non-linear-least-squares-estimation.html#cb222-254" tabindex="-1"></a>                             <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-255"><a href="non-linear-least-squares-estimation.html#cb222-255" tabindex="-1"></a>                             <span class="at">upper =</span> <span class="cn">NULL</span>)</span>
<span id="cb222-256"><a href="non-linear-least-squares-estimation.html#cb222-256" tabindex="-1"></a>{</span>
<span id="cb222-257"><a href="non-linear-least-squares-estimation.html#cb222-257" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-258"><a href="non-linear-least-squares-estimation.html#cb222-258" tabindex="-1"></a>    <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-259"><a href="non-linear-least-squares-estimation.html#cb222-259" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">optim</span>(par, fn, <span class="at">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb222-260"><a href="non-linear-least-squares-estimation.html#cb222-260" tabindex="-1"></a>  res<span class="sc">$</span>par</span>
<span id="cb222-261"><a href="non-linear-least-squares-estimation.html#cb222-261" tabindex="-1"></a>}</span>
<span id="cb222-262"><a href="non-linear-least-squares-estimation.html#cb222-262" tabindex="-1"></a></span>
<span id="cb222-263"><a href="non-linear-least-squares-estimation.html#cb222-263" tabindex="-1"></a><span class="co"># 2.7 Trust-region reflective (nloptr)</span></span>
<span id="cb222-264"><a href="non-linear-least-squares-estimation.html#cb222-264" tabindex="-1"></a>trust_region_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-265"><a href="non-linear-least-squares-estimation.html#cb222-265" tabindex="-1"></a>                             x,</span>
<span id="cb222-266"><a href="non-linear-least-squares-estimation.html#cb222-266" tabindex="-1"></a>                             y,</span>
<span id="cb222-267"><a href="non-linear-least-squares-estimation.html#cb222-267" tabindex="-1"></a>                             sse_fn,</span>
<span id="cb222-268"><a href="non-linear-least-squares-estimation.html#cb222-268" tabindex="-1"></a>                             model_fn,</span>
<span id="cb222-269"><a href="non-linear-least-squares-estimation.html#cb222-269" tabindex="-1"></a>                             <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-270"><a href="non-linear-least-squares-estimation.html#cb222-270" tabindex="-1"></a>                             <span class="at">upper =</span> <span class="cn">NULL</span>)</span>
<span id="cb222-271"><a href="non-linear-least-squares-estimation.html#cb222-271" tabindex="-1"></a>{</span>
<span id="cb222-272"><a href="non-linear-least-squares-estimation.html#cb222-272" tabindex="-1"></a>  <span class="co"># numeric gradient</span></span>
<span id="cb222-273"><a href="non-linear-least-squares-estimation.html#cb222-273" tabindex="-1"></a>  grad_numeric <span class="ot">&lt;-</span> <span class="cf">function</span>(pp, <span class="at">eps =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb222-274"><a href="non-linear-least-squares-estimation.html#cb222-274" tabindex="-1"></a>    g  <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(pp))</span>
<span id="cb222-275"><a href="non-linear-least-squares-estimation.html#cb222-275" tabindex="-1"></a>    f0 <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-276"><a href="non-linear-least-squares-estimation.html#cb222-276" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(pp)) {</span>
<span id="cb222-277"><a href="non-linear-least-squares-estimation.html#cb222-277" tabindex="-1"></a>      p2 <span class="ot">&lt;-</span> pp</span>
<span id="cb222-278"><a href="non-linear-least-squares-estimation.html#cb222-278" tabindex="-1"></a>      p2[i] <span class="ot">&lt;-</span> p2[i] <span class="sc">+</span> eps</span>
<span id="cb222-279"><a href="non-linear-least-squares-estimation.html#cb222-279" tabindex="-1"></a>      g[i] <span class="ot">&lt;-</span> (<span class="fu">sse_fn</span>(p2, x, y) <span class="sc">-</span> f0) <span class="sc">/</span> eps</span>
<span id="cb222-280"><a href="non-linear-least-squares-estimation.html#cb222-280" tabindex="-1"></a>    }</span>
<span id="cb222-281"><a href="non-linear-least-squares-estimation.html#cb222-281" tabindex="-1"></a>    g</span>
<span id="cb222-282"><a href="non-linear-least-squares-estimation.html#cb222-282" tabindex="-1"></a>  }</span>
<span id="cb222-283"><a href="non-linear-least-squares-estimation.html#cb222-283" tabindex="-1"></a>  eval_f <span class="ot">&lt;-</span> <span class="cf">function</span>(pp) {</span>
<span id="cb222-284"><a href="non-linear-least-squares-estimation.html#cb222-284" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-285"><a href="non-linear-least-squares-estimation.html#cb222-285" tabindex="-1"></a>    gr  <span class="ot">&lt;-</span> <span class="fu">grad_numeric</span>(pp)</span>
<span id="cb222-286"><a href="non-linear-least-squares-estimation.html#cb222-286" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">objective =</span> val, <span class="at">gradient =</span> gr)</span>
<span id="cb222-287"><a href="non-linear-least-squares-estimation.html#cb222-287" tabindex="-1"></a>  }</span>
<span id="cb222-288"><a href="non-linear-least-squares-estimation.html#cb222-288" tabindex="-1"></a>  lb <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(lower))</span>
<span id="cb222-289"><a href="non-linear-least-squares-estimation.html#cb222-289" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fu">length</span>(par))</span>
<span id="cb222-290"><a href="non-linear-least-squares-estimation.html#cb222-290" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb222-291"><a href="non-linear-least-squares-estimation.html#cb222-291" tabindex="-1"></a>    lower</span>
<span id="cb222-292"><a href="non-linear-least-squares-estimation.html#cb222-292" tabindex="-1"></a>  ub <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(upper))</span>
<span id="cb222-293"><a href="non-linear-least-squares-estimation.html#cb222-293" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">Inf</span>, <span class="fu">length</span>(par))</span>
<span id="cb222-294"><a href="non-linear-least-squares-estimation.html#cb222-294" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb222-295"><a href="non-linear-least-squares-estimation.html#cb222-295" tabindex="-1"></a>    upper</span>
<span id="cb222-296"><a href="non-linear-least-squares-estimation.html#cb222-296" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">nloptr</span>(</span>
<span id="cb222-297"><a href="non-linear-least-squares-estimation.html#cb222-297" tabindex="-1"></a>    <span class="at">x0 =</span> par,</span>
<span id="cb222-298"><a href="non-linear-least-squares-estimation.html#cb222-298" tabindex="-1"></a>    <span class="at">eval_f =</span> eval_f,</span>
<span id="cb222-299"><a href="non-linear-least-squares-estimation.html#cb222-299" tabindex="-1"></a>    <span class="at">lb =</span> lb,</span>
<span id="cb222-300"><a href="non-linear-least-squares-estimation.html#cb222-300" tabindex="-1"></a>    <span class="at">ub =</span> ub,</span>
<span id="cb222-301"><a href="non-linear-least-squares-estimation.html#cb222-301" tabindex="-1"></a>    <span class="at">opts =</span> <span class="fu">list</span>(</span>
<span id="cb222-302"><a href="non-linear-least-squares-estimation.html#cb222-302" tabindex="-1"></a>      <span class="at">algorithm =</span> <span class="st">&quot;NLOPT_LD_TNEWTON&quot;</span>,</span>
<span id="cb222-303"><a href="non-linear-least-squares-estimation.html#cb222-303" tabindex="-1"></a>      <span class="at">maxeval =</span> <span class="dv">500</span>,</span>
<span id="cb222-304"><a href="non-linear-least-squares-estimation.html#cb222-304" tabindex="-1"></a>      <span class="at">xtol_rel =</span> <span class="fl">1e-6</span></span>
<span id="cb222-305"><a href="non-linear-least-squares-estimation.html#cb222-305" tabindex="-1"></a>    )</span>
<span id="cb222-306"><a href="non-linear-least-squares-estimation.html#cb222-306" tabindex="-1"></a>  )</span>
<span id="cb222-307"><a href="non-linear-least-squares-estimation.html#cb222-307" tabindex="-1"></a>  res<span class="sc">$</span>solution</span>
<span id="cb222-308"><a href="non-linear-least-squares-estimation.html#cb222-308" tabindex="-1"></a>}</span>
<span id="cb222-309"><a href="non-linear-least-squares-estimation.html#cb222-309" tabindex="-1"></a></span>
<span id="cb222-310"><a href="non-linear-least-squares-estimation.html#cb222-310" tabindex="-1"></a><span class="co"># 2.8 Grid search</span></span>
<span id="cb222-311"><a href="non-linear-least-squares-estimation.html#cb222-311" tabindex="-1"></a>grid_search_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-312"><a href="non-linear-least-squares-estimation.html#cb222-312" tabindex="-1"></a>                            x,</span>
<span id="cb222-313"><a href="non-linear-least-squares-estimation.html#cb222-313" tabindex="-1"></a>                            y,</span>
<span id="cb222-314"><a href="non-linear-least-squares-estimation.html#cb222-314" tabindex="-1"></a>                            sse_fn,</span>
<span id="cb222-315"><a href="non-linear-least-squares-estimation.html#cb222-315" tabindex="-1"></a>                            model_fn,</span>
<span id="cb222-316"><a href="non-linear-least-squares-estimation.html#cb222-316" tabindex="-1"></a>                            <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-317"><a href="non-linear-least-squares-estimation.html#cb222-317" tabindex="-1"></a>                            <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-318"><a href="non-linear-least-squares-estimation.html#cb222-318" tabindex="-1"></a>                            <span class="at">grid_defs =</span> <span class="cn">NULL</span>)</span>
<span id="cb222-319"><a href="non-linear-least-squares-estimation.html#cb222-319" tabindex="-1"></a>{</span>
<span id="cb222-320"><a href="non-linear-least-squares-estimation.html#cb222-320" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(grid_defs))</span>
<span id="cb222-321"><a href="non-linear-least-squares-estimation.html#cb222-321" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Must provide grid_defs for multi-parameter grid search.&quot;</span>)</span>
<span id="cb222-322"><a href="non-linear-least-squares-estimation.html#cb222-322" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(grid_defs)</span>
<span id="cb222-323"><a href="non-linear-least-squares-estimation.html#cb222-323" tabindex="-1"></a>  g<span class="sc">$</span>SSE <span class="ot">&lt;-</span></span>
<span id="cb222-324"><a href="non-linear-least-squares-estimation.html#cb222-324" tabindex="-1"></a>    <span class="fu">apply</span>(g, <span class="dv">1</span>, <span class="cf">function</span>(rowp)</span>
<span id="cb222-325"><a href="non-linear-least-squares-estimation.html#cb222-325" tabindex="-1"></a>      <span class="fu">sse_fn</span>(<span class="fu">as.numeric</span>(rowp), x, y))</span>
<span id="cb222-326"><a href="non-linear-least-squares-estimation.html#cb222-326" tabindex="-1"></a>  best_idx <span class="ot">&lt;-</span> <span class="fu">which.min</span>(g<span class="sc">$</span>SSE)</span>
<span id="cb222-327"><a href="non-linear-least-squares-estimation.html#cb222-327" tabindex="-1"></a>  <span class="fu">as.numeric</span>(g[best_idx, <span class="fu">seq_along</span>(grid_defs)])</span>
<span id="cb222-328"><a href="non-linear-least-squares-estimation.html#cb222-328" tabindex="-1"></a>}</span>
<span id="cb222-329"><a href="non-linear-least-squares-estimation.html#cb222-329" tabindex="-1"></a></span>
<span id="cb222-330"><a href="non-linear-least-squares-estimation.html#cb222-330" tabindex="-1"></a><span class="co"># 2.9 Nelder-Mead</span></span>
<span id="cb222-331"><a href="non-linear-least-squares-estimation.html#cb222-331" tabindex="-1"></a>nelder_mead_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-332"><a href="non-linear-least-squares-estimation.html#cb222-332" tabindex="-1"></a>                            x,</span>
<span id="cb222-333"><a href="non-linear-least-squares-estimation.html#cb222-333" tabindex="-1"></a>                            y,</span>
<span id="cb222-334"><a href="non-linear-least-squares-estimation.html#cb222-334" tabindex="-1"></a>                            sse_fn,</span>
<span id="cb222-335"><a href="non-linear-least-squares-estimation.html#cb222-335" tabindex="-1"></a>                            model_fn,</span>
<span id="cb222-336"><a href="non-linear-least-squares-estimation.html#cb222-336" tabindex="-1"></a>                            <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-337"><a href="non-linear-least-squares-estimation.html#cb222-337" tabindex="-1"></a>                            <span class="at">upper =</span> <span class="cn">NULL</span>)</span>
<span id="cb222-338"><a href="non-linear-least-squares-estimation.html#cb222-338" tabindex="-1"></a>{</span>
<span id="cb222-339"><a href="non-linear-least-squares-estimation.html#cb222-339" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-340"><a href="non-linear-least-squares-estimation.html#cb222-340" tabindex="-1"></a>    <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-341"><a href="non-linear-least-squares-estimation.html#cb222-341" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">optim</span>(par, fn, <span class="at">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>)</span>
<span id="cb222-342"><a href="non-linear-least-squares-estimation.html#cb222-342" tabindex="-1"></a>  res<span class="sc">$</span>par</span>
<span id="cb222-343"><a href="non-linear-least-squares-estimation.html#cb222-343" tabindex="-1"></a>}</span>
<span id="cb222-344"><a href="non-linear-least-squares-estimation.html#cb222-344" tabindex="-1"></a></span>
<span id="cb222-345"><a href="non-linear-least-squares-estimation.html#cb222-345" tabindex="-1"></a><span class="co"># 2.10 Powell’s method (dfoptim::nmk for unconstrained)</span></span>
<span id="cb222-346"><a href="non-linear-least-squares-estimation.html#cb222-346" tabindex="-1"></a>powell_fit <span class="ot">&lt;-</span></span>
<span id="cb222-347"><a href="non-linear-least-squares-estimation.html#cb222-347" tabindex="-1"></a>  <span class="cf">function</span>(par,</span>
<span id="cb222-348"><a href="non-linear-least-squares-estimation.html#cb222-348" tabindex="-1"></a>           x,</span>
<span id="cb222-349"><a href="non-linear-least-squares-estimation.html#cb222-349" tabindex="-1"></a>           y,</span>
<span id="cb222-350"><a href="non-linear-least-squares-estimation.html#cb222-350" tabindex="-1"></a>           sse_fn,</span>
<span id="cb222-351"><a href="non-linear-least-squares-estimation.html#cb222-351" tabindex="-1"></a>           model_fn,</span>
<span id="cb222-352"><a href="non-linear-least-squares-estimation.html#cb222-352" tabindex="-1"></a>           <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-353"><a href="non-linear-least-squares-estimation.html#cb222-353" tabindex="-1"></a>           <span class="at">upper =</span> <span class="cn">NULL</span>) {</span>
<span id="cb222-354"><a href="non-linear-least-squares-estimation.html#cb222-354" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-355"><a href="non-linear-least-squares-estimation.html#cb222-355" tabindex="-1"></a>      <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-356"><a href="non-linear-least-squares-estimation.html#cb222-356" tabindex="-1"></a>    dfoptim<span class="sc">::</span><span class="fu">nmk</span>(par, fn)<span class="sc">$</span>par</span>
<span id="cb222-357"><a href="non-linear-least-squares-estimation.html#cb222-357" tabindex="-1"></a>  }</span>
<span id="cb222-358"><a href="non-linear-least-squares-estimation.html#cb222-358" tabindex="-1"></a></span>
<span id="cb222-359"><a href="non-linear-least-squares-estimation.html#cb222-359" tabindex="-1"></a><span class="co"># 2.11 Hooke-Jeeves (dfoptim::hjkb)</span></span>
<span id="cb222-360"><a href="non-linear-least-squares-estimation.html#cb222-360" tabindex="-1"></a>hooke_jeeves_fit <span class="ot">&lt;-</span></span>
<span id="cb222-361"><a href="non-linear-least-squares-estimation.html#cb222-361" tabindex="-1"></a>  <span class="cf">function</span>(par,</span>
<span id="cb222-362"><a href="non-linear-least-squares-estimation.html#cb222-362" tabindex="-1"></a>           x,</span>
<span id="cb222-363"><a href="non-linear-least-squares-estimation.html#cb222-363" tabindex="-1"></a>           y,</span>
<span id="cb222-364"><a href="non-linear-least-squares-estimation.html#cb222-364" tabindex="-1"></a>           sse_fn,</span>
<span id="cb222-365"><a href="non-linear-least-squares-estimation.html#cb222-365" tabindex="-1"></a>           model_fn,</span>
<span id="cb222-366"><a href="non-linear-least-squares-estimation.html#cb222-366" tabindex="-1"></a>           <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-367"><a href="non-linear-least-squares-estimation.html#cb222-367" tabindex="-1"></a>           <span class="at">upper =</span> <span class="cn">NULL</span>) {</span>
<span id="cb222-368"><a href="non-linear-least-squares-estimation.html#cb222-368" tabindex="-1"></a>    fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-369"><a href="non-linear-least-squares-estimation.html#cb222-369" tabindex="-1"></a>      <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-370"><a href="non-linear-least-squares-estimation.html#cb222-370" tabindex="-1"></a>    dfoptim<span class="sc">::</span><span class="fu">hjkb</span>(par, fn)<span class="sc">$</span>par</span>
<span id="cb222-371"><a href="non-linear-least-squares-estimation.html#cb222-371" tabindex="-1"></a>  }</span>
<span id="cb222-372"><a href="non-linear-least-squares-estimation.html#cb222-372" tabindex="-1"></a></span>
<span id="cb222-373"><a href="non-linear-least-squares-estimation.html#cb222-373" tabindex="-1"></a><span class="co"># 2.12 Random Search</span></span>
<span id="cb222-374"><a href="non-linear-least-squares-estimation.html#cb222-374" tabindex="-1"></a>random_search_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-375"><a href="non-linear-least-squares-estimation.html#cb222-375" tabindex="-1"></a>                              x,</span>
<span id="cb222-376"><a href="non-linear-least-squares-estimation.html#cb222-376" tabindex="-1"></a>                              y,</span>
<span id="cb222-377"><a href="non-linear-least-squares-estimation.html#cb222-377" tabindex="-1"></a>                              sse_fn,</span>
<span id="cb222-378"><a href="non-linear-least-squares-estimation.html#cb222-378" tabindex="-1"></a>                              model_fn,</span>
<span id="cb222-379"><a href="non-linear-least-squares-estimation.html#cb222-379" tabindex="-1"></a>                              lower,</span>
<span id="cb222-380"><a href="non-linear-least-squares-estimation.html#cb222-380" tabindex="-1"></a>                              upper,</span>
<span id="cb222-381"><a href="non-linear-least-squares-estimation.html#cb222-381" tabindex="-1"></a>                              <span class="at">max_iter =</span> <span class="dv">2000</span>,</span>
<span id="cb222-382"><a href="non-linear-least-squares-estimation.html#cb222-382" tabindex="-1"></a>                              ...)</span>
<span id="cb222-383"><a href="non-linear-least-squares-estimation.html#cb222-383" tabindex="-1"></a>{</span>
<span id="cb222-384"><a href="non-linear-least-squares-estimation.html#cb222-384" tabindex="-1"></a>  best_par <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb222-385"><a href="non-linear-least-squares-estimation.html#cb222-385" tabindex="-1"></a>  best_sse <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb222-386"><a href="non-linear-least-squares-estimation.html#cb222-386" tabindex="-1"></a>  dimp <span class="ot">&lt;-</span> <span class="fu">length</span>(lower)</span>
<span id="cb222-387"><a href="non-linear-least-squares-estimation.html#cb222-387" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(max_iter)) {</span>
<span id="cb222-388"><a href="non-linear-least-squares-estimation.html#cb222-388" tabindex="-1"></a>    candidate <span class="ot">&lt;-</span> <span class="fu">runif</span>(dimp, <span class="at">min =</span> lower, <span class="at">max =</span> upper)</span>
<span id="cb222-389"><a href="non-linear-least-squares-estimation.html#cb222-389" tabindex="-1"></a>    val <span class="ot">&lt;-</span> <span class="fu">sse_fn</span>(candidate, x, y)</span>
<span id="cb222-390"><a href="non-linear-least-squares-estimation.html#cb222-390" tabindex="-1"></a>    <span class="cf">if</span> (val <span class="sc">&lt;</span> best_sse) {</span>
<span id="cb222-391"><a href="non-linear-least-squares-estimation.html#cb222-391" tabindex="-1"></a>      best_sse <span class="ot">&lt;-</span> val</span>
<span id="cb222-392"><a href="non-linear-least-squares-estimation.html#cb222-392" tabindex="-1"></a>      best_par <span class="ot">&lt;-</span> candidate</span>
<span id="cb222-393"><a href="non-linear-least-squares-estimation.html#cb222-393" tabindex="-1"></a>    }</span>
<span id="cb222-394"><a href="non-linear-least-squares-estimation.html#cb222-394" tabindex="-1"></a>  }</span>
<span id="cb222-395"><a href="non-linear-least-squares-estimation.html#cb222-395" tabindex="-1"></a>  best_par</span>
<span id="cb222-396"><a href="non-linear-least-squares-estimation.html#cb222-396" tabindex="-1"></a>}</span>
<span id="cb222-397"><a href="non-linear-least-squares-estimation.html#cb222-397" tabindex="-1"></a></span>
<span id="cb222-398"><a href="non-linear-least-squares-estimation.html#cb222-398" tabindex="-1"></a><span class="co"># 2.13 Differential Evolution (DEoptim)</span></span>
<span id="cb222-399"><a href="non-linear-least-squares-estimation.html#cb222-399" tabindex="-1"></a>diff_evo_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-400"><a href="non-linear-least-squares-estimation.html#cb222-400" tabindex="-1"></a>                         x,</span>
<span id="cb222-401"><a href="non-linear-least-squares-estimation.html#cb222-401" tabindex="-1"></a>                         y,</span>
<span id="cb222-402"><a href="non-linear-least-squares-estimation.html#cb222-402" tabindex="-1"></a>                         sse_fn,</span>
<span id="cb222-403"><a href="non-linear-least-squares-estimation.html#cb222-403" tabindex="-1"></a>                         model_fn,</span>
<span id="cb222-404"><a href="non-linear-least-squares-estimation.html#cb222-404" tabindex="-1"></a>                         lower,</span>
<span id="cb222-405"><a href="non-linear-least-squares-estimation.html#cb222-405" tabindex="-1"></a>                         upper,</span>
<span id="cb222-406"><a href="non-linear-least-squares-estimation.html#cb222-406" tabindex="-1"></a>                         <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb222-407"><a href="non-linear-least-squares-estimation.html#cb222-407" tabindex="-1"></a>                         ...)</span>
<span id="cb222-408"><a href="non-linear-least-squares-estimation.html#cb222-408" tabindex="-1"></a>{</span>
<span id="cb222-409"><a href="non-linear-least-squares-estimation.html#cb222-409" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="cf">function</span>(v)</span>
<span id="cb222-410"><a href="non-linear-least-squares-estimation.html#cb222-410" tabindex="-1"></a>    <span class="fu">sse_fn</span>(v, x, y)</span>
<span id="cb222-411"><a href="non-linear-least-squares-estimation.html#cb222-411" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">DEoptim</span>(fn,</span>
<span id="cb222-412"><a href="non-linear-least-squares-estimation.html#cb222-412" tabindex="-1"></a>                 <span class="at">lower =</span> lower,</span>
<span id="cb222-413"><a href="non-linear-least-squares-estimation.html#cb222-413" tabindex="-1"></a>                 <span class="at">upper =</span> upper,</span>
<span id="cb222-414"><a href="non-linear-least-squares-estimation.html#cb222-414" tabindex="-1"></a>                 <span class="fu">DEoptim.control</span>(<span class="at">NP =</span> <span class="dv">50</span>, <span class="at">itermax =</span> max_iter, <span class="at">trace =</span> F))</span>
<span id="cb222-415"><a href="non-linear-least-squares-estimation.html#cb222-415" tabindex="-1"></a>  out<span class="sc">$</span>optim<span class="sc">$</span>bestmem</span>
<span id="cb222-416"><a href="non-linear-least-squares-estimation.html#cb222-416" tabindex="-1"></a>}</span>
<span id="cb222-417"><a href="non-linear-least-squares-estimation.html#cb222-417" tabindex="-1"></a></span>
<span id="cb222-418"><a href="non-linear-least-squares-estimation.html#cb222-418" tabindex="-1"></a><span class="co"># 2.14 Simulated Annealing (GenSA)</span></span>
<span id="cb222-419"><a href="non-linear-least-squares-estimation.html#cb222-419" tabindex="-1"></a>sim_anneal_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-420"><a href="non-linear-least-squares-estimation.html#cb222-420" tabindex="-1"></a>                           x,</span>
<span id="cb222-421"><a href="non-linear-least-squares-estimation.html#cb222-421" tabindex="-1"></a>                           y,</span>
<span id="cb222-422"><a href="non-linear-least-squares-estimation.html#cb222-422" tabindex="-1"></a>                           sse_fn,</span>
<span id="cb222-423"><a href="non-linear-least-squares-estimation.html#cb222-423" tabindex="-1"></a>                           model_fn,</span>
<span id="cb222-424"><a href="non-linear-least-squares-estimation.html#cb222-424" tabindex="-1"></a>                           <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-425"><a href="non-linear-least-squares-estimation.html#cb222-425" tabindex="-1"></a>                           <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-426"><a href="non-linear-least-squares-estimation.html#cb222-426" tabindex="-1"></a>                           ...)</span>
<span id="cb222-427"><a href="non-linear-least-squares-estimation.html#cb222-427" tabindex="-1"></a>{</span>
<span id="cb222-428"><a href="non-linear-least-squares-estimation.html#cb222-428" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-429"><a href="non-linear-least-squares-estimation.html#cb222-429" tabindex="-1"></a>    <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-430"><a href="non-linear-least-squares-estimation.html#cb222-430" tabindex="-1"></a>  lb <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(lower))</span>
<span id="cb222-431"><a href="non-linear-least-squares-estimation.html#cb222-431" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fu">length</span>(par))</span>
<span id="cb222-432"><a href="non-linear-least-squares-estimation.html#cb222-432" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb222-433"><a href="non-linear-least-squares-estimation.html#cb222-433" tabindex="-1"></a>    lower</span>
<span id="cb222-434"><a href="non-linear-least-squares-estimation.html#cb222-434" tabindex="-1"></a>  ub <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.null</span>(upper))</span>
<span id="cb222-435"><a href="non-linear-least-squares-estimation.html#cb222-435" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">Inf</span>, <span class="fu">length</span>(par))</span>
<span id="cb222-436"><a href="non-linear-least-squares-estimation.html#cb222-436" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb222-437"><a href="non-linear-least-squares-estimation.html#cb222-437" tabindex="-1"></a>    upper</span>
<span id="cb222-438"><a href="non-linear-least-squares-estimation.html#cb222-438" tabindex="-1"></a>  <span class="co"># GenSA requires: GenSA(par, fn, lower, upper, control=list(...))</span></span>
<span id="cb222-439"><a href="non-linear-least-squares-estimation.html#cb222-439" tabindex="-1"></a>  out <span class="ot">&lt;-</span></span>
<span id="cb222-440"><a href="non-linear-least-squares-estimation.html#cb222-440" tabindex="-1"></a>    <span class="fu">GenSA</span>(</span>
<span id="cb222-441"><a href="non-linear-least-squares-estimation.html#cb222-441" tabindex="-1"></a>      par,</span>
<span id="cb222-442"><a href="non-linear-least-squares-estimation.html#cb222-442" tabindex="-1"></a>      fn,</span>
<span id="cb222-443"><a href="non-linear-least-squares-estimation.html#cb222-443" tabindex="-1"></a>      <span class="at">lower =</span> lb,</span>
<span id="cb222-444"><a href="non-linear-least-squares-estimation.html#cb222-444" tabindex="-1"></a>      <span class="at">upper =</span> ub,</span>
<span id="cb222-445"><a href="non-linear-least-squares-estimation.html#cb222-445" tabindex="-1"></a>      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">max.call =</span> <span class="dv">10000</span>)</span>
<span id="cb222-446"><a href="non-linear-least-squares-estimation.html#cb222-446" tabindex="-1"></a>    )</span>
<span id="cb222-447"><a href="non-linear-least-squares-estimation.html#cb222-447" tabindex="-1"></a>  out<span class="sc">$</span>par</span>
<span id="cb222-448"><a href="non-linear-least-squares-estimation.html#cb222-448" tabindex="-1"></a>}</span>
<span id="cb222-449"><a href="non-linear-least-squares-estimation.html#cb222-449" tabindex="-1"></a></span>
<span id="cb222-450"><a href="non-linear-least-squares-estimation.html#cb222-450" tabindex="-1"></a><span class="co"># 2.15 Genetic Algorithm (GA)</span></span>
<span id="cb222-451"><a href="non-linear-least-squares-estimation.html#cb222-451" tabindex="-1"></a>genetic_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-452"><a href="non-linear-least-squares-estimation.html#cb222-452" tabindex="-1"></a>                        x,</span>
<span id="cb222-453"><a href="non-linear-least-squares-estimation.html#cb222-453" tabindex="-1"></a>                        y,</span>
<span id="cb222-454"><a href="non-linear-least-squares-estimation.html#cb222-454" tabindex="-1"></a>                        sse_fn,</span>
<span id="cb222-455"><a href="non-linear-least-squares-estimation.html#cb222-455" tabindex="-1"></a>                        model_fn,</span>
<span id="cb222-456"><a href="non-linear-least-squares-estimation.html#cb222-456" tabindex="-1"></a>                        lower,</span>
<span id="cb222-457"><a href="non-linear-least-squares-estimation.html#cb222-457" tabindex="-1"></a>                        upper,</span>
<span id="cb222-458"><a href="non-linear-least-squares-estimation.html#cb222-458" tabindex="-1"></a>                        <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb222-459"><a href="non-linear-least-squares-estimation.html#cb222-459" tabindex="-1"></a>                        ...)</span>
<span id="cb222-460"><a href="non-linear-least-squares-estimation.html#cb222-460" tabindex="-1"></a>{</span>
<span id="cb222-461"><a href="non-linear-least-squares-estimation.html#cb222-461" tabindex="-1"></a>  fitness_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-462"><a href="non-linear-least-squares-estimation.html#cb222-462" tabindex="-1"></a>    <span class="sc">-</span> <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-463"><a href="non-linear-least-squares-estimation.html#cb222-463" tabindex="-1"></a>  gares <span class="ot">&lt;-</span> <span class="fu">ga</span>(</span>
<span id="cb222-464"><a href="non-linear-least-squares-estimation.html#cb222-464" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;real-valued&quot;</span>,</span>
<span id="cb222-465"><a href="non-linear-least-squares-estimation.html#cb222-465" tabindex="-1"></a>    <span class="at">fitness =</span> fitness_fun,</span>
<span id="cb222-466"><a href="non-linear-least-squares-estimation.html#cb222-466" tabindex="-1"></a>    <span class="at">lower =</span> lower,</span>
<span id="cb222-467"><a href="non-linear-least-squares-estimation.html#cb222-467" tabindex="-1"></a>    <span class="at">upper =</span> upper,</span>
<span id="cb222-468"><a href="non-linear-least-squares-estimation.html#cb222-468" tabindex="-1"></a>    <span class="at">popSize =</span> <span class="dv">50</span>,</span>
<span id="cb222-469"><a href="non-linear-least-squares-estimation.html#cb222-469" tabindex="-1"></a>    <span class="at">maxiter =</span> max_iter,</span>
<span id="cb222-470"><a href="non-linear-least-squares-estimation.html#cb222-470" tabindex="-1"></a>    <span class="at">run =</span> <span class="dv">50</span></span>
<span id="cb222-471"><a href="non-linear-least-squares-estimation.html#cb222-471" tabindex="-1"></a>  )</span>
<span id="cb222-472"><a href="non-linear-least-squares-estimation.html#cb222-472" tabindex="-1"></a>  gares<span class="sc">@</span>solution[<span class="dv">1</span>,]</span>
<span id="cb222-473"><a href="non-linear-least-squares-estimation.html#cb222-473" tabindex="-1"></a>}</span>
<span id="cb222-474"><a href="non-linear-least-squares-estimation.html#cb222-474" tabindex="-1"></a></span>
<span id="cb222-475"><a href="non-linear-least-squares-estimation.html#cb222-475" tabindex="-1"></a><span class="co"># 2.16 Particle Swarm (pso)</span></span>
<span id="cb222-476"><a href="non-linear-least-squares-estimation.html#cb222-476" tabindex="-1"></a>particle_swarm_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(par,</span>
<span id="cb222-477"><a href="non-linear-least-squares-estimation.html#cb222-477" tabindex="-1"></a>                               x,</span>
<span id="cb222-478"><a href="non-linear-least-squares-estimation.html#cb222-478" tabindex="-1"></a>                               y,</span>
<span id="cb222-479"><a href="non-linear-least-squares-estimation.html#cb222-479" tabindex="-1"></a>                               sse_fn,</span>
<span id="cb222-480"><a href="non-linear-least-squares-estimation.html#cb222-480" tabindex="-1"></a>                               model_fn,</span>
<span id="cb222-481"><a href="non-linear-least-squares-estimation.html#cb222-481" tabindex="-1"></a>                               lower,</span>
<span id="cb222-482"><a href="non-linear-least-squares-estimation.html#cb222-482" tabindex="-1"></a>                               upper,</span>
<span id="cb222-483"><a href="non-linear-least-squares-estimation.html#cb222-483" tabindex="-1"></a>                               <span class="at">max_iter =</span> <span class="dv">100</span>,</span>
<span id="cb222-484"><a href="non-linear-least-squares-estimation.html#cb222-484" tabindex="-1"></a>                               ...)</span>
<span id="cb222-485"><a href="non-linear-least-squares-estimation.html#cb222-485" tabindex="-1"></a>{</span>
<span id="cb222-486"><a href="non-linear-least-squares-estimation.html#cb222-486" tabindex="-1"></a>  fn <span class="ot">&lt;-</span> <span class="cf">function</span>(pp)</span>
<span id="cb222-487"><a href="non-linear-least-squares-estimation.html#cb222-487" tabindex="-1"></a>    <span class="fu">sse_fn</span>(pp, x, y)</span>
<span id="cb222-488"><a href="non-linear-least-squares-estimation.html#cb222-488" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">psoptim</span>(</span>
<span id="cb222-489"><a href="non-linear-least-squares-estimation.html#cb222-489" tabindex="-1"></a>    <span class="at">par =</span> (lower <span class="sc">+</span> upper) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb222-490"><a href="non-linear-least-squares-estimation.html#cb222-490" tabindex="-1"></a>    <span class="at">fn =</span> fn,</span>
<span id="cb222-491"><a href="non-linear-least-squares-estimation.html#cb222-491" tabindex="-1"></a>    <span class="at">lower =</span> lower,</span>
<span id="cb222-492"><a href="non-linear-least-squares-estimation.html#cb222-492" tabindex="-1"></a>    <span class="at">upper =</span> upper,</span>
<span id="cb222-493"><a href="non-linear-least-squares-estimation.html#cb222-493" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">maxit =</span> max_iter)</span>
<span id="cb222-494"><a href="non-linear-least-squares-estimation.html#cb222-494" tabindex="-1"></a>  )</span>
<span id="cb222-495"><a href="non-linear-least-squares-estimation.html#cb222-495" tabindex="-1"></a>  res<span class="sc">$</span>par</span>
<span id="cb222-496"><a href="non-linear-least-squares-estimation.html#cb222-496" tabindex="-1"></a>}</span>
<span id="cb222-497"><a href="non-linear-least-squares-estimation.html#cb222-497" tabindex="-1"></a></span>
<span id="cb222-498"><a href="non-linear-least-squares-estimation.html#cb222-498" tabindex="-1"></a></span>
<span id="cb222-499"><a href="non-linear-least-squares-estimation.html#cb222-499" tabindex="-1"></a><span class="co"># -- 3) RUN METHOD WRAPPER ---</span></span>
<span id="cb222-500"><a href="non-linear-least-squares-estimation.html#cb222-500" tabindex="-1"></a>run_method <span class="ot">&lt;-</span> <span class="cf">function</span>(method_name,</span>
<span id="cb222-501"><a href="non-linear-least-squares-estimation.html#cb222-501" tabindex="-1"></a>                       FUN,</span>
<span id="cb222-502"><a href="non-linear-least-squares-estimation.html#cb222-502" tabindex="-1"></a>                       par_init,</span>
<span id="cb222-503"><a href="non-linear-least-squares-estimation.html#cb222-503" tabindex="-1"></a>                       x,</span>
<span id="cb222-504"><a href="non-linear-least-squares-estimation.html#cb222-504" tabindex="-1"></a>                       y,</span>
<span id="cb222-505"><a href="non-linear-least-squares-estimation.html#cb222-505" tabindex="-1"></a>                       sse_fn,</span>
<span id="cb222-506"><a href="non-linear-least-squares-estimation.html#cb222-506" tabindex="-1"></a>                       model_fn,</span>
<span id="cb222-507"><a href="non-linear-least-squares-estimation.html#cb222-507" tabindex="-1"></a>                       <span class="at">lower =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-508"><a href="non-linear-least-squares-estimation.html#cb222-508" tabindex="-1"></a>                       <span class="at">upper =</span> <span class="cn">NULL</span>,</span>
<span id="cb222-509"><a href="non-linear-least-squares-estimation.html#cb222-509" tabindex="-1"></a>                       ...)</span>
<span id="cb222-510"><a href="non-linear-least-squares-estimation.html#cb222-510" tabindex="-1"></a>{</span>
<span id="cb222-511"><a href="non-linear-least-squares-estimation.html#cb222-511" tabindex="-1"></a>  mb <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">result =</span> {</span>
<span id="cb222-512"><a href="non-linear-least-squares-estimation.html#cb222-512" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">FUN</span>(par_init, x, y, sse_fn, model_fn, lower, upper, ...)</span>
<span id="cb222-513"><a href="non-linear-least-squares-estimation.html#cb222-513" tabindex="-1"></a>    out</span>
<span id="cb222-514"><a href="non-linear-least-squares-estimation.html#cb222-514" tabindex="-1"></a>  }, <span class="at">times =</span> <span class="dv">1</span>)</span>
<span id="cb222-515"><a href="non-linear-least-squares-estimation.html#cb222-515" tabindex="-1"></a>  final_par <span class="ot">&lt;-</span></span>
<span id="cb222-516"><a href="non-linear-least-squares-estimation.html#cb222-516" tabindex="-1"></a>    <span class="fu">FUN</span>(par_init, x, y, sse_fn, model_fn, lower, upper, ...)</span>
<span id="cb222-517"><a href="non-linear-least-squares-estimation.html#cb222-517" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(final_par)) {</span>
<span id="cb222-518"><a href="non-linear-least-squares-estimation.html#cb222-518" tabindex="-1"></a>    <span class="co"># e.g. placeholders that return NULL</span></span>
<span id="cb222-519"><a href="non-linear-least-squares-estimation.html#cb222-519" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb222-520"><a href="non-linear-least-squares-estimation.html#cb222-520" tabindex="-1"></a>      <span class="at">Method =</span> method_name,</span>
<span id="cb222-521"><a href="non-linear-least-squares-estimation.html#cb222-521" tabindex="-1"></a>      <span class="at">Parameters =</span> <span class="st">&quot;N/A&quot;</span>,</span>
<span id="cb222-522"><a href="non-linear-least-squares-estimation.html#cb222-522" tabindex="-1"></a>      <span class="at">SSE =</span> <span class="cn">NA</span>,</span>
<span id="cb222-523"><a href="non-linear-least-squares-estimation.html#cb222-523" tabindex="-1"></a>      <span class="at">Time_ms =</span> <span class="cn">NA</span></span>
<span id="cb222-524"><a href="non-linear-least-squares-estimation.html#cb222-524" tabindex="-1"></a>    ))</span>
<span id="cb222-525"><a href="non-linear-least-squares-estimation.html#cb222-525" tabindex="-1"></a>  }</span>
<span id="cb222-526"><a href="non-linear-least-squares-estimation.html#cb222-526" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb222-527"><a href="non-linear-least-squares-estimation.html#cb222-527" tabindex="-1"></a>    <span class="at">Method     =</span> method_name,</span>
<span id="cb222-528"><a href="non-linear-least-squares-estimation.html#cb222-528" tabindex="-1"></a>    <span class="at">Parameters =</span> <span class="fu">paste</span>(<span class="fu">round</span>(final_par, <span class="dv">4</span>), <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>),</span>
<span id="cb222-529"><a href="non-linear-least-squares-estimation.html#cb222-529" tabindex="-1"></a>    <span class="at">SSE        =</span> <span class="fu">round</span>(<span class="fu">sse_fn</span>(final_par, x, y), <span class="dv">6</span>),</span>
<span id="cb222-530"><a href="non-linear-least-squares-estimation.html#cb222-530" tabindex="-1"></a>    <span class="at">Time_ms    =</span> <span class="fu">median</span>(mb<span class="sc">$</span>time) <span class="sc">/</span> <span class="fl">1e6</span></span>
<span id="cb222-531"><a href="non-linear-least-squares-estimation.html#cb222-531" tabindex="-1"></a>  )</span>
<span id="cb222-532"><a href="non-linear-least-squares-estimation.html#cb222-532" tabindex="-1"></a>}</span>
<span id="cb222-533"><a href="non-linear-least-squares-estimation.html#cb222-533" tabindex="-1"></a></span>
<span id="cb222-534"><a href="non-linear-least-squares-estimation.html#cb222-534" tabindex="-1"></a><span class="co"># -- 4) MASTER FUNCTION TO COMPARE ALL METHODS (SIMPLE / COMPLEX) ---</span></span>
<span id="cb222-535"><a href="non-linear-least-squares-estimation.html#cb222-535" tabindex="-1"></a></span>
<span id="cb222-536"><a href="non-linear-least-squares-estimation.html#cb222-536" tabindex="-1"></a>compare_all_methods <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">is_complex =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb222-537"><a href="non-linear-least-squares-estimation.html#cb222-537" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>is_complex) {</span>
<span id="cb222-538"><a href="non-linear-least-squares-estimation.html#cb222-538" tabindex="-1"></a>    <span class="co"># SIMPLE (3-param logistic)</span></span>
<span id="cb222-539"><a href="non-linear-least-squares-estimation.html#cb222-539" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_data</span>
<span id="cb222-540"><a href="non-linear-least-squares-estimation.html#cb222-540" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_data_simple</span>
<span id="cb222-541"><a href="non-linear-least-squares-estimation.html#cb222-541" tabindex="-1"></a>    sse_fn   <span class="ot">&lt;-</span> sse_logistic</span>
<span id="cb222-542"><a href="non-linear-least-squares-estimation.html#cb222-542" tabindex="-1"></a>    model_fn <span class="ot">&lt;-</span> f_logistic</span>
<span id="cb222-543"><a href="non-linear-least-squares-estimation.html#cb222-543" tabindex="-1"></a>    init_par <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb222-544"><a href="non-linear-least-squares-estimation.html#cb222-544" tabindex="-1"></a>    grid_defs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb222-545"><a href="non-linear-least-squares-estimation.html#cb222-545" tabindex="-1"></a>      <span class="at">A =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">10</span>),</span>
<span id="cb222-546"><a href="non-linear-least-squares-estimation.html#cb222-546" tabindex="-1"></a>      <span class="at">B =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">10</span>),</span>
<span id="cb222-547"><a href="non-linear-least-squares-estimation.html#cb222-547" tabindex="-1"></a>      <span class="at">C =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb222-548"><a href="non-linear-least-squares-estimation.html#cb222-548" tabindex="-1"></a>    )</span>
<span id="cb222-549"><a href="non-linear-least-squares-estimation.html#cb222-549" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>,<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb222-550"><a href="non-linear-least-squares-estimation.html#cb222-550" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">3</span>,  <span class="dv">3</span>)</span>
<span id="cb222-551"><a href="non-linear-least-squares-estimation.html#cb222-551" tabindex="-1"></a>    lm_form <span class="ot">&lt;-</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb222-552"><a href="non-linear-least-squares-estimation.html#cb222-552" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb222-553"><a href="non-linear-least-squares-estimation.html#cb222-553" tabindex="-1"></a>    <span class="co"># COMPLEX (4-param model)</span></span>
<span id="cb222-554"><a href="non-linear-least-squares-estimation.html#cb222-554" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x_data</span>
<span id="cb222-555"><a href="non-linear-least-squares-estimation.html#cb222-555" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y_data_complex</span>
<span id="cb222-556"><a href="non-linear-least-squares-estimation.html#cb222-556" tabindex="-1"></a>    sse_fn   <span class="ot">&lt;-</span> sse_complex</span>
<span id="cb222-557"><a href="non-linear-least-squares-estimation.html#cb222-557" tabindex="-1"></a>    model_fn <span class="ot">&lt;-</span> f_complex</span>
<span id="cb222-558"><a href="non-linear-least-squares-estimation.html#cb222-558" tabindex="-1"></a>    init_par <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span>)</span>
<span id="cb222-559"><a href="non-linear-least-squares-estimation.html#cb222-559" tabindex="-1"></a>    grid_defs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb222-560"><a href="non-linear-least-squares-estimation.html#cb222-560" tabindex="-1"></a>      <span class="at">A =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">8</span>),</span>
<span id="cb222-561"><a href="non-linear-least-squares-estimation.html#cb222-561" tabindex="-1"></a>      <span class="at">B =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">8</span>),</span>
<span id="cb222-562"><a href="non-linear-least-squares-estimation.html#cb222-562" tabindex="-1"></a>      <span class="at">C =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">8</span>),</span>
<span id="cb222-563"><a href="non-linear-least-squares-estimation.html#cb222-563" tabindex="-1"></a>      <span class="at">D =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">8</span>)</span>
<span id="cb222-564"><a href="non-linear-least-squares-estimation.html#cb222-564" tabindex="-1"></a>    )</span>
<span id="cb222-565"><a href="non-linear-least-squares-estimation.html#cb222-565" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>,<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>)</span>
<span id="cb222-566"><a href="non-linear-least-squares-estimation.html#cb222-566" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">3</span>,  <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb222-567"><a href="non-linear-least-squares-estimation.html#cb222-567" tabindex="-1"></a>    lm_form <span class="ot">&lt;-</span> <span class="st">&quot;complex&quot;</span></span>
<span id="cb222-568"><a href="non-linear-least-squares-estimation.html#cb222-568" tabindex="-1"></a>  }</span>
<span id="cb222-569"><a href="non-linear-least-squares-estimation.html#cb222-569" tabindex="-1"></a>  </span>
<span id="cb222-570"><a href="non-linear-least-squares-estimation.html#cb222-570" tabindex="-1"></a>  <span class="co"># RUN each method</span></span>
<span id="cb222-571"><a href="non-linear-least-squares-estimation.html#cb222-571" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb222-572"><a href="non-linear-least-squares-estimation.html#cb222-572" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-573"><a href="non-linear-least-squares-estimation.html#cb222-573" tabindex="-1"></a>      <span class="st">&quot;Gauss-Newton&quot;</span>,</span>
<span id="cb222-574"><a href="non-linear-least-squares-estimation.html#cb222-574" tabindex="-1"></a>      gauss_newton_fit,</span>
<span id="cb222-575"><a href="non-linear-least-squares-estimation.html#cb222-575" tabindex="-1"></a>      init_par,</span>
<span id="cb222-576"><a href="non-linear-least-squares-estimation.html#cb222-576" tabindex="-1"></a>      x,</span>
<span id="cb222-577"><a href="non-linear-least-squares-estimation.html#cb222-577" tabindex="-1"></a>      y,</span>
<span id="cb222-578"><a href="non-linear-least-squares-estimation.html#cb222-578" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-579"><a href="non-linear-least-squares-estimation.html#cb222-579" tabindex="-1"></a>      model_fn</span>
<span id="cb222-580"><a href="non-linear-least-squares-estimation.html#cb222-580" tabindex="-1"></a>    ),</span>
<span id="cb222-581"><a href="non-linear-least-squares-estimation.html#cb222-581" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-582"><a href="non-linear-least-squares-estimation.html#cb222-582" tabindex="-1"></a>      <span class="st">&quot;Modified Gauss-Newton&quot;</span>,</span>
<span id="cb222-583"><a href="non-linear-least-squares-estimation.html#cb222-583" tabindex="-1"></a>      modified_gauss_newton_fit,</span>
<span id="cb222-584"><a href="non-linear-least-squares-estimation.html#cb222-584" tabindex="-1"></a>      init_par,</span>
<span id="cb222-585"><a href="non-linear-least-squares-estimation.html#cb222-585" tabindex="-1"></a>      x,</span>
<span id="cb222-586"><a href="non-linear-least-squares-estimation.html#cb222-586" tabindex="-1"></a>      y,</span>
<span id="cb222-587"><a href="non-linear-least-squares-estimation.html#cb222-587" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-588"><a href="non-linear-least-squares-estimation.html#cb222-588" tabindex="-1"></a>      model_fn</span>
<span id="cb222-589"><a href="non-linear-least-squares-estimation.html#cb222-589" tabindex="-1"></a>    ),</span>
<span id="cb222-590"><a href="non-linear-least-squares-estimation.html#cb222-590" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-591"><a href="non-linear-least-squares-estimation.html#cb222-591" tabindex="-1"></a>      <span class="st">&quot;Steepest Descent&quot;</span>,</span>
<span id="cb222-592"><a href="non-linear-least-squares-estimation.html#cb222-592" tabindex="-1"></a>      steepest_descent_fit,</span>
<span id="cb222-593"><a href="non-linear-least-squares-estimation.html#cb222-593" tabindex="-1"></a>      init_par,</span>
<span id="cb222-594"><a href="non-linear-least-squares-estimation.html#cb222-594" tabindex="-1"></a>      x,</span>
<span id="cb222-595"><a href="non-linear-least-squares-estimation.html#cb222-595" tabindex="-1"></a>      y,</span>
<span id="cb222-596"><a href="non-linear-least-squares-estimation.html#cb222-596" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-597"><a href="non-linear-least-squares-estimation.html#cb222-597" tabindex="-1"></a>      model_fn</span>
<span id="cb222-598"><a href="non-linear-least-squares-estimation.html#cb222-598" tabindex="-1"></a>    ),</span>
<span id="cb222-599"><a href="non-linear-least-squares-estimation.html#cb222-599" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-600"><a href="non-linear-least-squares-estimation.html#cb222-600" tabindex="-1"></a>      <span class="st">&quot;Levenberg-Marquardt (nlsLM)&quot;</span>,</span>
<span id="cb222-601"><a href="non-linear-least-squares-estimation.html#cb222-601" tabindex="-1"></a>      lm_fit,</span>
<span id="cb222-602"><a href="non-linear-least-squares-estimation.html#cb222-602" tabindex="-1"></a>      init_par,</span>
<span id="cb222-603"><a href="non-linear-least-squares-estimation.html#cb222-603" tabindex="-1"></a>      x,</span>
<span id="cb222-604"><a href="non-linear-least-squares-estimation.html#cb222-604" tabindex="-1"></a>      y,</span>
<span id="cb222-605"><a href="non-linear-least-squares-estimation.html#cb222-605" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-606"><a href="non-linear-least-squares-estimation.html#cb222-606" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-607"><a href="non-linear-least-squares-estimation.html#cb222-607" tabindex="-1"></a>      <span class="at">form =</span> lm_form</span>
<span id="cb222-608"><a href="non-linear-least-squares-estimation.html#cb222-608" tabindex="-1"></a>    ),</span>
<span id="cb222-609"><a href="non-linear-least-squares-estimation.html#cb222-609" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-610"><a href="non-linear-least-squares-estimation.html#cb222-610" tabindex="-1"></a>      <span class="st">&quot;Newton-Raphson&quot;</span>,</span>
<span id="cb222-611"><a href="non-linear-least-squares-estimation.html#cb222-611" tabindex="-1"></a>      newton_raphson_fit,</span>
<span id="cb222-612"><a href="non-linear-least-squares-estimation.html#cb222-612" tabindex="-1"></a>      init_par,</span>
<span id="cb222-613"><a href="non-linear-least-squares-estimation.html#cb222-613" tabindex="-1"></a>      x,</span>
<span id="cb222-614"><a href="non-linear-least-squares-estimation.html#cb222-614" tabindex="-1"></a>      y,</span>
<span id="cb222-615"><a href="non-linear-least-squares-estimation.html#cb222-615" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-616"><a href="non-linear-least-squares-estimation.html#cb222-616" tabindex="-1"></a>      model_fn</span>
<span id="cb222-617"><a href="non-linear-least-squares-estimation.html#cb222-617" tabindex="-1"></a>    ),</span>
<span id="cb222-618"><a href="non-linear-least-squares-estimation.html#cb222-618" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-619"><a href="non-linear-least-squares-estimation.html#cb222-619" tabindex="-1"></a>      <span class="st">&quot;Quasi-Newton (BFGS)&quot;</span>,</span>
<span id="cb222-620"><a href="non-linear-least-squares-estimation.html#cb222-620" tabindex="-1"></a>      quasi_newton_fit,</span>
<span id="cb222-621"><a href="non-linear-least-squares-estimation.html#cb222-621" tabindex="-1"></a>      init_par,</span>
<span id="cb222-622"><a href="non-linear-least-squares-estimation.html#cb222-622" tabindex="-1"></a>      x,</span>
<span id="cb222-623"><a href="non-linear-least-squares-estimation.html#cb222-623" tabindex="-1"></a>      y,</span>
<span id="cb222-624"><a href="non-linear-least-squares-estimation.html#cb222-624" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-625"><a href="non-linear-least-squares-estimation.html#cb222-625" tabindex="-1"></a>      model_fn</span>
<span id="cb222-626"><a href="non-linear-least-squares-estimation.html#cb222-626" tabindex="-1"></a>    ),</span>
<span id="cb222-627"><a href="non-linear-least-squares-estimation.html#cb222-627" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-628"><a href="non-linear-least-squares-estimation.html#cb222-628" tabindex="-1"></a>      <span class="st">&quot;Trust-region Reflective&quot;</span>,</span>
<span id="cb222-629"><a href="non-linear-least-squares-estimation.html#cb222-629" tabindex="-1"></a>      trust_region_fit,</span>
<span id="cb222-630"><a href="non-linear-least-squares-estimation.html#cb222-630" tabindex="-1"></a>      init_par,</span>
<span id="cb222-631"><a href="non-linear-least-squares-estimation.html#cb222-631" tabindex="-1"></a>      x,</span>
<span id="cb222-632"><a href="non-linear-least-squares-estimation.html#cb222-632" tabindex="-1"></a>      y,</span>
<span id="cb222-633"><a href="non-linear-least-squares-estimation.html#cb222-633" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-634"><a href="non-linear-least-squares-estimation.html#cb222-634" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-635"><a href="non-linear-least-squares-estimation.html#cb222-635" tabindex="-1"></a>      lower,</span>
<span id="cb222-636"><a href="non-linear-least-squares-estimation.html#cb222-636" tabindex="-1"></a>      upper</span>
<span id="cb222-637"><a href="non-linear-least-squares-estimation.html#cb222-637" tabindex="-1"></a>    ),</span>
<span id="cb222-638"><a href="non-linear-least-squares-estimation.html#cb222-638" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-639"><a href="non-linear-least-squares-estimation.html#cb222-639" tabindex="-1"></a>      <span class="st">&quot;Grid Search&quot;</span>,</span>
<span id="cb222-640"><a href="non-linear-least-squares-estimation.html#cb222-640" tabindex="-1"></a>      grid_search_fit,</span>
<span id="cb222-641"><a href="non-linear-least-squares-estimation.html#cb222-641" tabindex="-1"></a>      <span class="cn">NULL</span>,</span>
<span id="cb222-642"><a href="non-linear-least-squares-estimation.html#cb222-642" tabindex="-1"></a>      x,</span>
<span id="cb222-643"><a href="non-linear-least-squares-estimation.html#cb222-643" tabindex="-1"></a>      y,</span>
<span id="cb222-644"><a href="non-linear-least-squares-estimation.html#cb222-644" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-645"><a href="non-linear-least-squares-estimation.html#cb222-645" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-646"><a href="non-linear-least-squares-estimation.html#cb222-646" tabindex="-1"></a>      <span class="at">grid_defs =</span> grid_defs</span>
<span id="cb222-647"><a href="non-linear-least-squares-estimation.html#cb222-647" tabindex="-1"></a>    ),</span>
<span id="cb222-648"><a href="non-linear-least-squares-estimation.html#cb222-648" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-649"><a href="non-linear-least-squares-estimation.html#cb222-649" tabindex="-1"></a>      <span class="st">&quot;Nelder-Mead&quot;</span>,</span>
<span id="cb222-650"><a href="non-linear-least-squares-estimation.html#cb222-650" tabindex="-1"></a>      nelder_mead_fit,</span>
<span id="cb222-651"><a href="non-linear-least-squares-estimation.html#cb222-651" tabindex="-1"></a>      init_par,</span>
<span id="cb222-652"><a href="non-linear-least-squares-estimation.html#cb222-652" tabindex="-1"></a>      x,</span>
<span id="cb222-653"><a href="non-linear-least-squares-estimation.html#cb222-653" tabindex="-1"></a>      y,</span>
<span id="cb222-654"><a href="non-linear-least-squares-estimation.html#cb222-654" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-655"><a href="non-linear-least-squares-estimation.html#cb222-655" tabindex="-1"></a>      model_fn</span>
<span id="cb222-656"><a href="non-linear-least-squares-estimation.html#cb222-656" tabindex="-1"></a>    ),</span>
<span id="cb222-657"><a href="non-linear-least-squares-estimation.html#cb222-657" tabindex="-1"></a>    <span class="fu">run_method</span>(<span class="st">&quot;Powell&#39;s method&quot;</span>,</span>
<span id="cb222-658"><a href="non-linear-least-squares-estimation.html#cb222-658" tabindex="-1"></a>               powell_fit,</span>
<span id="cb222-659"><a href="non-linear-least-squares-estimation.html#cb222-659" tabindex="-1"></a>               init_par,</span>
<span id="cb222-660"><a href="non-linear-least-squares-estimation.html#cb222-660" tabindex="-1"></a>               x,</span>
<span id="cb222-661"><a href="non-linear-least-squares-estimation.html#cb222-661" tabindex="-1"></a>               y,</span>
<span id="cb222-662"><a href="non-linear-least-squares-estimation.html#cb222-662" tabindex="-1"></a>               sse_fn,</span>
<span id="cb222-663"><a href="non-linear-least-squares-estimation.html#cb222-663" tabindex="-1"></a>               model_fn),</span>
<span id="cb222-664"><a href="non-linear-least-squares-estimation.html#cb222-664" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-665"><a href="non-linear-least-squares-estimation.html#cb222-665" tabindex="-1"></a>      <span class="st">&quot;Hooke-Jeeves&quot;</span>,</span>
<span id="cb222-666"><a href="non-linear-least-squares-estimation.html#cb222-666" tabindex="-1"></a>      hooke_jeeves_fit,</span>
<span id="cb222-667"><a href="non-linear-least-squares-estimation.html#cb222-667" tabindex="-1"></a>      init_par,</span>
<span id="cb222-668"><a href="non-linear-least-squares-estimation.html#cb222-668" tabindex="-1"></a>      x,</span>
<span id="cb222-669"><a href="non-linear-least-squares-estimation.html#cb222-669" tabindex="-1"></a>      y,</span>
<span id="cb222-670"><a href="non-linear-least-squares-estimation.html#cb222-670" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-671"><a href="non-linear-least-squares-estimation.html#cb222-671" tabindex="-1"></a>      model_fn</span>
<span id="cb222-672"><a href="non-linear-least-squares-estimation.html#cb222-672" tabindex="-1"></a>    ),</span>
<span id="cb222-673"><a href="non-linear-least-squares-estimation.html#cb222-673" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-674"><a href="non-linear-least-squares-estimation.html#cb222-674" tabindex="-1"></a>      <span class="st">&quot;Random Search&quot;</span>,</span>
<span id="cb222-675"><a href="non-linear-least-squares-estimation.html#cb222-675" tabindex="-1"></a>      random_search_fit,</span>
<span id="cb222-676"><a href="non-linear-least-squares-estimation.html#cb222-676" tabindex="-1"></a>      <span class="cn">NULL</span>,</span>
<span id="cb222-677"><a href="non-linear-least-squares-estimation.html#cb222-677" tabindex="-1"></a>      x,</span>
<span id="cb222-678"><a href="non-linear-least-squares-estimation.html#cb222-678" tabindex="-1"></a>      y,</span>
<span id="cb222-679"><a href="non-linear-least-squares-estimation.html#cb222-679" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-680"><a href="non-linear-least-squares-estimation.html#cb222-680" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-681"><a href="non-linear-least-squares-estimation.html#cb222-681" tabindex="-1"></a>      lower,</span>
<span id="cb222-682"><a href="non-linear-least-squares-estimation.html#cb222-682" tabindex="-1"></a>      upper,</span>
<span id="cb222-683"><a href="non-linear-least-squares-estimation.html#cb222-683" tabindex="-1"></a>      <span class="at">max_iter =</span> <span class="dv">1000</span></span>
<span id="cb222-684"><a href="non-linear-least-squares-estimation.html#cb222-684" tabindex="-1"></a>    ),</span>
<span id="cb222-685"><a href="non-linear-least-squares-estimation.html#cb222-685" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-686"><a href="non-linear-least-squares-estimation.html#cb222-686" tabindex="-1"></a>      <span class="st">&quot;Differential Evolution&quot;</span>,</span>
<span id="cb222-687"><a href="non-linear-least-squares-estimation.html#cb222-687" tabindex="-1"></a>      diff_evo_fit,</span>
<span id="cb222-688"><a href="non-linear-least-squares-estimation.html#cb222-688" tabindex="-1"></a>      <span class="cn">NULL</span>,</span>
<span id="cb222-689"><a href="non-linear-least-squares-estimation.html#cb222-689" tabindex="-1"></a>      x,</span>
<span id="cb222-690"><a href="non-linear-least-squares-estimation.html#cb222-690" tabindex="-1"></a>      y,</span>
<span id="cb222-691"><a href="non-linear-least-squares-estimation.html#cb222-691" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-692"><a href="non-linear-least-squares-estimation.html#cb222-692" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-693"><a href="non-linear-least-squares-estimation.html#cb222-693" tabindex="-1"></a>      lower,</span>
<span id="cb222-694"><a href="non-linear-least-squares-estimation.html#cb222-694" tabindex="-1"></a>      upper,</span>
<span id="cb222-695"><a href="non-linear-least-squares-estimation.html#cb222-695" tabindex="-1"></a>      <span class="at">max_iter =</span> <span class="dv">50</span></span>
<span id="cb222-696"><a href="non-linear-least-squares-estimation.html#cb222-696" tabindex="-1"></a>    ),</span>
<span id="cb222-697"><a href="non-linear-least-squares-estimation.html#cb222-697" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-698"><a href="non-linear-least-squares-estimation.html#cb222-698" tabindex="-1"></a>      <span class="st">&quot;Simulated Annealing&quot;</span>,</span>
<span id="cb222-699"><a href="non-linear-least-squares-estimation.html#cb222-699" tabindex="-1"></a>      sim_anneal_fit,</span>
<span id="cb222-700"><a href="non-linear-least-squares-estimation.html#cb222-700" tabindex="-1"></a>      init_par,</span>
<span id="cb222-701"><a href="non-linear-least-squares-estimation.html#cb222-701" tabindex="-1"></a>      x,</span>
<span id="cb222-702"><a href="non-linear-least-squares-estimation.html#cb222-702" tabindex="-1"></a>      y,</span>
<span id="cb222-703"><a href="non-linear-least-squares-estimation.html#cb222-703" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-704"><a href="non-linear-least-squares-estimation.html#cb222-704" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-705"><a href="non-linear-least-squares-estimation.html#cb222-705" tabindex="-1"></a>      lower,</span>
<span id="cb222-706"><a href="non-linear-least-squares-estimation.html#cb222-706" tabindex="-1"></a>      upper</span>
<span id="cb222-707"><a href="non-linear-least-squares-estimation.html#cb222-707" tabindex="-1"></a>    ),</span>
<span id="cb222-708"><a href="non-linear-least-squares-estimation.html#cb222-708" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-709"><a href="non-linear-least-squares-estimation.html#cb222-709" tabindex="-1"></a>      <span class="st">&quot;Genetic Algorithm&quot;</span>,</span>
<span id="cb222-710"><a href="non-linear-least-squares-estimation.html#cb222-710" tabindex="-1"></a>      genetic_fit,</span>
<span id="cb222-711"><a href="non-linear-least-squares-estimation.html#cb222-711" tabindex="-1"></a>      <span class="cn">NULL</span>,</span>
<span id="cb222-712"><a href="non-linear-least-squares-estimation.html#cb222-712" tabindex="-1"></a>      x,</span>
<span id="cb222-713"><a href="non-linear-least-squares-estimation.html#cb222-713" tabindex="-1"></a>      y,</span>
<span id="cb222-714"><a href="non-linear-least-squares-estimation.html#cb222-714" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-715"><a href="non-linear-least-squares-estimation.html#cb222-715" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-716"><a href="non-linear-least-squares-estimation.html#cb222-716" tabindex="-1"></a>      lower,</span>
<span id="cb222-717"><a href="non-linear-least-squares-estimation.html#cb222-717" tabindex="-1"></a>      upper,</span>
<span id="cb222-718"><a href="non-linear-least-squares-estimation.html#cb222-718" tabindex="-1"></a>      <span class="at">max_iter =</span> <span class="dv">50</span></span>
<span id="cb222-719"><a href="non-linear-least-squares-estimation.html#cb222-719" tabindex="-1"></a>    ),</span>
<span id="cb222-720"><a href="non-linear-least-squares-estimation.html#cb222-720" tabindex="-1"></a>    <span class="fu">run_method</span>(</span>
<span id="cb222-721"><a href="non-linear-least-squares-estimation.html#cb222-721" tabindex="-1"></a>      <span class="st">&quot;Particle Swarm&quot;</span>,</span>
<span id="cb222-722"><a href="non-linear-least-squares-estimation.html#cb222-722" tabindex="-1"></a>      particle_swarm_fit,</span>
<span id="cb222-723"><a href="non-linear-least-squares-estimation.html#cb222-723" tabindex="-1"></a>      <span class="cn">NULL</span>,</span>
<span id="cb222-724"><a href="non-linear-least-squares-estimation.html#cb222-724" tabindex="-1"></a>      x,</span>
<span id="cb222-725"><a href="non-linear-least-squares-estimation.html#cb222-725" tabindex="-1"></a>      y,</span>
<span id="cb222-726"><a href="non-linear-least-squares-estimation.html#cb222-726" tabindex="-1"></a>      sse_fn,</span>
<span id="cb222-727"><a href="non-linear-least-squares-estimation.html#cb222-727" tabindex="-1"></a>      model_fn,</span>
<span id="cb222-728"><a href="non-linear-least-squares-estimation.html#cb222-728" tabindex="-1"></a>      lower,</span>
<span id="cb222-729"><a href="non-linear-least-squares-estimation.html#cb222-729" tabindex="-1"></a>      upper,</span>
<span id="cb222-730"><a href="non-linear-least-squares-estimation.html#cb222-730" tabindex="-1"></a>      <span class="at">max_iter =</span> <span class="dv">50</span></span>
<span id="cb222-731"><a href="non-linear-least-squares-estimation.html#cb222-731" tabindex="-1"></a>    )</span>
<span id="cb222-732"><a href="non-linear-least-squares-estimation.html#cb222-732" tabindex="-1"></a>  )</span>
<span id="cb222-733"><a href="non-linear-least-squares-estimation.html#cb222-733" tabindex="-1"></a>  out</span>
<span id="cb222-734"><a href="non-linear-least-squares-estimation.html#cb222-734" tabindex="-1"></a>}</span>
<span id="cb222-735"><a href="non-linear-least-squares-estimation.html#cb222-735" tabindex="-1"></a></span>
<span id="cb222-736"><a href="non-linear-least-squares-estimation.html#cb222-736" tabindex="-1"></a><span class="co"># -- 5) RUN &amp; VISUALIZE ----</span></span>
<span id="cb222-737"><a href="non-linear-least-squares-estimation.html#cb222-737" tabindex="-1"></a></span>
<span id="cb222-738"><a href="non-linear-least-squares-estimation.html#cb222-738" tabindex="-1"></a><span class="co"># Compare &quot;simple&quot; logistic (3 params)</span></span>
<span id="cb222-739"><a href="non-linear-least-squares-estimation.html#cb222-739" tabindex="-1"></a>results_simple  <span class="ot">&lt;-</span> <span class="fu">compare_all_methods</span>(<span class="at">is_complex =</span> <span class="cn">FALSE</span>)</span>
<span id="cb222-740"><a href="non-linear-least-squares-estimation.html#cb222-740" tabindex="-1"></a>results_simple<span class="sc">$</span>Problem <span class="ot">&lt;-</span> <span class="st">&quot;Simple&quot;</span></span>
<span id="cb222-741"><a href="non-linear-least-squares-estimation.html#cb222-741" tabindex="-1"></a></span>
<span id="cb222-742"><a href="non-linear-least-squares-estimation.html#cb222-742" tabindex="-1"></a><span class="co"># Compare &quot;complex&quot; (4 params)</span></span>
<span id="cb222-743"><a href="non-linear-least-squares-estimation.html#cb222-743" tabindex="-1"></a>results_complex <span class="ot">&lt;-</span> <span class="fu">compare_all_methods</span>(<span class="at">is_complex =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-744"><a href="non-linear-least-squares-estimation.html#cb222-744" tabindex="-1"></a>results_complex<span class="sc">$</span>Problem <span class="ot">&lt;-</span> <span class="st">&quot;Complex&quot;</span></span>
<span id="cb222-745"><a href="non-linear-least-squares-estimation.html#cb222-745" tabindex="-1"></a></span>
<span id="cb222-746"><a href="non-linear-least-squares-estimation.html#cb222-746" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb222-747"><a href="non-linear-least-squares-estimation.html#cb222-747" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_simple, results_complex)</span>
<span id="cb222-748"><a href="non-linear-least-squares-estimation.html#cb222-748" tabindex="-1"></a><span class="co"># print(all_results)</span></span>
<span id="cb222-749"><a href="non-linear-least-squares-estimation.html#cb222-749" tabindex="-1"></a><span class="co"># DT::datatable(all_results)</span></span>
<span id="cb222-750"><a href="non-linear-least-squares-estimation.html#cb222-750" tabindex="-1"></a></span>
<span id="cb222-751"><a href="non-linear-least-squares-estimation.html#cb222-751" tabindex="-1"></a><span class="co"># Example: SSE by method &amp; problem</span></span>
<span id="cb222-752"><a href="non-linear-least-squares-estimation.html#cb222-752" tabindex="-1"></a><span class="fu">ggplot</span>(all_results, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> <span class="fu">log</span>(SSE), <span class="at">fill =</span> Problem)) <span class="sc">+</span></span>
<span id="cb222-753"><a href="non-linear-least-squares-estimation.html#cb222-753" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb222-754"><a href="non-linear-least-squares-estimation.html#cb222-754" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb222-755"><a href="non-linear-least-squares-estimation.html#cb222-755" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of SSE by Method &amp; Problem Complexity&quot;</span>,</span>
<span id="cb222-756"><a href="non-linear-least-squares-estimation.html#cb222-756" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Log(Sum of Squared Errors)&quot;</span>) <span class="sc">+</span></span>
<span id="cb222-757"><a href="non-linear-least-squares-estimation.html#cb222-757" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="non-linear-least-squares-estimation.html#cb223-1" tabindex="-1"></a></span>
<span id="cb223-2"><a href="non-linear-least-squares-estimation.html#cb223-2" tabindex="-1"></a><span class="co"># Example: Time (ms) by method &amp; problem</span></span>
<span id="cb223-3"><a href="non-linear-least-squares-estimation.html#cb223-3" tabindex="-1"></a><span class="fu">ggplot</span>(all_results, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Time_ms, <span class="at">fill =</span> Problem)) <span class="sc">+</span></span>
<span id="cb223-4"><a href="non-linear-least-squares-estimation.html#cb223-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-5"><a href="non-linear-least-squares-estimation.html#cb223-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb223-6"><a href="non-linear-least-squares-estimation.html#cb223-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Comparison of Computation Time by Method &amp; Problem Complexity&quot;</span>,</span>
<span id="cb223-7"><a href="non-linear-least-squares-estimation.html#cb223-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Time (ms)&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-8"><a href="non-linear-least-squares-estimation.html#cb223-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-24-2.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bates1981relative" class="csl-entry">
———. 1981. <span>“A Relative Off Set Orthogonality Convergence Criterion for Nonlinear Least Squares.”</span> <em>Technometrics</em> 23 (2): 179–83.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-considerations-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mikenguyen13/data_analysis/edit/main/06-nonlinear-regession.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mikenguyen13/data_analysis/blob/main/06-nonlinear-regession.Rmd",
    "text": null
  },
  "download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true,
    "sharing": {
      "facebook": true,
      "github": true,
      "twitter": true,
      "linkedin": true
    },
    "info": true,
    "edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
