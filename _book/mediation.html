<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 36 Mediation | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="36.1 Traditional Approach Baron and Kenny (1986) is outdated because of step 1, but we could still see the original idea. 3 regressions Step 1: \(X \to Y\) Step 2: \(X \to M\) Step 3: \(X + M \to...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 36 Mediation | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/mediation.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="36.1 Traditional Approach Baron and Kenny (1986) is outdated because of step 1, but we could still see the original idea. 3 regressions Step 1: \(X \to Y\) Step 2: \(X \to M\) Step 3: \(X + M \to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 36 Mediation | A Guide on Data Analysis">
<meta name="twitter:description" content="36.1 Traditional Approach Baron and Kenny (1986) is outdated because of step 1, but we could still see the original idea. 3 regressions Step 1: \(X \to Y\) Step 2: \(X \to M\) Step 3: \(X + M \to...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="model-specification-4.html"><span class="header-section-number">10</span> Model Specification</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></li>
<li><a class="" href="data.html"><span class="header-section-number">12</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">13</span> Variable Transformation</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">14</span> Hypothesis Testing</a></li>
<li><a class="" href="marginal-effects.html"><span class="header-section-number">15</span> Marginal Effects</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">16</span> Prediction and Estimation</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">17</span> Moderation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">18</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="experimental-design.html"><span class="header-section-number">19</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">20</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">21</span> Analysis of Variance (ANOVA)</a></li>
<li><a class="" href="multivariate-methods.html"><span class="header-section-number">22</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="quasi-experimental.html"><span class="header-section-number">23</span> Quasi-experimental</a></li>
<li><a class="" href="regression-discontinuity.html"><span class="header-section-number">24</span> Regression Discontinuity</a></li>
<li><a class="" href="synthetic-difference-in-differences.html"><span class="header-section-number">25</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="difference-in-differences.html"><span class="header-section-number">26</span> Difference-in-differences</a></li>
<li><a class="" href="changes-in-changes.html"><span class="header-section-number">27</span> Changes-in-Changes</a></li>
<li><a class="" href="synthetic-control.html"><span class="header-section-number">28</span> Synthetic Control</a></li>
<li><a class="" href="event-studies.html"><span class="header-section-number">29</span> Event Studies</a></li>
<li><a class="" href="instrumental-variables.html"><span class="header-section-number">30</span> Instrumental Variables</a></li>
<li><a class="" href="matching-methods.html"><span class="header-section-number">31</span> Matching Methods</a></li>
<li><a class="" href="interrupted-time-series.html"><span class="header-section-number">32</span> Interrupted Time Series</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">33</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">34</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">35</span> Controls</a></li>
<li><a class="active" href="mediation.html"><span class="header-section-number">36</span> Mediation</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">37</span> Directed Acyclic Graph</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">38</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">39</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">40</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">41</span> Replication and Synthetic Data</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="mediation" class="section level1" number="36">
<h1>
<span class="header-section-number">36</span> Mediation<a class="anchor" aria-label="anchor" href="#mediation"><i class="fas fa-link"></i></a>
</h1>
<div id="traditional-approach" class="section level2" number="36.1">
<h2>
<span class="header-section-number">36.1</span> Traditional Approach<a class="anchor" aria-label="anchor" href="#traditional-approach"><i class="fas fa-link"></i></a>
</h2>
<p><span class="citation">Baron and Kenny (<a href="references.html#ref-baron1986moderator">1986</a>)</span> is outdated because of step 1, but we could still see the original idea.</p>
<p>3 regressions</p>
<ul>
<li><p>Step 1: <span class="math inline">\(X \to Y\)</span></p></li>
<li><p>Step 2: <span class="math inline">\(X \to M\)</span></p></li>
<li><p>Step 3: <span class="math inline">\(X + M \to Y\)</span></p></li>
</ul>
<p>where</p>
<ul>
<li><p><span class="math inline">\(X\)</span> = independent (causal) variable</p></li>
<li><p><span class="math inline">\(Y\)</span> = dependent (outcome) variable</p></li>
<li><p><span class="math inline">\(M\)</span> = mediating variable</p></li>
</ul>
<p><strong>Note</strong>: Originally, the first path from <span class="math inline">\(X \to Y\)</span> suggested by <span class="citation">(<a href="references.html#ref-baron1986moderator">Baron and Kenny 1986</a>)</span> needs to be significant. But there are cases in which you could have indirect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> without significant direct effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> (e.g., when the effect is absorbed into M, or there are two counteracting effects <span class="math inline">\(M_1, M_2\)</span> that cancel out each other effect).</p>
<div class="float">
<img src="images/mediation/direct_mod.png" style="width:90.0%" alt="Unmediated model"><div class="figcaption">Unmediated model</div>
</div>
<p>where <span class="math inline">\(c\)</span> is the <strong>total effect</strong></p>
<div class="inline-figure"><img src="images/mediation/full_mod.png" style="width:90.0%"></div>
<p>where</p>
<ul>
<li><p><span class="math inline">\(c'\)</span> = <strong>direct effect</strong> (effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> after accounting for the indirect path)</p></li>
<li><p><span class="math inline">\(ab\)</span> = <strong>indirect effect</strong></p></li>
</ul>
<p>Hence,</p>
<p><span class="math display">\[
\begin{aligned}
\text{total effect} &amp;= \text{direct effect} + \text{indirect effect} \\
c &amp;= c' + ab
\end{aligned}
\]</span></p>
<p>However, this simple equation does not only hold in cases of</p>
<ol style="list-style-type: decimal">
<li>Models with latent variables</li>
<li>Logistic models (only approximately). Hence, you can only calculate <span class="math inline">\(c\)</span> as the total effect of <span class="math inline">\(c' + ab\)</span>
</li>
<li>Multi-level models <span class="citation">(<a href="references.html#ref-bauer2006conceptualizing">Bauer, Preacher, and Gil 2006</a>)</span>
</li>
</ol>
<p>To measure mediation (i.e., indirect effect),</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(1 - \frac{c'}{c}\)</span> highly unstable <span class="citation">(<a href="references.html#ref-mackinnon1995simulation">D. P. MacKinnon, Warsi, and Dwyer 1995</a>)</span>, especially in cases that <span class="math inline">\(c\)</span> is small (not re* recommended)</li>
<li>
<strong>Product method</strong>: <span class="math inline">\(a\times b\)</span>
</li>
<li>
<strong>Difference method</strong>: <span class="math inline">\(c- c'\)</span>
</li>
</ol>
<p>For linear models, we have the following assumptions:</p>
<ol style="list-style-type: decimal">
<li><p>No unmeasured confound between <span class="math inline">\(X-Y\)</span>, <span class="math inline">\(X-M\)</span> and <span class="math inline">\(M-Y\)</span> relationships.</p></li>
<li><p><span class="math inline">\(X \not\rightarrow C\)</span> where <span class="math inline">\(C\)</span> is a confounder between <span class="math inline">\(M-Y\)</span> relationship</p></li>
<li><p><a href="mediation.html#reliability">Reliability</a>: No errors in measurement of <span class="math inline">\(M\)</span> (also known as reliability assumption) (can consider errors-in-variables models)</p></li>
</ol>
<p>Mathematically,</p>
<p><span class="math display">\[
Y = b_0 + b_1 X + \epsilon
\]</span></p>
<p><span class="math inline">\(b_1\)</span> does <strong>not</strong> need to be <strong>significant</strong>.</p>
<ol start="2" style="list-style-type: decimal">
<li>We examine the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(M\)</span>. This step requires that there is a significant effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(M\)</span> to continue with the analysis</li>
</ol>
<p>Mathematically,</p>
<p><span class="math display">\[
M = b_0 + b_2 X + \epsilon
\]</span></p>
<p>where <span class="math inline">\(b_2\)</span> needs to be <strong>significant</strong>.</p>
<ol start="3" style="list-style-type: decimal">
<li>In this step, we want to the effect of <span class="math inline">\(M\)</span> on <span class="math inline">\(Y\)</span> “absorbs” most of the direct effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> (or at least makes the effect smaller).</li>
</ol>
<p>Mathematically,</p>
<p><span class="math display">\[
Y = b_0 + b_4 X + b_3 M + \epsilon
\]</span></p>
<p><span class="math inline">\(b_4\)</span> needs to be either smaller or insignificant.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>The effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>
</th>
<th>then, <span class="math inline">\(M\)</span> … mediates between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>completely disappear (<span class="math inline">\(b_4\)</span> insignificant)</td>
<td>Fully (i.e., full mediation)</td>
</tr>
<tr class="even">
<td>partially disappear (<span class="math inline">\(b_4 &lt; b_1\)</span> in step 1)</td>
<td>Partially (i.e., partial mediation)</td>
</tr>
</tbody>
</table></div>
<ol start="4" style="list-style-type: decimal">
<li>Examine the mediation effect (i.e., whether it is significant)</li>
</ol>
<ul>
<li><p><a href="mediation.html#sobel-test">Sobel Test</a> <span class="citation">(<a href="references.html#ref-sobel1982asymptotic">Sobel 1982</a>)</span></p></li>
<li><p><a href="mediation.html#joint-significance-test">Joint Significance Test</a></p></li>
<li><p><a href="mediation.html#bootstrapping">Bootstrapping</a> <span class="citation">Shrout and Bolger (<a href="references.html#ref-shrout2002mediation">2002</a>)</span> (preferable)</p></li>
</ul>
<p><strong>Notes</strong>:</p>
<ul>
<li><p>Proximal mediation (<span class="math inline">\(a &gt; b\)</span>) can lead to multicollinearity and reduce statistical power, whereas distal mediation (<span class="math inline">\(b &gt; a\)</span>) is preferred for maximizing test power.</p></li>
<li><p>The ideal balance for maximizing power in mediation analysis involves slightly distal mediators (i.e., path <span class="math inline">\(b\)</span> is somewhat larger than path <span class="math inline">\(a\)</span>) <span class="citation">(<a href="references.html#ref-hoyle1999statistical">Hoyle 1999</a>)</span>.</p></li>
<li><p>Tests for direct effects (c and c’) have lower power compared to the indirect effect (ab), making it possible for ab to be significant while c is not, even in cases where there seems to be complete mediation but no statistical evidence of a direct cause-effect relationship between X and Y without considering M <span class="citation">(<a href="references.html#ref-kenny2014power">Kenny and Judd 2014</a>)</span>.</p></li>
<li><p>The testing of <span class="math inline">\(ab\)</span> offers a power advantage over <span class="math inline">\(c’\)</span> because it effectively combines two tests. However, claims of complete mediation based solely on the non-significance of <span class="math inline">\(c’\)</span> should be approached with caution, emphasizing the need for sufficient sample size and power, especially in assessing partial mediation. Or one should never make complete mediation claim <span class="citation">(<a href="references.html#ref-hayes2013relative">Hayes and Scharkow 2013</a>)</span></p></li>
</ul>
<div id="assumptions-2" class="section level3" number="36.1.1">
<h3>
<span class="header-section-number">36.1.1</span> Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-2"><i class="fas fa-link"></i></a>
</h3>
<div id="direction" class="section level4" number="36.1.1.1">
<h4>
<span class="header-section-number">36.1.1.1</span> Direction<a class="anchor" aria-label="anchor" href="#direction"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Quick fix but not convincing: Measure <span class="math inline">\(X\)</span> before <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> to prevent <span class="math inline">\(M\)</span> or <span class="math inline">\(Y\)</span> causing <span class="math inline">\(X\)</span>; measure <span class="math inline">\(M\)</span> before <span class="math inline">\(Y\)</span> to avoid <span class="math inline">\(Y\)</span> causing <span class="math inline">\(M\)</span>.</p></li>
<li>
<p><span class="math inline">\(Y\)</span> may cause <span class="math inline">\(M\)</span> in a feedback model.</p>
<ul>
<li><p>Assuming <span class="math inline">\(c' =0\)</span> (full mediation) allows for estimating models with reciprocal causal effects between <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> via IV estimation.</p></li>
<li><p><span class="citation">E. R. Smith (<a href="references.html#ref-smith1982beliefs">1982</a>)</span> proposes treating both <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> as outcomes with potential to mediate each other, requiring distinct instrumental variables for each that do not affect the other.</p></li>
</ul>
</li>
</ul>
</div>
<div id="interaction" class="section level4" number="36.1.1.2">
<h4>
<span class="header-section-number">36.1.1.2</span> Interaction<a class="anchor" aria-label="anchor" href="#interaction"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>When M interact with X to affect Y, M is both a mediator and a mediator <span class="citation">(<a href="references.html#ref-baron1986moderator">Baron and Kenny 1986</a>)</span>.</p></li>
<li><p>Interaction between <span class="math inline">\(XM\)</span> should always be estimated.</p></li>
<li><p>For the interpretation of this interaction, see <span class="citation">(<a href="references.html#ref-vanderweele2015explanation">T. VanderWeele 2015</a>)</span></p></li>
</ul>
</div>
<div id="reliability" class="section level4" number="36.1.1.3">
<h4>
<span class="header-section-number">36.1.1.3</span> Reliability<a class="anchor" aria-label="anchor" href="#reliability"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<p>When mediator contains measurement errors, <span class="math inline">\(b, c'\)</span> are biased. Possible fix: mediator = latent variable (but loss of power) <span class="citation">(<a href="references.html#ref-ledgerwood2011trade">Ledgerwood and Shrout 2011</a>)</span></p>
<ul>
<li><p><span class="math inline">\(b\)</span> is attenuated (closer to 0)</p></li>
<li>
<p><span class="math inline">\(c'\)</span> is</p>
<ul>
<li><p>overestimated when <span class="math inline">\(ab &gt;0\)</span></p></li>
<li><p>underestiamted when <span class="math inline">\(ab&lt;0\)</span></p></li>
</ul>
</li>
</ul>
</li>
<li>
<p>When treatment contains measurement errors, <span class="math inline">\(a,b\)</span> are biased</p>
<ul>
<li><p><span class="math inline">\(a\)</span> is attenuated</p></li>
<li>
<p><span class="math inline">\(b\)</span> is</p>
<ul>
<li><p>overestimated when <span class="math inline">\(ac'&gt;0\)</span></p></li>
<li><p>underestimated when <span class="math inline">\(ac' &lt;0\)</span></p></li>
</ul>
</li>
</ul>
</li>
<li>
<p>When outcome contains measurement errors,</p>
<ul>
<li><p>If unstandardized, no bias</p></li>
<li><p>If standardized, attenuation bias</p></li>
</ul>
</li>
</ul>
</div>
<div id="confounding" class="section level4" number="36.1.1.4">
<h4>
<span class="header-section-number">36.1.1.4</span> Confounding<a class="anchor" aria-label="anchor" href="#confounding"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Omitted variable bias can happen to any pair of relationships</p></li>
<li>
<p>To deal with this problem, one can either use</p>
<ul>
<li><p><a href="mediation.html#design-strategies">Design Strategies</a></p></li>
<li><p><a href="mediation.html#statistical-strategies">Statistical Strategies</a></p></li>
</ul>
</li>
</ul>
<div id="design-strategies" class="section level5" number="36.1.1.4.1">
<h5>
<span class="header-section-number">36.1.1.4.1</span> Design Strategies<a class="anchor" aria-label="anchor" href="#design-strategies"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li><p><strong>Randomization</strong> of treatment variable. If possible, also mediator</p></li>
<li><p><strong>Control</strong> for the confounder (but still only for measureable observables)</p></li>
</ul>
</div>
<div id="statistical-strategies" class="section level5" number="36.1.1.4.2">
<h5>
<span class="header-section-number">36.1.1.4.2</span> Statistical Strategies<a class="anchor" aria-label="anchor" href="#statistical-strategies"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>
<p><strong>Instrumental</strong> <strong>variable</strong> on treatment</p>
<ul>
<li>Specifically for confounder affecting the <span class="math inline">\(M-Y\)</span> pair, front-door adjustment is possible when there is a variable that completely mediates the effect of the mediator on the outcome and is unaffected by the confounder.</li>
</ul>
</li>
<li>
<p><strong>Weighting</strong> methods (e.g., inverse propensity) See <a href="https://www.andrewheiss.com/blog/2020/12/01/ipw-binary-continuous/">Heiss</a> for R code</p>
<ul>
<li>Need strong ignorability assumption (i.e.., all confounders are included and measured without error <span class="citation">(<a href="references.html#ref-westfall2016statistically">Westfall and Yarkoni 2016</a>)</span>). Not fixable, but can be examined with robustness checks.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="indirect-effect-tests" class="section level3" number="36.1.2">
<h3>
<span class="header-section-number">36.1.2</span> Indirect Effect Tests<a class="anchor" aria-label="anchor" href="#indirect-effect-tests"><i class="fas fa-link"></i></a>
</h3>
<div id="sobel-test" class="section level4" number="36.1.2.1">
<h4>
<span class="header-section-number">36.1.2.1</span> Sobel Test<a class="anchor" aria-label="anchor" href="#sobel-test"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>developed by <span class="citation">Sobel (<a href="references.html#ref-sobel1982asymptotic">1982</a>)</span></p></li>
<li><p>also known as the <strong>delta method</strong></p></li>
<li><p>not recommend because it assumes the indirect effect <span class="math inline">\(b\)</span> has a normal distribution when it’s not <span class="citation">(<a href="references.html#ref-mackinnon1995simulation">D. P. MacKinnon, Warsi, and Dwyer 1995</a>)</span>.</p></li>
<li><p>Mediation can occur even if direct and indirect effects oppose each other, termed “inconsistent mediation” <span class="citation">(<a href="references.html#ref-mackinnon2007mediation">D. P. MacKinnon, Fairchild, and Fritz 2007</a>)</span>. This is when the mediator acts as a suppressor variable.</p></li>
</ul>
<p>Standard Error</p>
<p><span class="math display">\[
\sqrt{\hat{b}^2 s_{\hat{a}} + \hat{a}^2 s_{b}^2}
\]</span></p>
<p>The test of the indirect effect is</p>
<p><span class="math display">\[
z = \frac{\hat{ab}}{\sqrt{\hat{b}^2 s_{\hat{a}} + \hat{a}^2 s_{b}^2}}
\]</span></p>
<p>Disadvantages</p>
<ul>
<li><p>Assume <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are independent.</p></li>
<li><p>Assume <span class="math inline">\(ab\)</span> is normally distributed.</p></li>
<li><p>Does not work well for small sample sizes.</p></li>
<li><p>Power of the test is low and the test is conservative as compared to <a href="mediation.html#bootstrapping">Bootstrapping</a>.</p></li>
</ul>
</div>
<div id="joint-significance-test" class="section level4" number="36.1.2.2">
<h4>
<span class="header-section-number">36.1.2.2</span> Joint Significance Test<a class="anchor" aria-label="anchor" href="#joint-significance-test"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Effective for determining if the indirect effect is nonzero (by testing whether <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are both statistically significant), assumes <span class="math inline">\(a \perp b\)</span>.</p></li>
<li><p>It’s recommended to use it with other tests and has similar performance to a <a href="mediation.html#bootstrapping">Bootstrapping</a> test <span class="citation">(<a href="references.html#ref-hayes2013relative">Hayes and Scharkow 2013</a>)</span>.</p></li>
<li><p>The test’s accuracy can be affected by heteroscedasticity <span class="citation">(<a href="references.html#ref-fossum2023use">Fossum and Montoya 2023</a>)</span> but not by non-normality.</p></li>
<li><p>Although helpful in computing power for the test of the indirect effect, it doesn’t provide a confidence interval for the effect.</p></li>
</ul>
</div>
<div id="bootstrapping" class="section level4" number="36.1.2.3">
<h4>
<span class="header-section-number">36.1.2.3</span> Bootstrapping<a class="anchor" aria-label="anchor" href="#bootstrapping"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>First used by <span class="citation">Bollen and Stine (<a href="references.html#ref-bollen1990direct">1990</a>)</span></p></li>
<li><p>It allows for the calculation of confidence intervals, p-values, etc.</p></li>
<li><p>It does not require <span class="math inline">\(a \perp b\)</span> and corrects for bias in the bootstrapped distribution.</p></li>
<li><p>It can handle non-normality (in the sampling distribution of the indirect effect), complex models, and small samples.</p></li>
<li><p>Concerns exist about the bias-corrected bootstrapping being too liberal <span class="citation">(<a href="references.html#ref-fritz2012explanation">Fritz, Taylor, and MacKinnon 2012</a>)</span>. Hence, current recommendations favor percentile bootstrap without bias correction for better Type I error rates <span class="citation">(<a href="references.html#ref-tibbe2022correcting">Tibbe and Montoya 2022</a>)</span>.</p></li>
<li><p>A special case of bootstrapping is a proposed by where you don’t need access to raw data to generate resampling, you only need <span class="math inline">\(a, b, var(a), var(b), cov(a,b)\)</span> (which can be taken from lots of primary studies)</p></li>
</ul>
<div class="sourceCode" id="cb836"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/med_ind.html">med_ind</a></span><span class="op">(</span></span>
<span>        a <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        b <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>        var_a <span class="op">=</span> <span class="fl">0.04</span>,</span>
<span>        var_b <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>        cov_ab <span class="op">=</span> <span class="fl">0.01</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<div class="inline-figure"><img src="36-mediation_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<div id="with-instrument" class="section level5" number="36.1.2.3.1">
<h5>
<span class="header-section-number">36.1.2.3.1</span> With Instrument<a class="anchor" aria-label="anchor" href="#with-instrument"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb837"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rich-iannone/DiagrammeR">DiagrammeR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">grViz</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">digraph {</span></span>
<span><span class="st">  graph []</span></span>
<span><span class="st">  node [shape = plaintext]</span></span>
<span><span class="st">    X [label = 'Treatment']</span></span>
<span><span class="st">    Y [label = 'Outcome']</span></span>
<span><span class="st">  edge [minlen = 2]</span></span>
<span><span class="st">    X-&gt;Y</span></span>
<span><span class="st">  { rank = same; X; Y }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DiagrammeR/man/grViz.html">grViz</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">digraph {</span></span>
<span><span class="st">  graph []</span></span>
<span><span class="st">  node [shape = plaintext]</span></span>
<span><span class="st">    X [label ='Treatment', shape = box]</span></span>
<span><span class="st">    Y [label ='Outcome', shape = box]</span></span>
<span><span class="st">    M [label ='Mediator', shape = box]</span></span>
<span><span class="st">    IV [label ='Instrument', shape = box]</span></span>
<span><span class="st">  edge [minlen = 2]</span></span>
<span><span class="st">    IV-&gt;X</span></span>
<span><span class="st">    X-&gt;M  </span></span>
<span><span class="st">    M-&gt;Y </span></span>
<span><span class="st">    X-&gt;Y </span></span>
<span><span class="st">  { rank = same; X; Y; M }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb838"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"boundsdata"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Total Effect</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Indirect Effect</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">med</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direct and Indirect Effect</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">med</span> <span class="op">+</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Proportion Test</span></span>
<span><span class="co"># To what extent is the effect of the treatment mediated by the mediator?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out2</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out3</span><span class="op">)</span><span class="op">[</span><span class="st">'med'</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt;      ttt </span></span>
<span><span class="co">#&gt; 68.63609</span></span>
<span></span>
<span></span>
<span><span class="co"># Sobel Test</span></span>
<span><span class="fu">bda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bda/man/medtest.html">mediation.test</a></span><span class="op">(</span><span class="va">boundsdata</span><span class="op">$</span><span class="va">med</span>, <span class="va">boundsdata</span><span class="op">$</span><span class="va">ttt</span>, <span class="va">boundsdata</span><span class="op">$</span><span class="va">out</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/nice_tab.html">nice_tab</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rowname Sobel Aroian Goodman</span></span>
<span><span class="co">#&gt; 1 z.value  4.05   4.03    4.07</span></span>
<span><span class="co">#&gt; 2 p.value  0.00   0.00    0.00</span></span></code></pre></div>
<div class="sourceCode" id="cb839"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mediation Analysis using boot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mediation_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># sample the dataset</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="va">a_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">med</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">a_path</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">b_path</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">med</span> <span class="op">+</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">b_path</span><span class="op">)</span><span class="op">[</span><span class="st">'med'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">b_path</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># indirect effect</span></span>
<span>    <span class="va">ind_ef</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">*</span><span class="va">b</span></span>
<span>    <span class="va">total_ef</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">*</span><span class="va">b</span> <span class="op">+</span> <span class="va">cp</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ind_ef</span>, <span class="va">total_ef</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">boot_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span><span class="va">boundsdata</span>, <span class="va">mediation_fn</span>, R <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="st">"multicore"</span>, ncpus <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">boot_med</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; boot(data = boundsdata, statistic = mediation_fn, R = 100, parallel = "multicore", </span></span>
<span><span class="co">#&gt;     ncpus = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap Statistics :</span></span>
<span><span class="co">#&gt;       original        bias    std. error</span></span>
<span><span class="co">#&gt; t1* 0.04112035  0.0006346725 0.009539903</span></span>
<span><span class="co">#&gt; t2* 0.05991068 -0.0004462572 0.029556611</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot_med</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/nice_tab.html">nice_tab</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     R original bootBias bootSE bootMed</span></span>
<span><span class="co">#&gt; 1 100     0.04        0   0.01    0.04</span></span>
<span><span class="co">#&gt; 2 100     0.06        0   0.03    0.06</span></span>
<span></span>
<span><span class="co"># confidence intervals (percentile is always recommended)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">boot_med</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span><span class="co">#&gt; Based on 100 bootstrap replicates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CALL : </span></span>
<span><span class="co">#&gt; boot.ci(boot.out = boot_med, type = c("norm", "perc"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intervals : </span></span>
<span><span class="co">#&gt; Level      Normal             Percentile     </span></span>
<span><span class="co">#&gt; 95%   ( 0.0218,  0.0592 )   ( 0.0249,  0.0623 )  </span></span>
<span><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span><span class="co">#&gt; Some percentile intervals may be unstable</span></span>
<span></span>
<span><span class="co"># point estimates (Indirect, and Total Effects)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">boot_med</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.04175502 0.05946442</span></span></code></pre></div>
<p>Alternatively, one can use the <code>robmed</code> package</p>
<div class="sourceCode" id="cb840"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aalfons/robmed">robmed</a></span><span class="op">)</span></span></code></pre></div>
<p>Power test or use <a href="https://davidakenny.shinyapps.io/MedPower/">app</a></p>
<div class="sourceCode" id="cb841"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pwr2ppl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># indirect path ab power</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pwr2ppl/man/medjs.html">medjs</a></span><span class="op">(</span></span>
<span>    <span class="co"># X on M (path a)</span></span>
<span>    rx1m1 <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    <span class="co"># correlation between X and Y (path c')</span></span>
<span>    rx1y  <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    <span class="co"># correlation between M and Y (path b)</span></span>
<span>    rym1  <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>    <span class="co"># sample size</span></span>
<span>    n     <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    <span class="co"># number of mediators</span></span>
<span>    mvars <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co"># should use 10000</span></span>
<span>    rep   <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="multiple-mediation" class="section level3" number="36.1.3">
<h3>
<span class="header-section-number">36.1.3</span> Multiple Mediation<a class="anchor" aria-label="anchor" href="#multiple-mediation"><i class="fas fa-link"></i></a>
</h3>
<p>The most general package to handle multiple cases is <code>manymome</code></p>
<p>See <a href="https://cran.r-project.org/web/packages/manymome/vignettes/med_lm.html">vignette</a> for an example</p>
<div class="sourceCode" id="cb842"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/manymome/">manymome</a></span><span class="op">)</span></span></code></pre></div>
<div id="multiple-mediators" class="section level4" number="36.1.3.1">
<h4>
<span class="header-section-number">36.1.3.1</span> Multiple Mediators<a class="anchor" aria-label="anchor" href="#multiple-mediators"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><a href="https://openresearchsoftware.metajnl.com/articles/10.5334/jors.160">Notes</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/mma/vignettes/MMAvignette.html">Vignette</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/mma/mma.pdf">Package</a></p></li>
</ul>
<div class="sourceCode" id="cb843"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">mma</a></span><span class="op">)</span></span></code></pre></div>
<div id="lavaan" class="section level6" number="36.1.3.1.0.1">
<h6>
<span class="header-section-number">36.1.3.1.0.1</span> Lavaan<a class="anchor" aria-label="anchor" href="#lavaan"><i class="fas fa-link"></i></a>
</h6>
<div class="sourceCode" id="cb844"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>  <span class="co"># for mvrnorm</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to generate synthetic data with correctly correlated errors for mediators</span></span>
<span><span class="va">generate_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>           <span class="va">a1</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           <span class="va">a2</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>,</span>
<span>           <span class="va">b1</span> <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>           <span class="va">b2</span> <span class="op">=</span> <span class="fl">0.48</span>,</span>
<span>           <span class="va">corr</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           <span class="va">correlation_value</span> <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span>    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Generate correlated errors using a multivariate normal distribution</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">correlation_value</span>, <span class="va">correlation_value</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Higher covariance matrix for errors</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span>  <span class="co"># Generate correlated errors</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Independent errors</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">M1</span> <span class="op">&lt;-</span> <span class="va">a1</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">M2</span> <span class="op">&lt;-</span> <span class="va">a2</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">M1</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">*</span> <span class="va">M2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Y depends on M1 and M2</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, M1 <span class="op">=</span> <span class="va">M1</span>, M2 <span class="op">=</span> <span class="va">M2</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Ground truth for comparison</span></span>
<span><span class="va">ground_truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span>, GroundTruth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to extract relevant estimates, standard errors, and model fit</span></span>
<span><span class="va">extract_estimates_b1_b2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="va">estimates</span><span class="op">$</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"Y"</span> <span class="op">&amp;</span> <span class="va">estimates</span><span class="op">$</span><span class="va">rhs</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rhs"</span>, <span class="st">"est"</span>, <span class="st">"se"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">estimates</span><span class="op">$</span><span class="va">Parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">$</span><span class="va">rhs</span> <span class="op">==</span> <span class="st">"M1"</span>, <span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"est"</span>, <span class="st">"se"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">fit_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html">fitMeasures</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"bic"</span>, <span class="st">"rmsea"</span>, <span class="st">"chisq"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">estimates</span>, fit_stats <span class="op">=</span> <span class="va">fit_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Case 1: Correlated errors for mediators (modeled correctly)</span></span>
<span><span class="va">Data_corr</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, corr <span class="op">=</span> <span class="cn">TRUE</span>, correlation_value <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">model_corr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">  M1 ~~ M2  # Correlated mediators (errors)</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_corr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span><span class="va">results_corr</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_corr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 2: Uncorrelated errors for mediators (modeled correctly)</span></span>
<span><span class="va">Data_uncorr</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, corr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">model_uncorr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_uncorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_uncorr</span>, data <span class="op">=</span> <span class="va">Data_uncorr</span><span class="op">)</span></span>
<span><span class="va">results_uncorr</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_uncorr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 3: Correlated errors, but not modeled as correlated</span></span>
<span><span class="va">fit_corr_incorrect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_uncorr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span><span class="va">results_corr_incorrect</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_corr_incorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 4: Uncorrelated errors, but modeled as correlated</span></span>
<span><span class="va">fit_uncorr_incorrect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_corr</span>, data <span class="op">=</span> <span class="va">Data_uncorr</span><span class="op">)</span></span>
<span><span class="va">results_uncorr_incorrect</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_uncorr_incorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all estimates for comparison</span></span>
<span><span class="va">estimates_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Correlated (Correct)"</span> <span class="op">=</span> <span class="va">results_corr</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Uncorrelated (Correct)"</span> <span class="op">=</span> <span class="va">results_uncorr</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Correlated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_corr_incorrect</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Uncorrelated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_uncorr_incorrect</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all into a single table</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates_combined</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">case</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">estimates_combined</span><span class="op">[[</span><span class="va">case</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">Case</span> <span class="op">&lt;-</span> <span class="va">case</span></span>
<span>    <span class="va">df</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge with ground truth for final comparison</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">comparison_table</span>, <span class="va">ground_truth</span>, by <span class="op">=</span> <span class="st">"Parameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the comparison table</span></span>
<span><span class="va">comparison_table</span></span>
<span><span class="co">#&gt;   Parameter       est          se                     Case GroundTruth</span></span>
<span><span class="co">#&gt; 1        b1 0.7002984 0.013870433     Correlated (Correct)        0.70</span></span>
<span><span class="co">#&gt; 2        b1 0.6973612 0.009859426   Uncorrelated (Correct)        0.70</span></span>
<span><span class="co">#&gt; 3        b1 0.7002984 0.010010367   Correlated (Incorrect)        0.70</span></span>
<span><span class="co">#&gt; 4        b1 0.6973612 0.009859634 Uncorrelated (Incorrect)        0.70</span></span>
<span><span class="co">#&gt; 5        b2 0.4871118 0.013805615     Correlated (Correct)        0.48</span></span>
<span><span class="co">#&gt; 6        b2 0.4868318 0.010009908   Uncorrelated (Correct)        0.48</span></span>
<span><span class="co">#&gt; 7        b2 0.4871118 0.009963588   Correlated (Incorrect)        0.48</span></span>
<span><span class="co">#&gt; 8        b2 0.4868318 0.010010119 Uncorrelated (Incorrect)        0.48</span></span>
<span></span>
<span><span class="co"># Display model fit statistics for each case</span></span>
<span><span class="va">fit_stats_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Correlated (Correct)"</span> <span class="op">=</span> <span class="va">results_corr</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Uncorrelated (Correct)"</span> <span class="op">=</span> <span class="va">results_uncorr</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Correlated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_corr_incorrect</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Uncorrelated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_uncorr_incorrect</span><span class="op">$</span><span class="va">fit_stats</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_stats_combined</span></span>
<span><span class="co">#&gt; $`Correlated (Correct)`</span></span>
<span><span class="co">#&gt;      aic      bic    rmsea    chisq </span></span>
<span><span class="co">#&gt; 77932.45 77997.34     0.00     0.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Uncorrelated (Correct)`</span></span>
<span><span class="co">#&gt;       aic       bic     rmsea     chisq </span></span>
<span><span class="co">#&gt; 84664.312 84721.995     0.000     0.421 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Correlated (Incorrect)`</span></span>
<span><span class="co">#&gt;       aic       bic     rmsea     chisq </span></span>
<span><span class="co">#&gt; 84453.208 84510.891     0.808  6522.762 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Uncorrelated (Incorrect)`</span></span>
<span><span class="co">#&gt;      aic      bic    rmsea    chisq </span></span>
<span><span class="co">#&gt; 84665.89 84730.78     0.00     0.00</span></span></code></pre></div>
</div>
</div>
<div id="multiple-treatments-1" class="section level4" number="36.1.3.2">
<h4>
<span class="header-section-number">36.1.3.2</span> Multiple Treatments<a class="anchor" aria-label="anchor" href="#multiple-treatments-1"><i class="fas fa-link"></i></a>
</h4>
<p><span class="citation">(<a href="references.html#ref-hayes2014statistical">Hayes and Preacher 2014</a>)</span></p>
<p>Code in <a href="https://core.ecu.edu/wuenschk/MV/multReg/Mediation_Multicategorical.pdf">Process</a></p>
</div>
</div>
</div>
<div id="causal-inference-approach" class="section level2" number="36.2">
<h2>
<span class="header-section-number">36.2</span> Causal Inference Approach<a class="anchor" aria-label="anchor" href="#causal-inference-approach"><i class="fas fa-link"></i></a>
</h2>
<div id="example-1-mediation-traditional" class="section level3" number="36.2.1">
<h3>
<span class="header-section-number">36.2.1</span> Example 1<a class="anchor" aria-label="anchor" href="#example-1-mediation-traditional"><i class="fas fa-link"></i></a>
</h3>
<p>from <a href="https://data.library.virginia.edu/introduction-to-mediation-analysis/">Virginia’s library</a></p>
<div class="sourceCode" id="cb845"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myData</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'http://static.lib.virginia.edu/statlab/materials/data/mediationData.csv'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 1 (no longer necessary)</span></span>
<span><span class="va">model.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -5.0262 -1.2340 -0.3282  1.5583  5.1622 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   2.8572     0.6932   4.122 7.88e-05 ***</span></span>
<span><span class="co">#&gt; X             0.3961     0.1112   3.564 0.000567 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.929 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1147, Adjusted R-squared:  0.1057 </span></span>
<span><span class="co">#&gt; F-statistic:  12.7 on 1 and 98 DF,  p-value: 0.0005671</span></span>
<span></span>
<span><span class="co"># Step 2</span></span>
<span><span class="va">model.M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">M</span> <span class="op">~</span> <span class="va">X</span>, <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.M</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = M ~ X, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.3046 -0.8656  0.1344  1.1344  4.6954 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.49952    0.58920   2.545   0.0125 *  </span></span>
<span><span class="co">#&gt; X            0.56102    0.09448   5.938 4.39e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.639 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2646, Adjusted R-squared:  0.2571 </span></span>
<span><span class="co">#&gt; F-statistic: 35.26 on 1 and 98 DF,  p-value: 4.391e-08</span></span>
<span></span>
<span><span class="co"># Step 3</span></span>
<span><span class="va">model.Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="va">M</span>, <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.Y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X + M, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.7631 -1.2393  0.0308  1.0832  4.0055 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   1.9043     0.6055   3.145   0.0022 ** </span></span>
<span><span class="co">#&gt; X             0.0396     0.1096   0.361   0.7187    </span></span>
<span><span class="co">#&gt; M             0.6355     0.1005   6.321 7.92e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.631 on 97 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.373,  Adjusted R-squared:  0.3601 </span></span>
<span><span class="co">#&gt; F-statistic: 28.85 on 2 and 97 DF,  p-value: 1.471e-10</span></span>
<span></span>
<span><span class="co"># Step 4 (boostrapping)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>    <span class="va">model.M</span>,</span>
<span>    <span class="va">model.Y</span>,</span>
<span>    treat <span class="op">=</span> <span class="st">'X'</span>,</span>
<span>    mediator <span class="op">=</span> <span class="st">'M'</span>,</span>
<span>    boot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sims <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Nonparametric Bootstrap Confidence Intervals with the Percentile Method</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME             0.3565       0.2119         0.51  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE              0.0396      -0.1750         0.28   0.760    </span></span>
<span><span class="co">#&gt; Total Effect     0.3961       0.1743         0.64   0.004 ** </span></span>
<span><span class="co">#&gt; Prop. Mediated   0.9000       0.5042         1.94   0.004 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 500</span></span></code></pre></div>
<ul>
<li><p>Total Effect = 0.3961 = <span class="math inline">\(b_1\)</span> (step 1) = total effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> without <span class="math inline">\(M\)</span></p></li>
<li><p>Direct Effect = ADE = 0.0396 = <span class="math inline">\(b_4\)</span> (step 3) = direct effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> accounting for the indirect effect of <span class="math inline">\(M\)</span></p></li>
<li><p>ACME = Average Causal Mediation Effects = <span class="math inline">\(b_1 - b_4\)</span> = 0.3961 - 0.0396 = 0.3565 = <span class="math inline">\(b_2 \times b_3\)</span> = 0.56102 * 0.6355 = 0.3565</p></li>
</ul>
<p>Using <code>mediation</code> package suggested by <span class="citation">Imai, Keele, and Yamamoto (<a href="references.html#ref-imai2010identification">2010</a>)</span>. More details of the package can be found <a href="https://cran.r-project.org/web/packages/mediation/vignettes/mediation.pdf">here</a></p>
<p>2 types of Inference in this package:</p>
<ol style="list-style-type: decimal">
<li>
<p>Model-based inference:</p>
<ul>
<li>
<p>Assumptions:</p>
<ul>
<li><p>Treatment is randomized (could use matching methods to achieve this).</p></li>
<li><p>Sequential Ignorability: conditional on covariates, there is other confounders that affect the relationship between (1) treatment-mediator, (2) treatment-outcome, (3) mediator-outcome. Typically hard to argue in observational data. This assumption is for the identification of ACME (i.e., average causal mediation effects).</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Design-based inference</p></li>
</ol>
<p>Notations: we stay consistent with package instruction</p>
<ul>
<li><p><span class="math inline">\(M_i(t)\)</span> = mediator</p></li>
<li><p><span class="math inline">\(T_i\)</span> = treatment status <span class="math inline">\((0,1)\)</span></p></li>
<li><p><span class="math inline">\(Y_i(t,m)\)</span> = outcome where <span class="math inline">\(t\)</span> = treatment, and <span class="math inline">\(m\)</span> = mediating variables.</p></li>
<li><p><span class="math inline">\(X_i\)</span> = vector of observed pre-treatment confounders</p></li>
<li>
<p>Treatment effect (per unit <span class="math inline">\(i\)</span>) = <span class="math inline">\(\tau_i = Y_i(1,M_i(1)) - Y_i (0,M_i(0))\)</span> which has 2 effects</p>
<ul>
<li><p>Causal mediation effects: <span class="math inline">\(\delta_i (t) \equiv Y_i (t,M_i(1)) - Y_i(t,M_i(0))\)</span></p></li>
<li><p>Direct effects: <span class="math inline">\(\zeta (t) \equiv Y_i (1, M_i(1)) - Y_i(0, M_i(0))\)</span></p></li>
<li><p>summing up to the treatment effect: <span class="math inline">\(\tau_i = \delta_i (t) + \zeta_i (1-t)\)</span></p></li>
</ul>
</li>
</ul>
<p>More on sequential ignorability</p>
<p><span class="math display">\[
\{ Y_i (t', m) , M_i (t) \} \perp T_i |X_i = x
\]</span></p>
<p><span class="math display">\[
Y_i(t',m) \perp M_i(t) | T_i = t, X_i = x
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(0 &lt; P(T_i = t | X_i = x)\)</span></p></li>
<li><p><span class="math inline">\(0 &lt; P(M_i = m | T_i = t , X_i =x)\)</span></p></li>
</ul>
<p>First condition is the standard strong ignorability condition where treatment assignment is random conditional on pre-treatment confounders.</p>
<p>Second condition is stronger where the mediators is also random given the observed treatment and pre-treatment confounders. This condition is satisfied only when there is no unobserved pre-treatment confounders, and post-treatment confounders, and multiple mediators that are correlated.</p>
<p>My understanding is that until the moment I write this note, there is <strong>no way to test the sequential ignorability assumption</strong>. Hence, researchers can only do sensitivity analysis to argue for their result.</p>
</div>
</div>
<div id="model-based-causal-mediation-analysis" class="section level2" number="36.3">
<h2>
<span class="header-section-number">36.3</span> Model-based causal mediation analysis<a class="anchor" aria-label="anchor" href="#model-based-causal-mediation-analysis"><i class="fas fa-link"></i></a>
</h2>
<p>Other resources:</p>
<ul>
<li><a href="https://cran.ism.ac.jp/web/packages/mediation/vignettes/mediation-old.pdf">here</a></li>
</ul>
<p>Fit 2 models</p>
<ul>
<li><p>mediator model: conditional distribution of the mediators <span class="math inline">\(M_i | T_i, X_i\)</span></p></li>
<li><p>Outcome model: conditional distribution of <span class="math inline">\(Y_i | T_i, M_i, X_i\)</span></p></li>
</ul>
<p><code>mediation</code> can accommodate almost all types of model for both mediator model and outcome model except Censored mediator model.</p>
<p>The update here is that estimation of ACME does not rely on product or difference of coefficients (see <a href="mediation.html#example-1-mediation-traditional">36.2.1</a> ,</p>
<p>which requires very strict assumption: (1) linear regression models of mediator and outcome, (2) <span class="math inline">\(T_i\)</span> and <span class="math inline">\(M_i\)</span> effects are additive and no interaction</p>
<div class="sourceCode" id="cb846"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2014</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"framing"</span>, package <span class="op">=</span> <span class="st">"mediation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">med.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">emo</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">framing</span><span class="op">)</span></span>
<span><span class="va">out.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>        <span class="va">cong_mesg</span> <span class="op">~</span> <span class="va">emo</span> <span class="op">+</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>        data <span class="op">=</span> <span class="va">framing</span>,</span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Quasi-Bayesian Monte Carlo </span></span>
<span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        robustSE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span> <span class="co"># should be 10000 in practice</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quasi-Bayesian Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.0791       0.0351         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.0804       0.0367         0.16  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)              0.0206      -0.0976         0.12    0.70    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.0218      -0.1053         0.12    0.70    </span></span>
<span><span class="co">#&gt; Total Effect               0.1009      -0.0497         0.23    0.14    </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.6946      -6.3109         3.68    0.14    </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.7118      -5.7936         3.50    0.14    </span></span>
<span><span class="co">#&gt; ACME (average)             0.0798       0.0359         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)              0.0212      -0.1014         0.12    0.70    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.7032      -6.0523         3.59    0.14    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span></code></pre></div>
<p>Nonparametric bootstrap version</p>
<div class="sourceCode" id="cb847"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        boot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span>, <span class="co"># should be 10000 in practice</span></span>
<span>        boot.ci.type <span class="op">=</span> <span class="st">"bca"</span> <span class="co"># bias-corrected and accelerated intervals</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Nonparametric Bootstrap Confidence Intervals with the BCa Method</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.0848       0.0424         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.0858       0.0410         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)              0.0117      -0.0726         0.13    0.58    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.0127      -0.0784         0.14    0.58    </span></span>
<span><span class="co">#&gt; Total Effect               0.0975       0.0122         0.25    0.06 .  </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.8698       1.7460       151.20    0.06 .  </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.8804       1.6879       138.91    0.06 .  </span></span>
<span><span class="co">#&gt; ACME (average)             0.0853       0.0434         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)              0.0122      -0.0756         0.14    0.58    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.8751       1.7170       145.05    0.06 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span></code></pre></div>
<p>If theoretically understanding suggests that there is treatment and mediator interaction</p>
<div class="sourceCode" id="cb848"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">emo</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">framing</span><span class="op">)</span></span>
<span><span class="va">out.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>        <span class="va">cong_mesg</span> <span class="op">~</span> <span class="va">emo</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>        data <span class="op">=</span> <span class="va">framing</span>,</span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        robustSE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quasi-Bayesian Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.07417      0.02401         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.09496      0.02702         0.16  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)             -0.01353     -0.11855         0.11    0.76    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.00726     -0.11007         0.11    0.90    </span></span>
<span><span class="co">#&gt; Total Effect               0.08143     -0.05646         0.19    0.26    </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.64510    -14.31243         3.13    0.26    </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.98006    -17.83202         4.01    0.26    </span></span>
<span><span class="co">#&gt; ACME (average)             0.08457      0.02738         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)             -0.00314     -0.11457         0.12    1.00    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.81258    -16.07223         3.55    0.26    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/mediation/man/test.TMint.html">test.TMint</a></span><span class="op">(</span><span class="va">med.out</span>, conf.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="co"># test treatment-mediator interaction effect </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Test of ACME(1) - ACME(0) = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  estimates from med.out</span></span>
<span><span class="co">#&gt; ACME(1) - ACME(0) = 0.020796, p-value = 0.3</span></span>
<span><span class="co">#&gt; alternative hypothesis: true ACME(1) - ACME(0) is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.01757310  0.07110837</span></span></code></pre></div>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="36-mediation_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><code>mediation</code> can be used in conjunction with any of your imputation packages.</p>
<p>And it can also handle <strong>mediated moderation</strong> or <strong>non-binary treatment variables</strong>, or <strong>multi-level data</strong></p>
<p>Sensitivity Analysis for sequential ignorability</p>
<ul>
<li><p>test for unobserved pre-treatment covariates</p></li>
<li><p><span class="math inline">\(\rho\)</span> = correlation between the residuals of the mediator and outcome regressions.</p></li>
<li><p>If <span class="math inline">\(\rho\)</span> is significant, we have evidence for violation of sequential ignorability (i.e., there is unobserved pre-treatment confounders).</p></li>
</ul>
<div class="sourceCode" id="cb850"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">emo</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">framing</span><span class="op">)</span></span>
<span><span class="va">out.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>        <span class="va">cong_mesg</span> <span class="op">~</span> <span class="va">emo</span> <span class="op">+</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>        data <span class="op">=</span> <span class="va">framing</span>,</span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        robustSE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">sens.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/medsens.html">medsens</a></span><span class="op">(</span><span class="va">med.out</span>,</span>
<span>            rho.by <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># \rho varies from -0.9 to 0.9 by 0.1</span></span>
<span>            effect.type <span class="op">=</span> <span class="st">"indirect"</span>, <span class="co"># sensitivity on ACME</span></span>
<span>            <span class="co"># effect.type = "direct", # sensitivity on ADE</span></span>
<span>            <span class="co"># effect.type = "both", # sensitivity on ACME and ADE</span></span>
<span>            sims <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sens.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mediation Sensitivity Analysis: Average Mediation Effect</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sensitivity Region: ACME for Control Group</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Rho ACME(control) 95% CI Lower 95% CI Upper R^2_M*R^2_Y* R^2_M~R^2_Y~</span></span>
<span><span class="co">#&gt; [1,] 0.3        0.0062      -0.0073       0.0188         0.09       0.0493</span></span>
<span><span class="co">#&gt; [2,] 0.4       -0.0084      -0.0238       0.0017         0.16       0.0877</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rho at which ACME for Control Group = 0: 0.3</span></span>
<span><span class="co">#&gt; R^2_M*R^2_Y* at which ACME for Control Group = 0: 0.09</span></span>
<span><span class="co">#&gt; R^2_M~R^2_Y~ at which ACME for Control Group = 0: 0.0493 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sensitivity Region: ACME for Treatment Group</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      Rho ACME(treated) 95% CI Lower 95% CI Upper R^2_M*R^2_Y* R^2_M~R^2_Y~</span></span>
<span><span class="co">#&gt; [1,] 0.3        0.0071      -0.0092       0.0213         0.09       0.0493</span></span>
<span><span class="co">#&gt; [2,] 0.4       -0.0101      -0.0295       0.0023         0.16       0.0877</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rho at which ACME for Treatment Group = 0: 0.3</span></span>
<span><span class="co">#&gt; R^2_M*R^2_Y* at which ACME for Treatment Group = 0: 0.09</span></span>
<span><span class="co">#&gt; R^2_M~R^2_Y~ at which ACME for Treatment Group = 0: 0.0493</span></span></code></pre></div>
<div class="sourceCode" id="cb851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens.out</span>, sens.par <span class="op">=</span> <span class="st">"rho"</span>, main <span class="op">=</span> <span class="st">"Anxiety"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>ACME confidence intervals contains 0 when <span class="math inline">\(\rho \in (0.3,0.4)\)</span></p>
<p>Alternatively, using <span class="math inline">\(R^2\)</span> interpretation, we need to specify the direction of confounder that affects the mediator and outcome variables in <code>plot</code> using <code>sign.prod = "positive"</code> (i.e., same direction) or <code>sign.prod = "negative"</code> (i.e., opposite direction).</p>
<div class="sourceCode" id="cb852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens.out</span>, sens.par <span class="op">=</span> <span class="st">"R2"</span>, r.type <span class="op">=</span> <span class="st">"total"</span>, sign.prod <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="controls.html"><span class="header-section-number">35</span> Controls</a></div>
<div class="next"><a href="directed-acyclic-graph.html"><span class="header-section-number">37</span> Directed Acyclic Graph</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#mediation"><span class="header-section-number">36</span> Mediation</a></li>
<li>
<a class="nav-link" href="#traditional-approach"><span class="header-section-number">36.1</span> Traditional Approach</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assumptions-2"><span class="header-section-number">36.1.1</span> Assumptions</a></li>
<li><a class="nav-link" href="#indirect-effect-tests"><span class="header-section-number">36.1.2</span> Indirect Effect Tests</a></li>
<li><a class="nav-link" href="#multiple-mediation"><span class="header-section-number">36.1.3</span> Multiple Mediation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#causal-inference-approach"><span class="header-section-number">36.2</span> Causal Inference Approach</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#example-1-mediation-traditional"><span class="header-section-number">36.2.1</span> Example 1</a></li></ul>
</li>
<li><a class="nav-link" href="#model-based-causal-mediation-analysis"><span class="header-section-number">36.3</span> Model-based causal mediation analysis</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/36-mediation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/36-mediation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-02-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
