<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 19 Mediation | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="19.1 Traditional Approach The classical mediation analysis follows the approach introduced by Baron and Kenny (1986), though it has limitations, particularly in requiring the first step (\(X \to...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 19 Mediation | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/mediation.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="19.1 Traditional Approach The classical mediation analysis follows the approach introduced by Baron and Kenny (1986), though it has limitations, particularly in requiring the first step (\(X \to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 19 Mediation | A Guide on Data Analysis">
<meta name="twitter:description" content="19.1 Traditional Approach The classical mediation analysis follows the approach introduced by Baron and Kenny (1986), though it has limitations, particularly in requiring the first step (\(X \to...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="active" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="sec-endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="sec-directed-acyclic-graphs.html"><span class="header-section-number">38</span> Directed Acyclic Graphs</a></li>
<li><a class="" href="sec-controls.html"><span class="header-section-number">39</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li><a class="" href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="mediation" class="section level1" number="19">
<h1>
<span class="header-section-number">19</span> Mediation<a class="anchor" aria-label="anchor" href="#mediation"><i class="fas fa-link"></i></a>
</h1>
<div id="traditional-approach" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Traditional Approach<a class="anchor" aria-label="anchor" href="#traditional-approach"><i class="fas fa-link"></i></a>
</h2>
<p>The classical mediation analysis follows the approach introduced by <span class="citation">Baron and Kenny (<a href="references.html#ref-baron1986moderator">1986</a>)</span>, though it has limitations, particularly in requiring the first step (<span class="math inline">\(X \to Y\)</span>) to be significant. Despite its shortcomings, this framework provides a useful foundation.</p>
<div id="steps-in-the-traditional-mediation-model" class="section level3" number="19.1.1">
<h3>
<span class="header-section-number">19.1.1</span> Steps in the Traditional Mediation Model<a class="anchor" aria-label="anchor" href="#steps-in-the-traditional-mediation-model"><i class="fas fa-link"></i></a>
</h3>
<p>Mediation is typically assessed through three regression models:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Total Effect</strong>: <span class="math inline">\(X \to Y\)</span>
</li>
<li>
<strong>Path</strong> <span class="math inline">\(a\)</span>: <span class="math inline">\(X \to M\)</span>
</li>
<li>
<strong>Path</strong> <span class="math inline">\(b\)</span> and Direct Effect (<span class="math inline">\(c'\)</span>): <span class="math inline">\(X + M \to Y\)</span>
</li>
</ol>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(X\)</span> = independent (causal) variable</li>
<li>
<span class="math inline">\(Y\)</span> = dependent (outcome) variable</li>
<li>
<span class="math inline">\(M\)</span> = mediating variable</li>
</ul>
<p>Originally, <span class="citation">Baron and Kenny (<a href="references.html#ref-baron1986moderator">1986</a>)</span> required the direct path <span class="math inline">\(X \to Y\)</span> to be significant. However, mediation can still occur even if this direct effect is not significant. For example:</p>
<ul>
<li><p>The effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> might be <strong>fully absorbed</strong> by <span class="math inline">\(M\)</span>.</p></li>
<li><p>Multiple mediators (<span class="math inline">\(M_1, M_2\)</span>) with <strong>opposing effects</strong> could cancel each other out, leading to a non-significant direct effect.</p></li>
</ul>
</div>
<div id="graphical-representation-of-mediation" class="section level3" number="19.1.2">
<h3>
<span class="header-section-number">19.1.2</span> Graphical Representation of Mediation<a class="anchor" aria-label="anchor" href="#graphical-representation-of-mediation"><i class="fas fa-link"></i></a>
</h3>
<div id="unmediated-model" class="section level4" number="19.1.2.1">
<h4>
<span class="header-section-number">19.1.2.1</span> Unmediated Model<a class="anchor" aria-label="anchor" href="#unmediated-model"><i class="fas fa-link"></i></a>
</h4>
<div class="float">
<img src="images/mediation/direct_mod.png" style="width:90.0%" alt="Unmediated model"><div class="figcaption">Unmediated model</div>
</div>
<p>Here, <span class="math inline">\(c\)</span> represents the <strong>total effect</strong> of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.</p>
</div>
<div id="mediated-model" class="section level4" number="19.1.2.2">
<h4>
<span class="header-section-number">19.1.2.2</span> Mediated Model<a class="anchor" aria-label="anchor" href="#mediated-model"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-figure"><img src="images/mediation/full_mod.png" style="width:90.0%"></div>
<p>Here:</p>
<ul>
<li>
<span class="math inline">\(c'\)</span> = <strong>direct effect</strong> (effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> after accounting for mediation)</li>
<li>
<span class="math inline">\(ab\)</span> = <strong>indirect effect</strong> (mediation pathway)</li>
</ul>
<p>Thus, we can express:</p>
<p><span class="math display">\[
\text{total effect} = \text{direct effect} + \text{indirect effect}
\]</span></p>
<p>or,</p>
<p><span class="math display">\[
c = c' + ab
\]</span></p>
<p>This equation holds under standard linear models but not necessarily in cases such as:</p>
<ol style="list-style-type: decimal">
<li>Latent variable models</li>
<li>Logistic regression (only an approximation)</li>
<li>Multilevel models <span class="citation">(<a href="references.html#ref-bauer2006conceptualizing">Bauer, Preacher, and Gil 2006</a>)</span>
</li>
</ol>
<hr>
</div>
</div>
<div id="measuring-mediation" class="section level3" number="19.1.3">
<h3>
<span class="header-section-number">19.1.3</span> Measuring Mediation<a class="anchor" aria-label="anchor" href="#measuring-mediation"><i class="fas fa-link"></i></a>
</h3>
<p>Several approaches exist for quantifying the <strong>indirect effect</strong> (<span class="math inline">\(ab\)</span>):</p>
<ol style="list-style-type: decimal">
<li><p><strong>Proportional Reduction Approach</strong>:<br><span class="math display">\[1 - \frac{c'}{c}\]</span><br><em>Not recommended</em> due to high instability, especially when <span class="math inline">\(c\)</span> is small <span class="citation">(<a href="references.html#ref-mackinnon1995simulation">D. P. MacKinnon, Warsi, and Dwyer 1995</a>)</span>.</p></li>
<li><p><strong>Product Method</strong>:<br><span class="math display">\[a \times b\]</span><br>
The most common approach.</p></li>
<li><p><strong>Difference Method</strong>:<br><span class="math display">\[c - c'\]</span><br>
Conceptually similar to the product method but less precise in small samples.</p></li>
</ol>
<hr>
</div>
<div id="assumptions-in-linear-mediation-models" class="section level3" number="19.1.4">
<h3>
<span class="header-section-number">19.1.4</span> Assumptions in Linear Mediation Models<a class="anchor" aria-label="anchor" href="#assumptions-in-linear-mediation-models"><i class="fas fa-link"></i></a>
</h3>
<p>For valid mediation analysis, the following assumptions should hold:</p>
<ol style="list-style-type: decimal">
<li>
<strong>No unmeasured confounders</strong> between <span class="math inline">\(X-Y\)</span>, <span class="math inline">\(X-M\)</span>, and <span class="math inline">\(M-Y\)</span>.</li>
<li>
<strong>No reverse causality</strong>: <span class="math inline">\(X\)</span> should not be influenced by a confounder (<span class="math inline">\(C\)</span>) that also affects <span class="math inline">\(M-Y\)</span>.</li>
<li>
<strong>Measurement reliability</strong>: <span class="math inline">\(M\)</span> should be measured without error (if not, consider errors-in-variables models).</li>
</ol>
<hr>
<p><strong>Regression Equations for Mediation Steps</strong></p>
<p>Step 1: Total Effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span></p>
<p><span class="math display">\[
Y = \beta_0 + cX + \epsilon
\]</span></p>
<ul>
<li>The significance of <span class="math inline">\(c\)</span> is <strong>not required</strong> for mediation to occur.</li>
</ul>
<p>Step 2: Effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(M\)</span></p>
<p><span class="math display">\[
M = \alpha_0 + aX + \epsilon
\]</span></p>
<ul>
<li>The coefficient <span class="math inline">\(a\)</span> must be significant for mediation analysis to proceed.</li>
</ul>
<p>Step 3: Effect of <span class="math inline">\(M\)</span> on <span class="math inline">\(Y\)</span> (Including <span class="math inline">\(X\)</span>)</p>
<p><span class="math display">\[
Y = \gamma_0 + c'X + bM + \epsilon
\]</span></p>
<ul>
<li>If <span class="math inline">\(c'\)</span> becomes non-significant after including <span class="math inline">\(M\)</span>, full mediation occurs.</li>
<li>If <span class="math inline">\(c'\)</span> is reduced but remains significant, partial mediation is present.</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>Interpretation of Mediation Outcomes</caption>
<thead><tr class="header">
<th>Effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>
</th>
<th>Mediation Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<span class="math inline">\(b_4\)</span> (from Step 3) is <strong>insignificant</strong>
</td>
<td>Full mediation</td>
</tr>
<tr class="even">
<td>
<span class="math inline">\(b_4 &lt; b_1\)</span> (from Step 1) but still significant</td>
<td>Partial mediation</td>
</tr>
</tbody>
</table></div>
<hr>
</div>
<div id="testing-for-mediation" class="section level3" number="19.1.5">
<h3>
<span class="header-section-number">19.1.5</span> Testing for Mediation<a class="anchor" aria-label="anchor" href="#testing-for-mediation"><i class="fas fa-link"></i></a>
</h3>
<p>Several statistical tests exist to assess whether the indirect effect (<span class="math inline">\(ab\)</span>) is significant:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sobel Test</strong> <span class="citation">(<a href="references.html#ref-sobel1982asymptotic">Sobel 1982</a>)</span>
<ul>
<li>Based on the standard error of <span class="math inline">\(ab\)</span>.</li>
<li>
<strong>Limitation</strong>: Assumes normality of <span class="math inline">\(ab\)</span>, which may not hold in small samples.</li>
</ul>
</li>
<li>
<strong>Joint Significance Test</strong>
<ul>
<li>If both <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are significant, mediation is likely.</li>
</ul>
</li>
<li>
<strong>Bootstrapping (Preferred)</strong> <span class="citation">Shrout and Bolger (<a href="references.html#ref-shrout2002mediation">2002</a>)</span>
<ul>
<li>Estimates the confidence interval for <span class="math inline">\(ab\)</span>.</li>
<li>Does not assume normality.</li>
<li>Recommended for small-to-moderate sample sizes.</li>
</ul>
</li>
</ol>
<hr>
</div>
<div id="additional-considerations" class="section level3" number="19.1.6">
<h3>
<span class="header-section-number">19.1.6</span> Additional Considerations<a class="anchor" aria-label="anchor" href="#additional-considerations"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Proximal mediation (where path <span class="math inline">\(a\)</span> exceeds path <span class="math inline">\(b\)</span>) can lead to multicollinearity and reduced statistical power. In contrast, distal mediation (where path <span class="math inline">\(b\)</span> exceeds path <span class="math inline">\(a\)</span>) tends to maximize power. In fact, slightly distal mediators—where <span class="math inline">\(b\)</span> is somewhat larger than <span class="math inline">\(a\)</span>—often strike an ideal balance for power in mediation analyses <span class="citation">(<a href="references.html#ref-hoyle1999statistical">Hoyle 1999</a>)</span>.</li>
<li>Tests of direct effects (<span class="math inline">\(c\)</span> and <span class="math inline">\(c'\)</span>) generally have lower power than tests of the indirect effect (<span class="math inline">\(ab\)</span>). As a result, it is possible for the indirect effect (<span class="math inline">\(ab\)</span>) to be statistically significant even when the direct effect (<span class="math inline">\(c\)</span>) is not. This situation can appear to indicate “complete mediation,” yet the lack of a statistically significant direct effect between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> (i.e., <span class="math inline">\(c'\)</span>) does not definitively rule out other possibilities <span class="citation">(<a href="references.html#ref-kenny2014power">Kenny and Judd 2014</a>)</span>.</li>
<li>Because testing <span class="math inline">\(ab\)</span> essentially combines two tests, it often provides a power advantage over testing <span class="math inline">\(c'\)</span> alone. However, using a non-significant <span class="math inline">\(c'\)</span> as the sole criterion for claiming complete mediation should be done cautiously—if at all—given the importance of adequate sample size and power. Indeed, <span class="citation">Hayes and Scharkow (<a href="references.html#ref-hayes2013relative">2013</a>)</span> recommend avoiding claims of complete mediation based solely on a non-significant <span class="math inline">\(c'\)</span>, particularly when partial mediation may still be present.</li>
</ul>
<hr>
</div>
<div id="assumptions-in-mediation-analysis" class="section level3" number="19.1.7">
<h3>
<span class="header-section-number">19.1.7</span> Assumptions in Mediation Analysis<a class="anchor" aria-label="anchor" href="#assumptions-in-mediation-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Valid mediation analysis requires several key assumptions, which can be categorized into <strong>causal direction</strong>, <strong>interaction effects</strong>, <strong>measurement reliability</strong>, and <strong>confounding control</strong>.</p>
<hr>
<div id="direction" class="section level4" number="19.1.7.1">
<h4>
<span class="header-section-number">19.1.7.1</span> Direction<a class="anchor" aria-label="anchor" href="#direction"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Causal Order of Variables</p></li>
<li><p>A simple but weak solution is to measure <span class="math inline">\(X\)</span> before <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> to prevent reverse causality (i.e., <span class="math inline">\(M\)</span> or <span class="math inline">\(Y\)</span> causing <span class="math inline">\(X\)</span>). Similarly, measuring <span class="math inline">\(M\)</span> before <span class="math inline">\(Y\)</span> avoids feedback effects of <span class="math inline">\(Y\)</span> on <span class="math inline">\(M\)</span>.</p></li>
<li>
<p>However, causal feedback loops between <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> may still exist.</p>
<ul>
<li><p>If we assume full mediation (<span class="math inline">\(c' = 0\)</span>), models with reciprocal causal effects between <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> can be estimated using instrumental variables (IV).</p></li>
<li><p><span class="citation">E. R. Smith (<a href="references.html#ref-smith1982beliefs">1982</a>)</span> suggests treating both <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> as potential mediators of each other, requiring distinct instrumental variables for each to avoid cross-contamination of causal effects.</p></li>
</ul>
</li>
</ul>
<hr>
</div>
<div id="interaction-effects-in-mediation" class="section level4" number="19.1.7.2">
<h4>
<span class="header-section-number">19.1.7.2</span> Interaction Effects in Mediation<a class="anchor" aria-label="anchor" href="#interaction-effects-in-mediation"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>If <span class="math inline">\(M\)</span> interacts with <span class="math inline">\(X\)</span> in predicting <span class="math inline">\(Y\)</span>, then <span class="math inline">\(M\)</span> is both a mediator and a moderator <span class="citation">(<a href="references.html#ref-baron1986moderator">Baron and Kenny 1986</a>)</span>.</p></li>
<li><p><strong>The interaction term</strong> <span class="math inline">\(X \times M\)</span> should always be included in the model to account for possible moderation effects.</p></li>
<li><p>For interpreting such interactions in mediation models, see <span class="citation">(<a href="references.html#ref-vanderweele2015explanation">T. VanderWeele 2015</a>)</span>, who provides a framework for <strong>moderated mediation</strong> analysis.</p></li>
</ul>
<hr>
</div>
<div id="reliability" class="section level4" number="19.1.7.3">
<h4>
<span class="header-section-number">19.1.7.3</span> Reliability<a class="anchor" aria-label="anchor" href="#reliability"><i class="fas fa-link"></i></a>
</h4>
<p>Measurement error in any of the three key variables (<span class="math inline">\(X, M, Y\)</span>) can bias estimates of mediation effects.</p>
<ol style="list-style-type: decimal">
<li>Measurement Error in the Mediator (<span class="math inline">\(M\)</span>):
<ul>
<li>Biases both <span class="math inline">\(b\)</span> and <span class="math inline">\(c'\)</span>.</li>
<li>Potential solution: Model <span class="math inline">\(M\)</span> as a latent variable (reduces bias but may decrease statistical power) <span class="citation">(<a href="references.html#ref-ledgerwood2011trade">Ledgerwood and Shrout 2011</a>)</span>.</li>
<li>Specific effects:
<ul>
<li>
<span class="math inline">\(b\)</span> is attenuated (biased toward 0).</li>
<li>
<span class="math inline">\(c'\)</span> is:
<ul>
<li>Overestimated if <span class="math inline">\(ab &gt; 0\)</span>.</li>
<li>Underestimated if <span class="math inline">\(ab &lt; 0\)</span>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Measurement Error in the Treatment (<span class="math inline">\(X\)</span>):
<ul>
<li>Biases both <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</li>
<li>Specific effects:
<ul>
<li>
<span class="math inline">\(a\)</span> is attenuated.</li>
<li>
<span class="math inline">\(b\)</span> is:
<ul>
<li>Overestimated if <span class="math inline">\(ac' &gt; 0\)</span>.</li>
<li>Underestimated if <span class="math inline">\(ac' &lt; 0\)</span>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Measurement Error in the Outcome (<span class="math inline">\(Y\)</span>):
<ul>
<li>If unstandardized, there is no bias.</li>
<li>If standardized, there is attenuation bias (reduced effect sizes due to error variance).</li>
</ul>
</li>
</ol>
<hr>
</div>
<div id="confounding-in-mediation-analysis" class="section level4" number="19.1.7.4">
<h4>
<span class="header-section-number">19.1.7.4</span> Confounding in Mediation Analysis<a class="anchor" aria-label="anchor" href="#confounding-in-mediation-analysis"><i class="fas fa-link"></i></a>
</h4>
<p>Omitted variable bias can distort any of the three core relationships (<span class="math inline">\(X \to Y\)</span>, <span class="math inline">\(X \to M\)</span>, <span class="math inline">\(M \to Y\)</span>). Addressing confounding requires either design-based or statistical solutions.</p>
<p><strong>Design-Based Strategies (Preferred if Feasible)</strong></p>
<ul>
<li>Randomization of the independent variable (<span class="math inline">\(X\)</span>) reduces confounding bias.</li>
<li>Randomization of the mediator (<span class="math inline">\(M\)</span>), if possible, further strengthens causal claims.</li>
<li>Controlling for measured confounders, though this only addresses observable confounding.</li>
</ul>
<p><strong>Statistical Strategies (When Randomization is Not Possible)</strong></p>
<ol style="list-style-type: decimal">
<li>Instrumental Variables Approach:
<ul>
<li>Used when a confounder affects both <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span>.</li>
<li>Front-door adjustment can be applied if there exists a third variable that fully mediates the effect of <span class="math inline">\(M\)</span> on <span class="math inline">\(Y\)</span> while being independent of the confounder.</li>
</ul>
</li>
<li>Weighting Methods (e.g., Inverse Probability Weighting - IPW):
<ul>
<li>Corrects for confounding by reweighting observations to balance confounders across treatment groups.</li>
<li>Requires the strong ignorability assumption: All confounders must be measured and correctly specified <span class="citation">(<a href="references.html#ref-westfall2016statistically">Westfall and Yarkoni 2016</a>)</span>.</li>
<li>While this assumption cannot be formally tested, sensitivity analyses can help assess robustness.</li>
<li>See <a href="https://www.andrewheiss.com/blog/2020/12/01/ipw-binary-continuous/">Heiss</a> for R code on implementing IPW in mediation models.</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div id="indirect-effect-tests" class="section level3" number="19.1.8">
<h3>
<span class="header-section-number">19.1.8</span> Indirect Effect Tests<a class="anchor" aria-label="anchor" href="#indirect-effect-tests"><i class="fas fa-link"></i></a>
</h3>
<p>Testing the indirect effect (<span class="math inline">\(ab\)</span>) is crucial in mediation analysis. Several methods exist, each with its advantages and limitations.</p>
<hr>
<div id="sobel-test-delta-method" class="section level4" number="19.1.8.1">
<h4>
<span class="header-section-number">19.1.8.1</span> Sobel Test (Delta Method)<a class="anchor" aria-label="anchor" href="#sobel-test-delta-method"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Developed by <span class="citation">Sobel (<a href="references.html#ref-sobel1982asymptotic">1982</a>)</span>.</li>
<li>Also known as the delta method.</li>
<li>Not recommended because it assumes the sampling distribution of <span class="math inline">\(ab\)</span> is normal, which often does not hold <span class="citation">(<a href="references.html#ref-mackinnon1995simulation">D. P. MacKinnon, Warsi, and Dwyer 1995</a>)</span>.</li>
</ul>
<p>The standard error (SE) of the indirect effect is:</p>
<p><span class="math display">\[
SE_{ab} = \sqrt{\hat{b}^2 s_{\hat{a}}^2 + \hat{a}^2 s_{\hat{b}}^2}
\]</span></p>
<p>The <strong>Z-statistic</strong> for testing whether <span class="math inline">\(ab\)</span> is significantly different from 0 is:</p>
<p><span class="math display">\[
z = \frac{\hat{ab}}{\sqrt{\hat{b}^2 s_{\hat{a}}^2 + \hat{a}^2 s_{\hat{b}}^2}}
\]</span></p>
<p><strong>Disadvantages</strong></p>
<ul>
<li>Assumes <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are independent.</li>
<li>Assumes <span class="math inline">\(ab\)</span> follows a normal distribution.</li>
<li>Poor performance in small samples.</li>
<li>Lower power and more conservative than bootstrapping.</li>
</ul>
<p><strong>Special Case: Inconsistent Mediation</strong></p>
<ul>
<li>Mediation can occur even when <strong>direct and indirect effects</strong> have <strong>opposite signs</strong>, known as <strong>inconsistent mediation</strong> <span class="citation">(<a href="references.html#ref-mackinnon2007mediation">D. P. MacKinnon, Fairchild, and Fritz 2007</a>)</span>.</li>
<li>This happens when the <strong>mediator acts as a suppressor variable</strong>, leading to counteracting paths.</li>
</ul>
<div class="sourceCode" id="cb632"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">bda</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"boundsdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sobel Test for Mediation</span></span>
<span><span class="fu">bda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bda/man/medtest.html">mediation.test</a></span><span class="op">(</span><span class="va">boundsdata</span><span class="op">$</span><span class="va">med</span>, <span class="va">boundsdata</span><span class="op">$</span><span class="va">ttt</span>, <span class="va">boundsdata</span><span class="op">$</span><span class="va">out</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/nice_tab.html">nice_tab</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   rowname Sobel Aroian Goodman</span></span>
<span><span class="co">#&gt; 1 z.value  4.05   4.03    4.07</span></span>
<span><span class="co">#&gt; 2 p.value  0.00   0.00    0.00</span></span></code></pre></div>
<hr>
</div>
<div id="joint-significance-test" class="section level4" number="19.1.8.2">
<h4>
<span class="header-section-number">19.1.8.2</span> Joint Significance Test<a class="anchor" aria-label="anchor" href="#joint-significance-test"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Tests if the indirect effect is nonzero by checking whether both <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are statistically significant.</li>
<li>Assumes <span class="math inline">\(a \perp b\)</span> (independence of paths).</li>
<li>Performs similarly to bootstrapping <span class="citation">(<a href="references.html#ref-hayes2013relative">Hayes and Scharkow 2013</a>)</span>.</li>
<li>More robust to non-normality but can be sensitive to heteroscedasticity <span class="citation">(<a href="references.html#ref-fossum2023use">Fossum and Montoya 2023</a>)</span>.</li>
<li>Does not provide confidence intervals, making effect size interpretation harder.</li>
</ul>
<hr>
</div>
<div id="bootstrapping-preferred-method" class="section level4" number="19.1.8.3">
<h4>
<span class="header-section-number">19.1.8.3</span> Bootstrapping (Preferred Method)<a class="anchor" aria-label="anchor" href="#bootstrapping-preferred-method"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>First applied to mediation by <span class="citation">Bollen and Stine (<a href="references.html#ref-bollen1990direct">1990</a>)</span>.</li>
<li>Uses resampling to empirically estimate the sampling distribution of the indirect effect.</li>
<li>Does not require normality assumptions or <span class="math inline">\(a \perp b\)</span> independence.</li>
<li>Works well with small samples.</li>
<li>Can handle complex models.</li>
</ul>
<p><strong>Which Bootstrapping Method?</strong></p>
<ul>
<li>
<strong>Percentile bootstrap</strong> is preferred due to better <strong>Type I error rates</strong> <span class="citation">(<a href="references.html#ref-tibbe2022correcting">Tibbe and Montoya 2022</a>)</span>.</li>
<li>
<strong>Bias-corrected bootstrapping</strong> can be too <strong>liberal</strong> (inflates Type I errors) <span class="citation">(<a href="references.html#ref-fritz2012explanation">Fritz, Taylor, and MacKinnon 2012</a>)</span>.</li>
</ul>
<p><strong>Special Case: Meta-Analytic Bootstrapping</strong></p>
<ul>
<li>Bootstrapping can be applied <strong>without raw data</strong>, using only <span class="math inline">\(a, b, var(a), var(b), cov(a,b)\)</span> from multiple studies.</li>
</ul>
<div class="sourceCode" id="cb633"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Meta-Analytic Bootstrapping for Mediation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">causalverse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/med_ind.html">med_ind</a></span><span class="op">(</span></span>
<span>    a <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>    b <span class="op">=</span> <span class="fl">0.7</span>, </span>
<span>    var_a <span class="op">=</span> <span class="fl">0.04</span>, </span>
<span>    var_b <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>    cov_ab <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<div class="inline-figure"><img src="19-mediation_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>When an <strong>instrumental variable (IV)</strong> is available, the causal effect can be estimated more reliably. Below are visual representations.</p>
<div class="sourceCode" id="cb634"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rich-iannone.github.io/DiagrammeR/">DiagrammeR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simple Treatment-Outcome Model</span></span>
<span><span class="fu">grViz</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">digraph {</span></span>
<span><span class="st">  graph []</span></span>
<span><span class="st">  node [shape = plaintext]</span></span>
<span><span class="st">    X [label = 'Treatment']</span></span>
<span><span class="st">    Y [label = 'Outcome']</span></span>
<span><span class="st">  edge [minlen = 2]</span></span>
<span><span class="st">    X-&gt;Y</span></span>
<span><span class="st">  { rank = same; X; Y }</span></span>
<span><span class="st">}"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mediation Model with an Instrument</span></span>
<span><span class="fu">grViz</span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">digraph {</span></span>
<span><span class="st">  graph []</span></span>
<span><span class="st">  node [shape = plaintext]</span></span>
<span><span class="st">    X [label ='Treatment', shape = box]</span></span>
<span><span class="st">    Y [label ='Outcome', shape = box]</span></span>
<span><span class="st">    M [label ='Mediator', shape = box]</span></span>
<span><span class="st">    IV [label ='Instrument', shape = box]</span></span>
<span><span class="st">  edge [minlen = 2]</span></span>
<span><span class="st">    IV-&gt;X</span></span>
<span><span class="st">    X-&gt;M  </span></span>
<span><span class="st">    M-&gt;Y </span></span>
<span><span class="st">    X-&gt;Y </span></span>
<span><span class="st">  { rank = same; X; Y; M }</span></span>
<span><span class="st">}"</span><span class="op">)</span></span></code></pre></div>
<p>Mediation Analysis with Fixed Effects Models</p>
<div class="sourceCode" id="cb635"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"boundsdata"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 1: Total Effect (c)</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Indirect Effect (a)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">med</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Direct &amp; Indirect Effect (c' &amp; b)</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">med</span> <span class="op">+</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">boundsdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Proportion of Mediation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out2</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out3</span><span class="op">)</span><span class="op">[</span><span class="st">'med'</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co">#&gt;      ttt </span></span>
<span><span class="co">#&gt; 68.63609</span></span></code></pre></div>
<p>Bootstrapped Mediation Analysis</p>
<div class="sourceCode" id="cb636"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the bootstrapping function</span></span>
<span><span class="va">mediation_fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">a_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">med</span> <span class="op">~</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">a_path</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">b_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">out</span> <span class="op">~</span> <span class="va">med</span> <span class="op">+</span> <span class="va">ttt</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">b_path</span><span class="op">)</span><span class="op">[</span><span class="st">'med'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">b_path</span><span class="op">)</span><span class="op">[</span><span class="st">'ttt'</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Indirect Effect (a * b)</span></span>
<span>    <span class="va">ind_ef</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span></span>
<span>    <span class="va">total_ef</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">+</span> <span class="va">cp</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ind_ef</span>, <span class="va">total_ef</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Perform Bootstrapping</span></span>
<span><span class="va">boot_med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span><span class="op">(</span><span class="va">boundsdata</span>, <span class="va">mediation_fn</span>, R <span class="op">=</span> <span class="fl">100</span>, parallel <span class="op">=</span> <span class="st">"multicore"</span>, ncpus <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">boot_med</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ORDINARY NONPARAMETRIC BOOTSTRAP</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; boot(data = boundsdata, statistic = mediation_fn, R = 100, parallel = "multicore", </span></span>
<span><span class="co">#&gt;     ncpus = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap Statistics :</span></span>
<span><span class="co">#&gt;       original        bias    std. error</span></span>
<span><span class="co">#&gt; t1* 0.04112035  0.0006346725 0.009539903</span></span>
<span><span class="co">#&gt; t2* 0.05991068 -0.0004462572 0.029556611</span></span>
<span></span>
<span><span class="co"># Summary and Confidence Intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">boot_med</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/nice_tab.html">nice_tab</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     R original bootBias bootSE bootMed</span></span>
<span><span class="co">#&gt; 1 100     0.04        0   0.01    0.04</span></span>
<span><span class="co">#&gt; 2 100     0.06        0   0.03    0.06</span></span>
<span></span>
<span><span class="co"># Confidence Intervals (percentile bootstrap preferred)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.ci.html">boot.ci</a></span><span class="op">(</span><span class="va">boot_med</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"perc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span><span class="co">#&gt; Based on 100 bootstrap replicates</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CALL : </span></span>
<span><span class="co">#&gt; boot.ci(boot.out = boot_med, type = c("norm", "perc"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intervals : </span></span>
<span><span class="co">#&gt; Level      Normal             Percentile     </span></span>
<span><span class="co">#&gt; 95%   ( 0.0218,  0.0592 )   ( 0.0249,  0.0623 )  </span></span>
<span><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span><span class="co">#&gt; Some percentile intervals may be unstable</span></span>
<span></span>
<span><span class="co"># Point Estimates (Indirect and Total Effects)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">colMeans</a></span><span class="op">(</span><span class="va">boot_med</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.04175502 0.05946442</span></span></code></pre></div>
<p>Alternatively, use the <code>robmed</code> package for <strong>robust</strong> mediation analysis:</p>
<div class="sourceCode" id="cb637"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/aalfons/robmed">robmed</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="power-analysis-for-mediation" class="section level3" number="19.1.9">
<h3>
<span class="header-section-number">19.1.9</span> Power Analysis for Mediation<a class="anchor" aria-label="anchor" href="#power-analysis-for-mediation"><i class="fas fa-link"></i></a>
</h3>
<p>To assess whether the study has sufficient <strong>power</strong> to detect mediation effects, use:</p>
<div class="sourceCode" id="cb638"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pwr2ppl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Power analysis for the indirect effect (ab path)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pwr2ppl/man/medjs.html">medjs</a></span><span class="op">(</span></span>
<span>    rx1m1 <span class="op">=</span> <span class="fl">.3</span>,  <span class="co"># Correlation: X → M (path a)</span></span>
<span>    rx1y  <span class="op">=</span> <span class="fl">.1</span>,  <span class="co"># Correlation: X → Y (path c')</span></span>
<span>    rym1  <span class="op">=</span> <span class="fl">.3</span>,  <span class="co"># Correlation: M → Y (path b)</span></span>
<span>    n     <span class="op">=</span> <span class="fl">100</span>, <span class="co"># Sample size</span></span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    mvars <span class="op">=</span> <span class="fl">1</span>,   <span class="co"># Number of mediators</span></span>
<span>    rep   <span class="op">=</span> <span class="fl">1000</span> <span class="co"># Replications (use 10,000 for accuracy)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For <strong>interactive</strong> power analysis, see <a href="https://davidakenny.shinyapps.io/MedPower/">Kenny’s Mediation Power App</a>.</p>
<p><strong>Summary of Indirect Effect Tests</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="29%">
<col width="40%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th><strong>Test</strong></th>
<th><strong>Pros</strong></th>
<th><strong>Cons</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Sobel Test</strong></td>
<td>Simple, fast</td>
<td>Assumes normality, low power</td>
</tr>
<tr class="even">
<td><strong>Joint Significance Test</strong></td>
<td>Robust to non-normality</td>
<td>No confidence interval</td>
</tr>
<tr class="odd">
<td>
<strong>Bootstrapping</strong> (Recommended)</td>
<td>No normality assumption, handles small samples</td>
<td>May be liberal if bias-corrected</td>
</tr>
</tbody>
</table></div>
</div>
<div id="multiple-mediation-analysis" class="section level3" number="19.1.10">
<h3>
<span class="header-section-number">19.1.10</span> Multiple Mediation Analysis<a class="anchor" aria-label="anchor" href="#multiple-mediation-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>In some cases, a single mediator (<span class="math inline">\(M\)</span>) does not fully capture the indirect effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>. Multiple mediation models extend traditional mediation by including two or more mediators, allowing us to examine how multiple pathways contribute to an outcome.</p>
<hr>
<p>Several R packages handle multiple mediation models:</p>
<ul>
<li>
<strong>manymome</strong>: A flexible package for multiple mediation modeling.
<ul>
<li><a href="https://cran.r-project.org/web/packages/manymome/vignettes/med_lm.html">Vignette</a></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb639"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/manymome/">manymome</a></span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<p><strong>mma</strong>: Used for multiple mediator models.</p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/mma/mma.pdf">Package PDF</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/mma/vignettes/MMAvignette.html">Vignette</a></p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb640"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">mma</a></span><span class="op">)</span></span></code></pre></div>
<div id="multiple-mediators-structural-equation-modeling-approach" class="section level4" number="19.1.10.1">
<h4>
<span class="header-section-number">19.1.10.1</span> Multiple Mediators: Structural Equation Modeling Approach<a class="anchor" aria-label="anchor" href="#multiple-mediators-structural-equation-modeling-approach"><i class="fas fa-link"></i></a>
</h4>
<p>A popular method for estimating multiple mediation models is <strong>Structural Equation Modeling</strong> using <strong>lavaan</strong>.</p>
<p>To test multiple mediation, we first <strong>simulate data</strong> where two mediators (<span class="math inline">\(M_1\)</span> and <span class="math inline">\(M_2\)</span>) contribute to the outcome (<span class="math inline">\(Y\)</span>).</p>
<div class="sourceCode" id="cb641"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>  <span class="co"># For mvrnorm (generating correlated errors)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to generate synthetic data</span></span>
<span><span class="va">generate_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">10000</span>, <span class="va">a1</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">a2</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>, </span>
<span>                          <span class="va">b1</span> <span class="op">=</span> <span class="fl">0.7</span>, <span class="va">b2</span> <span class="op">=</span> <span class="fl">0.48</span>, </span>
<span>                          <span class="va">corr</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">correlation_value</span> <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span>    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Independent variable</span></span>
<span>    </span>
<span>    <span class="co"># Generate correlated errors for mediators</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">correlation_value</span>, <span class="va">correlation_value</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">M1</span> <span class="op">&lt;-</span> <span class="va">a1</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">M2</span> <span class="op">&lt;-</span> <span class="va">a2</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">Y</span>  <span class="op">&lt;-</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">M1</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">*</span> <span class="va">M2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Outcome variable</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, M1 <span class="op">=</span> <span class="va">M1</span>, M2 <span class="op">=</span> <span class="va">M2</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We analyze the indirect effects through both mediators (<span class="math inline">\(M_1\)</span> and <span class="math inline">\(M_2\)</span>).</p>
<ol style="list-style-type: decimal">
<li>Correctly Modeling Correlated Mediators</li>
</ol>
<div class="sourceCode" id="cb642"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate data with correlated mediators</span></span>
<span><span class="va">Data_corr</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, corr <span class="op">=</span> <span class="cn">TRUE</span>, correlation_value <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define SEM model for multiple mediation</span></span>
<span><span class="va">model_corr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">  M1 ~~ M2  # Correlated mediators (modeling correlation correctly)</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit SEM model</span></span>
<span><span class="va">fit_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model_corr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract parameter estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit_corr</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lhs"</span>, <span class="st">"rhs"</span>, <span class="st">"est"</span>, <span class="st">"se"</span>, <span class="st">"pvalue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;    lhs rhs    est    se pvalue</span></span>
<span><span class="co">#&gt; 1    Y  M1  0.700 0.014  0.000</span></span>
<span><span class="co">#&gt; 2    Y  M2  0.487 0.014  0.000</span></span>
<span><span class="co">#&gt; 3    Y   X -0.009 0.015  0.545</span></span>
<span><span class="co">#&gt; 4   M1   X  0.519 0.010  0.000</span></span>
<span><span class="co">#&gt; 5   M2   X -0.340 0.010  0.000</span></span>
<span><span class="co">#&gt; 6   M1  M2  0.677 0.012  0.000</span></span>
<span><span class="co">#&gt; 7    Y   Y  0.975 0.014  0.000</span></span>
<span><span class="co">#&gt; 8   M1  M1  0.973 0.014  0.000</span></span>
<span><span class="co">#&gt; 9   M2  M2  0.982 0.014  0.000</span></span>
<span><span class="co">#&gt; 10   X   X  1.000 0.000     NA</span></span></code></pre></div>
<p>2. Incorrectly Ignoring Correlation Between Mediators</p>
<div class="sourceCode" id="cb643"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define SEM model without modeling mediator correlation</span></span>
<span><span class="va">model_uncorr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co"># Fit incorrect model</span></span>
<span><span class="va">fit_uncorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">model_uncorr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare parameter estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit_uncorr</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lhs"</span>, <span class="st">"rhs"</span>, <span class="st">"est"</span>, <span class="st">"se"</span>, <span class="st">"pvalue"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   lhs rhs    est    se pvalue</span></span>
<span><span class="co">#&gt; 1   Y  M1  0.700 0.010  0.000</span></span>
<span><span class="co">#&gt; 2   Y  M2  0.487 0.010  0.000</span></span>
<span><span class="co">#&gt; 3   Y   X -0.009 0.012  0.443</span></span>
<span><span class="co">#&gt; 4  M1   X  0.519 0.010  0.000</span></span>
<span><span class="co">#&gt; 5  M2   X -0.340 0.010  0.000</span></span>
<span><span class="co">#&gt; 6   Y   Y  0.975 0.014  0.000</span></span>
<span><span class="co">#&gt; 7  M1  M1  0.973 0.014  0.000</span></span>
<span><span class="co">#&gt; 8  M2  M2  0.982 0.014  0.000</span></span>
<span><span class="co">#&gt; 9   X   X  1.000 0.000     NA</span></span></code></pre></div>
<p><strong>Comparison of Model Fits</strong></p>
<p>To check whether modeling correlation matters, we compare AIC and RMSEA.</p>
<div class="sourceCode" id="cb644"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract model fit statistics</span></span>
<span><span class="va">fit_measures</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html">fitMeasures</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"bic"</span>, <span class="st">"rmsea"</span>, <span class="st">"chisq"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare model fits</span></span>
<span><span class="fu">fit_measures</span><span class="op">(</span><span class="va">fit_corr</span><span class="op">)</span>  <span class="co"># Correct model (correlated mediators)</span></span>
<span><span class="co">#&gt;      aic      bic    rmsea    chisq </span></span>
<span><span class="co">#&gt; 77932.45 77997.34     0.00     0.00</span></span>
<span><span class="fu">fit_measures</span><span class="op">(</span><span class="va">fit_uncorr</span><span class="op">)</span>  <span class="co"># Incorrect model (ignores correlation)</span></span>
<span><span class="co">#&gt;       aic       bic     rmsea     chisq </span></span>
<span><span class="co">#&gt; 84453.208 84510.891     0.808  6522.762</span></span></code></pre></div>
<ul>
<li>If AIC and RMSEA are lower in the correlated model, it suggests that accounting for correlated errors improves fit.</li>
</ul>
<p>After fitting the model, we assess:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Direct Effect</strong>: The effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> <strong>after accounting for both mediators</strong> (<span class="math inline">\(c'\)</span>).</p></li>
<li>
<p><strong>Indirect Effects</strong>:</p>
<ul>
<li><p><span class="math inline">\(a_1 \times b_1\)</span>: Effect of <span class="math inline">\(X \to M_1 \to Y\)</span>.</p></li>
<li><p><span class="math inline">\(a_2 \times b_2\)</span>: Effect of <span class="math inline">\(X \to M_2 \to Y\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Total Effect</strong>: Sum of direct and indirect effects.</p></li>
</ol>
<div class="sourceCode" id="cb645"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract indirect and direct effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit_corr</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    lhs op rhs label    est    se       z pvalue ci.lower ci.upper std.lv</span></span>
<span><span class="co">#&gt; 1    Y  ~  M1    b1  0.700 0.014  50.489  0.000    0.673    0.727  0.700</span></span>
<span><span class="co">#&gt; 2    Y  ~  M2    b2  0.487 0.014  35.284  0.000    0.460    0.514  0.487</span></span>
<span><span class="co">#&gt; 3    Y  ~   X     c -0.009 0.015  -0.606  0.545   -0.038    0.020 -0.009</span></span>
<span><span class="co">#&gt; 4   M1  ~   X    a1  0.519 0.010  52.563  0.000    0.499    0.538  0.519</span></span>
<span><span class="co">#&gt; 5   M2  ~   X    a2 -0.340 0.010 -34.314  0.000   -0.360   -0.321 -0.340</span></span>
<span><span class="co">#&gt; 6   M1 ~~  M2        0.677 0.012  56.915  0.000    0.654    0.700  0.677</span></span>
<span><span class="co">#&gt; 7    Y ~~   Y        0.975 0.014  70.711  0.000    0.948    1.002  0.975</span></span>
<span><span class="co">#&gt; 8   M1 ~~  M1        0.973 0.014  70.711  0.000    0.946    1.000  0.973</span></span>
<span><span class="co">#&gt; 9   M2 ~~  M2        0.982 0.014  70.711  0.000    0.955    1.010  0.982</span></span>
<span><span class="co">#&gt; 10   X ~~   X        1.000 0.000      NA     NA    1.000    1.000  1.000</span></span>
<span><span class="co">#&gt;    std.all std.nox</span></span>
<span><span class="co">#&gt; 1    0.528   0.528</span></span>
<span><span class="co">#&gt; 2    0.345   0.345</span></span>
<span><span class="co">#&gt; 3   -0.006  -0.006</span></span>
<span><span class="co">#&gt; 4    0.465   0.465</span></span>
<span><span class="co">#&gt; 5   -0.325  -0.325</span></span>
<span><span class="co">#&gt; 6    0.692   0.692</span></span>
<span><span class="co">#&gt; 7    0.447   0.447</span></span>
<span><span class="co">#&gt; 8    0.784   0.784</span></span>
<span><span class="co">#&gt; 9    0.895   0.895</span></span>
<span><span class="co">#&gt; 10   1.000   1.000</span></span></code></pre></div>
<p>If <span class="math inline">\(c'\)</span> is reduced (but still significant), we have partial mediation. If <span class="math inline">\(c' \approx 0\)</span>, it suggests full mediation.</p>
<div class="sourceCode" id="cb646"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>  <span class="co"># for mvrnorm</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to generate synthetic data with correctly correlated errors for mediators</span></span>
<span><span class="va">generate_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>           <span class="va">a1</span> <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           <span class="va">a2</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.35</span>,</span>
<span>           <span class="va">b1</span> <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>           <span class="va">b2</span> <span class="op">=</span> <span class="fl">0.48</span>,</span>
<span>           <span class="va">corr</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           <span class="va">correlation_value</span> <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span>    <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Generate correlated errors using a multivariate normal distribution</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">correlation_value</span>, <span class="va">correlation_value</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Higher covariance matrix for errors</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span>  <span class="co"># Generate correlated errors</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">errors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Independent errors</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">M1</span> <span class="op">&lt;-</span> <span class="va">a1</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">M2</span> <span class="op">&lt;-</span> <span class="va">a2</span> <span class="op">*</span> <span class="va">X</span> <span class="op">+</span> <span class="va">errors</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">M1</span> <span class="op">+</span> <span class="va">b2</span> <span class="op">*</span> <span class="va">M2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Y depends on M1 and M2</span></span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, M1 <span class="op">=</span> <span class="va">M1</span>, M2 <span class="op">=</span> <span class="va">M2</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Ground truth for comparison</span></span>
<span><span class="va">ground_truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span>, GroundTruth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to extract relevant estimates, standard errors, and model fit</span></span>
<span><span class="va">extract_estimates_b1_b2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/parameterEstimates.html">parameterEstimates</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="va">estimates</span><span class="op">$</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"Y"</span> <span class="op">&amp;</span> <span class="va">estimates</span><span class="op">$</span><span class="va">rhs</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rhs"</span>, <span class="st">"est"</span>, <span class="st">"se"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">estimates</span><span class="op">$</span><span class="va">Parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">$</span><span class="va">rhs</span> <span class="op">==</span> <span class="st">"M1"</span>, <span class="st">"b1"</span>, <span class="st">"b2"</span><span class="op">)</span></span>
<span>    <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"est"</span>, <span class="st">"se"</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">fit_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html">fitMeasures</a></span><span class="op">(</span><span class="va">fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"bic"</span>, <span class="st">"rmsea"</span>, <span class="st">"chisq"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span>estimates <span class="op">=</span> <span class="va">estimates</span>, fit_stats <span class="op">=</span> <span class="va">fit_stats</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Case 1: Correlated errors for mediators (modeled correctly)</span></span>
<span><span class="va">Data_corr</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, corr <span class="op">=</span> <span class="cn">TRUE</span>, correlation_value <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="va">model_corr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">  M1 ~~ M2  # Correlated mediators (errors)</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_corr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span><span class="va">results_corr</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_corr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 2: Uncorrelated errors for mediators (modeled correctly)</span></span>
<span><span class="va">Data_uncorr</span> <span class="op">&lt;-</span> <span class="fu">generate_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, corr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">model_uncorr</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  Y ~ b1 * M1 + b2 * M2 + c * X</span></span>
<span><span class="st">  M1 ~ a1 * X</span></span>
<span><span class="st">  M2 ~ a2 * X</span></span>
<span><span class="st">'</span></span>
<span><span class="va">fit_uncorr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_uncorr</span>, data <span class="op">=</span> <span class="va">Data_uncorr</span><span class="op">)</span></span>
<span><span class="va">results_uncorr</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_uncorr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 3: Correlated errors, but not modeled as correlated</span></span>
<span><span class="va">fit_corr_incorrect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_uncorr</span>, data <span class="op">=</span> <span class="va">Data_corr</span><span class="op">)</span></span>
<span><span class="va">results_corr_incorrect</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_corr_incorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Case 4: Uncorrelated errors, but modeled as correlated</span></span>
<span><span class="va">fit_uncorr_incorrect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model_corr</span>, data <span class="op">=</span> <span class="va">Data_uncorr</span><span class="op">)</span></span>
<span><span class="va">results_uncorr_incorrect</span> <span class="op">&lt;-</span> <span class="fu">extract_estimates_b1_b2</span><span class="op">(</span><span class="va">fit_uncorr_incorrect</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all estimates for comparison</span></span>
<span><span class="va">estimates_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Correlated (Correct)"</span> <span class="op">=</span> <span class="va">results_corr</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Uncorrelated (Correct)"</span> <span class="op">=</span> <span class="va">results_uncorr</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Correlated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_corr_incorrect</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>    <span class="st">"Uncorrelated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_uncorr_incorrect</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all into a single table</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">estimates_combined</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">case</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">estimates_combined</span><span class="op">[[</span><span class="va">case</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">Case</span> <span class="op">&lt;-</span> <span class="va">case</span></span>
<span>    <span class="va">df</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge with ground truth for final comparison</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">comparison_table</span>, <span class="va">ground_truth</span>, by <span class="op">=</span> <span class="st">"Parameter"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the comparison table</span></span>
<span><span class="va">comparison_table</span></span>
<span><span class="co">#&gt;   Parameter       est          se                     Case GroundTruth</span></span>
<span><span class="co">#&gt; 1        b1 0.7002984 0.013870433     Correlated (Correct)        0.70</span></span>
<span><span class="co">#&gt; 2        b1 0.6973612 0.009859426   Uncorrelated (Correct)        0.70</span></span>
<span><span class="co">#&gt; 3        b1 0.7002984 0.010010367   Correlated (Incorrect)        0.70</span></span>
<span><span class="co">#&gt; 4        b1 0.6973612 0.009859634 Uncorrelated (Incorrect)        0.70</span></span>
<span><span class="co">#&gt; 5        b2 0.4871118 0.013805615     Correlated (Correct)        0.48</span></span>
<span><span class="co">#&gt; 6        b2 0.4868318 0.010009908   Uncorrelated (Correct)        0.48</span></span>
<span><span class="co">#&gt; 7        b2 0.4871118 0.009963588   Correlated (Incorrect)        0.48</span></span>
<span><span class="co">#&gt; 8        b2 0.4868318 0.010010119 Uncorrelated (Incorrect)        0.48</span></span>
<span></span>
<span><span class="co"># Display model fit statistics for each case</span></span>
<span><span class="va">fit_stats_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Correlated (Correct)"</span> <span class="op">=</span> <span class="va">results_corr</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Uncorrelated (Correct)"</span> <span class="op">=</span> <span class="va">results_uncorr</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Correlated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_corr_incorrect</span><span class="op">$</span><span class="va">fit_stats</span>,</span>
<span>    <span class="st">"Uncorrelated (Incorrect)"</span> <span class="op">=</span> <span class="va">results_uncorr_incorrect</span><span class="op">$</span><span class="va">fit_stats</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_stats_combined</span></span>
<span><span class="co">#&gt; $`Correlated (Correct)`</span></span>
<span><span class="co">#&gt;      aic      bic    rmsea    chisq </span></span>
<span><span class="co">#&gt; 77932.45 77997.34     0.00     0.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Uncorrelated (Correct)`</span></span>
<span><span class="co">#&gt;       aic       bic     rmsea     chisq </span></span>
<span><span class="co">#&gt; 84664.312 84721.995     0.000     0.421 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Correlated (Incorrect)`</span></span>
<span><span class="co">#&gt;       aic       bic     rmsea     chisq </span></span>
<span><span class="co">#&gt; 84453.208 84510.891     0.808  6522.762 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Uncorrelated (Incorrect)`</span></span>
<span><span class="co">#&gt;      aic      bic    rmsea    chisq </span></span>
<span><span class="co">#&gt; 84665.89 84730.78     0.00     0.00</span></span></code></pre></div>
</div>
</div>
<div id="multiple-treatments-in-mediation" class="section level3" number="19.1.11">
<h3>
<span class="header-section-number">19.1.11</span> Multiple Treatments in Mediation<a class="anchor" aria-label="anchor" href="#multiple-treatments-in-mediation"><i class="fas fa-link"></i></a>
</h3>
<p>In some cases, <strong>multiple independent variables</strong> (<span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>) influence the same mediators. This is called <strong>multiple treatments mediation</strong> <span class="citation">(<a href="references.html#ref-hayes2014statistical">Hayes and Preacher 2014</a>)</span>.</p>
<p>For an example in <strong>PROCESS (SPSS/R)</strong>, see:<br><a href="https://core.ecu.edu/wuenschk/MV/multReg/Mediation_Multicategorical.pdf">Process Mediation with Multiple Treatments</a>.</p>
</div>
</div>
<div id="causal-inference-approach-to-mediation" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Causal Inference Approach to Mediation<a class="anchor" aria-label="anchor" href="#causal-inference-approach-to-mediation"><i class="fas fa-link"></i></a>
</h2>
<p>Traditional mediation models assume that regression-based estimates provide valid causal inference. However, <strong>causal mediation analysis</strong> (CMA) extends beyond traditional models by explicitly defining mediation in terms of <strong>potential outcomes and counterfactuals</strong>.</p>
<hr>
<div id="sec-example-traditional-mediation-analysis" class="section level3" number="19.2.1">
<h3>
<span class="header-section-number">19.2.1</span> Example: Traditional Mediation Analysis<a class="anchor" aria-label="anchor" href="#sec-example-traditional-mediation-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>We begin with a classic <strong>three-step mediation approach</strong>.</p>
<div class="sourceCode" id="cb647"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="va">myData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"data/mediationData.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 1 (Total Effect: X → Y) [No longer required]</span></span>
<span><span class="va">model.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.0</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -5.0262 -1.2340 -0.3282  1.5583  5.1622 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   2.8572     0.6932   4.122 7.88e-05 ***</span></span>
<span><span class="co">#&gt; X             0.3961     0.1112   3.564 0.000567 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.929 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1147, Adjusted R-squared:  0.1057 </span></span>
<span><span class="co">#&gt; F-statistic:  12.7 on 1 and 98 DF,  p-value: 0.0005671</span></span>
<span></span>
<span><span class="co"># Step 2 (Effect of X on M)</span></span>
<span><span class="va">model.M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">M</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.M</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = M ~ X, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -4.3046 -0.8656  0.1344  1.1344  4.6954 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.49952    0.58920   2.545   0.0125 *  </span></span>
<span><span class="co">#&gt; X            0.56102    0.09448   5.938 4.39e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.639 on 98 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2646, Adjusted R-squared:  0.2571 </span></span>
<span><span class="co">#&gt; F-statistic: 35.26 on 1 and 98 DF,  p-value: 4.391e-08</span></span>
<span></span>
<span><span class="co"># Step 3 (Effect of M on Y, controlling for X)</span></span>
<span><span class="va">model.Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="va">M</span>, data <span class="op">=</span> <span class="va">myData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model.Y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X + M, data = myData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -3.7631 -1.2393  0.0308  1.0832  4.0055 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   1.9043     0.6055   3.145   0.0022 ** </span></span>
<span><span class="co">#&gt; X             0.0396     0.1096   0.361   0.7187    </span></span>
<span><span class="co">#&gt; M             0.6355     0.1005   6.321 7.92e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.631 on 97 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.373,  Adjusted R-squared:  0.3601 </span></span>
<span><span class="co">#&gt; F-statistic: 28.85 on 2 and 97 DF,  p-value: 1.471e-10</span></span>
<span></span>
<span><span class="co"># Step 4: Bootstrapping for ACME</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">model.M</span>,</span>
<span>        <span class="va">model.Y</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">'X'</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">'M'</span>,</span>
<span>        boot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">500</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Nonparametric Bootstrap Confidence Intervals with the Percentile Method</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME             0.3565       0.2119         0.51  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE              0.0396      -0.1750         0.28   0.760    </span></span>
<span><span class="co">#&gt; Total Effect     0.3961       0.1743         0.64   0.004 ** </span></span>
<span><span class="co">#&gt; Prop. Mediated   0.9000       0.5042         1.94   0.004 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 500</span></span></code></pre></div>
<ul>
<li>
<strong>Total Effect</strong>: <span class="math inline">\(\hat{c} = 0.3961\)</span> → effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> <strong>without</strong> controlling for <span class="math inline">\(M\)</span>.</li>
<li>
<strong>Direct Effect (ADE)</strong>: <span class="math inline">\(\hat{c'} = 0.0396\)</span> → effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> <strong>after</strong> accounting for <span class="math inline">\(M\)</span>.</li>
<li>
<strong>ACME (Average Causal Mediation Effect)</strong>:
<ul>
<li><p>ACME = <span class="math inline">\(\hat{c} - \hat{c'} = 0.3961 - 0.0396 = 0.3565\)</span></p></li>
<li><p>Equivalent to <strong>product of paths</strong>: <span class="math inline">\(\hat{a} \times \hat{b} = 0.56102 \times 0.6355 = 0.3565\)</span>.</p></li>
</ul>
</li>
</ul>
<p>These calculations do not rely on strong causal assumptions. For a causal interpretation, we need a more rigorous framework.</p>
</div>
<div id="two-approaches-in-causal-mediation-analysis" class="section level3" number="19.2.2">
<h3>
<span class="header-section-number">19.2.2</span> Two Approaches in Causal Mediation Analysis<a class="anchor" aria-label="anchor" href="#two-approaches-in-causal-mediation-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>mediation</code> package <span class="citation">Imai, Keele, and Yamamoto (<a href="references.html#ref-imai2010identification">2010</a>)</span> enables <strong>causal mediation analysis</strong>. It supports two inference types:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Model-Based Inference</strong></p>
<ul>
<li>
<p>Assumptions:</p>
<ul>
<li><p>Treatment is randomized (or approximated via matching).</p></li>
<li>
<p>Sequential Ignorability: No unobserved confounding in:</p>
<ol style="list-style-type: decimal">
<li><p>Treatment → Mediator</p></li>
<li><p>Treatment → Outcome</p></li>
<li><p>Mediator → Outcome</p></li>
</ol>
</li>
<li><p>This assumption is hard to justify in observational studies.</p></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Design-Based Inference</strong></p>
<ul>
<li>Relies on experimental design to isolate the causal mechanism.</li>
</ul>
</li>
</ol>
<p><strong>Notation</strong></p>
<p>We follow the standard potential outcomes framework:</p>
<ul>
<li><p><span class="math inline">\(M_i(t)\)</span> = mediator under treatment condition <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(T_i \in {0,1}\)</span> = treatment assignment</p></li>
<li><p><span class="math inline">\(Y_i(t, m)\)</span> = outcome under treatment <span class="math inline">\(t\)</span> and mediator value <span class="math inline">\(m\)</span></p></li>
<li><p><span class="math inline">\(X_i\)</span> = observed pre-treatment covariates</p></li>
</ul>
<p>The <strong>treatment effect</strong> for an individual <span class="math inline">\(i\)</span>: <span class="math display">\[
\tau_i = Y_i(1,M_i(1)) - Y_i (0,M_i(0))
\]</span> which decomposes into:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Causal Mediation Effect (ACME)</strong>:</li>
</ol>
<p><span class="math display">\[
\delta_i (t) = Y_i (t,M_i(1)) - Y_i(t,M_i(0))
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Direct Effect (ADE)</strong>:</li>
</ol>
<p><span class="math display">\[
\zeta_i (t) = Y_i (1, M_i(1)) - Y_i(0, M_i(0))
\]</span></p>
<p>Summing up:</p>
<p><span class="math display">\[
\tau_i = \delta_i (t) + \zeta_i (1-t)
\]</span></p>
<p><strong>Sequential Ignorability Assumption</strong></p>
<p>For CMA to be valid, we assume:</p>
<p><span class="math display">\[
\begin{aligned}
\{ Y_i (t', m), M_i (t) \} &amp;\perp T_i |X_i = x\\
Y_i(t',m) &amp;\perp M_i(t) | T_i = t, X_i = x
\end{aligned}
\]</span></p>
<ul>
<li><p>First condition is the standard strong ignorability condition where treatment assignment is random conditional on pre-treatment confounders.</p></li>
<li><p>Second condition is stronger where the mediators is also random given the observed treatment and pre-treatment confounders. This condition is satisfied only when there is no unobserved pre-treatment confounders, and post-treatment confounders, and multiple mediators that are correlated.</p></li>
</ul>
<p><strong>Key Challenge</strong></p>
<p>⚠️ <strong>Sequential Ignorability is not testable.</strong> Researchers should conduct <strong>sensitivity analysis</strong>.</p>
<p>We now fit a <strong>causal mediation model</strong> using <code>mediation</code>.</p>
<div class="sourceCode" id="cb648"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2014</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"framing"</span>, package <span class="op">=</span> <span class="st">"mediation"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 1: Fit mediator model (M ~ T, X)</span></span>
<span><span class="va">med.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">emo</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">framing</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Fit outcome model (Y ~ M, T, X)</span></span>
<span><span class="va">out.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>        <span class="va">cong_mesg</span> <span class="op">~</span> <span class="va">emo</span> <span class="op">+</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>        data <span class="op">=</span> <span class="va">framing</span>,</span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Causal Mediation Analysis (Quasi-Bayesian)</span></span>
<span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        robustSE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="op">)</span>  <span class="co"># Use sims = 10000 in practice</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quasi-Bayesian Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.0791       0.0351         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.0804       0.0367         0.16  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)              0.0206      -0.0976         0.12    0.70    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.0218      -0.1053         0.12    0.70    </span></span>
<span><span class="co">#&gt; Total Effect               0.1009      -0.0497         0.23    0.14    </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.6946      -6.3109         3.68    0.14    </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.7118      -5.7936         3.50    0.14    </span></span>
<span><span class="co">#&gt; ACME (average)             0.0798       0.0359         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)              0.0212      -0.1014         0.12    0.70    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.7032      -6.0523         3.59    0.14    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span></code></pre></div>
<p><strong>Alternative: Nonparametric Bootstrap</strong></p>
<div class="sourceCode" id="cb649"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        boot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span>,</span>
<span>        boot.ci.type <span class="op">=</span> <span class="st">"bca"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Nonparametric Bootstrap Confidence Intervals with the BCa Method</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.0848       0.0424         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.0858       0.0410         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)              0.0117      -0.0726         0.13    0.58    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.0127      -0.0784         0.14    0.58    </span></span>
<span><span class="co">#&gt; Total Effect               0.0975       0.0122         0.25    0.06 .  </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.8698       1.7460       151.20    0.06 .  </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.8804       1.6879       138.91    0.06 .  </span></span>
<span><span class="co">#&gt; ACME (average)             0.0853       0.0434         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)              0.0122      -0.0756         0.14    0.58    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.8751       1.7170       145.05    0.06 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span></code></pre></div>
<p>If we suspect <strong>moderation</strong>, we include an <strong>interaction term</strong>.</p>
<div class="sourceCode" id="cb650"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">med.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">emo</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">framing</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out.fit</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span></span>
<span>        <span class="va">cong_mesg</span> <span class="op">~</span> <span class="va">emo</span> <span class="op">*</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">gender</span> <span class="op">+</span> <span class="va">income</span>,</span>
<span>        data <span class="op">=</span> <span class="va">framing</span>,</span>
<span>        family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"probit"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">med.out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span></span>
<span>        <span class="va">med.fit</span>,</span>
<span>        <span class="va">out.fit</span>,</span>
<span>        treat <span class="op">=</span> <span class="st">"treat"</span>,</span>
<span>        mediator <span class="op">=</span> <span class="st">"emo"</span>,</span>
<span>        robustSE <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        sims <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">med.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Causal Mediation Analysis </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Quasi-Bayesian Confidence Intervals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Estimate 95% CI Lower 95% CI Upper p-value    </span></span>
<span><span class="co">#&gt; ACME (control)             0.07417      0.02401         0.14  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ACME (treated)             0.09496      0.02702         0.16  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (control)             -0.01353     -0.11855         0.11    0.76    </span></span>
<span><span class="co">#&gt; ADE (treated)              0.00726     -0.11007         0.11    0.90    </span></span>
<span><span class="co">#&gt; Total Effect               0.08143     -0.05646         0.19    0.26    </span></span>
<span><span class="co">#&gt; Prop. Mediated (control)   0.64510    -14.31243         3.13    0.26    </span></span>
<span><span class="co">#&gt; Prop. Mediated (treated)   0.98006    -17.83202         4.01    0.26    </span></span>
<span><span class="co">#&gt; ACME (average)             0.08457      0.02738         0.15  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ADE (average)             -0.00314     -0.11457         0.12    1.00    </span></span>
<span><span class="co">#&gt; Prop. Mediated (average)   0.81258    -16.07223         3.55    0.26    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Size Used: 265 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulations: 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/mediation/man/test.TMint.html">test.TMint</a></span><span class="op">(</span><span class="va">med.out</span>, conf.level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span>  <span class="co"># Tests for interaction effect</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Test of ACME(1) - ACME(0) = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  estimates from med.out</span></span>
<span><span class="co">#&gt; ACME(1) - ACME(0) = 0.020796, p-value = 0.3</span></span>
<span><span class="co">#&gt; alternative hypothesis: true ACME(1) - ACME(0) is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.01757310  0.07110837</span></span></code></pre></div>
<p>Since <strong>sequential ignorability</strong> is untestable, we examine how unmeasured confounding affects ACME estimates.</p>
<div class="sourceCode" id="cb651"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://imai.princeton.edu/projects/mechanisms.html">mediation</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate some example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  treat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,       <span class="co"># Binary treatment</span></span>
<span>  med <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,                   <span class="co"># Continuous mediator</span></span>
<span>  outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>                 <span class="co"># Continuous outcome</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the mediator model (med ~ treat)</span></span>
<span><span class="va">med_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">med</span> <span class="op">~</span> <span class="va">treat</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the outcome model (outcome ~ treat + med)</span></span>
<span><span class="va">outcome_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">+</span> <span class="va">med</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform mediation analysis</span></span>
<span><span class="va">med_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/mediate.html">mediate</a></span><span class="op">(</span><span class="va">med_model</span>, </span>
<span>                   <span class="va">outcome_model</span>, </span>
<span>                   treat <span class="op">=</span> <span class="st">"treat"</span>, </span>
<span>                   mediator <span class="op">=</span> <span class="st">"med"</span>, </span>
<span>                   sims <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conduct sensitivity analysis</span></span>
<span><span class="va">sens_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mediation/man/medsens.html">medsens</a></span><span class="op">(</span><span class="va">med_out</span>, sims <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print and plot results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sens_out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mediation Sensitivity Analysis for Average Causal Mediation Effect</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sensitivity Region</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;        Rho    ACME 95% CI Lower 95% CI Upper R^2_M*R^2_Y* R^2_M~R^2_Y~</span></span>
<span><span class="co">#&gt;  [1,] -0.9 -0.6194      -1.3431       0.1043         0.81       0.7807</span></span>
<span><span class="co">#&gt;  [2,] -0.8 -0.3898      -0.8479       0.0682         0.64       0.6168</span></span>
<span><span class="co">#&gt;  [3,] -0.7 -0.2790      -0.6096       0.0516         0.49       0.4723</span></span>
<span><span class="co">#&gt;  [4,] -0.6 -0.2067      -0.4552       0.0418         0.36       0.3470</span></span>
<span><span class="co">#&gt;  [5,] -0.5 -0.1525      -0.3406       0.0355         0.25       0.2409</span></span>
<span><span class="co">#&gt;  [6,] -0.4 -0.1083      -0.2487       0.0321         0.16       0.1542</span></span>
<span><span class="co">#&gt;  [7,] -0.3 -0.0700      -0.1723       0.0323         0.09       0.0867</span></span>
<span><span class="co">#&gt;  [8,] -0.2 -0.0354      -0.1097       0.0389         0.04       0.0386</span></span>
<span><span class="co">#&gt;  [9,] -0.1 -0.0028      -0.0648       0.0591         0.01       0.0096</span></span>
<span><span class="co">#&gt; [10,]  0.0  0.0287      -0.0416       0.0990         0.00       0.0000</span></span>
<span><span class="co">#&gt; [11,]  0.1  0.0603      -0.0333       0.1538         0.01       0.0096</span></span>
<span><span class="co">#&gt; [12,]  0.2  0.0928      -0.0317       0.2173         0.04       0.0386</span></span>
<span><span class="co">#&gt; [13,]  0.3  0.1275      -0.0333       0.2882         0.09       0.0867</span></span>
<span><span class="co">#&gt; [14,]  0.4  0.1657      -0.0369       0.3684         0.16       0.1542</span></span>
<span><span class="co">#&gt; [15,]  0.5  0.2100      -0.0422       0.4621         0.25       0.2409</span></span>
<span><span class="co">#&gt; [16,]  0.6  0.2642      -0.0495       0.5779         0.36       0.3470</span></span>
<span><span class="co">#&gt; [17,]  0.7  0.3364      -0.0601       0.7329         0.49       0.4723</span></span>
<span><span class="co">#&gt; [18,]  0.8  0.4473      -0.0771       0.9717         0.64       0.6168</span></span>
<span><span class="co">#&gt; [19,]  0.9  0.6768      -0.1135       1.4672         0.81       0.7807</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rho at which ACME = 0: -0.1</span></span>
<span><span class="co">#&gt; R^2_M*R^2_Y* at which ACME = 0: 0.01</span></span>
<span><span class="co">#&gt; R^2_M~R^2_Y~ at which ACME = 0: 0.0096</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens_out</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="19-mediation_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;"></div>
<ul>
<li>If ACME confidence intervals contain 0, the effect is not robust to confounding.</li>
</ul>
<p>Alternatively, using <span class="math inline">\(R^2\)</span> interpretation, we need to specify the direction of confounder that affects the mediator and outcome variables in <code>plot</code> using <code>sign.prod = "positive"</code> (i.e., same direction) or <code>sign.prod = "negative"</code> (i.e., opposite direction).</p>
<div class="sourceCode" id="cb652"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sens.out</span>, sens.par <span class="op">=</span> <span class="st">"R2"</span>, r.type <span class="op">=</span> <span class="st">"total"</span>, sign.prod <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Summary: Causal Mediation vs. Traditional Mediation</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="31%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th><strong>Aspect</strong></th>
<th><strong>Traditional Mediation</strong></th>
<th><strong>Causal Mediation</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Model Assumption</strong></td>
<td>Linear regressions</td>
<td>Potential outcomes framework</td>
</tr>
<tr class="even">
<td><strong>Assumptions Needed</strong></td>
<td>No omitted confounders</td>
<td>Sequential ignorability</td>
</tr>
<tr class="odd">
<td><strong>Inference Method</strong></td>
<td>Product of coefficients</td>
<td>Counterfactual reasoning</td>
</tr>
<tr class="even">
<td><strong>Bootstrapping?</strong></td>
<td>Common</td>
<td>Essential</td>
</tr>
<tr class="odd">
<td><strong>Sensitivity Analysis?</strong></td>
<td>Rarely used</td>
<td>Strongly recommended</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="moderation.html"><span class="header-section-number">18</span> Moderation</a></div>
<div class="next"><a href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#mediation"><span class="header-section-number">19</span> Mediation</a></li>
<li>
<a class="nav-link" href="#traditional-approach"><span class="header-section-number">19.1</span> Traditional Approach</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#steps-in-the-traditional-mediation-model"><span class="header-section-number">19.1.1</span> Steps in the Traditional Mediation Model</a></li>
<li><a class="nav-link" href="#graphical-representation-of-mediation"><span class="header-section-number">19.1.2</span> Graphical Representation of Mediation</a></li>
<li><a class="nav-link" href="#measuring-mediation"><span class="header-section-number">19.1.3</span> Measuring Mediation</a></li>
<li><a class="nav-link" href="#assumptions-in-linear-mediation-models"><span class="header-section-number">19.1.4</span> Assumptions in Linear Mediation Models</a></li>
<li><a class="nav-link" href="#testing-for-mediation"><span class="header-section-number">19.1.5</span> Testing for Mediation</a></li>
<li><a class="nav-link" href="#additional-considerations"><span class="header-section-number">19.1.6</span> Additional Considerations</a></li>
<li><a class="nav-link" href="#assumptions-in-mediation-analysis"><span class="header-section-number">19.1.7</span> Assumptions in Mediation Analysis</a></li>
<li><a class="nav-link" href="#indirect-effect-tests"><span class="header-section-number">19.1.8</span> Indirect Effect Tests</a></li>
<li><a class="nav-link" href="#power-analysis-for-mediation"><span class="header-section-number">19.1.9</span> Power Analysis for Mediation</a></li>
<li><a class="nav-link" href="#multiple-mediation-analysis"><span class="header-section-number">19.1.10</span> Multiple Mediation Analysis</a></li>
<li><a class="nav-link" href="#multiple-treatments-in-mediation"><span class="header-section-number">19.1.11</span> Multiple Treatments in Mediation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#causal-inference-approach-to-mediation"><span class="header-section-number">19.2</span> Causal Inference Approach to Mediation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-example-traditional-mediation-analysis"><span class="header-section-number">19.2.1</span> Example: Traditional Mediation Analysis</a></li>
<li><a class="nav-link" href="#two-approaches-in-causal-mediation-analysis"><span class="header-section-number">19.2.2</span> Two Approaches in Causal Mediation Analysis</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/19-mediation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/19-mediation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-05-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
