<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Descriptive Statistics | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="When you have an area of interest that you want to research, a problem that you want to solve, a relationship that you want to investigate, theoretical and empirical processes will help you....">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 3 Descriptive Statistics | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/descriptive-stat.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="When you have an area of interest that you want to research, a problem that you want to solve, a relationship that you want to investigate, theoretical and empirical processes will help you....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Descriptive Statistics | A Guide on Data Analysis">
<meta name="twitter:description" content="When you have an area of interest that you want to research, a problem that you want to solve, a relationship that you want to investigate, theoretical and empirical processes will help you....">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="active" href="descriptive-stat.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="model-specification.html"><span class="header-section-number">10</span> Model Specification</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></li>
<li><a class="" href="data.html"><span class="header-section-number">12</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">13</span> Variable Transformation</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">14</span> Hypothesis Testing</a></li>
<li><a class="" href="marginal-effects.html"><span class="header-section-number">15</span> Marginal Effects</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">16</span> Prediction and Estimation</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">17</span> Moderation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">18</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="experimental-design.html"><span class="header-section-number">19</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">20</span> Sampling</a></li>
<li><a class="" href="analysis-of-variance-anova.html"><span class="header-section-number">21</span> Analysis of Variance (ANOVA)</a></li>
<li><a class="" href="multivariate-methods.html"><span class="header-section-number">22</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="quasi-experimental.html"><span class="header-section-number">23</span> Quasi-experimental</a></li>
<li><a class="" href="regression-discontinuity.html"><span class="header-section-number">24</span> Regression Discontinuity</a></li>
<li><a class="" href="synthetic-difference-in-differences.html"><span class="header-section-number">25</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="difference-in-differences.html"><span class="header-section-number">26</span> Difference-in-differences</a></li>
<li><a class="" href="synthetic-control.html"><span class="header-section-number">27</span> Synthetic Control</a></li>
<li><a class="" href="event-studies.html"><span class="header-section-number">28</span> Event Studies</a></li>
<li><a class="" href="matching-methods.html"><span class="header-section-number">29</span> Matching Methods</a></li>
<li><a class="" href="interrupted-time-series.html"><span class="header-section-number">30</span> Interrupted Time Series</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">31</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">32</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">33</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="mediation.html"><span class="header-section-number">34</span> Mediation</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">35</span> Directed Acyclic Graph</a></li>
<li><a class="" href="report.html"><span class="header-section-number">36</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">37</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">38</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">39</span> Replication and Synthetic Data</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="descriptive-stat" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Descriptive Statistics<a class="anchor" aria-label="anchor" href="#descriptive-stat"><i class="fas fa-link"></i></a>
</h1>
<p>When you have an area of interest that you want to research, a problem that you want to solve, a relationship that you want to investigate, theoretical and empirical processes will help you.</p>
<p>Estimand is defined as “a quantity of scientific interest that can be calculated in the population and does not change its value depending on the data collection design used to measure it (i.e., it does not vary with sample size and survey design, or the number of non-respondents, or follow-up efforts).” <span class="citation">(<a href="references.html#ref-Rubin_1996">Rubin 1996</a>)</span></p>
<p>Estimands include:</p>
<ul>
<li>population means</li>
<li>Population variances</li>
<li>correlations</li>
<li>factor loading</li>
<li>regression coefficients</li>
</ul>
<div id="numerical-measures" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Numerical Measures<a class="anchor" aria-label="anchor" href="#numerical-measures"><i class="fas fa-link"></i></a>
</h2>
<p>There are differences between a population and a sample</p>
<div class="inline-table"><table style="width:99%;" class="table table-sm">
<colgroup>
<col width="7%">
<col width="30%">
<col width="36%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>Measures of</th>
<th>Category</th>
<th>Population</th>
<th>Sample</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>-</td>
<td>What is it?</td>
<td>Reality</td>
<td>A small fraction of reality (inference)</td>
</tr>
<tr class="even">
<td>-</td>
<td>Characteristics described by</td>
<td>Parameters</td>
<td>Statistics</td>
</tr>
<tr class="odd">
<td>Central Tendency</td>
<td>Mean</td>
<td><span class="math inline">\(\mu = E(Y)\)</span></td>
<td><span class="math inline">\(\hat{\mu} = \overline{y}\)</span></td>
</tr>
<tr class="even">
<td>Central Tendency</td>
<td>Median</td>
<td>50-th percentile</td>
<td><span class="math inline">\(y_{(\frac{n+1}{2})}\)</span></td>
</tr>
<tr class="odd">
<td>Dispersion</td>
<td>Variance</td>
<td><span class="math display">\[\begin{aligned} \sigma^2 &amp;= var(Y) \\ &amp;= E(Y- \mu^2) \end{aligned}\]</span></td>
<td><span class="math inline">\(s^2=\frac{1}{n-1} \sum_{i = 1}^{n} (y_i-\overline{y})^2\)</span></td>
</tr>
<tr class="even">
<td>Dispersion</td>
<td>Coefficient of Variation</td>
<td><span class="math inline">\(\frac{\sigma}{\mu}\)</span></td>
<td><span class="math inline">\(\frac{s}{\overline{y}}\)</span></td>
</tr>
<tr class="odd">
<td>Dispersion</td>
<td>Interquartile Range</td>
<td>difference between 25th and 75th percentiles. Robust to outliers</td>
<td></td>
</tr>
<tr class="even">
<td>Shape</td>
<td>Skewness Standardized 3rd central moment (unitless)</td>
<td><span class="math inline">\(g_1=\frac{\mu_3}{\mu_2^{3/2}}\)</span></td>
<td><span class="math inline">\(\hat{g_1}=\frac{m_3}{m_2sqrt(m_2)}\)</span></td>
</tr>
<tr class="odd">
<td>Shape</td>
<td>Central moments</td>
<td>
<span class="math inline">\(\mu=E(Y)\)</span> <span class="math inline">\(\mu_2 = \sigma^2=E(Y-\mu)^2\)</span> <span class="math inline">\(\mu_3 = E(Y-\mu)^3\)</span> <span class="math inline">\(\mu_4 = E(Y-\mu)^4\)</span> |</td>
<td>
<p><span class="math inline">\(m_2=\sum_{i=1}^{n}(y_1-\overline{y})^2/n\)</span></p>
<p><span class="math inline">\(m_3=\sum_{i=1}^{n}(y_1-\overline{y})^3/n\)</span></p>
</td>
</tr>
<tr class="even">
<td>Shape</td>
<td>Kurtosis (peakedness and tail thickness) Standardized 4th central moment</td>
<td><span class="math inline">\(g_2^*=\frac{E(Y-\mu)^4}{\sigma^4}\)</span></td>
<td><span class="math inline">\(\hat{g_2}=\frac{m_4}{m_2^2}-3\)</span></td>
</tr>
</tbody>
</table></div>
<p>Note:</p>
<ul>
<li><p>Order Statistics: <span class="math inline">\(y_{(1)},y_{(2)},...,y_{(n)}\)</span> where <span class="math inline">\(y_{(1)}&lt;y_{(2)}&lt;...&lt;y_{(n)}\)</span></p></li>
<li><p>Coefficient of variation: standard deviation over mean. This metric is stable, dimensionless statistic for comparison.</p></li>
<li><p>Symmetric: mean = median, skewness = 0</p></li>
<li><p>Skewed right: mean &gt; median, skewness &gt; 0</p></li>
<li><p>Skewed left: mean &lt; median, skewness &lt; 0</p></li>
<li><p>Central moments: <span class="math inline">\(\mu=E(Y)\)</span> , <span class="math inline">\(\mu_2 = \sigma^2=E(Y-\mu)^2\)</span> , <span class="math inline">\(\mu_3 = E(Y-\mu)^3\)</span>, <span class="math inline">\(\mu_4 = E(Y-\mu)^4\)</span></p></li>
<li><p>For normal distributions, <span class="math inline">\(\mu_3=0\)</span>, so <span class="math inline">\(g_1=0\)</span></p></li>
<li>
<p><span class="math inline">\(\hat{g_1}\)</span> is distributed approximately as <span class="math inline">\(N(0,6/n)\)</span> if sample is from a normal population. (valid when <span class="math inline">\(n &gt; 150\)</span>)</p>
<ul>
<li>For large samples, inference on skewness can be based on normal tables with 95% confidence interval for <span class="math inline">\(g_1\)</span> as <span class="math inline">\(\hat{g_1}\pm1.96\sqrt{6/n}\)</span>
</li>
<li>For small samples, special tables from Snedecor and Cochran 1989, Table A 19(i) or Monte Carlo test</li>
</ul>
</li>
</ul>
<div class="inline-table"><table style="width:99%;" class="table table-sm">
<colgroup>
<col width="23%">
<col width="11%">
<col width="64%">
</colgroup>
<tbody>
<tr class="odd">
<td>Kurtosis &gt; 0 (leptokurtic)</td>
<td>heavier tail</td>
<td>compared to a normal distribution with the same <span class="math inline">\(\sigma\)</span> (e.g., t-distribution)</td>
</tr>
<tr class="even">
<td>Kurtosis &lt; 0 (platykurtic)</td>
<td>lighter tail</td>
<td>compared to a normal distribution with the same <span class="math inline">\(\sigma\)</span>
</td>
</tr>
</tbody>
</table></div>
<ul>
<li>
<p>For a normal distribution, <span class="math inline">\(g_2^*=3\)</span>. Kurtosis is often redefined as: <span class="math inline">\(g_2=\frac{E(Y-\mu)^4}{\sigma^4}-3\)</span> where the 4th central moment is estimated by <span class="math inline">\(m_4=\sum_{i=1}^{n}(y_i-\overline{y})^4/n\)</span></p>
<ul>
<li>the asymptotic sampling distribution for <span class="math inline">\(\hat{g_2}\)</span> is approximately <span class="math inline">\(N(0,24/n)\)</span> (with <span class="math inline">\(n &gt; 1000\)</span>)</li>
<li>large sample on kurtosis uses standard normal tables</li>
<li>small sample uses tables by Snedecor and Cochran, 1989, Table A 19(ii) or Geary 1936</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/skewness.html">skewness</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.2046225</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/kurtosis.html">kurtosis</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.6313715</span></span></code></pre></div>
</div>
<div id="graphical-measures" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Graphical Measures<a class="anchor" aria-label="anchor" href="#graphical-measures"><i class="fas fa-link"></i></a>
</h2>
<div id="shape" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Shape<a class="anchor" aria-label="anchor" href="#shape"><i class="fas fa-link"></i></a>
</h3>
<p>It’s a good habit to label your graph, so others can easily follow.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Histogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">data</span>,labels <span class="op">=</span> <span class="cn">T</span>,col<span class="op">=</span><span class="st">"grey"</span>,breaks <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Interactive histogram  </span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"highcharter"</span><span class="op">)</span></span>
<span><span class="fu">hchart</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Box-and-Whisker plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">spray</span>, data <span class="op">=</span> <span class="va">InsectSprays</span>,col <span class="op">=</span> <span class="st">"lightgray"</span>,main<span class="op">=</span><span class="st">"boxplot"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Notched Boxplot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">len</span><span class="op">~</span><span class="va">supp</span><span class="op">*</span><span class="va">dose</span>, data<span class="op">=</span><span class="va">ToothGrowth</span>, notch<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>  col<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gold"</span>,<span class="st">"darkgreen"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Tooth Growth"</span>, xlab<span class="op">=</span><span class="st">"Suppliment and Dose"</span><span class="op">)</span></span>
<span><span class="co"># If notches differ -&gt; medians differ</span></span>
<span></span>
<span><span class="co"># Stem-and-Leaf Plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stem.html">stem</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Bagplot - A 2D Boxplot Extension</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">aplpack</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu">bagplot</span><span class="op">(</span><span class="va">wt</span>,<span class="va">mpg</span>, xlab<span class="op">=</span><span class="st">"Car Weight"</span>, ylab<span class="op">=</span><span class="st">"Miles Per Gallon"</span>,</span>
<span>  main<span class="op">=</span><span class="st">"Bagplot Example"</span><span class="op">)</span></span></code></pre></div>
<p>Others more advanced plots</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boxplot.matrix()  #library("sfsmisc")</span></span>
<span><span class="co"># boxplot.n()       #library("gplots")</span></span>
<span><span class="co"># vioplot()         #library("vioplot")</span></span></code></pre></div>
</div>
<div id="scatterplot" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Scatterplot<a class="anchor" aria-label="anchor" href="#scatterplot"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pairs(mtcars)</span></span></code></pre></div>
</div>
</div>
<div id="normality-assessment" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Normality Assessment<a class="anchor" aria-label="anchor" href="#normality-assessment"><i class="fas fa-link"></i></a>
</h2>
<p>Since Normal (Gaussian) distribution has many applications, we typically want/ wish our data or our variable is normal. Hence, we have to assess the normality based on not only <a href="descriptive-stat.html#numerical-measures">Numerical Measures</a> but also <a href="descriptive-stat.html#graphical-measures">Graphical Measures</a></p>
<div id="graphical-assessment" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Graphical Assessment<a class="anchor" aria-label="anchor" href="#graphical-assessment"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"car"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span><span class="op">(</span><span class="va">precip</span>, ylab <span class="op">=</span> <span class="st">"Precipitation [in/yr] for 70 US cities"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">precip</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The straight line represents the theoretical line for normally distributed data. The dots represent real empirical data that we are checking. If all the dots fall on the straight line, we can be confident that our data follow a normal distribution. If our data wiggle and deviate from the line, we should be concerned with the normality assumption.</p>
</div>
<div id="summary-statistics" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Summary Statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes it’s hard to tell whether your data follow the normal distribution by just looking at the graph. Hence, we often have to conduct statistical test to aid our decision. Common tests are</p>
<ul>
<li>
<p><a href="descriptive-stat.html#methods-based-on-normal-probability-plot">Methods based on normal probability plot</a></p>
<ul>
<li><a href="descriptive-stat.html#correlation-coefficient-with-normal-probability-plots">Correlation Coefficient with Normal Probability Plots</a></li>
<li><a href="descriptive-stat.html#shapiro-wilk-test">Shapiro-Wilk Test</a></li>
</ul>
</li>
<li>
<p><a href="descriptive-stat.html#methods-based-on-empirical-cumulative-distribution-function">Methods based on empirical cumulative distribution function</a></p>
<ul>
<li><a href="descriptive-stat.html#anderson-darling-test">Anderson-Darling Test</a></li>
<li><a href="descriptive-stat.html#kolmogorov-smirnov-test">Kolmogorov-Smirnov Test</a></li>
<li><a href="descriptive-stat.html#cramer-von-mises-test">Cramer-von Mises Test</a></li>
<li><a href="descriptive-stat.html#jarquebera-test">Jarque–Bera Test</a></li>
</ul>
</li>
</ul>
<div id="methods-based-on-normal-probability-plot" class="section level4" number="3.3.2.1">
<h4>
<span class="header-section-number">3.3.2.1</span> Methods based on normal probability plot<a class="anchor" aria-label="anchor" href="#methods-based-on-normal-probability-plot"><i class="fas fa-link"></i></a>
</h4>
<div id="correlation-coefficient-with-normal-probability-plots" class="section level5" number="3.3.2.1.1">
<h5>
<span class="header-section-number">3.3.2.1.1</span> Correlation Coefficient with Normal Probability Plots<a class="anchor" aria-label="anchor" href="#correlation-coefficient-with-normal-probability-plots"><i class="fas fa-link"></i></a>
</h5>
<p><span class="citation">(<a href="references.html#ref-Looney_1985">Looney and Gulledge Jr 1985</a>)</span> <span class="citation">(<a href="references.html#ref-Shapiro_1972">Samuel S. Shapiro and Francia 1972</a>)</span> The correlation coefficient between <span class="math inline">\(y_{(i)}\)</span> and <span class="math inline">\(m_i^*\)</span> as given on the normal probability plot:</p>
<p><span class="math display">\[W^*=\frac{\sum_{i=1}^{n}(y_{(i)}-\bar{y})(m_i^*-0)}{(\sum_{i=1}^{n}(y_{(i)}-\bar{y})^2\sum_{i=1}^{n}(m_i^*-0)^2)^.5}\]</span></p>
<p>where <span class="math inline">\(\bar{m^*}=0\)</span></p>
<p>Pearson product moment formula for correlation:</p>
<p><span class="math display">\[\hat{p}=\frac{\sum_{i-1}^{n}(y_i-\bar{y})(x_i-\bar{x})}{(\sum_{i=1}^{n}(y_{i}-\bar{y})^2\sum_{i=1}^{n}(x_i-\bar{x})^2)^.5}\]</span></p>
<ul>
<li>When the correlation is 1, the plot is exactly linear and normality is assumed.</li>
<li>The closer the correlation is to zero, the more confident we are to reject normality</li>
<li>Inference on W* needs to be based on special tables <span class="citation">(<a href="references.html#ref-Looney_1985">Looney and Gulledge Jr 1985</a>)</span>
</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/alexkowa/EnvStats">"EnvStats"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/EnvStats/man/gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">data</span>,test<span class="op">=</span><span class="st">"ppcc"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co">#Probability Plot Correlation Coefficient </span></span>
<span><span class="co">#&gt; [1] 0.383608</span></span></code></pre></div>
</div>
<div id="shapiro-wilk-test" class="section level5" number="3.3.2.1.2">
<h5>
<span class="header-section-number">3.3.2.1.2</span> Shapiro-Wilk Test<a class="anchor" aria-label="anchor" href="#shapiro-wilk-test"><i class="fas fa-link"></i></a>
</h5>
<p><span class="citation">(<a href="references.html#ref-Shapiro_1965">Samuel Sanford Shapiro and Wilk 1965</a>)</span></p>
<p><span class="math display">\[W=(\frac{\sum_{i=1}^{n}a_i(y_{(i)}-\bar{y})(m_i^*-0)}{(\sum_{i=1}^{n}a_i^2(y_{(i)}-\bar{y})^2\sum_{i=1}^{n}(m_i^*-0)^2)^.5})^2\]</span></p>
<p>where <span class="math inline">\(a_1,..,a_n\)</span> are weights computed from the covariance matrix for the order statistics.</p>
<ul>
<li>Researchers typically use this test to assess normality. (n &lt; 2000) Under normality, W is close to 1, just like <span class="math inline">\(W^*\)</span>. Notice that the only difference between W and W* is the “weights”.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/EnvStats/man/gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">data</span>,test<span class="op">=</span><span class="st">"sw"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co">#Shapiro-Wilk is the default.</span></span>
<span><span class="co">#&gt; [1] 0.3132036</span></span></code></pre></div>
</div>
</div>
<div id="methods-based-on-empirical-cumulative-distribution-function" class="section level4" number="3.3.2.2">
<h4>
<span class="header-section-number">3.3.2.2</span> Methods based on empirical cumulative distribution function<a class="anchor" aria-label="anchor" href="#methods-based-on-empirical-cumulative-distribution-function"><i class="fas fa-link"></i></a>
</h4>
<p>The formula for the empirical cumulative distribution function (CDF) is:</p>
<p><span class="math inline">\(F_n(t)\)</span> = estimate of probability that an observation <span class="math inline">\(\le\)</span> t = (number of observation <span class="math inline">\(\le\)</span> t)/n</p>
<p>This method requires large sample sizes. However, it can apply to distributions other than the normal (Gaussian) one.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Empirical CDF hand-code</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html">plot.ecdf</a></span><span class="op">(</span><span class="va">data</span>,verticals <span class="op">=</span> <span class="cn">T</span>, do.points<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;"></div>
<div id="anderson-darling-test" class="section level5" number="3.3.2.2.1">
<h5>
<span class="header-section-number">3.3.2.2.1</span> Anderson-Darling Test<a class="anchor" aria-label="anchor" href="#anderson-darling-test"><i class="fas fa-link"></i></a>
</h5>
<p>The Anderson-Darling statistic <span class="citation">(<a href="references.html#ref-Anderson_1952">T. W. Anderson and Darling 1952</a>)</span>:</p>
<p><span class="math display">\[A^2=\int_{-\infty}^{\infty}(F_n(t)=F(t))^2\frac{dF(t)}{F(t)(1-F(t))}\]</span></p>
<ul>
<li>a weight average of squared deviations (it weights small and large values of t more)</li>
</ul>
<p>For the normal distribution,</p>
<p><span class="math inline">\(A^2 = - (\sum_{i=1}^{n}(2i-1)(ln(p_i) +ln(1-p_{n+1-i}))/n-n\)</span></p>
<p>where <span class="math inline">\(p_i=\Phi(\frac{y_{(i)}-\bar{y}}{s})\)</span>, the probability that a standard normal variable is less than <span class="math inline">\(\frac{y_{(i)}-\bar{y}}{s}\)</span></p>
<ul>
<li><p>Reject normal assumption when <span class="math inline">\(A^2\)</span> is too large</p></li>
<li><p>Evaluate the null hypothesis that the observations are randomly selected from a normal population based on the critical value provided by <span class="citation">(<a href="references.html#ref-Marsaglia_2004">Marsaglia and Marsaglia 2004</a>)</span> and <span class="citation">(<a href="references.html#ref-Stephens_1974">Stephens 1974</a>)</span></p></li>
<li>
<p>This test can be applied to other distributions:</p>
<ul>
<li>Exponential</li>
<li>Logistic</li>
<li>Gumbel</li>
<li>Extreme-value</li>
<li>Weibull: log(Weibull) = Gumbel</li>
<li>Gamma</li>
<li>Logistic</li>
<li>Cauchy</li>
<li>von Mises</li>
<li>Log-normal (two-parameter)</li>
</ul>
</li>
</ul>
<p>Consult <span class="citation">(<a href="references.html#ref-Stephens_1974">Stephens 1974</a>)</span> for more detailed transformation and critical values.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/EnvStats/man/gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">data</span>,test<span class="op">=</span><span class="st">"ad"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co">#Anderson-Darling</span></span>
<span><span class="co">#&gt; [1] 0.1961768</span></span></code></pre></div>
</div>
<div id="kolmogorov-smirnov-test" class="section level5" number="3.3.2.2.2">
<h5>
<span class="header-section-number">3.3.2.2.2</span> Kolmogorov-Smirnov Test<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov-test"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>Based on the largest absolute difference between empirical and expected cumulative distribution</li>
<li>Another deviation of K-S test is Kuiper’s test</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/EnvStats/man/gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">data</span>,test<span class="op">=</span><span class="st">"ks"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co">#Komogorov-Smirnov </span></span>
<span><span class="co">#&gt; [1] 0.6694967</span></span></code></pre></div>
</div>
<div id="cramer-von-mises-test" class="section level5" number="3.3.2.2.3">
<h5>
<span class="header-section-number">3.3.2.2.3</span> Cramer-von Mises Test<a class="anchor" aria-label="anchor" href="#cramer-von-mises-test"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>Based on the average squared discrepancy between the empirical distribution and a given theoretical distribution. Each discrepancy is weighted equally (unlike Anderson-Darling test weights end points more heavily)</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/EnvStats/man/gofTest.html">gofTest</a></span><span class="op">(</span><span class="va">data</span>,test<span class="op">=</span><span class="st">"cvm"</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="co">#Cramer-von Mises</span></span>
<span><span class="co">#&gt; [1] 0.1820569</span></span></code></pre></div>
</div>
<div id="jarquebera-test" class="section level5" number="3.3.2.2.4">
<h5>
<span class="header-section-number">3.3.2.2.4</span> Jarque–Bera Test<a class="anchor" aria-label="anchor" href="#jarquebera-test"><i class="fas fa-link"></i></a>
</h5>
<p><span class="citation">(<a href="references.html#ref-Bera_1981">Bera and Jarque 1981</a>)</span></p>
<p>Based on the skewness and kurtosis to test normality.</p>
<p><span class="math inline">\(JB = \frac{n}{6}(S^2+(K-3)^2/4)\)</span> where <span class="math inline">\(S\)</span> is the sample skewness and <span class="math inline">\(K\)</span> is the sample kurtosis</p>
<p><span class="math inline">\(S=\frac{\hat{\mu_3}}{\hat{\sigma}^3}=\frac{\sum_{i=1}^{n}(x_i-\bar{x})^3/n}{(\sum_{i=1}^{n}(x_i-\bar{x})^2/n)^\frac{3}{2}}\)</span></p>
<p><span class="math inline">\(K=\frac{\hat{\mu_4}}{\hat{\sigma}^4}=\frac{\sum_{i=1}^{n}(x_i-\bar{x})^4/n}{(\sum_{i=1}^{n}(x_i-\bar{x})^2/n)^2}\)</span></p>
<p>recall <span class="math inline">\(\hat{\sigma^2}\)</span> is the estimate of the second central moment (variance) <span class="math inline">\(\hat{\mu_3}\)</span> and <span class="math inline">\(\hat{\mu_4}\)</span> are the estimates of third and fourth central moments.</p>
<p>If the data comes from a normal distribution, the JB statistic asymptotically has a chi-squared distribution with two degrees of freedom.</p>
<p>The null hypothesis is a joint hypothesis of the skewness being zero and the excess kurtosis being zero.</p>
</div>
</div>
</div>
</div>
<div id="bivariate-statistics" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Bivariate Statistics<a class="anchor" aria-label="anchor" href="#bivariate-statistics"><i class="fas fa-link"></i></a>
</h2>
<p>Correlation between</p>
<ul>
<li>
<a href="descriptive-stat.html#two-continuous">Two Continuous</a> variables</li>
<li>
<a href="descriptive-stat.html#two-discrete">Two Discrete</a> variables</li>
<li><a href="descriptive-stat.html#categorical-and-continuous">Categorical and Continuous</a></li>
</ul>
<div class="inline-table"><table style="width:99%;" class="table table-sm">
<colgroup>
<col width="18%">
<col width="54%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Categorical</th>
<th>Continuous</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Categorical</strong></td>
<td>
<p><a href="descriptive-stat.html#phi-coefficient">Phi coefficient</a></p>
<p><a href="descriptive-stat.html#cramers-v">Cramer’s V</a></p>
<p><a href="descriptive-stat.html#tschuprows-t">Tschuprow’s T</a></p>
<p><a href="descriptive-stat.html#freemans-theta">Freeman’s Theta</a></p>
<p><a href="descriptive-stat.html#epsilon-squared">Epsilon-squared</a></p>
<p><a href="descriptive-stat.html#goodman-kruskals-gamma">Goodman Kruskal’s Gamma</a></p>
<p><a href="descriptive-stat.html#somers-d">Somers’ D</a></p>
<p><a href="descriptive-stat.html#kendalls-tau-b">Kendall’s Tau-b</a></p>
<p><a href="descriptive-stat.html#yules-q-and-y">Yule’s Q and Y</a></p>
<p><a href="descriptive-stat.html#tetrachoric-correlation">Tetrachoric Correlation</a></p>
<p><a href="descriptive-stat.html#polychoric-correlation">Polychoric Correlation</a></p>
</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Continuous</strong></td>
<td>
<p><a href="descriptive-stat.html#point-biserial-correlation">Point-Biserial Correlation</a></p>
<p><a href="descriptive-stat.html#logistic-regression">Logistic Regression</a></p>
</td>
<td>
<p><a href="descriptive-stat.html#pearson-correlation">Pearson Correlation</a></p>
<p><a href="descriptive-stat.html#spearman-correlation">Spearman Correlation</a></p>
</td>
</tr>
</tbody>
</table></div>
<p>Questions to keep in mind:</p>
<ol style="list-style-type: decimal">
<li>Is the relationship linear or non-linear?</li>
<li>If the variable is continuous, is it normal and homoskadastic?</li>
<li>How big is your dataset?</li>
</ol>
<div id="two-continuous" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Two Continuous<a class="anchor" aria-label="anchor" href="#two-continuous"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="pearson-correlation" class="section level4" number="3.4.1.1">
<h4>
<span class="header-section-number">3.4.1.1</span> Pearson Correlation<a class="anchor" aria-label="anchor" href="#pearson-correlation"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Good with linear relationship</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.html">rcorr</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">A</span>, <span class="va">data</span><span class="op">$</span><span class="va">B</span>, type<span class="op">=</span><span class="st">"pearson"</span><span class="op">)</span> </span>
<span><span class="co">#&gt;      x    y</span></span>
<span><span class="co">#&gt; x 1.00 0.17</span></span>
<span><span class="co">#&gt; y 0.17 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; n= 100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P</span></span>
<span><span class="co">#&gt;   x      y     </span></span>
<span><span class="co">#&gt; x        0.0878</span></span>
<span><span class="co">#&gt; y 0.0878</span></span></code></pre></div>
</div>
<div id="spearman-correlation" class="section level4" number="3.4.1.2">
<h4>
<span class="header-section-number">3.4.1.2</span> Spearman Correlation<a class="anchor" aria-label="anchor" href="#spearman-correlation"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/">Hmisc</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.html">rcorr</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">A</span>, <span class="va">data</span><span class="op">$</span><span class="va">B</span>, type<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span> </span>
<span><span class="co">#&gt;      x    y</span></span>
<span><span class="co">#&gt; x 1.00 0.18</span></span>
<span><span class="co">#&gt; y 0.18 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; n= 100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P</span></span>
<span><span class="co">#&gt;   x    y   </span></span>
<span><span class="co">#&gt; x      0.08</span></span>
<span><span class="co">#&gt; y 0.08</span></span></code></pre></div>
</div>
</div>
<div id="categorical-and-continuous" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Categorical and Continuous<a class="anchor" aria-label="anchor" href="#categorical-and-continuous"><i class="fas fa-link"></i></a>
</h3>
<div id="point-biserial-correlation" class="section level4" number="3.4.2.1">
<h4>
<span class="header-section-number">3.4.2.1</span> Point-Biserial Correlation<a class="anchor" aria-label="anchor" href="#point-biserial-correlation"><i class="fas fa-link"></i></a>
</h4>
<p>Similar to the Pearson correlation coefficient, the point-biserial correlation coefficient is between -1 and 1 where:</p>
<ul>
<li><p>-1 means a perfectly negative correlation between two variables</p></li>
<li><p>0 means no correlation between two variables</p></li>
<li><p>1 means a perfectly positive correlation between two variables</p></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">17</span>, <span class="fl">17</span>, <span class="fl">11</span>, <span class="fl">22</span>, <span class="fl">23</span>, <span class="fl">11</span>, <span class="fl">19</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#calculate point-biserial correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pearson's product-moment correlation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  x and y</span></span>
<span><span class="co">#&gt; t = 0.67064, df = 9, p-value = 0.5193</span></span>
<span><span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -0.4391885  0.7233704</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt;       cor </span></span>
<span><span class="co">#&gt; 0.2181635</span></span></code></pre></div>
<p>Alternatively</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ltm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ltm/man/biserial.cor.html">biserial.cor</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span>, use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"all.obs"</span><span class="op">)</span>, level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2181635</span></span></code></pre></div>
</div>
<div id="logistic-regression" class="section level4" number="3.4.2.2">
<h4>
<span class="header-section-number">3.4.2.2</span> Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h4>
<p>See <a href="descriptive-stat.html#logistic-regression">3.4.2.2</a></p>
</div>
</div>
<div id="two-discrete" class="section level3" number="3.4.3">
<h3>
<span class="header-section-number">3.4.3</span> Two Discrete<a class="anchor" aria-label="anchor" href="#two-discrete"><i class="fas fa-link"></i></a>
</h3>
<div id="distance-metrics" class="section level4" number="3.4.3.1">
<h4>
<span class="header-section-number">3.4.3.1</span> Distance Metrics<a class="anchor" aria-label="anchor" href="#distance-metrics"><i class="fas fa-link"></i></a>
</h4>
<p>Some consider distance is not a correlation metric because it isn’t unit independent (i.e., if you scale the distance, the metrics will change), but it’s still a useful proxy. Distance metrics are more likely to be used for similarity measure.</p>
<ul>
<li><p>Euclidean Distance</p></li>
<li><p>Manhattan Distance</p></li>
<li><p>Chessboard Distance</p></li>
<li><p>Minkowski Distance</p></li>
<li><p>Canberra Distance</p></li>
<li><p>Hamming Distance</p></li>
<li><p>Cosine Distance</p></li>
<li><p>Sum of Absolute Distance</p></li>
<li><p>Sum of Squared Distance</p></li>
<li><p>Mean-Absolute Error</p></li>
</ul>
</div>
<div id="statistical-metrics" class="section level4" number="3.4.3.2">
<h4>
<span class="header-section-number">3.4.3.2</span> Statistical Metrics<a class="anchor" aria-label="anchor" href="#statistical-metrics"><i class="fas fa-link"></i></a>
</h4>
<div id="chi-squared-test" class="section level5" number="3.4.3.2.1">
<h5>
<span class="header-section-number">3.4.3.2.1</span> Chi-squared test<a class="anchor" aria-label="anchor" href="#chi-squared-test"><i class="fas fa-link"></i></a>
</h5>
<div id="phi-coefficient" class="section level6" number="3.4.3.2.1.1">
<h6>
<span class="header-section-number">3.4.3.2.1.1</span> Phi coefficient<a class="anchor" aria-label="anchor" href="#phi-coefficient"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>2 binary</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dt</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    3</span></span>
<span><span class="co">#&gt; [2,]    4    5</span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/phi.html">phi</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.18</span></span></code></pre></div>
</div>
<div id="cramers-v" class="section level6" number="3.4.3.2.1.2">
<h6>
<span class="header-section-number">3.4.3.2.1.2</span> Cramer’s V<a class="anchor" aria-label="anchor" href="#cramers-v"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>between nominal categorical variables (no natural order)</li>
</ul>
<p><span class="math display">\[
\text{Cramer's V} = \sqrt{\frac{\chi^2/n}{\min(c-1,r-1)}}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\chi^2\)</span> = Chi-square statistic</p></li>
<li><p><span class="math inline">\(n\)</span> = sample size</p></li>
<li><p><span class="math inline">\(r\)</span> = # of rows</p></li>
<li><p><span class="math inline">\(c\)</span> = # of columns</p></li>
</ul>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/djnavarro/lsr">'lsr'</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lsr/man/cramersV.html">cramersV</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">A</span>, <span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1944616</span></span></code></pre></div>
<p>Alternatively,</p>
<ul>
<li><p><code>ncchisq</code> noncentral Chi-square</p></li>
<li><p><code>nchisqadj</code> Adjusted noncentral Chi-square</p></li>
<li><p><code>fisher</code> Fisher Z transformation</p></li>
<li><p><code>fisheradj</code> bias correction Fisher z transformation</p></li>
</ul>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CramerV.html">CramerV</a></span><span class="op">(</span><span class="va">data</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>,method <span class="op">=</span> <span class="st">"ncchisqadj"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Cramer V    lwr.ci    upr.ci </span></span>
<span><span class="co">#&gt; 0.3472325 0.3929964 0.4033053</span></span></code></pre></div>
</div>
<div id="tschuprows-t" class="section level6" number="3.4.3.2.1.3">
<h6>
<span class="header-section-number">3.4.3.2.1.3</span> Tschuprow’s T<a class="anchor" aria-label="anchor" href="#tschuprows-t"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>2 nominal variables</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CramerV.html">TschuprowT</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1100808</span></span></code></pre></div>
</div>
</div>
</div>
<div id="ordinal-association-rank-correlation" class="section level4" number="3.4.3.3">
<h4>
<span class="header-section-number">3.4.3.3</span> Ordinal Association (Rank correlation)<a class="anchor" aria-label="anchor" href="#ordinal-association-rank-correlation"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Good with non-linear relationship</li>
</ul>
<div id="ordinal-and-nominal" class="section level5" number="3.4.3.3.1">
<h5>
<span class="header-section-number">3.4.3.3.1</span> Ordinal and Nominal<a class="anchor" aria-label="anchor" href="#ordinal-and-nominal"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, <span class="co"># ordinal</span></span>
<span>    B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>  <span class="co"># nominal</span></span>
<span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">dt</span></span>
<span><span class="co">#&gt;    B</span></span>
<span><span class="co">#&gt; A    1  2  3</span></span>
<span><span class="co">#&gt;   1  7 11  9</span></span>
<span><span class="co">#&gt;   2 11  6 14</span></span>
<span><span class="co">#&gt;   3  7 11  4</span></span>
<span><span class="co">#&gt;   4  6  4 10</span></span></code></pre></div>
<div id="freemans-theta" class="section level6" number="3.4.3.3.1.1">
<h6>
<span class="header-section-number">3.4.3.3.1.1</span> Freeman’s Theta<a class="anchor" aria-label="anchor" href="#freemans-theta"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>Ordinal and nominal</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this package is not available for R &gt;= 4.0.0</span></span>
<span><span class="fu">rcompanion</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rcompanion/man/freemanTheta.html">freemanTheta</a></span><span class="op">(</span><span class="va">dt</span>, group <span class="op">=</span> <span class="st">"column"</span><span class="op">)</span> </span>
<span><span class="co"># because column is the grouping variable (i.e., nominal)</span></span></code></pre></div>
</div>
<div id="epsilon-squared" class="section level6" number="3.4.3.3.1.2">
<h6>
<span class="header-section-number">3.4.3.3.1.2</span> Epsilon-squared<a class="anchor" aria-label="anchor" href="#epsilon-squared"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>Ordinal and nominal</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this package is not available for R &gt;= 4.0.0</span></span>
<span><span class="fu">rcompanion</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rcompanion/man/epsilonSquared.html">epsilonSquared</a></span><span class="op">(</span><span class="va">dt</span>,group <span class="op">=</span> <span class="st">"column"</span> <span class="op">)</span> </span>
<span><span class="co"># because column is the grouping variable (i.e., nominal)</span></span></code></pre></div>
</div>
</div>
<div id="two-ordinal" class="section level5" number="3.4.3.3.2">
<h5>
<span class="header-section-number">3.4.3.3.2</span> Two Ordinal<a class="anchor" aria-label="anchor" href="#two-ordinal"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, <span class="co"># ordinal</span></span>
<span>    B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>  <span class="co"># ordinal</span></span>
<span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">dt</span></span>
<span><span class="co">#&gt;    B</span></span>
<span><span class="co">#&gt; A    1  2  3</span></span>
<span><span class="co">#&gt;   1  7 11  9</span></span>
<span><span class="co">#&gt;   2 11  6 14</span></span>
<span><span class="co">#&gt;   3  7 11  4</span></span>
<span><span class="co">#&gt;   4  6  4 10</span></span></code></pre></div>
<div id="goodman-kruskals-gamma" class="section level6" number="3.4.3.3.2.1">
<h6>
<span class="header-section-number">3.4.3.3.2.1</span> Goodman Kruskal’s Gamma<a class="anchor" aria-label="anchor" href="#goodman-kruskals-gamma"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>2 ordinal variables</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/GoodmanKruskalGamma.html">GoodmanKruskalGamma</a></span><span class="op">(</span><span class="va">dt</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;        gamma       lwr.ci       upr.ci </span></span>
<span><span class="co">#&gt;  0.006781013 -0.229032069  0.242594095</span></span></code></pre></div>
</div>
<div id="somers-d" class="section level6" number="3.4.3.3.2.2">
<h6>
<span class="header-section-number">3.4.3.3.2.2</span> Somers’ D<a class="anchor" aria-label="anchor" href="#somers-d"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li><p>or Somers’ Delta</p></li>
<li><p>2 ordinal variables</p></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/SomersDelta.html">SomersDelta</a></span><span class="op">(</span><span class="va">dt</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;       somers       lwr.ci       upr.ci </span></span>
<span><span class="co">#&gt;  0.005115859 -0.172800185  0.183031903</span></span></code></pre></div>
</div>
<div id="kendalls-tau-b" class="section level6" number="3.4.3.3.2.3">
<h6>
<span class="header-section-number">3.4.3.3.2.3</span> Kendall’s Tau-b<a class="anchor" aria-label="anchor" href="#kendalls-tau-b"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>2 ordinal variables</li>
</ul>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/KendallTauB.html">KendallTauB</a></span><span class="op">(</span><span class="va">dt</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;        tau_b       lwr.ci       upr.ci </span></span>
<span><span class="co">#&gt;  0.004839732 -0.163472443  0.173151906</span></span></code></pre></div>
</div>
<div id="yules-q-and-y" class="section level6" number="3.4.3.3.2.4">
<h6>
<span class="header-section-number">3.4.3.3.2.4</span> Yule’s Q and Y<a class="anchor" aria-label="anchor" href="#yules-q-and-y"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>2 ordinal variables</li>
</ul>
<p>Special version <span class="math inline">\((2 \times 2)\)</span> of the <a href="descriptive-stat.html#goodman-kruskals-gamma">Goodman Kruskal’s Gamma</a> coefficient.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th></th>
<th>Variable 1</th>
<th></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Variable 2</strong></td>
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td></td>
<td>c</td>
<td>d</td>
</tr>
</tbody>
</table></div>
<p><span class="math display">\[
\text{Yule's Q} = \frac{ad - bc}{ad + bc}
\]</span></p>
<p>We typically use Yule’s <span class="math inline">\(Q\)</span> in practice while Yule’s Y has the following relationship with <span class="math inline">\(Q\)</span>.</p>
<p><span class="math display">\[
\text{Yule's Y} = \frac{\sqrt{ad} - \sqrt{bc}}{\sqrt{ad} + \sqrt{bc}}
\]</span></p>
<p><span class="math display">\[
Q = \frac{2Y}{1 + Y^2}
\]</span></p>
<p><span class="math display">\[
Y = \frac{1 = \sqrt{1-Q^2}}{Q}
\]</span></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt</span></span>
<span><span class="co">#&gt;    B</span></span>
<span><span class="co">#&gt; A    0  1</span></span>
<span><span class="co">#&gt;   0 25 24</span></span>
<span><span class="co">#&gt;   1 28 23</span></span>
<span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/CramerV.html">YuleQ</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.07778669</span></span></code></pre></div>
</div>
<div id="tetrachoric-correlation" class="section level6" number="3.4.3.3.2.5">
<h6>
<span class="header-section-number">3.4.3.3.2.5</span> Tetrachoric Correlation<a class="anchor" aria-label="anchor" href="#tetrachoric-correlation"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>is a special case of <a href="descriptive-stat.html#polychoric-correlation">Polychoric Correlation</a> when both variables are binary</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#view table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   A B</span></span>
<span><span class="co">#&gt; 1 1 0</span></span>
<span><span class="co">#&gt; 2 1 0</span></span>
<span><span class="co">#&gt; 3 0 0</span></span>
<span><span class="co">#&gt; 4 1 0</span></span>
<span><span class="co">#&gt; 5 1 0</span></span>
<span><span class="co">#&gt; 6 1 0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    B</span></span>
<span><span class="co">#&gt; A    0  1</span></span>
<span><span class="co">#&gt;   0 21 23</span></span>
<span><span class="co">#&gt;   1 34 22</span></span>
<span></span>
<span></span>
<span><span class="co">#calculate tetrachoric correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/tetrachor.html">tetrachoric</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: tetrachoric(x = data)</span></span>
<span><span class="co">#&gt; tetrachoric correlation </span></span>
<span><span class="co">#&gt;   A    B   </span></span>
<span><span class="co">#&gt; A  1.0     </span></span>
<span><span class="co">#&gt; B -0.2  1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  with tau of </span></span>
<span><span class="co">#&gt;     A     B </span></span>
<span><span class="co">#&gt; -0.15  0.13</span></span></code></pre></div>
</div>
<div id="polychoric-correlation" class="section level6" number="3.4.3.3.2.6">
<h6>
<span class="header-section-number">3.4.3.3.2.6</span> Polychoric Correlation<a class="anchor" aria-label="anchor" href="#polychoric-correlation"><i class="fas fa-link"></i></a>
</h6>
<ul>
<li>between ordinal categorical variables (natural order).</li>
<li>Assumption: Ordinal variable is a discrete representation of a latent normally distributed continuous variable. (Income = low, normal, high).</li>
</ul>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/polycor/">polycor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># (sample size)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span>,</span>
<span>                  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   A B</span></span>
<span><span class="co">#&gt; 1 1 3</span></span>
<span><span class="co">#&gt; 2 1 1</span></span>
<span><span class="co">#&gt; 3 3 5</span></span>
<span><span class="co">#&gt; 4 2 3</span></span>
<span><span class="co">#&gt; 5 3 5</span></span>
<span><span class="co">#&gt; 6 4 4</span></span>
<span></span>
<span></span>
<span><span class="co">#calculate polychoric correlation between ratings</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/polycor/man/polychor.html">polychor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">A</span>, <span class="va">data</span><span class="op">$</span><span class="va">B</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01607982</span></span></code></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="summary-1" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mtcars"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cyl</span>, <span class="va">vs</span>, <span class="va">carb</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_factor</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>        cyl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>,</span>
<span>        vs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">vs</span><span class="op">)</span>,</span>
<span>        carb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">carb</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co"># summary(df)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    32 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...</span></span>
<span><span class="co">#&gt;  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df_factor</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    32 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ cyl : Factor w/ 3 levels "4","6","8": 2 2 1 2 3 2 3 1 1 2 ...</span></span>
<span><span class="co">#&gt;  $ vs  : Factor w/ 2 levels "0","1": 1 1 2 2 1 2 1 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ carb: Factor w/ 6 levels "1","2","3","4",..: 4 4 1 1 2 1 4 2 2 4 ...</span></span></code></pre></div>
<p>Get the correlation table for continuous variables only</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;             cyl         vs       carb</span></span>
<span><span class="co">#&gt; cyl   1.0000000 -0.8108118  0.5269883</span></span>
<span><span class="co">#&gt; vs   -0.8108118  1.0000000 -0.5696071</span></span>
<span><span class="co">#&gt; carb  0.5269883 -0.5696071  1.0000000</span></span>
<span></span>
<span><span class="co"># only complete obs</span></span>
<span><span class="co"># cor(df, use = "complete.obs")</span></span></code></pre></div>
<p>Alternatively, you can also have the</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/rcorr.html">rcorr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        cyl    vs  carb</span></span>
<span><span class="co">#&gt; cyl   1.00 -0.81  0.53</span></span>
<span><span class="co">#&gt; vs   -0.81  1.00 -0.57</span></span>
<span><span class="co">#&gt; carb  0.53 -0.57  1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; n= 32 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P</span></span>
<span><span class="co">#&gt;      cyl    vs     carb  </span></span>
<span><span class="co">#&gt; cyl         0.0000 0.0019</span></span>
<span><span class="co">#&gt; vs   0.0000        0.0007</span></span>
<span><span class="co">#&gt; carb 0.0019 0.0007</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">modelsummary</span><span class="fu">::</span><span class="fu"><a href="https://modelsummary.com/reference/datasummary_correlation.html">datasummary_correlation</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
cyl
</th>
<th style="text-align:right;">
vs
</th>
<th style="text-align:right;">
carb
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
cyl
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
vs
</td>
<td style="text-align:right;">
−.81
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
carb
</td>
<td style="text-align:right;">
.53
</td>
<td style="text-align:right;">
−.57
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggcorrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggcorrplot/man/ggcorrplot.html">ggcorrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-35-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Different comparison between different correlation between different types of variables (i.e., continuous vs. categorical) can be problematic. Moreover, the problem of detecting non-linear vs. linear relationship/correlation is another one. Hence, a solution is that using mutual information from information theory (i.e., knowing one variable can reduce uncertainty about the other).</p>
<p>To implement mutual information, we have the following approximations</p>
<p><span class="math display">\[
\downarrow \text{prediction error} \approx \downarrow \text{uncertainty} \approx \downarrow \text{association strength}
\]</span></p>
<p>More specifically, following the <a href="https://rviews.rstudio.com/2021/04/15/an-alternative-to-the-correlation-coefficient-that-works-for-numeric-and-categorical-variables/">X2Y metric</a>, we have the following steps:</p>
<ol style="list-style-type: decimal">
<li>
<p>Predict <span class="math inline">\(y\)</span> without <span class="math inline">\(x\)</span> (i.e., baseline model)</p>
<ol style="list-style-type: decimal">
<li><p>Average of <span class="math inline">\(y\)</span> when <span class="math inline">\(y\)</span> is continuous</p></li>
<li><p>Most frequent value when <span class="math inline">\(y\)</span> is categorical</p></li>
</ol>
</li>
<li><p>Predict <span class="math inline">\(y\)</span> with <span class="math inline">\(x\)</span> (e.g., linear, random forest, etc.)</p></li>
<li><p>Calculate the prediction error difference between 1 and 2</p></li>
</ol>
<p>To have a comprehensive table that could handle</p>
<ul>
<li><p>continuous vs. continuous</p></li>
<li><p>categorical vs. continuous</p></li>
<li><p>continuous vs. categorical</p></li>
<li><p>categorical vs. categorical</p></li>
</ul>
<p>the suggested model would be Classification and Regression Trees (CART). But we can certainly use other models as well.</p>
<p>The downfall of this method is that you might suffer</p>
<ol style="list-style-type: decimal">
<li>Symmetry: <span class="math inline">\((x,y) \neq (y,x)\)</span>
</li>
<li>Comparability : Different pair of comparison might use different metrics (e.g., misclassification error vs. MAE)</li>
</ol>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ppsr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ppsr::score_df(iris) # if you want a dataframe</span></span>
<span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/score_matrix.html">score_matrix</a></span><span class="op">(</span><span class="va">iris</span>,</span>
<span>                   do_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Sepal.Length Sepal.Width Petal.Length</span></span>
<span><span class="co">#&gt; Sepal.Length   1.00000000  0.04632352    0.5491398</span></span>
<span><span class="co">#&gt; Sepal.Width    0.06790301  1.00000000    0.2376991</span></span>
<span><span class="co">#&gt; Petal.Length   0.61608360  0.24263851    1.0000000</span></span>
<span></span>
<span><span class="co"># if you want a similar correlation matrix</span></span>
<span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/score_matrix.html">score_matrix</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>                   do_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;             cyl        vs      carb</span></span>
<span><span class="co">#&gt; cyl  1.00000000 0.3982789 0.2092533</span></span>
<span><span class="co">#&gt; vs   0.02514286 1.0000000 0.2000000</span></span>
<span><span class="co">#&gt; carb 0.30798148 0.2537309 1.0000000</span></span></code></pre></div>
<div id="visualization" class="section level3" number="3.5.1">
<h3>
<span class="header-section-number">3.5.1</span> Visualization<a class="anchor" aria-label="anchor" href="#visualization"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-37-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Alternatively,</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PerformanceAnalytics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/chart.Correlation.html">chart.Correlation</a></span><span class="op">(</span><span class="va">df</span>, histogram <span class="op">=</span> <span class="cn">T</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-38-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-39-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>More general form,</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/visualize_pps.html">visualize_pps</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">iris</span>,</span>
<span>    do_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-40-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/visualize_correlations.html">visualize_correlations</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">iris</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Both heat map and correlation at the same time</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/visualize_both.html">visualize_both</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">iris</span>,</span>
<span>    do_parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-42-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>More elaboration with <code>ggplot2</code></p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ppsr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ppsr/man/visualize_pps.html">visualize_pps</a></span><span class="op">(</span></span>
<span>    df <span class="op">=</span> <span class="va">iris</span>,</span>
<span>    color_value_high <span class="op">=</span> <span class="st">'red'</span>,</span>
<span>    color_value_low <span class="op">=</span> <span class="st">'yellow'</span>,</span>
<span>    color_text <span class="op">=</span> <span class="st">'black'</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> </span>
<span>                       <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgrey"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">'Correlation aand Heatmap'</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">'Subtitle'</span>,</span>
<span>        caption <span class="op">=</span> <span class="st">'Caption'</span>,</span>
<span>        x <span class="op">=</span> <span class="st">'More info'</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03-descriptive-stat_files/figure-html/unnamed-chunk-43-1.png" width="90%" style="display: block; margin: auto;"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></div>
<div class="next"><a href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#descriptive-stat"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="nav-link" href="#numerical-measures"><span class="header-section-number">3.1</span> Numerical Measures</a></li>
<li>
<a class="nav-link" href="#graphical-measures"><span class="header-section-number">3.2</span> Graphical Measures</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#shape"><span class="header-section-number">3.2.1</span> Shape</a></li>
<li><a class="nav-link" href="#scatterplot"><span class="header-section-number">3.2.2</span> Scatterplot</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#normality-assessment"><span class="header-section-number">3.3</span> Normality Assessment</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#graphical-assessment"><span class="header-section-number">3.3.1</span> Graphical Assessment</a></li>
<li><a class="nav-link" href="#summary-statistics"><span class="header-section-number">3.3.2</span> Summary Statistics</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#bivariate-statistics"><span class="header-section-number">3.4</span> Bivariate Statistics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#two-continuous"><span class="header-section-number">3.4.1</span> Two Continuous</a></li>
<li><a class="nav-link" href="#categorical-and-continuous"><span class="header-section-number">3.4.2</span> Categorical and Continuous</a></li>
<li><a class="nav-link" href="#two-discrete"><span class="header-section-number">3.4.3</span> Two Discrete</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#summary-1"><span class="header-section-number">3.5</span> Summary</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#visualization"><span class="header-section-number">3.5.1</span> Visualization</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/03-descriptive-stat.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/03-descriptive-stat.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2024-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
