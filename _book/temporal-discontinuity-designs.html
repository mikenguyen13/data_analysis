<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 28 Temporal Discontinuity Designs | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="When evaluating the causal impact of a policy, intervention, or treatment that begins at a known time, two popular quasi-experimental methods are: Regression Discontinuity in Time Interrupted Time...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 28 Temporal Discontinuity Designs | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/temporal-discontinuity-designs.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="When evaluating the causal impact of a policy, intervention, or treatment that begins at a known time, two popular quasi-experimental methods are: Regression Discontinuity in Time Interrupted Time...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 28 Temporal Discontinuity Designs | A Guide on Data Analysis">
<meta name="twitter:description" content="When evaluating the causal impact of a policy, intervention, or treatment that begins at a known time, two popular quasi-experimental methods are: Regression Discontinuity in Time Interrupted Time...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="active" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">38</span> Controls</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">39</span> Directed Acyclic Graph</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="temporal-discontinuity-designs" class="section level1" number="28">
<h1>
<span class="header-section-number">28</span> Temporal Discontinuity Designs<a class="anchor" aria-label="anchor" href="#temporal-discontinuity-designs"><i class="fas fa-link"></i></a>
</h1>
<p>When evaluating the causal impact of a policy, intervention, or treatment that begins at a known time, two popular quasi-experimental methods are:</p>
<ul>
<li><a href="temporal-discontinuity-designs.html#sec-regression-discontinuity-in-time">Regression Discontinuity in Time</a></li>
<li><a href="temporal-discontinuity-designs.html#sec-interrupted-time-series">Interrupted Time Series</a></li>
</ul>
<p>Both leverage the fact that an intervention or policy starts at a specific point in time, but they differ in how they model the outcome around that point and in the assumptions they require.</p>
<ul>
<li>Both use the timing of an intervention as the key to identifying a causal effect.</li>
<li>Both assume no other major changes that coincide exactly with the intervention.</li>
</ul>
<p>Unlike standard RD, which exploits variation in the <strong>cross-sectional dimension</strong> (e.g., eligibility thresholds), RDiT leverages variation in the <strong>time dimension</strong> to estimate causal effects.</p>
<p>ITS and RDiT are particularly useful when:</p>
<ol style="list-style-type: decimal">
<li>A policy is implemented at a fixed date for all subjects (e.g., a national tax reform).</li>
<li>A policy is implemented at different times for different subjects (e.g., state-level policy rollouts).</li>
<li>There is no suitable cross-sectional control group, making difference-in-differences infeasible.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="17%">
<col width="38%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th align="center">Feature</th>
<th align="center"><strong>RDiT</strong></th>
<th align="center"><strong>ITS</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>Focus</strong></td>
<td align="center">Local neighborhood around <span class="math inline">\(T^*\)</span>
</td>
<td align="center">Entire time series (long pre- and post-data)</td>
</tr>
<tr class="even">
<td align="center"><strong>Effect Model</strong></td>
<td align="center">Assumes a sharp, immediate jump</td>
<td align="center">Can capture abrupt or gradual changes (level &amp; slope)</td>
</tr>
<tr class="odd">
<td align="center"><strong>Method</strong></td>
<td align="center">Local polynomial regression around cutoff</td>
<td align="center">Segmented regression using the full series</td>
</tr>
<tr class="even">
<td align="center"><strong>Key Assumption</strong></td>
<td align="center">Units just before and after cutoff are comparable</td>
<td align="center">Trend would continue unchanged in absence of intervention</td>
</tr>
<tr class="odd">
<td align="center"><strong>Bandwidth / Window</strong></td>
<td align="center">Uses a bandwidth <span class="math inline">\(h\)</span> around <span class="math inline">\(T^*\)</span>
</td>
<td align="center">Typically uses the entire pre/post period</td>
</tr>
<tr class="even">
<td align="center"><strong>Data Requirement</strong></td>
<td align="center">High-resolution near <span class="math inline">\(T^*\)</span>
</td>
<td align="center">Sufficient pre-/post- observations to establish trends</td>
</tr>
</tbody>
</table></div>
<hr>
<div id="sec-regression-discontinuity-in-time" class="section level2" number="28.1">
<h2>
<span class="header-section-number">28.1</span> Regression Discontinuity in Time<a class="anchor" aria-label="anchor" href="#sec-regression-discontinuity-in-time"><i class="fas fa-link"></i></a>
</h2>
<p>Regression Discontinuity in Time is a special case of a <a href="sec-regression-discontinuity.html#sec-regression-discontinuity">Regression Discontinuity</a> design where the “forcing variable” is time itself. At an exact cutoff time <span class="math inline">\(T^*\)</span>, a policy or intervention is implemented. We compare observations <strong>just before</strong> and <strong>just after</strong> <span class="math inline">\(T^*\)</span> to estimate the causal effect.</p>
<p><strong>Key assumptions</strong> for RDiT:</p>
<ul>
<li>
<strong>Sharp assignment</strong>: The intervention precisely begins at time <span class="math inline">\(T^*\)</span>.</li>
<li>
<strong>Local continuity</strong>: Units just before and after <span class="math inline">\(T^*\)</span> are comparable except for treatment status.</li>
<li>
<strong>Continuity of Time-Varying Confounders</strong>
<ul>
<li>The fundamental assumption in RDiT is that unobserved factors affecting the outcome evolve smoothly over time.</li>
<li>If an unobserved confounder changes discontinuously at the cutoff date, RDiT will attribute the effect to the intervention incorrectly.</li>
</ul>
</li>
<li>
<strong>No other confounding interventions</strong> that begin exactly at <span class="math inline">\(T^*\)</span>.</li>
<li>
<strong>No Manipulation of the Running Variable (Time)</strong>
<ul>
<li>Unlike standard RD, where subjects may manipulate their assignment variable (e.g., test scores), time cannot be directly manipulated.</li>
<li>However, strategic anticipation of a policy (e.g., firms adjusting behavior before a tax increase) can create bias.</li>
</ul>
</li>
</ul>
<p>Using a local polynomial approach near <span class="math inline">\(T^*\)</span>:</p>
<p><span class="math display">\[
Y_t = \alpha_0 + \alpha_1 \bigl(T_t - T^*\bigr) \;+\; \tau\,D_t \;+\; \alpha_2 \bigl(T_t - T^*\bigr) D_t \;+\; \epsilon_t,
\quad \text{for } |T_t - T^*| &lt; h,
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(Y_t\)</span> is the outcome at time <span class="math inline">\(t\)</span>.</li>
<li>
<span class="math inline">\(T_t\)</span> is the time index (running variable).</li>
<li>
<span class="math inline">\(T^*\)</span> is the cutoff (intervention) time.</li>
<li>
<span class="math inline">\(D_t = 1\)</span> if <span class="math inline">\(t \ge T^*\)</span> and 0 otherwise.</li>
<li>
<span class="math inline">\(h\)</span> is a chosen bandwidth such that only observations close to <span class="math inline">\(T^*\)</span> are used.</li>
<li>
<span class="math inline">\(\tau\)</span> represents the treatment effect (the discontinuity at <span class="math inline">\(T^*\)</span>).</li>
</ul>
<p>Because RDiT focuses on a local window around <span class="math inline">\(T^*\)</span>, it is best when you expect an immediate jump at the cutoff and when observations near the cutoff are likely to be similar except for the treatment.</p>
<div class="inline-table"><table class="table table-sm">
<caption>When RDiT is Used Instead of Traditional RD</caption>
<colgroup>
<col width="20%">
<col width="36%">
<col width="42%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Criterion</strong></td>
<td><strong>Standard RD</strong></td>
<td><strong>RDiT</strong></td>
</tr>
<tr class="even">
<td>Running Variable</td>
<td>Cross-sectional (e.g., test score)</td>
<td>Time (e.g., policy implementation date)</td>
</tr>
<tr class="odd">
<td>Treatment Assignment</td>
<td>Based on threshold in <span class="math inline">\(X\)</span>
</td>
<td>Based on threshold in <span class="math inline">\(T^*\)</span>
</td>
</tr>
<tr class="even">
<td>Assumptions</td>
<td>No sorting, smooth potential outcomes</td>
<td>No anticipatory behavior, smooth confounders</td>
</tr>
<tr class="odd">
<td>Key Challenge</td>
<td>Manipulation of <span class="math inline">\(X\)</span> (sorting)</td>
<td>Serial correlation, anticipation effects</td>
</tr>
</tbody>
</table></div>
<div id="estimation-and-model-selection" class="section level3" number="28.1.1">
<h3>
<span class="header-section-number">28.1.1</span> Estimation and Model Selection<a class="anchor" aria-label="anchor" href="#estimation-and-model-selection"><i class="fas fa-link"></i></a>
</h3>
<p>In <a href="temporal-discontinuity-designs.html#sec-regression-discontinuity-in-time">Regression Discontinuity in Time</a>, model selection is critical to accurately estimate the causal effect at the cutoff <span class="math inline">\(T^*\)</span>. Unlike <a href="temporal-discontinuity-designs.html#sec-interrupted-time-series">Interrupted Time Series</a>, which models long-term trends before and after an intervention, RDiT relies on local comparisons around the cutoff. This means that:</p>
<ul>
<li>A narrow bandwidth (<span class="math inline">\(h\)</span>) should be chosen to focus on observations just before and after <span class="math inline">\(T^*\)</span>.</li>
<li>Polynomial order selection should be guided by the Bayesian Information Criterion to avoid overfitting.</li>
<li>Higher-order polynomials can introduce spurious curvature, so local linear or quadratic models are preferred.</li>
</ul>
<p>Because RDiT uses time-series data, it is essential to correct for serial correlation in errors:</p>
<ol style="list-style-type: decimal">
<li>Clustered Standard Errors: Adjusts for within-time correlation, ensuring valid inference.</li>
<li>Newey-West HAC Standard Errors: Corrects for heteroskedasticity and serial correlation over time.</li>
</ol>
<ul>
<li>If serial dependence exists in <span class="math inline">\(\epsilon_{it}\)</span> (the error term), there is no straightforward fix—introducing a lagged dependent variable may mis-specify the model.</li>
<li>If serial dependence exists in <span class="math inline">\(y_{it}\)</span> (the outcome variable):
<ul>
<li>With long windows, identifying the precise treatment effect becomes challenging.</li>
<li>
<strong>Including a lagged dependent variable can help</strong>, though bias may still arise from time-varying treatment effects or over-fitting.</li>
</ul>
</li>
</ul>
<hr>
<ol style="list-style-type: decimal">
<li><strong>Baseline Local Linear Model (Preferred in RDiT)</strong></li>
</ol>
<p><span class="math display">\[
Y_t = \alpha_0 + \alpha_1 (T_t - T^*) + \tau D_t + \alpha_2 (T_t - T^*) D_t + \epsilon_t, \quad \text{for } |T_t - T^*| &lt; h
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y_t\)</span> is the outcome of interest at time <span class="math inline">\(t\)</span>.</p></li>
<li><p><span class="math inline">\(T_t\)</span> is the time forcing variable.</p></li>
<li><p><span class="math inline">\(T^*\)</span> is the cutoff time when the policy/intervention occurs.</p></li>
<li><p><span class="math inline">\(D_t\)</span> is the treatment indicator:</p></li>
<li><p><span class="math inline">\(D_t = 1\)</span> if <span class="math inline">\(t \geq T^*\)</span> (post-intervention).</p></li>
<li><p><span class="math inline">\(D_t = 0\)</span> if <span class="math inline">\(t &lt; T^*\)</span> (pre-intervention).</p></li>
<li><p><span class="math inline">\(h\)</span> is the bandwidth, restricting analysis to observations close to <span class="math inline">\(T^*\)</span>.</p></li>
<li><p><span class="math inline">\(\tau\)</span> is the treatment effect, measuring the discontinuity at <span class="math inline">\(T^*\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha_1 (T_t - T^*)\)</span> allows for a smooth time trend on both sides of the cutoff.</p></li>
<li><p><span class="math inline">\(\alpha_2 (T_t - T^*) D_t\)</span> captures any differential time trends post-treatment.</p></li>
</ul>
<p>This model ensures that the treatment effect is identified from the discontinuity at <span class="math inline">\(T^*\)</span>, rather than long-term trends.</p>
<hr>
<ol start="2" style="list-style-type: decimal">
<li><strong>Quadratic Local Model (Allowing for Nonlinear Trends)</strong></li>
</ol>
<p>If the outcome variable exhibits curvature over time, a quadratic term can be added:</p>
<p><span class="math display">\[
Y_t = \alpha_0 + \alpha_1 (T_t - T^*) + \alpha_2 (T_t - T^*)^2 + \tau D_t + \alpha_3 (T_t - T^*) D_t + \alpha_4 (T_t - T^*)^2 D_t + \epsilon_t, \quad \text{for } |T_t - T^*| &lt; h
\]</span></p>
<ul>
<li>
<span class="math inline">\(\alpha_2 (T_t - T^*)^2\)</span> accounts for <strong>nonlinear pre-treatment trends</strong>.</li>
<li>
<span class="math inline">\(\alpha_4 (T_t - T^*)^2 D_t\)</span> allows for <strong>nonlinear post-treatment effects</strong>.</li>
</ul>
<p>This model is useful if visual inspection suggests a <strong>curved relationship</strong> near the cutoff.</p>
<hr>
<ol start="3" style="list-style-type: decimal">
<li><strong>Augmented Local Linear Model (Robust Control for Confounders)</strong></li>
</ol>
<p>Following <span class="citation">C. Hausman and Rapson (<a href="references.html#ref-hausman2018">2018</a>)</span>, an augmented approach helps control for omitted variables:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>First-stage regression:</strong> Estimate the outcome with all relevant control variables and compute the residuals.</p>
<p><span class="math display">\[
Y_t = \delta_0 + \sum_{j} \delta_j X_{jt} + \nu_t
\]</span></p>
<p>where <span class="math inline">\(X_{jt}\)</span> are observed covariates that could influence <span class="math inline">\(Y_t\)</span>.</p>
</li>
<li>
<p><strong>Second-stage RDiT model:</strong> Use residuals from the first stage in the standard local linear RDiT model:</p>
<p><span class="math display">\[
\hat{\nu}_t = \beta_0 + \beta_1 (T_t - T^*) + \tau D_t + \beta_2 (T_t - T^*) D_t + \epsilon_t, \quad \text{for } |T_t - T^*| &lt; h
\]</span></p>
</li>
</ol>
<ul>
<li>This approach removes variation explained by covariates before estimating the treatment effect.</li>
<li>Bootstrap methods should be used to correct for first-stage estimation variance.</li>
</ul>
<hr>
</div>
<div id="strengths-of-rdit" class="section level3" number="28.1.2">
<h3>
<span class="header-section-number">28.1.2</span> Strengths of RDiT<a class="anchor" aria-label="anchor" href="#strengths-of-rdit"><i class="fas fa-link"></i></a>
</h3>
<p>One of the key advantages of <strong>Regression Discontinuity in Time</strong> is its ability to handle cases where standard <strong>Difference-in-Differences</strong> approaches are infeasible. This typically occurs when treatment implementation lacks cross-sectional variation—meaning that all units receive treatment at the same time, leaving no untreated control group for comparison. In such cases, RDiT provides a viable alternative by exploiting temporal discontinuities in treatment assignment.</p>
<p>Notably, some studies combine both RDiT and DiD to strengthen identification and provide additional insights. For instance,</p>
<ul>
<li><p><span class="citation">Auffhammer and Kellogg (<a href="references.html#ref-auffhammer2011clearing">2011</a>)</span> applies these methods to examine how treatment effects vary across individuals and geographic space.</p></li>
<li><p><span class="citation">Gallego, Montero, and Salas (<a href="references.html#ref-gallego2013effect">2013</a>)</span> contrasts RDiT and DiD estimates when the validity of the control group in DiD is uncertain, helping assess potential biases.</p></li>
</ul>
<p>Beyond being an alternative to DiD, RDiT also offers advantages over simpler <strong>pre/post comparisons</strong>. Unlike naive before-and-after analyses, RDiT can incorporate flexible controls for time trends, reducing the risk of spurious results due to temporal confounders.</p>
<p>Event study methods, particularly modern implementations, have improved significantly, allowing researchers to study treatment effects over long time horizons. However, RDiT still holds certain advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Longer time horizons</strong>: Unlike traditional event studies, RDiT is not restricted to short-term dynamics and can capture effects that unfold gradually over extended periods.</li>
<li>
<strong>Higher-order time controls</strong>: RDiT allows for more flexible modeling of time trends, including the use of higher-order polynomials, which may provide better approximations of underlying time dynamics.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<caption>Comparison with Other Methods</caption>
<colgroup>
<col width="20%">
<col width="19%">
<col width="22%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th><strong>Method</strong></th>
<th><strong>Key Feature</strong></th>
<th><strong>Strengths</strong></th>
<th><strong>Weaknesses</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Difference-in-Differences</strong></td>
<td>Uses a control group</td>
<td>Accounts for time-invariant confounders</td>
<td>Requires parallel trends assumption</td>
</tr>
<tr class="even">
<td><strong>Event Study</strong></td>
<td>Models multiple time periods</td>
<td>Estimates dynamic treatment effects</td>
<td>Requires staggered interventions</td>
</tr>
<tr class="odd">
<td><strong>Pre/Post Comparison</strong></td>
<td>Simple before/after design</td>
<td>No control needed</td>
<td>Cannot separate treatment from time trends</td>
</tr>
<tr class="even">
<td><strong>Regression Discontinuity in Time</strong></td>
<td>Uses time as the running variable</td>
<td>Flexible polynomial trends</td>
<td>Sensitive to polynomial choice, cannot model time-varying treatment</td>
</tr>
</tbody>
</table></div>
</div>
<div id="limitations-and-challenges-of-rdit" class="section level3" number="28.1.3">
<h3>
<span class="header-section-number">28.1.3</span> Limitations and Challenges of RDiT<a class="anchor" aria-label="anchor" href="#limitations-and-challenges-of-rdit"><i class="fas fa-link"></i></a>
</h3>
<p>Despite its strengths, RDiT comes with several methodological challenges that researchers must carefully address.</p>
<div id="selection-bias-at-the-time-threshold" class="section level4" number="28.1.3.1">
<h4>
<span class="header-section-number">28.1.3.1</span> Selection Bias at the Time Threshold<a class="anchor" aria-label="anchor" href="#selection-bias-at-the-time-threshold"><i class="fas fa-link"></i></a>
</h4>
<p>A major concern in RDiT is <strong>bias from selecting observations too close to the threshold</strong>. Unlike cross-sectional RD designs, where observations on either side of the cutoff are assumed to be comparable, time-based designs introduce complications:</p>
<ul>
<li><p>The data-generating process may exhibit time-dependent structure.</p></li>
<li><p>Unobserved shocks occurring near the threshold can confound estimates.</p></li>
<li><p>Seasonal or cyclical trends may drive changes at the discontinuity rather than the treatment itself.</p></li>
</ul>
</div>
<div id="inapplicability-of-the-mccrary-test" class="section level4" number="28.1.3.2">
<h4>
<span class="header-section-number">28.1.3.2</span> Inapplicability of the McCrary Test<a class="anchor" aria-label="anchor" href="#inapplicability-of-the-mccrary-test"><i class="fas fa-link"></i></a>
</h4>
<p>A key diagnostic tool in standard RD designs is the McCrary test <span class="citation">(<a href="references.html#ref-mccrary2008manipulation">McCrary 2008</a>)</span>, which checks for discontinuities in the density of the running variable to detect manipulation. Unfortunately, this test is not feasible in RDiT because time itself is uniformly distributed. This limitation makes it more challenging to rule out sorting, anticipation, or other forms of manipulation (<a href="sec-regression-discontinuity.html#sec-sorting-bunching-and-manipulation">27.5.2</a>) around the threshold.</p>
</div>
<div id="potential-discontinuities-in-unobservables" class="section level4" number="28.1.3.3">
<h4>
<span class="header-section-number">28.1.3.3</span> Potential Discontinuities in Unobservables<a class="anchor" aria-label="anchor" href="#potential-discontinuities-in-unobservables"><i class="fas fa-link"></i></a>
</h4>
<p>Even if the treatment is assigned exogenously at a specific time, <strong>time-varying unobserved factors</strong> can still introduce discontinuities in the dependent variable. If these unobservable factors coincide with the threshold, they may be mistakenly attributed to the treatment effect, leading to biased conclusions.</p>
</div>
<div id="challenges-in-modeling-time-varying-treatment-effects" class="section level4" number="28.1.3.4">
<h4>
<span class="header-section-number">28.1.3.4</span> Challenges in Modeling Time-Varying Treatment Effects<a class="anchor" aria-label="anchor" href="#challenges-in-modeling-time-varying-treatment-effects"><i class="fas fa-link"></i></a>
</h4>
<p>RDiT does not naturally accommodate <strong>time-varying treatment effects</strong>, which can lead to specification issues. When choosing a time window:</p>
<ul>
<li><p><strong>A narrow window</strong> improves the local approximation but may reduce statistical power.</p></li>
<li><p><strong>A broader window</strong> provides more data but increases the risk of bias from additional confounders.</p></li>
</ul>
<p>To address these concerns, researchers must assume:</p>
<ol style="list-style-type: decimal">
<li>
<strong>The model is correctly specified</strong>, meaning it includes all relevant confounders or that the polynomial approximation accurately captures time trends.</li>
<li>
<strong>The treatment effect is correctly specified</strong>, whether assumed to be smooth, constant, or varying over time.</li>
</ol>
<p>Additionally, these two assumptions <strong>must not interact</strong>—in other words, the polynomial control should not be correlated with unobserved variation in the treatment effect. If this condition fails, bias from misspecification and treatment heterogeneity can compound <span class="citation">(<a href="references.html#ref-hausman2018">C. Hausman and Rapson 2018, 544</a>)</span>.</p>
</div>
<div id="sorting-and-anticipation-effects" class="section level4" number="28.1.3.5">
<h4>
<span class="header-section-number">28.1.3.5</span> Sorting and Anticipation Effects<a class="anchor" aria-label="anchor" href="#sorting-and-anticipation-effects"><i class="fas fa-link"></i></a>
</h4>
<p>Unlike traditional RD designs, where individuals cannot manipulate their assignment to treatment, time-based cutoffs introduce <strong>potential sorting, anticipation, or avoidance behaviors</strong>.</p>
<p>While the McCrary test cannot be applied to detect manipulation, researchers can perform robustness checks:</p>
<ul>
<li><p><strong>Check for discontinuities in other covariates</strong>: Ideally, covariates should be smooth around the threshold.</p></li>
<li><p><strong>Test for placebo discontinuities</strong>: If significant jumps appear at other, randomly chosen thresholds, this raises concerns about the validity of the estimated treatment effect.</p></li>
</ul>
<p>The difficulty in RDiT is that <strong>even when a treatment effect is detected, it may reflect more than just the causal effect of the intervention</strong>. Anticipatory behavior, adaptation, and strategic avoidance may all contribute to observed discontinuities, making it harder to isolate the <strong>true causal effect</strong>.</p>
<p>Thus, researchers relying on RDiT must make a strong case that such behaviors <strong>do not</strong> drive their results. This often requires additional robustness tests, alternative specifications, or comparisons with other methods to rule out alternative explanations.</p>
<hr>
</div>
</div>
<div id="recommendations-for-robustness-checks" class="section level3" number="28.1.4">
<h3>
<span class="header-section-number">28.1.4</span> Recommendations for Robustness Checks<a class="anchor" aria-label="anchor" href="#recommendations-for-robustness-checks"><i class="fas fa-link"></i></a>
</h3>
<p>To ensure the validity of RDiT estimates, researchers should conduct a series of <strong>robustness checks</strong> to detect potential biases from overfitting, time-varying treatment effects, and model misspecification. The following strategies, based on <span class="citation">(<a href="references.html#ref-hausman2018">C. Hausman and Rapson 2018, 549</a>)</span>, provide a comprehensive framework for assessing the reliability of results.</p>
<ol style="list-style-type: decimal">
<li><strong>Visual Inspection: Raw Data and Residuals</strong></li>
</ol>
<p>Before applying any complex statistical adjustments, start with a simple visualization of the raw data and residuals (after removing confounders and time trends). If results are sensitive to the choice of polynomial order or local linear controls, it could signal time-varying treatment effects.</p>
<p>A well-behaved RDiT should exhibit a clear and consistent discontinuity at the threshold, regardless of the specification used. If the discontinuity shifts or fades under different model choices, this suggests sensitivity to the polynomial approximation, potentially indicating bias.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Sensitivity to Polynomial Order and Bandwidth Choice</strong></li>
</ol>
<p>A common concern in RDiT is overfitting due to high-order global polynomials. To diagnose this issue:</p>
<ul>
<li><p>Estimate the model with different polynomial orders and check whether results remain consistent.</p></li>
<li><p>Compare global polynomial estimates with local linear specifications using different bandwidths.</p></li>
<li><p>If findings remain stable across specifications, the estimates are likely robust. However, if results fluctuate significantly, this suggests potential overfitting or sensitivity to bandwidth choice.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Placebo Tests</strong></li>
</ol>
<p>To strengthen causal claims, conduct placebo tests by estimating the RDiT model under conditions where no treatment effect should exist. There are two primary approaches:</p>
<ol style="list-style-type: decimal">
<li>Estimate the RD on a different location or population that did not receive the treatment. If a discontinuity is detected, it suggests that the estimated effect may be driven by factors other than the intervention.</li>
<li>Use an alternative time threshold where no intervention took place. If the model still detects a significant effect, this implies that the discontinuity may be an artifact of the method rather than the treatment.</li>
</ol>
<p>If placebo tests reveal no significant discontinuities, this reinforces the credibility of the primary RDiT estimate.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Discontinuity in Continuous Controls</strong></li>
</ol>
<p>Another useful diagnostic is to <strong>plot the RD discontinuity on continuous control variables</strong> that should not be affected by the treatment.</p>
<ul>
<li><p>If these covariates exhibit a significant jump at the threshold, it raises concerns that other <strong>time-varying confounders</strong> may be driving the observed effect.</p></li>
<li><p>Ideally, covariates should remain smooth across the threshold, confirming that the discontinuity in the outcome is <strong>not</strong> due to unobserved factors.</p></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Donut RD: Excluding Observations Near the Cutoff</strong></li>
</ol>
<p>To assess whether strategic behavior or anticipation effects are influencing the estimates, researchers can use a <strong>donut RD</strong> approach <span class="citation">(<a href="references.html#ref-barreca2011saving">Barreca et al. 2011</a>)</span>.</p>
<ul>
<li><p>This involves <strong>removing observations immediately around the threshold</strong> to check whether results remain consistent.</p></li>
<li><p>If avoiding selection close to the cutoff significantly alters the findings, this suggests that <strong>sorting, anticipation, or measurement error</strong> may be affecting the estimates.</p></li>
<li><p>If results are stable even after excluding these observations, it strengthens confidence in the identification strategy.</p></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><strong>Testing for Autoregression</strong></li>
</ol>
<p>Because RDiT operates in a time-series framework, serial dependence in the residuals can distort standard errors and bias inference. To diagnose this:</p>
<ul>
<li><p>Use pre-treatment data to test for autoregression in the dependent variable.</p></li>
<li><p>If autoregression is detected, consider including a lagged dependent variable to account for serial correlation.</p></li>
<li><p>However, be cautious—introducing a lagged outcome may create dynamic bias if the treatment effect itself influences the lag.</p></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li><strong>Augmented Local Linear Approach</strong></li>
</ol>
<p>Instead of relying on global polynomials, which risk overfitting, a more reliable alternative is an <strong>augmented local linear approach</strong>, which avoids excessive reliance on high-order time polynomials. The procedure involves two key steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Use the full sample to control for key predictors</strong>, ensuring that the model accounts for important covariates that may confound the treatment effect.</li>
<li>
<strong>Estimate the conditioned second-stage model on a narrower bandwidth</strong> to refine the local approximation while maintaining robustness to overfitting.</li>
</ol>
<hr>
</div>
<div id="applications-of-rdit" class="section level3" number="28.1.5">
<h3>
<span class="header-section-number">28.1.5</span> Applications of RDiT<a class="anchor" aria-label="anchor" href="#applications-of-rdit"><i class="fas fa-link"></i></a>
</h3>
<p>Regression Discontinuity in Time has been widely applied across various disciplines, particularly in <strong>economics and marketing</strong>, where policy changes, regulations, and market shifts often provide natural time-based discontinuities. Below, we summarize key studies that have employed RDiT to estimate causal effects.</p>
<div id="applications-in-economics-1" class="section level4" number="28.1.5.1">
<h4>
<span class="header-section-number">28.1.5.1</span> Applications in Economics<a class="anchor" aria-label="anchor" href="#applications-in-economics-1"><i class="fas fa-link"></i></a>
</h4>
<p>RDiT has been used extensively in <strong>environmental economics</strong>, <strong>transportation policy</strong>, and <strong>public health</strong>, where regulations or interventions are introduced at well-defined points in time. Some notable studies include:</p>
<ol style="list-style-type: decimal">
<li><strong>Environmental Regulations and Air Quality</strong></li>
</ol>
<p>Several studies exploit sudden policy changes or emission regulations to estimate their impact on air pollution:</p>
<ul>
<li><p><span class="citation">Davis (<a href="references.html#ref-davis2008effect">2008</a>)</span>, <span class="citation">Auffhammer and Kellogg (<a href="references.html#ref-auffhammer2011clearing">2011</a>)</span>, and <span class="citation">H. Chen et al. (<a href="references.html#ref-chen2018effect">2018</a>)</span> all examine the impact of environmental regulations on air quality.</p></li>
<li><p><span class="citation">Gallego, Montero, and Salas (<a href="references.html#ref-gallego2013effect">2013</a>)</span> compares RDiT and Difference-in-Differences (DiD) estimates to assess the reliability of control groups in air pollution studies.</p></li>
</ul>
<p>By leveraging RDiT, these studies isolate immediate changes in pollution levels at policy thresholds while controlling for underlying trends.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Traffic and Transportation Policies</strong></li>
</ol>
<p>RDiT has been used to assess the impact of transportation policies on congestion, accidents, and public transit usage:</p>
<ul>
<li><p><span class="citation">Bento et al. (<a href="references.html#ref-bento2014effects">2014</a>)</span> and <span class="citation">M. L. Anderson (<a href="references.html#ref-anderson2014subways">2014</a>)</span> investigate how new subway openings and transportation policies affect traffic congestion.</p></li>
<li><p><span class="citation">De Paola, Scoppa, and Falcone (<a href="references.html#ref-de2013deterrent">2013</a>)</span> and <span class="citation">Burger, Kaffine, and Yu (<a href="references.html#ref-burger2014did">2014</a>)</span> analyze the deterrent effects of traffic safety regulations on car accidents, using policy enactment dates as a discontinuity.</p></li>
</ul>
<p>These studies demonstrate how RDiT can effectively measure behavioral responses to transportation interventions, isolating immediate impacts from broader secular trends.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>COVID-19 Lockdowns and Well-being</strong></li>
</ol>
<ul>
<li>
<span class="citation">Brodeur et al. (<a href="references.html#ref-brodeur2021covid">2021</a>)</span> employs RDiT to assess the impact of COVID-19 lockdowns on psychological well-being, economic activity, and public health outcomes.</li>
</ul>
<p>The sudden implementation of lockdown policies provides a sharp time-based discontinuity, making RDiT a natural method to evaluate their effects.</p>
<hr>
</div>
<div id="applications-in-marketing-1" class="section level4" number="28.1.5.2">
<h4>
<span class="header-section-number">28.1.5.2</span> Applications in Marketing<a class="anchor" aria-label="anchor" href="#applications-in-marketing-1"><i class="fas fa-link"></i></a>
</h4>
<p>In marketing, RDiT has been applied to analyze <strong>consumer behavior, pricing strategies, and promotional effectiveness</strong> in response to abrupt policy or market changes.</p>
<ol style="list-style-type: decimal">
<li><strong>Vehicle Pricing and Demand Shocks</strong></li>
</ol>
<p>Several studies leverage RDiT to study how consumers and firms respond to price changes in the automotive market:</p>
<ul>
<li><p><span class="citation">M. Busse, Silva-Risso, and Zettelmeyer (<a href="references.html#ref-busse20061">2006</a>)</span>, <span class="citation">M. R. Busse, Simester, and Zettelmeyer (<a href="references.html#ref-busse2010best">2010</a>)</span>, and <span class="citation">M. R. Busse et al. (<a href="references.html#ref-busse2013estimating">2013</a>)</span> explore the impact of promotional campaigns and policy changes on vehicle prices.</p></li>
<li><p><span class="citation">Davis and Kahn (<a href="references.html#ref-davis2010international">2010</a>)</span> investigates how changes in international trade policies influence vehicle pricing.</p></li>
</ul>
<p>By identifying sharp price discontinuities at the time of policy changes, these studies provide causal insights into price elasticity and consumer demand.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Customer Satisfaction and Learning Effects</strong></li>
</ol>
<ul>
<li>
<span class="citation">X. Chen et al. (<a href="references.html#ref-chen2009learning">2009</a>)</span> applies RDiT to measure how customer satisfaction evolves after firms make abrupt service changes.</li>
</ul>
<p>This study demonstrates how RDiT can capture immediate consumer reactions, distinguishing between short-term dissatisfaction and long-term adaptation.</p>
</div>
</div>
<div id="empirical-example" class="section level3" number="28.1.6">
<h3>
<span class="header-section-number">28.1.6</span> Empirical Example<a class="anchor" aria-label="anchor" href="#empirical-example"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Generating synthetic time-series data with a known cutoff T_star</li>
<li>Visualizing the entire dataset, including the jump at T_star</li>
<li>Fitting a local linear RDiT model (baseline)</li>
<li>Adding a local polynomial (quadratic) to allow nonlinear trends</li>
<li>Demonstrating robust (sandwich) standard errors to account for serial correlation</li>
<li>Performing a “donut” RDiT by excluding observations near T_star</li>
<li>Conducting a placebo test at a fake cutoff</li>
<li>Demonstrating an augmented approach with a confounder</li>
<li>Plotting the local data and fitted RDiT regression lines</li>
</ol>
<div class="sourceCode" id="cb738"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 0. Libraries</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://sandwich.R-Forge.R-project.org/">"sandwich"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"sandwich"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span><span class="op">)</span>   <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"lmtest"</span>,   quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 1. Generate Synthetic Data</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span>      <span class="op">&lt;-</span> <span class="fl">200</span>                <span class="co"># total number of time points</span></span>
<span><span class="va">T_star</span> <span class="op">&lt;-</span> <span class="fl">100</span>                <span class="co"># cutoff (policy/intervention) time</span></span>
<span><span class="va">t_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>         <span class="co"># time index: 1, 2, ..., n</span></span>
<span></span>
<span><span class="co"># Outcome Y has a linear pre-trend, a mild quadratic component, </span></span>
<span><span class="co"># and a jump of +5 at T_star</span></span>
<span><span class="co"># plus a small sinusoidal seasonality and random noise.</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">t_vals</span> <span class="op">+</span>          <span class="co"># baseline slope</span></span>
<span>     <span class="fl">0.002</span> <span class="op">*</span> <span class="op">(</span><span class="va">t_vals</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># mild curvature</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># jump at T_star</span></span>
<span>     <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">/</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>              <span class="co"># mild seasonal pattern</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>                 <span class="co"># random noise</span></span>
<span></span>
<span><span class="co"># Optional confounder X that also increases with time</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">t_vals</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Store everything in a single data frame</span></span>
<span><span class="va">df_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">t_vals</span>, Y <span class="op">=</span> <span class="va">Y</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 2. Plot the Entire Dataset &amp; Highlight the Cutoff</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># We'll produce two plots side by side</span></span>
<span></span>
<span><span class="co"># Plot 1: Full data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">df_full</span><span class="op">$</span><span class="va">t</span>, <span class="va">df_full</span><span class="op">$</span><span class="va">Y</span>, pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time (t)"</span>, ylab<span class="op">=</span><span class="st">"Outcome (Y)"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Full Time Series with True Jump at T_star"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">T_star</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># vertical line at the cutoff</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 3. Restrict to a Local Bandwidth (h) Around T_star</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">df_local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">df_full</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">h</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create variables for local regression</span></span>
<span><span class="va">df_local</span><span class="op">$</span><span class="va">D</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df_local</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df_local</span><span class="op">$</span><span class="va">t_centered</span>  <span class="op">&lt;-</span> <span class="va">df_local</span><span class="op">$</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 4. Baseline Local Linear RDiT Model</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># Model:</span></span>
<span><span class="co">#   Y = alpha_0 + alpha_1*(t - T_star) + tau*D + alpha_2*(t - T_star)*D + error</span></span>
<span><span class="va">mod_rdit_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t_centered</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">t_centered</span><span class="op">:</span><span class="va">D</span>, data <span class="op">=</span> <span class="va">df_local</span><span class="op">)</span></span>
<span><span class="co"># Robust (HC) standard errors for potential serial correlation</span></span>
<span><span class="va">res_rdit_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_rdit_linear</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_rdit_linear</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 5. Local Polynomial (Quadratic) RDiT Model</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">df_local</span><span class="op">$</span><span class="va">t_centered2</span> <span class="op">&lt;-</span> <span class="va">df_local</span><span class="op">$</span><span class="va">t_centered</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">mod_rdit_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t_centered</span> <span class="op">+</span> <span class="va">t_centered2</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">t_centered</span><span class="op">:</span><span class="va">D</span> <span class="op">+</span> <span class="va">t_centered2</span><span class="op">:</span><span class="va">D</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">df_local</span><span class="op">)</span></span>
<span><span class="va">res_rdit_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_rdit_quad</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_rdit_quad</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 6. Donut Approach: Excluding Observations Near the Cutoff</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">df_donut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">df_local</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># remove t_star +/- 1 unit</span></span>
<span><span class="va">mod_rdit_donut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t_centered</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">t_centered</span><span class="op">:</span><span class="va">D</span>, data <span class="op">=</span> <span class="va">df_donut</span><span class="op">)</span></span>
<span><span class="va">res_rdit_donut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_rdit_donut</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_rdit_donut</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 7. Placebo Test: Fake Cutoff</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">T_fake</span> <span class="op">&lt;-</span> <span class="fl">120</span></span>
<span><span class="va">df_placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">df_full</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_fake</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">h</span><span class="op">)</span></span>
<span><span class="va">df_placebo</span><span class="op">$</span><span class="va">D_placebo</span>          <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df_placebo</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">T_fake</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df_placebo</span><span class="op">$</span><span class="va">t_centered_placebo</span> <span class="op">&lt;-</span> <span class="va">df_placebo</span><span class="op">$</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_fake</span></span>
<span></span>
<span><span class="va">mod_rdit_placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t_centered_placebo</span> <span class="op">+</span> <span class="va">D_placebo</span> <span class="op">+</span> <span class="va">t_centered_placebo</span><span class="op">:</span><span class="va">D_placebo</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">df_placebo</span><span class="op">)</span></span>
<span><span class="va">res_rdit_placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_rdit_placebo</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_rdit_placebo</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 8. Augmented RDiT Model (Controlling for X)</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">mod_rdit_aug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="va">t_centered</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="va">t_centered</span><span class="op">:</span><span class="va">D</span>, data <span class="op">=</span> <span class="va">df_local</span><span class="op">)</span></span>
<span><span class="va">res_rdit_aug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_rdit_aug</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_rdit_aug</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 9. Plot the Local Data and Fitted RDiT Lines</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">df_local</span><span class="op">$</span><span class="va">t</span>, <span class="va">df_local</span><span class="op">$</span><span class="va">Y</span>, pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time (t)"</span>, ylab<span class="op">=</span><span class="st">"Outcome (Y)"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Local Window Around T_star"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sort data by centered time for a smooth line</span></span>
<span><span class="va">df_local_sorted</span> <span class="op">&lt;-</span> <span class="va">df_local</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">df_local</span><span class="op">$</span><span class="va">t_centered</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">pred_linear</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_rdit_linear</span>, newdata<span class="op">=</span><span class="va">df_local_sorted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df_local_sorted</span><span class="op">$</span><span class="va">t</span>, <span class="va">pred_linear</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a vertical line at T_star for reference</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">T_star</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="28-interrupted-time-series_files/figure-html/rdit-comprehensive-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb739"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># Print Summaries &amp; Brief Interpretation</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">" Local Linear RDiT (Baseline):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Local Linear RDiT (Baseline):</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_rdit_linear</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  61.213434   1.625008 37.6696 2.853e-16 ***</span></span>
<span><span class="co">#&gt; t_centered    1.032094   0.231380  4.4606 0.0004579 ***</span></span>
<span><span class="co">#&gt; D             2.853971   1.772639  1.6100 0.1282338    </span></span>
<span><span class="co">#&gt; t_centered:D -0.076391   0.271405 -0.2815 0.7821991    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Local Quadratic RDiT:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Local Quadratic RDiT:</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_rdit_quad</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   61.827393   3.038967 20.3449 3.061e-11 ***</span></span>
<span><span class="co">#&gt; t_centered     1.366981   1.342431  1.0183    0.3271    </span></span>
<span><span class="co">#&gt; t_centered2    0.033489   0.124970  0.2680    0.7929    </span></span>
<span><span class="co">#&gt; D              1.577410   3.103945  0.5082    0.6198    </span></span>
<span><span class="co">#&gt; t_centered:D   0.085673   1.397606  0.0613    0.9521    </span></span>
<span><span class="co">#&gt; t_centered2:D -0.088706   0.134490 -0.6596    0.5210    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Donut RDiT (Excluding Observations Near T_star):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Donut RDiT (Excluding Observations Near T_star):</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_rdit_donut</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  62.52140    1.87095 33.4169 3.273e-13 ***</span></span>
<span><span class="co">#&gt; t_centered    1.22829    0.27153  4.5235 0.0006975 ***</span></span>
<span><span class="co">#&gt; D             2.97980    2.01021  1.4823 0.1640306    </span></span>
<span><span class="co">#&gt; t_centered:D -0.49288    0.32020 -1.5393 0.1496810    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Placebo Test (Fake Cutoff at T_fake=120):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Placebo Test (Fake Cutoff at T_fake=120):</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_rdit_placebo</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                  82.658533   0.868852 95.1354 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; t_centered_placebo            0.768238   0.185830  4.1341 0.0008831 ***</span></span>
<span><span class="co">#&gt; D_placebo                    -0.377333   1.188411 -0.3175 0.7552328    </span></span>
<span><span class="co">#&gt; t_centered_placebo:D_placebo -0.013586   0.245019 -0.0555 0.9565112    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Augmented RDiT (Controlling for X):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Augmented RDiT (Controlling for X):</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_rdit_aug</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)  50.960390  13.226193  3.8530 0.001757 **</span></span>
<span><span class="co">#&gt; X             0.068836   0.087887  0.7832 0.446540   </span></span>
<span><span class="co">#&gt; t_centered    0.984583   0.249801  3.9415 0.001476 **</span></span>
<span><span class="co">#&gt; D             2.922905   1.935753  1.5100 0.153291   </span></span>
<span><span class="co">#&gt; t_centered:D -0.141496   0.318509 -0.4442 0.663655   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<ul>
<li>‘D’ is the local jump at T_star (i.e., the treatment effect, tau).</li>
<li>‘t_centered:D’ indicates how the slope differs post-cutoff.</li>
<li>In the placebo test, D_placebo should ideally be insignificant.</li>
<li>In the donut model, large differences from the baseline may suggest local anomalies or anticipation near T_star.</li>
<li>In the augmented model, controlling for X can change tau if X was correlated with both Y and time.</li>
</ul>
<hr>
</div>
</div>
<div id="sec-interrupted-time-series" class="section level2" number="28.2">
<h2>
<span class="header-section-number">28.2</span> Interrupted Time Series<a class="anchor" aria-label="anchor" href="#sec-interrupted-time-series"><i class="fas fa-link"></i></a>
</h2>
<p>Interrupted Time Series (ITS) is a powerful quasi-experimental method used to assess <strong>how an intervention affects the level and/or trend of an outcome over time</strong>. By analyzing long-term <strong>pre- and post-intervention</strong> data, ITS estimates what would have happened in the absence of the intervention—assuming the pre-existing trend would have continued unchanged.</p>
<p>ITS is particularly useful when a <strong>policy, treatment, or intervention is implemented at a distinct point in time</strong>, affecting an entire population or group simultaneously. It differs from RDiT in that it typically models <strong>both abrupt and gradual changes</strong> over time rather than exploiting a sharp discontinuity.</p>
<p>A well-specified ITS model should account for:</p>
<ul>
<li><p><strong>Seasonal trends</strong>: Some outcomes exhibit cyclical patterns (e.g., sales, disease prevalence), which must be adjusted for.</p></li>
<li><p><strong>Concurrent events</strong>: Other changes occurring around the same time as the intervention may confound estimates, making it difficult to attribute observed changes solely to the intervention.</p></li>
</ul>
<p>ITS is appropriate when:</p>
<ol style="list-style-type: decimal">
<li>Longitudinal data is available: The outcome must be observed over time, with multiple data points before and after the intervention.</li>
<li>A population-wide intervention occurs at a specific time: The intervention should affect all units simultaneously or be structured in a way that allows stacking based on intervention timing.</li>
</ol>
<p><strong>Notes</strong></p>
<ul>
<li>For analyzing <strong>subgroup effects</strong> (heterogeneity in treatment impact), see <span class="citation">(<a href="references.html#ref-harper2017did">Harper and Bruckner 2017</a>)</span>.</li>
<li>For interpreting ITS results <strong>with control variables</strong>, see <span class="citation">(<a href="references.html#ref-bottomley2019analysing">Bottomley, Scott, and Isham 2019</a>)</span>.</li>
</ul>
<p>Possible Threats to the Validity of ITS Analysis <span class="citation">(<a href="references.html#ref-baicker2019testing">Baicker and Svoronos 2019</a>)</span></p>
<ul>
<li><p><strong>Delayed effects</strong> <span class="citation">(<a href="references.html#ref-rodgers2005did">Rodgers, John, and Coleman 2005</a>)</span><br>
The impact of an intervention may manifest some time after its introduction. If only the immediate post-intervention period is assessed, key effects could be missed.</p></li>
<li><p><strong>Other confounding events</strong> <span class="citation">(<a href="references.html#ref-linden2016using">Linden and Yarnold 2016</a>; <a href="references.html#ref-linden2017comprehensive">Linden 2017</a>)</span><br>
Concurrent policy changes or external shocks that overlap with the intervention period can obscure or inflate the apparent intervention effect.</p></li>
<li><p><strong>Intervention is introduced but later withdrawn</strong> <span class="citation">(<a href="references.html#ref-linden2015conducting">Linden 2015</a>)</span><br>
When an intervention does not remain in place, the time series may reflect multiple shifts in trends or levels, complicating the interpretation of a single “interrupted” period.</p></li>
<li><p><strong>Autocorrelation</strong><br>
Time series data often exhibit autocorrelation, which can lead to underestimated standard errors if not properly accounted for, thus overstating the statistical significance of the intervention effect.</p></li>
<li><p><strong>Regression to the mean</strong><br>
After a short-term shock, outcomes may revert toward prior or average levels. Interpreting this natural reversion as an intervention effect can be misleading.</p></li>
<li><p><strong>Selection bias</strong><br>
If only certain individuals or settings receive the intervention, pre-existing differences may confound the results. Designs with multiple groups or comparison series can help mitigate this bias.</p></li>
</ul>
<p>After an intervention, an outcome can exhibit four distinct patterns:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<strong>Key assumptions</strong> for ITS:</caption>
<colgroup>
<col width="36%">
<col width="63%">
</colgroup>
<thead><tr class="header">
<th><strong>Scenario</strong></th>
<th><strong>Description</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>No effect</strong></td>
<td>The intervention does not change the level or trend of the outcome.</td>
</tr>
<tr class="even">
<td><strong>Immediate effect</strong></td>
<td>A sharp, immediate change in the outcome following the intervention.</td>
</tr>
<tr class="odd">
<td><strong>Sustained effect</strong></td>
<td>A gradual, long-term shift in the outcome that smooths over time.</td>
</tr>
<tr class="even">
<td><strong>Both immediate &amp; sustained effects</strong></td>
<td>A combination of a sudden change and a long-term trend shift.</td>
</tr>
</tbody>
</table></div>
<ul>
<li>The <strong>pre-intervention trend</strong> would remain stable if the intervention never occurred (i.e., no major time-varying confounders coinciding with the intervention).</li>
<li>Data is available for <strong>multiple time points before and after</strong> the intervention to estimate trends.</li>
</ul>
<p>The following model integrates both immediate and sustained intervention effects (i.e., segmented regression):</p>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 T_t + \beta_2 D_t + \beta_3 (T_t \times D_t) + \beta_4 P_t + \epsilon_t
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(Y_t\)</span>: Outcome variable at time <span class="math inline">\(t\)</span>.</li>
<li>
<span class="math inline">\(T_t\)</span>: Time index (continuous).
<ul>
<li>
<span class="math inline">\(\beta_1\)</span>: Baseline slope (trend before intervention).</li>
</ul>
</li>
<li>
<span class="math inline">\(D_t\)</span>: Intervention dummy (<span class="math inline">\(D_t = 1\)</span> if <span class="math inline">\(t \geq T^*\)</span>, otherwise 0).
<ul>
<li>
<span class="math inline">\(\beta_2\)</span>: Immediate effect (level change at intervention).</li>
</ul>
</li>
<li>
<span class="math inline">\((T_t \times D_t)\)</span>: Interaction term capturing a change in slope post-intervention.
<ul>
<li>
<span class="math inline">\(\beta_3\)</span>: Difference in slope after intervention compared to before.</li>
</ul>
</li>
<li>
<span class="math inline">\(P_t\)</span>: Time since the intervention (0 before intervention, increments after).
<ul>
<li>
<span class="math inline">\(\beta_4\)</span>: Sustained effect over time.</li>
</ul>
</li>
<li>
<span class="math inline">\(\epsilon_t\)</span>: Error term (assumed to be normally distributed).</li>
</ul>
<p>This model allows us to:</p>
<ol style="list-style-type: decimal">
<li>Measure the pre-intervention trend (<span class="math inline">\(\beta_1\)</span>).</li>
<li>Capture the immediate effect of the intervention (<span class="math inline">\(\beta_2\)</span>).</li>
<li>Identify if the slope changes post-intervention (<span class="math inline">\(\beta_3\)</span>).</li>
<li>Examine long-term effects using <span class="math inline">\(P_t\)</span> (<span class="math inline">\(\beta_4\)</span>).</li>
</ol>
<p>ITS does not require a purely immediate or discontinuous effect; the effect can be gradual or delayed, which can be captured with additional terms (e.g., lags or non-linear structures).</p>
<div id="advantages-of-its" class="section level3" number="28.2.1">
<h3>
<span class="header-section-number">28.2.1</span> Advantages of ITS<a class="anchor" aria-label="anchor" href="#advantages-of-its"><i class="fas fa-link"></i></a>
</h3>
<p>ITS offers several benefits, particularly in public policy, health research, and economics. According to <span class="citation">(<a href="references.html#ref-penfold2013use">Penfold and Zhang 2013</a>)</span>, key advantages include:</p>
<ul>
<li><p><strong>Controls for long-term trends</strong>: Unlike simple pre/post comparisons, ITS explicitly models pre-existing trajectories, reducing bias from underlying trends.</p></li>
<li><p><strong>Applicable to population-wide interventions</strong>: When an entire group or region is affected simultaneously, ITS provides a strong alternative to traditional experimental methods.</p></li>
</ul>
</div>
<div id="limitations-of-its" class="section level3" number="28.2.2">
<h3>
<span class="header-section-number">28.2.2</span> Limitations of ITS<a class="anchor" aria-label="anchor" href="#limitations-of-its"><i class="fas fa-link"></i></a>
</h3>
<p>While ITS is a valuable tool, it has some key limitations:</p>
<ul>
<li><p><strong>Requires a sufficient number of observations</strong>: At least <strong>8 data points before and 8 after</strong> the intervention are typically recommended for reliable estimation.</p></li>
<li><p><strong>Challenging with multiple overlapping events</strong>: When several interventions occur close together in time, it can be difficult to isolate their individual effects.</p></li>
</ul>
</div>
<div id="empirical-example-1" class="section level3" number="28.2.3">
<h3>
<span class="header-section-number">28.2.3</span> Empirical Example<a class="anchor" aria-label="anchor" href="#empirical-example-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Generating synthetic time-series data with a known intervention time T_star</li>
<li>Modeling an Interrupted Time Series (ITS) with both immediate and sustained effects</li>
<li>Accounting for pre-intervention trend, immediate jump, slope change, and post-intervention time</li>
<li>Demonstrating robust (sandwich) standard errors to handle possible autocorrelation</li>
<li>Visualizing the data and fitted ITS lines</li>
<li>Brief interpretation of coefficients</li>
</ol>
<div class="sourceCode" id="cb740"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 0. Libraries</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://sandwich.R-Forge.R-project.org/">"sandwich"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"sandwich"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span><span class="op">)</span>   <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"lmtest"</span>,   quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 1. Generate Synthetic Data</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">n</span>       <span class="op">&lt;-</span> <span class="fl">50</span>               <span class="co"># total number of time points</span></span>
<span><span class="va">T_star</span>  <span class="op">&lt;-</span> <span class="fl">25</span>               <span class="co"># intervention time</span></span>
<span><span class="va">t_vals</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>       <span class="co"># time index: 1, 2, ..., n</span></span></code></pre></div>
<p>We’ll simulate a time-series with:</p>
<ul>
<li><p>A baseline slope pre-intervention</p></li>
<li><p>An immediate jump at <span class="math inline">\(T^*\)</span></p></li>
<li><p>A change in slope after <span class="math inline">\(T^*\)</span></p></li>
<li><p>A mild seasonal pattern</p></li>
<li><p>Random noise</p></li>
</ul>
<div class="sourceCode" id="cb741"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">1.0</span> <span class="op">*</span> <span class="va">t_vals</span> <span class="op">+</span>                      <span class="co"># baseline slope</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>   <span class="co"># immediate jump of +10 at T_star</span></span>
<span>  </span>
<span>  <span class="co"># additional slope post-intervention</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">t_vals</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span>                <span class="co"># mild seasonal pattern</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>                   <span class="co"># random noise</span></span>
<span></span>
<span><span class="co"># Combine into a data frame</span></span>
<span><span class="va">df_its</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">t_vals</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 2. Define Key ITS Variables</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span></code></pre></div>
<ul>
<li><p><span class="math inline">\(T_t\)</span>: the time index (we’ll just use ‘time’ for that)</p></li>
<li><p><span class="math inline">\(D_t\)</span>: an indicator for post-intervention (1 if <span class="math inline">\(t &gt;= T^*\)</span>, else 0)</p></li>
<li><p><span class="math inline">\(P_t\)</span>: time since intervention (0 before <span class="math inline">\(T^*\)</span>, increments after)</p></li>
</ul>
<div class="sourceCode" id="cb742"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_its</span><span class="op">$</span><span class="va">D</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="va">time</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>  <span class="op">&lt;-</span> <span class="va">df_its</span><span class="op">$</span><span class="va">time</span></span>
<span><span class="va">df_its</span><span class="op">$</span><span class="va">P</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="va">time</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">time</span> <span class="op">-</span> <span class="va">T_star</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 3. Plot the Entire Dataset &amp; Highlight the Intervention</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span></span>
<span>    <span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>,</span>
<span>    <span class="va">df_its</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>    pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Time (T)"</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">"Outcome (Y)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"Full Series with Intervention at T_star"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">T_star</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># vertical line for the intervention</span></span></code></pre></div>
<div class="inline-figure"><img src="28-interrupted-time-series_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Model: <span class="math display">\[Y_t = \beta_0 + \beta_1*T + \beta_2*D + \beta_3*(T*D) + \beta_4*P + \epsilon_t\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: baseline level</p></li>
<li><p><span class="math inline">\(\beta_1\)</span>: pre-intervention slope</p></li>
<li><p><span class="math inline">\(\beta_2\)</span>: immediate jump at T_star</p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: change in slope post-intervention</p></li>
<li><p><span class="math inline">\(\beta_4\)</span>: sustained effect over time since intervention</p></li>
<li><p><span class="math inline">\(\epsilon_t\)</span>: error term</p></li>
</ul>
<div class="sourceCode" id="cb743"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 4. Fit the Comprehensive ITS Model (Segmented Regression)</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">mod_its</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="cn">T</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="cn">T</span><span class="op">*</span><span class="va">D</span><span class="op">)</span> <span class="op">+</span> <span class="va">P</span>, data <span class="op">=</span> <span class="va">df_its</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use robust standard errors to account for potential autocorrelation</span></span>
<span><span class="va">res_its</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_its</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_its</span>, type<span class="op">=</span><span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 5. Create Fitted Values for Plotting</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">df_its</span><span class="op">$</span><span class="va">pred_its</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_its</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 6. Plot the Observed Data &amp; Fitted ITS Lines</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">Y</span>, pch<span class="op">=</span><span class="fl">16</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time (T)"</span>, ylab<span class="op">=</span><span class="st">"Outcome (Y)"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"ITS: Observed vs. Fitted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">T_star</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">pred_its</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="28-interrupted-time-series_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb744"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 7. Summaries &amp; Brief Interpretation</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_its</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   5.42261    2.06039  2.6318   0.01152 *  </span></span>
<span><span class="co">#&gt; T             0.78737    0.16204  4.8589 1.409e-05 ***</span></span>
<span><span class="co">#&gt; D           -28.27162    3.95530 -7.1478 5.472e-09 ***</span></span>
<span><span class="co">#&gt; I(T * D)      1.25703    0.18351  6.8498 1.531e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<ul>
<li>(Intercept) = <span class="math inline">\(\beta_0\)</span>: Baseline level at <span class="math inline">\(T=0\)</span>.</li>
<li>T = <span class="math inline">\(\beta_1\)</span>: Baseline slope (pre-intervention trend).</li>
<li>D = <span class="math inline">\(\beta_2\)</span>: Immediate jump (level change) at T_star.</li>
<li>T:D = <span class="math inline">\(\beta_3\)</span>: Slope change post-intervention.</li>
<li>P = <span class="math inline">\(\beta_4\)</span>: Sustained (additional) effect over time since <span class="math inline">\(T^*\)</span>.</li>
</ul>
<p>We compare the observed data with a <strong>counterfactual</strong> (assuming no treatment) <span class="citation">(<a href="references.html#ref-lee2014graphical">Lee Rodgers, Beasley, and Schuelke 2014</a>)</span>.</p>
<div class="sourceCode" id="cb745"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">Y</span>, pch<span class="op">=</span><span class="fl">16</span>, col<span class="op">=</span><span class="st">"gray"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Time (T)"</span>, ylab<span class="op">=</span><span class="st">"Outcome (Y)"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"ITS: Observed vs. Fitted vs. Counterfactual"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add vertical line indicating intervention point</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">T_star</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add fitted ITS model trend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">pred_its</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add counterfactual trend (what would have happened without intervention)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df_its</span><span class="op">$</span><span class="cn">T</span>, <span class="va">df_its</span><span class="op">$</span><span class="va">pred_counterfactual</span>, lwd<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Observed Data"</span>, <span class="st">"Fitted ITS"</span>, <span class="st">"Counterfactual"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="28-interrupted-time-series_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Notes on Real-World Usage:</p>
<ul>
<li><p>Consider checking for seasonality more explicitly (e.g., Fourier terms), or other covariates that might confound the outcome.</p></li>
<li><p>Assess autocorrelation further (e.g., Durbin-Watson test, Box-Jenkins approach).</p></li>
<li><p>In practice, also run diagnostics or conduct robustness checks, e.g., removing overlapping interventions or investigating delayed effects.</p></li>
</ul>
</div>
</div>
<div id="combining-both-rdit-and-its" class="section level2" number="28.3">
<h2>
<span class="header-section-number">28.3</span> Combining both RDiT and ITS<a class="anchor" aria-label="anchor" href="#combining-both-rdit-and-its"><i class="fas fa-link"></i></a>
</h2>
<p>Combining <a href="temporal-discontinuity-designs.html#sec-regression-discontinuity-in-time">Regression Discontinuity in Time</a> and <a href="temporal-discontinuity-designs.html#sec-interrupted-time-series">Interrupted Time Series</a> in a single regression framework is not standard, but hybrid or augmented approaches can capture both:</p>
<ol style="list-style-type: decimal">
<li>A <strong>sharp local discontinuity</strong> at the cutoff (<span class="math inline">\(T^*\)</span>).</li>
<li>
<strong>Longer-term trend changes</strong> before and after the intervention.</li>
</ol>
<p>Below are some conceptual strategies for merging RDiT and ITS ideas.</p>
<hr>
<div id="augment-an-its-model-with-a-local-discontinuity-term" class="section level3" number="28.3.1">
<h3>
<span class="header-section-number">28.3.1</span> Augment an ITS Model with a Local Discontinuity Term<a class="anchor" aria-label="anchor" href="#augment-an-its-model-with-a-local-discontinuity-term"><i class="fas fa-link"></i></a>
</h3>
<p>A more <strong>comprehensive ITS</strong> can be written using the following form:</p>
<p><span class="math display">\[
Y_t = \beta_0 + \beta_1 T_t + \beta_2 D_t + \beta_3 \bigl(T_t \times D_t\bigr) + \beta_4 P_t + \epsilon_t,
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(T_t\)</span> is the continuous time index
<ul>
<li>
<span class="math inline">\(\beta_1\)</span> is the baseline slope (pre-intervention).</li>
</ul>
</li>
<li>
<span class="math inline">\(D_t = 1\)</span> if <span class="math inline">\(t \geq T^*\)</span> (0 otherwise)
<ul>
<li>
<span class="math inline">\(\beta_2\)</span> is the immediate jump (level change) at <span class="math inline">\(T^*\)</span>.</li>
</ul>
</li>
<li>
<span class="math inline">\(\bigl(T_t \times D_t\bigr)\)</span> is the interaction term that allows the slope to differ after <span class="math inline">\(T^*\)</span>
<ul>
<li>
<span class="math inline">\(\beta_3\)</span> is the difference in slope post-<span class="math inline">\(T^*\)</span>.</li>
</ul>
</li>
<li>
<span class="math inline">\(P_t\)</span> is the time elapsed since <span class="math inline">\(T^*\)</span> (0 before <span class="math inline">\(T^*\)</span>)
<ul>
<li>
<span class="math inline">\(\beta_4\)</span> captures the sustained effect of the intervention.</li>
</ul>
</li>
<li>
<span class="math inline">\(\epsilon_t\)</span> is the error term.</li>
</ul>
<p>To embed an RDiT-style local discontinuity, define a bandwidth <span class="math inline">\(h\)</span> around <span class="math inline">\(T^*\)</span> and add local polynomial terms (e.g., linear) inside that window:</p>
<p><span class="math display">\[
\begin{aligned}
Y_t =\;&amp; \beta_0
       + \beta_1 T_t
       + \beta_2 D_t
       + \beta_3 \bigl(T_t \times D_t\bigr)
       + \beta_4 P_t \\
     &amp;\quad + \alpha_1 \bigl(T_t - T^*\bigr)\mathbf{1}\bigl(\lvert T_t - T^* \rvert &lt; h\bigr)
       + \alpha_2 \bigl(T_t - T^*\bigr) D_t \,\mathbf{1}\bigl(\lvert T_t - T^* \rvert &lt; h\bigr)
       + \epsilon_t.
\end{aligned}
\]</span></p>
<ul>
<li>
<span class="math inline">\(\mathbf{1}(\cdot)\)</span> is an indicator function that is 1 if the time index is within <span class="math inline">\(h\)</span> of <span class="math inline">\(T^*\)</span> (and 0 otherwise).</li>
<li>The <span class="math inline">\(\beta\)</span> terms capture the <strong>global</strong> pre/post trends, level changes, and sustained effects.</li>
<li>The <span class="math inline">\(\alpha\)</span> terms capture <strong>local curvature</strong> or a sharper jump within the <span class="math inline">\(\pm h\)</span> region of <span class="math inline">\(T^*\)</span>.</li>
</ul>
<p>This approach leverages the entire time series for <strong>trend estimation</strong> (ITS), while also including local (RDiT-like) estimation of an immediate discontinuity around <span class="math inline">\(T^*\)</span>.</p>
<p><strong>Cautions</strong>:</p>
<ul>
<li>You need sufficient data <strong>globally</strong> (for the ITS) and <strong>locally</strong> near <span class="math inline">\(T^*\)</span> (for the RDiT terms).</li>
<li>Extra parameters can lead to complexity and potential overfitting.</li>
</ul>
<hr>
</div>
<div id="two-stage-or-multi-stage-modeling" class="section level3" number="28.3.2">
<h3>
<span class="header-section-number">28.3.2</span> Two-Stage (or Multi-Stage) Modeling<a class="anchor" aria-label="anchor" href="#two-stage-or-multi-stage-modeling"><i class="fas fa-link"></i></a>
</h3>
<p>An ad hoc but sometimes practical workflow is:</p>
<p><strong>Stage 1</strong>: <strong>Local RDiT</strong></p>
<ul>
<li>Focus on a chosen bandwidth around <span class="math inline">\(T^*\)</span>.</li>
<li>Fit a local polynomial to capture the immediate jump at <span class="math inline">\(T^*\)</span>.</li>
<li>Estimate <span class="math inline">\(\hat{\tau}\)</span> as the jump.</li>
</ul>
<p><strong>Stage 2</strong>: <strong>ITS on the Full Series</strong></p>
<ul>
<li>Use the entire time series in a <strong>segmented (interrupted) regression</strong> framework.</li>
<li>Incorporate <span class="math inline">\(\hat{\tau}\)</span> explicitly as a known offset or treat it as a prior estimate for the jump.</li>
</ul>
<p>In practice, you could adjust the outcome by the estimated jump:</p>
<p><span class="math display">\[
Y_t^* = Y_t - \hat{\tau}\,D_t,
\]</span></p>
<p>and then fit the augmented model:</p>
<p><span class="math display">\[
Y_t^* = \beta_0 + \beta_1 T_t + \beta_2 D_t + \beta_3 \bigl(T_t \times D_t\bigr) + \beta_4 P_t + \nu_t.
\]</span></p>
<p>Here, <span class="math inline">\(Y_t^*\)</span> is the outcome after removing the locally estimated jump from Stage 1. This is not a single unified regression, but a two-step approach combining local (RDiT) and global (ITS) analyses.</p>
<hr>
</div>
<div id="hierarchical-or-multi-level-modeling" class="section level3" number="28.3.3">
<h3>
<span class="header-section-number">28.3.3</span> Hierarchical or Multi-Level Modeling<a class="anchor" aria-label="anchor" href="#hierarchical-or-multi-level-modeling"><i class="fas fa-link"></i></a>
</h3>
<p>A more unified, Bayesian hierarchical approach can also combine RDiT and ITS:</p>
<p><span class="math display">\[
\begin{aligned}
Y_{t} &amp;= \underbrace{\beta_0
           + \beta_1 T_t
           + \beta_2 D_t
           + \beta_3 \bigl(T_t \times D_t\bigr)
           + \beta_4 P_t}_{\text{Global ITS component}}
           \\
       &amp;\quad\;+\;
       \underbrace{\alpha_1 \bigl(T_t - T^*\bigr)\mathbf{1}\bigl(\lvert T_t - T^* \rvert &lt; h\bigr)
           + \alpha_2 \bigl(T_t - T^*\bigr) D_t\,\mathbf{1}\bigl(\lvert T_t - T^* \rvert &lt; h\bigr)}_{\text{Local RDiT component}}
           \;+\; \epsilon_t.
\end{aligned}
\]</span></p>
<ul>
<li>
<strong>Global ITS component</strong> captures overall level shifts, slope changes, and sustained effects.</li>
<li>
<strong>Local RDiT component</strong> captures a sharp jump or local polynomial shape around <span class="math inline">\(T^*\)</span>.</li>
<li>Additional hierarchical layers (e.g., group-level effects) can handle multiple groups or multiple cutoffs.</li>
</ul>
<p>Using one of these strategies ensures you capture both the <strong>global</strong> pre/post-intervention trends (ITS) and any <strong>local</strong> discontinuities near <span class="math inline">\(T^*\)</span> (RDiT).</p>
</div>
<div id="empirical-example-2" class="section level3" number="28.3.4">
<h3>
<span class="header-section-number">28.3.4</span> Empirical Example<a class="anchor" aria-label="anchor" href="#empirical-example-2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Generating synthetic data with a global ITS pattern (immediate jump, slope change, and sustained effect) plus a localized “extra” jump around <span class="math inline">\(T^* \pm h\)</span> (RDiT-style).</li>
<li>Fitting a single unified model that includes:
<ul>
<li>Global ITS terms (beta coefficients)</li>
<li>Local RDiT terms (alpha coefficients) within a bandwidth h</li>
</ul>
</li>
<li>Showing a two-stage approach where we first estimate a local jump and then adjust the outcome.</li>
<li>Visualizing the results.</li>
</ol>
<div class="sourceCode" id="cb746"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 0. Libraries</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://sandwich.R-Forge.R-project.org/">"sandwich"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"sandwich"</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span><span class="op">)</span>   <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"lmtest"</span>,   quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sandwich.R-Forge.R-project.org/">sandwich</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 1. Generate Synthetic Data</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span>
<span><span class="va">n</span>       <span class="op">&lt;-</span> <span class="fl">150</span>             <span class="co"># total number of time points</span></span>
<span><span class="va">T_star</span>  <span class="op">&lt;-</span> <span class="fl">80</span>              <span class="co"># cutoff/intervention time</span></span>
<span><span class="va">t_vals</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>      <span class="co"># time index: 1, 2, ..., n</span></span></code></pre></div>
<p>We’ll create a dataset that has:</p>
<ul>
<li><p>Baseline slope (pre-intervention)</p></li>
<li><p>Immediate jump at <span class="math inline">\(T^*\)</span></p></li>
<li><p>Post-intervention slope change (ITS style)</p></li>
<li><p>Sustained effect</p></li>
<li><p>PLUS a local polynomial “extra jump” around <span class="math inline">\(T^* \pm h=5\)</span> (RDiT style)</p></li>
</ul>
<div class="sourceCode" id="cb747"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">5</span>  <span class="co"># bandwidth for local discontinuity</span></span>
<span><span class="va">within_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">h</span>  <span class="co"># indicator for local region</span></span></code></pre></div>
<p>Create outcome <span class="math inline">\(Y\)</span> with:</p>
<ul>
<li><p>baseline slope: <span class="math inline">\(0.3 * t\)</span></p></li>
<li><p>immediate jump at <span class="math inline">\(T^*\)</span>: +5</p></li>
<li><p>slope change after <span class="math inline">\(T^*\)</span>: +0.2 per unit time (beyond the baseline)</p></li>
<li><p>sustained effect: <span class="math inline">\(0.1*( \text{time since } T^* )\)</span></p></li>
<li><p>local polynomial “extra jump” in the region <span class="math inline">\([T^* \pm h]\)</span>: <span class="math inline">\((t - T^*) * 2\)</span> only active within <span class="math inline">\(\pm h\)</span> of <span class="math inline">\(T^*\)</span></p></li>
<li><p>random noise</p></li>
</ul>
<div class="sourceCode" id="cb748"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">t_vals</span> <span class="op">+</span>                                        <span class="co"># baseline slope</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>                      <span class="co"># immediate jump</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">0.2</span><span class="op">*</span><span class="op">(</span><span class="va">t_vals</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># slope change</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">t_vals</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">0.1</span><span class="op">*</span><span class="op">(</span><span class="va">t_vals</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># sustained effect</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">within_h</span>, <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">t_vals</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>            <span class="co"># local polynomial jump</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd<span class="op">=</span><span class="fl">2</span><span class="op">)</span>                                        <span class="co"># noise</span></span>
<span></span>
<span><span class="co"># Put it in a data frame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">t_vals</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 2. Define Variables for a Single Unified Model</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">D</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>          <span class="co"># intervention dummy</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">T_c</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">t</span>                                 <span class="co"># rename time to T_c for clarity</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">P</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">&gt;=</span> <span class="va">T_star</span>, <span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># time since intervention</span></span>
<span></span>
<span><span class="co"># Indicator for local region (± h around T_star)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">local_indicator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">h</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Center time around T_star for local polynomial</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">t_centered</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 3. Fit the Unified "Augmented ITS + RDiT" Model</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># Y_t = beta_0</span></span>
<span><span class="co">#       + beta_1 * T_c</span></span>
<span><span class="co">#       + beta_2 * D</span></span>
<span><span class="co">#       + beta_3 * (T_c * D)</span></span>
<span><span class="co">#       + beta_4 * P</span></span>
<span><span class="co">#       + alpha_1 * (t_centered)* local_indicator</span></span>
<span><span class="co">#       + alpha_2 * (t_centered)* D * local_indicator</span></span>
<span><span class="co">#       + epsilon_t</span></span>
<span><span class="co">#</span></span>
<span><span class="va">mod_hybrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">T_c</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">T_c</span><span class="op">*</span><span class="va">D</span><span class="op">)</span> <span class="op">+</span> <span class="va">P</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">t_centered</span> <span class="op">*</span> <span class="va">local_indicator</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">t_centered</span> <span class="op">*</span> <span class="va">D</span> <span class="op">*</span> <span class="va">local_indicator</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Robust standard errors</span></span>
<span><span class="va">res_hybrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_hybrid</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_hybrid</span>, type <span class="op">=</span> <span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 4. A Two-Stage Approach for Illustrative Purposes</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># STAGE 1: Local RDiT to estimate extra local jump around T_star ± h</span></span>
<span><span class="va">df_local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">T_star</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">h</span><span class="op">)</span></span>
<span><span class="va">mod_local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">t_centered</span><span class="op">*</span><span class="va">D</span>, data <span class="op">=</span> <span class="va">df_local</span><span class="op">)</span></span>
<span><span class="va">tau_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod_local</span><span class="op">)</span><span class="op">[</span><span class="st">"D"</span><span class="op">]</span>  <span class="co"># estimate of the jump at T_star from local model</span></span>
<span></span>
<span><span class="co"># Adjust outcome by subtracting local jump * D</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Y_star</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span> <span class="op">-</span> <span class="va">tau_hat</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">D</span></span>
<span></span>
<span><span class="co"># STAGE 2: Fit a standard ITS on the adjusted outcome Y_star</span></span>
<span><span class="va">mod_its_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y_star</span> <span class="op">~</span> <span class="va">T_c</span> <span class="op">+</span> <span class="va">D</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">T_c</span><span class="op">*</span><span class="va">D</span><span class="op">)</span> <span class="op">+</span> <span class="va">P</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">res_its_adjusted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">mod_its_adjusted</span>, vcov <span class="op">=</span> <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">mod_its_adjusted</span>, type <span class="op">=</span> <span class="st">"HC1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="co"># 5. Plot the Data and Fitted Lines</span></span>
<span><span class="co"># -------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 1: Observed data vs. fitted "Hybrid Model"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">t</span>,</span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time (t)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Outcome (Y)"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Hybrid RDiT+ITS Model"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">T_star</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># cutoff</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_hybrid</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>      lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot 2: Adjusted Data (Two-Stage) vs. Fitted ITS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">t</span>,</span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">Y_star</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Time (t)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Outcome (Y*)"</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Two-Stage Approach: Adjusted Y*"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">T_star</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_its_adjusted</span><span class="op">)</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>      lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="28-interrupted-time-series_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb749"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_hybrid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                       Estimate Std. Error  t value  Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)                          -1.066743   0.453019  -2.3547   0.01989</span></span>
<span><span class="co">#&gt; T_c                                   0.328522   0.009090  36.1409 &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; D                                   -19.072974   1.557761 -12.2438 &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; I(T_c * D)                            0.282215   0.015636  18.0488 &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; I(t_centered * local_indicator)       2.197553   0.323646   6.7900 2.726e-10</span></span>
<span><span class="co">#&gt; I(t_centered * D * local_indicator)  -0.317783   0.399128  -0.7962   0.42723</span></span>
<span><span class="co">#&gt;                                        </span></span>
<span><span class="co">#&gt; (Intercept)                         *  </span></span>
<span><span class="co">#&gt; T_c                                 ***</span></span>
<span><span class="co">#&gt; D                                   ***</span></span>
<span><span class="co">#&gt; I(T_c * D)                          ***</span></span>
<span><span class="co">#&gt; I(t_centered * local_indicator)     ***</span></span>
<span><span class="co">#&gt; I(t_centered * D * local_indicator)    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\n Two-Stage Approach:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Two-Stage Approach:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"   (1) Local RDiT =&gt; estimated local jump = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tau_hat</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    (1) Local RDiT =&gt; estimated local jump =  3.27</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"   (2) Standard ITS on adjusted outcome:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    (2) Standard ITS on adjusted outcome:</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">res_its_adjusted</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; t test of coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               Estimate Std. Error  t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  -0.553196   0.507846  -1.0893   0.2778    </span></span>
<span><span class="co">#&gt; T_c           0.308729   0.012701  24.3075   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; D           -20.268345   1.889371 -10.7276   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; I(T_c * D)    0.281836   0.019730  14.2844   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<ul>
<li>Beta terms (<span class="math inline">\(T_c, D, T_c:D, P\)</span>) capture the global ITS components:
<ul>
<li>Baseline slope (<span class="math inline">\(\beta_1\)</span>)</li>
<li>Immediate jump (<span class="math inline">\(\beta_2\)</span>)</li>
<li>Post-intervention slope change (<span class="math inline">\(\beta_3\)</span>)</li>
<li>Sustained effect (<span class="math inline">\(\beta_4\)</span>)</li>
</ul>
</li>
<li>Alpha terms (t_centered * local_indicator, etc.) capture a local RDiT effect.</li>
<li>In the two-stage approach, <span class="math inline">\(\hat{\tau}\)</span> is the local jump. Subtracting it (Stage 1) yields a ‘cleaned’ <span class="math inline">\(Y^*\)</span>, and we then fit a simpler ITS (Stage 2).</li>
</ul>
<hr>
</div>
<div id="practical-guidance" class="section level3" number="28.3.5">
<h3>
<span class="header-section-number">28.3.5</span> Practical Guidance<a class="anchor" aria-label="anchor" href="#practical-guidance"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>Data Requirements</strong>: You must have enough data in the local window around <span class="math inline">\(T^*\)</span> for RDiT and enough pre- and post-intervention observations for ITS.</li>
<li>
<strong>Avoid Over-Parameterization</strong>: Adding many interaction and polynomial terms can quickly increase complexity.</li>
<li>
<strong>Interpretation</strong>: A single unified model that merges local jumps with global trends may be difficult to interpret. Distinguish clearly which parameters capture the sharp discontinuity versus the long-run trend.</li>
</ul>
<p>In practice, a hybrid approach can work if you truly believe there is both a local immediate jump and a longer-run trend change that standard ITS alone may not fully capture. However, weigh the added complexity against the quality and richness of your data.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></div>
<div class="next"><a href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#temporal-discontinuity-designs"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li>
<a class="nav-link" href="#sec-regression-discontinuity-in-time"><span class="header-section-number">28.1</span> Regression Discontinuity in Time</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimation-and-model-selection"><span class="header-section-number">28.1.1</span> Estimation and Model Selection</a></li>
<li><a class="nav-link" href="#strengths-of-rdit"><span class="header-section-number">28.1.2</span> Strengths of RDiT</a></li>
<li><a class="nav-link" href="#limitations-and-challenges-of-rdit"><span class="header-section-number">28.1.3</span> Limitations and Challenges of RDiT</a></li>
<li><a class="nav-link" href="#recommendations-for-robustness-checks"><span class="header-section-number">28.1.4</span> Recommendations for Robustness Checks</a></li>
<li><a class="nav-link" href="#applications-of-rdit"><span class="header-section-number">28.1.5</span> Applications of RDiT</a></li>
<li><a class="nav-link" href="#empirical-example"><span class="header-section-number">28.1.6</span> Empirical Example</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-interrupted-time-series"><span class="header-section-number">28.2</span> Interrupted Time Series</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#advantages-of-its"><span class="header-section-number">28.2.1</span> Advantages of ITS</a></li>
<li><a class="nav-link" href="#limitations-of-its"><span class="header-section-number">28.2.2</span> Limitations of ITS</a></li>
<li><a class="nav-link" href="#empirical-example-1"><span class="header-section-number">28.2.3</span> Empirical Example</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#combining-both-rdit-and-its"><span class="header-section-number">28.3</span> Combining both RDiT and ITS</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#augment-an-its-model-with-a-local-discontinuity-term"><span class="header-section-number">28.3.1</span> Augment an ITS Model with a Local Discontinuity Term</a></li>
<li><a class="nav-link" href="#two-stage-or-multi-stage-modeling"><span class="header-section-number">28.3.2</span> Two-Stage (or Multi-Stage) Modeling</a></li>
<li><a class="nav-link" href="#hierarchical-or-multi-level-modeling"><span class="header-section-number">28.3.3</span> Hierarchical or Multi-Level Modeling</a></li>
<li><a class="nav-link" href="#empirical-example-2"><span class="header-section-number">28.3.4</span> Empirical Example</a></li>
<li><a class="nav-link" href="#practical-guidance"><span class="header-section-number">28.3.5</span> Practical Guidance</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/28-interrupted-time-series.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/28-interrupted-time-series.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-03-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
