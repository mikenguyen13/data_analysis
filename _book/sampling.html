<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 23 Sampling | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="Sampling allows us to draw conclusions about a population without analyzing every individual in it. In business applications—such as marketing research, and financial forecasting—sampling enables...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 23 Sampling | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/sampling.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="Sampling allows us to draw conclusions about a population without analyzing every individual in it. In business applications—such as marketing research, and financial forecasting—sampling enables...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 23 Sampling | A Guide on Data Analysis">
<meta name="twitter:description" content="Sampling allows us to draw conclusions about a population without analyzing every individual in it. In business applications—such as marketing research, and financial forecasting—sampling enables...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="active" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">38</span> Controls</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">39</span> Directed Acyclic Graph</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="sampling" class="section level1" number="23">
<h1>
<span class="header-section-number">23</span> Sampling<a class="anchor" aria-label="anchor" href="#sampling"><i class="fas fa-link"></i></a>
</h1>
<p>Sampling allows us to draw conclusions about a population without analyzing every individual in it. In business applications—such as marketing research, and financial forecasting—sampling enables efficient decision-making while reducing costs and effort.</p>
<hr>
<div id="population-and-sample" class="section level2" number="23.1">
<h2>
<span class="header-section-number">23.1</span> Population and Sample<a class="anchor" aria-label="anchor" href="#population-and-sample"><i class="fas fa-link"></i></a>
</h2>
<p>This is a refresher on terminology regarding sampling.</p>
<ul>
<li>
<strong>Population</strong> (<span class="math inline">\(N\)</span>): The complete set of all elements under study.</li>
<li>
<strong>Sample</strong> (<span class="math inline">\(n\)</span>): A subset of the population selected for analysis.</li>
<li>
<strong>Parameter</strong>: A numerical measure that describes a characteristic of a population (e.g., population mean <span class="math inline">\(\mu\)</span>, population variance <span class="math inline">\(\sigma^2\)</span>).</li>
<li>
<strong>Statistic</strong>: A numerical measure computed from a sample, used to estimate a population parameter (e.g., sample mean <span class="math inline">\(\bar{x}\)</span>, sample variance <span class="math inline">\(s^2\)</span>).</li>
</ul>
<p>A well-chosen sample ensures that results generalize to the population, reducing <strong>sampling bias</strong>.</p>
<hr>
</div>
<div id="probability-sampling" class="section level2" number="23.2">
<h2>
<span class="header-section-number">23.2</span> Probability Sampling<a class="anchor" aria-label="anchor" href="#probability-sampling"><i class="fas fa-link"></i></a>
</h2>
<p>Probability sampling methods ensure that every element in the population has a known, nonzero probability of being selected. These methods are preferred in inferential statistics since they allow for the estimation of sampling error.</p>
<div id="sec-simple-random-sampling" class="section level3" number="23.2.1">
<h3>
<span class="header-section-number">23.2.1</span> Simple Random Sampling<a class="anchor" aria-label="anchor" href="#sec-simple-random-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Simple Random Sampling (SRS) ensures that every element in the population has an <strong>equal chance</strong> of being selected. This can be done <strong>with replacement</strong> or <strong>without replacement</strong>, impacting whether an element can be chosen more than once.</p>
<p>Below is an example of drawing a simple random sample without replacement from a population of 100 elements:</p>
<div class="sourceCode" id="cb674"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>  <span class="co"># A population of 100 elements</span></span>
<span><span class="va">sample_srs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">population</span>, size <span class="op">=</span> <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">sample_srs</span></span>
<span><span class="co">#&gt;  [1] 31 79 51 14 67 42 50 43 97 25</span></span></code></pre></div>
<p><strong>Advantages:</strong></p>
<ul>
<li><p>Simple and easy to implement</p></li>
<li><p>Ensures unbiased selection</p></li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><p>May not represent subgroups well, especially in heterogeneous populations</p></li>
<li><p>Requires access to a complete list of the population</p></li>
</ul>
<div id="using-dplyr" class="section level4" number="23.2.1.1">
<h4>
<span class="header-section-number">23.2.1.1</span> Using <code>dplyr</code><a class="anchor" aria-label="anchor" href="#using-dplyr"><i class="fas fa-link"></i></a>
</h4>
<p>The <code><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n()</a></code> function in <code>dplyr</code> allows for simple random sampling from a dataset:</p>
<div class="sourceCode" id="cb675"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">iris_df</span> <span class="op">&lt;-</span> <span class="va">iris</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="va">iris_df</span>, <span class="fl">5</span><span class="op">)</span>  <span class="co"># Randomly selects 5 rows from the iris dataset</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</span></span>
<span><span class="co">#&gt; 1          5.8         2.7          4.1         1.0 versicolor</span></span>
<span><span class="co">#&gt; 2          6.4         2.8          5.6         2.1  virginica</span></span>
<span><span class="co">#&gt; 3          4.4         3.2          1.3         0.2     setosa</span></span>
<span><span class="co">#&gt; 4          4.3         3.0          1.1         0.1     setosa</span></span>
<span><span class="co">#&gt; 5          7.0         3.2          4.7         1.4 versicolor</span></span></code></pre></div>
</div>
<div id="using-the-sampling-package" class="section level4" number="23.2.1.2">
<h4>
<span class="header-section-number">23.2.1.2</span> Using the <code>sampling</code> Package<a class="anchor" aria-label="anchor" href="#using-the-sampling-package"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>sampling</code> package provides functions for random sampling <strong>with</strong> and <strong>without</strong> replacement.</p>
<div class="sourceCode" id="cb676"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sampling</span><span class="op">)</span></span>
<span><span class="co"># Assign a unique ID to each row in the dataset</span></span>
<span><span class="va">iris_df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simple random sampling without replacement</span></span>
<span><span class="va">srs_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampling/man/srswor.html">srswor</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iris_df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="co"># srs_sample</span></span>
<span></span>
<span><span class="co"># Simple random sampling with replacement</span></span>
<span><span class="va">srs_sample_wr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampling/man/srswr.html">srswr</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iris_df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># srs_sample_wr</span></span></code></pre></div>
</div>
<div id="using-the-sampler-package" class="section level4" number="23.2.1.3">
<h4>
<span class="header-section-number">23.2.1.3</span> Using the <code>sampler</code> Package<a class="anchor" aria-label="anchor" href="#using-the-sampler-package"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>sampler</code> package provides additional functionality, such as <strong>oversampling</strong> to account for non-response.</p>
<div class="sourceCode" id="cb677"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mbaldassaro/sampler">sampler</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rsamp.html">rsamp</a></span><span class="op">(</span><span class="va">albania</span>, n <span class="op">=</span> <span class="fl">260</span>, over <span class="op">=</span> <span class="fl">0.1</span>, rep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="handling-missing-data-in-sample-collection" class="section level4" number="23.2.1.4">
<h4>
<span class="header-section-number">23.2.1.4</span> Handling Missing Data in Sample Collection<a class="anchor" aria-label="anchor" href="#handling-missing-data-in-sample-collection"><i class="fas fa-link"></i></a>
</h4>
<p>To compare a sample with received (collected) data and identify missing elements:</p>
<div class="sourceCode" id="cb678"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alsample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rsamp.html">rsamp</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">albania</span>, <span class="fl">544</span><span class="op">)</span>  <span class="co"># Initial sample</span></span>
<span><span class="va">alreceived</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rsamp.html">rsamp</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">alsample</span>, <span class="fl">390</span><span class="op">)</span>  <span class="co"># Collected data</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rmissing.html">rmissing</a></span><span class="op">(</span>sampdf <span class="op">=</span> <span class="va">alsample</span>, colldf <span class="op">=</span> <span class="va">alreceived</span>, col_name <span class="op">=</span> <span class="va">qvKod</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="sec-stratified-sampling" class="section level3" number="23.2.2">
<h3>
<span class="header-section-number">23.2.2</span> Stratified Sampling<a class="anchor" aria-label="anchor" href="#sec-stratified-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Stratified sampling involves dividing the population into distinct <strong>strata</strong> based on a characteristic (e.g., age, income level, region). A <strong>random sample</strong> is then drawn from each stratum, often in proportion to its size within the population. This method ensures that all subgroups are adequately represented, improving the precision of estimates.</p>
<hr>
<p>The following example demonstrates stratified sampling where individuals belong to three different groups <strong>(A, B, C)</strong>, and a random sample is drawn from each.</p>
<div class="sourceCode" id="cb679"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stratified random sampling: selecting 10 elements per group</span></span>
<span><span class="va">stratified_sample</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stratified_sample</span></span></code></pre></div>
<p><strong>Advantages:</strong></p>
<ul>
<li><p>Ensures representation of all subgroups</p></li>
<li><p>More precise estimates compared to <a href="sampling.html#sec-simple-random-sampling">Simple Random Sampling</a></p></li>
<li><p>Reduces sampling error by accounting for population variability</p></li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><p>Requires prior knowledge of population strata</p></li>
<li><p>More complex to implement than <a href="sampling.html#sec-simple-random-sampling">SRS</a></p></li>
</ul>
<div id="using-dplyr-for-stratified-sampling" class="section level4" number="23.2.2.1">
<h4>
<span class="header-section-number">23.2.2.1</span> Using <code>dplyr</code> for Stratified Sampling<a class="anchor" aria-label="anchor" href="#using-dplyr-for-stratified-sampling"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Sampling by Fixed Number of Rows</strong></p>
<p>Here, we extract <strong>5 random observations</strong> from each species in the <code>iris</code> dataset.</p>
<div class="sourceCode" id="cb680"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>  <span class="co"># Selects 5 samples per species</span></span>
<span></span>
<span><span class="co"># sample_iris</span></span></code></pre></div>
<p><strong>Sampling by Fraction of Each Stratum</strong></p>
<p>Instead of selecting a fixed number, we can sample <strong>15% of each species</strong>:</p>
<div class="sourceCode" id="cb681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sample_iris</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_frac</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>  <span class="co"># Selects 15% of each species</span></span>
<span></span>
<span><span class="co"># sample_iris</span></span></code></pre></div>
</div>
<div id="using-the-sampler-package-1" class="section level4" number="23.2.2.2">
<h4>
<span class="header-section-number">23.2.2.2</span> Using the <code>sampler</code> Package<a class="anchor" aria-label="anchor" href="#using-the-sampler-package-1"><i class="fas fa-link"></i></a>
</h4>
<p>The <code>sampler</code> package allows stratified sampling with proportional allocation:</p>
<div class="sourceCode" id="cb682"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mbaldassaro/sampler">sampler</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stratified sample using proportional allocation without replacement</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampler/man/ssamp.html">ssamp</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">albania</span>, n <span class="op">=</span> <span class="fl">360</span>, strata <span class="op">=</span> <span class="va">qarku</span>, over <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="handling-missing-data-in-stratified-sampling" class="section level4" number="23.2.2.3">
<h4>
<span class="header-section-number">23.2.2.3</span> Handling Missing Data in Stratified Sampling<a class="anchor" aria-label="anchor" href="#handling-missing-data-in-stratified-sampling"><i class="fas fa-link"></i></a>
</h4>
<p>To identify the number of missing values <strong>by stratum</strong> between the initial sample and the collected data:</p>
<div class="sourceCode" id="cb683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alsample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rsamp.html">rsamp</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">albania</span>, <span class="fl">544</span><span class="op">)</span>  <span class="co"># Initial sample</span></span>
<span><span class="va">alreceived</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sampler/man/rsamp.html">rsamp</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">alsample</span>, <span class="fl">390</span><span class="op">)</span>  <span class="co"># Collected data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampler/man/smissing.html">smissing</a></span><span class="op">(</span></span>
<span>  sampdf <span class="op">=</span> <span class="va">alsample</span>,</span>
<span>  colldf <span class="op">=</span> <span class="va">alreceived</span>,</span>
<span>  strata <span class="op">=</span> <span class="va">qarku</span>,   <span class="co"># Strata column</span></span>
<span>  col_name <span class="op">=</span> <span class="va">qvKod</span>  <span class="co"># Column for checking missing values</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="systematic-sampling" class="section level3" number="23.2.3">
<h3>
<span class="header-section-number">23.2.3</span> Systematic Sampling<a class="anchor" aria-label="anchor" href="#systematic-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Selects every <span class="math inline">\(k\)</span>th element after a random starting point.</p>
<div class="sourceCode" id="cb684"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># Select every 10th element</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Random start point</span></span>
<span><span class="va">sample_systematic</span> <span class="op">&lt;-</span> <span class="va">population</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">start</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">k</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><strong>Advantages:</strong></p>
<ul>
<li><p>Simple to implement</p></li>
<li><p>Ensures even coverage</p></li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>If data follows a pattern, bias may be introduced</li>
</ul>
</div>
<div id="cluster-sampling" class="section level3" number="23.2.4">
<h3>
<span class="header-section-number">23.2.4</span> Cluster Sampling<a class="anchor" aria-label="anchor" href="#cluster-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Instead of selecting individuals, entire clusters (e.g., cities, schools) are randomly chosen, and all members of selected clusters are included.</p>
<div class="sourceCode" id="cb685"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">Cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># Assign 10 clusters</span></span>
<span><span class="va">chosen_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># Select 3 clusters</span></span>
<span><span class="va">cluster_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Cluster</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">chosen_clusters</span><span class="op">)</span></span></code></pre></div>
<p><strong>Advantages:</strong></p>
<ul>
<li><p>Cost-effective when the population is large</p></li>
<li><p>Useful when the population is naturally divided into groups</p></li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><p>Higher variability</p></li>
<li><p>Risk of unrepresentative clusters</p></li>
</ul>
</div>
</div>
<div id="non-probability-sampling" class="section level2" number="23.3">
<h2>
<span class="header-section-number">23.3</span> Non-Probability Sampling<a class="anchor" aria-label="anchor" href="#non-probability-sampling"><i class="fas fa-link"></i></a>
</h2>
<p>These methods do not give all elements a known probability of selection. They are used in exploratory research but are not suitable for making formal statistical inferences.</p>
<div id="convenience-sampling" class="section level3" number="23.3.1">
<h3>
<span class="header-section-number">23.3.1</span> Convenience Sampling<a class="anchor" aria-label="anchor" href="#convenience-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Selecting individuals who are easiest to reach (e.g., mall surveys).</p>
<p><strong>Pros:</strong> Quick and inexpensive<br><strong>Cons:</strong> High risk of bias, not generalizable</p>
</div>
<div id="quota-sampling" class="section level3" number="23.3.2">
<h3>
<span class="header-section-number">23.3.2</span> Quota Sampling<a class="anchor" aria-label="anchor" href="#quota-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Similar to stratified sampling but non-random.</p>
<p><strong>Pros:</strong> Ensures subgroup representation<br><strong>Cons:</strong> Subject to selection bias</p>
</div>
<div id="snowball-sampling" class="section level3" number="23.3.3">
<h3>
<span class="header-section-number">23.3.3</span> Snowball Sampling<a class="anchor" aria-label="anchor" href="#snowball-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Used for hard-to-reach populations (e.g., networking through referrals).</p>
<p><strong>Pros:</strong> Useful when the population is unknown<br><strong>Cons:</strong> High bias, dependency on initial subjects</p>
</div>
</div>
<div id="sec-unequal-probability-sampling" class="section level2" number="23.4">
<h2>
<span class="header-section-number">23.4</span> Unequal Probability Sampling<a class="anchor" aria-label="anchor" href="#sec-unequal-probability-sampling"><i class="fas fa-link"></i></a>
</h2>
<p>Unequal probability sampling assigns different selection probabilities to elements in the population. This approach is often used when certain units are more important, have higher variability, or require higher precision in estimation.</p>
<p>Common methods for unequal probability sampling include:</p>
<ul>
<li><p><strong>Probability Proportional to Size (PPS)</strong>: Selection probability is proportional to a given auxiliary variable (e.g., revenue, population size).</p></li>
<li><p><strong>Poisson Sampling</strong>: Independent selection of each unit with a given probability.</p></li>
<li><p><strong>Systematic Sampling with Unequal Probabilities</strong>: Uses a systematic approach while ensuring different probabilities.</p></li>
</ul>
<p>The following functions from the <code>sampling</code> package implement various unequal probability sampling methods:</p>
<div class="sourceCode" id="cb686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sampling</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Different methods for unequal probability sampling</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPbrewer.html">UPbrewer</a></span><span class="op">(</span><span class="op">)</span>         <span class="co"># Brewer's method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPmaxentropy.html">UPmaxentropy</a></span><span class="op">(</span><span class="op">)</span>     <span class="co"># Maximum entropy method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPmidzuno.html">UPmidzuno</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># Midzuno’s method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPmidzunopi2.html">UPmidzunopi2</a></span><span class="op">(</span><span class="op">)</span>     <span class="co"># Midzuno’s method with second-order inclusion probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPmultinomial.html">UPmultinomial</a></span><span class="op">(</span><span class="op">)</span>    <span class="co"># Multinomial method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPpivotal.html">UPpivotal</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># Pivotal method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPrandompivotal.html">UPrandompivotal</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Randomized pivotal method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPpoisson.html">UPpoisson</a></span><span class="op">(</span><span class="op">)</span>        <span class="co"># Poisson sampling</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPsampford.html">UPsampford</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># Sampford’s method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPsystematic.html">UPsystematic</a></span><span class="op">(</span><span class="op">)</span>     <span class="co"># Systematic sampling</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPrandomsystematic.html">UPrandomsystematic</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Randomized systematic sampling</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPsystematicpi2.html">UPsystematicpi2</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># Systematic sampling with second-order probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPtille.html">UPtille</a></span><span class="op">(</span><span class="op">)</span>          <span class="co"># Tillé’s method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/UPtillepi2.html">UPtillepi2</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># Tillé’s method with second-order inclusion probabilities</span></span></code></pre></div>
<p>Each of these methods has specific use cases and theoretical justifications. For example:</p>
<ul>
<li><p><strong>Poisson sampling</strong> allows flexible control over sample size but may lead to variable sample sizes.</p></li>
<li><p><strong>Systematic sampling</strong> is useful when population elements are arranged in a meaningful order.</p></li>
<li><p><strong>Tillé’s method</strong> ensures better control over the sample’s second-order inclusion probabilities.</p></li>
</ul>
</div>
<div id="sec-balanced-sampling" class="section level2" number="23.5">
<h2>
<span class="header-section-number">23.5</span> Balanced Sampling<a class="anchor" aria-label="anchor" href="#sec-balanced-sampling"><i class="fas fa-link"></i></a>
</h2>
<p>Balanced sampling ensures that the <strong>means of auxiliary variables</strong> in the sample match those in the population. This method improves estimation efficiency and reduces variability without introducing bias.</p>
<p>Balanced sampling <strong>differs from purposive selection</strong> because it still involves <strong>randomization</strong>, ensuring statistical validity.</p>
<p>The <strong>balancing equation</strong> is given by: <span class="math display">\[
\sum_{k \in S} \frac{\mathbf{x}_k}{\pi_k} = \sum_{k \in U} \mathbf{x}_k
\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(\mathbf{x}_k\)</span> is a vector of auxiliary variables (e.g., income, age, household size).</p></li>
<li><p><span class="math inline">\(\pi_k\)</span> is the inclusion probability of unit <span class="math inline">\(k\)</span>.</p></li>
<li><p><span class="math inline">\(S\)</span> is the sample, and <span class="math inline">\(U\)</span> is the population.</p></li>
</ul>
<p>This ensures that the total weighted sum of auxiliary variables in the sample matches the total sum in the population.</p>
<div id="cube-method-for-balanced-sampling" class="section level3" number="23.5.1">
<h3>
<span class="header-section-number">23.5.1</span> Cube Method for Balanced Sampling<a class="anchor" aria-label="anchor" href="#cube-method-for-balanced-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>The <strong>Cube Method</strong> is a widely used approach for balanced sampling, consisting of two phases:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Flight Phase</strong>: Ensures initial balance on auxiliary variables.</p></li>
<li><p><strong>Landing Phase</strong>: Adjusts the sample to meet constraints while keeping randomness.</p></li>
</ol>
<div class="sourceCode" id="cb687"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sampling</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cube method functions</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/samplecube.html">samplecube</a></span><span class="op">(</span><span class="op">)</span>       <span class="co"># Standard cube method</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/fastflightcube.html">fastflightcube</a></span><span class="op">(</span><span class="op">)</span>   <span class="co"># Optimized flight phase</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/landingcube.html">landingcube</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># Landing phase method</span></span></code></pre></div>
</div>
<div id="balanced-sampling-with-stratification" class="section level3" number="23.5.2">
<h3>
<span class="header-section-number">23.5.2</span> Balanced Sampling with Stratification<a class="anchor" aria-label="anchor" href="#balanced-sampling-with-stratification"><i class="fas fa-link"></i></a>
</h3>
<p>Stratification attempts to <strong>replicate the population structure</strong> in the sample by preserving the original <strong>multivariate histogram</strong>.</p>
<div class="sourceCode" id="cb688"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/">survey</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"api"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stratified design with proportional allocation</span></span>
<span><span class="va">srs_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">apistrat</span>,</span>
<span>                        weights <span class="op">=</span> <span class="op">~</span><span class="va">pw</span>, </span>
<span>                        fpc <span class="op">=</span> <span class="op">~</span><span class="va">fpc</span>, </span>
<span>                        strata <span class="op">=</span> <span class="op">~</span><span class="va">stype</span>,</span>
<span>                        id <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>An additional method for balanced stratification is:</p>
<div class="sourceCode" id="cb689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/balancedstratification.html">balancedstratification</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This method ensures that within each stratum, the sample retains the original proportions of auxiliary variables.</p>
</div>
<div id="balanced-sampling-in-cluster-sampling" class="section level3" number="23.5.3">
<h3>
<span class="header-section-number">23.5.3</span> Balanced Sampling in Cluster Sampling<a class="anchor" aria-label="anchor" href="#balanced-sampling-in-cluster-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Cluster sampling involves selecting <strong>entire groups (clusters)</strong> instead of individual units. A balanced approach ensures that the sampled clusters <strong>preserve the overall distribution of auxiliary variables</strong>.</p>
<div class="sourceCode" id="cb690"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/">survey</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"api"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cluster sampling design</span></span>
<span><span class="va">srs_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">apiclus1</span>,</span>
<span>                        weights <span class="op">=</span> <span class="op">~</span><span class="va">pw</span>, </span>
<span>                        fpc <span class="op">=</span> <span class="op">~</span><span class="va">fpc</span>, </span>
<span>                        id <span class="op">=</span> <span class="op">~</span><span class="va">dnum</span><span class="op">)</span></span></code></pre></div>
<p>For explicitly balanced cluster sampling:</p>
<div class="sourceCode" id="cb691"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/balancedcluster.html">balancedcluster</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This method ensures that the <strong>cluster-level characteristics</strong> of the sample match those of the population.</p>
</div>
<div id="balanced-sampling-in-two-stage-sampling" class="section level3" number="23.5.4">
<h3>
<span class="header-section-number">23.5.4</span> Balanced Sampling in Two-Stage Sampling<a class="anchor" aria-label="anchor" href="#balanced-sampling-in-two-stage-sampling"><i class="fas fa-link"></i></a>
</h3>
<p>Two-stage sampling first selects primary units (e.g., schools, cities) and then samples within them. A balanced approach ensures <strong>representative selection at both stages</strong>.</p>
<div class="sourceCode" id="cb692"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://r-survey.r-forge.r-project.org/survey/">survey</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"api"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Two-stage sampling design</span></span>
<span><span class="va">srs_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html">svydesign</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">apiclus2</span>, </span>
<span>                        fpc <span class="op">=</span> <span class="op">~</span><span class="va">fpc1</span> <span class="op">+</span> <span class="va">fpc2</span>, </span>
<span>                        id <span class="op">=</span> <span class="op">~</span><span class="va">dnum</span> <span class="op">+</span> <span class="va">snum</span><span class="op">)</span></span></code></pre></div>
<p>For explicitly balanced two-stage sampling:</p>
<div class="sourceCode" id="cb693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/sampling/man/balancedtwostage.html">balancedtwostage</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This method ensures that <strong>auxiliary variables remain balanced across both selection stages</strong>, reducing variability while maintaining randomness.</p>
</div>
</div>
<div id="sample-size-determination" class="section level2" number="23.6">
<h2>
<span class="header-section-number">23.6</span> Sample Size Determination<a class="anchor" aria-label="anchor" href="#sample-size-determination"><i class="fas fa-link"></i></a>
</h2>
<p>The appropriate sample size depends on the <strong>margin of error</strong>, <strong>confidence level</strong>, and <strong>population variability</strong>. A commonly used formula for estimating the required sample size for a proportion is:</p>
<p><span class="math display">\[
n = \frac{Z^2 p (1 - p)}{E^2}
\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(Z\)</span> is the Z-score corresponding to the confidence level</p></li>
<li><p><span class="math inline">\(p\)</span> is the estimated proportion</p></li>
<li><p><span class="math inline">\(E\)</span> is the margin of error</p></li>
</ul>
<div class="sourceCode" id="cb694"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span>  <span class="co"># 95% confidence level</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Estimated proportion</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># 5% margin of error</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">z</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">E</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Round up to nearest integer</span></span>
<span><span class="co">#&gt; [1] 385</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></div>
<div class="next"><a href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sampling"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="nav-link" href="#population-and-sample"><span class="header-section-number">23.1</span> Population and Sample</a></li>
<li>
<a class="nav-link" href="#probability-sampling"><span class="header-section-number">23.2</span> Probability Sampling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-simple-random-sampling"><span class="header-section-number">23.2.1</span> Simple Random Sampling</a></li>
<li><a class="nav-link" href="#sec-stratified-sampling"><span class="header-section-number">23.2.2</span> Stratified Sampling</a></li>
<li><a class="nav-link" href="#systematic-sampling"><span class="header-section-number">23.2.3</span> Systematic Sampling</a></li>
<li><a class="nav-link" href="#cluster-sampling"><span class="header-section-number">23.2.4</span> Cluster Sampling</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#non-probability-sampling"><span class="header-section-number">23.3</span> Non-Probability Sampling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#convenience-sampling"><span class="header-section-number">23.3.1</span> Convenience Sampling</a></li>
<li><a class="nav-link" href="#quota-sampling"><span class="header-section-number">23.3.2</span> Quota Sampling</a></li>
<li><a class="nav-link" href="#snowball-sampling"><span class="header-section-number">23.3.3</span> Snowball Sampling</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-unequal-probability-sampling"><span class="header-section-number">23.4</span> Unequal Probability Sampling</a></li>
<li>
<a class="nav-link" href="#sec-balanced-sampling"><span class="header-section-number">23.5</span> Balanced Sampling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cube-method-for-balanced-sampling"><span class="header-section-number">23.5.1</span> Cube Method for Balanced Sampling</a></li>
<li><a class="nav-link" href="#balanced-sampling-with-stratification"><span class="header-section-number">23.5.2</span> Balanced Sampling with Stratification</a></li>
<li><a class="nav-link" href="#balanced-sampling-in-cluster-sampling"><span class="header-section-number">23.5.3</span> Balanced Sampling in Cluster Sampling</a></li>
<li><a class="nav-link" href="#balanced-sampling-in-two-stage-sampling"><span class="header-section-number">23.5.4</span> Balanced Sampling in Two-Stage Sampling</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sample-size-determination"><span class="header-section-number">23.6</span> Sample Size Determination</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/23-sampling.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/23-sampling.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-03-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
