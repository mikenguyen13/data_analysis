<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 13 Hypothesis Testing | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="Error types: Type I Error (False Positive): Reality: nope Diagnosis/Analysis: yes  Type II Error (False Negative): Reality: yes Diagnosis/Analysis: nope Power: The probability of rejecting the...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 13 Hypothesis Testing | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/hypothesis-testing.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="Error types: Type I Error (False Positive): Reality: nope Diagnosis/Analysis: yes  Type II Error (False Negative): Reality: yes Diagnosis/Analysis: nope Power: The probability of rejecting the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 13 Hypothesis Testing | A Guide on Data Analysis">
<meta name="twitter:description" content="Error types: Type I Error (False Positive): Reality: nope Diagnosis/Analysis: yes  Type II Error (False Negative): Reality: yes Diagnosis/Analysis: nope Power: The probability of rejecting the...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/proj4js-2.3.15/proj4.js"></script><link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet">
<script src="libs/highcharts-8.1.2/highcharts.js"></script><script src="libs/highcharts-8.1.2/highcharts-3d.js"></script><script src="libs/highcharts-8.1.2/highcharts-more.js"></script><script src="libs/highcharts-8.1.2/modules/stock.js"></script><script src="libs/highcharts-8.1.2/modules/map.js"></script><script src="libs/highcharts-8.1.2/modules/annotations.js"></script><script src="libs/highcharts-8.1.2/modules/data.js"></script><script src="libs/highcharts-8.1.2/modules/drilldown.js"></script><script src="libs/highcharts-8.1.2/modules/item-series.js"></script><script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script><script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script><script src="libs/highcharts-8.1.2/modules/exporting.js"></script><script src="libs/highcharts-8.1.2/modules/export-data.js"></script><script src="libs/highcharts-8.1.2/modules/funnel.js"></script><script src="libs/highcharts-8.1.2/modules/heatmap.js"></script><script src="libs/highcharts-8.1.2/modules/treemap.js"></script><script src="libs/highcharts-8.1.2/modules/sankey.js"></script><script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script><script src="libs/highcharts-8.1.2/modules/organization.js"></script><script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script><script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script><script src="libs/highcharts-8.1.2/modules/sunburst.js"></script><script src="libs/highcharts-8.1.2/modules/vector.js"></script><script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script><script src="libs/highcharts-8.1.2/modules/xrange.js"></script><script src="libs/highcharts-8.1.2/modules/tilemap.js"></script><script src="libs/highcharts-8.1.2/modules/venn.js"></script><script src="libs/highcharts-8.1.2/modules/gantt.js"></script><script src="libs/highcharts-8.1.2/modules/timeline.js"></script><script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script><script src="libs/highcharts-8.1.2/modules/bullet.js"></script><script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script><script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script><script src="libs/highcharts-8.1.2/modules/lollipop.js"></script><script src="libs/highcharts-8.1.2/modules/series-label.js"></script><script src="libs/highcharts-8.1.2/plugins/motion.js"></script><script src="libs/highcharts-8.1.2/custom/reset.js"></script><script src="libs/highcharts-8.1.2/modules/boost.js"></script><script src="libs/highchart-binding-0.8.2/highchart.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">BASIC</li>
<li><a class="" href="descriptive-stat.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li class="book-part">RAMIFICATIONS</li>
<li><a class="" href="model-specification.html"><span class="header-section-number">10</span> Model Specification</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></li>
<li><a class="" href="data.html"><span class="header-section-number">12</span> Data</a></li>
<li><a class="active" href="hypothesis-testing.html"><span class="header-section-number">13</span> Hypothesis Testing</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">14</span> Prediction and Estimation</a></li>
<li class="book-part">EXPERIMENTAL DESIGN</li>
<li><a class="" href="sampling.html"><span class="header-section-number">15</span> Sampling</a></li>
<li><a class="" href="analysis-of-variance-anova.html"><span class="header-section-number">16</span> Analysis of Variance (ANOVA)</a></li>
<li><a class="" href="multivariate-methods.html"><span class="header-section-number">17</span> Multivariate Methods</a></li>
<li class="book-part">CAUSAL INFERENCE</li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">18</span> Causal Inference</a></li>
<li><a class="" href="experimental-design.html"><span class="header-section-number">19</span> Experimental Design</a></li>
<li><a class="" href="quasi-experimental.html"><span class="header-section-number">20</span> Quasi-experimental</a></li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">21</span> Endogeneity</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">22</span> Mediation</a></li>
<li class="book-part">MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">23</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">24</span> Exploratory Data Analysis</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="hypothesis-testing" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> Hypothesis Testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"><i class="fas fa-link"></i></a>
</h1>
<p>Error types:</p>
<ul>
<li>
<p>Type I Error (False Positive):</p>
<ul>
<li>Reality: nope</li>
<li>Diagnosis/Analysis: yes</li>
</ul>
</li>
<li>
<p>Type II Error (False Negative):</p>
<ul>
<li>Reality: yes</li>
<li>Diagnosis/Analysis: nope</li>
</ul>
</li>
</ul>
<p>Power: The probability of rejecting the null hypothesis when it is actually false</p>
<p><strong>Note:</strong></p>
<ul>
<li><p>Always written in terms of the population parameter (<span class="math inline">\(\beta\)</span>) not the estimator/estimate (<span class="math inline">\(\hat{\beta}\)</span>)</p></li>
<li>
<p>Sometimes, different disciplines prefer to use <span class="math inline">\(\beta\)</span> (i.e., standardized coefficient), or <span class="math inline">\(\mathbf{b}\)</span> (i.e., unstandardized coefficient)</p>
<ul>
<li><p><span class="math inline">\(\beta\)</span> and <span class="math inline">\(\mathbf{b}\)</span> are similar in interpretation; however, <span class="math inline">\(\beta\)</span> is scale free. Hence, you can see the relative contribution of <span class="math inline">\(\beta\)</span> to the dependent variable. On the other hand, <span class="math inline">\(\mathbf{b}\)</span> can be more easily used in policy decisions.</p></li>
<li><p><span class="math display">\[
\beta_j = \mathbf{b} \frac{s_{x_j}}{s_y}
\]</span></p></li>
</ul>
</li>
</ul>
<!-- --><ul>
<li>Assuming the null hypothesis is true, what is the (asymptotic) distribution of the estimator</li>
<li>Two-sided</li>
</ul>
<p><span class="math display">\[
H_0: \beta_j = 0 \\
H_1: \beta_j \neq 0 
\]</span></p>
<p>then under the null, the OLS estimator has the following distribution</p>
<p><span class="math display">\[
A1-A3a, A5: \sqrt{n} \hat{\beta_j}  \sim  N(0,Avar(\sqrt{n}\hat{\beta}_j))
\]</span></p>
<ul>
<li>For the one-sided test, the null is a set of values, so now you choose the worst case single value that is hardest to prove and derive the distribution under the null</li>
<li>One-sided</li>
</ul>
<p><span class="math display">\[
H_0: \beta_j\ge 0 \\
H_1: \beta_j &lt; 0 
\]</span></p>
<p>then the hardest null value to prove is <span class="math inline">\(H_0: \beta_j=0\)</span>. Then under this specific null, the OLS estimator has the following asymptotic distribution</p>
<p><span class="math display">\[
A1-A3a, A5: \sqrt{n}\hat{\beta_j} \sim N(0,Avar(\sqrt{n}\hat{\beta}_j))
\]</span></p>
<div id="types-of-hypothesis-testing" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> Types of hypothesis testing<a class="anchor" aria-label="anchor" href="#types-of-hypothesis-testing"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math inline">\(H_0 : \theta = \theta_0\)</span></p>
<p><span class="math inline">\(H_1 : \theta \neq \theta_0\)</span></p>
<p>How far away / extreme <span class="math inline">\(\theta\)</span> can be if our null hypothesis is true</p>
<p>Assume that our likelihood function for q is <span class="math inline">\(L(q) = q^{30}(1-q)^{70}\)</span> <strong>Likelihood function</strong></p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>
<span class="va">L</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">{</span><span class="va">q</span><span class="op">^</span><span class="fl">30</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">^</span><span class="fl">70</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">q</span>,<span class="fu">L</span><span class="op">(</span><span class="va">q</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"L(q)"</span>,xlab<span class="op">=</span><span class="st">"q"</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="13-hypothesis_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p><strong>Log-Likelihood function</strong></p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length<span class="op">=</span><span class="fl">100</span><span class="op">)</span>
<span class="va">l</span><span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">{</span><span class="fl">30</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="op">+</span> <span class="fl">70</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">q</span><span class="op">)</span><span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">q</span>,<span class="fu">l</span><span class="op">(</span><span class="va">q</span><span class="op">)</span><span class="op">-</span><span class="fu">l</span><span class="op">(</span><span class="fl">0.3</span><span class="op">)</span>,ylab<span class="op">=</span><span class="st">"l(q) - l(qhat)"</span>,xlab<span class="op">=</span><span class="st">"q"</span>,type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="13-hypothesis_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="inline-figure"><img src="images/nested_tests.jpg" style="display: block; margin: 1em auto"></div>
<p><span class="citation">(<a href="references.html#ref-Fox_1991" role="doc-biblioref">Fox 1991</a>)</span></p>
<p>typically, <a href="hypothesis-testing.html#the-likelihood-ratio-test">The likelihood ratio test</a> (and <a href="hypothesis-testing.html#lagrange-multiplier-score">Lagrange Multiplier (Score)</a>) performs better with small to moderate sample sizes, but the <a href="hypothesis-testing.html#wald-test">Wald test</a> only requires one maximization (under the full model).</p>
</div>
<div id="wald-test" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> Wald test<a class="anchor" aria-label="anchor" href="#wald-test"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[
W = (\hat{\theta}-\theta_0)'[cov(\hat{\theta})]^{-1}(\hat{\theta}-\theta_0) \\
W \sim \chi_q^2
\]</span></p>
<p>where <span class="math inline">\(cov(\hat{\theta})\)</span> is given by the inverse Fisher Information matrix evaluated at <span class="math inline">\(\hat{\theta}\)</span> and q is the rank of <span class="math inline">\(cov(\hat{\theta})\)</span>, which is the number of non-redundant parameters in <span class="math inline">\(\theta\)</span></p>
<p>Alternatively,</p>
<p><span class="math display">\[
t_W=\frac{(\hat{\theta}-\theta_0)^2}{I(\theta_0)^{-1}} \sim \chi^2_{(v)}
\]</span></p>
<p>where v is the degree of freedom.</p>
<p>Equivalently,</p>
<p><span class="math display">\[
s_W= \frac{\hat{\theta}-\theta_0}{\sqrt{I(\hat{\theta})^{-1}}} \sim Z
\]</span></p>
<p>How far away in the distribution your sample estimate is from the hypothesized population parameter.</p>
<p>For a null value, what is the probability you would have obtained a realization “more extreme” or “worse” than the estimate you actually obtained?</p>
<p>Significance Level (<span class="math inline">\(\alpha\)</span>) and Confidence Level (<span class="math inline">\(1-\alpha\)</span>)</p>
<ul>
<li>The significance level is the benchmark in which the probability is so low that we would have to reject the null</li>
<li>The confidence level is the probability that sets the bounds on how far away the realization of the estimator would have to be to reject the null.</li>
</ul>
<p><strong>Test Statistics</strong></p>
<ul>
<li>Standardized (transform) the estimator and null value to a test statistic that always has the same distribution</li>
<li>Test Statistic for the OLS estimator for a single hypothesis</li>
</ul>
<p><span class="math display">\[
T = \frac{\sqrt{n}(\hat{\beta}_j-\beta_{j0})}{\sqrt{n}SE(\hat{\beta_j})} \sim^a N(0,1)
\]</span></p>
<p>Equivalently,</p>
<p><span class="math display">\[
T = \frac{(\hat{\beta}_j-\beta_{j0})}{SE(\hat{\beta_j})} \sim^a N(0,1)
\]</span></p>
<p>the test statistic is another random variable that is a function of the data and null hypothesis.</p>
<ul>
<li>T denotes the random variable test statistic</li>
<li>t denotes the single realization of the test statistic</li>
</ul>
<p>Evaluating Test Statistic: determine whether or not we reject or fail to reject the null hypothesis at a given significance / confidence level</p>
<p>Three equivalent ways</p>
<ol style="list-style-type: decimal">
<li><p>Critical Value<br></p></li>
<li><p>P-value<br></p></li>
<li><p>Confidence Interval</p></li>
<li><p>Critical Value</p></li>
</ol>
<p>For a given significance level, will determine the critical value (c)<br>
* One-sided: <span class="math inline">\(H_0: \beta_j \ge \beta_{j0}\)</span></p>
<p><span class="math display">\[
P(T&lt;c|H_0)=\alpha
\]</span></p>
<p>Reject the null if <span class="math inline">\(t&lt;c\)</span></p>
<ul>
<li>One-sided: <span class="math inline">\(H_0: \beta_j \le \beta_{j0}\)</span>
</li>
</ul>
<p><span class="math display">\[
P(T&gt;c|H_0)=\alpha
\]</span></p>
<p>Reject the null if <span class="math inline">\(t&gt;c\)</span></p>
<ul>
<li>TWo-sided: <span class="math inline">\(H_0: \beta_j \neq \beta_{j0}\)</span>
</li>
</ul>
<p><span class="math display">\[
P(|T|&gt;c|H_0)=\alpha
\]</span></p>
<p>Reject the null if <span class="math inline">\(|t|&gt;c\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>p-value</li>
</ol>
<p>Calculate the probability that the test statistic was worse than the realization you have</p>
<ul>
<li>One-sided: <span class="math inline">\(H_0: \beta_j \ge \beta_{j0}\)</span>
</li>
</ul>
<p><span class="math display">\[
\text{p-value} = P(T&lt;t|H_0)
\]</span></p>
<ul>
<li>One-sided: <span class="math inline">\(H_0: \beta_j \le \beta_{j0}\)</span>
</li>
</ul>
<p><span class="math display">\[
\text{p-value} = P(T&gt;t|H_0)
\]</span></p>
<ul>
<li>Two-sided: <span class="math inline">\(H_0: \beta_j \neq \beta_{j0}\)</span>
</li>
</ul>
<p><span class="math display">\[
\text{p-value} = P(|T|&lt;t|H_0)
\]</span></p>
<p>reject the null if p-value <span class="math inline">\(&lt; \alpha\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Confidence Interval</li>
</ol>
<p>Using the critical value associated with a null hypothesis and significance level, create an interval</p>
<p><span class="math display">\[
CI(\hat{\beta}_j)_{\alpha} = [\hat{\beta}_j-(c \times SE(\hat{\beta}_j)),\hat{\beta}_j+(c \times SE(\hat{\beta}_j))]
\]</span></p>
<p>If the null set lies outside the interval then we reject the null.</p>
<ul>
<li>We are not testing whether the true population value is close to the estimate, we are testing that given a field true population value of the parameter, how like it is that we observed this estimate.</li>
<li>Can be interpreted as we believe with <span class="math inline">\((1-\alpha)\times 100 \%\)</span> probability that the confidence interval captures the true parameter value.</li>
</ul>
<p>With stronger assumption (A1-A6), we could consider <a href="linear-regression.html#finite-sample-properties">Finite Sample Properties</a></p>
<p><span class="math display">\[
T = \frac{\hat{\beta}_j-\beta_{j0}}{SE(\hat{\beta}_j)} \sim T(n-k)
\]</span></p>
<ul>
<li>This above distributional derivation is strongly dependent on <a href="linear-regression.html#a4-homoskedasticity">A4</a> and <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>
</li>
<li>T has a student t-distribution because the numerator is normal and the denominator is <span class="math inline">\(\chi^2\)</span>.</li>
<li>Critical value and p-values will be calculated from the student t-distribution rather than the standard normal distribution.</li>
<li>
<span class="math inline">\(n \to \infty\)</span>, <span class="math inline">\(T(n-k)\)</span> is asymptotically standard normal.</li>
</ul>
<p><strong>Rule of thumb</strong></p>
<ul>
<li><p>if <span class="math inline">\(n-k&gt;120\)</span>: the critical values and p-values from the t-distribution are (almost) the same as the critical values and p-values from the standard normal distribution.</p></li>
<li>
<p>if <span class="math inline">\(n-k&lt;120\)</span></p>
<ul>
<li>if (A1-A6) hold then the t-test is an exact finite distribution test</li>
<li>if (A1-A3a, A5) hold, because the t-distribution is asymptotically normal, computing the critical values from a t-distribution is still a valid asymptotic test (i.e., not quite the right critical values and p0values, the difference goes away as <span class="math inline">\(n \to \infty\)</span>)</li>
</ul>
</li>
</ul>
<div id="multiple-hypothesis" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">13.2.1</span> Multiple Hypothesis<a class="anchor" aria-label="anchor" href="#multiple-hypothesis"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p>test multiple parameters as the same time</p>
<ul>
<li><span class="math inline">\(H_0: \beta_1 = 0\ \&amp; \ \beta_2 = 0\)</span></li>
<li><span class="math inline">\(H_0: \beta_1 = 1\ \&amp; \ \beta_2 = 0\)</span></li>
</ul>
</li>
<li><p>perform a series of simply hypothesis does not answer the question (joint distribution vs. two marginal distributions).</p></li>
<li><p>The test statistic is based on a restriction written in matrix form.</p></li>
</ul>
<p><span class="math display">\[
y=\beta_0+x_1\beta_1 + x_2\beta_2 + x_3\beta_3 + \epsilon
\]</span></p>
<p>Null hypothesis is <span class="math inline">\(H_0: \beta_1 = 0\)</span> &amp; <span class="math inline">\(\beta_2=0\)</span> can be rewritten as <span class="math inline">\(H_0: \mathbf{R}\beta -\mathbf{q}=0\)</span> where</p>
<ul>
<li>
<span class="math inline">\(\mathbf{R}\)</span> is a m x k matrix where m is the number of restrictions and k is the number of parameters. <span class="math inline">\(\mathbf{q}\)</span> is a k x 1 vector</li>
<li>
<span class="math inline">\(\mathbf{R}\)</span> “picks up” the relevant parameters while <span class="math inline">\(\mathbf{q}\)</span> is a the null value of the parameter</li>
</ul>
<p><span class="math display">\[
\mathbf{R}= 
\left(
\begin{array}{cccc}
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 \\
\end{array}
\right),
\mathbf{q} = 
\left(
\begin{array}{c}
0 \\
0 \\
\end{array}
\right)
\]</span></p>
<p>Test Statistic for OLS estimator for a multiple hypothesis</p>
<p><span class="math display">\[
F = \frac{(\mathbf{R\hat{\beta}-q})\hat{\Sigma}^{-1}(\mathbf{R\hat{\beta}-q})}{m} \sim^a F(m,n-k)
\]</span></p>
<ul>
<li>
<p><span class="math inline">\(\hat{\Sigma}^{-1}\)</span> is the estimator for the asymptotic variance-covariance matrix</p>
<ul>
<li>if <a href="linear-regression.html#a4-homoskedasticity">A4</a> holds, both the homoskedastic and heteroskedastic versions produce valid estimator</li>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> does not hold, only the heteroskedastic version produces valid estimators.</li>
</ul>
</li>
<li><p>When m = 1, there is only a single restriction, then the F-statistic is the t-statistic squared.</p></li>
<li><p>F distribution is strictly positive, check <a href="prerequisites.html#f-distribution">F-Distribution</a> for more details.</p></li>
</ul>
</div>
<div id="linear-combination" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">13.2.2</span> Linear Combination<a class="anchor" aria-label="anchor" href="#linear-combination"><i class="fas fa-link"></i></a>
</h3>
<p>Testing multiple parameters as the same time</p>
<p><span class="math display">\[
H_0: \beta_1 -\beta_2 = 0 \\
H_0: \beta_1 - \beta_2 &gt; 0 \\
H_0: \beta_1 - 2*\beta_2 =0
\]</span></p>
<p>Each is a single restriction on a function of the parameters.</p>
<p>Null hypothesis:</p>
<p><span class="math display">\[
H_0: \beta_1 -\beta_2 = 0
\]</span></p>
<p>can be rewritten as</p>
<p><span class="math display">\[
H_0: \mathbf{R}\beta -\mathbf{q}=0
\]</span></p>
<p>where <span class="math inline">\(\mathbf{R}\)</span>=(0 1 -1 0 0) and <span class="math inline">\(\mathbf{q}=0\)</span></p>
</div>
<div id="estimate-difference-in-coefficients" class="section level3" number="13.2.3">
<h3>
<span class="header-section-number">13.2.3</span> Estimate Difference in Coefficients<a class="anchor" aria-label="anchor" href="#estimate-difference-in-coefficients"><i class="fas fa-link"></i></a>
</h3>
<p>There is no package to estimate for the difference between two coefficients and its CI, but a simple function created by <a href="https://kzee.github.io/CoeffDiff_Demo.html">Katherine Zee</a> can be used to calculate this difference. Some modifications might be needed if you don’t use standard <code>lm</code> model in R.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">difftest_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">model</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">diffest</span> <span class="op">&lt;-</span>
        <span class="fu"><a href="https://rdrr.io/pkg/spaMM/man/summary.HL.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">x1</span>, <span class="st">"Estimate"</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/spaMM/man/summary.HL.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">x2</span>, <span class="st">"Estimate"</span><span class="op">]</span>
    <span class="va">vardiff</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/spaMM/man/summary.HL.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">x1</span>, <span class="st">"Std. Error"</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span>
                    <span class="fu"><a href="https://rdrr.io/pkg/spaMM/man/summary.HL.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="va">x2</span>, <span class="st">"Std. Error"</span><span class="op">]</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="co"># variance of x1 + variance of x2 - 2*covariance of x1 and x2</span>
    <span class="va">diffse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">vardiff</span><span class="op">)</span>
    <span class="va">tdiff</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">diffest</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">diffse</span><span class="op">)</span>
    <span class="va">ptdiff</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">tdiff</span><span class="op">)</span>, <span class="va">model</span><span class="op">$</span><span class="va">df</span>, lower.tail <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
    <span class="va">upr</span> <span class="op">&lt;-</span>
        <span class="va">diffest</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">df</span><span class="op">)</span> <span class="op">*</span> <span class="va">diffse</span> <span class="co"># will usually be very close to 1.96</span>
    <span class="va">lwr</span> <span class="op">&lt;-</span> <span class="va">diffest</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">.025</span>, df <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">df</span><span class="op">)</span> <span class="op">*</span> <span class="va">diffse</span>
    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">df</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span>
        est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">diffest</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
        t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tdiff</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
        p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ptdiff</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
        lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lwr</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
        upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">upr</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
        df <span class="op">=</span> <span class="va">df</span>
    <span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="application-9" class="section level3" number="13.2.4">
<h3>
<span class="header-section-number">13.2.4</span> Application<a class="anchor" aria-label="anchor" href="#application-9"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span>

<span class="co"># Multiple hypothesis</span>
<span class="va">mod.davis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">repwt</span>, data<span class="op">=</span><span class="va">Davis</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">mod.davis</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(Intercept) = 0"</span>, <span class="st">"repwt = 1"</span><span class="op">)</span>,white.adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Linear hypothesis test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hypothesis:</span>
<span class="co">#&gt; (Intercept) = 0</span>
<span class="co">#&gt; repwt = 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: restricted model</span>
<span class="co">#&gt; Model 2: weight ~ repwt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Res.Df Df      F  Pr(&gt;F)  </span>
<span class="co">#&gt; 1    183                    </span>
<span class="co">#&gt; 2    181  2 3.3896 0.03588 *</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># Linear Combination</span>
<span class="va">mod.duncan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">prestige</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">education</span>, data<span class="op">=</span><span class="va">Duncan</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html">linearHypothesis</a></span><span class="op">(</span><span class="va">mod.duncan</span>, <span class="st">"1*income - 1*education = 0"</span><span class="op">)</span>
<span class="co">#&gt; Linear hypothesis test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Hypothesis:</span>
<span class="co">#&gt; income - education = 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model 1: restricted model</span>
<span class="co">#&gt; Model 2: prestige ~ income + education</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co">#&gt; 1     43 7518.9                           </span>
<span class="co">#&gt; 2     42 7506.7  1    12.195 0.0682 0.7952</span></code></pre></div>
</div>
<div id="nonlinear-1" class="section level3" number="13.2.5">
<h3>
<span class="header-section-number">13.2.5</span> Nonlinear<a class="anchor" aria-label="anchor" href="#nonlinear-1"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose that we have q nonlinear functions of the parameters<br><span class="math display">\[
\mathbf{h}(\theta) = \{ h_1 (\theta), ..., h_q (\theta)\}'
\]</span></p>
<p>The,n, the Jacobian matrix (<span class="math inline">\(\mathbf{H}(\theta)\)</span>), of rank q is</p>
<p><span class="math display">\[
\mathbf{H}_{q \times p}(\theta) = 
\left(
\begin{array}
{ccc}
\frac{\partial h_1(\theta)}{\partial \theta_1} &amp; ... &amp; \frac{\partial h_1(\theta)}{\partial \theta_p} \\
. &amp; . &amp; . \\
\frac{\partial h_q(\theta)}{\partial \theta_1} &amp; ... &amp; \frac{\partial h_q(\theta)}{\partial \theta_p}
\end{array}
\right)
\]</span></p>
<p>where the null hypothesis <span class="math inline">\(H_0: \mathbf{h} (\theta) = 0\)</span> can be tested agiasnt the 2-sided alternative with the Wald statistic</p>
<p><span class="math display">\[
W = \frac{\mathbf{h(\hat{\theta})'\{H(\hat{\theta})[F(\hat{\theta})'F(\hat{\theta})]^{-1}H(\hat{\theta})'\}^{-1}h(\hat{\theta})}}{s^2q} \sim F_{q,n-p}
\]</span></p>
</div>
</div>
<div id="the-likelihood-ratio-test" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> The likelihood ratio test<a class="anchor" aria-label="anchor" href="#the-likelihood-ratio-test"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[
t_{LR} = 2[l(\hat{\theta})-l(\theta_0)] \sim \chi^2_v
\]</span></p>
<p>where v is the degree of freedom.</p>
<p>Compare the height of the log-likelihood of the sample estimate in relation to the height of log-likelihood of the hypothesized population parameter</p>
<p>Alternatively,</p>
<p>This test considers a ratio of two maximizations,</p>
<p><span class="math display">\[
L_r = \text{maximized value of the likelihood under $H_0$ (the reduced model)} \\
L_f = \text{maximized value of the likelihood under $H_0 \cup H_a$ (the full model)}
\]</span></p>
<p>Then, the likelihood ratio is:</p>
<p><span class="math display">\[
\Lambda = \frac{L_r}{L_f}
\]</span></p>
<p>which can’t exceed 1 (since <span class="math inline">\(L_f\)</span> is always at least as large as <span class="math inline">\(L-r\)</span> because <span class="math inline">\(L_r\)</span> is the result of a maximization under a restricted set of the parameter values).</p>
<p>The likelihood ratio statistic is:</p>
<p><span class="math display">\[
-2ln(\Lambda) = -2ln(L_r/L_f) = -2(l_r - l_f) \\
\lim_{n \to \infty}(-2ln(\Lambda)) \sim \chi^2_v
\]</span></p>
<p>where v is the number of parameters in the full model minus the number of parameters in the reduced model.</p>
<p>If <span class="math inline">\(L_r\)</span> is much smaller than <span class="math inline">\(L_f\)</span> (the likelihood ratio exceeds <span class="math inline">\(\chi_{\alpha,v}^2\)</span>), then we reject he reduced model and accept the full model at <span class="math inline">\(\alpha \times 100 \%\)</span> significance level</p>
</div>
<div id="lagrange-multiplier-score" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Lagrange Multiplier (Score)<a class="anchor" aria-label="anchor" href="#lagrange-multiplier-score"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[
t_S= \frac{S(\theta_0)^2}{I(\theta_0)} \sim \chi^2_v
\]</span></p>
<p>where v is the degree of freedom.</p>
<p>Compare the slope of the log-likelihood of the sample estimate in relation to the slope of the log-likelihood of the hypothesized population parameter</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data.html"><span class="header-section-number">12</span> Data</a></div>
<div class="next"><a href="prediction-and-estimation.html"><span class="header-section-number">14</span> Prediction and Estimation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#hypothesis-testing"><span class="header-section-number">13</span> Hypothesis Testing</a></li>
<li><a class="nav-link" href="#types-of-hypothesis-testing"><span class="header-section-number">13.1</span> Types of hypothesis testing</a></li>
<li>
<a class="nav-link" href="#wald-test"><span class="header-section-number">13.2</span> Wald test</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#multiple-hypothesis"><span class="header-section-number">13.2.1</span> Multiple Hypothesis</a></li>
<li><a class="nav-link" href="#linear-combination"><span class="header-section-number">13.2.2</span> Linear Combination</a></li>
<li><a class="nav-link" href="#estimate-difference-in-coefficients"><span class="header-section-number">13.2.3</span> Estimate Difference in Coefficients</a></li>
<li><a class="nav-link" href="#application-9"><span class="header-section-number">13.2.4</span> Application</a></li>
<li><a class="nav-link" href="#nonlinear-1"><span class="header-section-number">13.2.5</span> Nonlinear</a></li>
</ul>
</li>
<li><a class="nav-link" href="#the-likelihood-ratio-test"><span class="header-section-number">13.3</span> The likelihood ratio test</a></li>
<li><a class="nav-link" href="#lagrange-multiplier-score"><span class="header-section-number">13.4</span> Lagrange Multiplier (Score)</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/13-hypothesis.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/13-hypothesis.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2022-01-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
