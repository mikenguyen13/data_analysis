<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>36.2 Endogenous Sample Selection | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="36.2 Endogenous Sample Selection | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="36.2 Endogenous Sample Selection | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2025-06-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-endogenous-treatment.html"/>
<link rel="next" href="other-biases.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
<li class="chapter" data-level="2.1.6" data-path="matrix-theory.html"><a href="matrix-theory.html#cholesky-decomposition"><i class="fa fa-check"></i><b>2.1.6</b> Cholesky Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#skewness"><i class="fa fa-check"></i><b>2.2.6</b> Skewness</a></li>
<li class="chapter" data-level="2.2.7" data-path="probability-theory.html"><a href="probability-theory.html#kurtosis"><i class="fa fa-check"></i><b>2.2.7</b> Kurtosis</a></li>
<li class="chapter" data-level="2.2.8" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.8</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.5</b> Convergence</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.6</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.7</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#key-limitations-of-r"><i class="fa fa-check"></i><b>2.4.1</b> Key Limitations of R</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#solutions-and-workarounds"><i class="fa fa-check"></i><b>2.4.2</b> Solutions and Workarounds</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.3</b> Medium size</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.4</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
<li class="chapter" data-level="3.4.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#general-approach-to-bivariate-statistics"><i class="fa fa-check"></i><b>3.4.4</b> General Approach to Bivariate Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Testing Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i><b>4.1.1</b> Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> Errors in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-role-of-distributions-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> The Role of Distributions in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-test-statistic"><i class="fa fa-check"></i><b>4.1.4</b> The Test Statistic</a></li>
<li class="chapter" data-level="4.1.5" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#critical-values-and-rejection-regions-1"><i class="fa fa-check"></i><b>4.1.5</b> Critical Values and Rejection Regions</a></li>
<li class="chapter" data-level="4.1.6" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#visualizing-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.6</b> Visualizing Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html"><i class="fa fa-check"></i><b>4.2</b> Key Concepts and Definitions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#random-sample"><i class="fa fa-check"></i><b>4.2.1</b> Random Sample</a></li>
<li class="chapter" data-level="4.2.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#sample-statistics"><i class="fa fa-check"></i><b>4.2.2</b> Sample Statistics</a></li>
<li class="chapter" data-level="4.2.3" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#distribution-of-the-sample-mean"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-mean"><i class="fa fa-check"></i><b>4.3.1</b> For Single Mean</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-independent-samples"><i class="fa fa-check"></i><b>4.3.2</b> For Difference of Means, Independent Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-paired-samples"><i class="fa fa-check"></i><b>4.3.3</b> For Difference of Means, Paired Samples</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-two-proportions"><i class="fa fa-check"></i><b>4.3.4</b> For Difference of Two Proportions</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-proportion"><i class="fa fa-check"></i><b>4.3.5</b> For Single Proportion</a></li>
<li class="chapter" data-level="4.3.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-variance"><i class="fa fa-check"></i><b>4.3.6</b> For Single Variance</a></li>
<li class="chapter" data-level="4.3.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.3.7</b> Non-parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.4</b> Two-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-means"><i class="fa fa-check"></i><b>4.4.1</b> For Means</a></li>
<li class="chapter" data-level="4.4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-variances"><i class="fa fa-check"></i><b>4.4.2</b> For Variances</a></li>
<li class="chapter" data-level="4.4.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power"><i class="fa fa-check"></i><b>4.4.3</b> Power</a></li>
<li class="chapter" data-level="4.4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.4.4</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.4.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.4.5</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.5</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#association-tests"><i class="fa fa-check"></i><b>4.5.1</b> Association Tests</a></li>
<li class="chapter" data-level="4.5.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.5.2</b> Ordinal Association</a></li>
<li class="chapter" data-level="4.5.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-trend"><i class="fa fa-check"></i><b>4.5.3</b> Ordinal Trend</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.6</b> Divergence Metrics and Tests for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>4.6.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-anderson-darling-test"><i class="fa fa-check"></i><b>4.6.2</b> Anderson-Darling Test</a></li>
<li class="chapter" data-level="4.6.3" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.6.3</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.6.4" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-cramer-von-mises-test"><i class="fa fa-check"></i><b>4.6.4</b> Cramér-von Mises Test</a></li>
<li class="chapter" data-level="4.6.5" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.6.5</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.6.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.6.6</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.6.7" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-hellinger-distance"><i class="fa fa-check"></i><b>4.6.7</b> Hellinger Distance</a></li>
<li class="chapter" data-level="4.6.8" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-bhattacharyya-distance"><i class="fa fa-check"></i><b>4.6.8</b> Bhattacharyya Distance</a></li>
<li class="chapter" data-level="4.6.9" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-wasserstein-distance"><i class="fa fa-check"></i><b>4.6.9</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.6.10" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-energy-distance"><i class="fa fa-check"></i><b>4.6.10</b> Energy Distance</a></li>
<li class="chapter" data-level="4.6.11" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-total-variation-distance"><i class="fa fa-check"></i><b>4.6.11</b> Total Variation Distance</a></li>
<li class="chapter" data-level="4.6.12" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#summary"><i class="fa fa-check"></i><b>4.6.12</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic) Model</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#infeasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.1</b> Infeasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#feasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.2</b> Feasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.3" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#weighted-least-squares"><i class="fa fa-check"></i><b>5.2.3</b> Weighted Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html"><i class="fa fa-check"></i><b>5.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.3.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#key-quantities-for-inference"><i class="fa fa-check"></i><b>5.3.2</b> Key Quantities for Inference</a></li>
<li class="chapter" data-level="5.3.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#assumptions-of-mle"><i class="fa fa-check"></i><b>5.3.3</b> Assumptions of MLE</a></li>
<li class="chapter" data-level="5.3.4" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#properties-of-mle"><i class="fa fa-check"></i><b>5.3.4</b> Properties of MLE</a></li>
<li class="chapter" data-level="5.3.5" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#practical-considerations"><i class="fa fa-check"></i><b>5.3.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="5.3.6" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#comparison-of-mle-and-ols"><i class="fa fa-check"></i><b>5.3.6</b> Comparison of MLE and OLS</a></li>
<li class="chapter" data-level="5.3.7" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#applications-of-mle"><i class="fa fa-check"></i><b>5.3.7</b> Applications of MLE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html"><i class="fa fa-check"></i><b>5.4</b> Penalized (Regularized) Estimators</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#motivation-for-penalized-estimators"><i class="fa fa-check"></i><b>5.4.1</b> Motivation for Penalized Estimators</a></li>
<li class="chapter" data-level="5.4.2" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#ridge-regression"><i class="fa fa-check"></i><b>5.4.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.4.3" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#lasso-regression"><i class="fa fa-check"></i><b>5.4.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="5.4.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#elastic-net"><i class="fa fa-check"></i><b>5.4.4</b> Elastic Net</a></li>
<li class="chapter" data-level="5.4.5" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#tuning-parameter-selection"><i class="fa fa-check"></i><b>5.4.5</b> Tuning Parameter Selection</a></li>
<li class="chapter" data-level="5.4.6" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#properties-of-penalized-estimators"><i class="fa fa-check"></i><b>5.4.6</b> Properties of Penalized Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="robust-estimators.html"><a href="robust-estimators.html"><i class="fa fa-check"></i><b>5.5</b> Robust Estimators</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="robust-estimators.html"><a href="robust-estimators.html#motivation-for-robust-estimation"><i class="fa fa-check"></i><b>5.5.1</b> Motivation for Robust Estimation</a></li>
<li class="chapter" data-level="5.5.2" data-path="robust-estimators.html"><a href="robust-estimators.html#m-estimators"><i class="fa fa-check"></i><b>5.5.2</b> <span class="math inline">\(M\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.3" data-path="robust-estimators.html"><a href="robust-estimators.html#r-estimators"><i class="fa fa-check"></i><b>5.5.3</b> <span class="math inline">\(R\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.4" data-path="robust-estimators.html"><a href="robust-estimators.html#l-estimators"><i class="fa fa-check"></i><b>5.5.4</b> <span class="math inline">\(L\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.5" data-path="robust-estimators.html"><a href="robust-estimators.html#least-trimmed-squares-lts"><i class="fa fa-check"></i><b>5.5.5</b> Least Trimmed Squares (LTS)</a></li>
<li class="chapter" data-level="5.5.6" data-path="robust-estimators.html"><a href="robust-estimators.html#s-estimators"><i class="fa fa-check"></i><b>5.5.6</b> <span class="math inline">\(S\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.7" data-path="robust-estimators.html"><a href="robust-estimators.html#mm-estimators"><i class="fa fa-check"></i><b>5.5.7</b> <span class="math inline">\(MM\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.8" data-path="robust-estimators.html"><a href="robust-estimators.html#practical-considerations-1"><i class="fa fa-check"></i><b>5.5.8</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="partial-least-squares.html"><a href="partial-least-squares.html"><i class="fa fa-check"></i><b>5.6</b> Partial Least Squares</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="partial-least-squares.html"><a href="partial-least-squares.html#motivation-for-pls"><i class="fa fa-check"></i><b>5.6.1</b> Motivation for PLS</a></li>
<li class="chapter" data-level="5.6.2" data-path="partial-least-squares.html"><a href="partial-least-squares.html#steps-to-construct-pls-components"><i class="fa fa-check"></i><b>5.6.2</b> Steps to Construct PLS Components</a></li>
<li class="chapter" data-level="5.6.3" data-path="partial-least-squares.html"><a href="partial-least-squares.html#properties-of-pls"><i class="fa fa-check"></i><b>5.6.3</b> Properties of PLS</a></li>
<li class="chapter" data-level="5.6.4" data-path="partial-least-squares.html"><a href="partial-least-squares.html#comparison-with-related-methods"><i class="fa fa-check"></i><b>5.6.4</b> Comparison with Related Methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference.html"><a href="inference.html#linear-functions-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Functions of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference.html"><a href="inference.html#nonlinear-functions-of-parameters"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear Functions of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Iterative Optimization</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#derivative-free"><i class="fa fa-check"></i><b>6.2.2</b> Derivative-Free</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic Heuristic</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.4</b> Linearization</a></li>
<li class="chapter" data-level="6.2.5" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.5</b> Hybrid</a></li>
<li class="chapter" data-level="6.2.6" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#comparison-of-nonlinear-optimizers"><i class="fa fa-check"></i><b>6.2.6</b> Comparison of Nonlinear Optimizers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html"><i class="fa fa-check"></i><b>6.3</b> Practical Considerations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#selecting-starting-values"><i class="fa fa-check"></i><b>6.3.1</b> Selecting Starting Values</a></li>
<li class="chapter" data-level="6.3.2" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#handling-constrained-parameters"><i class="fa fa-check"></i><b>6.3.2</b> Handling Constrained Parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#failure-to-converge"><i class="fa fa-check"></i><b>6.3.3</b> Failure to Converge</a></li>
<li class="chapter" data-level="6.3.4" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#convergence-to-a-local-minimum"><i class="fa fa-check"></i><b>6.3.4</b> Convergence to a Local Minimum</a></li>
<li class="chapter" data-level="6.3.5" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#model-adequacy-and-estimation-considerations"><i class="fa fa-check"></i><b>6.3.5</b> Model Adequacy and Estimation Considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>6.4</b> Application</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="application.html"><a href="application.html#nonlinear-estimation-using-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.4.1</b> Nonlinear Estimation Using Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.4.2" data-path="application.html"><a href="application.html#logistic-growth-model"><i class="fa fa-check"></i><b>6.4.2</b> Logistic Growth Model</a></li>
<li class="chapter" data-level="6.4.3" data-path="application.html"><a href="application.html#nonlinear-plateau-model"><i class="fa fa-check"></i><b>6.4.3</b> Nonlinear Plateau Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#logistic-model"><i class="fa fa-check"></i><b>7.1.1</b> Logistic Model</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#sec-likelihood-function-logistic"><i class="fa fa-check"></i><b>7.1.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="7.1.3" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#fisher-information-matrix"><i class="fa fa-check"></i><b>7.1.3</b> Fisher Information Matrix</a></li>
<li class="chapter" data-level="7.1.4" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#inference-in-logistic-regression"><i class="fa fa-check"></i><b>7.1.4</b> Inference in Logistic Regression</a></li>
<li class="chapter" data-level="7.1.5" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#application-logistic-regression"><i class="fa fa-check"></i><b>7.1.5</b> Application: Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#probit-model"><i class="fa fa-check"></i><b>7.2.1</b> Probit Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#application-probit-regression"><i class="fa fa-check"></i><b>7.2.2</b> Application: Probit Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#dataset-overview"><i class="fa fa-check"></i><b>7.3.1</b> Dataset Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-logistic-model"><i class="fa fa-check"></i><b>7.3.2</b> Apply Logistic Model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-probit-model"><i class="fa fa-check"></i><b>7.3.3</b> Apply Probit Model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#the-poisson-distribution"><i class="fa fa-check"></i><b>7.4.1</b> The Poisson Distribution</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#poisson-model"><i class="fa fa-check"></i><b>7.4.2</b> Poisson Model</a></li>
<li class="chapter" data-level="7.4.3" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#link-function-choices"><i class="fa fa-check"></i><b>7.4.3</b> Link Function Choices</a></li>
<li class="chapter" data-level="7.4.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#application-poisson-regression"><i class="fa fa-check"></i><b>7.4.4</b> Application: Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>7.5.1</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#application-negative-binomial-regression"><i class="fa fa-check"></i><b>7.5.2</b> Application: Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.5.3" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#fitting-a-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>7.5.3</b> Fitting a Zero-Inflated Negative Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html"><i class="fa fa-check"></i><b>7.6</b> Quasi-Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#is-quasi-poisson-regression-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.6.1</b> Is Quasi-Poisson Regression a Generalized Linear Model?</a></li>
<li class="chapter" data-level="7.6.2" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#application-quasi-poisson-regression"><i class="fa fa-check"></i><b>7.6.2</b> Application: Quasi-Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.7</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#the-multinomial-distribution"><i class="fa fa-check"></i><b>7.7.1</b> The Multinomial Distribution</a></li>
<li class="chapter" data-level="7.7.2" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#modeling-probabilities-using-log-odds"><i class="fa fa-check"></i><b>7.7.2</b> Modeling Probabilities Using Log-Odds</a></li>
<li class="chapter" data-level="7.7.3" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#softmax-representation"><i class="fa fa-check"></i><b>7.7.3</b> Softmax Representation</a></li>
<li class="chapter" data-level="7.7.4" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#log-odds-ratio-between-two-categories"><i class="fa fa-check"></i><b>7.7.4</b> Log-Odds Ratio Between Two Categories</a></li>
<li class="chapter" data-level="7.7.5" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#estimation"><i class="fa fa-check"></i><b>7.7.5</b> Estimation</a></li>
<li class="chapter" data-level="7.7.6" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#interpretation-of-coefficients"><i class="fa fa-check"></i><b>7.7.6</b> Interpretation of Coefficients</a></li>
<li class="chapter" data-level="7.7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-multinomial-logistic-regression"><i class="fa fa-check"></i><b>7.7.7</b> Application: Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.7.8" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-gamma-regression"><i class="fa fa-check"></i><b>7.7.8</b> Application: Gamma Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html"><i class="fa fa-check"></i><b>7.8</b> Generalization of Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#exponential-family"><i class="fa fa-check"></i><b>7.8.1</b> Exponential Family</a></li>
<li class="chapter" data-level="7.8.2" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#properties-of-glm-exponential-families"><i class="fa fa-check"></i><b>7.8.2</b> Properties of GLM Exponential Families</a></li>
<li class="chapter" data-level="7.8.3" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#structure-of-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.8.3</b> Structure of a Generalized Linear Model</a></li>
<li class="chapter" data-level="7.8.4" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#components-of-a-glm"><i class="fa fa-check"></i><b>7.8.4</b> Components of a GLM</a></li>
<li class="chapter" data-level="7.8.5" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#canonical-link"><i class="fa fa-check"></i><b>7.8.5</b> Canonical Link</a></li>
<li class="chapter" data-level="7.8.6" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inverse-link-functions"><i class="fa fa-check"></i><b>7.8.6</b> Inverse Link Functions</a></li>
<li class="chapter" data-level="7.8.7" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#estimation-of-parameters-in-glms"><i class="fa fa-check"></i><b>7.8.7</b> Estimation of Parameters in GLMs</a></li>
<li class="chapter" data-level="7.8.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inference-1"><i class="fa fa-check"></i><b>7.8.8</b> Inference</a></li>
<li class="chapter" data-level="7.8.9" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#deviance"><i class="fa fa-check"></i><b>7.8.9</b> Deviance</a></li>
<li class="chapter" data-level="7.8.10" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.8.10</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.8.11" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.8.11</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.8.12" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#over-dispersion"><i class="fa fa-check"></i><b>7.8.12</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-linear-mixed-models.html"><a href="sec-linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#motivation-a-repeated-measurements-example"><i class="fa fa-check"></i><b>8.1.1</b> Motivation: A Repeated Measurements Example</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#example-linear-mixed-model-for-repeated-measurements"><i class="fa fa-check"></i><b>8.1.2</b> Example: Linear Mixed Model for Repeated Measurements</a></li>
<li class="chapter" data-level="8.1.3" data-path="dependent-data.html"><a href="dependent-data.html#sec-random-intercepts-model-lmm"><i class="fa fa-check"></i><b>8.1.3</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.4" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models-in-linear-mixed-models"><i class="fa fa-check"></i><b>8.1.4</b> Covariance Models in Linear Mixed Models</a></li>
<li class="chapter" data-level="8.1.5" data-path="dependent-data.html"><a href="dependent-data.html#covariance-structures-in-mixed-models"><i class="fa fa-check"></i><b>8.1.5</b> Covariance Structures in Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.2</b> Estimation in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#interpretation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.1</b> Interpretation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#derivation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.2</b> Derivation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#bayesian-interpretation-of-linear-mixed-models"><i class="fa fa-check"></i><b>8.2.3</b> Bayesian Interpretation of Linear Mixed Models</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>8.2.4</b> Estimating the Variance-Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.3</b> Inference in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-fixed-effects-beta"><i class="fa fa-check"></i><b>8.3.1</b> Inference for Fixed Effects (<span class="math inline">\(\beta\)</span>)</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-variance-components-theta"><i class="fa fa-check"></i><b>8.3.2</b> Inference for Variance Components (<span class="math inline">\(\theta\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria for Model Selection</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-akaike-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.1</b> Akaike Information Criterion</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-corrected-aic-lmm"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-bayesian-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="8.4.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#practical-example-with-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.4</b> Practical Example with Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#example-setup"><i class="fa fa-check"></i><b>8.5.1</b> Example Setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#statistical-model-for-split-plot-designs"><i class="fa fa-check"></i><b>8.5.2</b> Statistical Model for Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#approaches-to-analyzing-split-plot-designs"><i class="fa fa-check"></i><b>8.5.3</b> Approaches to Analyzing Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-split-plot-design"><i class="fa fa-check"></i><b>8.5.4</b> Application: Split-Plot Design</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html#variance-covariance-structure-power-model"><i class="fa fa-check"></i><b>8.7.1</b> Variance-Covariance Structure: Power Model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html"><i class="fa fa-check"></i><b>8.8</b> Application: Mixed Models in Practice</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-1-pulp-brightness-analysis"><i class="fa fa-check"></i><b>8.8.1</b> Example 1: Pulp Brightness Analysis</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-2-penicillin-yield-glmm-with-blocking"><i class="fa fa-check"></i><b>8.8.2</b> Example 2: Penicillin Yield (GLMM with Blocking)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-3-growth-in-rats-over-time"><i class="fa fa-check"></i><b>8.8.3</b> Example 3: Growth in Rats Over Time</a></li>
<li class="chapter" data-level="8.8.4" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-4-tree-water-use-agridat"><i class="fa fa-check"></i><b>8.8.4</b> Example 4: Tree Water Use (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-nonlinear-and-generalized-linear-mixed-models.html"><a href="sec-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-nonlinear-mixed-models.html"><a href="sec-nonlinear-mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Nonlinear Mixed Models</a></li>
<li class="chapter" data-level="9.2" data-path="sec-generalized-linear-mixed-models.html"><a href="sec-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.2</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="9.3" data-path="relationship-between-nlmms-and-glmms.html"><a href="relationship-between-nlmms-and-glmms.html"><i class="fa fa-check"></i><b>9.3</b> Relationship Between NLMMs and GLMMs</a></li>
<li class="chapter" data-level="9.4" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html"><i class="fa fa-check"></i><b>9.4</b> Marginal Properties of GLMMs</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-mean-of-y_i"><i class="fa fa-check"></i><b>9.4.1</b> Marginal Mean of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-variance-of-y_i"><i class="fa fa-check"></i><b>9.4.2</b> Marginal Variance of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.3" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-covariance-of-mathbfy"><i class="fa fa-check"></i><b>9.4.3</b> Marginal Covariance of <span class="math inline">\(\mathbf{y}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.5</b> Estimation in Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.5.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.5.2" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#sec-estimation-by-linearization-glmm"><i class="fa fa-check"></i><b>9.5.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.5.3" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.5.3</b> Estimation by Bayesian Hierarchical Models</a></li>
<li class="chapter" data-level="9.5.4" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#practical-implementation-in-r"><i class="fa fa-check"></i><b>9.5.4</b> Practical Implementation in R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.6</b> Application: Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-data-cbpp-dataset"><i class="fa fa-check"></i><b>9.6.1</b> Binomial Data: CBPP Dataset</a></li>
<li class="chapter" data-level="9.6.2" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#count-data-owl-dataset"><i class="fa fa-check"></i><b>9.6.2</b> Count Data: Owl Dataset</a></li>
<li class="chapter" data-level="9.6.3" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-example-gotway-hessian-fly-data"><i class="fa fa-check"></i><b>9.6.3</b> Binomial Example: Gotway Hessian Fly Data</a></li>
<li class="chapter" data-level="9.6.4" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#nonlinear-mixed-model-yellow-poplar-data"><i class="fa fa-check"></i><b>9.6.4</b> Nonlinear Mixed Model: Yellow Poplar Data</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-nonparametric-regression.html"><a href="sec-nonparametric-regression.html"><i class="fa fa-check"></i><b>10</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html"><i class="fa fa-check"></i><b>10.1</b> Why Nonparametric?</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html#flexibility"><i class="fa fa-check"></i><b>10.1.1</b> Flexibility</a></li>
<li class="chapter" data-level="10.1.2" data-path="why-nonparametric.html"><a href="why-nonparametric.html#fewer-assumptions"><i class="fa fa-check"></i><b>10.1.2</b> Fewer Assumptions</a></li>
<li class="chapter" data-level="10.1.3" data-path="why-nonparametric.html"><a href="why-nonparametric.html#interpretability"><i class="fa fa-check"></i><b>10.1.3</b> Interpretability</a></li>
<li class="chapter" data-level="10.1.4" data-path="why-nonparametric.html"><a href="why-nonparametric.html#practical-considerations-3"><i class="fa fa-check"></i><b>10.1.4</b> Practical Considerations</a></li>
<li class="chapter" data-level="10.1.5" data-path="why-nonparametric.html"><a href="why-nonparametric.html#balancing-parametric-and-nonparametric-approaches"><i class="fa fa-check"></i><b>10.1.5</b> Balancing Parametric and Nonparametric Approaches</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html"><i class="fa fa-check"></i><b>10.2</b> Basic Concepts in Nonparametric Estimation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>10.2.1</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="10.2.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#kernel-smoothing-and-local-averages"><i class="fa fa-check"></i><b>10.2.2</b> Kernel Smoothing and Local Averages</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html"><i class="fa fa-check"></i><b>10.3</b> Kernel Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#basic-setup"><i class="fa fa-check"></i><b>10.3.1</b> Basic Setup</a></li>
<li class="chapter" data-level="10.3.2" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-nadaraya-watson-kernel-estimator"><i class="fa fa-check"></i><b>10.3.2</b> Nadaraya-Watson Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-priestley-chao-kernel-estimator"><i class="fa fa-check"></i><b>10.3.3</b> Priestley–Chao Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.4" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-gasser-mueller-kernel-estimator"><i class="fa fa-check"></i><b>10.3.4</b> Gasser–Müller Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.5" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#comparison-of-kernel-based-estimators"><i class="fa fa-check"></i><b>10.3.5</b> Comparison of Kernel-Based Estimators</a></li>
<li class="chapter" data-level="10.3.6" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#bandwidth-selection"><i class="fa fa-check"></i><b>10.3.6</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.3.7" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#asymptotic-properties"><i class="fa fa-check"></i><b>10.3.7</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="10.3.8" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#derivation-of-the-nadaraya-watson-estimator"><i class="fa fa-check"></i><b>10.3.8</b> Derivation of the Nadaraya-Watson Estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html"><i class="fa fa-check"></i><b>10.4</b> Local Polynomial Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#local-polynomial-fitting"><i class="fa fa-check"></i><b>10.4.1</b> Local Polynomial Fitting</a></li>
<li class="chapter" data-level="10.4.2" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#mathematical-form-of-the-solution"><i class="fa fa-check"></i><b>10.4.2</b> Mathematical Form of the Solution</a></li>
<li class="chapter" data-level="10.4.3" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bias-variance-and-asymptotics"><i class="fa fa-check"></i><b>10.4.3</b> Bias, Variance, and Asymptotics</a></li>
<li class="chapter" data-level="10.4.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#sec-special-case-local-linear-regression"><i class="fa fa-check"></i><b>10.4.4</b> Special Case: Local Linear Regression</a></li>
<li class="chapter" data-level="10.4.5" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bandwidth-selection-1"><i class="fa fa-check"></i><b>10.4.5</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.4.6" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#asymptotic-properties-summary"><i class="fa fa-check"></i><b>10.4.6</b> Asymptotic Properties Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html"><i class="fa fa-check"></i><b>10.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#properties-and-form-of-the-smoothing-spline"><i class="fa fa-check"></i><b>10.5.1</b> Properties and Form of the Smoothing Spline</a></li>
<li class="chapter" data-level="10.5.2" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#choice-of-lambda"><i class="fa fa-check"></i><b>10.5.2</b> Choice of <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="10.5.3" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#connection-to-reproducing-kernel-hilbert-spaces"><i class="fa fa-check"></i><b>10.5.3</b> Connection to Reproducing Kernel Hilbert Spaces</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.6</b> Confidence Intervals in Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#asymptotic-normality"><i class="fa fa-check"></i><b>10.6.1</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="10.6.2" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#bootstrap-methods"><i class="fa fa-check"></i><b>10.6.2</b> Bootstrap Methods</a></li>
<li class="chapter" data-level="10.6.3" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#practical-considerations-4"><i class="fa fa-check"></i><b>10.6.3</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html"><i class="fa fa-check"></i><b>10.7</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#estimation-via-penalized-likelihood"><i class="fa fa-check"></i><b>10.7.1</b> Estimation via Penalized Likelihood</a></li>
<li class="chapter" data-level="10.7.2" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#interpretation-of-gams"><i class="fa fa-check"></i><b>10.7.2</b> Interpretation of GAMs</a></li>
<li class="chapter" data-level="10.7.3" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#model-selection-and-smoothing-parameter-estimation"><i class="fa fa-check"></i><b>10.7.3</b> Model Selection and Smoothing Parameter Estimation</a></li>
<li class="chapter" data-level="10.7.4" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#extensions-of-gams"><i class="fa fa-check"></i><b>10.7.4</b> Extensions of GAMs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html"><i class="fa fa-check"></i><b>10.8</b> Regression Trees and Random Forests</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-regression-trees"><i class="fa fa-check"></i><b>10.8.1</b> Regression Trees</a></li>
<li class="chapter" data-level="10.8.2" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-random-forests"><i class="fa fa-check"></i><b>10.8.2</b> Random Forests</a></li>
<li class="chapter" data-level="10.8.3" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#theoretical-insights"><i class="fa fa-check"></i><b>10.8.3</b> Theoretical Insights</a></li>
<li class="chapter" data-level="10.8.4" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#feature-importance-in-random-forests"><i class="fa fa-check"></i><b>10.8.4</b> Feature Importance in Random Forests</a></li>
<li class="chapter" data-level="10.8.5" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#advantages-and-limitations-of-tree-based-methods"><i class="fa fa-check"></i><b>10.8.5</b> Advantages and Limitations of Tree-Based Methods</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html"><i class="fa fa-check"></i><b>10.9</b> Wavelet Regression</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-series-expansion"><i class="fa fa-check"></i><b>10.9.1</b> Wavelet Series Expansion</a></li>
<li class="chapter" data-level="10.9.2" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-regression-model"><i class="fa fa-check"></i><b>10.9.2</b> Wavelet Regression Model</a></li>
<li class="chapter" data-level="10.9.3" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-shrinkage-and-thresholding"><i class="fa fa-check"></i><b>10.9.3</b> Wavelet Shrinkage and Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.10</b> Multivariate Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#the-curse-of-dimensionality"><i class="fa fa-check"></i><b>10.10.1</b> The Curse of Dimensionality</a></li>
<li class="chapter" data-level="10.10.2" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-kernel-regression"><i class="fa fa-check"></i><b>10.10.2</b> Multivariate Kernel Regression</a></li>
<li class="chapter" data-level="10.10.3" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-splines"><i class="fa fa-check"></i><b>10.10.3</b> Multivariate Splines</a></li>
<li class="chapter" data-level="10.10.4" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#additive-models-gams"><i class="fa fa-check"></i><b>10.10.4</b> Additive Models (GAMs)</a></li>
<li class="chapter" data-level="10.10.5" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#radial-basis-functions"><i class="fa fa-check"></i><b>10.10.5</b> Radial Basis Functions</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html"><i class="fa fa-check"></i><b>10.11</b> Conclusion: The Evolving Landscape of Regression Analysis</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#key-takeaways-1"><i class="fa fa-check"></i><b>10.11.1</b> Key Takeaways</a></li>
<li class="chapter" data-level="10.11.2" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#the-art-and-science-of-regression"><i class="fa fa-check"></i><b>10.11.2</b> The Art and Science of Regression</a></li>
<li class="chapter" data-level="10.11.3" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#looking-forward"><i class="fa fa-check"></i><b>10.11.3</b> Looking Forward</a></li>
<li class="chapter" data-level="10.11.4" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#final-thoughts"><i class="fa fa-check"></i><b>10.11.4</b> Final Thoughts</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="11" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>11</b> Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>11.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-types.html"><a href="data-types.html#qualitative-vs.-quantitative-data"><i class="fa fa-check"></i><b>11.1.1</b> Qualitative vs. Quantitative Data</a></li>
<li class="chapter" data-level="11.1.2" data-path="data-types.html"><a href="data-types.html#other-ways-to-classify-data"><i class="fa fa-check"></i><b>11.1.2</b> Other Ways to Classify Data</a></li>
<li class="chapter" data-level="11.1.3" data-path="data-types.html"><a href="data-types.html#data-by-observational-structure-over-time"><i class="fa fa-check"></i><b>11.1.3</b> Data by Observational Structure Over Time</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sec-cross-sectional-data.html"><a href="sec-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.2</b> Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html"><i class="fa fa-check"></i><b>11.3</b> Time Series Data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#statistical-properties-of-time-series-models"><i class="fa fa-check"></i><b>11.3.1</b> Statistical Properties of Time Series Models</a></li>
<li class="chapter" data-level="11.3.2" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#common-time-series-processes"><i class="fa fa-check"></i><b>11.3.2</b> Common Time Series Processes</a></li>
<li class="chapter" data-level="11.3.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#deterministic-time-trends"><i class="fa fa-check"></i><b>11.3.3</b> Deterministic Time Trends</a></li>
<li class="chapter" data-level="11.3.4" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#violations-of-exogeneity-in-time-series-models"><i class="fa fa-check"></i><b>11.3.4</b> Violations of Exogeneity in Time Series Models</a></li>
<li class="chapter" data-level="11.3.5" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#consequences-of-exogeneity-violations"><i class="fa fa-check"></i><b>11.3.5</b> Consequences of Exogeneity Violations</a></li>
<li class="chapter" data-level="11.3.6" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#highly-persistent-data"><i class="fa fa-check"></i><b>11.3.6</b> Highly Persistent Data</a></li>
<li class="chapter" data-level="11.3.7" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-unit-root-testing"><i class="fa fa-check"></i><b>11.3.7</b> Unit Root Testing</a></li>
<li class="chapter" data-level="11.3.8" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-newey-west-standard-errors"><i class="fa fa-check"></i><b>11.3.8</b> Newey-West Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.4</b> Repeated Cross-Sectional Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#key-characteristics"><i class="fa fa-check"></i><b>11.4.1</b> Key Characteristics</a></li>
<li class="chapter" data-level="11.4.2" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#statistical-modeling-for-repeated-cross-sections"><i class="fa fa-check"></i><b>11.4.2</b> Statistical Modeling for Repeated Cross-Sections</a></li>
<li class="chapter" data-level="11.4.3" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#advantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.3</b> Advantages of Repeated Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.4.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#disadvantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.4</b> Disadvantages of Repeated Cross-Sectional Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html"><i class="fa fa-check"></i><b>11.5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sec-panel-data.html"><a href="sec-panel-data.html#advantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.1</b> Advantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.2" data-path="sec-panel-data.html"><a href="sec-panel-data.html#disadvantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.2</b> Disadvantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.3" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sources-of-variation-in-panel-data"><i class="fa fa-check"></i><b>11.5.3</b> Sources of Variation in Panel Data</a></li>
<li class="chapter" data-level="11.5.4" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-pooled-ols-estimator"><i class="fa fa-check"></i><b>11.5.4</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="11.5.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>11.5.5</b> Individual-Specific Effects Model</a></li>
<li class="chapter" data-level="11.5.6" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-random-effects-estimator"><i class="fa fa-check"></i><b>11.5.6</b> Random Effects Estimator</a></li>
<li class="chapter" data-level="11.5.7" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-fixed-effects-estimator"><i class="fa fa-check"></i><b>11.5.7</b> Fixed Effects Estimator</a></li>
<li class="chapter" data-level="11.5.8" data-path="sec-panel-data.html"><a href="sec-panel-data.html#tests-for-assumptions-in-panel-data-analysis"><i class="fa fa-check"></i><b>11.5.8</b> Tests for Assumptions in Panel Data Analysis</a></li>
<li class="chapter" data-level="11.5.9" data-path="sec-panel-data.html"><a href="sec-panel-data.html#model-selection-in-panel-data"><i class="fa fa-check"></i><b>11.5.9</b> Model Selection in Panel Data</a></li>
<li class="chapter" data-level="11.5.10" data-path="sec-panel-data.html"><a href="sec-panel-data.html#alternative-estimators"><i class="fa fa-check"></i><b>11.5.10</b> Alternative Estimators</a></li>
<li class="chapter" data-level="11.5.11" data-path="sec-panel-data.html"><a href="sec-panel-data.html#application-1"><i class="fa fa-check"></i><b>11.5.11</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="choosing-the-right-type-of-data.html"><a href="choosing-the-right-type-of-data.html"><i class="fa fa-check"></i><b>11.6</b> Choosing the Right Type of Data</a></li>
<li class="chapter" data-level="11.7" data-path="data-quality-and-ethical-considerations.html"><a href="data-quality-and-ethical-considerations.html"><i class="fa fa-check"></i><b>11.7</b> Data Quality and Ethical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>12</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>12.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization-z-score-normalization"><i class="fa fa-check"></i><b>12.1.1</b> Standardization (Z-score Normalization)</a></li>
<li class="chapter" data-level="12.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling-normalization"><i class="fa fa-check"></i><b>12.1.2</b> Min-Max Scaling (Normalization)</a></li>
<li class="chapter" data-level="12.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-root-and-cube-root-transformations"><i class="fa fa-check"></i><b>12.1.3</b> Square Root and Cube Root Transformations</a></li>
<li class="chapter" data-level="12.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-logarithmic-transformation"><i class="fa fa-check"></i><b>12.1.4</b> Logarithmic Transformation</a></li>
<li class="chapter" data-level="12.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential-transformation"><i class="fa fa-check"></i><b>12.1.5</b> Exponential Transformation</a></li>
<li class="chapter" data-level="12.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-transformation"><i class="fa fa-check"></i><b>12.1.6</b> Power Transformation</a></li>
<li class="chapter" data-level="12.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-reciprocal-transformation"><i class="fa fa-check"></i><b>12.1.7</b> Inverse (Reciprocal) Transformation</a></li>
<li class="chapter" data-level="12.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine-transformation"><i class="fa fa-check"></i><b>12.1.8</b> Hyperbolic Arcsine Transformation</a></li>
<li class="chapter" data-level="12.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-normalization-rank-based-transformation"><i class="fa fa-check"></i><b>12.1.9</b> Ordered Quantile Normalization (Rank-Based Transformation)</a></li>
<li class="chapter" data-level="12.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>12.1.10</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="12.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-transformation"><i class="fa fa-check"></i><b>12.1.11</b> Inverse Hyperbolic Sine Transformation</a></li>
<li class="chapter" data-level="12.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-box-cox-transformation"><i class="fa fa-check"></i><b>12.1.12</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="12.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>12.1.13</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="12.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss-transformation"><i class="fa fa-check"></i><b>12.1.14</b> RankGauss Transformation</a></li>
<li class="chapter" data-level="12.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#automatically-choosing-the-best-transformation"><i class="fa fa-check"></i><b>12.1.15</b> Automatically Choosing the Best Transformation</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>12.2</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="categorical-variables.html"><a href="categorical-variables.html#one-hot-encoding-dummy-variables"><i class="fa fa-check"></i><b>12.2.1</b> One-Hot Encoding (Dummy Variables)</a></li>
<li class="chapter" data-level="12.2.2" data-path="categorical-variables.html"><a href="categorical-variables.html#label-encoding"><i class="fa fa-check"></i><b>12.2.2</b> Label Encoding</a></li>
<li class="chapter" data-level="12.2.3" data-path="categorical-variables.html"><a href="categorical-variables.html#feature-hashing-hash-encoding"><i class="fa fa-check"></i><b>12.2.3</b> Feature Hashing (Hash Encoding)</a></li>
<li class="chapter" data-level="12.2.4" data-path="categorical-variables.html"><a href="categorical-variables.html#binary-encoding"><i class="fa fa-check"></i><b>12.2.4</b> Binary Encoding</a></li>
<li class="chapter" data-level="12.2.5" data-path="categorical-variables.html"><a href="categorical-variables.html#base-n-encoding-generalized-binary-encoding"><i class="fa fa-check"></i><b>12.2.5</b> Base-N Encoding (Generalized Binary Encoding)</a></li>
<li class="chapter" data-level="12.2.6" data-path="categorical-variables.html"><a href="categorical-variables.html#frequency-encoding"><i class="fa fa-check"></i><b>12.2.6</b> Frequency Encoding</a></li>
<li class="chapter" data-level="12.2.7" data-path="categorical-variables.html"><a href="categorical-variables.html#target-encoding-mean-encoding"><i class="fa fa-check"></i><b>12.2.7</b> Target Encoding (Mean Encoding)</a></li>
<li class="chapter" data-level="12.2.8" data-path="categorical-variables.html"><a href="categorical-variables.html#ordinal-encoding"><i class="fa fa-check"></i><b>12.2.8</b> Ordinal Encoding</a></li>
<li class="chapter" data-level="12.2.9" data-path="categorical-variables.html"><a href="categorical-variables.html#weight-of-evidence-encoding"><i class="fa fa-check"></i><b>12.2.9</b> Weight of Evidence Encoding</a></li>
<li class="chapter" data-level="12.2.10" data-path="categorical-variables.html"><a href="categorical-variables.html#helmert-encoding"><i class="fa fa-check"></i><b>12.2.10</b> Helmert Encoding</a></li>
<li class="chapter" data-level="12.2.11" data-path="categorical-variables.html"><a href="categorical-variables.html#probability-ratio-encoding"><i class="fa fa-check"></i><b>12.2.11</b> Probability Ratio Encoding</a></li>
<li class="chapter" data-level="12.2.12" data-path="categorical-variables.html"><a href="categorical-variables.html#backward-difference-encoding"><i class="fa fa-check"></i><b>12.2.12</b> Backward Difference Encoding</a></li>
<li class="chapter" data-level="12.2.13" data-path="categorical-variables.html"><a href="categorical-variables.html#leave-one-out-encoding"><i class="fa fa-check"></i><b>12.2.13</b> Leave-One-Out Encoding</a></li>
<li class="chapter" data-level="12.2.14" data-path="categorical-variables.html"><a href="categorical-variables.html#james-stein-encoding"><i class="fa fa-check"></i><b>12.2.14</b> James-Stein Encoding</a></li>
<li class="chapter" data-level="12.2.15" data-path="categorical-variables.html"><a href="categorical-variables.html#m-estimator-encoding"><i class="fa fa-check"></i><b>12.2.15</b> M-Estimator Encoding</a></li>
<li class="chapter" data-level="12.2.16" data-path="categorical-variables.html"><a href="categorical-variables.html#thermometer-encoding"><i class="fa fa-check"></i><b>12.2.16</b> Thermometer Encoding</a></li>
<li class="chapter" data-level="12.2.17" data-path="categorical-variables.html"><a href="categorical-variables.html#choosing-the-right-encoding-method"><i class="fa fa-check"></i><b>12.2.17</b> Choosing the Right Encoding Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>13</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html"><i class="fa fa-check"></i><b>13.1</b> Introduction to Missing Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#types-of-imputation"><i class="fa fa-check"></i><b>13.1.1</b> Types of Imputation</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#when-and-why-to-use-imputation"><i class="fa fa-check"></i><b>13.1.2</b> When and Why to Use Imputation</a></li>
<li class="chapter" data-level="13.1.3" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#importance-of-missing-data-treatment-in-statistical-modeling"><i class="fa fa-check"></i><b>13.1.3</b> Importance of Missing Data Treatment in Statistical Modeling</a></li>
<li class="chapter" data-level="13.1.4" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#prevalence-of-missing-data-across-domains"><i class="fa fa-check"></i><b>13.1.4</b> Prevalence of Missing Data Across Domains</a></li>
<li class="chapter" data-level="13.1.5" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#practical-considerations-for-imputation"><i class="fa fa-check"></i><b>13.1.5</b> Practical Considerations for Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html"><i class="fa fa-check"></i><b>13.2</b> Theoretical Foundations of Missing Data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#definition-and-classification-of-missing-data"><i class="fa fa-check"></i><b>13.2.1</b> Definition and Classification of Missing Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>13.2.2</b> Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.2.3" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#relationship-between-mechanisms-and-ignorability"><i class="fa fa-check"></i><b>13.2.3</b> Relationship Between Mechanisms and Ignorability</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html"><i class="fa fa-check"></i><b>13.3</b> Diagnosing the Missing Data Mechanism</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#descriptive-methods"><i class="fa fa-check"></i><b>13.3.1</b> Descriptive Methods</a></li>
<li class="chapter" data-level="13.3.2" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#statistical-tests-for-missing-data-mechanisms"><i class="fa fa-check"></i><b>13.3.2</b> Statistical Tests for Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.3.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#assessing-mar-and-mnar"><i class="fa fa-check"></i><b>13.3.3</b> Assessing MAR and MNAR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html"><i class="fa fa-check"></i><b>13.4</b> Methods for Handling Missing Data</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#basic-methods"><i class="fa fa-check"></i><b>13.4.1</b> Basic Methods</a></li>
<li class="chapter" data-level="13.4.2" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#single-imputation-techniques"><i class="fa fa-check"></i><b>13.4.2</b> Single Imputation Techniques</a></li>
<li class="chapter" data-level="13.4.3" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#machine-learning-and-modern-approaches"><i class="fa fa-check"></i><b>13.4.3</b> Machine Learning and Modern Approaches</a></li>
<li class="chapter" data-level="13.4.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>13.4.4</b> Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html"><i class="fa fa-check"></i><b>13.5</b> Evaluation of Imputation Methods</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#statistical-metrics-for-assessing-imputation-quality"><i class="fa fa-check"></i><b>13.5.1</b> Statistical Metrics for Assessing Imputation Quality</a></li>
<li class="chapter" data-level="13.5.2" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#bias-variance-tradeoff-in-imputation"><i class="fa fa-check"></i><b>13.5.2</b> Bias-Variance Tradeoff in Imputation</a></li>
<li class="chapter" data-level="13.5.3" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>13.5.3</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="13.5.4" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#validation-using-simulated-data-and-real-world-case-studies"><i class="fa fa-check"></i><b>13.5.4</b> Validation Using Simulated Data and Real-World Case Studies</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>13.6</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="13.7" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html"><i class="fa fa-check"></i><b>13.7</b> Challenges and Ethical Considerations</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#challenges-in-high-dimensional-data"><i class="fa fa-check"></i><b>13.7.1</b> Challenges in High-Dimensional Data</a></li>
<li class="chapter" data-level="13.7.2" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#missing-data-in-big-data-contexts"><i class="fa fa-check"></i><b>13.7.2</b> Missing Data in Big Data Contexts</a></li>
<li class="chapter" data-level="13.7.3" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#ethical-concerns"><i class="fa fa-check"></i><b>13.7.3</b> Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html"><i class="fa fa-check"></i><b>13.8</b> Emerging Trends in Missing Data Handling</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#advances-in-neural-network-approaches"><i class="fa fa-check"></i><b>13.8.1</b> Advances in Neural Network Approaches</a></li>
<li class="chapter" data-level="13.8.2" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#integration-with-reinforcement-learning"><i class="fa fa-check"></i><b>13.8.2</b> Integration with Reinforcement Learning</a></li>
<li class="chapter" data-level="13.8.3" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#synthetic-data-generation-for-missing-data"><i class="fa fa-check"></i><b>13.8.3</b> Synthetic Data Generation for Missing Data</a></li>
<li class="chapter" data-level="13.8.4" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#federated-learning-and-privacy-preserving-imputation"><i class="fa fa-check"></i><b>13.8.4</b> Federated Learning and Privacy-Preserving Imputation</a></li>
<li class="chapter" data-level="13.8.5" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#imputation-in-streaming-and-online-data-environments"><i class="fa fa-check"></i><b>13.8.5</b> Imputation in Streaming and Online Data Environments</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html"><i class="fa fa-check"></i><b>13.9</b> Application of Imputation</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="application-of-imputation.html"><a href="application-of-imputation.html#visualizing-missing-data"><i class="fa fa-check"></i><b>13.9.1</b> Visualizing Missing Data</a></li>
<li class="chapter" data-level="13.9.2" data-path="application-of-imputation.html"><a href="application-of-imputation.html#how-many-imputations"><i class="fa fa-check"></i><b>13.9.2</b> How Many Imputations?</a></li>
<li class="chapter" data-level="13.9.3" data-path="application-of-imputation.html"><a href="application-of-imputation.html#generating-missing-data-for-demonstration"><i class="fa fa-check"></i><b>13.9.3</b> Generating Missing Data for Demonstration</a></li>
<li class="chapter" data-level="13.9.4" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-mean-median-and-mode"><i class="fa fa-check"></i><b>13.9.4</b> Imputation with Mean, Median, and Mode</a></li>
<li class="chapter" data-level="13.9.5" data-path="application-of-imputation.html"><a href="application-of-imputation.html#k-nearest-neighbors-knn-imputation"><i class="fa fa-check"></i><b>13.9.5</b> K-Nearest Neighbors (KNN) Imputation</a></li>
<li class="chapter" data-level="13.9.6" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-decision-trees-rpart"><i class="fa fa-check"></i><b>13.9.6</b> Imputation with Decision Trees (rpart)</a></li>
<li class="chapter" data-level="13.9.7" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>13.9.7</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="13.9.8" data-path="application-of-imputation.html"><a href="application-of-imputation.html#amelia"><i class="fa fa-check"></i><b>13.9.8</b> Amelia</a></li>
<li class="chapter" data-level="13.9.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html#missforest"><i class="fa fa-check"></i><b>13.9.9</b> missForest</a></li>
<li class="chapter" data-level="13.9.10" data-path="application-of-imputation.html"><a href="application-of-imputation.html#hmisc"><i class="fa fa-check"></i><b>13.9.10</b> Hmisc</a></li>
<li class="chapter" data-level="13.9.11" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mi"><i class="fa fa-check"></i><b>13.9.11</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="model-specification-tests.html"><a href="model-specification-tests.html"><i class="fa fa-check"></i><b>14</b> Model Specification Tests</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html"><i class="fa fa-check"></i><b>14.1</b> Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-wald-test-nested"><i class="fa fa-check"></i><b>14.1.1</b> Wald Test</a></li>
<li class="chapter" data-level="14.1.2" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-likelihood-ratio-test-nested"><i class="fa fa-check"></i><b>14.1.2</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="14.1.3" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-f-test-for-linear-regression-nested"><i class="fa fa-check"></i><b>14.1.3</b> F-Test (for Linear Regression)</a></li>
<li class="chapter" data-level="14.1.4" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-chow-test"><i class="fa fa-check"></i><b>14.1.4</b> Chow Test</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html"><i class="fa fa-check"></i><b>14.2</b> Non-Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-vuong-test"><i class="fa fa-check"></i><b>14.2.1</b> Vuong Test</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-davidson--mackinnon-j-test"><i class="fa fa-check"></i><b>14.2.2</b> Davidson–MacKinnon J-Test</a></li>
<li class="chapter" data-level="14.2.3" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#adjusted-r2"><i class="fa fa-check"></i><b>14.2.3</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="14.2.4" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#comparing-models-with-transformed-dependent-variables"><i class="fa fa-check"></i><b>14.2.4</b> Comparing Models with Transformed Dependent Variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html"><i class="fa fa-check"></i><b>14.3</b> Heteroskedasticity Tests</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-breusch--pagan-test"><i class="fa fa-check"></i><b>14.3.1</b> Breusch–Pagan Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-white-test-hetero"><i class="fa fa-check"></i><b>14.3.2</b> White Test</a></li>
<li class="chapter" data-level="14.3.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-goldfeld--quandt-test"><i class="fa fa-check"></i><b>14.3.3</b> Goldfeld–Quandt Test</a></li>
<li class="chapter" data-level="14.3.4" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-park-test"><i class="fa fa-check"></i><b>14.3.4</b> Park Test</a></li>
<li class="chapter" data-level="14.3.5" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-glejser-test"><i class="fa fa-check"></i><b>14.3.5</b> Glejser Test</a></li>
<li class="chapter" data-level="14.3.6" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#summary-of-heteroskedasticity-tests"><i class="fa fa-check"></i><b>14.3.6</b> Summary of Heteroskedasticity Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html"><i class="fa fa-check"></i><b>14.4</b> Functional Form Tests</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-ramsey-reset-test"><i class="fa fa-check"></i><b>14.4.1</b> Ramsey RESET Test (Regression Equation Specification Error Test)</a></li>
<li class="chapter" data-level="14.4.2" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-harvey--collier-test"><i class="fa fa-check"></i><b>14.4.2</b> Harvey–Collier Test</a></li>
<li class="chapter" data-level="14.4.3" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-rainbow-test"><i class="fa fa-check"></i><b>14.4.3</b> Rainbow Test</a></li>
<li class="chapter" data-level="14.4.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html#summary-of-functional-form-tests"><i class="fa fa-check"></i><b>14.4.4</b> Summary of Functional Form Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html"><i class="fa fa-check"></i><b>14.5</b> Autocorrelation Tests</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-durbin--watson-test"><i class="fa fa-check"></i><b>14.5.1</b> Durbin–Watson Test</a></li>
<li class="chapter" data-level="14.5.2" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-breusch--godfrey-test"><i class="fa fa-check"></i><b>14.5.2</b> Breusch–Godfrey Test</a></li>
<li class="chapter" data-level="14.5.3" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-ljung--box-test"><i class="fa fa-check"></i><b>14.5.3</b> Ljung–Box Test (or Box–Pierce Test)</a></li>
<li class="chapter" data-level="14.5.4" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-runs-test"><i class="fa fa-check"></i><b>14.5.4</b> Runs Test</a></li>
<li class="chapter" data-level="14.5.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#summary-of-autocorrelation-tests"><i class="fa fa-check"></i><b>14.5.5</b> Summary of Autocorrelation Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html"><i class="fa fa-check"></i><b>14.6</b> Multicollinearity Diagnostics</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-variance-inflation-factor"><i class="fa fa-check"></i><b>14.6.1</b> Variance Inflation Factor</a></li>
<li class="chapter" data-level="14.6.2" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-tolerance-statistic"><i class="fa fa-check"></i><b>14.6.2</b> Tolerance Statistic</a></li>
<li class="chapter" data-level="14.6.3" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-condition-index-and-eigenvalue-decomposition"><i class="fa fa-check"></i><b>14.6.3</b> Condition Index and Eigenvalue Decomposition</a></li>
<li class="chapter" data-level="14.6.4" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-pairwise-correlation-matrix"><i class="fa fa-check"></i><b>14.6.4</b> Pairwise Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.5" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-determinant-of-the-correlation-matrix"><i class="fa fa-check"></i><b>14.6.5</b> Determinant of the Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#summary-of-multicollinearity-diagnostics"><i class="fa fa-check"></i><b>14.6.6</b> Summary of Multicollinearity Diagnostics</a></li>
<li class="chapter" data-level="14.6.7" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#addressing-multicollinearity"><i class="fa fa-check"></i><b>14.6.7</b> Addressing Multicollinearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>15</b> Variable Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html"><i class="fa fa-check"></i><b>15.1</b> Filter Methods (Statistical Criteria, Model-Agnostic)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#information-criteria-based-selection"><i class="fa fa-check"></i><b>15.1.1</b> Information Criteria-Based Selection</a></li>
<li class="chapter" data-level="15.1.2" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#univariate-selection-methods"><i class="fa fa-check"></i><b>15.1.2</b> Univariate Selection Methods</a></li>
<li class="chapter" data-level="15.1.3" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#correlation-based-feature-selection"><i class="fa fa-check"></i><b>15.1.3</b> Correlation-Based Feature Selection</a></li>
<li class="chapter" data-level="15.1.4" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#variance-thresholding"><i class="fa fa-check"></i><b>15.1.4</b> Variance Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html"><i class="fa fa-check"></i><b>15.2</b> Wrapper Methods (Model-Based Subset Evaluation)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#best-subsets-algorithm-1"><i class="fa fa-check"></i><b>15.2.1</b> Best Subsets Algorithm</a></li>
<li class="chapter" data-level="15.2.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#stepwise-selection-methods-1"><i class="fa fa-check"></i><b>15.2.2</b> Stepwise Selection Methods</a></li>
<li class="chapter" data-level="15.2.3" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#branch-and-bound-algorithm-1"><i class="fa fa-check"></i><b>15.2.3</b> Branch-and-Bound Algorithm</a></li>
<li class="chapter" data-level="15.2.4" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#recursive-feature-elimination"><i class="fa fa-check"></i><b>15.2.4</b> Recursive Feature Elimination</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html"><i class="fa fa-check"></i><b>15.3</b> Embedded Methods (Integrated into Model Training)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#regularization-based-selection"><i class="fa fa-check"></i><b>15.3.1</b> Regularization-Based Selection</a></li>
<li class="chapter" data-level="15.3.2" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#tree-based-feature-importance"><i class="fa fa-check"></i><b>15.3.2</b> Tree-Based Feature Importance</a></li>
<li class="chapter" data-level="15.3.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#genetic-algorithms-1"><i class="fa fa-check"></i><b>15.3.3</b> Genetic Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="summary-table-1.html"><a href="summary-table-1.html"><i class="fa fa-check"></i><b>15.4</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>16</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>16.1</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#error-types-in-hypothesis-testing"><i class="fa fa-check"></i><b>16.1.1</b> Error Types in Hypothesis Testing</a></li>
<li class="chapter" data-level="16.1.2" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#hypothesis-testing-framework-1"><i class="fa fa-check"></i><b>16.1.2</b> Hypothesis Testing Framework</a></li>
<li class="chapter" data-level="16.1.3" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#interpreting-hypothesis-testing-results"><i class="fa fa-check"></i><b>16.1.3</b> Interpreting Hypothesis Testing Results</a></li>
<li class="chapter" data-level="16.1.4" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#understanding-p-values"><i class="fa fa-check"></i><b>16.1.4</b> Understanding p-Values</a></li>
<li class="chapter" data-level="16.1.5" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#the-role-of-sample-size"><i class="fa fa-check"></i><b>16.1.5</b> The Role of Sample Size</a></li>
<li class="chapter" data-level="16.1.6" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#p-value-hacking"><i class="fa fa-check"></i><b>16.1.6</b> p-Value Hacking</a></li>
<li class="chapter" data-level="16.1.7" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#practical-vs.-statistical-significance"><i class="fa fa-check"></i><b>16.1.7</b> Practical vs. Statistical Significance</a></li>
<li class="chapter" data-level="16.1.8" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#mitigating-the-misuse-of-p-values"><i class="fa fa-check"></i><b>16.1.8</b> Mitigating the Misuse of p-Values</a></li>
<li class="chapter" data-level="16.1.9" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-wald-test"><i class="fa fa-check"></i><b>16.1.9</b> Wald Test</a></li>
<li class="chapter" data-level="16.1.10" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-likelihood-ratio-test"><i class="fa fa-check"></i><b>16.1.10</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="16.1.11" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#lagrange-multiplier-score"><i class="fa fa-check"></i><b>16.1.11</b> Lagrange Multiplier (Score) Test</a></li>
<li class="chapter" data-level="16.1.12" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#comparing-hypothesis-tests"><i class="fa fa-check"></i><b>16.1.12</b> Comparing Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html"><i class="fa fa-check"></i><b>16.2</b> Two One-Sided Tests Equivalence Testing</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-to-use-tost"><i class="fa fa-check"></i><b>16.2.1</b> When to Use TOST?</a></li>
<li class="chapter" data-level="16.2.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#interpretation-of-the-tost-procedure"><i class="fa fa-check"></i><b>16.2.2</b> Interpretation of the TOST Procedure</a></li>
<li class="chapter" data-level="16.2.3" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#relationship-to-confidence-intervals"><i class="fa fa-check"></i><b>16.2.3</b> Relationship to Confidence Intervals</a></li>
<li class="chapter" data-level="16.2.4" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#example-1-testing-the-equivalence-of-two-means"><i class="fa fa-check"></i><b>16.2.4</b> Example 1: Testing the Equivalence of Two Means</a></li>
<li class="chapter" data-level="16.2.5" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#advantages-of-tost-equivalence-testing"><i class="fa fa-check"></i><b>16.2.5</b> Advantages of TOST Equivalence Testing</a></li>
<li class="chapter" data-level="16.2.6" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-not-to-use-tost"><i class="fa fa-check"></i><b>16.2.6</b> When <em>Not</em> to Use TOST</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html"><i class="fa fa-check"></i><b>16.3</b> False Discovery Rate</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-hochberg-procedure"><i class="fa fa-check"></i><b>16.3.1</b> Benjamini-Hochberg Procedure</a></li>
<li class="chapter" data-level="16.3.2" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-yekutieli-procedure"><i class="fa fa-check"></i><b>16.3.2</b> Benjamini-Yekutieli Procedure</a></li>
<li class="chapter" data-level="16.3.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-storeys-q-value-approach"><i class="fa fa-check"></i><b>16.3.3</b> Storey’s q-value Approach</a></li>
<li class="chapter" data-level="16.3.4" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#summary-false-discovery-rate-methods"><i class="fa fa-check"></i><b>16.3.4</b> Summary: False Discovery Rate Methods</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="comparison-of-testing-frameworks.html"><a href="comparison-of-testing-frameworks.html"><i class="fa fa-check"></i><b>16.4</b> Comparison of Testing Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-marginal-effects.html"><a href="sec-marginal-effects.html"><i class="fa fa-check"></i><b>17</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html"><i class="fa fa-check"></i><b>17.1</b> Definition of Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-analytical-derivation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.1</b> Analytical Derivation of Marginal Effects</a></li>
<li class="chapter" data-level="17.1.2" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-numerical-approximation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.2</b> Numerical Approximation of Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="marginal-effects-in-different-contexts.html"><a href="marginal-effects-in-different-contexts.html"><i class="fa fa-check"></i><b>17.2</b> Marginal Effects in Different Contexts</a></li>
<li class="chapter" data-level="17.3" data-path="marginal-effects-interpretation.html"><a href="marginal-effects-interpretation.html"><i class="fa fa-check"></i><b>17.3</b> Marginal Effects Interpretation</a></li>
<li class="chapter" data-level="17.4" data-path="sec-delta-method.html"><a href="sec-delta-method.html"><i class="fa fa-check"></i><b>17.4</b> Delta Method</a></li>
<li class="chapter" data-level="17.5" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html"><i class="fa fa-check"></i><b>17.5</b> Comparison: Delta Method vs. Alternative Approaches</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html#example-applying-the-delta-method-in-a-logistic-regression"><i class="fa fa-check"></i><b>17.5.1</b> Example: Applying the Delta Method in a logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html"><i class="fa fa-check"></i><b>17.6</b> Types of Marginal Effect</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-average-marginal-effect"><i class="fa fa-check"></i><b>17.6.1</b> Average Marginal Effect</a></li>
<li class="chapter" data-level="17.6.2" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-mean"><i class="fa fa-check"></i><b>17.6.2</b> Marginal Effects at the Mean</a></li>
<li class="chapter" data-level="17.6.3" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-average"><i class="fa fa-check"></i><b>17.6.3</b> Marginal Effects at the Average</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html"><i class="fa fa-check"></i><b>17.7</b> Packages for Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#marginaleffects-package-recommended"><i class="fa fa-check"></i><b>17.7.1</b> <code>marginaleffects</code> Package (Recommended)</a></li>
<li class="chapter" data-level="17.7.2" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#margins-package"><i class="fa fa-check"></i><b>17.7.2</b> <code>margins</code> Package</a></li>
<li class="chapter" data-level="17.7.3" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#mfx-package"><i class="fa fa-check"></i><b>17.7.3</b> <code>mfx</code> Package</a></li>
<li class="chapter" data-level="17.7.4" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#comparison-of-packages"><i class="fa fa-check"></i><b>17.7.4</b> Comparison of Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>18</b> Moderation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="types-of-moderation-analyses.html"><a href="types-of-moderation-analyses.html"><i class="fa fa-check"></i><b>18.1</b> Types of Moderation Analyses</a></li>
<li class="chapter" data-level="18.2" data-path="key-terminology.html"><a href="key-terminology.html"><i class="fa fa-check"></i><b>18.2</b> Key Terminology</a></li>
<li class="chapter" data-level="18.3" data-path="moderation-model.html"><a href="moderation-model.html"><i class="fa fa-check"></i><b>18.3</b> Moderation Model</a></li>
<li class="chapter" data-level="18.4" data-path="types-of-interactions.html"><a href="types-of-interactions.html"><i class="fa fa-check"></i><b>18.4</b> Types of Interactions</a></li>
<li class="chapter" data-level="18.5" data-path="three-way-interactions.html"><a href="three-way-interactions.html"><i class="fa fa-check"></i><b>18.5</b> Three-Way Interactions</a></li>
<li class="chapter" data-level="18.6" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18.6</b> Additional Resources</a></li>
<li class="chapter" data-level="18.7" data-path="application-2.html"><a href="application-2.html"><i class="fa fa-check"></i><b>18.7</b> Application</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="application-2.html"><a href="application-2.html#emmeans-package"><i class="fa fa-check"></i><b>18.7.1</b> <code>emmeans</code> Package</a></li>
<li class="chapter" data-level="18.7.2" data-path="application-2.html"><a href="application-2.html#probemod-package"><i class="fa fa-check"></i><b>18.7.2</b> <code>probemod</code> Package</a></li>
<li class="chapter" data-level="18.7.3" data-path="application-2.html"><a href="application-2.html#interactions-package"><i class="fa fa-check"></i><b>18.7.3</b> <code>interactions</code> Package</a></li>
<li class="chapter" data-level="18.7.4" data-path="application-2.html"><a href="application-2.html#interactionr-package"><i class="fa fa-check"></i><b>18.7.4</b> <code>interactionR</code> Package</a></li>
<li class="chapter" data-level="18.7.5" data-path="application-2.html"><a href="application-2.html#sjplot-package"><i class="fa fa-check"></i><b>18.7.5</b> <code>sjPlot</code> Package</a></li>
<li class="chapter" data-level="18.7.6" data-path="application-2.html"><a href="application-2.html#summary-of-moderation-analysis-packages"><i class="fa fa-check"></i><b>18.7.6</b> Summary of Moderation Analysis Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>19</b> Mediation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>19.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#steps-in-the-traditional-mediation-model"><i class="fa fa-check"></i><b>19.1.1</b> Steps in the Traditional Mediation Model</a></li>
<li class="chapter" data-level="19.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#graphical-representation-of-mediation"><i class="fa fa-check"></i><b>19.1.2</b> Graphical Representation of Mediation</a></li>
<li class="chapter" data-level="19.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#measuring-mediation"><i class="fa fa-check"></i><b>19.1.3</b> Measuring Mediation</a></li>
<li class="chapter" data-level="19.1.4" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-linear-mediation-models"><i class="fa fa-check"></i><b>19.1.4</b> Assumptions in Linear Mediation Models</a></li>
<li class="chapter" data-level="19.1.5" data-path="traditional-approach.html"><a href="traditional-approach.html#testing-for-mediation"><i class="fa fa-check"></i><b>19.1.5</b> Testing for Mediation</a></li>
<li class="chapter" data-level="19.1.6" data-path="traditional-approach.html"><a href="traditional-approach.html#additional-considerations"><i class="fa fa-check"></i><b>19.1.6</b> Additional Considerations</a></li>
<li class="chapter" data-level="19.1.7" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-mediation-analysis"><i class="fa fa-check"></i><b>19.1.7</b> Assumptions in Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.8" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>19.1.8</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="19.1.9" data-path="traditional-approach.html"><a href="traditional-approach.html#power-analysis-for-mediation"><i class="fa fa-check"></i><b>19.1.9</b> Power Analysis for Mediation</a></li>
<li class="chapter" data-level="19.1.10" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation-analysis"><i class="fa fa-check"></i><b>19.1.10</b> Multiple Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.11" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-treatments-in-mediation"><i class="fa fa-check"></i><b>19.1.11</b> Multiple Treatments in Mediation</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html"><i class="fa fa-check"></i><b>19.2</b> Causal Inference Approach to Mediation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#sec-example-traditional-mediation-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Example: Traditional Mediation Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#two-approaches-in-causal-mediation-analysis"><i class="fa fa-check"></i><b>19.2.2</b> Two Approaches in Causal Mediation Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>20</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html"><i class="fa fa-check"></i><b>20.1</b> Conceptual Framing</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html#predictive-modeling"><i class="fa fa-check"></i><b>20.1.1</b> Predictive Modeling</a></li>
<li class="chapter" data-level="20.1.2" data-path="conceptual-framing.html"><a href="conceptual-framing.html#estimation-or-causal-inference"><i class="fa fa-check"></i><b>20.1.2</b> Estimation or Causal Inference</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html"><i class="fa fa-check"></i><b>20.2</b> Mathematical Setup</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="mathematical-setup.html"><a href="mathematical-setup.html#probability-space-and-data"><i class="fa fa-check"></i><b>20.2.1</b> Probability Space and Data</a></li>
<li class="chapter" data-level="20.2.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html#loss-functions-and-risk"><i class="fa fa-check"></i><b>20.2.2</b> Loss Functions and Risk</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html"><i class="fa fa-check"></i><b>20.3</b> Prediction in Detail</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#empirical-risk-minimization-and-generalization"><i class="fa fa-check"></i><b>20.3.1</b> Empirical Risk Minimization and Generalization</a></li>
<li class="chapter" data-level="20.3.2" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>20.3.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="20.3.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#example-linear-regression-for-prediction"><i class="fa fa-check"></i><b>20.3.3</b> Example: Linear Regression for Prediction</a></li>
<li class="chapter" data-level="20.3.4" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#applications-in-economics"><i class="fa fa-check"></i><b>20.3.4</b> Applications in Economics</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html"><i class="fa fa-check"></i><b>20.4</b> Parameter Estimation and Causal Inference</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#estimation-in-parametric-models"><i class="fa fa-check"></i><b>20.4.1</b> Estimation in Parametric Models</a></li>
<li class="chapter" data-level="20.4.2" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#causal-inference-fundamentals"><i class="fa fa-check"></i><b>20.4.2</b> Causal Inference Fundamentals</a></li>
<li class="chapter" data-level="20.4.3" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#role-of-identification"><i class="fa fa-check"></i><b>20.4.3</b> Role of Identification</a></li>
<li class="chapter" data-level="20.4.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#challenges-1"><i class="fa fa-check"></i><b>20.4.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>20.5</b> Causation versus Prediction</a></li>
<li class="chapter" data-level="20.6" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html"><i class="fa fa-check"></i><b>20.6</b> Illustrative Equations and Mathematical Contrasts</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#risk-minimization-vs.-consistency"><i class="fa fa-check"></i><b>20.6.1</b> Risk Minimization vs. Consistency</a></li>
<li class="chapter" data-level="20.6.2" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#partial-derivatives-vs.-predictions"><i class="fa fa-check"></i><b>20.6.2</b> Partial Derivatives vs. Predictions</a></li>
<li class="chapter" data-level="20.6.3" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#example-high-dimensional-regularization"><i class="fa fa-check"></i><b>20.6.3</b> Example: High-Dimensional Regularization</a></li>
<li class="chapter" data-level="20.6.4" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#potential-outcomes-notation"><i class="fa fa-check"></i><b>20.6.4</b> Potential Outcomes Notation</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html"><i class="fa fa-check"></i><b>20.7</b> Extended Mathematical Points</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#m-estimation-and-asymptotic-theory"><i class="fa fa-check"></i><b>20.7.1</b> M-Estimation and Asymptotic Theory</a></li>
<li class="chapter" data-level="20.7.2" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#the-danger-of-omitted-variables"><i class="fa fa-check"></i><b>20.7.2</b> The Danger of Omitted Variables</a></li>
<li class="chapter" data-level="20.7.3" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#cross-validation-vs.-statistical-testing"><i class="fa fa-check"></i><b>20.7.3</b> Cross-Validation vs. Statistical Testing</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="putting-it-all-together-comparing-objectives.html"><a href="putting-it-all-together-comparing-objectives.html"><i class="fa fa-check"></i><b>20.8</b> Putting It All Together: Comparing Objectives</a></li>
<li class="chapter" data-level="20.9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>20.9</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="21" data-path="sec-causal-inference.html"><a href="sec-causal-inference.html"><i class="fa fa-check"></i><b>21</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-the-ladder-of-causation.html"><a href="sec-the-ladder-of-causation.html"><i class="fa fa-check"></i><b>21.1</b> The Ladder of Causation</a></li>
<li class="chapter" data-level="21.2" data-path="the-formal-notation-of-causality.html"><a href="the-formal-notation-of-causality.html"><i class="fa fa-check"></i><b>21.2</b> The Formal Notation of Causality</a></li>
<li class="chapter" data-level="21.3" data-path="the-7-tools-of-structural-causal-models.html"><a href="the-7-tools-of-structural-causal-models.html"><i class="fa fa-check"></i><b>21.3</b> The 7 Tools of Structural Causal Models</a></li>
<li class="chapter" data-level="21.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html"><i class="fa fa-check"></i><b>21.4</b> Simpson’s Paradox</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#what-is-simpsons-paradox"><i class="fa fa-check"></i><b>21.4.1</b> What is Simpson’s Paradox?</a></li>
<li class="chapter" data-level="21.4.2" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-is-this-important"><i class="fa fa-check"></i><b>21.4.2</b> Why is this Important?</a></li>
<li class="chapter" data-level="21.4.3" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#comparison-between-simpsons-paradox-and-omitted-variable-bias"><i class="fa fa-check"></i><b>21.4.3</b> Comparison between Simpson’s Paradox and Omitted Variable Bias</a></li>
<li class="chapter" data-level="21.4.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#illustrating-simpsons-paradox-marketing-campaign-success-rates"><i class="fa fa-check"></i><b>21.4.4</b> Illustrating Simpson’s Paradox: Marketing Campaign Success Rates</a></li>
<li class="chapter" data-level="21.4.5" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-does-this-happen"><i class="fa fa-check"></i><b>21.4.5</b> Why Does This Happen?</a></li>
<li class="chapter" data-level="21.4.6" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#how-does-causal-inference-solve-this"><i class="fa fa-check"></i><b>21.4.6</b> How Does Causal Inference Solve This?</a></li>
<li class="chapter" data-level="21.4.7" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#correcting-simpsons-paradox-with-regression-adjustment"><i class="fa fa-check"></i><b>21.4.7</b> Correcting Simpson’s Paradox with Regression Adjustment</a></li>
<li class="chapter" data-level="21.4.8" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#key-takeaways-3"><i class="fa fa-check"></i><b>21.4.8</b> Key Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="additional-resources-1.html"><a href="additional-resources-1.html"><i class="fa fa-check"></i><b>21.5</b> Additional Resources</a></li>
<li class="chapter" data-level="21.6" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html"><i class="fa fa-check"></i><b>21.6</b> Experimental vs. Quasi-Experimental Designs</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html#criticisms-of-quasi-experimental-designs"><i class="fa fa-check"></i><b>21.6.1</b> Criticisms of Quasi-Experimental Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="hierarchical-ordering-of-causal-tools.html"><a href="hierarchical-ordering-of-causal-tools.html"><i class="fa fa-check"></i><b>21.7</b> Hierarchical Ordering of Causal Tools</a></li>
<li class="chapter" data-level="21.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html"><i class="fa fa-check"></i><b>21.8</b> Types of Validity in Research</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-measurement-validity"><i class="fa fa-check"></i><b>21.8.1</b> Measurement Validity</a></li>
<li class="chapter" data-level="21.8.2" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-construct-validity"><i class="fa fa-check"></i><b>21.8.2</b> Construct Validity</a></li>
<li class="chapter" data-level="21.8.3" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-criterion-validity"><i class="fa fa-check"></i><b>21.8.3</b> Criterion Validity</a></li>
<li class="chapter" data-level="21.8.4" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-internal-validity"><i class="fa fa-check"></i><b>21.8.4</b> Internal Validity</a></li>
<li class="chapter" data-level="21.8.5" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-external-validity"><i class="fa fa-check"></i><b>21.8.5</b> External Validity</a></li>
<li class="chapter" data-level="21.8.6" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-ecological-validity"><i class="fa fa-check"></i><b>21.8.6</b> Ecological Validity</a></li>
<li class="chapter" data-level="21.8.7" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-statistical-conclusion-validity"><i class="fa fa-check"></i><b>21.8.7</b> Statistical Conclusion Validity</a></li>
<li class="chapter" data-level="21.8.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#putting-it-all-together"><i class="fa fa-check"></i><b>21.8.8</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html"><i class="fa fa-check"></i><b>21.9</b> Types of Subjects in a Treatment Setting</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#non-switchers"><i class="fa fa-check"></i><b>21.9.1</b> Non-Switchers</a></li>
<li class="chapter" data-level="21.9.2" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#switchers"><i class="fa fa-check"></i><b>21.9.2</b> Switchers</a></li>
<li class="chapter" data-level="21.9.3" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#classification-of-individuals-based-on-treatment-assignment"><i class="fa fa-check"></i><b>21.9.3</b> Classification of Individuals Based on Treatment Assignment</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html"><i class="fa fa-check"></i><b>21.10</b> Types of Treatment Effects</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-average-treatment-effect"><i class="fa fa-check"></i><b>21.10.1</b> Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.2" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-conditional-average-treatment-effect-"><i class="fa fa-check"></i><b>21.10.2</b> Conditional Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.3" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-intention-to-treat-effect"><i class="fa fa-check"></i><b>21.10.3</b> Intention-to-Treat Effect</a></li>
<li class="chapter" data-level="21.10.4" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-local-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.5" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.6" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>21.10.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="21.10.7" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-quantile-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.8" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-log-odds-treatment-effects-for-binary-outcomes"><i class="fa fa-check"></i><b>21.10.8</b> Log-Odds Treatment Effects for Binary Outcomes</a></li>
<li class="chapter" data-level="21.10.9" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#summary-table-treatment-effect-estimands"><i class="fa fa-check"></i><b>21.10.9</b> Summary Table: Treatment Effect Estimands</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="22" data-path="sec-experimental-design.html"><a href="sec-experimental-design.html"><i class="fa fa-check"></i><b>22</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="22.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>22.1</b> Principles of Experimental Design</a></li>
<li class="chapter" data-level="22.2" data-path="sec-the-gold-standard-randomized-controlled-trials.html"><a href="sec-the-gold-standard-randomized-controlled-trials.html"><i class="fa fa-check"></i><b>22.2</b> The Gold Standard: Randomized Controlled Trials</a></li>
<li class="chapter" data-level="22.3" data-path="selection-problem.html"><a href="selection-problem.html"><i class="fa fa-check"></i><b>22.3</b> Selection Problem</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="selection-problem.html"><a href="selection-problem.html#the-observed-difference-in-outcomes"><i class="fa fa-check"></i><b>22.3.1</b> The Observed Difference in Outcomes</a></li>
<li class="chapter" data-level="22.3.2" data-path="selection-problem.html"><a href="selection-problem.html#eliminating-selection-bias-with-random-assignment"><i class="fa fa-check"></i><b>22.3.2</b> Eliminating Selection Bias with Random Assignment</a></li>
<li class="chapter" data-level="22.3.3" data-path="selection-problem.html"><a href="selection-problem.html#another-representation-under-regression"><i class="fa fa-check"></i><b>22.3.3</b> Another Representation Under Regression</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html"><i class="fa fa-check"></i><b>22.4</b> Classical Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.4.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="22.4.2" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#randomized-block-design"><i class="fa fa-check"></i><b>22.4.2</b> Randomized Block Design</a></li>
<li class="chapter" data-level="22.4.3" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#factorial-design"><i class="fa fa-check"></i><b>22.4.3</b> Factorial Design</a></li>
<li class="chapter" data-level="22.4.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#crossover-design"><i class="fa fa-check"></i><b>22.4.4</b> Crossover Design</a></li>
<li class="chapter" data-level="22.4.5" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#split-plot-design"><i class="fa fa-check"></i><b>22.4.5</b> Split-Plot Design</a></li>
<li class="chapter" data-level="22.4.6" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#latin-square-design"><i class="fa fa-check"></i><b>22.4.6</b> Latin Square Design</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html"><i class="fa fa-check"></i><b>22.5</b> Advanced Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#semi-random-experiments"><i class="fa fa-check"></i><b>22.5.1</b> Semi-Random Experiments</a></li>
<li class="chapter" data-level="22.5.2" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#re-randomization"><i class="fa fa-check"></i><b>22.5.2</b> Re-Randomization</a></li>
<li class="chapter" data-level="22.5.3" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments"><i class="fa fa-check"></i><b>22.5.3</b> Two-Stage Randomized Experiments</a></li>
<li class="chapter" data-level="22.5.4" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments-with-interference-and-noncompliance"><i class="fa fa-check"></i><b>22.5.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="emerging-research.html"><a href="emerging-research.html"><i class="fa fa-check"></i><b>22.6</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="emerging-research.html"><a href="emerging-research.html#covariate-balancing-in-online-ab-testing-the-pigeonhole-design"><i class="fa fa-check"></i><b>22.6.1</b> Covariate Balancing in Online A/B Testing: The Pigeonhole Design</a></li>
<li class="chapter" data-level="22.6.2" data-path="emerging-research.html"><a href="emerging-research.html#sec-handling-zero-valued-outcomes"><i class="fa fa-check"></i><b>22.6.2</b> Handling Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>23</b> Sampling</a>
<ul>
<li class="chapter" data-level="23.1" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>23.1</b> Population and Sample</a></li>
<li class="chapter" data-level="23.2" data-path="probability-sampling.html"><a href="probability-sampling.html"><i class="fa fa-check"></i><b>23.2</b> Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-simple-random-sampling"><i class="fa fa-check"></i><b>23.2.1</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="23.2.2" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-stratified-sampling"><i class="fa fa-check"></i><b>23.2.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="23.2.3" data-path="probability-sampling.html"><a href="probability-sampling.html#systematic-sampling"><i class="fa fa-check"></i><b>23.2.3</b> Systematic Sampling</a></li>
<li class="chapter" data-level="23.2.4" data-path="probability-sampling.html"><a href="probability-sampling.html#cluster-sampling"><i class="fa fa-check"></i><b>23.2.4</b> Cluster Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html"><i class="fa fa-check"></i><b>23.3</b> Non-Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#convenience-sampling"><i class="fa fa-check"></i><b>23.3.1</b> Convenience Sampling</a></li>
<li class="chapter" data-level="23.3.2" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#quota-sampling"><i class="fa fa-check"></i><b>23.3.2</b> Quota Sampling</a></li>
<li class="chapter" data-level="23.3.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#snowball-sampling"><i class="fa fa-check"></i><b>23.3.3</b> Snowball Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="sec-unequal-probability-sampling.html"><a href="sec-unequal-probability-sampling.html"><i class="fa fa-check"></i><b>23.4</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="23.5" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html"><i class="fa fa-check"></i><b>23.5</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#cube-method-for-balanced-sampling"><i class="fa fa-check"></i><b>23.5.1</b> Cube Method for Balanced Sampling</a></li>
<li class="chapter" data-level="23.5.2" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-with-stratification"><i class="fa fa-check"></i><b>23.5.2</b> Balanced Sampling with Stratification</a></li>
<li class="chapter" data-level="23.5.3" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-cluster-sampling"><i class="fa fa-check"></i><b>23.5.3</b> Balanced Sampling in Cluster Sampling</a></li>
<li class="chapter" data-level="23.5.4" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-two-stage-sampling"><i class="fa fa-check"></i><b>23.5.4</b> Balanced Sampling in Two-Stage Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="sample-size-determination.html"><a href="sample-size-determination.html"><i class="fa fa-check"></i><b>23.6</b> Sample Size Determination</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="sec-analysis-of-variance-anova.html"><a href="sec-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>24</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="24.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html"><i class="fa fa-check"></i><b>24.1</b> Completely Randomized Design</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>24.1.1</b> Single-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.2" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-random-effects-model"><i class="fa fa-check"></i><b>24.1.2</b> Single Factor Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.3" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-factor-fixed-effects-anova"><i class="fa fa-check"></i><b>24.1.3</b> Two-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.4" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-random-effects-anova"><i class="fa fa-check"></i><b>24.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.5" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>24.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html"><i class="fa fa-check"></i><b>24.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#kruskal-wallis-test-one-way-nonparametric-anova"><i class="fa fa-check"></i><b>24.2.1</b> Kruskal-Wallis Test (One-Way Nonparametric ANOVA)</a></li>
<li class="chapter" data-level="24.2.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#friedman-test-nonparametric-two-way-anova"><i class="fa fa-check"></i><b>24.2.2</b> Friedman Test (Nonparametric Two-Way ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="sec-randomized-block-designs.html"><a href="sec-randomized-block-designs.html"><i class="fa fa-check"></i><b>24.3</b> Randomized Block Designs</a></li>
<li class="chapter" data-level="24.4" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>24.4</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-design"><i class="fa fa-check"></i><b>24.4.1</b> Two-Factor Nested Design</a></li>
<li class="chapter" data-level="24.4.2" data-path="nested-designs.html"><a href="nested-designs.html#unbalanced-nested-two-factor-designs"><i class="fa fa-check"></i><b>24.4.2</b> Unbalanced Nested Two-Factor Designs</a></li>
<li class="chapter" data-level="24.4.3" data-path="nested-designs.html"><a href="nested-designs.html#random-factor-effects"><i class="fa fa-check"></i><b>24.4.3</b> Random Factor Effects</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>24.5</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>24.5.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="24.5.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#single-factor-studies"><i class="fa fa-check"></i><b>24.5.2</b> Single Factor Studies</a></li>
<li class="chapter" data-level="24.5.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#multi-factor-studies"><i class="fa fa-check"></i><b>24.5.3</b> Multi-Factor Studies</a></li>
<li class="chapter" data-level="24.5.4" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#procedure-for-sample-size-selection"><i class="fa fa-check"></i><b>24.5.4</b> Procedure for Sample Size Selection</a></li>
<li class="chapter" data-level="24.5.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>24.5.5</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>24.6</b> Single Factor Covariance Model</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#statistical-inference-for-treatment-effects"><i class="fa fa-check"></i><b>24.6.1</b> Statistical Inference for Treatment Effects</a></li>
<li class="chapter" data-level="24.6.2" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#testing-for-parallel-slopes"><i class="fa fa-check"></i><b>24.6.2</b> Testing for Parallel Slopes</a></li>
<li class="chapter" data-level="24.6.3" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#adjusted-means"><i class="fa fa-check"></i><b>24.6.3</b> Adjusted Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sec-multivariate-methods.html"><a href="sec-multivariate-methods.html"><i class="fa fa-check"></i><b>25</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="25.1" data-path="basic-understanding.html"><a href="basic-understanding.html"><i class="fa fa-check"></i><b>25.1</b> Basic Understanding</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-random-vectors"><i class="fa fa-check"></i><b>25.1.1</b> Multivariate Random Vectors</a></li>
<li class="chapter" data-level="25.1.2" data-path="basic-understanding.html"><a href="basic-understanding.html#sec-covariance-matrix-multivariate"><i class="fa fa-check"></i><b>25.1.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="25.1.3" data-path="basic-understanding.html"><a href="basic-understanding.html#equalities-in-expectation-and-variance"><i class="fa fa-check"></i><b>25.1.3</b> Equalities in Expectation and Variance</a></li>
<li class="chapter" data-level="25.1.4" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-normal-distribution-1"><i class="fa fa-check"></i><b>25.1.4</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="25.1.5" data-path="basic-understanding.html"><a href="basic-understanding.html#test-of-multivariate-normality"><i class="fa fa-check"></i><b>25.1.5</b> Test of Multivariate Normality</a></li>
<li class="chapter" data-level="25.1.6" data-path="basic-understanding.html"><a href="basic-understanding.html#mean-vector-inference"><i class="fa fa-check"></i><b>25.1.6</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="25.1.7" data-path="basic-understanding.html"><a href="basic-understanding.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>25.1.7</b> General Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>25.2</b> Multivariate Analysis of Variance</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#one-way-manova"><i class="fa fa-check"></i><b>25.2.1</b> One-Way MANOVA</a></li>
<li class="chapter" data-level="25.2.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#sec-profile-analysis"><i class="fa fa-check"></i><b>25.2.2</b> Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="statistical-test-selection-for-comparing-means.html"><a href="statistical-test-selection-for-comparing-means.html"><i class="fa fa-check"></i><b>25.3</b> Statistical Test Selection for Comparing Means</a></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="26" data-path="sec-quasi-experimental.html"><a href="sec-quasi-experimental.html"><i class="fa fa-check"></i><b>26</b> Quasi-Experimental Methods</a>
<ul>
<li class="chapter" data-level="26.1" data-path="identification-strategy-in-quasi-experiments.html"><a href="identification-strategy-in-quasi-experiments.html"><i class="fa fa-check"></i><b>26.1</b> Identification Strategy in Quasi-Experiments</a></li>
<li class="chapter" data-level="26.2" data-path="robustness-checks.html"><a href="robustness-checks.html"><i class="fa fa-check"></i><b>26.2</b> Robustness Checks</a></li>
<li class="chapter" data-level="26.3" data-path="establishing-mechanisms.html"><a href="establishing-mechanisms.html"><i class="fa fa-check"></i><b>26.3</b> Establishing Mechanisms</a></li>
<li class="chapter" data-level="26.4" data-path="limitations-of-quasi-experiments.html"><a href="limitations-of-quasi-experiments.html"><i class="fa fa-check"></i><b>26.4</b> Limitations of Quasi-Experiments</a></li>
<li class="chapter" data-level="26.5" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html"><i class="fa fa-check"></i><b>26.5</b> Assumptions for Identifying Treatment Effects</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-sutva"><i class="fa fa-check"></i><b>26.5.1</b> Stable Unit Treatment Value Assumption</a></li>
<li class="chapter" data-level="26.5.2" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-conditional-ignorability-assumption"><i class="fa fa-check"></i><b>26.5.2</b> Conditional Ignorability Assumption</a></li>
<li class="chapter" data-level="26.5.3" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-overlap-positivity-assumption"><i class="fa fa-check"></i><b>26.5.3</b> Overlap (Positivity) Assumption</a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html"><i class="fa fa-check"></i><b>26.6</b> Natural Experiments</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#the-problem-of-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.1</b> The Problem of Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.2" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#statistical-challenges-in-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.2</b> Statistical Challenges in Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.3" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#solutions-multiple-testing-corrections"><i class="fa fa-check"></i><b>26.6.3</b> Solutions: Multiple Testing Corrections</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html"><i class="fa fa-check"></i><b>26.7</b> Design vs. Model-Based Approaches</a>
<ul>
<li class="chapter" data-level="26.7.1" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-design-based"><i class="fa fa-check"></i><b>26.7.1</b> Design-Based Perspective</a></li>
<li class="chapter" data-level="26.7.2" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-model-based-perspective"><i class="fa fa-check"></i><b>26.7.2</b> Model-Based Perspective</a></li>
<li class="chapter" data-level="26.7.3" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#placing-methods-along-a-spectrum"><i class="fa fa-check"></i><b>26.7.3</b> Placing Methods Along a Spectrum</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="sec-regression-discontinuity.html"><a href="sec-regression-discontinuity.html"><i class="fa fa-check"></i><b>27</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="27.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html"><i class="fa fa-check"></i><b>27.1</b> Conceptual Framework</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html#types-of-regression-discontinuity-designs"><i class="fa fa-check"></i><b>27.1.1</b> Types of Regression Discontinuity Designs</a></li>
<li class="chapter" data-level="27.1.2" data-path="conceptual-framework.html"><a href="conceptual-framework.html#assumptions-for-rd-validity"><i class="fa fa-check"></i><b>27.1.2</b> Assumptions for RD Validity</a></li>
<li class="chapter" data-level="27.1.3" data-path="conceptual-framework.html"><a href="conceptual-framework.html#threats-to-rd-validity"><i class="fa fa-check"></i><b>27.1.3</b> Threats to RD Validity</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html"><i class="fa fa-check"></i><b>27.2</b> Model Estimation Strategies</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#parametric-models-polynomial-regression"><i class="fa fa-check"></i><b>27.2.1</b> Parametric Models: Polynomial Regression</a></li>
<li class="chapter" data-level="27.2.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#nonparametric-models-local-regression"><i class="fa fa-check"></i><b>27.2.2</b> Nonparametric Models: Local Regression</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="formal-definition.html"><a href="formal-definition.html"><i class="fa fa-check"></i><b>27.3</b> Formal Definition</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="formal-definition.html"><a href="formal-definition.html#identification-assumptions"><i class="fa fa-check"></i><b>27.3.1</b> Identification Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>27.4</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based-approach"><i class="fa fa-check"></i><b>27.4.1</b> Local Randomization-Based Approach</a></li>
<li class="chapter" data-level="27.4.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#sec-continuity-based-approach"><i class="fa fa-check"></i><b>27.4.2</b> Continuity-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>27.5</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="specification-checks.html"><a href="specification-checks.html#sec-balance-checks"><i class="fa fa-check"></i><b>27.5.1</b> Balance Checks</a></li>
<li class="chapter" data-level="27.5.2" data-path="specification-checks.html"><a href="specification-checks.html#sec-sorting-bunching-and-manipulation"><i class="fa fa-check"></i><b>27.5.2</b> Sorting, Bunching, and Manipulation</a></li>
<li class="chapter" data-level="27.5.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>27.5.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="27.5.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>27.5.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="27.5.5" data-path="specification-checks.html"><a href="specification-checks.html#assessing-sensitivity"><i class="fa fa-check"></i><b>27.5.5</b> Assessing Sensitivity</a></li>
<li class="chapter" data-level="27.5.6" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>27.5.6</b> Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.6</b> Fuzzy Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#compliance-types"><i class="fa fa-check"></i><b>27.6.1</b> Compliance Types</a></li>
<li class="chapter" data-level="27.6.2" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect"><i class="fa fa-check"></i><b>27.6.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.6.3" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#equivalent-representation-using-expectations"><i class="fa fa-check"></i><b>27.6.3</b> Equivalent Representation Using Expectations</a></li>
<li class="chapter" data-level="27.6.4" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimation-strategies"><i class="fa fa-check"></i><b>27.6.4</b> Estimation Strategies</a></li>
<li class="chapter" data-level="27.6.5" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#practical-considerations-6"><i class="fa fa-check"></i><b>27.6.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="27.6.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#steps-for-fuzzy-rd"><i class="fa fa-check"></i><b>27.6.6</b> Steps for Fuzzy RD</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.7</b> Sharp Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.7.1" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#assumptions-for-identification"><i class="fa fa-check"></i><b>27.7.1</b> Assumptions for Identification</a></li>
<li class="chapter" data-level="27.7.2" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect-1"><i class="fa fa-check"></i><b>27.7.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.7.3" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimation-methods"><i class="fa fa-check"></i><b>27.7.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="27.7.4" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#steps-for-sharp-rd"><i class="fa fa-check"></i><b>27.7.4</b> Steps for Sharp RD</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html"><i class="fa fa-check"></i><b>27.8</b> Regression Kink Design</a>
<ul>
<li class="chapter" data-level="27.8.1" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-sharp-regression-kink-design"><i class="fa fa-check"></i><b>27.8.1</b> Identification in Sharp Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.2" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-fuzzy-regression-kink-design"><i class="fa fa-check"></i><b>27.8.2</b> Identification in Fuzzy Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.3" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#estimation-of-rkd-effects"><i class="fa fa-check"></i><b>27.8.3</b> Estimation of RKD Effects</a></li>
<li class="chapter" data-level="27.8.4" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#robustness-checks-1"><i class="fa fa-check"></i><b>27.8.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.9" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.9</b> Multi-Cutoff Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.9.1" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#identification"><i class="fa fa-check"></i><b>27.9.1</b> Identification</a></li>
<li class="chapter" data-level="27.9.2" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#key-assumptions-1"><i class="fa fa-check"></i><b>27.9.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.9.3" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#estimation-approaches"><i class="fa fa-check"></i><b>27.9.3</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.9.4" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#robustness-checks-2"><i class="fa fa-check"></i><b>27.9.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.10" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.10</b> Multi-Score Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.10.1" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#general-framework"><i class="fa fa-check"></i><b>27.10.1</b> General Framework</a></li>
<li class="chapter" data-level="27.10.2" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#identification-1"><i class="fa fa-check"></i><b>27.10.2</b> Identification</a></li>
<li class="chapter" data-level="27.10.3" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#key-assumptions-2"><i class="fa fa-check"></i><b>27.10.3</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.10.4" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#estimation-approaches-1"><i class="fa fa-check"></i><b>27.10.4</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.10.5" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#robustness-checks-3"><i class="fa fa-check"></i><b>27.10.5</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.11" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.11</b> Evaluation of a Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.11.1" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#graphical-and-formal-evidence"><i class="fa fa-check"></i><b>27.11.1</b> Graphical and Formal Evidence</a></li>
<li class="chapter" data-level="27.11.2" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#functional-form-of-the-running-variable"><i class="fa fa-check"></i><b>27.11.2</b> Functional Form of the Running Variable</a></li>
<li class="chapter" data-level="27.11.3" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#bandwidth-selection-2"><i class="fa fa-check"></i><b>27.11.3</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="27.11.4" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#addressing-potential-confounders"><i class="fa fa-check"></i><b>27.11.4</b> Addressing Potential Confounders</a></li>
<li class="chapter" data-level="27.11.5" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#external-validity-in-rd"><i class="fa fa-check"></i><b>27.11.5</b> External Validity in RD</a></li>
</ul></li>
<li class="chapter" data-level="27.12" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html"><i class="fa fa-check"></i><b>27.12</b> Applications of RD Designs</a>
<ul>
<li class="chapter" data-level="27.12.1" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#applications-in-marketing"><i class="fa fa-check"></i><b>27.12.1</b> Applications in Marketing</a></li>
<li class="chapter" data-level="27.12.2" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#r-packages-for-rd-estimation"><i class="fa fa-check"></i><b>27.12.2</b> R Packages for RD Estimation</a></li>
<li class="chapter" data-level="27.12.3" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-regression-discontinuity-in-education"><i class="fa fa-check"></i><b>27.12.3</b> Example of Regression Discontinuity in Education</a></li>
<li class="chapter" data-level="27.12.4" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-occupational-licensing-and-market-efficiency"><i class="fa fa-check"></i><b>27.12.4</b> Example of Occupational Licensing and Market Efficiency</a></li>
<li class="chapter" data-level="27.12.5" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#replicating-carpenter2009effect"><i class="fa fa-check"></i><b>27.12.5</b> Replicating <span class="citation">(Carpenter and Dobkin 2009)</span></a></li>
<li class="chapter" data-level="27.12.6" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#additional-rd-applications"><i class="fa fa-check"></i><b>27.12.6</b> Additional RD Applications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="temporal-discontinuity-designs.html"><a href="temporal-discontinuity-designs.html"><i class="fa fa-check"></i><b>28</b> Temporal Discontinuity Designs</a>
<ul>
<li class="chapter" data-level="28.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>28.1</b> Regression Discontinuity in Time</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>28.1.1</b> Estimation and Model Selection</a></li>
<li class="chapter" data-level="28.1.2" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#strengths-of-rdit"><i class="fa fa-check"></i><b>28.1.2</b> Strengths of RDiT</a></li>
<li class="chapter" data-level="28.1.3" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#limitations-and-challenges-of-rdit"><i class="fa fa-check"></i><b>28.1.3</b> Limitations and Challenges of RDiT</a></li>
<li class="chapter" data-level="28.1.4" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#recommendations-for-robustness-checks"><i class="fa fa-check"></i><b>28.1.4</b> Recommendations for Robustness Checks</a></li>
<li class="chapter" data-level="28.1.5" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#applications-of-rdit"><i class="fa fa-check"></i><b>28.1.5</b> Applications of RDiT</a></li>
<li class="chapter" data-level="28.1.6" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#empirical-example"><i class="fa fa-check"></i><b>28.1.6</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html"><i class="fa fa-check"></i><b>28.2</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#advantages-of-its"><i class="fa fa-check"></i><b>28.2.1</b> Advantages of ITS</a></li>
<li class="chapter" data-level="28.2.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#limitations-of-its"><i class="fa fa-check"></i><b>28.2.2</b> Limitations of ITS</a></li>
<li class="chapter" data-level="28.2.3" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#empirical-example-1"><i class="fa fa-check"></i><b>28.2.3</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html"><i class="fa fa-check"></i><b>28.3</b> Combining both RDiT and ITS</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#augment-an-its-model-with-a-local-discontinuity-term"><i class="fa fa-check"></i><b>28.3.1</b> Augment an ITS Model with a Local Discontinuity Term</a></li>
<li class="chapter" data-level="28.3.2" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#two-stage-or-multi-stage-modeling"><i class="fa fa-check"></i><b>28.3.2</b> Two-Stage (or Multi-Stage) Modeling</a></li>
<li class="chapter" data-level="28.3.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#hierarchical-or-multi-level-modeling"><i class="fa fa-check"></i><b>28.3.3</b> Hierarchical or Multi-Level Modeling</a></li>
<li class="chapter" data-level="28.3.4" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#empirical-example-2"><i class="fa fa-check"></i><b>28.3.4</b> Empirical Example</a></li>
<li class="chapter" data-level="28.3.5" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#practical-guidance"><i class="fa fa-check"></i><b>28.3.5</b> Practical Guidance</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html"><i class="fa fa-check"></i><b>28.4</b> Case-Crossover Study Design</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#mathematical-foundations"><i class="fa fa-check"></i><b>28.4.1</b> Mathematical Foundations</a></li>
<li class="chapter" data-level="28.4.2" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#selection-of-control-periods"><i class="fa fa-check"></i><b>28.4.2</b> Selection of Control Periods</a></li>
<li class="chapter" data-level="28.4.3" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#assumptions-1"><i class="fa fa-check"></i><b>28.4.3</b> Assumptions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="sec-synthetic-difference-in-differences.html"><a href="sec-synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>29</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="29.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>29.1</b> Understanding</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="understanding.html"><a href="understanding.html#steps-in-sdid-estimation"><i class="fa fa-check"></i><b>29.1.1</b> Steps in SDID Estimation</a></li>
<li class="chapter" data-level="29.1.2" data-path="understanding.html"><a href="understanding.html#comparison-of-methods-1"><i class="fa fa-check"></i><b>29.1.2</b> Comparison of Methods</a></li>
<li class="chapter" data-level="29.1.3" data-path="understanding.html"><a href="understanding.html#why-use-weights"><i class="fa fa-check"></i><b>29.1.3</b> <strong>Why Use Weights?</strong></a></li>
<li class="chapter" data-level="29.1.4" data-path="understanding.html"><a href="understanding.html#benefits-of-localization-in-sdid"><i class="fa fa-check"></i><b>29.1.4</b> <strong>Benefits of Localization in SDID</strong></a></li>
<li class="chapter" data-level="29.1.5" data-path="understanding.html"><a href="understanding.html#designing-sdid-weights"><i class="fa fa-check"></i><b>29.1.5</b> <strong>Designing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.6" data-path="understanding.html"><a href="understanding.html#how-sdid-enhances-dids-plausibility"><i class="fa fa-check"></i><b>29.1.6</b> <strong>How SDID Enhances DID’s Plausibility</strong></a></li>
<li class="chapter" data-level="29.1.7" data-path="understanding.html"><a href="understanding.html#choosing-sdid-weights"><i class="fa fa-check"></i><b>29.1.7</b> <strong>Choosing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.8" data-path="understanding.html"><a href="understanding.html#accounting-for-time-varying-covariates-in-weight-estimation"><i class="fa fa-check"></i><b>29.1.8</b> <strong>Accounting for Time-Varying Covariates in Weight Estimation</strong></a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="application-3.html"><a href="application-3.html"><i class="fa fa-check"></i><b>29.2</b> Application</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="application-3.html"><a href="application-3.html#block-treatment"><i class="fa fa-check"></i><b>29.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="29.2.2" data-path="application-3.html"><a href="application-3.html#staggered-adoption"><i class="fa fa-check"></i><b>29.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="sec-difference-in-differences.html"><a href="sec-difference-in-differences.html"><i class="fa fa-check"></i><b>30</b> Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.1" data-path="empirical-studies.html"><a href="empirical-studies.html"><i class="fa fa-check"></i><b>30.1</b> Empirical Studies</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-marketing"><i class="fa fa-check"></i><b>30.1.1</b> Applications of DID in Marketing</a></li>
<li class="chapter" data-level="30.1.2" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-economics"><i class="fa fa-check"></i><b>30.1.2</b> Applications of DID in Economics</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="sec-visualization-did.html"><a href="sec-visualization-did.html"><i class="fa fa-check"></i><b>30.2</b> Visualization</a></li>
<li class="chapter" data-level="30.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html"><i class="fa fa-check"></i><b>30.3</b> Simple Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#basic-setup-of-did"><i class="fa fa-check"></i><b>30.3.1</b> Basic Setup of DID</a></li>
<li class="chapter" data-level="30.3.2" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#extensions-of-did"><i class="fa fa-check"></i><b>30.3.2</b> Extensions of DID</a></li>
<li class="chapter" data-level="30.3.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#goals-of-did"><i class="fa fa-check"></i><b>30.3.3</b> Goals of DID</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html"><i class="fa fa-check"></i><b>30.4</b> Empirical Research Walkthrough</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-unintended-consequences-of-ban-the-box-policies"><i class="fa fa-check"></i><b>30.4.1</b> Example: The Unintended Consequences of “Ban the Box” Policies</a></li>
<li class="chapter" data-level="30.4.2" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-minimum-wage-and-employment"><i class="fa fa-check"></i><b>30.4.2</b> Example: Minimum Wage and Employment</a></li>
<li class="chapter" data-level="30.4.3" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-effects-of-grade-policies-on-major-choice"><i class="fa fa-check"></i><b>30.4.3</b> Example: The Effects of Grade Policies on Major Choice</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>30.5</b> One Difference</a></li>
<li class="chapter" data-level="30.6" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html"><i class="fa fa-check"></i><b>30.6</b> Two-Way Fixed Effects</a>
<ul>
<li class="chapter" data-level="30.6.1" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#canonical-twfe-model"><i class="fa fa-check"></i><b>30.6.1</b> Canonical TWFE Model</a></li>
<li class="chapter" data-level="30.6.2" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#limitations-of-twfe"><i class="fa fa-check"></i><b>30.6.2</b> Limitations of TWFE</a></li>
<li class="chapter" data-level="30.6.3" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#diagnosing-and-addressing-bias-in-twfe"><i class="fa fa-check"></i><b>30.6.3</b> Diagnosing and Addressing Bias in TWFE</a></li>
<li class="chapter" data-level="30.6.4" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#remedies-for-twfes-shortcomings"><i class="fa fa-check"></i><b>30.6.4</b> Remedies for TWFE’s Shortcomings</a></li>
<li class="chapter" data-level="30.6.5" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#best-practices-and-recommendations"><i class="fa fa-check"></i><b>30.6.5</b> Best Practices and Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="sec-multiple-periods-and-variation-in-treatment-timing.html"><a href="sec-multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>30.7</b> Multiple Periods and Variation in Treatment Timing</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="sec-multiple-periods-and-variation-in-treatment-timing.html"><a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-staggered-difference-in-differences"><i class="fa fa-check"></i><b>30.7.1</b> Staggered Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html"><i class="fa fa-check"></i><b>30.8</b> Modern Estimators for Staggered Adoption</a>
<ul>
<li class="chapter" data-level="30.8.1" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-group-time-average-treatment-effects-callaway2021difference"><i class="fa fa-check"></i><b>30.8.1</b> Group-Time Average Treatment Effects <span class="citation">(Callaway and Sant’Anna 2021)</span></a></li>
<li class="chapter" data-level="30.8.2" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-cohort-average-treatment-effects-sun2021estimating"><i class="fa fa-check"></i><b>30.8.2</b> Cohort Average Treatment Effects <span class="citation">(L. Sun and Abraham 2021)</span></a></li>
<li class="chapter" data-level="30.8.3" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-stacked-difference-in-differences"><i class="fa fa-check"></i><b>30.8.3</b> Stacked Difference-in-Differences</a></li>
<li class="chapter" data-level="30.8.4" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-panel-match-did-estimator-with-in-and-out-treatment-conditions"><i class="fa fa-check"></i><b>30.8.4</b> Panel Match DiD Estimator with In-and-Out Treatment Conditions</a></li>
<li class="chapter" data-level="30.8.5" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#counterfactual-estimators"><i class="fa fa-check"></i><b>30.8.5</b> Counterfactual Estimators</a></li>
<li class="chapter" data-level="30.8.6" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-matrix-completion-estimator"><i class="fa fa-check"></i><b>30.8.6</b> Matrix Completion Estimator</a></li>
<li class="chapter" data-level="30.8.7" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-reshaped-inverse-probability-weighting-twfe-estimator"><i class="fa fa-check"></i><b>30.8.7</b> Reshaped Inverse Probability Weighting - TWFE Estimator</a></li>
<li class="chapter" data-level="30.8.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#gardner2022two-and-borusyak2024revisiting"><i class="fa fa-check"></i><b>30.8.8</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2024)</span></a></li>
<li class="chapter" data-level="30.8.9" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#dynamic-treatment-effect-estimation-with-interactive-fixed-effects-and-short-panels"><i class="fa fa-check"></i><b>30.8.9</b> Dynamic Treatment Effect Estimation with Interactive Fixed Effects and Short Panels</a></li>
<li class="chapter" data-level="30.8.10" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-switching-difference-in-differences-estimator-de2020two"><i class="fa fa-check"></i><b>30.8.10</b> Switching Difference-in-Differences Estimator <span class="citation">(Clément De Chaisemartin and d’Haultfoeuille 2020)</span></a></li>
<li class="chapter" data-level="30.8.11" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#augmentedforward-did"><i class="fa fa-check"></i><b>30.8.11</b> Augmented/Forward DID</a></li>
<li class="chapter" data-level="30.8.12" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#doubly-robust-difference-in-differences-estimators"><i class="fa fa-check"></i><b>30.8.12</b> Doubly Robust Difference-in-Differences Estimators</a></li>
<li class="chapter" data-level="30.8.13" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#nonlinear-difference-in-differences"><i class="fa fa-check"></i><b>30.8.13</b> Nonlinear Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.9" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>30.9</b> Multiple Treatments</a>
<ul>
<li class="chapter" data-level="30.9.1" data-path="multiple-treatments.html"><a href="multiple-treatments.html#multiple-treatment-groups-model-specification"><i class="fa fa-check"></i><b>30.9.1</b> Multiple Treatment Groups: Model Specification</a></li>
<li class="chapter" data-level="30.9.2" data-path="multiple-treatments.html"><a href="multiple-treatments.html#understanding-the-control-group-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.2</b> Understanding the Control Group in Multiple Treatment DiD</a></li>
<li class="chapter" data-level="30.9.3" data-path="multiple-treatments.html"><a href="multiple-treatments.html#alternative-approaches-separate-regressions-vs.-one-model"><i class="fa fa-check"></i><b>30.9.3</b> Alternative Approaches: Separate Regressions vs. One Model</a></li>
<li class="chapter" data-level="30.9.4" data-path="multiple-treatments.html"><a href="multiple-treatments.html#handling-treatment-intensity"><i class="fa fa-check"></i><b>30.9.4</b> Handling Treatment Intensity</a></li>
<li class="chapter" data-level="30.9.5" data-path="multiple-treatments.html"><a href="multiple-treatments.html#considerations-when-individuals-can-move-between-treatment-groups"><i class="fa fa-check"></i><b>30.9.5</b> Considerations When Individuals Can Move Between Treatment Groups</a></li>
<li class="chapter" data-level="30.9.6" data-path="multiple-treatments.html"><a href="multiple-treatments.html#parallel-trends-assumption-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.6</b> Parallel Trends Assumption in Multiple-Treatment DiD</a></li>
</ul></li>
<li class="chapter" data-level="30.10" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>30.10</b> Mediation Under DiD</a>
<ul>
<li class="chapter" data-level="30.10.1" data-path="mediation-under-did.html"><a href="mediation-under-did.html#mediation-model-in-did"><i class="fa fa-check"></i><b>30.10.1</b> Mediation Model in DiD</a></li>
<li class="chapter" data-level="30.10.2" data-path="mediation-under-did.html"><a href="mediation-under-did.html#interpreting-the-results"><i class="fa fa-check"></i><b>30.10.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="30.10.3" data-path="mediation-under-did.html"><a href="mediation-under-did.html#challenges-in-mediation-analysis-for-did"><i class="fa fa-check"></i><b>30.10.3</b> Challenges in Mediation Analysis for DiD</a></li>
<li class="chapter" data-level="30.10.4" data-path="mediation-under-did.html"><a href="mediation-under-did.html#alternative-approach-instrumental-variables-for-mediation"><i class="fa fa-check"></i><b>30.10.4</b> Alternative Approach: Instrumental Variables for Mediation</a></li>
</ul></li>
<li class="chapter" data-level="30.11" data-path="assumptions-3.html"><a href="assumptions-3.html"><i class="fa fa-check"></i><b>30.11</b> Assumptions</a>
<ul>
<li class="chapter" data-level="30.11.1" data-path="assumptions-3.html"><a href="assumptions-3.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>30.11.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="30.11.2" data-path="assumptions-3.html"><a href="assumptions-3.html#sec-placebo-test-did"><i class="fa fa-check"></i><b>30.11.2</b> Placebo Test</a></li>
</ul></li>
<li class="chapter" data-level="30.12" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html"><i class="fa fa-check"></i><b>30.12</b> Robustness Checks</a>
<ul>
<li class="chapter" data-level="30.12.1" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#robustness-checks-to-strengthen-causal-interpretation"><i class="fa fa-check"></i><b>30.12.1</b> Robustness Checks to Strengthen Causal Interpretation</a></li>
<li class="chapter" data-level="30.12.2" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#best-practices-for-reliable-did-implementation"><i class="fa fa-check"></i><b>30.12.2</b> Best Practices for Reliable DiD Implementation</a></li>
</ul></li>
<li class="chapter" data-level="30.13" data-path="concerns-in-did.html"><a href="concerns-in-did.html"><i class="fa fa-check"></i><b>30.13</b> Concerns in DID</a>
<ul>
<li class="chapter" data-level="30.13.1" data-path="concerns-in-did.html"><a href="concerns-in-did.html#matching-methods-in-did"><i class="fa fa-check"></i><b>30.13.1</b> Matching Methods in DID</a></li>
<li class="chapter" data-level="30.13.2" data-path="concerns-in-did.html"><a href="concerns-in-did.html#control-variables-in-did"><i class="fa fa-check"></i><b>30.13.2</b> Control Variables in DID</a></li>
<li class="chapter" data-level="30.13.3" data-path="concerns-in-did.html"><a href="concerns-in-did.html#did-for-count-data-fixed-effects-poisson-model"><i class="fa fa-check"></i><b>30.13.3</b> DID for Count Data: Fixed-Effects Poisson Model</a></li>
<li class="chapter" data-level="30.13.4" data-path="concerns-in-did.html"><a href="concerns-in-did.html#handling-zero-valued-outcomes-in-did"><i class="fa fa-check"></i><b>30.13.4</b> Handling Zero-Valued Outcomes in DID</a></li>
<li class="chapter" data-level="30.13.5" data-path="concerns-in-did.html"><a href="concerns-in-did.html#standard-errors-1"><i class="fa fa-check"></i><b>30.13.5</b> Standard Errors</a></li>
<li class="chapter" data-level="30.13.6" data-path="concerns-in-did.html"><a href="concerns-in-did.html#sec-partial-identification-did"><i class="fa fa-check"></i><b>30.13.6</b> Partial Identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="sec-changes-in-changes.html"><a href="sec-changes-in-changes.html"><i class="fa fa-check"></i><b>31</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="31.1" data-path="key-concepts.html"><a href="key-concepts.html"><i class="fa fa-check"></i><b>31.1</b> Key Concepts</a></li>
<li class="chapter" data-level="31.2" data-path="estimating-qtt-with-cic.html"><a href="estimating-qtt-with-cic.html"><i class="fa fa-check"></i><b>31.2</b> Estimating QTT with CiC</a></li>
<li class="chapter" data-level="31.3" data-path="application-4.html"><a href="application-4.html"><i class="fa fa-check"></i><b>31.3</b> Application</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="application-4.html"><a href="application-4.html#ecic-package"><i class="fa fa-check"></i><b>31.3.1</b> ECIC package</a></li>
<li class="chapter" data-level="31.3.2" data-path="application-4.html"><a href="application-4.html#qte-package"><i class="fa fa-check"></i><b>31.3.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="sec-synthetic-control.html"><a href="sec-synthetic-control.html"><i class="fa fa-check"></i><b>32</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.1" data-path="marketing-applications.html"><a href="marketing-applications.html"><i class="fa fa-check"></i><b>32.1</b> Marketing Applications</a></li>
<li class="chapter" data-level="32.2" data-path="key-features-of-scm.html"><a href="key-features-of-scm.html"><i class="fa fa-check"></i><b>32.2</b> Key Features of SCM</a></li>
<li class="chapter" data-level="32.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html"><i class="fa fa-check"></i><b>32.3</b> Advantages of SCM</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-did"><i class="fa fa-check"></i><b>32.3.1</b> Compared to DiD</a></li>
<li class="chapter" data-level="32.3.2" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-linear-regression"><i class="fa fa-check"></i><b>32.3.2</b> Compared to Linear Regression</a></li>
<li class="chapter" data-level="32.3.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#additional-advantages"><i class="fa fa-check"></i><b>32.3.3</b> Additional Advantages</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="disadvantages-of-scm.html"><a href="disadvantages-of-scm.html"><i class="fa fa-check"></i><b>32.4</b> Disadvantages of SCM</a></li>
<li class="chapter" data-level="32.5" data-path="assumptions-4.html"><a href="assumptions-4.html"><i class="fa fa-check"></i><b>32.5</b> Assumptions</a></li>
<li class="chapter" data-level="32.6" data-path="estimation-3.html"><a href="estimation-3.html"><i class="fa fa-check"></i><b>32.6</b> Estimation</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="estimation-3.html"><a href="estimation-3.html#constructing-the-synthetic-control"><i class="fa fa-check"></i><b>32.6.1</b> Constructing the Synthetic Control</a></li>
<li class="chapter" data-level="32.6.2" data-path="estimation-3.html"><a href="estimation-3.html#penalized-synthetic-control"><i class="fa fa-check"></i><b>32.6.2</b> Penalized Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="theoretical-considerations.html"><a href="theoretical-considerations.html"><i class="fa fa-check"></i><b>32.7</b> Theoretical Considerations</a></li>
<li class="chapter" data-level="32.8" data-path="inference-in-scm.html"><a href="inference-in-scm.html"><i class="fa fa-check"></i><b>32.8</b> Inference in SCM</a>
<ul>
<li class="chapter" data-level="32.8.1" data-path="inference-in-scm.html"><a href="inference-in-scm.html#permutation-placebo-inference"><i class="fa fa-check"></i><b>32.8.1</b> Permutation (Placebo) Inference</a></li>
<li class="chapter" data-level="32.8.2" data-path="inference-in-scm.html"><a href="inference-in-scm.html#one-sided-inference"><i class="fa fa-check"></i><b>32.8.2</b> One-Sided Inference</a></li>
</ul></li>
<li class="chapter" data-level="32.9" data-path="sec-augmented-synthetic-control.html"><a href="sec-augmented-synthetic-control.html"><i class="fa fa-check"></i><b>32.9</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="32.10" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>32.10</b> Synthetic Control with Staggered Adoption</a>
<ul>
<li class="chapter" data-level="32.10.1" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html#partially-pooled-synthetic-control"><i class="fa fa-check"></i><b>32.10.1</b> Partially Pooled Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.11" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>32.11</b> Generalized Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.11.1" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#the-problem-with-traditional-methods"><i class="fa fa-check"></i><b>32.11.1</b> The Problem with Traditional Methods</a></li>
<li class="chapter" data-level="32.11.2" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#generalized-synthetic-control-model"><i class="fa fa-check"></i><b>32.11.2</b> Generalized Synthetic Control Model</a></li>
<li class="chapter" data-level="32.11.3" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#identification-and-estimation"><i class="fa fa-check"></i><b>32.11.3</b> Identification and Estimation</a></li>
<li class="chapter" data-level="32.11.4" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#bootstrap-procedure-for-standard-errors"><i class="fa fa-check"></i><b>32.11.4</b> Bootstrap Procedure for Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="32.12" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>32.12</b> Bayesian Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.12.1" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-causal-inference-framework"><i class="fa fa-check"></i><b>32.12.1</b> Bayesian Causal Inference Framework</a></li>
<li class="chapter" data-level="32.12.2" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-dynamic-multilevel-factor-model"><i class="fa fa-check"></i><b>32.12.2</b> Bayesian Dynamic Multilevel Factor Model</a></li>
<li class="chapter" data-level="32.12.3" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-sparse-synthetic-control"><i class="fa fa-check"></i><b>32.12.3</b> Bayesian Sparse Synthetic Control</a></li>
<li class="chapter" data-level="32.12.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-inference-and-mcmc-estimation"><i class="fa fa-check"></i><b>32.12.4</b> Bayesian Inference and MCMC Estimation</a></li>
</ul></li>
<li class="chapter" data-level="32.13" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><i class="fa fa-check"></i><b>32.13</b> Using Multiple Outcomes to Improve the Synthetic Control Method</a>
<ul>
<li class="chapter" data-level="32.13.1" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#standard-synthetic-control-method"><i class="fa fa-check"></i><b>32.13.1</b> Standard Synthetic Control Method</a></li>
<li class="chapter" data-level="32.13.2" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#using-multiple-outcomes-for-bias-reduction"><i class="fa fa-check"></i><b>32.13.2</b> Using Multiple Outcomes for Bias Reduction</a></li>
<li class="chapter" data-level="32.13.3" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#estimation-methods-1"><i class="fa fa-check"></i><b>32.13.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="32.13.4" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#empirical-application-flint-water-crisis"><i class="fa fa-check"></i><b>32.13.4</b> Empirical Application: Flint Water Crisis</a></li>
</ul></li>
<li class="chapter" data-level="32.14" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>32.14</b> Applications</a>
<ul>
<li class="chapter" data-level="32.14.1" data-path="applications.html"><a href="applications.html#synthetic-control-estimation"><i class="fa fa-check"></i><b>32.14.1</b> Synthetic Control Estimation</a></li>
<li class="chapter" data-level="32.14.2" data-path="applications.html"><a href="applications.html#the-basque-country-policy-change"><i class="fa fa-check"></i><b>32.14.2</b> The Basque Country Policy Change</a></li>
<li class="chapter" data-level="32.14.3" data-path="applications.html"><a href="applications.html#micro-synthetic-control-with-microsynth"><i class="fa fa-check"></i><b>32.14.3</b> Micro-Synthetic Control with <code>microsynth</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="sec-event-studies.html"><a href="sec-event-studies.html"><i class="fa fa-check"></i><b>33</b> Event Studies</a>
<ul>
<li class="chapter" data-level="33.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html"><i class="fa fa-check"></i><b>33.1</b> Review of Event Studies Across Disciplines</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#finance-applications"><i class="fa fa-check"></i><b>33.1.1</b> Finance Applications</a></li>
<li class="chapter" data-level="33.1.2" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#management-applications"><i class="fa fa-check"></i><b>33.1.2</b> Management Applications</a></li>
<li class="chapter" data-level="33.1.3" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#marketing-applications-1"><i class="fa fa-check"></i><b>33.1.3</b> Marketing Applications</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="key-assumptions-3.html"><a href="key-assumptions-3.html"><i class="fa fa-check"></i><b>33.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="33.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html"><i class="fa fa-check"></i><b>33.3</b> Steps for Conducting an Event Study</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-1-event-identification"><i class="fa fa-check"></i><b>33.3.1</b> Step 1: Event Identification</a></li>
<li class="chapter" data-level="33.3.2" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-2-define-the-event-and-estimation-windows"><i class="fa fa-check"></i><b>33.3.2</b> Step 2: Define the Event and Estimation Windows</a></li>
<li class="chapter" data-level="33.3.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-3-compute-normal-vs.-abnormal-returns"><i class="fa fa-check"></i><b>33.3.3</b> Step 3: Compute Normal vs. Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.4" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-4-compute-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.3.4</b> Step 4: Compute Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.5" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-5-statistical-tests-for-significance"><i class="fa fa-check"></i><b>33.3.5</b> Step 5: Statistical Tests for Significance</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html"><i class="fa fa-check"></i><b>33.4</b> Event Studies in Marketing</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#definition"><i class="fa fa-check"></i><b>33.4.1</b> Definition</a></li>
<li class="chapter" data-level="33.4.2" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#when-can-marketing-events-affect-non-operating-assets-or-debt"><i class="fa fa-check"></i><b>33.4.2</b> When Can Marketing Events Affect Non-Operating Assets or Debt?</a></li>
<li class="chapter" data-level="33.4.3" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#calculating-the-leverage-effect"><i class="fa fa-check"></i><b>33.4.3</b> Calculating the Leverage Effect</a></li>
<li class="chapter" data-level="33.4.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#computing-leverage-effect-from-compustat-data"><i class="fa fa-check"></i><b>33.4.4</b> Computing Leverage Effect from Compustat Data</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="economic-significance.html"><a href="economic-significance.html"><i class="fa fa-check"></i><b>33.5</b> Economic Significance</a></li>
<li class="chapter" data-level="33.6" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html"><i class="fa fa-check"></i><b>33.6</b> Testing in Event Studies</a>
<ul>
<li class="chapter" data-level="33.6.1" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#statistical-power-in-event-studies"><i class="fa fa-check"></i><b>33.6.1</b> Statistical Power in Event Studies</a></li>
<li class="chapter" data-level="33.6.2" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#parametric-tests"><i class="fa fa-check"></i><b>33.6.2</b> Parametric Tests</a></li>
<li class="chapter" data-level="33.6.3" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#non-parametric-tests-1"><i class="fa fa-check"></i><b>33.6.3</b> Non-Parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.7" data-path="sample-in-event-studies.html"><a href="sample-in-event-studies.html"><i class="fa fa-check"></i><b>33.7</b> Sample in Event Studies</a></li>
<li class="chapter" data-level="33.8" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html"><i class="fa fa-check"></i><b>33.8</b> Confounders in Event Studies</a>
<ul>
<li class="chapter" data-level="33.8.1" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#types-of-confounding-events"><i class="fa fa-check"></i><b>33.8.1</b> Types of Confounding Events</a></li>
<li class="chapter" data-level="33.8.2" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#should-we-exclude-confounded-observations"><i class="fa fa-check"></i><b>33.8.2</b> Should We Exclude Confounded Observations?</a></li>
<li class="chapter" data-level="33.8.3" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#simulation-study-should-we-exclude-correlated-and-uncorrelated-events"><i class="fa fa-check"></i><b>33.8.3</b> Simulation Study: Should We Exclude Correlated and Uncorrelated Events?</a></li>
</ul></li>
<li class="chapter" data-level="33.9" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html"><i class="fa fa-check"></i><b>33.9</b> Biases in Event Studies</a>
<ul>
<li class="chapter" data-level="33.9.1" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#timing-bias-different-market-closing-times"><i class="fa fa-check"></i><b>33.9.1</b> Timing Bias: Different Market Closing Times</a></li>
<li class="chapter" data-level="33.9.2" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#upward-bias-in-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.9.2</b> Upward Bias in Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.9.3" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#cross-sectional-dependence-bias"><i class="fa fa-check"></i><b>33.9.3</b> Cross-Sectional Dependence Bias</a></li>
<li class="chapter" data-level="33.9.4" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#sample-selection-bias"><i class="fa fa-check"></i><b>33.9.4</b> Sample Selection Bias</a></li>
<li class="chapter" data-level="33.9.5" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#corrections-for-sample-selection-bias"><i class="fa fa-check"></i><b>33.9.5</b> Corrections for Sample Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="33.10" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>33.10</b> Long-run Event Studies</a>
<ul>
<li class="chapter" data-level="33.10.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#sec-buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>33.10.1</b> Buy-and-Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="33.10.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>33.10.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="33.10.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>33.10.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="33.11" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>33.11</b> Aggregation</a>
<ul>
<li class="chapter" data-level="33.11.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>33.11.1</b> Over Time</a></li>
<li class="chapter" data-level="33.11.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-and-over-time"><i class="fa fa-check"></i><b>33.11.2</b> Across Firms and Over Time</a></li>
<li class="chapter" data-level="33.11.3" data-path="aggregation.html"><a href="aggregation.html#statistical-tests-1"><i class="fa fa-check"></i><b>33.11.3</b> Statistical Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.12" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>33.12</b> Heterogeneity in the Event Effect</a>
<ul>
<li class="chapter" data-level="33.12.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-affecting-car-in-marketing-and-finance"><i class="fa fa-check"></i><b>33.12.1</b> Common Variables Affecting CAR in Marketing and Finance</a></li>
</ul></li>
<li class="chapter" data-level="33.13" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>33.13</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="33.13.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.1</b> <strong>Statistical Models for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.13.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.2</b> <strong>Economic Models for Expected Returns</strong></a></li>
</ul></li>
<li class="chapter" data-level="33.14" data-path="application-of-event-study.html"><a href="application-of-event-study.html"><i class="fa fa-check"></i><b>33.14</b> Application of Event Study</a>
<ul>
<li class="chapter" data-level="33.14.1" data-path="application-of-event-study.html"><a href="application-of-event-study.html#sorting-portfolios-for-expected-returns"><i class="fa fa-check"></i><b>33.14.1</b> <strong>Sorting Portfolios for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.14.2" data-path="application-of-event-study.html"><a href="application-of-event-study.html#erer-package"><i class="fa fa-check"></i><b>33.14.2</b> <strong><code>erer</code> Package</strong></a></li>
<li class="chapter" data-level="33.14.3" data-path="application-of-event-study.html"><a href="application-of-event-study.html#eventus"><i class="fa fa-check"></i><b>33.14.3</b> Eventus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="sec-instrumental-variables.html"><a href="sec-instrumental-variables.html"><i class="fa fa-check"></i><b>34</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.1" data-path="challenges-with-instrumental-variables.html"><a href="challenges-with-instrumental-variables.html"><i class="fa fa-check"></i><b>34.1</b> Challenges with Instrumental Variables</a></li>
<li class="chapter" data-level="34.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html"><i class="fa fa-check"></i><b>34.2</b> Framework for Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#constant-treatment-effect-model"><i class="fa fa-check"></i><b>34.2.1</b> Constant-Treatment-Effect Model</a></li>
<li class="chapter" data-level="34.2.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#instrumental-variable-solution"><i class="fa fa-check"></i><b>34.2.2</b> Instrumental Variable Solution</a></li>
<li class="chapter" data-level="34.2.3" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#heterogeneous-treatment-effects-and-the-late-framework"><i class="fa fa-check"></i><b>34.2.3</b> Heterogeneous Treatment Effects and the LATE Framework</a></li>
<li class="chapter" data-level="34.2.4" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#assumptions-for-late-identification"><i class="fa fa-check"></i><b>34.2.4</b> Assumptions for LATE Identification</a></li>
<li class="chapter" data-level="34.2.5" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#local-average-treatment-effect-theorem"><i class="fa fa-check"></i><b>34.2.5</b> Local Average Treatment Effect Theorem</a></li>
<li class="chapter" data-level="34.2.6" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#iv-in-randomized-trials-noncompliance"><i class="fa fa-check"></i><b>34.2.6</b> IV in Randomized Trials (Noncompliance)</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="sec-estimation.html"><a href="sec-estimation.html"><i class="fa fa-check"></i><b>34.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-two-stage-least-squares-estimation"><i class="fa fa-check"></i><b>34.3.1</b> Two-Stage Least Squares Estimation</a></li>
<li class="chapter" data-level="34.3.2" data-path="sec-estimation.html"><a href="sec-estimation.html#iv-gmm"><i class="fa fa-check"></i><b>34.3.2</b> IV-GMM</a></li>
<li class="chapter" data-level="34.3.3" data-path="sec-estimation.html"><a href="sec-estimation.html#limited-information-maximum-likelihood"><i class="fa fa-check"></i><b>34.3.3</b> Limited Information Maximum Likelihood</a></li>
<li class="chapter" data-level="34.3.4" data-path="sec-estimation.html"><a href="sec-estimation.html#jackknife-iv"><i class="fa fa-check"></i><b>34.3.4</b> Jackknife IV</a></li>
<li class="chapter" data-level="34.3.5" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-control-function-approach"><i class="fa fa-check"></i><b>34.3.5</b> Control Function Approach</a></li>
<li class="chapter" data-level="34.3.6" data-path="sec-estimation.html"><a href="sec-estimation.html#fuller-and-bias-reduced-iv"><i class="fa fa-check"></i><b>34.3.6</b> Fuller and Bias-Reduced IV</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html"><i class="fa fa-check"></i><b>34.4</b> Asymptotic Properties of the IV Estimator</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#sec-consistency-iv"><i class="fa fa-check"></i><b>34.4.1</b> Consistency</a></li>
<li class="chapter" data-level="34.4.2" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-normality-1"><i class="fa fa-check"></i><b>34.4.2</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="34.4.3" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-efficiency-1"><i class="fa fa-check"></i><b>34.4.3</b> Asymptotic Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html"><i class="fa fa-check"></i><b>34.5</b> Inference</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-weak-instruments-problem"><i class="fa fa-check"></i><b>34.5.1</b> Weak Instruments Problem</a></li>
<li class="chapter" data-level="34.5.2" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#solutions-and-approaches-for-valid-inference"><i class="fa fa-check"></i><b>34.5.2</b> Solutions and Approaches for Valid Inference</a></li>
<li class="chapter" data-level="34.5.3" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-anderson-rubin-approach"><i class="fa fa-check"></i><b>34.5.3</b> Anderson-Rubin Approach</a></li>
<li class="chapter" data-level="34.5.4" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-tf-procedure"><i class="fa fa-check"></i><b>34.5.4</b> tF Procedure</a></li>
<li class="chapter" data-level="34.5.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-ak-approach"><i class="fa fa-check"></i><b>34.5.5</b> AK Approach</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>34.6</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="34.6.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-relevance-assumption"><i class="fa fa-check"></i><b>34.6.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="34.6.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#independence-unconfoundedness"><i class="fa fa-check"></i><b>34.6.2</b> Independence (Unconfoundedness)</a></li>
<li class="chapter" data-level="34.6.3" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-monotonicity-assumption"><i class="fa fa-check"></i><b>34.6.3</b> Monotonicity Assumption</a></li>
<li class="chapter" data-level="34.6.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html#homogeneous-treatment-effects-optional"><i class="fa fa-check"></i><b>34.6.4</b> Homogeneous Treatment Effects (Optional)</a></li>
<li class="chapter" data-level="34.6.5" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-linearity-and-additivity"><i class="fa fa-check"></i><b>34.6.5</b> Linearity and Additivity</a></li>
<li class="chapter" data-level="34.6.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html#instrument-exogeneity-exclusion-restriction"><i class="fa fa-check"></i><b>34.6.6</b> Instrument Exogeneity (Exclusion Restriction)</a></li>
<li class="chapter" data-level="34.6.7" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-exogeneity-assumption"><i class="fa fa-check"></i><b>34.6.7</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html"><i class="fa fa-check"></i><b>34.7</b> Cautions in IV</a>
<ul>
<li class="chapter" data-level="34.7.1" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#negative-r2-in-iv"><i class="fa fa-check"></i><b>34.7.1</b> Negative <span class="math inline">\(R^2\)</span> in IV</a></li>
<li class="chapter" data-level="34.7.2" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#sec-many-instruments-bias"><i class="fa fa-check"></i><b>34.7.2</b> Many-Instruments Bias</a></li>
<li class="chapter" data-level="34.7.3" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#heterogeneous-effects-in-iv-estimation"><i class="fa fa-check"></i><b>34.7.3</b> Heterogeneous Effects in IV Estimation</a></li>
<li class="chapter" data-level="34.7.4" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#zero-valued-outcomes"><i class="fa fa-check"></i><b>34.7.4</b> Zero-Valued Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="34.8" data-path="types-of-iv.html"><a href="types-of-iv.html"><i class="fa fa-check"></i><b>34.8</b> Types of IV</a>
<ul>
<li class="chapter" data-level="34.8.1" data-path="types-of-iv.html"><a href="types-of-iv.html#treatment-intensity"><i class="fa fa-check"></i><b>34.8.1</b> Treatment Intensity</a></li>
<li class="chapter" data-level="34.8.2" data-path="types-of-iv.html"><a href="types-of-iv.html#decision-maker-iv"><i class="fa fa-check"></i><b>34.8.2</b> Decision-Maker IV</a></li>
<li class="chapter" data-level="34.8.3" data-path="types-of-iv.html"><a href="types-of-iv.html#sec-proxy-variables"><i class="fa fa-check"></i><b>34.8.3</b> Proxy Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="sec-matching-methods.html"><a href="sec-matching-methods.html"><i class="fa fa-check"></i><b>35</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="35.1" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html"><i class="fa fa-check"></i><b>35.1</b> Introduction and Motivation</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#why-match"><i class="fa fa-check"></i><b>35.1.1</b> Why Match?</a></li>
<li class="chapter" data-level="35.1.2" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#matching-as-pruning"><i class="fa fa-check"></i><b>35.1.2</b> Matching as “Pruning”</a></li>
<li class="chapter" data-level="35.1.3" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#matching-with-did"><i class="fa fa-check"></i><b>35.1.3</b> Matching with DiD</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="key-assumptions-4.html"><a href="key-assumptions-4.html"><i class="fa fa-check"></i><b>35.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="35.3" data-path="framework-for-generalization.html"><a href="framework-for-generalization.html"><i class="fa fa-check"></i><b>35.3</b> Framework for Generalization</a></li>
<li class="chapter" data-level="35.4" data-path="steps-for-matching.html"><a href="steps-for-matching.html"><i class="fa fa-check"></i><b>35.4</b> Steps for Matching</a>
<ul>
<li class="chapter" data-level="35.4.1" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-1-define-closeness-distance-metrics"><i class="fa fa-check"></i><b>35.4.1</b> Step 1: Define “Closeness” (Distance Metrics)</a></li>
<li class="chapter" data-level="35.4.2" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-2-matching-algorithms"><i class="fa fa-check"></i><b>35.4.2</b> Step 2: Matching Algorithms</a></li>
<li class="chapter" data-level="35.4.3" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-3-diagnosing-match-quality"><i class="fa fa-check"></i><b>35.4.3</b> Step 3: Diagnosing Match Quality</a></li>
<li class="chapter" data-level="35.4.4" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-4-estimating-treatment-effects"><i class="fa fa-check"></i><b>35.4.4</b> Step 4: Estimating Treatment Effects</a></li>
</ul></li>
<li class="chapter" data-level="35.5" data-path="special-considerations.html"><a href="special-considerations.html"><i class="fa fa-check"></i><b>35.5</b> Special Considerations</a></li>
<li class="chapter" data-level="35.6" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html"><i class="fa fa-check"></i><b>35.6</b> Choosing a Matching Strategy</a>
<ul>
<li class="chapter" data-level="35.6.1" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#based-on-estimand"><i class="fa fa-check"></i><b>35.6.1</b> Based on Estimand</a></li>
<li class="chapter" data-level="35.6.2" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#based-on-diagnostics"><i class="fa fa-check"></i><b>35.6.2</b> Based on Diagnostics</a></li>
<li class="chapter" data-level="35.6.3" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#selection-criteria"><i class="fa fa-check"></i><b>35.6.3</b> Selection Criteria</a></li>
</ul></li>
<li class="chapter" data-level="35.7" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html"><i class="fa fa-check"></i><b>35.7</b> Matching vs. Regression</a>
<ul>
<li class="chapter" data-level="35.7.1" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#matching-estimand"><i class="fa fa-check"></i><b>35.7.1</b> Matching Estimand</a></li>
<li class="chapter" data-level="35.7.2" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#regression-estimand"><i class="fa fa-check"></i><b>35.7.2</b> Regression Estimand</a></li>
<li class="chapter" data-level="35.7.3" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#interpretation-weighting-differences"><i class="fa fa-check"></i><b>35.7.3</b> Interpretation: Weighting Differences</a></li>
</ul></li>
<li class="chapter" data-level="35.8" data-path="software-and-practical-implementation.html"><a href="software-and-practical-implementation.html"><i class="fa fa-check"></i><b>35.8</b> Software and Practical Implementation</a></li>
<li class="chapter" data-level="35.9" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html"><i class="fa fa-check"></i><b>35.9</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="35.9.1" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-with-matchit"><i class="fa fa-check"></i><b>35.9.1</b> Matching with <code>MatchIt</code></a></li>
<li class="chapter" data-level="35.9.2" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#reporting-standards"><i class="fa fa-check"></i><b>35.9.2</b> Reporting Standards</a></li>
<li class="chapter" data-level="35.9.3" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#optimization-based-matching-via-designmatch"><i class="fa fa-check"></i><b>35.9.3</b> Optimization-Based Matching via <code>designmatch</code></a></li>
<li class="chapter" data-level="35.9.4" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>35.9.4</b> MatchingFrontier</a></li>
<li class="chapter" data-level="35.9.5" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-propensity-scores"><i class="fa fa-check"></i><b>35.9.5</b> Propensity Scores</a></li>
<li class="chapter" data-level="35.9.6" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-mahalanobis"><i class="fa fa-check"></i><b>35.9.6</b> Mahalanobis Distance Matching</a></li>
<li class="chapter" data-level="35.9.7" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-cem"><i class="fa fa-check"></i><b>35.9.7</b> Coarsened Exact Matching (CEM)</a></li>
<li class="chapter" data-level="35.9.8" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-genetic-matching"><i class="fa fa-check"></i><b>35.9.8</b> Genetic Matching</a></li>
<li class="chapter" data-level="35.9.9" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>35.9.9</b> Entropy Balancing</a></li>
<li class="chapter" data-level="35.9.10" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>35.9.10</b> Matching for High-Dimensional Data</a></li>
<li class="chapter" data-level="35.9.11" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>35.9.11</b> Matching for Multiple Treatments</a></li>
<li class="chapter" data-level="35.9.12" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>35.9.12</b> Matching for Multi-Level Treatments</a></li>
<li class="chapter" data-level="35.9.13" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-repeated-treatments-time-varying-treatments"><i class="fa fa-check"></i><b>35.9.13</b> Matching for Repeated Treatments (Time-Varying Treatments)</a></li>
</ul></li>
<li class="chapter" data-level="35.10" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html"><i class="fa fa-check"></i><b>35.10</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="35.10.1" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-rosenbaum-bounds"><i class="fa fa-check"></i><b>35.10.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="35.10.2" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-relative-correlation-restrictions"><i class="fa fa-check"></i><b>35.10.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="35.10.3" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-coefficient-stability-bounds"><i class="fa fa-check"></i><b>35.10.3</b> Coefficient-Stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="36" data-path="sec-endogeneity.html"><a href="sec-endogeneity.html"><i class="fa fa-check"></i><b>36</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="36.1" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html"><i class="fa fa-check"></i><b>36.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-measurement-error"><i class="fa fa-check"></i><b>36.1.1</b> Measurement Errors</a></li>
<li class="chapter" data-level="36.1.2" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-simultaneity"><i class="fa fa-check"></i><b>36.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="36.1.3" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-reverse-causality"><i class="fa fa-check"></i><b>36.1.3</b> Reverse Causality</a></li>
<li class="chapter" data-level="36.1.4" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-omitted-variable-bias"><i class="fa fa-check"></i><b>36.1.4</b> Omitted Variable Bias</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html"><i class="fa fa-check"></i><b>36.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#unifying-model-frameworks"><i class="fa fa-check"></i><b>36.2.1</b> Unifying Model Frameworks</a></li>
<li class="chapter" data-level="36.2.2" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#estimation-methods-2"><i class="fa fa-check"></i><b>36.2.2</b> Estimation Methods</a></li>
<li class="chapter" data-level="36.2.3" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#theoretical-connections"><i class="fa fa-check"></i><b>36.2.3</b> Theoretical Connections</a></li>
<li class="chapter" data-level="36.2.4" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#tobit-2-heckmans-sample-selection-model"><i class="fa fa-check"></i><b>36.2.4</b> Tobit-2: Heckman’s Sample Selection Model</a></li>
<li class="chapter" data-level="36.2.5" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#tobit-5-switching-regression-model"><i class="fa fa-check"></i><b>36.2.5</b> Tobit-5: Switching Regression Model</a></li>
<li class="chapter" data-level="36.2.6" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#sec-pattern-mixture-models"><i class="fa fa-check"></i><b>36.2.6</b> Pattern-Mixture Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>37</b> Other Biases</a>
<ul>
<li class="chapter" data-level="37.1" data-path="sec-aggregation-bias.html"><a href="sec-aggregation-bias.html"><i class="fa fa-check"></i><b>37.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="sec-aggregation-bias.html"><a href="sec-aggregation-bias.html#simpsons-paradox-1"><i class="fa fa-check"></i><b>37.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="sec-contamination-bias.html"><a href="sec-contamination-bias.html"><i class="fa fa-check"></i><b>37.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="37.3" data-path="sec-survivorship-bias.html"><a href="sec-survivorship-bias.html"><i class="fa fa-check"></i><b>37.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="37.4" data-path="sec-publication-bias.html"><a href="sec-publication-bias.html"><i class="fa fa-check"></i><b>37.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="sec-directed-acyclic-graphs.html"><a href="sec-directed-acyclic-graphs.html"><i class="fa fa-check"></i><b>38</b> Directed Acyclic Graphs</a>
<ul>
<li class="chapter" data-level="38.1" data-path="basic-notation-and-graph-structures.html"><a href="basic-notation-and-graph-structures.html"><i class="fa fa-check"></i><b>38.1</b> Basic Notation and Graph Structures</a></li>
<li class="chapter" data-level="38.2" data-path="rule-of-thumb-for-causal-inference.html"><a href="rule-of-thumb-for-causal-inference.html"><i class="fa fa-check"></i><b>38.2</b> Rule of Thumb for Causal Inference</a></li>
<li class="chapter" data-level="38.3" data-path="example-dag.html"><a href="example-dag.html"><i class="fa fa-check"></i><b>38.3</b> Example DAG</a></li>
<li class="chapter" data-level="38.4" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>38.4</b> Causal Discovery</a></li>
<li class="chapter" data-level="38.5" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>38.5</b> </a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="sec-controls.html"><a href="sec-controls.html"><i class="fa fa-check"></i><b>39</b> Controls</a>
<ul>
<li class="chapter" data-level="39.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>39.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="39.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>39.1.1</b> M-bias</a></li>
<li class="chapter" data-level="39.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification-1"><i class="fa fa-check"></i><b>39.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="39.1.3" data-path="bad-controls.html"><a href="bad-controls.html#sec-overcontrol-bias"><i class="fa fa-check"></i><b>39.1.3</b> Overcontrol Bias</a></li>
<li class="chapter" data-level="39.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>39.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="39.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>39.1.5</b> Case-Control Bias</a></li>
<li class="chapter" data-level="39.1.6" data-path="bad-controls.html"><a href="bad-controls.html#summary-3"><i class="fa fa-check"></i><b>39.1.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="39.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>39.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>39.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="39.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>39.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="39.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>39.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="39.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>39.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="39.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>39.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="39.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>39.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="39.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>39.3.4</b> Bad Selection Bias</a></li>
<li class="chapter" data-level="39.3.5" data-path="neutral-controls.html"><a href="neutral-controls.html#summary-table-predictive-vs.-causal-utility-of-controls"><i class="fa fa-check"></i><b>39.3.5</b> Summary Table: Predictive vs. Causal Utility of Controls</a></li>
</ul></li>
<li class="chapter" data-level="39.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>39.4</b> Choosing Controls</a>
<ul>
<li class="chapter" data-level="39.4.1" data-path="choosing-controls.html"><a href="choosing-controls.html#step-1-use-a-causal-diagram-dag"><i class="fa fa-check"></i><b>39.4.1</b> Step 1: Use a Causal Diagram (DAG)</a></li>
<li class="chapter" data-level="39.4.2" data-path="choosing-controls.html"><a href="choosing-controls.html#step-2-use-algorithmic-tools"><i class="fa fa-check"></i><b>39.4.2</b> Step 2: Use Algorithmic Tools</a></li>
<li class="chapter" data-level="39.4.3" data-path="choosing-controls.html"><a href="choosing-controls.html#step-3-theoretical-principles"><i class="fa fa-check"></i><b>39.4.3</b> Step 3: Theoretical Principles</a></li>
<li class="chapter" data-level="39.4.4" data-path="choosing-controls.html"><a href="choosing-controls.html#step-4-consider-sensitivity-analysis"><i class="fa fa-check"></i><b>39.4.4</b> Step 4: Consider Sensitivity Analysis</a></li>
<li class="chapter" data-level="39.4.5" data-path="choosing-controls.html"><a href="choosing-controls.html#step-5-know-when-not-to-control"><i class="fa fa-check"></i><b>39.4.5</b> Step 5: Know When Not to Control</a></li>
<li class="chapter" data-level="39.4.6" data-path="choosing-controls.html"><a href="choosing-controls.html#summary-control-selection-pipeline"><i class="fa fa-check"></i><b>39.4.6</b> Summary: Control Selection Pipeline</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="40" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>40</b> Report</a>
<ul>
<li class="chapter" data-level="40.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>40.1</b> One summary table</a></li>
<li class="chapter" data-level="40.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>40.2</b> Model Comparison</a></li>
<li class="chapter" data-level="40.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>40.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="40.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>40.4</b> Standard Errors</a></li>
<li class="chapter" data-level="40.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>40.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="40.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>40.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="40.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>40.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>41</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="42" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>42</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="42.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>42.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="42.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>42.1.1</b> starbility</a></li>
<li class="chapter" data-level="42.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>42.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="42.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>42.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="42.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>42.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>43</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>43.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>43.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="43.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>43.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="43.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>43.1.3</b> Exceptions to Replication</a></li>
<li class="chapter" data-level="43.1.4" data-path="the-replication-standard.html"><a href="the-replication-standard.html#replication-landscape"><i class="fa fa-check"></i><b>43.1.4</b> Replication Landscape</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="synthetic-data.html"><a href="synthetic-data.html"><i class="fa fa-check"></i><b>43.2</b> Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="synthetic-data.html"><a href="synthetic-data.html#benefits-of-synthetic-data"><i class="fa fa-check"></i><b>43.2.1</b> Benefits of Synthetic Data</a></li>
<li class="chapter" data-level="43.2.2" data-path="synthetic-data.html"><a href="synthetic-data.html#concerns-and-limitations"><i class="fa fa-check"></i><b>43.2.2</b> Concerns and Limitations</a></li>
<li class="chapter" data-level="43.2.3" data-path="synthetic-data.html"><a href="synthetic-data.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>43.2.3</b> Further Insights on Synthetic Data</a></li>
<li class="chapter" data-level="43.2.4" data-path="synthetic-data.html"><a href="synthetic-data.html#generating-synthetic-data"><i class="fa fa-check"></i><b>43.2.4</b> Generating Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>43.3</b> Application</a>
<ul>
<li class="chapter" data-level="43.3.1" data-path="application-5.html"><a href="application-5.html#original-dataset"><i class="fa fa-check"></i><b>43.3.1</b> Original Dataset</a></li>
<li class="chapter" data-level="43.3.2" data-path="application-5.html"><a href="application-5.html#restricted-dataset"><i class="fa fa-check"></i><b>43.3.2</b> Restricted Dataset</a></li>
<li class="chapter" data-level="43.3.3" data-path="application-5.html"><a href="application-5.html#synthpop"><i class="fa fa-check"></i><b>43.3.3</b> Synthpop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>44</b> High-Performance Computing</a>
<ul>
<li class="chapter" data-level="44.1" data-path="best-practices-for-hpc-in-data-analysis.html"><a href="best-practices-for-hpc-in-data-analysis.html"><i class="fa fa-check"></i><b>44.1</b> Best Practices for HPC in Data Analysis</a></li>
<li class="chapter" data-level="44.2" data-path="example-workflow-in-r.html"><a href="example-workflow-in-r.html"><i class="fa fa-check"></i><b>44.2</b> Example Workflow in R</a></li>
<li class="chapter" data-level="44.3" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>44.3</b> Recommendations</a></li>
<li class="chapter" data-level="44.4" data-path="demonstration.html"><a href="demonstration.html"><i class="fa fa-check"></i><b>44.4</b> Demonstration</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="git.html"><a href="git.html#basic-setup-1"><i class="fa fa-check"></i><b>A.1.1</b> Basic Setup</a></li>
<li class="chapter" data-level="A.1.2" data-path="git.html"><a href="git.html#creating-a-repository"><i class="fa fa-check"></i><b>A.1.2</b> Creating a Repository</a></li>
<li class="chapter" data-level="A.1.3" data-path="git.html"><a href="git.html#tracking-changes"><i class="fa fa-check"></i><b>A.1.3</b> Tracking Changes</a></li>
<li class="chapter" data-level="A.1.4" data-path="git.html"><a href="git.html#viewing-history-and-changes"><i class="fa fa-check"></i><b>A.1.4</b> Viewing History and Changes</a></li>
<li class="chapter" data-level="A.1.5" data-path="git.html"><a href="git.html#ignoring-files"><i class="fa fa-check"></i><b>A.1.5</b> Ignoring Files</a></li>
<li class="chapter" data-level="A.1.6" data-path="git.html"><a href="git.html#remote-repositories"><i class="fa fa-check"></i><b>A.1.6</b> Remote Repositories</a></li>
<li class="chapter" data-level="A.1.7" data-path="git.html"><a href="git.html#collaboration"><i class="fa fa-check"></i><b>A.1.7</b> Collaboration</a></li>
<li class="chapter" data-level="A.1.8" data-path="git.html"><a href="git.html#branching-and-merging"><i class="fa fa-check"></i><b>A.1.8</b> Branching and Merging</a></li>
<li class="chapter" data-level="A.1.9" data-path="git.html"><a href="git.html#handling-conflicts"><i class="fa fa-check"></i><b>A.1.9</b> Handling Conflicts</a></li>
<li class="chapter" data-level="A.1.10" data-path="git.html"><a href="git.html#licensing"><i class="fa fa-check"></i><b>A.1.10</b> Licensing</a></li>
<li class="chapter" data-level="A.1.11" data-path="git.html"><a href="git.html#citing-repositories"><i class="fa fa-check"></i><b>A.1.11</b> Citing Repositories</a></li>
<li class="chapter" data-level="A.1.12" data-path="git.html"><a href="git.html#hosting-and-legal-considerations"><i class="fa fa-check"></i><b>A.1.12</b> Hosting and Legal Considerations</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install All Necessary Packages on Your Local Machine</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html#step-1-export-installed-packages-from-your-current-session"><i class="fa fa-check"></i><b>A.5.1</b> Step 1: Export Installed Packages from Your Current Session</a></li>
<li class="chapter" data-level="A.5.2" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html#step-2-install-packages-on-a-new-machine"><i class="fa fa-check"></i><b>A.5.2</b> Step 2: Install Packages on a New Machine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="references.html"><a href="references.html#cluster-randomization"><i class="fa fa-check"></i><b>B.3.1</b> Cluster Randomization</a></li>
<li class="chapter" data-level="B.4" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html"><i class="fa fa-check"></i><b>B.4</b> 5 Methodological Blueprint for Applied Researchers</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#diagnosing-interference"><i class="fa fa-check"></i><b>B.4.1</b> 5.1 Diagnosing Interference</a></li>
<li class="chapter" data-level="B.4.2" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#cluster-construction-algorithm"><i class="fa fa-check"></i><b>B.4.2</b> 5.2 Cluster Construction Algorithm</a></li>
<li class="chapter" data-level="B.4.3" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#analysis-plan"><i class="fa fa-check"></i><b>B.4.3</b> 5.3 Analysis Plan</a></li>
<li class="chapter" data-level="B.4.4" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#practical-considerations-9"><i class="fa fa-check"></i><b>B.4.4</b> 5.4 Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="extensions-and-research-opportunities.html"><a href="extensions-and-research-opportunities.html"><i class="fa fa-check"></i><b>B.5</b> 6 Extensions and Research Opportunities</a></li>
<li class="chapter" data-level="B.6" data-path="pre-experiment-checklist.html"><a href="pre-experiment-checklist.html"><i class="fa fa-check"></i><b>B.6</b> 7 Pre-Experiment Checklist</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="chapter-cluster-randomization-and-interference-bias.html"><a href="chapter-cluster-randomization-and-interference-bias.html"><i class="fa fa-check"></i><b>C</b> Chapter: Cluster Randomization and Interference Bias</a>
<ul>
<li class="chapter" data-level="C.1" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html"><i class="fa fa-check"></i><b>C.1</b> 6. Implementation: Practical Guidelines</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#constructing-clusters"><i class="fa fa-check"></i><b>C.1.1</b> 6.1 Constructing Clusters</a></li>
<li class="chapter" data-level="C.1.2" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#evaluating-cluster-quality"><i class="fa fa-check"></i><b>C.1.2</b> 6.2 Evaluating Cluster Quality</a></li>
<li class="chapter" data-level="C.1.3" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#trade-offs"><i class="fa fa-check"></i><b>C.1.3</b> 6.3 Trade-offs</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="limitations-and-open-questions.html"><a href="limitations-and-open-questions.html"><i class="fa fa-check"></i><b>C.2</b> 8. Limitations and Open Questions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-endogenous-sample-selection" class="section level2 hasAnchor" number="36.2">
<h2><span class="header-section-number">36.2</span> Endogenous Sample Selection<a href="sec-endogenous-sample-selection.html#sec-endogenous-sample-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Endogenous sample selection arises in <strong>observational</strong> or <strong>non-experimental</strong> research whenever the inclusion of observations (or assignment to treatment) is <strong>not random</strong>, and the same unobservable factors influencing selection also affect the outcome of interest. This scenario leads to <strong>biased and inconsistent</strong> estimates of causal parameters (e.g., <a href="types-of-treatment-effects.html#sec-average-treatment-effect">Average Treatment Effect</a>) if not properly addressed.</p>
<p>This problem was first formalized in the econometric literature by <span class="citation">J. Heckman (<a href="#ref-heckman1974shadow">1974</a>)</span>, <span class="citation">J. J. Heckman (<a href="#ref-heckman1976common">1976b</a>)</span>, and <span class="citation">J. J. Heckman (<a href="#ref-heckman1979sample">1979</a>)</span>, whose work addressed the issue in the context of labor force participation among women. Later, <span class="citation">Amemiya (<a href="#ref-amemiya1984tobit">1984</a>)</span> generalize the method. Now, it has since been applied widely across social sciences, epidemiology, marketing, and finance.</p>
<p>Endogenous sample selection is often conflated with general selection bias, but it is important to understand that sample selection refers specifically to the inclusion of observations into the estimation sample, not just to assignment into treatment (i.e., selection bias).</p>
<p>This problem comes in many names such as self-selection problem, incidental truncation, or omitted variable (i.e., the omitted variable is how people were selected into the sample). Some disciplines consider nonresponse/selection bias as sample selection:</p>
<ul>
<li>When unobservable factors that affect who is in the sample are independent of unobservable factors that affect the outcome, the sample selection is not endogenous. Hence, the sample selection is ignorable and estimator that ignores sample selection is still consistent.</li>
<li>When the unobservable factors that affect who is included in the sample are correlated with the unobservable factors that affect the outcome, the sample selection is endogenous and not ignorable, because estimators that ignore endogenous sample selection are not consistent (we don’t know which part of the observable outcome is related to the causal relationship and which part is due to different people were selected for the treatment and control groups).</li>
</ul>
<p>Many evaluation studies use observational data, and in such data:</p>
<ul>
<li>Participants are not randomly assigned.</li>
<li>Treatment or exposure is determined by individual or institutional choices.</li>
<li>Counterfactual outcomes are not observed.</li>
<li>The treatment indicator is often endogenous.</li>
</ul>
<p>Some notable terminologies include:</p>
<ol style="list-style-type: decimal">
<li><strong>Truncation</strong>: Occurs when data are collected only from a restricted subpopulation based on the value of a variable.
<ul>
<li><strong>Left truncation</strong>: Values below a threshold are excluded (e.g., only high-income individuals are surveyed).</li>
<li><strong>Right truncation</strong>: Values above a threshold are excluded.</li>
</ul></li>
<li><strong>Censoring</strong>: Occurs when the variable is <strong>observed but coarsened</strong> beyond a threshold.
<ul>
<li>E.g., incomes below a certain level are coded as zero; arrest counts above a threshold are top-coded.</li>
</ul></li>
<li><strong>Incidental Truncation</strong>: Refers to selection based on a latent variable (e.g., employment decisions), <strong>not directly observed</strong>. This is what makes Heckman’s model distinct.
<ul>
<li>Also called <strong>non-random sample selection</strong>.</li>
<li>The error in the outcome equation is correlated with the selection indicator.</li>
</ul></li>
</ol>
<p>Researchers often categorize self-selection into:</p>
<ul>
<li><strong>Negative (Mitigation-Based) Selection:</strong> Individuals select into a treatment or sample to address an existing problem, so they start off with worse potential outcomes.
<ul>
<li>Bias direction: Underestimates true treatment effects (makes the treatment look less effective than it is).</li>
<li>Individuals select into treatment to combat a problem they already face.</li>
<li><strong>Examples</strong>:
<ul>
<li>People at high risk of severe illness (e.g., elderly or immunocompromised individuals) are more likely to get vaccinated. If we compare vaccinated vs. unvaccinated individuals without adjusting for risk factors, we might mistakenly conclude that vaccines are ineffective simply because vaccinated individuals had worse initial health conditions.</li>
<li>Evaluating the effect of job training programs—unemployed individuals with the greatest difficulty finding jobs are most likely to enroll, leading to underestimated program benefits.</li>
</ul></li>
</ul></li>
<li><strong>Positive (Preference-Based) Selection:</strong> Individuals select into a treatment or sample because they have advantageous traits, preferences, or resources. Hence, those who take treatment are systematically better off compared to those who do not.
<ul>
<li>Bias direction: Overestimates true treatment effects (makes the treatment look more effective than it is).</li>
<li>Individuals select into treatment because they inherently prefer it, rather than because of an underlying problem.</li>
<li><strong>Examples:</strong>
<ul>
<li>People who are health-conscious and physically active are more likely to join a fitness program. If we compare fitness program participants to non-participants, we might falsely attribute their better health outcomes to the program, when in reality, their pre-existing lifestyle contributed to their improved health.</li>
<li>Evaluating the effect of private school education—students who attend private schools often come from wealthier families with greater academic support, making it difficult to isolate the true impact of the school itself.</li>
</ul></li>
</ul></li>
</ul>
<p>Both forms of selection reflect correlation between <strong>unobservables</strong> (driving selection) and <strong>potential outcomes</strong>—the hallmark of <strong>endogenous selection bias</strong>.</p>
<hr />
<p>Some seminal applied works in this area include:</p>
<ol style="list-style-type: decimal">
<li><strong>Labor Force Participation</strong> <span class="citation">(<a href="#ref-heckman1974shadow">J. Heckman 1974</a>)</span></li>
</ol>
<ul>
<li>Wages are observed <strong>only</strong> for women who choose to work.</li>
<li>Unobservable preferences (reservation wages) drive participation.</li>
<li>Ignoring this leads to <strong>biased estimates of the returns to education</strong>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Union Membership</strong> <span class="citation">(<a href="#ref-lewis1986union">Lewis 1986</a>)</span></li>
</ol>
<ul>
<li>Wages differ between union and non-union workers.</li>
<li>But union membership is <strong>not exogenous</strong>—workers choose to join based on anticipated benefits.</li>
<li>Naïve OLS yields biased estimates of union premium.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>College Attendance</strong> <span class="citation">(<a href="#ref-card1999causal">Card 1999</a>, <a href="#ref-card2001estimating">2001</a>)</span></li>
</ol>
<ul>
<li>Comparing income of college graduates vs. non-graduates.</li>
<li>Attending college is a choice based on expected gains, ability, or family background.</li>
<li>A treatment effect model (described next) is more appropriate here.</li>
</ul>
<hr />
<div id="unifying-model-frameworks" class="section level3 hasAnchor" number="36.2.1">
<h3><span class="header-section-number">36.2.1</span> Unifying Model Frameworks<a href="sec-endogenous-sample-selection.html#unifying-model-frameworks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Though often conflated, there are several overlapping models to address endogenous selection:</p>
<ol style="list-style-type: decimal">
<li><a href="sec-endogenous-sample-selection.html#sec-sample-selection-model">Sample Selection Model</a> <span class="citation">(<a href="#ref-heckman1979sample">J. J. Heckman 1979</a>)</span>: Outcome is <em>unobserved</em> if an agent is not selected into the sample.</li>
<li><a href="sec-endogenous-sample-selection.html#sec-treatment-effect-switching-model">Treatment Effect Model</a>: Outcome is observed for both groups (treated vs. untreated), but treatment assignment is endogenous.</li>
<li><a href="sec-endogenous-sample-selection.html#sec-heckman-type-control-function">Heckman-Type / Control Function Approaches</a>: Decompose the endogenous regressor or incorporate a correction term (Inverse Mills Ratio or residual) to control for endogeneity.</li>
</ol>
<p>All revolve around the challenge: unobserved factors affect both who is included (or treated) and outcomes.</p>
<p>To formalize the problem, we consider the outcome and selection equations. Let:</p>
<ul>
<li><span class="math inline">\(y_i\)</span>: observed outcome (e.g., wage)</li>
<li><span class="math inline">\(x_i\)</span>: covariates affecting outcome</li>
<li><span class="math inline">\(z_i\)</span>: covariates affecting selection</li>
<li><span class="math inline">\(w_i\)</span>: binary indicator for selection into the sample (e.g., employment)</li>
</ul>
<div id="sec-sample-selection-model" class="section level4 hasAnchor" number="36.2.1.1">
<h4><span class="header-section-number">36.2.1.1</span> Sample Selection Model<a href="sec-endogenous-sample-selection.html#sec-sample-selection-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We begin with an <strong>outcome equation</strong>, which describes the variable of interest <span class="math inline">\(y_i\)</span>. However, we only observe <span class="math inline">\(y_i\)</span> if a certain <strong>selection mechanism</strong> indicates it is part of the sample. That mechanism is captured by a binary indicator <span class="math inline">\(w_i = 1\)</span>. Formally, the observed outcome equation is:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;= x_i&#39; \beta + \varepsilon_i, \quad &amp;\text{(Observed only if } w_i = 1\text{)}, \\
\varepsilon_i &amp;\sim N(0, \sigma_\varepsilon^2).
\end{aligned}
\]</span></p>
<p>Here, <span class="math inline">\(x_i\)</span> is a vector of explanatory variables (or covariates) that explain <span class="math inline">\(y_i\)</span>. The noise term <span class="math inline">\(\varepsilon_i\)</span> is assumed to be normally distributed with mean zero and variance <span class="math inline">\(\sigma_\varepsilon^2\)</span>. However, because we only see <span class="math inline">\(y_i\)</span> for those cases in which <span class="math inline">\(w_i = 1\)</span>, we must account for how the selection occurs.</p>
<p>Next, we specify the <strong>selection equation</strong> via a <strong>latent index model</strong>. Let <span class="math inline">\(w_i^*\)</span> be an unobserved latent variable:</p>
<p><span class="math display">\[
\begin{aligned}
w_i^* &amp;= z_i&#39; \gamma + u_i, \\
w_i &amp;= \begin{cases}
1 &amp; \text{if } w_i^* &gt; 0, \\
0 &amp; \text{otherwise}.
\end{cases}
\end{aligned}
\]</span></p>
<p>Here, <span class="math inline">\(z_i\)</span> is a vector of variables that influence whether or not <span class="math inline">\(y_i\)</span> is observed. In practice, <span class="math inline">\(z_i\)</span> may overlap with <span class="math inline">\(x_i\)</span>, but can also include variables not in the outcome equation. For <strong>identification</strong>, we normalize <span class="math inline">\(\mathrm{Var}(u_i) = 1\)</span>. This is analogous to the probit model’s standard normalization.</p>
<p>Because <span class="math inline">\(w_i = 1\)</span> exactly when <span class="math inline">\(w_i^* &gt; 0\)</span>, this event occurs if <span class="math inline">\(u_i \ge -\,z_i&#39; \gamma\)</span>. Therefore,</p>
<p><span class="math display">\[
\begin{aligned}
P(w_i = 1)
&amp;= P\bigl(u_i \ge -z_i&#39; \gamma\bigr),\\
&amp;= 1 - \Phi\bigl(-z_i&#39;\gamma\bigr), \\
&amp;= \Phi\bigl(z_i&#39;\gamma\bigr),
\end{aligned}
\]</span></p>
<p>where we use the symmetry of the standard normal distribution.</p>
<p>We assume <span class="math inline">\((\varepsilon_i, u_i)\)</span> are <strong>jointly normally distributed</strong> with correlation <span class="math inline">\(\rho\)</span>. In other words,</p>
<p><span class="math display">\[
\begin{pmatrix}
\varepsilon_i \\
u_i
\end{pmatrix}
\;\sim\; \mathcal{N} \!\Biggl(
\begin{pmatrix} 0 \\ 0 \end{pmatrix},
\begin{pmatrix} \sigma^2_\varepsilon &amp; \rho \,\sigma_\varepsilon \\
\rho \,\sigma_\varepsilon &amp; 1 \end{pmatrix}
\Biggr).
\]</span></p>
<ul>
<li>If <span class="math inline">\(\rho = 0\)</span>, the selection is exogenous: whether <span class="math inline">\(y_i\)</span> is observed is unrelated to unobserved determinants of <span class="math inline">\(y_i\)</span>.</li>
<li>If <span class="math inline">\(\rho \neq 0\)</span>, <strong>sample selection is endogenous</strong>. Failing to model this selection mechanism leads to biased estimates of <span class="math inline">\(\beta\)</span>.</li>
</ul>
<p>Interpreting <span class="math inline">\(\rho\)</span></p>
<ul>
<li><span class="math inline">\(\rho &gt; 0\)</span>: Individuals with higher unobserved components in <span class="math inline">\(\varepsilon_i\)</span> (and thus typically larger <span class="math inline">\(y_i\)</span>) are <strong>more likely</strong> to appear in the sample. (Positive selection)</li>
<li><span class="math inline">\(\rho &lt; 0\)</span>: Individuals with higher unobserved components in <span class="math inline">\(\varepsilon_i\)</span> are <strong>less likely</strong> to appear. (Negative selection)</li>
<li><span class="math inline">\(\rho = 0\)</span>: No endogenous selection. Observed outcomes are effectively random with respect to the unobserved part of <span class="math inline">\(y_i\)</span>.</li>
</ul>
<p>In empirical practice, <span class="math inline">\(\rho\)</span> signals the direction of bias one might expect if the selection process is ignored.</p>
<p>Often, it is helpful to visualize how part of the distribution of <span class="math inline">\(u_i\)</span> (the error in the selection equation) is truncated based on the threshold <span class="math inline">\(w_i^*&gt;0\)</span>. Below is a notional R code snippet that draws a normal density and shades the region where <span class="math inline">\(u_i &gt; -z_i&#39;\gamma\)</span>.</p>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="sec-endogenous-sample-selection.html#cb958-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">200</span>)</span>
<span id="cb958-2"><a href="sec-endogenous-sample-selection.html#cb958-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb958-3"><a href="sec-endogenous-sample-selection.html#cb958-3" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb958-4"><a href="sec-endogenous-sample-selection.html#cb958-4" tabindex="-1"></a>     y,</span>
<span id="cb958-5"><a href="sec-endogenous-sample-selection.html#cb958-5" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb958-6"><a href="sec-endogenous-sample-selection.html#cb958-6" tabindex="-1"></a>     <span class="at">main =</span>  <span class="fu">bquote</span>(<span class="st">&quot;Probabibility distribution of&quot;</span> <span class="sc">~</span> u[i]))</span>
<span id="cb958-7"><a href="sec-endogenous-sample-selection.html#cb958-7" tabindex="-1"></a></span>
<span id="cb958-8"><a href="sec-endogenous-sample-selection.html#cb958-8" tabindex="-1"></a>x_shaded <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb958-9"><a href="sec-endogenous-sample-selection.html#cb958-9" tabindex="-1"></a>y_shaded <span class="ot">=</span> <span class="fu">dnorm</span>(x_shaded, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb958-10"><a href="sec-endogenous-sample-selection.html#cb958-10" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, x_shaded, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>, y_shaded, <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb958-11"><a href="sec-endogenous-sample-selection.html#cb958-11" tabindex="-1"></a></span>
<span id="cb958-12"><a href="sec-endogenous-sample-selection.html#cb958-12" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fu">expression</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">Phi</span>(<span class="sc">-</span>z[i] <span class="sc">*</span> gamma)))</span>
<span id="cb958-13"><a href="sec-endogenous-sample-selection.html#cb958-13" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="fl">0.15</span>)</span>
<span id="cb958-14"><a href="sec-endogenous-sample-selection.html#cb958-14" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.12</span>, <span class="fu">expression</span>(<span class="sc">-</span>z[i] <span class="sc">*</span> gamma))</span>
<span id="cb958-15"><a href="sec-endogenous-sample-selection.html#cb958-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb958-16"><a href="sec-endogenous-sample-selection.html#cb958-16" tabindex="-1"></a>       <span class="st">&quot;Gray = Prob of Observed&quot;</span>,</span>
<span id="cb958-17"><a href="sec-endogenous-sample-selection.html#cb958-17" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb958-18"><a href="sec-endogenous-sample-selection.html#cb958-18" tabindex="-1"></a>       <span class="at">inset =</span> <span class="fl">0.02</span>)</span></code></pre></div>
<p><img src="36-endogeneity_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>In this figure, the gray‐shaded area represents <span class="math inline">\(u_i &gt; -z_i&#39;\gamma\)</span>. Observations in that range are included in the sample. If <span class="math inline">\(\rho\neq 0\)</span>, then the unobserved factors that drive <span class="math inline">\(u_i\)</span> also affect <span class="math inline">\(\varepsilon_i\)</span>, causing a non‐representative sample of <span class="math inline">\(\varepsilon_i\)</span>.</p>
<p>A core insight of the Heckman model is the conditional expectation of <span class="math inline">\(y_i\)</span> given <span class="math inline">\(w_i=1\)</span>:</p>
<p><span class="math display">\[
E\bigl(y_i \mid w_i = 1\bigr)
\;=\;
E\bigl(y_i \mid w_i^*&gt;0\bigr)
\;=\;
E\bigl(x_i&#39;\beta + \varepsilon_i \mid u_i &gt; -z_i&#39;\gamma\bigr).
\]</span></p>
<p>Since <span class="math inline">\(x_i&#39;\beta\)</span> is nonrandom (conditional on <span class="math inline">\(x_i\)</span>), we get</p>
<p><span class="math display">\[
E\bigl(y_i \mid w_i=1\bigr)
= x_i&#39;\beta + E\bigl(\varepsilon_i \mid u_i &gt; -z_i&#39;\gamma\bigr).
\]</span></p>
<p>From bivariate normal properties:</p>
<p><span class="math display">\[
\varepsilon_i \,\bigl\lvert\, u_i=a
\;\sim\;
N\!\Bigl(\rho\,\sigma_{\varepsilon}\cdot a,\; (1-\rho^2)\,\sigma_{\varepsilon}^2\Bigr).
\]</span></p>
<p>Thus,</p>
<p><span class="math display">\[
E\bigl(\varepsilon_i \mid u_i &gt; -z_i&#39;\gamma\bigr)
=\;
\rho\,\sigma_{\varepsilon}\,
E\bigl(u_i \mid u_i &gt; -z_i&#39;\gamma\bigr).
\]</span></p>
<p>If <span class="math inline">\(U\sim N(0,1)\)</span>, then</p>
<p><span class="math display">\[
E(U \mid U&gt;a)
= \frac{\phi(a)}{1-\Phi(a)}
= \frac{\phi(a)}{\Phi(-a)},
\]</span> where <span class="math inline">\(\phi\)</span> is the standard normal pdf, <span class="math inline">\(\Phi\)</span> is the cdf. By symmetry, <span class="math inline">\(\phi(-a)=\phi(a)\)</span> and <span class="math inline">\(\Phi(-a)=1-\Phi(a)\)</span>. Letting <span class="math inline">\(a = -\,z_i&#39;\gamma\)</span> yields</p>
<p><span class="math display">\[
E\bigl(U \mid U &gt; -z_i&#39;\gamma\bigr)
= \frac{\phi(-z_i&#39;\gamma)}{1-\Phi(-z_i&#39;\gamma)}
= \frac{\phi(z_i&#39;\gamma)}{\Phi(z_i&#39;\gamma)}.
\]</span></p>
<p>Define the <strong>Inverse Mills Ratio</strong> (IMR) as</p>
<p><span class="math display">\[
\lambda(x)
= \frac{\phi(x)}{\Phi(x)}.
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
E\bigl(\varepsilon_i \mid u_i &gt; -z_i&#39;\gamma\bigr)
= \rho\,\sigma_{\varepsilon}\,\lambda\bigl(z_i&#39;\gamma\bigr),
\]</span> and therefore</p>
<p><span class="math display">\[
\boxed{
E\bigl(y_i \mid w_i=1\bigr)
= x_i&#39;\beta
\;+\;
\rho\,\sigma_{\varepsilon}\,
\frac{\phi\bigl(z_i&#39;\gamma\bigr)}{\Phi\bigl(z_i&#39;\gamma\bigr)}.
}
\]</span></p>
<p>This extra term is the so‐called <strong>Heckman correction</strong>.</p>
<p>The IMR appears in the two‐step procedure as a regressor for bias correction. It has useful derivatives:</p>
<p><span class="math display">\[
\frac{d}{dx}\Bigl[\text{IMR}(x)\Bigr]
= \frac{d}{dx}\Bigl[\frac{\phi(x)}{\Phi(x)}\Bigr]
= -x\,\text{IMR}(x)\;-\;\bigl[\text{IMR}(x)\bigr]^2.
\]</span></p>
<p>This arises from the quotient rule and the fact that <span class="math inline">\(\phi&#39;(x)=-x\phi(x)\)</span>, <span class="math inline">\(\Phi&#39;(x)=\phi(x)\)</span>. The derivative property also helps in interpreting marginal effects in selection models.</p>
<hr />
</div>
<div id="sec-treatment-effect-switching-model" class="section level4 hasAnchor" number="36.2.1.2">
<h4><span class="header-section-number">36.2.1.2</span> Treatment Effect (Switching) Model<a href="sec-endogenous-sample-selection.html#sec-treatment-effect-switching-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While the sample selection model is used when outcome is only observed for one group (e.g., <span class="math inline">\(D = 1\)</span>), the treatment effect model is used when outcomes are observed for both groups, but treatment assignment is endogenous.</p>
<p>Treatment Effect Model Equations:</p>
<ul>
<li>Outcome: <span class="math display">\[ y_i = x_i&#39; \beta + D_i \delta + \varepsilon_i \]</span></li>
<li>Selection: <span class="math display">\[ D_i^* = z_i&#39; \gamma + u_i \\ D_i = 1 \text{ if } D_i^* &gt; 0 \]</span></li>
</ul>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(D_i\)</span> is the treatment indicator.</p></li>
<li><p><span class="math inline">\((\varepsilon_i, u_i)\)</span> are again bivariate normal with correlation <span class="math inline">\(\rho\)</span>.</p></li>
</ul>
<p>The treatment effect model is sometimes called a <strong>switching regression</strong>.</p>
</div>
<div id="sec-heckman-type-control-function" class="section level4 hasAnchor" number="36.2.1.3">
<h4><span class="header-section-number">36.2.1.3</span> Heckman-Type vs. Control Function<a href="sec-endogenous-sample-selection.html#sec-heckman-type-control-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Heckman Sample Selection</strong>: Insert an Inverse Mills Ratio (IMR) to adjust the outcome equation for non-random truncation.</li>
<li><strong>Control Function</strong>: Residual-based or predicted-endogenous-variable approach that mirrors IV logic, but typically <em>still</em> requires an instrument or parametric assumption.</li>
</ul>
<table>
<caption>Differences between Heckman Sample Selection vs. Heckman-type correction</caption>
<colgroup>
<col width="7%" />
<col width="36%" />
<col width="56%" />
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td><strong>Heckman Sample Selection Model</strong></td>
<td><strong>Heckman-Type Corrections</strong></td>
</tr>
<tr class="even">
<td>When</td>
<td>Only observes one sample (treated), addressing selection bias directly.</td>
<td>Two samples are observed (treated and untreated), known as the control function approach.</td>
</tr>
<tr class="odd">
<td>Model</td>
<td>Probit</td>
<td>OLS (even for dummy endogenous variable)</td>
</tr>
<tr class="even">
<td>Integration of 1st stage</td>
<td>Also include a term (called Inverse Mills ratio) besides the endogenous variable.</td>
<td>Decompose the endogenous variable to get the part that is uncorrelated with the error terms of the outcome equation. Either use the predicted endogenous variable directly or include the residual from the first-stage equation.</td>
</tr>
<tr class="odd">
<td>Advantages and Assumptions</td>
<td>Provides a direct test for endogeneity via the coefficient of the inverse Mills ratio but requires the assumption of joint normality of errors.</td>
<td>Does not require the assumption of joint normality, but can’t test for endogeneity directly.</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="estimation-methods-2" class="section level3 hasAnchor" number="36.2.2">
<h3><span class="header-section-number">36.2.2</span> Estimation Methods<a href="sec-endogenous-sample-selection.html#estimation-methods-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="heckmans-two-step-estimator-heckit" class="section level4 hasAnchor" number="36.2.2.1">
<h4><span class="header-section-number">36.2.2.1</span> Heckman’s Two-Step Estimator (Heckit)<a href="sec-endogenous-sample-selection.html#heckmans-two-step-estimator-heckit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Step 1: Estimate Selection Equation with Probit</strong></p>
<p>We estimate the probability of being included in the sample: <span class="math display">\[ P(w_i = 1 \mid z_i) = \Phi(z_i&#39; \gamma) \]</span></p>
<p>From the estimated model, we compute the <strong>Inverse Mills Ratio (IMR)</strong>: <span class="math display">\[ \lambda_i = \frac{\phi(z_i&#39; \hat{\gamma})}{\Phi(z_i&#39; \hat{\gamma})} \]</span></p>
<p>This term captures the expected value of the error in the outcome equation, conditional on selection.</p>
<p><strong>Step 2: Include IMR in Outcome Equation</strong></p>
<p>We then estimate the regression: <span class="math display">\[ y_i = x_i&#39; \beta + \delta \lambda_i + \nu_i \]</span></p>
<ul>
<li>If <span class="math inline">\(\delta\)</span> is significantly different from 0, selection bias is present.</li>
<li><span class="math inline">\(\lambda_i\)</span> corrects for the non-random selection.</li>
<li>OLS on this augmented model yields consistent estimates of <span class="math inline">\(\beta\)</span> under the joint normality assumption.</li>
<li>Pros: Conceptually simple; widely used.</li>
<li>Cons: Relies heavily on the bivariate normal assumption for <span class="math inline">\((\varepsilon_i, u_i)\)</span>. If no good exclusion variable is available, identification rests on the functional form.</li>
</ul>
<p>Specifically, the model can be identified <strong>without an exclusion restriction</strong>, but in such cases, identification is driven purely by the <strong>non-linearity</strong> of the probit function and the normality assumption (through the IMR). This is <strong>fragile</strong>.</p>
<ul>
<li>With strong exclusion restriction for the covariate in the correction equation, the variation in this variable can help identify the control for selection.</li>
<li>With weak exclusion restriction, and the variable exists in both steps, it’s the assumed error structure that identifies the control for selection <span class="citation">(<a href="#ref-heckman2004using">J. Heckman and Navarro-Lozano 2004</a>)</span>.</li>
<li>In management, <span class="citation">Wolfolds and Siegel (<a href="#ref-wolfolds2019misaccounting">2019</a>)</span> found that papers should have valid exclusion conditions, because without these, simulations show that results using the Heckman method are less reliable than those obtained with OLS.</li>
</ul>
<p>For robust identification, we prefer an <strong>exclusion restriction</strong>:</p>
<ul>
<li>A variable that affects selection (through <span class="math inline">\(z_i\)</span>) but not the outcome.</li>
<li>Example: Distance to a training center might affect the probability of enrollment, but not post-training income.</li>
</ul>
<p>Without such a variable, the model relies solely on functional form.</p>
<p>The Heckman two-step estimation procedure is less efficient than FIML. One key limitation is that the two-step estimator does not fully exploit the joint distribution of the error terms across equations, leading to a loss of efficiency. Moreover, the two-step approach may introduce <strong>measurement error</strong> in the second stage. This arises because the inverse Mills ratio used in the second stage is itself an estimated regressor, which can lead to biased standard errors and inference.</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="sec-endogenous-sample-selection.html#cb959-1" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb959-2"><a href="sec-endogenous-sample-selection.html#cb959-2" tabindex="-1"></a><span class="co">#   SIM 1: Heckman 2-step #</span></span>
<span id="cb959-3"><a href="sec-endogenous-sample-selection.html#cb959-3" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb959-4"><a href="sec-endogenous-sample-selection.html#cb959-4" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(MASS))</span>
<span id="cb959-5"><a href="sec-endogenous-sample-selection.html#cb959-5" tabindex="-1"></a></span>
<span id="cb959-6"><a href="sec-endogenous-sample-selection.html#cb959-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb959-7"><a href="sec-endogenous-sample-selection.html#cb959-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb959-8"><a href="sec-endogenous-sample-selection.html#cb959-8" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb959-9"><a href="sec-endogenous-sample-selection.html#cb959-9" tabindex="-1"></a>beta_true <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb959-10"><a href="sec-endogenous-sample-selection.html#cb959-10" tabindex="-1"></a></span>
<span id="cb959-11"><a href="sec-endogenous-sample-selection.html#cb959-11" tabindex="-1"></a>gamma_true <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb959-12"><a href="sec-endogenous-sample-selection.html#cb959-12" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>)</span>
<span id="cb959-13"><a href="sec-endogenous-sample-selection.html#cb959-13" tabindex="-1"></a>errors <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), Sigma)</span>
<span id="cb959-14"><a href="sec-endogenous-sample-selection.html#cb959-14" tabindex="-1"></a></span>
<span id="cb959-15"><a href="sec-endogenous-sample-selection.html#cb959-15" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> errors[,<span class="dv">1</span>]</span>
<span id="cb959-16"><a href="sec-endogenous-sample-selection.html#cb959-16" tabindex="-1"></a>u       <span class="ot">&lt;-</span> errors[,<span class="dv">2</span>]</span>
<span id="cb959-17"><a href="sec-endogenous-sample-selection.html#cb959-17" tabindex="-1"></a></span>
<span id="cb959-18"><a href="sec-endogenous-sample-selection.html#cb959-18" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb959-19"><a href="sec-endogenous-sample-selection.html#cb959-19" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb959-20"><a href="sec-endogenous-sample-selection.html#cb959-20" tabindex="-1"></a></span>
<span id="cb959-21"><a href="sec-endogenous-sample-selection.html#cb959-21" tabindex="-1"></a><span class="co"># Selection</span></span>
<span id="cb959-22"><a href="sec-endogenous-sample-selection.html#cb959-22" tabindex="-1"></a>z_star <span class="ot">&lt;-</span> w<span class="sc">*</span>gamma_true <span class="sc">+</span> u</span>
<span id="cb959-23"><a href="sec-endogenous-sample-selection.html#cb959-23" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(z_star<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb959-24"><a href="sec-endogenous-sample-selection.html#cb959-24" tabindex="-1"></a></span>
<span id="cb959-25"><a href="sec-endogenous-sample-selection.html#cb959-25" tabindex="-1"></a><span class="co"># Outcome</span></span>
<span id="cb959-26"><a href="sec-endogenous-sample-selection.html#cb959-26" tabindex="-1"></a></span>
<span id="cb959-27"><a href="sec-endogenous-sample-selection.html#cb959-27" tabindex="-1"></a>y_star <span class="ot">&lt;-</span> x <span class="sc">*</span> beta_true <span class="sc">+</span> epsilon</span>
<span id="cb959-28"><a href="sec-endogenous-sample-selection.html#cb959-28" tabindex="-1"></a><span class="co"># Observed only if z=1</span></span>
<span id="cb959-29"><a href="sec-endogenous-sample-selection.html#cb959-29" tabindex="-1"></a>y_obs <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(z <span class="sc">==</span> <span class="dv">1</span>, y_star, <span class="cn">NA</span>)</span>
<span id="cb959-30"><a href="sec-endogenous-sample-selection.html#cb959-30" tabindex="-1"></a></span>
<span id="cb959-31"><a href="sec-endogenous-sample-selection.html#cb959-31" tabindex="-1"></a><span class="co"># Step 1: Probit</span></span>
<span id="cb959-32"><a href="sec-endogenous-sample-selection.html#cb959-32" tabindex="-1"></a>sel_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(z <span class="sc">~</span> w, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;probit&quot;</span>))</span>
<span id="cb959-33"><a href="sec-endogenous-sample-selection.html#cb959-33" tabindex="-1"></a>z_hat <span class="ot">&lt;-</span> <span class="fu">predict</span>(sel_mod, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb959-34"><a href="sec-endogenous-sample-selection.html#cb959-34" tabindex="-1"></a>lambda_vals <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(z_hat) <span class="sc">/</span> <span class="fu">pnorm</span>(z_hat)</span>
<span id="cb959-35"><a href="sec-endogenous-sample-selection.html#cb959-35" tabindex="-1"></a></span>
<span id="cb959-36"><a href="sec-endogenous-sample-selection.html#cb959-36" tabindex="-1"></a><span class="co"># Step 2: OLS on observed + IMR</span></span>
<span id="cb959-37"><a href="sec-endogenous-sample-selection.html#cb959-37" tabindex="-1"></a>data_heck <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y_obs,</span>
<span id="cb959-38"><a href="sec-endogenous-sample-selection.html#cb959-38" tabindex="-1"></a>                        <span class="at">x =</span> x,</span>
<span id="cb959-39"><a href="sec-endogenous-sample-selection.html#cb959-39" tabindex="-1"></a>                        <span class="at">imr =</span> lambda_vals,</span>
<span id="cb959-40"><a href="sec-endogenous-sample-selection.html#cb959-40" tabindex="-1"></a>                        <span class="at">z =</span> z)</span>
<span id="cb959-41"><a href="sec-endogenous-sample-selection.html#cb959-41" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_heck, z <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb959-42"><a href="sec-endogenous-sample-selection.html#cb959-42" tabindex="-1"></a>heck_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> imr, <span class="at">data =</span> observed_data)</span>
<span id="cb959-43"><a href="sec-endogenous-sample-selection.html#cb959-43" tabindex="-1"></a><span class="fu">summary</span>(heck_lm)</span>
<span id="cb959-44"><a href="sec-endogenous-sample-selection.html#cb959-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb959-45"><a href="sec-endogenous-sample-selection.html#cb959-45" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb959-46"><a href="sec-endogenous-sample-selection.html#cb959-46" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x + imr, data = observed_data)</span></span>
<span id="cb959-47"><a href="sec-endogenous-sample-selection.html#cb959-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb959-48"><a href="sec-endogenous-sample-selection.html#cb959-48" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb959-49"><a href="sec-endogenous-sample-selection.html#cb959-49" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb959-50"><a href="sec-endogenous-sample-selection.html#cb959-50" tabindex="-1"></a><span class="co">#&gt; -2.76657 -0.60099 -0.02776  0.56317  2.74797 </span></span>
<span id="cb959-51"><a href="sec-endogenous-sample-selection.html#cb959-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb959-52"><a href="sec-endogenous-sample-selection.html#cb959-52" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb959-53"><a href="sec-endogenous-sample-selection.html#cb959-53" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb959-54"><a href="sec-endogenous-sample-selection.html#cb959-54" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.01715    0.07068   0.243    0.808    </span></span>
<span id="cb959-55"><a href="sec-endogenous-sample-selection.html#cb959-55" tabindex="-1"></a><span class="co">#&gt; x            1.95925    0.03934  49.800  &lt; 2e-16 ***</span></span>
<span id="cb959-56"><a href="sec-endogenous-sample-selection.html#cb959-56" tabindex="-1"></a><span class="co">#&gt; imr          0.41900    0.10063   4.164 3.69e-05 ***</span></span>
<span id="cb959-57"><a href="sec-endogenous-sample-selection.html#cb959-57" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb959-58"><a href="sec-endogenous-sample-selection.html#cb959-58" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb959-59"><a href="sec-endogenous-sample-selection.html#cb959-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb959-60"><a href="sec-endogenous-sample-selection.html#cb959-60" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.8942 on 501 degrees of freedom</span></span>
<span id="cb959-61"><a href="sec-endogenous-sample-selection.html#cb959-61" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.8332, Adjusted R-squared:  0.8325 </span></span>
<span id="cb959-62"><a href="sec-endogenous-sample-selection.html#cb959-62" tabindex="-1"></a><span class="co">#&gt; F-statistic:  1251 on 2 and 501 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb959-63"><a href="sec-endogenous-sample-selection.html#cb959-63" tabindex="-1"></a></span>
<span id="cb959-64"><a href="sec-endogenous-sample-selection.html#cb959-64" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;True beta=&quot;</span>, beta_true, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb959-65"><a href="sec-endogenous-sample-selection.html#cb959-65" tabindex="-1"></a><span class="co">#&gt; True beta= 2</span></span>
<span id="cb959-66"><a href="sec-endogenous-sample-selection.html#cb959-66" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Heckman 2-step estimated beta=&quot;</span>, <span class="fu">coef</span>(heck_lm)[<span class="st">&quot;x&quot;</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb959-67"><a href="sec-endogenous-sample-selection.html#cb959-67" tabindex="-1"></a><span class="co">#&gt; Heckman 2-step estimated beta= 1.959249</span></span></code></pre></div>
</div>
<div id="full-information-maximum-likelihood" class="section level4 hasAnchor" number="36.2.2.2">
<h4><span class="header-section-number">36.2.2.2</span> Full Information Maximum Likelihood<a href="sec-endogenous-sample-selection.html#full-information-maximum-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Jointly estimates the selection and outcome equations via ML, assuming:</p>
<p><span class="math display">\[
\biggl(\varepsilon_i, u_i\biggr) \sim \mathcal{N}\biggl(\begin{pmatrix}0\\0\end{pmatrix},\begin{pmatrix}\sigma_{\varepsilon}^2 &amp; \rho\,\sigma_{\varepsilon}\\\rho\,\sigma_{\varepsilon} &amp; 1\end{pmatrix}\biggr).
\]</span></p>
<ul>
<li>Pros: More efficient if the distributional assumption is correct. Allows a direct test of <span class="math inline">\(\rho=0\)</span> (LR test).</li>
<li>Cons: More sensitive to specification errors (i.e., requires stronger distributional assumptions); potentially complex to implement.</li>
</ul>
<p>We can use the <strong><code>sampleSelection</code></strong> package in R to perform full maximum likelihood estimation for the same data:</p>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="sec-endogenous-sample-selection.html#cb960-1" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb960-2"><a href="sec-endogenous-sample-selection.html#cb960-2" tabindex="-1"></a><span class="co"># SIM 2: 2-step vs. FIML    #</span></span>
<span id="cb960-3"><a href="sec-endogenous-sample-selection.html#cb960-3" tabindex="-1"></a><span class="do">#############################</span></span>
<span id="cb960-4"><a href="sec-endogenous-sample-selection.html#cb960-4" tabindex="-1"></a></span>
<span id="cb960-5"><a href="sec-endogenous-sample-selection.html#cb960-5" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(sampleSelection))</span>
<span id="cb960-6"><a href="sec-endogenous-sample-selection.html#cb960-6" tabindex="-1"></a></span>
<span id="cb960-7"><a href="sec-endogenous-sample-selection.html#cb960-7" tabindex="-1"></a><span class="co"># Using same data (z, x, y_obs) from above</span></span>
<span id="cb960-8"><a href="sec-endogenous-sample-selection.html#cb960-8" tabindex="-1"></a></span>
<span id="cb960-9"><a href="sec-endogenous-sample-selection.html#cb960-9" tabindex="-1"></a><span class="co"># 1) Heckman 2-step (built-in)</span></span>
<span id="cb960-10"><a href="sec-endogenous-sample-selection.html#cb960-10" tabindex="-1"></a>heck2 <span class="ot">&lt;-</span></span>
<span id="cb960-11"><a href="sec-endogenous-sample-selection.html#cb960-11" tabindex="-1"></a>    <span class="fu">selection</span>(z <span class="sc">~</span> w, y_obs <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">&quot;2step&quot;</span>, <span class="at">data =</span> data_heck)</span>
<span id="cb960-12"><a href="sec-endogenous-sample-selection.html#cb960-12" tabindex="-1"></a><span class="fu">summary</span>(heck2)</span>
<span id="cb960-13"><a href="sec-endogenous-sample-selection.html#cb960-13" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb960-14"><a href="sec-endogenous-sample-selection.html#cb960-14" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb960-15"><a href="sec-endogenous-sample-selection.html#cb960-15" tabindex="-1"></a><span class="co">#&gt; 2-step Heckman / heckit estimation</span></span>
<span id="cb960-16"><a href="sec-endogenous-sample-selection.html#cb960-16" tabindex="-1"></a><span class="co">#&gt; 1000 observations (496 censored and 504 observed)</span></span>
<span id="cb960-17"><a href="sec-endogenous-sample-selection.html#cb960-17" tabindex="-1"></a><span class="co">#&gt; 7 free parameters (df = 994)</span></span>
<span id="cb960-18"><a href="sec-endogenous-sample-selection.html#cb960-18" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb960-19"><a href="sec-endogenous-sample-selection.html#cb960-19" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-20"><a href="sec-endogenous-sample-selection.html#cb960-20" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.02053    0.04494   0.457    0.648    </span></span>
<span id="cb960-21"><a href="sec-endogenous-sample-selection.html#cb960-21" tabindex="-1"></a><span class="co">#&gt; w            0.94063    0.05911  15.913   &lt;2e-16 ***</span></span>
<span id="cb960-22"><a href="sec-endogenous-sample-selection.html#cb960-22" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb960-23"><a href="sec-endogenous-sample-selection.html#cb960-23" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-24"><a href="sec-endogenous-sample-selection.html#cb960-24" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.01715    0.07289   0.235    0.814    </span></span>
<span id="cb960-25"><a href="sec-endogenous-sample-selection.html#cb960-25" tabindex="-1"></a><span class="co">#&gt; x            1.95925    0.03924  49.932   &lt;2e-16 ***</span></span>
<span id="cb960-26"><a href="sec-endogenous-sample-selection.html#cb960-26" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared:0.8332,   Adjusted R-Squared:0.8325</span></span>
<span id="cb960-27"><a href="sec-endogenous-sample-selection.html#cb960-27" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb960-28"><a href="sec-endogenous-sample-selection.html#cb960-28" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-29"><a href="sec-endogenous-sample-selection.html#cb960-29" tabindex="-1"></a><span class="co">#&gt; invMillsRatio   0.4190     0.1018   4.116 4.18e-05 ***</span></span>
<span id="cb960-30"><a href="sec-endogenous-sample-selection.html#cb960-30" tabindex="-1"></a><span class="co">#&gt; sigma           0.9388         NA      NA       NA    </span></span>
<span id="cb960-31"><a href="sec-endogenous-sample-selection.html#cb960-31" tabindex="-1"></a><span class="co">#&gt; rho             0.4463         NA      NA       NA    </span></span>
<span id="cb960-32"><a href="sec-endogenous-sample-selection.html#cb960-32" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb960-33"><a href="sec-endogenous-sample-selection.html#cb960-33" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb960-34"><a href="sec-endogenous-sample-selection.html#cb960-34" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb960-35"><a href="sec-endogenous-sample-selection.html#cb960-35" tabindex="-1"></a></span>
<span id="cb960-36"><a href="sec-endogenous-sample-selection.html#cb960-36" tabindex="-1"></a><span class="co"># 2) FIML</span></span>
<span id="cb960-37"><a href="sec-endogenous-sample-selection.html#cb960-37" tabindex="-1"></a>heckFIML <span class="ot">&lt;-</span></span>
<span id="cb960-38"><a href="sec-endogenous-sample-selection.html#cb960-38" tabindex="-1"></a>    <span class="fu">selection</span>(z <span class="sc">~</span> w, y_obs <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">data =</span> data_heck)</span>
<span id="cb960-39"><a href="sec-endogenous-sample-selection.html#cb960-39" tabindex="-1"></a><span class="fu">summary</span>(heckFIML)</span>
<span id="cb960-40"><a href="sec-endogenous-sample-selection.html#cb960-40" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb960-41"><a href="sec-endogenous-sample-selection.html#cb960-41" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb960-42"><a href="sec-endogenous-sample-selection.html#cb960-42" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb960-43"><a href="sec-endogenous-sample-selection.html#cb960-43" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 2 iterations</span></span>
<span id="cb960-44"><a href="sec-endogenous-sample-selection.html#cb960-44" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb960-45"><a href="sec-endogenous-sample-selection.html#cb960-45" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1174.233 </span></span>
<span id="cb960-46"><a href="sec-endogenous-sample-selection.html#cb960-46" tabindex="-1"></a><span class="co">#&gt; 1000 observations (496 censored and 504 observed)</span></span>
<span id="cb960-47"><a href="sec-endogenous-sample-selection.html#cb960-47" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 994)</span></span>
<span id="cb960-48"><a href="sec-endogenous-sample-selection.html#cb960-48" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb960-49"><a href="sec-endogenous-sample-selection.html#cb960-49" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-50"><a href="sec-endogenous-sample-selection.html#cb960-50" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.02169    0.04488   0.483    0.629    </span></span>
<span id="cb960-51"><a href="sec-endogenous-sample-selection.html#cb960-51" tabindex="-1"></a><span class="co">#&gt; w            0.94203    0.05908  15.945   &lt;2e-16 ***</span></span>
<span id="cb960-52"><a href="sec-endogenous-sample-selection.html#cb960-52" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb960-53"><a href="sec-endogenous-sample-selection.html#cb960-53" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-54"><a href="sec-endogenous-sample-selection.html#cb960-54" tabindex="-1"></a><span class="co">#&gt; (Intercept) 0.008601   0.071315   0.121    0.904    </span></span>
<span id="cb960-55"><a href="sec-endogenous-sample-selection.html#cb960-55" tabindex="-1"></a><span class="co">#&gt; x           1.959195   0.039124  50.077   &lt;2e-16 ***</span></span>
<span id="cb960-56"><a href="sec-endogenous-sample-selection.html#cb960-56" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb960-57"><a href="sec-endogenous-sample-selection.html#cb960-57" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb960-58"><a href="sec-endogenous-sample-selection.html#cb960-58" tabindex="-1"></a><span class="co">#&gt; sigma  0.94118    0.03503  26.867  &lt; 2e-16 ***</span></span>
<span id="cb960-59"><a href="sec-endogenous-sample-selection.html#cb960-59" tabindex="-1"></a><span class="co">#&gt; rho    0.46051    0.09411   4.893 1.16e-06 ***</span></span>
<span id="cb960-60"><a href="sec-endogenous-sample-selection.html#cb960-60" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb960-61"><a href="sec-endogenous-sample-selection.html#cb960-61" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb960-62"><a href="sec-endogenous-sample-selection.html#cb960-62" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>You can compare the coefficient estimates on <code>x</code> from <code>heck2</code> vs. <code>heckFIML</code>. In large samples, both should converge to the true <span class="math inline">\(\beta\)</span>. FIML is typically more efficient, but if the normality assumption is violated, both can be biased.</p>
</div>
<div id="cf-and-iv-approaches" class="section level4 hasAnchor" number="36.2.2.3">
<h4><span class="header-section-number">36.2.2.3</span> CF and IV Approaches<a href="sec-endogenous-sample-selection.html#cf-and-iv-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><strong>Control Function</strong></li>
</ol>
<ul>
<li>Residual-based approach: Regress the selection (or treatment) variable on excluded instruments and included controls. Obtain the predicted residual. Include that residual in the main outcome regression.</li>
<li>If correlated residual is significant, that indicates endogeneity; adjusting for it can correct bias.</li>
<li>Often used in the context of treatment effect models or simultaneously with IV logic.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><a href="sec-instrumental-variables.html#sec-instrumental-variables">Instrumental Variables</a></li>
</ol>
<ul>
<li>In the pure treatment effect context, an IV must affect treatment assignment but not the outcome directly.</li>
<li>For sample selection, an exclusion restriction (“instrument”) must shift selection but not outcomes.</li>
<li>Example: Distance to a training center influences participation in a job program but not post-training earnings.</li>
</ul>
<hr />
</div>
</div>
<div id="theoretical-connections" class="section level3 hasAnchor" number="36.2.3">
<h3><span class="header-section-number">36.2.3</span> Theoretical Connections<a href="sec-endogenous-sample-selection.html#theoretical-connections" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="conditional-expectation-from-truncated-distributions" class="section level4 hasAnchor" number="36.2.3.1">
<h4><span class="header-section-number">36.2.3.1</span> Conditional Expectation from Truncated Distributions<a href="sec-endogenous-sample-selection.html#conditional-expectation-from-truncated-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the sample selection scenario:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}[y_i\mid w_i=1] &amp;= x_i\beta + \mathbb{E}[\varepsilon_i\mid w_i^*&gt;0],\\
&amp;= x_i\beta + \rho\,\sigma_{\varepsilon}\,\frac{\phi(z_i&#39;\gamma)}{\Phi(z_i&#39;\gamma)},
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\rho\,\sigma_{\varepsilon}\)</span> is the covariance term and <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\Phi\)</span> are the standard normal PDF and CDF, respectively. This formula underpins the inverse Mills ratio correction.</p>
<ul>
<li>If <span class="math inline">\(\rho&gt;0\)</span>, then the same unobservables that increase the likelihood of selection also increase outcomes, implying positive selection.</li>
<li>If <span class="math inline">\(\rho&lt;0\)</span>, selection is negatively correlated with outcomes.</li>
<li><span class="math inline">\(\hat{\rho}\)</span>: Estimated correlation of error terms. If significantly different from 0, endogenous selection is present.</li>
<li>Wald or Likelihood Ratio Test: Used to test <span class="math inline">\(H_0: \rho = 0\)</span>.</li>
<li>Lambda (<span class="math inline">\(\hat{\lambda}\)</span>): Product of <span class="math inline">\(\hat{\rho} \hat{\sigma}_\varepsilon\)</span>—measures strength of selection bias.</li>
<li>Inverse Mills Ratio: Can be saved and inspected to understand sample inclusion probabilities.</li>
</ul>
</div>
<div id="relationship-among-models" class="section level4 hasAnchor" number="36.2.3.2">
<h4><span class="header-section-number">36.2.3.2</span> Relationship Among Models<a href="sec-endogenous-sample-selection.html#relationship-among-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>All the models in <a href="sec-endogenous-sample-selection.html#unifying-model-frameworks">Unifying Model Frameworks</a> can be seen as special or generalized cases:</p>
<ul>
<li><p>If one only has data for the selected group, it’s a sample selection setup.</p></li>
<li><p>If data for both groups exist, but assignment is endogenous, it’s a treatment effect problem.</p></li>
<li><p>If there’s a valid instrument, one can do a control function or IV approach.</p></li>
<li><p>If the normality assumption holds and selection is truly parametric, Heckman or FIML correct for the bias.</p></li>
</ul>
<p>Summary Table of Methods</p>
<table>
<colgroup>
<col width="9%" />
<col width="25%" />
<col width="16%" />
<col width="8%" />
<col width="16%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Method</strong></th>
<th><strong>Data Observed</strong></th>
<th><strong>Key Assumption</strong></th>
<th><strong>Exclusion?</strong></th>
<th><strong>Pros</strong></th>
<th><strong>Cons</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>OLS (Naive)</td>
<td>Full or partial, ignoring selection</td>
<td>No endogeneity in errors</td>
<td>Not required</td>
<td>Simple to implement</td>
<td>Biased if endogeneity is present</td>
</tr>
<tr class="even">
<td>Heckman 2-Step (Heckit)</td>
<td>Outcome only for selected group</td>
<td>Joint normal errors; linear functional</td>
<td>Strongly recommended</td>
<td>Intuitive, widely used</td>
<td>Sensitive to normality/functional form.</td>
</tr>
<tr class="odd">
<td>FIML (Full ML)</td>
<td>Same as Heckman (subset observed)</td>
<td>Joint normal errors</td>
<td>Strongly recommended</td>
<td>More efficient, direct test of <span class="math inline">\(\rho=0\)</span></td>
<td>Complex, more sensitive to misspecification</td>
</tr>
<tr class="even">
<td>Control Function</td>
<td>Observed data for both or one group (depending on setup)</td>
<td>Some form of valid instrument or exog.</td>
<td>Yes (instrument)</td>
<td>Extends easily to many models</td>
<td>Must find valid instrument, no direct test for endogeneity</td>
</tr>
<tr class="odd">
<td>Instrumental Variables</td>
<td>Observed data for both groups, or entire sample (for selection)</td>
<td>IV must affect selection but not outcome</td>
<td>Yes (instrument)</td>
<td>Common approach in program evaluation</td>
<td>Exclusion restriction validity is critical</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="concerns" class="section level4 hasAnchor" number="36.2.3.3">
<h4><span class="header-section-number">36.2.3.3</span> Concerns<a href="sec-endogenous-sample-selection.html#concerns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><strong>Small Samples</strong>: Two-step procedures can be unstable in smaller datasets.</li>
<li><strong>Exclusion Restrictions</strong>: Without a credible variable that predicts selection but not outcomes, identification depends purely on functional form (bivariate normal + nonlinearity of probit).</li>
<li><strong>Distributional Assumption</strong>: If normality is seriously violated, neither 2-step nor FIML may reliably remove bias.</li>
<li><strong>Measurement Error in IMR</strong>: The second-stage includes an <em>estimated</em> regressor <span class="math inline">\(\hat{\lambda}_i\)</span>, which can add noise.</li>
<li><strong>Connection to IV</strong>: If a strong instrument exists, one could proceed with a control function or standard IV in a treatment effect setup. But for sample selection (lack of data on unselected), the Heckman approach is more common.</li>
<li><strong>Presence of Correlation between the Error Terms</strong>: The Heckman treatment effect model outperforms OLS when <span class="math inline">\(\rho \neq 0\)</span> because it corrects for selection bias due to unobserved factors. However, when <span class="math inline">\(\rho = 0\)</span>, the correction is unnecessary and can introduce inefficiency, making simpler methods more accurate.</li>
</ol>
<hr />
</div>
</div>
<div id="tobit-2-heckmans-sample-selection-model" class="section level3 hasAnchor" number="36.2.4">
<h3><span class="header-section-number">36.2.4</span> Tobit-2: Heckman’s Sample Selection Model<a href="sec-endogenous-sample-selection.html#tobit-2-heckmans-sample-selection-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Tobit-2 model, also known as <strong>Heckman’s standard sample selection model</strong>, is designed to correct for sample selection bias. This arises when the outcome variable is only observed for a non-random subset of the population, and the selection process is correlated with the outcome of interest.</p>
<p>A key assumption of the model is the <strong>joint normality of the error terms</strong> in the selection and outcome equations.</p>
<div id="panel-study-of-income-dynamics" class="section level4 hasAnchor" number="36.2.4.1">
<h4><span class="header-section-number">36.2.4.1</span> Panel Study of Income Dynamics<a href="sec-endogenous-sample-selection.html#panel-study-of-income-dynamics" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We demonstrate the model using the classic dataset from <span class="citation">Mroz (<a href="#ref-mroz1984sensitivity">1984</a>)</span>, which provides data from the 1975 Panel Study of Income Dynamics on married women’s labor-force participation and wages.</p>
<p>We aim to estimate the log of hourly wages for married women, using:</p>
<ul>
<li><code>educ</code>: Years of education</li>
<li><code>exper</code>: Years of work experience</li>
<li><code>exper^2</code>: Experience squared (to capture non-linear effects)</li>
<li><code>city</code>: A dummy for residence in a big city</li>
</ul>
<p>However, wages are only observed for those who participated in the labor force, meaning an OLS regression using only this subsample would suffer from selection bias.</p>
<p>Because we also have data on non-participants, we can use Heckman’s two-step method to correct for this bias.</p>
<hr />
<ol style="list-style-type: decimal">
<li><strong>Load and Prepare Data</strong></li>
</ol>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="sec-endogenous-sample-selection.html#cb961-1" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb961-2"><a href="sec-endogenous-sample-selection.html#cb961-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb961-3"><a href="sec-endogenous-sample-selection.html#cb961-3" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb961-4"><a href="sec-endogenous-sample-selection.html#cb961-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb961-5"><a href="sec-endogenous-sample-selection.html#cb961-5" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb961-6"><a href="sec-endogenous-sample-selection.html#cb961-6" tabindex="-1"></a></span>
<span id="cb961-7"><a href="sec-endogenous-sample-selection.html#cb961-7" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Mroz87&quot;</span>)  <span class="co"># PSID data on married women in 1975</span></span>
<span id="cb961-8"><a href="sec-endogenous-sample-selection.html#cb961-8" tabindex="-1"></a>Mroz87 <span class="ot">=</span> Mroz87 <span class="sc">%&gt;%</span></span>
<span id="cb961-9"><a href="sec-endogenous-sample-selection.html#cb961-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">kids =</span> kids5 <span class="sc">+</span> kids618)  <span class="co"># total number of children</span></span>
<span id="cb961-10"><a href="sec-endogenous-sample-selection.html#cb961-10" tabindex="-1"></a><span class="fu">head</span>(Mroz87)</span>
<span id="cb961-11"><a href="sec-endogenous-sample-selection.html#cb961-11" tabindex="-1"></a><span class="co">#&gt;   lfp hours kids5 kids618 age educ   wage repwage hushrs husage huseduc huswage</span></span>
<span id="cb961-12"><a href="sec-endogenous-sample-selection.html#cb961-12" tabindex="-1"></a><span class="co">#&gt; 1   1  1610     1       0  32   12 3.3540    2.65   2708     34      12  4.0288</span></span>
<span id="cb961-13"><a href="sec-endogenous-sample-selection.html#cb961-13" tabindex="-1"></a><span class="co">#&gt; 2   1  1656     0       2  30   12 1.3889    2.65   2310     30       9  8.4416</span></span>
<span id="cb961-14"><a href="sec-endogenous-sample-selection.html#cb961-14" tabindex="-1"></a><span class="co">#&gt; 3   1  1980     1       3  35   12 4.5455    4.04   3072     40      12  3.5807</span></span>
<span id="cb961-15"><a href="sec-endogenous-sample-selection.html#cb961-15" tabindex="-1"></a><span class="co">#&gt; 4   1   456     0       3  34   12 1.0965    3.25   1920     53      10  3.5417</span></span>
<span id="cb961-16"><a href="sec-endogenous-sample-selection.html#cb961-16" tabindex="-1"></a><span class="co">#&gt; 5   1  1568     1       2  31   14 4.5918    3.60   2000     32      12 10.0000</span></span>
<span id="cb961-17"><a href="sec-endogenous-sample-selection.html#cb961-17" tabindex="-1"></a><span class="co">#&gt; 6   1  2032     0       0  54   12 4.7421    4.70   1040     57      11  6.7106</span></span>
<span id="cb961-18"><a href="sec-endogenous-sample-selection.html#cb961-18" tabindex="-1"></a><span class="co">#&gt;   faminc    mtr motheduc fatheduc unem city exper  nwifeinc wifecoll huscoll</span></span>
<span id="cb961-19"><a href="sec-endogenous-sample-selection.html#cb961-19" tabindex="-1"></a><span class="co">#&gt; 1  16310 0.7215       12        7  5.0    0    14 10.910060    FALSE   FALSE</span></span>
<span id="cb961-20"><a href="sec-endogenous-sample-selection.html#cb961-20" tabindex="-1"></a><span class="co">#&gt; 2  21800 0.6615        7        7 11.0    1     5 19.499981    FALSE   FALSE</span></span>
<span id="cb961-21"><a href="sec-endogenous-sample-selection.html#cb961-21" tabindex="-1"></a><span class="co">#&gt; 3  21040 0.6915       12        7  5.0    0    15 12.039910    FALSE   FALSE</span></span>
<span id="cb961-22"><a href="sec-endogenous-sample-selection.html#cb961-22" tabindex="-1"></a><span class="co">#&gt; 4   7300 0.7815        7        7  5.0    0     6  6.799996    FALSE   FALSE</span></span>
<span id="cb961-23"><a href="sec-endogenous-sample-selection.html#cb961-23" tabindex="-1"></a><span class="co">#&gt; 5  27300 0.6215       12       14  9.5    1     7 20.100058     TRUE   FALSE</span></span>
<span id="cb961-24"><a href="sec-endogenous-sample-selection.html#cb961-24" tabindex="-1"></a><span class="co">#&gt; 6  19495 0.6915       14        7  7.5    1    33  9.859054    FALSE   FALSE</span></span>
<span id="cb961-25"><a href="sec-endogenous-sample-selection.html#cb961-25" tabindex="-1"></a><span class="co">#&gt;   kids</span></span>
<span id="cb961-26"><a href="sec-endogenous-sample-selection.html#cb961-26" tabindex="-1"></a><span class="co">#&gt; 1    1</span></span>
<span id="cb961-27"><a href="sec-endogenous-sample-selection.html#cb961-27" tabindex="-1"></a><span class="co">#&gt; 2    2</span></span>
<span id="cb961-28"><a href="sec-endogenous-sample-selection.html#cb961-28" tabindex="-1"></a><span class="co">#&gt; 3    4</span></span>
<span id="cb961-29"><a href="sec-endogenous-sample-selection.html#cb961-29" tabindex="-1"></a><span class="co">#&gt; 4    3</span></span>
<span id="cb961-30"><a href="sec-endogenous-sample-selection.html#cb961-30" tabindex="-1"></a><span class="co">#&gt; 5    3</span></span>
<span id="cb961-31"><a href="sec-endogenous-sample-selection.html#cb961-31" tabindex="-1"></a><span class="co">#&gt; 6    0</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Model Overview</strong></li>
</ol>
<p>The two-step Heckman selection model proceeds as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Selection Equation (Probit)</strong>:<br />
Models the probability of labor force participation (<code>lfp = 1</code>) as a function of variables that affect the decision to work.</p></li>
<li><p><strong>Outcome Equation (Wage)</strong>:<br />
Models log wages conditional on working. A correction term, the IMR, is included to account for the non-random selection into work.</p></li>
</ol>
<p>Step 1: Naive OLS on Observed Wages</p>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="sec-endogenous-sample-selection.html#cb962-1" tabindex="-1"></a>ols1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city,</span>
<span id="cb962-2"><a href="sec-endogenous-sample-selection.html#cb962-2" tabindex="-1"></a>          <span class="at">data =</span> <span class="fu">subset</span>(Mroz87, lfp <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb962-3"><a href="sec-endogenous-sample-selection.html#cb962-3" tabindex="-1"></a><span class="fu">summary</span>(ols1)</span>
<span id="cb962-4"><a href="sec-endogenous-sample-selection.html#cb962-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb962-5"><a href="sec-endogenous-sample-selection.html#cb962-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb962-6"><a href="sec-endogenous-sample-selection.html#cb962-6" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(wage) ~ educ + exper + I(exper^2) + city, data = subset(Mroz87, </span></span>
<span id="cb962-7"><a href="sec-endogenous-sample-selection.html#cb962-7" tabindex="-1"></a><span class="co">#&gt;     lfp == 1))</span></span>
<span id="cb962-8"><a href="sec-endogenous-sample-selection.html#cb962-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb962-9"><a href="sec-endogenous-sample-selection.html#cb962-9" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb962-10"><a href="sec-endogenous-sample-selection.html#cb962-10" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb962-11"><a href="sec-endogenous-sample-selection.html#cb962-11" tabindex="-1"></a><span class="co">#&gt; -3.10084 -0.32453  0.05292  0.36261  2.34806 </span></span>
<span id="cb962-12"><a href="sec-endogenous-sample-selection.html#cb962-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb962-13"><a href="sec-endogenous-sample-selection.html#cb962-13" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb962-14"><a href="sec-endogenous-sample-selection.html#cb962-14" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb962-15"><a href="sec-endogenous-sample-selection.html#cb962-15" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.5308476  0.1990253  -2.667  0.00794 ** </span></span>
<span id="cb962-16"><a href="sec-endogenous-sample-selection.html#cb962-16" tabindex="-1"></a><span class="co">#&gt; educ         0.1057097  0.0143280   7.378 8.58e-13 ***</span></span>
<span id="cb962-17"><a href="sec-endogenous-sample-selection.html#cb962-17" tabindex="-1"></a><span class="co">#&gt; exper        0.0410584  0.0131963   3.111  0.00199 ** </span></span>
<span id="cb962-18"><a href="sec-endogenous-sample-selection.html#cb962-18" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0007973  0.0003938  -2.025  0.04352 *  </span></span>
<span id="cb962-19"><a href="sec-endogenous-sample-selection.html#cb962-19" tabindex="-1"></a><span class="co">#&gt; city         0.0542225  0.0680903   0.796  0.42629    </span></span>
<span id="cb962-20"><a href="sec-endogenous-sample-selection.html#cb962-20" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb962-21"><a href="sec-endogenous-sample-selection.html#cb962-21" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb962-22"><a href="sec-endogenous-sample-selection.html#cb962-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb962-23"><a href="sec-endogenous-sample-selection.html#cb962-23" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6667 on 423 degrees of freedom</span></span>
<span id="cb962-24"><a href="sec-endogenous-sample-selection.html#cb962-24" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1581, Adjusted R-squared:  0.1501 </span></span>
<span id="cb962-25"><a href="sec-endogenous-sample-selection.html#cb962-25" tabindex="-1"></a><span class="co">#&gt; F-statistic: 19.86 on 4 and 423 DF,  p-value: 5.389e-15</span></span></code></pre></div>
<p>This OLS is biased because it only includes women who chose to work.</p>
<p>Step 2: Heckman Two-Step Estimation</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="sec-endogenous-sample-selection.html#cb963-1" tabindex="-1"></a><span class="co"># Heckman 2-step estimation</span></span>
<span id="cb963-2"><a href="sec-endogenous-sample-selection.html#cb963-2" tabindex="-1"></a>heck1 <span class="ot">=</span> <span class="fu">heckit</span>(</span>
<span id="cb963-3"><a href="sec-endogenous-sample-selection.html#cb963-3" tabindex="-1"></a>    <span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb963-4"><a href="sec-endogenous-sample-selection.html#cb963-4" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city,</span>
<span id="cb963-5"><a href="sec-endogenous-sample-selection.html#cb963-5" tabindex="-1"></a>    <span class="at">data =</span> Mroz87</span>
<span id="cb963-6"><a href="sec-endogenous-sample-selection.html#cb963-6" tabindex="-1"></a>)</span>
<span id="cb963-7"><a href="sec-endogenous-sample-selection.html#cb963-7" tabindex="-1"></a></span>
<span id="cb963-8"><a href="sec-endogenous-sample-selection.html#cb963-8" tabindex="-1"></a><span class="co"># Stage 1: Selection equation (probit)</span></span>
<span id="cb963-9"><a href="sec-endogenous-sample-selection.html#cb963-9" tabindex="-1"></a><span class="fu">summary</span>(heck1<span class="sc">$</span>probit)</span>
<span id="cb963-10"><a href="sec-endogenous-sample-selection.html#cb963-10" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb963-11"><a href="sec-endogenous-sample-selection.html#cb963-11" tabindex="-1"></a><span class="co">#&gt; Probit binary choice model/Maximum Likelihood estimation</span></span>
<span id="cb963-12"><a href="sec-endogenous-sample-selection.html#cb963-12" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb963-13"><a href="sec-endogenous-sample-selection.html#cb963-13" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb963-14"><a href="sec-endogenous-sample-selection.html#cb963-14" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -482.8212 </span></span>
<span id="cb963-15"><a href="sec-endogenous-sample-selection.html#cb963-15" tabindex="-1"></a><span class="co">#&gt; Model: Y == &#39;1&#39; in contrary to &#39;0&#39;</span></span>
<span id="cb963-16"><a href="sec-endogenous-sample-selection.html#cb963-16" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 &#39;negative&#39; and 428 &#39;positive&#39;) and 6 free parameters (df = 747)</span></span>
<span id="cb963-17"><a href="sec-endogenous-sample-selection.html#cb963-17" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb963-18"><a href="sec-endogenous-sample-selection.html#cb963-18" tabindex="-1"></a><span class="co">#&gt;                  Estimate  Std. error t value   Pr(&gt; t)    </span></span>
<span id="cb963-19"><a href="sec-endogenous-sample-selection.html#cb963-19" tabindex="-1"></a><span class="co">#&gt; XS(Intercept) -4.18146681  1.40241567 -2.9816  0.002867 ** </span></span>
<span id="cb963-20"><a href="sec-endogenous-sample-selection.html#cb963-20" tabindex="-1"></a><span class="co">#&gt; XSage          0.18608901  0.06517476  2.8552  0.004301 ** </span></span>
<span id="cb963-21"><a href="sec-endogenous-sample-selection.html#cb963-21" tabindex="-1"></a><span class="co">#&gt; XSI(age^2)    -0.00241491  0.00075857 -3.1835  0.001455 ** </span></span>
<span id="cb963-22"><a href="sec-endogenous-sample-selection.html#cb963-22" tabindex="-1"></a><span class="co">#&gt; XSkids        -0.14955977  0.03825079 -3.9100 9.230e-05 ***</span></span>
<span id="cb963-23"><a href="sec-endogenous-sample-selection.html#cb963-23" tabindex="-1"></a><span class="co">#&gt; XShuswage     -0.04303635  0.01220791 -3.5253  0.000423 ***</span></span>
<span id="cb963-24"><a href="sec-endogenous-sample-selection.html#cb963-24" tabindex="-1"></a><span class="co">#&gt; XSeduc         0.12502818  0.02277645  5.4894 4.034e-08 ***</span></span>
<span id="cb963-25"><a href="sec-endogenous-sample-selection.html#cb963-25" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb963-26"><a href="sec-endogenous-sample-selection.html#cb963-26" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb963-27"><a href="sec-endogenous-sample-selection.html#cb963-27" tabindex="-1"></a><span class="co">#&gt; Significance test:</span></span>
<span id="cb963-28"><a href="sec-endogenous-sample-selection.html#cb963-28" tabindex="-1"></a><span class="co">#&gt; chi2(5) = 64.10407 (p=1.719042e-12)</span></span>
<span id="cb963-29"><a href="sec-endogenous-sample-selection.html#cb963-29" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb963-30"><a href="sec-endogenous-sample-selection.html#cb963-30" tabindex="-1"></a></span>
<span id="cb963-31"><a href="sec-endogenous-sample-selection.html#cb963-31" tabindex="-1"></a><span class="co"># Stage 2: Wage equation with selection correction</span></span>
<span id="cb963-32"><a href="sec-endogenous-sample-selection.html#cb963-32" tabindex="-1"></a><span class="fu">summary</span>(heck1<span class="sc">$</span>lm)</span>
<span id="cb963-33"><a href="sec-endogenous-sample-selection.html#cb963-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb963-34"><a href="sec-endogenous-sample-selection.html#cb963-34" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb963-35"><a href="sec-endogenous-sample-selection.html#cb963-35" tabindex="-1"></a><span class="co">#&gt; lm(formula = YO ~ -1 + XO + imrData$IMR1, subset = YS == 1, weights = weightsNoNA)</span></span>
<span id="cb963-36"><a href="sec-endogenous-sample-selection.html#cb963-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb963-37"><a href="sec-endogenous-sample-selection.html#cb963-37" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb963-38"><a href="sec-endogenous-sample-selection.html#cb963-38" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb963-39"><a href="sec-endogenous-sample-selection.html#cb963-39" tabindex="-1"></a><span class="co">#&gt; -3.09494 -0.30953  0.05341  0.36530  2.34770 </span></span>
<span id="cb963-40"><a href="sec-endogenous-sample-selection.html#cb963-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb963-41"><a href="sec-endogenous-sample-selection.html#cb963-41" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb963-42"><a href="sec-endogenous-sample-selection.html#cb963-42" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb963-43"><a href="sec-endogenous-sample-selection.html#cb963-43" tabindex="-1"></a><span class="co">#&gt; XO(Intercept) -0.6143381  0.3768796  -1.630  0.10383    </span></span>
<span id="cb963-44"><a href="sec-endogenous-sample-selection.html#cb963-44" tabindex="-1"></a><span class="co">#&gt; XOeduc         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb963-45"><a href="sec-endogenous-sample-selection.html#cb963-45" tabindex="-1"></a><span class="co">#&gt; XOexper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb963-46"><a href="sec-endogenous-sample-selection.html#cb963-46" tabindex="-1"></a><span class="co">#&gt; XOI(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb963-47"><a href="sec-endogenous-sample-selection.html#cb963-47" tabindex="-1"></a><span class="co">#&gt; XOcity         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb963-48"><a href="sec-endogenous-sample-selection.html#cb963-48" tabindex="-1"></a><span class="co">#&gt; imrData$IMR1   0.0551177  0.2111916   0.261  0.79423    </span></span>
<span id="cb963-49"><a href="sec-endogenous-sample-selection.html#cb963-49" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb963-50"><a href="sec-endogenous-sample-selection.html#cb963-50" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb963-51"><a href="sec-endogenous-sample-selection.html#cb963-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb963-52"><a href="sec-endogenous-sample-selection.html#cb963-52" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6674 on 422 degrees of freedom</span></span>
<span id="cb963-53"><a href="sec-endogenous-sample-selection.html#cb963-53" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7734, Adjusted R-squared:  0.7702 </span></span>
<span id="cb963-54"><a href="sec-endogenous-sample-selection.html#cb963-54" tabindex="-1"></a><span class="co">#&gt; F-statistic:   240 on 6 and 422 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>The variable <code>kids</code> is used only in the selection equation. This follows good practice: at least one variable should appear only in the selection equation (serving as an instrument) to help identify the model.</p>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="sec-endogenous-sample-selection.html#cb964-1" tabindex="-1"></a><span class="co"># ML estimation of Heckman selection model</span></span>
<span id="cb964-2"><a href="sec-endogenous-sample-selection.html#cb964-2" tabindex="-1"></a>ml1 <span class="ot">=</span> <span class="fu">selection</span>(</span>
<span id="cb964-3"><a href="sec-endogenous-sample-selection.html#cb964-3" tabindex="-1"></a>  <span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb964-4"><a href="sec-endogenous-sample-selection.html#cb964-4" tabindex="-1"></a>  <span class="at">outcome =</span> <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> city,</span>
<span id="cb964-5"><a href="sec-endogenous-sample-selection.html#cb964-5" tabindex="-1"></a>  <span class="at">data =</span> Mroz87</span>
<span id="cb964-6"><a href="sec-endogenous-sample-selection.html#cb964-6" tabindex="-1"></a>)</span>
<span id="cb964-7"><a href="sec-endogenous-sample-selection.html#cb964-7" tabindex="-1"></a><span class="fu">summary</span>(ml1)</span>
<span id="cb964-8"><a href="sec-endogenous-sample-selection.html#cb964-8" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb964-9"><a href="sec-endogenous-sample-selection.html#cb964-9" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb964-10"><a href="sec-endogenous-sample-selection.html#cb964-10" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb964-11"><a href="sec-endogenous-sample-selection.html#cb964-11" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 3 iterations</span></span>
<span id="cb964-12"><a href="sec-endogenous-sample-selection.html#cb964-12" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb964-13"><a href="sec-endogenous-sample-selection.html#cb964-13" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -914.0777 </span></span>
<span id="cb964-14"><a href="sec-endogenous-sample-selection.html#cb964-14" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 censored and 428 observed)</span></span>
<span id="cb964-15"><a href="sec-endogenous-sample-selection.html#cb964-15" tabindex="-1"></a><span class="co">#&gt; 13 free parameters (df = 740)</span></span>
<span id="cb964-16"><a href="sec-endogenous-sample-selection.html#cb964-16" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb964-17"><a href="sec-endogenous-sample-selection.html#cb964-17" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb964-18"><a href="sec-endogenous-sample-selection.html#cb964-18" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.1484037  1.4109302  -2.940 0.003382 ** </span></span>
<span id="cb964-19"><a href="sec-endogenous-sample-selection.html#cb964-19" tabindex="-1"></a><span class="co">#&gt; age          0.1842132  0.0658041   2.799 0.005253 ** </span></span>
<span id="cb964-20"><a href="sec-endogenous-sample-selection.html#cb964-20" tabindex="-1"></a><span class="co">#&gt; I(age^2)    -0.0023925  0.0007664  -3.122 0.001868 ** </span></span>
<span id="cb964-21"><a href="sec-endogenous-sample-selection.html#cb964-21" tabindex="-1"></a><span class="co">#&gt; kids        -0.1488158  0.0384888  -3.866 0.000120 ***</span></span>
<span id="cb964-22"><a href="sec-endogenous-sample-selection.html#cb964-22" tabindex="-1"></a><span class="co">#&gt; huswage     -0.0434253  0.0123229  -3.524 0.000451 ***</span></span>
<span id="cb964-23"><a href="sec-endogenous-sample-selection.html#cb964-23" tabindex="-1"></a><span class="co">#&gt; educ         0.1255639  0.0229229   5.478 5.91e-08 ***</span></span>
<span id="cb964-24"><a href="sec-endogenous-sample-selection.html#cb964-24" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb964-25"><a href="sec-endogenous-sample-selection.html#cb964-25" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb964-26"><a href="sec-endogenous-sample-selection.html#cb964-26" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.5814781  0.3052031  -1.905  0.05714 .  </span></span>
<span id="cb964-27"><a href="sec-endogenous-sample-selection.html#cb964-27" tabindex="-1"></a><span class="co">#&gt; educ         0.1078481  0.0172998   6.234 7.63e-10 ***</span></span>
<span id="cb964-28"><a href="sec-endogenous-sample-selection.html#cb964-28" tabindex="-1"></a><span class="co">#&gt; exper        0.0415752  0.0133269   3.120  0.00188 ** </span></span>
<span id="cb964-29"><a href="sec-endogenous-sample-selection.html#cb964-29" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008125  0.0003974  -2.044  0.04129 *  </span></span>
<span id="cb964-30"><a href="sec-endogenous-sample-selection.html#cb964-30" tabindex="-1"></a><span class="co">#&gt; city         0.0522990  0.0682652   0.766  0.44385    </span></span>
<span id="cb964-31"><a href="sec-endogenous-sample-selection.html#cb964-31" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb964-32"><a href="sec-endogenous-sample-selection.html#cb964-32" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb964-33"><a href="sec-endogenous-sample-selection.html#cb964-33" tabindex="-1"></a><span class="co">#&gt; sigma  0.66326    0.02309  28.729   &lt;2e-16 ***</span></span>
<span id="cb964-34"><a href="sec-endogenous-sample-selection.html#cb964-34" tabindex="-1"></a><span class="co">#&gt; rho    0.05048    0.23169   0.218    0.828    </span></span>
<span id="cb964-35"><a href="sec-endogenous-sample-selection.html#cb964-35" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb964-36"><a href="sec-endogenous-sample-selection.html#cb964-36" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb964-37"><a href="sec-endogenous-sample-selection.html#cb964-37" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>The MLE approach jointly estimates both equations, yielding consistent and asymptotically efficient estimates.</p>
<p>Manual Implementation: Constructing the IMR</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="sec-endogenous-sample-selection.html#cb965-1" tabindex="-1"></a><span class="co"># Step 1: Probit model</span></span>
<span id="cb965-2"><a href="sec-endogenous-sample-selection.html#cb965-2" tabindex="-1"></a>myprob <span class="ot">&lt;-</span> <span class="fu">probit</span>(lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb965-3"><a href="sec-endogenous-sample-selection.html#cb965-3" tabindex="-1"></a>                 <span class="at">data =</span> Mroz87)</span>
<span id="cb965-4"><a href="sec-endogenous-sample-selection.html#cb965-4" tabindex="-1"></a><span class="fu">summary</span>(myprob)</span>
<span id="cb965-5"><a href="sec-endogenous-sample-selection.html#cb965-5" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb965-6"><a href="sec-endogenous-sample-selection.html#cb965-6" tabindex="-1"></a><span class="co">#&gt; Probit binary choice model/Maximum Likelihood estimation</span></span>
<span id="cb965-7"><a href="sec-endogenous-sample-selection.html#cb965-7" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb965-8"><a href="sec-endogenous-sample-selection.html#cb965-8" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb965-9"><a href="sec-endogenous-sample-selection.html#cb965-9" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -482.8212 </span></span>
<span id="cb965-10"><a href="sec-endogenous-sample-selection.html#cb965-10" tabindex="-1"></a><span class="co">#&gt; Model: Y == &#39;1&#39; in contrary to &#39;0&#39;</span></span>
<span id="cb965-11"><a href="sec-endogenous-sample-selection.html#cb965-11" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 &#39;negative&#39; and 428 &#39;positive&#39;) and 6 free parameters (df = 747)</span></span>
<span id="cb965-12"><a href="sec-endogenous-sample-selection.html#cb965-12" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb965-13"><a href="sec-endogenous-sample-selection.html#cb965-13" tabindex="-1"></a><span class="co">#&gt;                Estimate  Std. error t value   Pr(&gt; t)    </span></span>
<span id="cb965-14"><a href="sec-endogenous-sample-selection.html#cb965-14" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.18146681  1.40241567 -2.9816  0.002867 ** </span></span>
<span id="cb965-15"><a href="sec-endogenous-sample-selection.html#cb965-15" tabindex="-1"></a><span class="co">#&gt; age          0.18608901  0.06517476  2.8552  0.004301 ** </span></span>
<span id="cb965-16"><a href="sec-endogenous-sample-selection.html#cb965-16" tabindex="-1"></a><span class="co">#&gt; I(age^2)    -0.00241491  0.00075857 -3.1835  0.001455 ** </span></span>
<span id="cb965-17"><a href="sec-endogenous-sample-selection.html#cb965-17" tabindex="-1"></a><span class="co">#&gt; kids        -0.14955977  0.03825079 -3.9100 9.230e-05 ***</span></span>
<span id="cb965-18"><a href="sec-endogenous-sample-selection.html#cb965-18" tabindex="-1"></a><span class="co">#&gt; huswage     -0.04303635  0.01220791 -3.5253  0.000423 ***</span></span>
<span id="cb965-19"><a href="sec-endogenous-sample-selection.html#cb965-19" tabindex="-1"></a><span class="co">#&gt; educ         0.12502818  0.02277645  5.4894 4.034e-08 ***</span></span>
<span id="cb965-20"><a href="sec-endogenous-sample-selection.html#cb965-20" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb965-21"><a href="sec-endogenous-sample-selection.html#cb965-21" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb965-22"><a href="sec-endogenous-sample-selection.html#cb965-22" tabindex="-1"></a><span class="co">#&gt; Significance test:</span></span>
<span id="cb965-23"><a href="sec-endogenous-sample-selection.html#cb965-23" tabindex="-1"></a><span class="co">#&gt; chi2(5) = 64.10407 (p=1.719042e-12)</span></span>
<span id="cb965-24"><a href="sec-endogenous-sample-selection.html#cb965-24" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb965-25"><a href="sec-endogenous-sample-selection.html#cb965-25" tabindex="-1"></a></span>
<span id="cb965-26"><a href="sec-endogenous-sample-selection.html#cb965-26" tabindex="-1"></a><span class="co"># Step 2: Compute IMR</span></span>
<span id="cb965-27"><a href="sec-endogenous-sample-selection.html#cb965-27" tabindex="-1"></a>imr <span class="ot">&lt;-</span> <span class="fu">invMillsRatio</span>(myprob)</span>
<span id="cb965-28"><a href="sec-endogenous-sample-selection.html#cb965-28" tabindex="-1"></a>Mroz87<span class="sc">$</span>IMR1 <span class="ot">&lt;-</span> imr<span class="sc">$</span>IMR1</span>
<span id="cb965-29"><a href="sec-endogenous-sample-selection.html#cb965-29" tabindex="-1"></a></span>
<span id="cb965-30"><a href="sec-endogenous-sample-selection.html#cb965-30" tabindex="-1"></a><span class="co"># Step 3: Wage regression including IMR</span></span>
<span id="cb965-31"><a href="sec-endogenous-sample-selection.html#cb965-31" tabindex="-1"></a>manually_est <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> city <span class="sc">+</span> IMR1,</span>
<span id="cb965-32"><a href="sec-endogenous-sample-selection.html#cb965-32" tabindex="-1"></a>                   <span class="at">data =</span> Mroz87,</span>
<span id="cb965-33"><a href="sec-endogenous-sample-selection.html#cb965-33" tabindex="-1"></a>                   <span class="at">subset =</span> (lfp <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb965-34"><a href="sec-endogenous-sample-selection.html#cb965-34" tabindex="-1"></a><span class="fu">summary</span>(manually_est)</span>
<span id="cb965-35"><a href="sec-endogenous-sample-selection.html#cb965-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb965-36"><a href="sec-endogenous-sample-selection.html#cb965-36" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb965-37"><a href="sec-endogenous-sample-selection.html#cb965-37" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(wage) ~ educ + exper + I(exper^2) + city + IMR1, </span></span>
<span id="cb965-38"><a href="sec-endogenous-sample-selection.html#cb965-38" tabindex="-1"></a><span class="co">#&gt;     data = Mroz87, subset = (lfp == 1))</span></span>
<span id="cb965-39"><a href="sec-endogenous-sample-selection.html#cb965-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb965-40"><a href="sec-endogenous-sample-selection.html#cb965-40" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb965-41"><a href="sec-endogenous-sample-selection.html#cb965-41" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb965-42"><a href="sec-endogenous-sample-selection.html#cb965-42" tabindex="-1"></a><span class="co">#&gt; -3.09494 -0.30953  0.05341  0.36530  2.34770 </span></span>
<span id="cb965-43"><a href="sec-endogenous-sample-selection.html#cb965-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb965-44"><a href="sec-endogenous-sample-selection.html#cb965-44" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb965-45"><a href="sec-endogenous-sample-selection.html#cb965-45" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb965-46"><a href="sec-endogenous-sample-selection.html#cb965-46" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.6143381  0.3768796  -1.630  0.10383    </span></span>
<span id="cb965-47"><a href="sec-endogenous-sample-selection.html#cb965-47" tabindex="-1"></a><span class="co">#&gt; educ         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb965-48"><a href="sec-endogenous-sample-selection.html#cb965-48" tabindex="-1"></a><span class="co">#&gt; exper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb965-49"><a href="sec-endogenous-sample-selection.html#cb965-49" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb965-50"><a href="sec-endogenous-sample-selection.html#cb965-50" tabindex="-1"></a><span class="co">#&gt; city         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb965-51"><a href="sec-endogenous-sample-selection.html#cb965-51" tabindex="-1"></a><span class="co">#&gt; IMR1         0.0551177  0.2111916   0.261  0.79423    </span></span>
<span id="cb965-52"><a href="sec-endogenous-sample-selection.html#cb965-52" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb965-53"><a href="sec-endogenous-sample-selection.html#cb965-53" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb965-54"><a href="sec-endogenous-sample-selection.html#cb965-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb965-55"><a href="sec-endogenous-sample-selection.html#cb965-55" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6674 on 422 degrees of freedom</span></span>
<span id="cb965-56"><a href="sec-endogenous-sample-selection.html#cb965-56" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1582, Adjusted R-squared:  0.1482 </span></span>
<span id="cb965-57"><a href="sec-endogenous-sample-selection.html#cb965-57" tabindex="-1"></a><span class="co">#&gt; F-statistic: 15.86 on 5 and 422 DF,  p-value: 2.505e-14</span></span></code></pre></div>
<p>Equivalent Method Using <code>glm</code> and Manual IMR Calculation</p>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="sec-endogenous-sample-selection.html#cb966-1" tabindex="-1"></a><span class="co"># Probit via glm</span></span>
<span id="cb966-2"><a href="sec-endogenous-sample-selection.html#cb966-2" tabindex="-1"></a>probit_selection <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb966-3"><a href="sec-endogenous-sample-selection.html#cb966-3" tabindex="-1"></a>  lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb966-4"><a href="sec-endogenous-sample-selection.html#cb966-4" tabindex="-1"></a>  <span class="at">data =</span> Mroz87,</span>
<span id="cb966-5"><a href="sec-endogenous-sample-selection.html#cb966-5" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;probit&#39;</span>)</span>
<span id="cb966-6"><a href="sec-endogenous-sample-selection.html#cb966-6" tabindex="-1"></a>)</span>
<span id="cb966-7"><a href="sec-endogenous-sample-selection.html#cb966-7" tabindex="-1"></a></span>
<span id="cb966-8"><a href="sec-endogenous-sample-selection.html#cb966-8" tabindex="-1"></a><span class="co"># Compute predicted latent index and IMR</span></span>
<span id="cb966-9"><a href="sec-endogenous-sample-selection.html#cb966-9" tabindex="-1"></a>probit_lp <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">predict</span>(probit_selection)</span>
<span id="cb966-10"><a href="sec-endogenous-sample-selection.html#cb966-10" tabindex="-1"></a>inv_mills <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(probit_lp) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(probit_lp))</span>
<span id="cb966-11"><a href="sec-endogenous-sample-selection.html#cb966-11" tabindex="-1"></a>Mroz87<span class="sc">$</span>inv_mills <span class="ot">&lt;-</span> inv_mills</span>
<span id="cb966-12"><a href="sec-endogenous-sample-selection.html#cb966-12" tabindex="-1"></a></span>
<span id="cb966-13"><a href="sec-endogenous-sample-selection.html#cb966-13" tabindex="-1"></a><span class="co"># Second stage: Wage regression with correction</span></span>
<span id="cb966-14"><a href="sec-endogenous-sample-selection.html#cb966-14" tabindex="-1"></a>probit_outcome <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb966-15"><a href="sec-endogenous-sample-selection.html#cb966-15" tabindex="-1"></a>  <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> city <span class="sc">+</span> inv_mills,</span>
<span id="cb966-16"><a href="sec-endogenous-sample-selection.html#cb966-16" tabindex="-1"></a>  <span class="at">data =</span> Mroz87,</span>
<span id="cb966-17"><a href="sec-endogenous-sample-selection.html#cb966-17" tabindex="-1"></a>  <span class="at">subset =</span> (lfp <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb966-18"><a href="sec-endogenous-sample-selection.html#cb966-18" tabindex="-1"></a>)</span>
<span id="cb966-19"><a href="sec-endogenous-sample-selection.html#cb966-19" tabindex="-1"></a><span class="fu">summary</span>(probit_outcome)</span>
<span id="cb966-20"><a href="sec-endogenous-sample-selection.html#cb966-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb966-21"><a href="sec-endogenous-sample-selection.html#cb966-21" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb966-22"><a href="sec-endogenous-sample-selection.html#cb966-22" tabindex="-1"></a><span class="co">#&gt; glm(formula = log(wage) ~ educ + exper + I(exper^2) + city + </span></span>
<span id="cb966-23"><a href="sec-endogenous-sample-selection.html#cb966-23" tabindex="-1"></a><span class="co">#&gt;     inv_mills, data = Mroz87, subset = (lfp == 1))</span></span>
<span id="cb966-24"><a href="sec-endogenous-sample-selection.html#cb966-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb966-25"><a href="sec-endogenous-sample-selection.html#cb966-25" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb966-26"><a href="sec-endogenous-sample-selection.html#cb966-26" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb966-27"><a href="sec-endogenous-sample-selection.html#cb966-27" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.6143383  0.3768798  -1.630  0.10383    </span></span>
<span id="cb966-28"><a href="sec-endogenous-sample-selection.html#cb966-28" tabindex="-1"></a><span class="co">#&gt; educ         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb966-29"><a href="sec-endogenous-sample-selection.html#cb966-29" tabindex="-1"></a><span class="co">#&gt; exper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb966-30"><a href="sec-endogenous-sample-selection.html#cb966-30" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb966-31"><a href="sec-endogenous-sample-selection.html#cb966-31" tabindex="-1"></a><span class="co">#&gt; city         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb966-32"><a href="sec-endogenous-sample-selection.html#cb966-32" tabindex="-1"></a><span class="co">#&gt; inv_mills    0.0551179  0.2111918   0.261  0.79423    </span></span>
<span id="cb966-33"><a href="sec-endogenous-sample-selection.html#cb966-33" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb966-34"><a href="sec-endogenous-sample-selection.html#cb966-34" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb966-35"><a href="sec-endogenous-sample-selection.html#cb966-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb966-36"><a href="sec-endogenous-sample-selection.html#cb966-36" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.4454809)</span></span>
<span id="cb966-37"><a href="sec-endogenous-sample-selection.html#cb966-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb966-38"><a href="sec-endogenous-sample-selection.html#cb966-38" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 223.33  on 427  degrees of freedom</span></span>
<span id="cb966-39"><a href="sec-endogenous-sample-selection.html#cb966-39" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 187.99  on 422  degrees of freedom</span></span>
<span id="cb966-40"><a href="sec-endogenous-sample-selection.html#cb966-40" tabindex="-1"></a><span class="co">#&gt; AIC: 876.49</span></span>
<span id="cb966-41"><a href="sec-endogenous-sample-selection.html#cb966-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb966-42"><a href="sec-endogenous-sample-selection.html#cb966-42" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>Comparing Models</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="sec-endogenous-sample-selection.html#cb967-1" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb967-2"><a href="sec-endogenous-sample-selection.html#cb967-2" tabindex="-1"></a><span class="fu">library</span>(plm)</span>
<span id="cb967-3"><a href="sec-endogenous-sample-selection.html#cb967-3" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb967-4"><a href="sec-endogenous-sample-selection.html#cb967-4" tabindex="-1"></a></span>
<span id="cb967-5"><a href="sec-endogenous-sample-selection.html#cb967-5" tabindex="-1"></a><span class="co"># Custom robust SE function</span></span>
<span id="cb967-6"><a href="sec-endogenous-sample-selection.html#cb967-6" tabindex="-1"></a>cse <span class="ot">=</span> <span class="cf">function</span>(reg) {</span>
<span id="cb967-7"><a href="sec-endogenous-sample-selection.html#cb967-7" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(reg, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)))</span>
<span id="cb967-8"><a href="sec-endogenous-sample-selection.html#cb967-8" tabindex="-1"></a>}</span>
<span id="cb967-9"><a href="sec-endogenous-sample-selection.html#cb967-9" tabindex="-1"></a></span>
<span id="cb967-10"><a href="sec-endogenous-sample-selection.html#cb967-10" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb967-11"><a href="sec-endogenous-sample-selection.html#cb967-11" tabindex="-1"></a><span class="fu">stargazer</span>(</span>
<span id="cb967-12"><a href="sec-endogenous-sample-selection.html#cb967-12" tabindex="-1"></a>  ols1, heck1, ml1, manually_est,</span>
<span id="cb967-13"><a href="sec-endogenous-sample-selection.html#cb967-13" tabindex="-1"></a>  <span class="at">se =</span> <span class="fu">list</span>(<span class="fu">cse</span>(ols1), <span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>),</span>
<span id="cb967-14"><a href="sec-endogenous-sample-selection.html#cb967-14" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Married Women&#39;s Wage Regressions: OLS vs Heckman Models&quot;</span>,</span>
<span id="cb967-15"><a href="sec-endogenous-sample-selection.html#cb967-15" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb967-16"><a href="sec-endogenous-sample-selection.html#cb967-16" tabindex="-1"></a>  <span class="at">df =</span> <span class="cn">FALSE</span>,</span>
<span id="cb967-17"><a href="sec-endogenous-sample-selection.html#cb967-17" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb967-18"><a href="sec-endogenous-sample-selection.html#cb967-18" tabindex="-1"></a>  <span class="at">selection.equation =</span> <span class="cn">TRUE</span></span>
<span id="cb967-19"><a href="sec-endogenous-sample-selection.html#cb967-19" tabindex="-1"></a>)</span>
<span id="cb967-20"><a href="sec-endogenous-sample-selection.html#cb967-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb967-21"><a href="sec-endogenous-sample-selection.html#cb967-21" tabindex="-1"></a><span class="co">#&gt; Married Women&#39;s Wage Regressions: OLS vs Heckman Models</span></span>
<span id="cb967-22"><a href="sec-endogenous-sample-selection.html#cb967-22" tabindex="-1"></a><span class="co">#&gt; =========================================================================</span></span>
<span id="cb967-23"><a href="sec-endogenous-sample-selection.html#cb967-23" tabindex="-1"></a><span class="co">#&gt;                                      Dependent variable:                 </span></span>
<span id="cb967-24"><a href="sec-endogenous-sample-selection.html#cb967-24" tabindex="-1"></a><span class="co">#&gt;                     -----------------------------------------------------</span></span>
<span id="cb967-25"><a href="sec-endogenous-sample-selection.html#cb967-25" tabindex="-1"></a><span class="co">#&gt;                     log(wage)                lfp               log(wage) </span></span>
<span id="cb967-26"><a href="sec-endogenous-sample-selection.html#cb967-26" tabindex="-1"></a><span class="co">#&gt;                        OLS         Heckman        selection       OLS    </span></span>
<span id="cb967-27"><a href="sec-endogenous-sample-selection.html#cb967-27" tabindex="-1"></a><span class="co">#&gt;                                   selection                              </span></span>
<span id="cb967-28"><a href="sec-endogenous-sample-selection.html#cb967-28" tabindex="-1"></a><span class="co">#&gt;                        (1)           (2)             (3)          (4)    </span></span>
<span id="cb967-29"><a href="sec-endogenous-sample-selection.html#cb967-29" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------</span></span>
<span id="cb967-30"><a href="sec-endogenous-sample-selection.html#cb967-30" tabindex="-1"></a><span class="co">#&gt; age                               0.1861***       0.1842***              </span></span>
<span id="cb967-31"><a href="sec-endogenous-sample-selection.html#cb967-31" tabindex="-1"></a><span class="co">#&gt;                                   (0.0652)        (0.0658)               </span></span>
<span id="cb967-32"><a href="sec-endogenous-sample-selection.html#cb967-32" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-33"><a href="sec-endogenous-sample-selection.html#cb967-33" tabindex="-1"></a><span class="co">#&gt; I(age2)                          -0.0024***      -0.0024***              </span></span>
<span id="cb967-34"><a href="sec-endogenous-sample-selection.html#cb967-34" tabindex="-1"></a><span class="co">#&gt;                                   (0.0008)        (0.0008)               </span></span>
<span id="cb967-35"><a href="sec-endogenous-sample-selection.html#cb967-35" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-36"><a href="sec-endogenous-sample-selection.html#cb967-36" tabindex="-1"></a><span class="co">#&gt; kids                             -0.1496***      -0.1488***              </span></span>
<span id="cb967-37"><a href="sec-endogenous-sample-selection.html#cb967-37" tabindex="-1"></a><span class="co">#&gt;                                   (0.0383)        (0.0385)               </span></span>
<span id="cb967-38"><a href="sec-endogenous-sample-selection.html#cb967-38" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-39"><a href="sec-endogenous-sample-selection.html#cb967-39" tabindex="-1"></a><span class="co">#&gt; huswage                          -0.0430***      -0.0434***              </span></span>
<span id="cb967-40"><a href="sec-endogenous-sample-selection.html#cb967-40" tabindex="-1"></a><span class="co">#&gt;                                   (0.0122)        (0.0123)               </span></span>
<span id="cb967-41"><a href="sec-endogenous-sample-selection.html#cb967-41" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-42"><a href="sec-endogenous-sample-selection.html#cb967-42" tabindex="-1"></a><span class="co">#&gt; educ                0.1057***     0.1250***       0.1256***    0.1092*** </span></span>
<span id="cb967-43"><a href="sec-endogenous-sample-selection.html#cb967-43" tabindex="-1"></a><span class="co">#&gt;                      (0.0130)     (0.0228)        (0.0229)      (0.0197) </span></span>
<span id="cb967-44"><a href="sec-endogenous-sample-selection.html#cb967-44" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-45"><a href="sec-endogenous-sample-selection.html#cb967-45" tabindex="-1"></a><span class="co">#&gt; exper               0.0411***                                  0.0419*** </span></span>
<span id="cb967-46"><a href="sec-endogenous-sample-selection.html#cb967-46" tabindex="-1"></a><span class="co">#&gt;                      (0.0154)                                   (0.0136) </span></span>
<span id="cb967-47"><a href="sec-endogenous-sample-selection.html#cb967-47" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-48"><a href="sec-endogenous-sample-selection.html#cb967-48" tabindex="-1"></a><span class="co">#&gt; I(exper2)            -0.0008*                                  -0.0008** </span></span>
<span id="cb967-49"><a href="sec-endogenous-sample-selection.html#cb967-49" tabindex="-1"></a><span class="co">#&gt;                      (0.0004)                                   (0.0004) </span></span>
<span id="cb967-50"><a href="sec-endogenous-sample-selection.html#cb967-50" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-51"><a href="sec-endogenous-sample-selection.html#cb967-51" tabindex="-1"></a><span class="co">#&gt; city                  0.0542                                     0.0510  </span></span>
<span id="cb967-52"><a href="sec-endogenous-sample-selection.html#cb967-52" tabindex="-1"></a><span class="co">#&gt;                      (0.0653)                                   (0.0692) </span></span>
<span id="cb967-53"><a href="sec-endogenous-sample-selection.html#cb967-53" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-54"><a href="sec-endogenous-sample-selection.html#cb967-54" tabindex="-1"></a><span class="co">#&gt; IMR1                                                             0.0551  </span></span>
<span id="cb967-55"><a href="sec-endogenous-sample-selection.html#cb967-55" tabindex="-1"></a><span class="co">#&gt;                                                                 (0.2112) </span></span>
<span id="cb967-56"><a href="sec-endogenous-sample-selection.html#cb967-56" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-57"><a href="sec-endogenous-sample-selection.html#cb967-57" tabindex="-1"></a><span class="co">#&gt; Constant            -0.5308***   -4.1815***      -4.1484***     -0.6143  </span></span>
<span id="cb967-58"><a href="sec-endogenous-sample-selection.html#cb967-58" tabindex="-1"></a><span class="co">#&gt;                      (0.2032)     (1.4024)        (1.4109)      (0.3769) </span></span>
<span id="cb967-59"><a href="sec-endogenous-sample-selection.html#cb967-59" tabindex="-1"></a><span class="co">#&gt;                                                                          </span></span>
<span id="cb967-60"><a href="sec-endogenous-sample-selection.html#cb967-60" tabindex="-1"></a><span class="co">#&gt; -------------------------------------------------------------------------</span></span>
<span id="cb967-61"><a href="sec-endogenous-sample-selection.html#cb967-61" tabindex="-1"></a><span class="co">#&gt; Observations           428           753             753          428    </span></span>
<span id="cb967-62"><a href="sec-endogenous-sample-selection.html#cb967-62" tabindex="-1"></a><span class="co">#&gt; R2                    0.1581       0.1582                        0.1582  </span></span>
<span id="cb967-63"><a href="sec-endogenous-sample-selection.html#cb967-63" tabindex="-1"></a><span class="co">#&gt; Adjusted R2           0.1501       0.1482                        0.1482  </span></span>
<span id="cb967-64"><a href="sec-endogenous-sample-selection.html#cb967-64" tabindex="-1"></a><span class="co">#&gt; Log Likelihood                                    -914.0777              </span></span>
<span id="cb967-65"><a href="sec-endogenous-sample-selection.html#cb967-65" tabindex="-1"></a><span class="co">#&gt; rho                                0.0830      0.0505 (0.2317)           </span></span>
<span id="cb967-66"><a href="sec-endogenous-sample-selection.html#cb967-66" tabindex="-1"></a><span class="co">#&gt; Inverse Mills Ratio            0.0551 (0.2099)                           </span></span>
<span id="cb967-67"><a href="sec-endogenous-sample-selection.html#cb967-67" tabindex="-1"></a><span class="co">#&gt; Residual Std. Error   0.6667                                     0.6674  </span></span>
<span id="cb967-68"><a href="sec-endogenous-sample-selection.html#cb967-68" tabindex="-1"></a><span class="co">#&gt; F Statistic         19.8561***                                 15.8635***</span></span>
<span id="cb967-69"><a href="sec-endogenous-sample-selection.html#cb967-69" tabindex="-1"></a><span class="co">#&gt; =========================================================================</span></span>
<span id="cb967-70"><a href="sec-endogenous-sample-selection.html#cb967-70" tabindex="-1"></a><span class="co">#&gt; Note:                                         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<ul>
<li><p>IMR: If the coefficient on the IMR is statistically significant, it suggests selection bias is present and that OLS estimates are biased.</p></li>
<li><p><span class="math inline">\(\rho\)</span>: Represents the estimated correlation between the error terms of the selection and outcome equations. A significant <span class="math inline">\(\rho\)</span> implies non-random selection, justifying the Heckman correction.</p></li>
<li><p>In our case, if the IMR coefficient is not statistically different from zero, then selection bias may not be a serious concern.</p></li>
</ul>
</div>
<div id="the-role-of-exclusion-restrictions-in-heckmans-model" class="section level4 hasAnchor" number="36.2.4.2">
<h4><span class="header-section-number">36.2.4.2</span> The Role of Exclusion Restrictions in Heckman’s Model<a href="sec-endogenous-sample-selection.html#the-role-of-exclusion-restrictions-in-heckmans-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This example, adapted from the <code>sampleSelection</code>, demonstrates the identification of the sample selection model using simulated data.</p>
<p>We compare two cases:</p>
<ul>
<li><p>One where an <strong>exclusion restriction</strong> is present (i.e., selection and outcome equations use different regressors).</p></li>
<li><p>One where the <strong>same regressor</strong> is used in both equations.</p></li>
</ul>
<hr />
<p><strong>Case 1: With Exclusion Restriction</strong></p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="sec-endogenous-sample-selection.html#cb968-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb968-2"><a href="sec-endogenous-sample-selection.html#cb968-2" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb968-3"><a href="sec-endogenous-sample-selection.html#cb968-3" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb968-4"><a href="sec-endogenous-sample-selection.html#cb968-4" tabindex="-1"></a></span>
<span id="cb968-5"><a href="sec-endogenous-sample-selection.html#cb968-5" tabindex="-1"></a></span>
<span id="cb968-6"><a href="sec-endogenous-sample-selection.html#cb968-6" tabindex="-1"></a><span class="co"># Simulate bivariate normal error terms with correlation -0.7</span></span>
<span id="cb968-7"><a href="sec-endogenous-sample-selection.html#cb968-7" tabindex="-1"></a>eps <span class="ot">&lt;-</span></span>
<span id="cb968-8"><a href="sec-endogenous-sample-selection.html#cb968-8" tabindex="-1"></a>    <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">0.7</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb968-9"><a href="sec-endogenous-sample-selection.html#cb968-9" tabindex="-1"></a></span>
<span id="cb968-10"><a href="sec-endogenous-sample-selection.html#cb968-10" tabindex="-1"></a><span class="co"># Independent explanatory variable for selection equation</span></span>
<span id="cb968-11"><a href="sec-endogenous-sample-selection.html#cb968-11" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb968-12"><a href="sec-endogenous-sample-selection.html#cb968-12" tabindex="-1"></a></span>
<span id="cb968-13"><a href="sec-endogenous-sample-selection.html#cb968-13" tabindex="-1"></a><span class="co"># Selection: Probit model (latent utility model)</span></span>
<span id="cb968-14"><a href="sec-endogenous-sample-selection.html#cb968-14" tabindex="-1"></a>ys_latent <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">1</span>]</span>
<span id="cb968-15"><a href="sec-endogenous-sample-selection.html#cb968-15" tabindex="-1"></a>ys <span class="ot">&lt;-</span> ys_latent <span class="sc">&gt;</span> <span class="dv">0</span>  <span class="co"># observed participation indicator (TRUE/FALSE)</span></span>
<span id="cb968-16"><a href="sec-endogenous-sample-selection.html#cb968-16" tabindex="-1"></a></span>
<span id="cb968-17"><a href="sec-endogenous-sample-selection.html#cb968-17" tabindex="-1"></a><span class="co"># Independent explanatory variable for outcome equation</span></span>
<span id="cb968-18"><a href="sec-endogenous-sample-selection.html#cb968-18" tabindex="-1"></a>xo <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb968-19"><a href="sec-endogenous-sample-selection.html#cb968-19" tabindex="-1"></a></span>
<span id="cb968-20"><a href="sec-endogenous-sample-selection.html#cb968-20" tabindex="-1"></a><span class="co"># Latent outcome variable</span></span>
<span id="cb968-21"><a href="sec-endogenous-sample-selection.html#cb968-21" tabindex="-1"></a>yo_latent <span class="ot">&lt;-</span> xo <span class="sc">+</span> eps[, <span class="dv">2</span>]</span>
<span id="cb968-22"><a href="sec-endogenous-sample-selection.html#cb968-22" tabindex="-1"></a></span>
<span id="cb968-23"><a href="sec-endogenous-sample-selection.html#cb968-23" tabindex="-1"></a><span class="co"># Observed outcome: only when selected (ys == TRUE)</span></span>
<span id="cb968-24"><a href="sec-endogenous-sample-selection.html#cb968-24" tabindex="-1"></a>yo <span class="ot">&lt;-</span> yo_latent <span class="sc">*</span> ys</span>
<span id="cb968-25"><a href="sec-endogenous-sample-selection.html#cb968-25" tabindex="-1"></a></span>
<span id="cb968-26"><a href="sec-endogenous-sample-selection.html#cb968-26" tabindex="-1"></a><span class="co"># Estimate Heckman&#39;s selection model</span></span>
<span id="cb968-27"><a href="sec-endogenous-sample-selection.html#cb968-27" tabindex="-1"></a>model_with_exclusion <span class="ot">&lt;-</span></span>
<span id="cb968-28"><a href="sec-endogenous-sample-selection.html#cb968-28" tabindex="-1"></a>    <span class="fu">selection</span>(<span class="at">selection =</span> ys <span class="sc">~</span> xs, <span class="at">outcome =</span> yo <span class="sc">~</span> xo)</span>
<span id="cb968-29"><a href="sec-endogenous-sample-selection.html#cb968-29" tabindex="-1"></a><span class="fu">summary</span>(model_with_exclusion)</span>
<span id="cb968-30"><a href="sec-endogenous-sample-selection.html#cb968-30" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb968-31"><a href="sec-endogenous-sample-selection.html#cb968-31" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb968-32"><a href="sec-endogenous-sample-selection.html#cb968-32" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb968-33"><a href="sec-endogenous-sample-selection.html#cb968-33" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 5 iterations</span></span>
<span id="cb968-34"><a href="sec-endogenous-sample-selection.html#cb968-34" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb968-35"><a href="sec-endogenous-sample-selection.html#cb968-35" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.3163 </span></span>
<span id="cb968-36"><a href="sec-endogenous-sample-selection.html#cb968-36" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb968-37"><a href="sec-endogenous-sample-selection.html#cb968-37" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb968-38"><a href="sec-endogenous-sample-selection.html#cb968-38" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb968-39"><a href="sec-endogenous-sample-selection.html#cb968-39" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb968-40"><a href="sec-endogenous-sample-selection.html#cb968-40" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.2228     0.1081  -2.061   0.0399 *  </span></span>
<span id="cb968-41"><a href="sec-endogenous-sample-selection.html#cb968-41" tabindex="-1"></a><span class="co">#&gt; xs            1.3377     0.2014   6.642 8.18e-11 ***</span></span>
<span id="cb968-42"><a href="sec-endogenous-sample-selection.html#cb968-42" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb968-43"><a href="sec-endogenous-sample-selection.html#cb968-43" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb968-44"><a href="sec-endogenous-sample-selection.html#cb968-44" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.0002265  0.1294178  -0.002    0.999    </span></span>
<span id="cb968-45"><a href="sec-endogenous-sample-selection.html#cb968-45" tabindex="-1"></a><span class="co">#&gt; xo           0.7299070  0.1635925   4.462 1.01e-05 ***</span></span>
<span id="cb968-46"><a href="sec-endogenous-sample-selection.html#cb968-46" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb968-47"><a href="sec-endogenous-sample-selection.html#cb968-47" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb968-48"><a href="sec-endogenous-sample-selection.html#cb968-48" tabindex="-1"></a><span class="co">#&gt; sigma   0.9190     0.0574  16.009  &lt; 2e-16 ***</span></span>
<span id="cb968-49"><a href="sec-endogenous-sample-selection.html#cb968-49" tabindex="-1"></a><span class="co">#&gt; rho    -0.5392     0.1521  -3.544 0.000431 ***</span></span>
<span id="cb968-50"><a href="sec-endogenous-sample-selection.html#cb968-50" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb968-51"><a href="sec-endogenous-sample-selection.html#cb968-51" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb968-52"><a href="sec-endogenous-sample-selection.html#cb968-52" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p><strong>Key Observations:</strong></p>
<ul>
<li><p>The variables <code>xs</code> and <code>xo</code> are <strong>independent</strong>, fulfilling the <strong>exclusion restriction</strong>.</p></li>
<li><p>The outcome equation is identified not only by the non-linearity of the model but also by the presence of a regressor in the selection equation that is absent from the outcome equation.</p></li>
</ul>
<p>This mirrors realistic scenarios in applied business settings, such as:</p>
<ul>
<li><p>Participation in the labor force driven by family or geographic factors (<code>xs</code>), while wages depend on skills or education (<code>xo</code>).</p></li>
<li><p>Loan application driven by personal risk preferences, while interest rates depend on credit score or income.</p></li>
</ul>
<hr />
<p><strong>Case 2: Without Exclusion Restriction</strong></p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="sec-endogenous-sample-selection.html#cb969-1" tabindex="-1"></a><span class="co"># Now use the same regressor (xs) in both equations</span></span>
<span id="cb969-2"><a href="sec-endogenous-sample-selection.html#cb969-2" tabindex="-1"></a>yo_latent2 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">2</span>]</span>
<span id="cb969-3"><a href="sec-endogenous-sample-selection.html#cb969-3" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> yo_latent2 <span class="sc">*</span> ys</span>
<span id="cb969-4"><a href="sec-endogenous-sample-selection.html#cb969-4" tabindex="-1"></a></span>
<span id="cb969-5"><a href="sec-endogenous-sample-selection.html#cb969-5" tabindex="-1"></a><span class="co"># Re-estimate model without exclusion restriction</span></span>
<span id="cb969-6"><a href="sec-endogenous-sample-selection.html#cb969-6" tabindex="-1"></a>model_no_exclusion <span class="ot">&lt;-</span></span>
<span id="cb969-7"><a href="sec-endogenous-sample-selection.html#cb969-7" tabindex="-1"></a>    <span class="fu">selection</span>(<span class="at">selection =</span> ys <span class="sc">~</span> xs, <span class="at">outcome =</span> yo2 <span class="sc">~</span> xs)</span>
<span id="cb969-8"><a href="sec-endogenous-sample-selection.html#cb969-8" tabindex="-1"></a><span class="fu">summary</span>(model_no_exclusion)</span>
<span id="cb969-9"><a href="sec-endogenous-sample-selection.html#cb969-9" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb969-10"><a href="sec-endogenous-sample-selection.html#cb969-10" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb969-11"><a href="sec-endogenous-sample-selection.html#cb969-11" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb969-12"><a href="sec-endogenous-sample-selection.html#cb969-12" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 14 iterations</span></span>
<span id="cb969-13"><a href="sec-endogenous-sample-selection.html#cb969-13" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb969-14"><a href="sec-endogenous-sample-selection.html#cb969-14" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.8298 </span></span>
<span id="cb969-15"><a href="sec-endogenous-sample-selection.html#cb969-15" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb969-16"><a href="sec-endogenous-sample-selection.html#cb969-16" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb969-17"><a href="sec-endogenous-sample-selection.html#cb969-17" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb969-18"><a href="sec-endogenous-sample-selection.html#cb969-18" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb969-19"><a href="sec-endogenous-sample-selection.html#cb969-19" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1984     0.1114  -1.781   0.0756 .  </span></span>
<span id="cb969-20"><a href="sec-endogenous-sample-selection.html#cb969-20" tabindex="-1"></a><span class="co">#&gt; xs            1.2907     0.2085   6.191 1.25e-09 ***</span></span>
<span id="cb969-21"><a href="sec-endogenous-sample-selection.html#cb969-21" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb969-22"><a href="sec-endogenous-sample-selection.html#cb969-22" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb969-23"><a href="sec-endogenous-sample-selection.html#cb969-23" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.5499     0.5644  -0.974  0.33038   </span></span>
<span id="cb969-24"><a href="sec-endogenous-sample-selection.html#cb969-24" tabindex="-1"></a><span class="co">#&gt; xs            1.3987     0.4482   3.120  0.00191 **</span></span>
<span id="cb969-25"><a href="sec-endogenous-sample-selection.html#cb969-25" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb969-26"><a href="sec-endogenous-sample-selection.html#cb969-26" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb969-27"><a href="sec-endogenous-sample-selection.html#cb969-27" tabindex="-1"></a><span class="co">#&gt; sigma  0.85091    0.05352  15.899   &lt;2e-16 ***</span></span>
<span id="cb969-28"><a href="sec-endogenous-sample-selection.html#cb969-28" tabindex="-1"></a><span class="co">#&gt; rho   -0.13226    0.72684  -0.182    0.856    </span></span>
<span id="cb969-29"><a href="sec-endogenous-sample-selection.html#cb969-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb969-30"><a href="sec-endogenous-sample-selection.html#cb969-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb969-31"><a href="sec-endogenous-sample-selection.html#cb969-31" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p><strong>What changes?</strong></p>
<ul>
<li><p>The estimates remain approximately unbiased because the model is still identified by functional form (non-linear selection mechanism).</p></li>
<li><p>However, the standard errors are substantially larger, leading to less precise inference.</p></li>
</ul>
<p><strong>Why Exclusion Restrictions Matter</strong></p>
<p>The exclusion restriction improves identification by introducing additional variation that affects selection but not the outcome. This is a common recommendation in empirical work:</p>
<ul>
<li><p>In the first case, <code>xs</code> helps explain who is selected, while <code>xo</code> helps explain the outcome, enabling more precise estimates.</p></li>
<li><p>In the second case, all variation comes from <code>xs</code>, meaning the model relies solely on the distributional assumptions (e.g., joint normality of errors) for identification.</p></li>
</ul>
<p><strong>Best Practice (for applied researchers):</strong></p>
<blockquote>
<p>Always try to include at least one variable in the selection equation that does <strong>not appear in the outcome equation</strong>. This helps identify the model and improves estimation precision.</p>
</blockquote>
<hr />
</div>
</div>
<div id="tobit-5-switching-regression-model" class="section level3 hasAnchor" number="36.2.5">
<h3><span class="header-section-number">36.2.5</span> Tobit-5: Switching Regression Model<a href="sec-endogenous-sample-selection.html#tobit-5-switching-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Tobit-5</strong> model, also known as the <strong>Switching Regression Model</strong>, generalizes Heckman’s sample selection model to allow for two separate outcome equations:</p>
<ul>
<li>One model for participants</li>
<li>A different model for non-participants</li>
</ul>
<p>Assumptions:</p>
<ul>
<li>The selection process determines which outcome equation is observed.</li>
<li>There is at least one variable in the selection equation that does not appear in the outcome equations (i.e., an exclusion restriction), which improves identification.</li>
<li>The errors from all three equations (selection, outcome1, outcome2) are assumed to be jointly normally distributed.</li>
</ul>
<p>This model is especially relevant when selection is endogenous and both groups (selected and unselected) have distinct data-generating processes.</p>
<hr />
<div id="simulated-example-with-exclusion-restriction" class="section level4 hasAnchor" number="36.2.5.1">
<h4><span class="header-section-number">36.2.5.1</span> Simulated Example: With Exclusion Restriction<a href="sec-endogenous-sample-selection.html#simulated-example-with-exclusion-restriction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="sec-endogenous-sample-selection.html#cb970-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb970-2"><a href="sec-endogenous-sample-selection.html#cb970-2" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb970-3"><a href="sec-endogenous-sample-selection.html#cb970-3" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb970-4"><a href="sec-endogenous-sample-selection.html#cb970-4" tabindex="-1"></a></span>
<span id="cb970-5"><a href="sec-endogenous-sample-selection.html#cb970-5" tabindex="-1"></a><span class="co"># Define a 3x3 covariance matrix with positive correlations</span></span>
<span id="cb970-6"><a href="sec-endogenous-sample-selection.html#cb970-6" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb970-7"><a href="sec-endogenous-sample-selection.html#cb970-7" tabindex="-1"></a>vc[<span class="fu">lower.tri</span>(vc)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb970-8"><a href="sec-endogenous-sample-selection.html#cb970-8" tabindex="-1"></a>vc[<span class="fu">upper.tri</span>(vc)] <span class="ot">&lt;-</span> <span class="fu">t</span>(vc)[<span class="fu">upper.tri</span>(vc)]</span>
<span id="cb970-9"><a href="sec-endogenous-sample-selection.html#cb970-9" tabindex="-1"></a></span>
<span id="cb970-10"><a href="sec-endogenous-sample-selection.html#cb970-10" tabindex="-1"></a><span class="co"># Generate multivariate normal error terms</span></span>
<span id="cb970-11"><a href="sec-endogenous-sample-selection.html#cb970-11" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> vc)</span>
<span id="cb970-12"><a href="sec-endogenous-sample-selection.html#cb970-12" tabindex="-1"></a></span>
<span id="cb970-13"><a href="sec-endogenous-sample-selection.html#cb970-13" tabindex="-1"></a><span class="co"># Selection equation regressor (xs), uniformly distributed</span></span>
<span id="cb970-14"><a href="sec-endogenous-sample-selection.html#cb970-14" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb970-15"><a href="sec-endogenous-sample-selection.html#cb970-15" tabindex="-1"></a></span>
<span id="cb970-16"><a href="sec-endogenous-sample-selection.html#cb970-16" tabindex="-1"></a><span class="co"># Binary selection indicator: ys = 1 if selected</span></span>
<span id="cb970-17"><a href="sec-endogenous-sample-selection.html#cb970-17" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb970-18"><a href="sec-endogenous-sample-selection.html#cb970-18" tabindex="-1"></a></span>
<span id="cb970-19"><a href="sec-endogenous-sample-selection.html#cb970-19" tabindex="-1"></a><span class="co"># Separate regressors for two regimes (fulfilling exclusion restriction)</span></span>
<span id="cb970-20"><a href="sec-endogenous-sample-selection.html#cb970-20" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb970-21"><a href="sec-endogenous-sample-selection.html#cb970-21" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[, <span class="dv">2</span>]  <span class="co"># Outcome for selected group</span></span>
<span id="cb970-22"><a href="sec-endogenous-sample-selection.html#cb970-22" tabindex="-1"></a></span>
<span id="cb970-23"><a href="sec-endogenous-sample-selection.html#cb970-23" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb970-24"><a href="sec-endogenous-sample-selection.html#cb970-24" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[, <span class="dv">3</span>]  <span class="co"># Outcome for non-selected group</span></span>
<span id="cb970-25"><a href="sec-endogenous-sample-selection.html#cb970-25" tabindex="-1"></a></span>
<span id="cb970-26"><a href="sec-endogenous-sample-selection.html#cb970-26" tabindex="-1"></a><span class="co"># Fit switching regression model</span></span>
<span id="cb970-27"><a href="sec-endogenous-sample-selection.html#cb970-27" tabindex="-1"></a>model_switch <span class="ot">&lt;-</span> <span class="fu">selection</span>(ys <span class="sc">~</span> xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2))</span>
<span id="cb970-28"><a href="sec-endogenous-sample-selection.html#cb970-28" tabindex="-1"></a><span class="fu">summary</span>(model_switch)</span>
<span id="cb970-29"><a href="sec-endogenous-sample-selection.html#cb970-29" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb970-30"><a href="sec-endogenous-sample-selection.html#cb970-30" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb970-31"><a href="sec-endogenous-sample-selection.html#cb970-31" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb970-32"><a href="sec-endogenous-sample-selection.html#cb970-32" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 11 iterations</span></span>
<span id="cb970-33"><a href="sec-endogenous-sample-selection.html#cb970-33" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb970-34"><a href="sec-endogenous-sample-selection.html#cb970-34" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -895.8201 </span></span>
<span id="cb970-35"><a href="sec-endogenous-sample-selection.html#cb970-35" tabindex="-1"></a><span class="co">#&gt; 500 observations: 172 selection 1 (FALSE) and 328 selection 2 (TRUE)</span></span>
<span id="cb970-36"><a href="sec-endogenous-sample-selection.html#cb970-36" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 490)</span></span>
<span id="cb970-37"><a href="sec-endogenous-sample-selection.html#cb970-37" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb970-38"><a href="sec-endogenous-sample-selection.html#cb970-38" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb970-39"><a href="sec-endogenous-sample-selection.html#cb970-39" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1550     0.1051  -1.474    0.141    </span></span>
<span id="cb970-40"><a href="sec-endogenous-sample-selection.html#cb970-40" tabindex="-1"></a><span class="co">#&gt; xs            1.1408     0.1785   6.390 3.86e-10 ***</span></span>
<span id="cb970-41"><a href="sec-endogenous-sample-selection.html#cb970-41" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb970-42"><a href="sec-endogenous-sample-selection.html#cb970-42" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb970-43"><a href="sec-endogenous-sample-selection.html#cb970-43" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.02708    0.16395   0.165    0.869    </span></span>
<span id="cb970-44"><a href="sec-endogenous-sample-selection.html#cb970-44" tabindex="-1"></a><span class="co">#&gt; xo1          0.83959    0.14968   5.609  3.4e-08 ***</span></span>
<span id="cb970-45"><a href="sec-endogenous-sample-selection.html#cb970-45" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb970-46"><a href="sec-endogenous-sample-selection.html#cb970-46" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb970-47"><a href="sec-endogenous-sample-selection.html#cb970-47" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.1583     0.1885   0.840    0.401    </span></span>
<span id="cb970-48"><a href="sec-endogenous-sample-selection.html#cb970-48" tabindex="-1"></a><span class="co">#&gt; xo2           0.8375     0.1707   4.908 1.26e-06 ***</span></span>
<span id="cb970-49"><a href="sec-endogenous-sample-selection.html#cb970-49" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb970-50"><a href="sec-endogenous-sample-selection.html#cb970-50" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb970-51"><a href="sec-endogenous-sample-selection.html#cb970-51" tabindex="-1"></a><span class="co">#&gt; sigma1  0.93191    0.09211  10.118   &lt;2e-16 ***</span></span>
<span id="cb970-52"><a href="sec-endogenous-sample-selection.html#cb970-52" tabindex="-1"></a><span class="co">#&gt; sigma2  0.90697    0.04434  20.455   &lt;2e-16 ***</span></span>
<span id="cb970-53"><a href="sec-endogenous-sample-selection.html#cb970-53" tabindex="-1"></a><span class="co">#&gt; rho1    0.88988    0.05353  16.623   &lt;2e-16 ***</span></span>
<span id="cb970-54"><a href="sec-endogenous-sample-selection.html#cb970-54" tabindex="-1"></a><span class="co">#&gt; rho2    0.17695    0.33139   0.534    0.594    </span></span>
<span id="cb970-55"><a href="sec-endogenous-sample-selection.html#cb970-55" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb970-56"><a href="sec-endogenous-sample-selection.html#cb970-56" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb970-57"><a href="sec-endogenous-sample-selection.html#cb970-57" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>The estimated coefficients are close to the true values (intercept = 0, slope = 1), and the model converges well due to correct specification and valid exclusion restriction.</p>
</div>
<div id="example-functional-form-misspecification" class="section level4 hasAnchor" number="36.2.5.2">
<h4><span class="header-section-number">36.2.5.2</span> Example: Functional Form Misspecification<a href="sec-endogenous-sample-selection.html#example-functional-form-misspecification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To demonstrate how <strong>non-normal errors</strong> or skewed distributions affect the model, consider the following:</p>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="sec-endogenous-sample-selection.html#cb971-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb971-2"><a href="sec-endogenous-sample-selection.html#cb971-2" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="at">sigma =</span> vc)</span>
<span id="cb971-3"><a href="sec-endogenous-sample-selection.html#cb971-3" tabindex="-1"></a></span>
<span id="cb971-4"><a href="sec-endogenous-sample-selection.html#cb971-4" tabindex="-1"></a><span class="co"># Induce skewness: squared errors minus 1 to ensure mean zero</span></span>
<span id="cb971-5"><a href="sec-endogenous-sample-selection.html#cb971-5" tabindex="-1"></a>eps <span class="ot">&lt;-</span> eps<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb971-6"><a href="sec-endogenous-sample-selection.html#cb971-6" tabindex="-1"></a></span>
<span id="cb971-7"><a href="sec-endogenous-sample-selection.html#cb971-7" tabindex="-1"></a><span class="co"># Generate xs on a skewed interval [-1, 0]</span></span>
<span id="cb971-8"><a href="sec-endogenous-sample-selection.html#cb971-8" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb971-9"><a href="sec-endogenous-sample-selection.html#cb971-9" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb971-10"><a href="sec-endogenous-sample-selection.html#cb971-10" tabindex="-1"></a></span>
<span id="cb971-11"><a href="sec-endogenous-sample-selection.html#cb971-11" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb971-12"><a href="sec-endogenous-sample-selection.html#cb971-12" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[, <span class="dv">2</span>]</span>
<span id="cb971-13"><a href="sec-endogenous-sample-selection.html#cb971-13" tabindex="-1"></a></span>
<span id="cb971-14"><a href="sec-endogenous-sample-selection.html#cb971-14" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb971-15"><a href="sec-endogenous-sample-selection.html#cb971-15" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[, <span class="dv">3</span>]</span>
<span id="cb971-16"><a href="sec-endogenous-sample-selection.html#cb971-16" tabindex="-1"></a></span>
<span id="cb971-17"><a href="sec-endogenous-sample-selection.html#cb971-17" tabindex="-1"></a><span class="co"># Attempt model estimation</span></span>
<span id="cb971-18"><a href="sec-endogenous-sample-selection.html#cb971-18" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys <span class="sc">~</span> xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2), <span class="at">iterlim =</span> <span class="dv">20</span>))</span>
<span id="cb971-19"><a href="sec-endogenous-sample-selection.html#cb971-19" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb971-20"><a href="sec-endogenous-sample-selection.html#cb971-20" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb971-21"><a href="sec-endogenous-sample-selection.html#cb971-21" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb971-22"><a href="sec-endogenous-sample-selection.html#cb971-22" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 12 iterations</span></span>
<span id="cb971-23"><a href="sec-endogenous-sample-selection.html#cb971-23" tabindex="-1"></a><span class="co">#&gt; Return code 3: Last step could not find a value above the current.</span></span>
<span id="cb971-24"><a href="sec-endogenous-sample-selection.html#cb971-24" tabindex="-1"></a><span class="co">#&gt; Boundary of parameter space?  </span></span>
<span id="cb971-25"><a href="sec-endogenous-sample-selection.html#cb971-25" tabindex="-1"></a><span class="co">#&gt; Consider switching to a more robust optimisation method temporarily.</span></span>
<span id="cb971-26"><a href="sec-endogenous-sample-selection.html#cb971-26" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1695.102 </span></span>
<span id="cb971-27"><a href="sec-endogenous-sample-selection.html#cb971-27" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 782 selection 1 (FALSE) and 218 selection 2 (TRUE)</span></span>
<span id="cb971-28"><a href="sec-endogenous-sample-selection.html#cb971-28" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb971-29"><a href="sec-endogenous-sample-selection.html#cb971-29" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb971-30"><a href="sec-endogenous-sample-selection.html#cb971-30" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb971-31"><a href="sec-endogenous-sample-selection.html#cb971-31" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.660315   0.082477  -8.006  3.3e-15 ***</span></span>
<span id="cb971-32"><a href="sec-endogenous-sample-selection.html#cb971-32" tabindex="-1"></a><span class="co">#&gt; xs           0.007167   0.088630   0.081    0.936    </span></span>
<span id="cb971-33"><a href="sec-endogenous-sample-selection.html#cb971-33" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb971-34"><a href="sec-endogenous-sample-selection.html#cb971-34" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb971-35"><a href="sec-endogenous-sample-selection.html#cb971-35" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.31351    0.04868   -6.44 1.86e-10 ***</span></span>
<span id="cb971-36"><a href="sec-endogenous-sample-selection.html#cb971-36" tabindex="-1"></a><span class="co">#&gt; xo1          1.03862    0.08049   12.90  &lt; 2e-16 ***</span></span>
<span id="cb971-37"><a href="sec-endogenous-sample-selection.html#cb971-37" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb971-38"><a href="sec-endogenous-sample-selection.html#cb971-38" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb971-39"><a href="sec-endogenous-sample-selection.html#cb971-39" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -2.6835     0.2043 -13.132  &lt; 2e-16 ***</span></span>
<span id="cb971-40"><a href="sec-endogenous-sample-selection.html#cb971-40" tabindex="-1"></a><span class="co">#&gt; xo2           1.0230     0.1309   7.814 1.41e-14 ***</span></span>
<span id="cb971-41"><a href="sec-endogenous-sample-selection.html#cb971-41" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb971-42"><a href="sec-endogenous-sample-selection.html#cb971-42" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb971-43"><a href="sec-endogenous-sample-selection.html#cb971-43" tabindex="-1"></a><span class="co">#&gt; sigma1  0.70172    0.02000   35.09   &lt;2e-16 ***</span></span>
<span id="cb971-44"><a href="sec-endogenous-sample-selection.html#cb971-44" tabindex="-1"></a><span class="co">#&gt; sigma2  2.49651        NaN     NaN      NaN    </span></span>
<span id="cb971-45"><a href="sec-endogenous-sample-selection.html#cb971-45" tabindex="-1"></a><span class="co">#&gt; rho1    0.51564    0.04216   12.23   &lt;2e-16 ***</span></span>
<span id="cb971-46"><a href="sec-endogenous-sample-selection.html#cb971-46" tabindex="-1"></a><span class="co">#&gt; rho2    1.00000        NaN     NaN      NaN    </span></span>
<span id="cb971-47"><a href="sec-endogenous-sample-selection.html#cb971-47" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb971-48"><a href="sec-endogenous-sample-selection.html#cb971-48" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb971-49"><a href="sec-endogenous-sample-selection.html#cb971-49" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Even though the exclusion restriction is preserved, non-normal errors introduce bias in the intercept estimates, and convergence is less reliable. This illustrates how functional form misspecification (i.e., deviations from assumed distributional forms) impacts performance.</p>
</div>
<div id="example-no-exclusion-restriction" class="section level4 hasAnchor" number="36.2.5.3">
<h4><span class="header-section-number">36.2.5.3</span> Example: No Exclusion Restriction<a href="sec-endogenous-sample-selection.html#example-no-exclusion-restriction" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Here we remove the exclusion restriction by using the same regressor (<code>xs</code>) in both outcome equations.</p>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="sec-endogenous-sample-selection.html#cb972-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb972-2"><a href="sec-endogenous-sample-selection.html#cb972-2" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb972-3"><a href="sec-endogenous-sample-selection.html#cb972-3" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb972-4"><a href="sec-endogenous-sample-selection.html#cb972-4" tabindex="-1"></a></span>
<span id="cb972-5"><a href="sec-endogenous-sample-selection.html#cb972-5" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">2</span>]</span>
<span id="cb972-6"><a href="sec-endogenous-sample-selection.html#cb972-6" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">3</span>]</span>
<span id="cb972-7"><a href="sec-endogenous-sample-selection.html#cb972-7" tabindex="-1"></a></span>
<span id="cb972-8"><a href="sec-endogenous-sample-selection.html#cb972-8" tabindex="-1"></a><span class="co"># Fit switching regression without exclusion restriction</span></span>
<span id="cb972-9"><a href="sec-endogenous-sample-selection.html#cb972-9" tabindex="-1"></a><span class="fu">summary</span>(tmp <span class="ot">&lt;-</span></span>
<span id="cb972-10"><a href="sec-endogenous-sample-selection.html#cb972-10" tabindex="-1"></a>            <span class="fu">selection</span>(ys <span class="sc">~</span> xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xs, yo2 <span class="sc">~</span> xs), <span class="at">iterlim =</span> <span class="dv">20</span>))</span>
<span id="cb972-11"><a href="sec-endogenous-sample-selection.html#cb972-11" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb972-12"><a href="sec-endogenous-sample-selection.html#cb972-12" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb972-13"><a href="sec-endogenous-sample-selection.html#cb972-13" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb972-14"><a href="sec-endogenous-sample-selection.html#cb972-14" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 16 iterations</span></span>
<span id="cb972-15"><a href="sec-endogenous-sample-selection.html#cb972-15" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb972-16"><a href="sec-endogenous-sample-selection.html#cb972-16" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1879.552 </span></span>
<span id="cb972-17"><a href="sec-endogenous-sample-selection.html#cb972-17" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 615 selection 1 (FALSE) and 385 selection 2 (TRUE)</span></span>
<span id="cb972-18"><a href="sec-endogenous-sample-selection.html#cb972-18" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb972-19"><a href="sec-endogenous-sample-selection.html#cb972-19" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb972-20"><a href="sec-endogenous-sample-selection.html#cb972-20" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb972-21"><a href="sec-endogenous-sample-selection.html#cb972-21" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.33425    0.04280   -7.81 1.46e-14 ***</span></span>
<span id="cb972-22"><a href="sec-endogenous-sample-selection.html#cb972-22" tabindex="-1"></a><span class="co">#&gt; xs           0.94762    0.07763   12.21  &lt; 2e-16 ***</span></span>
<span id="cb972-23"><a href="sec-endogenous-sample-selection.html#cb972-23" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb972-24"><a href="sec-endogenous-sample-selection.html#cb972-24" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb972-25"><a href="sec-endogenous-sample-selection.html#cb972-25" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.49592    0.06800  -7.293 6.19e-13 ***</span></span>
<span id="cb972-26"><a href="sec-endogenous-sample-selection.html#cb972-26" tabindex="-1"></a><span class="co">#&gt; xs           0.84530    0.06789  12.450  &lt; 2e-16 ***</span></span>
<span id="cb972-27"><a href="sec-endogenous-sample-selection.html#cb972-27" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb972-28"><a href="sec-endogenous-sample-selection.html#cb972-28" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb972-29"><a href="sec-endogenous-sample-selection.html#cb972-29" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.3861     0.4967   0.777   0.4371  </span></span>
<span id="cb972-30"><a href="sec-endogenous-sample-selection.html#cb972-30" tabindex="-1"></a><span class="co">#&gt; xs            0.6254     0.3322   1.882   0.0601 .</span></span>
<span id="cb972-31"><a href="sec-endogenous-sample-selection.html#cb972-31" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb972-32"><a href="sec-endogenous-sample-selection.html#cb972-32" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb972-33"><a href="sec-endogenous-sample-selection.html#cb972-33" tabindex="-1"></a><span class="co">#&gt; sigma1  0.61693    0.02054  30.029   &lt;2e-16 ***</span></span>
<span id="cb972-34"><a href="sec-endogenous-sample-selection.html#cb972-34" tabindex="-1"></a><span class="co">#&gt; sigma2  1.59059    0.05745  27.687   &lt;2e-16 ***</span></span>
<span id="cb972-35"><a href="sec-endogenous-sample-selection.html#cb972-35" tabindex="-1"></a><span class="co">#&gt; rho1    0.19981    0.15863   1.260    0.208    </span></span>
<span id="cb972-36"><a href="sec-endogenous-sample-selection.html#cb972-36" tabindex="-1"></a><span class="co">#&gt; rho2   -0.01259    0.29339  -0.043    0.966    </span></span>
<span id="cb972-37"><a href="sec-endogenous-sample-selection.html#cb972-37" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb972-38"><a href="sec-endogenous-sample-selection.html#cb972-38" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb972-39"><a href="sec-endogenous-sample-selection.html#cb972-39" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>This model may fail to converge or produce biased estimates, especially for the intercepts. Even if it does converge, the reliability of the inference is questionable due to weak identification from using the same regressor across all equations.</p>
<p><strong>Notes on Estimation and Convergence</strong></p>
<p>The log-likelihood function of switching regression models is not globally concave, so the estimation process may:</p>
<ul>
<li><p>Fail to converge</p></li>
<li><p>Converge to a local maximum</p></li>
</ul>
<p>Practical Tips:</p>
<ul>
<li><p>Try different starting values or random seeds</p></li>
<li><p>Use alternative maximization algorithms (e.g., <code>optim</code> control)</p></li>
<li><p>Consider rescaling variables or centering predictors</p></li>
<li><p>Refer to <a href="non-linear-regression.html#non-linear-regression">Non-Linear Regression</a> for advanced diagnostics</p></li>
</ul>
<p>Model Comparison Summary</p>
<table>
<colgroup>
<col width="32%" />
<col width="24%" />
<col width="13%" />
<col width="18%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th>Scenario</th>
<th>Exclusion Restriction</th>
<th>Convergence</th>
<th>Bias</th>
<th>Variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Well-specified with exclusion</td>
<td>Yes</td>
<td>Likely</td>
<td>No</td>
<td>Low</td>
</tr>
<tr class="even">
<td>Misspecified distribution</td>
<td>Yes</td>
<td>Risky</td>
<td>Yes (intercepts)</td>
<td>Moderate</td>
</tr>
<tr class="odd">
<td>No exclusion restriction</td>
<td>No</td>
<td>Often fails</td>
<td>Yes</td>
<td>High</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="sec-pattern-mixture-models" class="section level3 hasAnchor" number="36.2.6">
<h3><span class="header-section-number">36.2.6</span> Pattern-Mixture Models<a href="sec-endogenous-sample-selection.html#sec-pattern-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the context of endogenous sample selection, one of the central challenges is modeling the joint distribution of the outcome and the selection mechanism when data are <a href="theoretical-foundations-of-missing-data.html#missing-not-at-random-mnar">Missing Not At Random (MNAR)</a>. In this framework, the probability that an outcome is observed may depend on unobserved values of that outcome, making the missingness mechanism <strong>nonignorable</strong>.</p>
<p>Previously, we discussed the <strong>selection model</strong> approach (e.g., Heckman’s Tobit-2 model), which factorizes the joint distribution as:</p>
<p><span class="math display">\[
\mathbb{P}(Y, R) = \mathbb{P}(Y) \cdot \mathbb{P}(R \mid Y),
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y\)</span> is the outcome of interest,</p></li>
<li><p><span class="math inline">\(R\)</span> is the response indicator (with <span class="math inline">\(R = 1\)</span> if <span class="math inline">\(Y\)</span> is observed, <span class="math inline">\(R = 0\)</span> otherwise).</p></li>
</ul>
<p>This approach models the selection process explicitly via <span class="math inline">\(\mathbb{P}(R \mid Y)\)</span>, often using a parametric model such as the probit.</p>
<p>However, the <strong>pattern-mixture model (PMM)</strong> offers an alternative and equally valid factorization:</p>
<p><span class="math display">\[
\mathbb{P}(Y, R) = \mathbb{P}(Y \mid R) \cdot \mathbb{P}(R),
\]</span></p>
<p>which decomposes the joint distribution by conditioning on the response pattern. This approach is particularly advantageous when the selection mechanism is complex, or when interest lies in modeling how the outcome distribution varies across response strata.</p>
<hr />
<div id="definition-of-the-pattern-mixture-model" class="section level4 hasAnchor" number="36.2.6.1">
<h4><span class="header-section-number">36.2.6.1</span> Definition of the Pattern-Mixture Model<a href="sec-endogenous-sample-selection.html#definition-of-the-pattern-mixture-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\((Y_i, R_i)\)</span> for <span class="math inline">\(i = 1, \dots, n\)</span> denote the observed data, where:</p>
<ul>
<li><span class="math inline">\(Y_i \in \mathbb{R}^p\)</span> is the multivariate outcome of interest,</li>
<li><span class="math inline">\(R_i \in \{0,1\}^p\)</span> is a missingness pattern indicator vector, where <span class="math inline">\(R_{ij} = 1\)</span> indicates that <span class="math inline">\(Y_{ij}\)</span> is observed.</li>
</ul>
<p>Define <span class="math inline">\(\mathcal{R}\)</span> as the finite set of all possible response patterns. For each pattern <span class="math inline">\(r \in \mathcal{R}\)</span>, partition the outcome vector <span class="math inline">\(Y\)</span> into:</p>
<ul>
<li><span class="math inline">\(Y_{(r)}\)</span>: observed components of <span class="math inline">\(Y\)</span> under pattern <span class="math inline">\(r\)</span>,</li>
<li><span class="math inline">\(Y_{(\bar{r})}\)</span>: missing components of <span class="math inline">\(Y\)</span> under pattern <span class="math inline">\(r\)</span>.</li>
</ul>
<p>The joint distribution can then be factorized according to the pattern-mixture model as:</p>
<p><span class="math display">\[
f(Y, R) = f(Y \mid R = r) \cdot \mathbb{P}(R = r), \quad r \in \mathcal{R}.
\]</span></p>
<p>The marginal distribution of <span class="math inline">\(Y\)</span> is obtained by summing over all response patterns:</p>
<p><span class="math display">\[
f(Y) = \sum_{r \in \mathcal{R}} f(Y \mid R = r) \cdot \mathbb{P}(R = r).
\]</span></p>
<p>In the simplest case of binary response patterns (complete responders <span class="math inline">\(R=1\)</span> and complete nonresponders <span class="math inline">\(R=0\)</span>), this reduces to:</p>
<p><span class="math display">\[
\mathbb{P}(Y) = \mathbb{P}(Y \mid R = 1) \cdot \mathbb{P}(R = 1) + \mathbb{P}(Y \mid R = 0) \cdot \mathbb{P}(R = 0).
\]</span></p>
<p>Thus, the overall distribution of <span class="math inline">\(Y\)</span> is explicitly treated as a <strong>mixture</strong> of distributions for responders and nonresponders. While <span class="math inline">\(\mathbb{P}(Y \mid R = 1)\)</span> can be directly estimated from observed data, <span class="math inline">\(\mathbb{P}(Y \mid R = 0)\)</span> cannot be identified from data alone, necessitating additional assumptions or sensitivity parameters for its estimation.</p>
<p>Common approaches for addressing non-identifiability involve defining plausible deviations from <span class="math inline">\(\mathbb{P}(Y \mid R = 1)\)</span> using specific sensitivity parameters such as:</p>
<ul>
<li><strong>Shift Bias</strong>: Adjusting imputed values by a constant <span class="math inline">\(\delta\)</span> to reflect systematic differences in nonresponders.</li>
<li><strong>Scale Bias</strong>: Scaling imputed values to account for differing variability.</li>
<li><strong>Shape Bias</strong>: Reweighting imputations, for example, using methods like Selection-Indicator Reweighting (SIR), to capture distributional shape differences.</li>
</ul>
<p>In this discussion, primary focus is placed on the shift parameter <span class="math inline">\(\delta\)</span>, hypothesizing that nonresponse shifts the mean of <span class="math inline">\(Y\)</span> by <span class="math inline">\(\delta\)</span> units.</p>
<p>In practice, since only observed components <span class="math inline">\(Y_{(r)}\)</span> are available for individuals with missing data, modeling the full conditional distribution <span class="math inline">\(f(Y \mid R = r)\)</span> requires extrapolating from observed to unobserved components.</p>
<hr />
</div>
<div id="modeling-strategy-and-identifiability" class="section level4 hasAnchor" number="36.2.6.2">
<h4><span class="header-section-number">36.2.6.2</span> Modeling Strategy and Identifiability<a href="sec-endogenous-sample-selection.html#modeling-strategy-and-identifiability" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose the full-data conditional distribution is parameterized by pattern-specific parameters <span class="math inline">\(\theta_r\)</span> for each response pattern <span class="math inline">\(r \in \mathcal{R}\)</span>:</p>
<p><span class="math display">\[
f(Y \mid R = r; \theta_r), \quad \text{with } \theta = \{\theta_r : r \in \mathcal{R}\}.
\]</span></p>
<p>Then, the marginal distribution of <span class="math inline">\(Y\)</span> can be expressed as:</p>
<p><span class="math display">\[
f(Y; \theta, \psi) = \sum_{r \in \mathcal{R}} f(Y \mid R = r; \theta_r) \cdot \mathbb{P}(R = r; \psi),
\]</span></p>
<p>where <span class="math inline">\(\psi\)</span> parameterizes the distribution of response patterns.</p>
<p>Important points about identifiability include:</p>
<ul>
<li>The model is inherently non-identifiable without explicit assumptions regarding the distribution of missing components <span class="math inline">\(Y_{(\bar{r})}\)</span>.</li>
<li>Estimating <span class="math inline">\(f(Y_{(\bar{r})} \mid Y_{(r)}, R = r)\)</span> requires external information, expert knowledge, or assumptions encapsulated in sensitivity parameters.</li>
</ul>
<p>The conditional density for each response pattern can be further decomposed as:</p>
<p><span class="math display">\[
f(Y \mid R = r) = f(Y_{(r)} \mid R = r) \cdot f(Y_{(\bar{r})} \mid Y_{(r)}, R = r).
\]</span></p>
<ul>
<li>The first term <span class="math inline">\(f(Y_{(r)} \mid R = r)\)</span> is estimable directly from observed data.</li>
<li>The second term <span class="math inline">\(f(Y_{(\bar{r})} \mid Y_{(r)}, R = r)\)</span> cannot be identified from observed data alone and must rely on assumptions or additional sensitivity analysis.</li>
</ul>
<hr />
</div>
<div id="location-shift-models" class="section level4 hasAnchor" number="36.2.6.3">
<h4><span class="header-section-number">36.2.6.3</span> Location Shift Models<a href="sec-endogenous-sample-selection.html#location-shift-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A widely used strategy in PMMs is to introduce a <strong>location shift</strong> for the unobserved outcomes. Specifically, assume that:</p>
<p><span class="math display">\[
Y_{(\bar{r})} \mid Y_{(r)}, R = r \sim \mathcal{L}(Y_{(\bar{r})} \mid Y_{(r)}, R = r = r^*) + \delta_r,
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(r^*\)</span> denotes a fully observed (reference) pattern (e.g., <span class="math inline">\(R = 1^p\)</span>),</p></li>
<li><p><span class="math inline">\(\delta_r\)</span> is a vector of <strong>sensitivity parameters</strong> that quantify the mean shift for missing outcomes under pattern <span class="math inline">\(r\)</span>.</p></li>
</ul>
<p>More formally, for each <span class="math inline">\(r \in \mathcal{R}\)</span> and unobserved component <span class="math inline">\(j \in \bar{r}\)</span>, we specify:</p>
<p><span class="math display">\[
\mathbb{E}[Y_j \mid Y_{(r)}, R = r] = \mathbb{E}[Y_j \mid Y_{(r)}, R = r^*] + \delta_{rj}.
\]</span></p>
<p>Under this framework:</p>
<ul>
<li>Setting <span class="math inline">\(\delta_r = 0\)</span> corresponds to the MAR assumption (i.e., ignorability).</li>
<li>Nonzero <span class="math inline">\(\delta_r\)</span> introduces controlled deviations from MAR and enables sensitivity analysis.</li>
</ul>
<hr />
</div>
<div id="sensitivity-analysis-in-pattern-mixture-models" class="section level4 hasAnchor" number="36.2.6.4">
<h4><span class="header-section-number">36.2.6.4</span> Sensitivity Analysis in Pattern-Mixture Models<a href="sec-endogenous-sample-selection.html#sensitivity-analysis-in-pattern-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To evaluate the robustness of inferences to the missing data mechanism, we perform sensitivity analysis by varying <span class="math inline">\(\delta_r\)</span> over plausible ranges.</p>
<p><strong>Bias in Estimation</strong></p>
<p>Let <span class="math inline">\(\mu = \mathbb{E}[Y]\)</span> be the target estimand. Under the pattern-mixture decomposition:</p>
<p><span class="math display">\[
\mu = \sum_{r \in \mathcal{R}} \mathbb{E}[Y \mid R = r] \cdot \mathbb{P}(R = r),
\]</span></p>
<p>and under the shift model:</p>
<p><span class="math display">\[
\mathbb{E}[Y \mid R = r] = \tilde{\mu}_r + \delta_r^{*},
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\tilde{\mu}_r\)</span> is the mean computed using observed data (e.g., via imputation under MAR),</p></li>
<li><p><span class="math inline">\(\delta_r^{*}\)</span> is a vector with entries equal to the mean shifts <span class="math inline">\(\delta_{rj}\)</span> for missing components and 0 for observed components.</p></li>
</ul>
<p>Therefore, the overall bias induced by nonzero shifts is:</p>
<p><span class="math display">\[
\Delta = \sum_{r \in \mathcal{R}} \delta_r^{*} \cdot \mathbb{P}(R = r).
\]</span></p>
<p>This highlights how the overall expectation depends linearly on the sensitivity parameters and their associated pattern probabilities.</p>
<p>Practical Recommendations</p>
<ul>
<li>Use subject-matter knowledge to specify plausible ranges for <span class="math inline">\(\delta_r\)</span>.</li>
<li>Consider standard increments (e.g., <span class="math inline">\(\pm 0.2\)</span> SD units) or domain-specific metrics (e.g., <span class="math inline">\(\pm 5\)</span> P/E for valuation).</li>
<li>If the dataset is large and the number of missingness patterns is small (e.g., monotone dropout), more detailed pattern-specific modeling is feasible.</li>
</ul>
<hr />
</div>
<div id="generalization-to-multivariate-and-longitudinal-data" class="section level4 hasAnchor" number="36.2.6.5">
<h4><span class="header-section-number">36.2.6.5</span> Generalization to Multivariate and Longitudinal Data<a href="sec-endogenous-sample-selection.html#generalization-to-multivariate-and-longitudinal-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose <span class="math inline">\(Y = (Y_1, \dots, Y_T)\)</span> is a longitudinal outcome. Let <span class="math inline">\(D \in \{1, \dots, T+1\}\)</span> denote the dropout time, where <span class="math inline">\(D = t\)</span> implies observation up to time <span class="math inline">\(t-1\)</span>.</p>
<p>Then the pattern-mixture factorization becomes:</p>
<p><span class="math display">\[
f(Y, D) = f(Y \mid D = t) \cdot \mathbb{P}(D = t), \quad t = 2, \dots, T+1.
\]</span></p>
<p>Assume a parametric model:</p>
<p><span class="math display">\[
Y_j \mid D = t \sim \mathcal{N}(\beta_{0t} + \beta_{1t} t_j, \sigma_t^2), \quad \text{for } j = 1, \dots, T.
\]</span></p>
<p>Then the overall mean trajectory becomes:</p>
<p><span class="math display">\[
\mathbb{E}[Y_j] = \sum_{t=2}^{T+1} (\beta_{0t} + \beta_{1t} t_j) \cdot \mathbb{P}(D = t).
\]</span></p>
<p>This model allows for dropout-pattern-specific trajectories and can flexibly account for deviations in the distributional shape due to dropout.</p>
<hr />
</div>
<div id="comparison-with-selection-models" class="section level4 hasAnchor" number="36.2.6.6">
<h4><span class="header-section-number">36.2.6.6</span> Comparison with Selection Models<a href="sec-endogenous-sample-selection.html#comparison-with-selection-models" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<colgroup>
<col width="26%" />
<col width="36%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Selection Model</th>
<th>Pattern-Mixture Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Factorization</td>
<td><span class="math inline">\(\mathbb{P}(Y) \cdot \mathbb{P}(R \mid Y)\)</span></td>
<td><span class="math inline">\(\mathbb{P}(Y \mid R) \cdot \mathbb{P}(R)\)</span></td>
</tr>
<tr class="even">
<td>Target of modeling</td>
<td>Missingness process <span class="math inline">\(\mathbb{P}(R \mid Y)\)</span></td>
<td>Distribution of <span class="math inline">\(Y\)</span> under <span class="math inline">\(R\)</span></td>
</tr>
<tr class="odd">
<td>Assumption for identifiability</td>
<td>MAR (often Probit)</td>
<td>Extrapolation (e.g., shift <span class="math inline">\(\delta\)</span>)</td>
</tr>
<tr class="even">
<td>Modeling burden</td>
<td>On <span class="math inline">\(\mathbb{P}(R \mid Y)\)</span></td>
<td>On <span class="math inline">\(f(Y \mid R)\)</span></td>
</tr>
<tr class="odd">
<td>Sensitivity analysis</td>
<td>Less interpretable</td>
<td>Easily parameterized (via <span class="math inline">\(\delta\)</span>)</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="sec-endogenous-sample-selection.html#cb973-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb973-2"><a href="sec-endogenous-sample-selection.html#cb973-2" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb973-3"><a href="sec-endogenous-sample-selection.html#cb973-3" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb973-4"><a href="sec-endogenous-sample-selection.html#cb973-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb973-5"><a href="sec-endogenous-sample-selection.html#cb973-5" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb973-6"><a href="sec-endogenous-sample-selection.html#cb973-6" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><strong>Simulate Longitudinal Dropout Data</strong></li>
</ol>
<p>We simulate a 3-time-point longitudinal outcome, where dropout depends on unobserved future outcomes, i.e., MNAR.</p>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="sec-endogenous-sample-selection.html#cb974-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb974-2"><a href="sec-endogenous-sample-selection.html#cb974-2" tabindex="-1"></a></span>
<span id="cb974-3"><a href="sec-endogenous-sample-selection.html#cb974-3" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb974-4"><a href="sec-endogenous-sample-selection.html#cb974-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb974-5"><a href="sec-endogenous-sample-selection.html#cb974-5" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb974-6"><a href="sec-endogenous-sample-selection.html#cb974-6" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">5</span>)  <span class="co"># intercept and slope</span></span>
<span id="cb974-7"><a href="sec-endogenous-sample-selection.html#cb974-7" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb974-8"><a href="sec-endogenous-sample-selection.html#cb974-8" tabindex="-1"></a>dropout_bias <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span>  <span class="co"># MNAR: lower future Y -&gt; more dropout</span></span>
<span id="cb974-9"><a href="sec-endogenous-sample-selection.html#cb974-9" tabindex="-1"></a></span>
<span id="cb974-10"><a href="sec-endogenous-sample-selection.html#cb974-10" tabindex="-1"></a><span class="co"># Simulate full data (Y1, Y2, Y3)</span></span>
<span id="cb974-11"><a href="sec-endogenous-sample-selection.html#cb974-11" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb974-12"><a href="sec-endogenous-sample-selection.html#cb974-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb974-13"><a href="sec-endogenous-sample-selection.html#cb974-13" tabindex="-1"></a>    Y[, i] <span class="ot">&lt;-</span> beta[<span class="dv">1</span>] <span class="sc">+</span> beta[<span class="dv">2</span>] <span class="sc">*</span> time[i] <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb974-14"><a href="sec-endogenous-sample-selection.html#cb974-14" tabindex="-1"></a>}</span>
<span id="cb974-15"><a href="sec-endogenous-sample-selection.html#cb974-15" tabindex="-1"></a></span>
<span id="cb974-16"><a href="sec-endogenous-sample-selection.html#cb974-16" tabindex="-1"></a><span class="co"># Dropout mechanism: higher chance to drop if Y3 is low</span></span>
<span id="cb974-17"><a href="sec-endogenous-sample-selection.html#cb974-17" tabindex="-1"></a>prob_dropout <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="sc">-</span><span class="fl">0.5</span> <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> (dropout_bias <span class="sc">-</span> Y[, <span class="dv">3</span>]))</span>
<span id="cb974-18"><a href="sec-endogenous-sample-selection.html#cb974-18" tabindex="-1"></a>drop <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, prob_dropout)</span>
<span id="cb974-19"><a href="sec-endogenous-sample-selection.html#cb974-19" tabindex="-1"></a></span>
<span id="cb974-20"><a href="sec-endogenous-sample-selection.html#cb974-20" tabindex="-1"></a><span class="co"># Define dropout time: if drop == 1, then Y3 is missing</span></span>
<span id="cb974-21"><a href="sec-endogenous-sample-selection.html#cb974-21" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb974-22"><a href="sec-endogenous-sample-selection.html#cb974-22" tabindex="-1"></a>R[drop <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb974-23"><a href="sec-endogenous-sample-selection.html#cb974-23" tabindex="-1"></a></span>
<span id="cb974-24"><a href="sec-endogenous-sample-selection.html#cb974-24" tabindex="-1"></a><span class="co"># Observed data</span></span>
<span id="cb974-25"><a href="sec-endogenous-sample-selection.html#cb974-25" tabindex="-1"></a>Y_obs <span class="ot">&lt;-</span> Y</span>
<span id="cb974-26"><a href="sec-endogenous-sample-selection.html#cb974-26" tabindex="-1"></a>Y_obs[R <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb974-27"><a href="sec-endogenous-sample-selection.html#cb974-27" tabindex="-1"></a></span>
<span id="cb974-28"><a href="sec-endogenous-sample-selection.html#cb974-28" tabindex="-1"></a><span class="co"># Combine into a data frame</span></span>
<span id="cb974-29"><a href="sec-endogenous-sample-selection.html#cb974-29" tabindex="-1"></a>df <span class="ot">&lt;-</span></span>
<span id="cb974-30"><a href="sec-endogenous-sample-selection.html#cb974-30" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb974-31"><a href="sec-endogenous-sample-selection.html#cb974-31" tabindex="-1"></a>        <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb974-32"><a href="sec-endogenous-sample-selection.html#cb974-32" tabindex="-1"></a>        <span class="at">Y1 =</span> Y_obs[, <span class="dv">1</span>],</span>
<span id="cb974-33"><a href="sec-endogenous-sample-selection.html#cb974-33" tabindex="-1"></a>        <span class="at">Y2 =</span> Y_obs[, <span class="dv">2</span>],</span>
<span id="cb974-34"><a href="sec-endogenous-sample-selection.html#cb974-34" tabindex="-1"></a>        <span class="at">Y3 =</span> Y_obs[, <span class="dv">3</span>],</span>
<span id="cb974-35"><a href="sec-endogenous-sample-selection.html#cb974-35" tabindex="-1"></a>        <span class="at">R3 =</span> R[, <span class="dv">3</span>]</span>
<span id="cb974-36"><a href="sec-endogenous-sample-selection.html#cb974-36" tabindex="-1"></a>    )</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Fit Pattern-Mixture Model with Delta Adjustment</strong></li>
</ol>
<p>We model <span class="math inline">\(Y_3\)</span> as a function of <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>, using the observed cases (complete cases), and create multiple imputed datasets under various shift parameters <span class="math inline">\(\delta\)</span> to represent different MNAR scenarios.</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="sec-endogenous-sample-selection.html#cb975-1" tabindex="-1"></a><span class="co"># Base linear model for Y3 ~ Y1 + Y2</span></span>
<span id="cb975-2"><a href="sec-endogenous-sample-selection.html#cb975-2" tabindex="-1"></a>model_cc <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y3 <span class="sc">~</span> Y1 <span class="sc">+</span> Y2, <span class="at">data =</span> df, <span class="at">subset =</span> R3 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb975-3"><a href="sec-endogenous-sample-selection.html#cb975-3" tabindex="-1"></a></span>
<span id="cb975-4"><a href="sec-endogenous-sample-selection.html#cb975-4" tabindex="-1"></a><span class="co"># Predict for missing Y3s</span></span>
<span id="cb975-5"><a href="sec-endogenous-sample-selection.html#cb975-5" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_cc, <span class="at">newdata =</span> df)</span>
<span id="cb975-6"><a href="sec-endogenous-sample-selection.html#cb975-6" tabindex="-1"></a></span>
<span id="cb975-7"><a href="sec-endogenous-sample-selection.html#cb975-7" tabindex="-1"></a><span class="co"># Sensitivity values for delta</span></span>
<span id="cb975-8"><a href="sec-endogenous-sample-selection.html#cb975-8" tabindex="-1"></a>delta_seq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">2.5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="fl">7.5</span>, <span class="sc">-</span><span class="dv">10</span>)  <span class="co"># in units of Y3</span></span>
<span id="cb975-9"><a href="sec-endogenous-sample-selection.html#cb975-9" tabindex="-1"></a></span>
<span id="cb975-10"><a href="sec-endogenous-sample-selection.html#cb975-10" tabindex="-1"></a><span class="co"># Perform delta adjustment</span></span>
<span id="cb975-11"><a href="sec-endogenous-sample-selection.html#cb975-11" tabindex="-1"></a>imputed_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(delta_seq, <span class="cf">function</span>(delta) {</span>
<span id="cb975-12"><a href="sec-endogenous-sample-selection.html#cb975-12" tabindex="-1"></a>  df_new <span class="ot">&lt;-</span> df</span>
<span id="cb975-13"><a href="sec-endogenous-sample-selection.html#cb975-13" tabindex="-1"></a>  df_new<span class="sc">$</span>Y3_imp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df<span class="sc">$</span>Y3),</span>
<span id="cb975-14"><a href="sec-endogenous-sample-selection.html#cb975-14" tabindex="-1"></a>                          preds <span class="sc">+</span> delta,</span>
<span id="cb975-15"><a href="sec-endogenous-sample-selection.html#cb975-15" tabindex="-1"></a>                          df<span class="sc">$</span>Y3)</span>
<span id="cb975-16"><a href="sec-endogenous-sample-selection.html#cb975-16" tabindex="-1"></a>  df_new<span class="sc">$</span>delta <span class="ot">&lt;-</span> delta</span>
<span id="cb975-17"><a href="sec-endogenous-sample-selection.html#cb975-17" tabindex="-1"></a>  <span class="fu">return</span>(df_new)</span>
<span id="cb975-18"><a href="sec-endogenous-sample-selection.html#cb975-18" tabindex="-1"></a>})</span>
<span id="cb975-19"><a href="sec-endogenous-sample-selection.html#cb975-19" tabindex="-1"></a></span>
<span id="cb975-20"><a href="sec-endogenous-sample-selection.html#cb975-20" tabindex="-1"></a><span class="co"># Stack all results</span></span>
<span id="cb975-21"><a href="sec-endogenous-sample-selection.html#cb975-21" tabindex="-1"></a>df_imp_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(imputed_dfs)</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Estimate Full-Data Mean and Trajectory under Each Delta</strong></li>
</ol>
<p>We now estimate the mean of <span class="math inline">\(Y_3\)</span> and the full outcome trajectory across delta values.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="sec-endogenous-sample-selection.html#cb976-1" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> df_imp_all <span class="sc">%&gt;%</span></span>
<span id="cb976-2"><a href="sec-endogenous-sample-selection.html#cb976-2" tabindex="-1"></a>    <span class="fu">group_by</span>(delta) <span class="sc">%&gt;%</span></span>
<span id="cb976-3"><a href="sec-endogenous-sample-selection.html#cb976-3" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb976-4"><a href="sec-endogenous-sample-selection.html#cb976-4" tabindex="-1"></a>        <span class="at">mu_Y1 =</span> <span class="fu">mean</span>(Y1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb976-5"><a href="sec-endogenous-sample-selection.html#cb976-5" tabindex="-1"></a>        <span class="at">mu_Y2 =</span> <span class="fu">mean</span>(Y2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb976-6"><a href="sec-endogenous-sample-selection.html#cb976-6" tabindex="-1"></a>        <span class="at">mu_Y3 =</span> <span class="fu">mean</span>(Y3_imp),</span>
<span id="cb976-7"><a href="sec-endogenous-sample-selection.html#cb976-7" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb976-8"><a href="sec-endogenous-sample-selection.html#cb976-8" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb976-9"><a href="sec-endogenous-sample-selection.html#cb976-9" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">&quot;mu&quot;</span>),</span>
<span id="cb976-10"><a href="sec-endogenous-sample-selection.html#cb976-10" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb976-11"><a href="sec-endogenous-sample-selection.html#cb976-11" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;Mean&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb976-12"><a href="sec-endogenous-sample-selection.html#cb976-12" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">factor</span>(</span>
<span id="cb976-13"><a href="sec-endogenous-sample-selection.html#cb976-13" tabindex="-1"></a>        Time,</span>
<span id="cb976-14"><a href="sec-endogenous-sample-selection.html#cb976-14" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;mu_Y1&quot;</span>, <span class="st">&quot;mu_Y2&quot;</span>, <span class="st">&quot;mu_Y3&quot;</span>),</span>
<span id="cb976-15"><a href="sec-endogenous-sample-selection.html#cb976-15" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Time 1&quot;</span>, <span class="st">&quot;Time 2&quot;</span>, <span class="st">&quot;Time 3&quot;</span>)</span>
<span id="cb976-16"><a href="sec-endogenous-sample-selection.html#cb976-16" tabindex="-1"></a>    ))</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Visualization: Sensitivity Analysis</strong></li>
</ol>
<p>We visualize how the mean trajectory changes across different sensitivity parameters <span class="math inline">\(\delta\)</span>.</p>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="sec-endogenous-sample-selection.html#cb977-1" tabindex="-1"></a><span class="fu">ggplot</span>(estimates, <span class="fu">aes</span>(</span>
<span id="cb977-2"><a href="sec-endogenous-sample-selection.html#cb977-2" tabindex="-1"></a>    <span class="at">x =</span> Time,</span>
<span id="cb977-3"><a href="sec-endogenous-sample-selection.html#cb977-3" tabindex="-1"></a>    <span class="at">y =</span> Mean,</span>
<span id="cb977-4"><a href="sec-endogenous-sample-selection.html#cb977-4" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">as.factor</span>(delta),</span>
<span id="cb977-5"><a href="sec-endogenous-sample-selection.html#cb977-5" tabindex="-1"></a>    <span class="at">group =</span> delta</span>
<span id="cb977-6"><a href="sec-endogenous-sample-selection.html#cb977-6" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb977-7"><a href="sec-endogenous-sample-selection.html#cb977-7" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb977-8"><a href="sec-endogenous-sample-selection.html#cb977-8" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb977-9"><a href="sec-endogenous-sample-selection.html#cb977-9" tabindex="-1"></a>    <span class="fu">scale_color_viridis_d</span>(<span class="at">name =</span> <span class="fu">expression</span>(delta)) <span class="sc">+</span></span>
<span id="cb977-10"><a href="sec-endogenous-sample-selection.html#cb977-10" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb977-11"><a href="sec-endogenous-sample-selection.html#cb977-11" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Pattern-Mixture Model Sensitivity Analysis&quot;</span>,</span>
<span id="cb977-12"><a href="sec-endogenous-sample-selection.html#cb977-12" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Mean of Y_t&quot;</span>,</span>
<span id="cb977-13"><a href="sec-endogenous-sample-selection.html#cb977-13" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Time&quot;</span></span>
<span id="cb977-14"><a href="sec-endogenous-sample-selection.html#cb977-14" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb977-15"><a href="sec-endogenous-sample-selection.html#cb977-15" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="36-endogeneity_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Sensitivity Table for Reporting</strong></li>
</ol>
<p>This table quantifies the change in <span class="math inline">\(\mu_{Y3}\)</span> across sensitivity scenarios.</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="sec-endogenous-sample-selection.html#cb978-1" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df_imp_all <span class="sc">%&gt;%</span></span>
<span id="cb978-2"><a href="sec-endogenous-sample-selection.html#cb978-2" tabindex="-1"></a>    <span class="fu">group_by</span>(delta) <span class="sc">%&gt;%</span></span>
<span id="cb978-3"><a href="sec-endogenous-sample-selection.html#cb978-3" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb978-4"><a href="sec-endogenous-sample-selection.html#cb978-4" tabindex="-1"></a>        <span class="at">Mean_Y3 =</span> <span class="fu">mean</span>(Y3_imp),</span>
<span id="cb978-5"><a href="sec-endogenous-sample-selection.html#cb978-5" tabindex="-1"></a>        <span class="at">SD_Y3 =</span> <span class="fu">sd</span>(Y3_imp),</span>
<span id="cb978-6"><a href="sec-endogenous-sample-selection.html#cb978-6" tabindex="-1"></a>        <span class="at">N_Missing =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(Y3)),</span>
<span id="cb978-7"><a href="sec-endogenous-sample-selection.html#cb978-7" tabindex="-1"></a>        <span class="at">N_Observed =</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(Y3))</span>
<span id="cb978-8"><a href="sec-endogenous-sample-selection.html#cb978-8" tabindex="-1"></a>    )</span>
<span id="cb978-9"><a href="sec-endogenous-sample-selection.html#cb978-9" tabindex="-1"></a></span>
<span id="cb978-10"><a href="sec-endogenous-sample-selection.html#cb978-10" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(df_summary, <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb978-11"><a href="sec-endogenous-sample-selection.html#cb978-11" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Sensitivity of Estimated Mean of Y3 to Delta Adjustments&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-22">Table 36.1: </span>Sensitivity of Estimated Mean of Y3 to Delta Adjustments</caption>
<thead>
<tr class="header">
<th align="right">delta</th>
<th align="right">Mean_Y3</th>
<th align="right">SD_Y3</th>
<th align="right">N_Missing</th>
<th align="right">N_Observed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-10.0</td>
<td align="right">110.6</td>
<td align="right">4.75</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="right">-7.5</td>
<td align="right">110.6</td>
<td align="right">4.75</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="right">-5.0</td>
<td align="right">110.6</td>
<td align="right">4.75</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="right">-2.5</td>
<td align="right">110.6</td>
<td align="right">4.75</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">110.6</td>
<td align="right">4.75</td>
<td align="right">0</td>
<td align="right">100</td>
</tr>
</tbody>
</table>
<ol start="6" style="list-style-type: decimal">
<li><strong>Interpretation and Discussion</strong></li>
</ol>
<ul>
<li><p>The estimated mean of <span class="math inline">\(Y_3\)</span> decreases linearly with increasingly negative <span class="math inline">\(\delta\)</span>, as expected.</p></li>
<li><p>This illustrates the <strong>non-identifiability</strong> of the distribution of missing data without unverifiable assumptions.</p></li>
<li><p>The results provide a <strong>tipping point analysis</strong>: at what <span class="math inline">\(\delta\)</span> does inference about the mean (or treatment effect, in a causal study) substantially change?</p></li>
</ul>

</div>
</div>
</div>
<!-- </div> -->
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-amemiya1984tobit" class="csl-entry">
———. 1984. <span>“Tobit Models: A Survey.”</span> <em>Journal of Econometrics</em> 24 (1-2): 3–61.
</div>
<div id="ref-card1999causal" class="csl-entry">
Card, David. 1999. <span>“The Causal Effect of Education on Earnings.”</span> <em>Handbook of Labor Economics</em> 3: 1801–63.
</div>
<div id="ref-card2001estimating" class="csl-entry">
———. 2001. <span>“Estimating the Return to Schooling: Progress on Some Persistent Econometric Problems.”</span> <em>Econometrica</em> 69 (5): 1127–60.
</div>
<div id="ref-heckman1974shadow" class="csl-entry">
Heckman, James. 1974. <span>“Shadow Prices, Market Wages, and Labor Supply.”</span> <em>Econometrica: Journal of the Econometric Society</em>, 679–94.
</div>
<div id="ref-heckman1976common" class="csl-entry">
Heckman, James J. 1976b. <span>“The Common Structure of Statistical Models of Truncation, Sample Selection and Limited Dependent Variables and a Simple Estimator for Such Models.”</span> In <em>Annals of Economic and Social Measurement, Volume 5, Number 4</em>, 475–92. NBER.
</div>
<div id="ref-heckman1979sample" class="csl-entry">
———. 1979. <span>“Sample Selection Bias as a Specification Error.”</span> <em>Econometrica: Journal of the Econometric Society</em>, 153–61.
</div>
<div id="ref-heckman2004using" class="csl-entry">
Heckman, James, and Salvador Navarro-Lozano. 2004. <span>“Using Matching, Instrumental Variables, and Control Functions to Estimate Economic Choice Models.”</span> <em>Review of Economics and Statistics</em> 86 (1): 30–57.
</div>
<div id="ref-lewis1986union" class="csl-entry">
Lewis, H Gregg. 1986. <span>“Union Relative Wage Effects.”</span> <em>Handbook of Labor Economics</em> 2: 1139–81.
</div>
<div id="ref-mroz1984sensitivity" class="csl-entry">
Mroz, Thomas Alvin. 1984. <em>The Sensitivity of an Empirical Model of Married Women’s Hours of Work to Economic and Statistical Assumptions</em>. Stanford University.
</div>
<div id="ref-wolfolds2019misaccounting" class="csl-entry">
Wolfolds, Sarah E, and Jordan Siegel. 2019. <span>“Misaccounting for Endogeneity: The Peril of Relying on the Heckman Two-Step Method Without a Valid Instrument.”</span> <em>Strategic Management Journal</em> 40 (3): 432–62.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-endogenous-treatment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-biases.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mikenguyen13/data_analysis/edit/main/36-endogeneity.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mikenguyen13/data_analysis/blob/main/36-endogeneity.Rmd",
    "text": null
  },
  "download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true,
    "sharing": {
      "facebook": true,
      "github": true,
      "twitter": true,
      "linkedin": true
    },
    "info": true,
    "edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
