<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Linear Regression | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="Estimating parameters -&gt; parametric (finite parameters) Estimating functions -&gt; non-parametric Estimator Desirable Properties Unbiased Consistency \(plim\hat{\beta_n}=\beta\) based on the law of...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 5 Linear Regression | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/linear-regression.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="Estimating parameters -&gt; parametric (finite parameters) Estimating functions -&gt; non-parametric Estimator Desirable Properties Unbiased Consistency \(plim\hat{\beta_n}=\beta\) based on the law of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Linear Regression | A Guide on Data Analysis">
<meta name="twitter:description" content="Estimating parameters -&gt; parametric (finite parameters) Estimating functions -&gt; non-parametric Estimator Desirable Properties Unbiased Consistency \(plim\hat{\beta_n}=\beta\) based on the law of...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-stat.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="active" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="model-specification.html"><span class="header-section-number">10</span> Model Specification</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></li>
<li><a class="" href="data.html"><span class="header-section-number">12</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">13</span> Variable Transformation</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">14</span> Hypothesis Testing</a></li>
<li><a class="" href="marginal-effects.html"><span class="header-section-number">15</span> Marginal Effects</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">16</span> Prediction and Estimation</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">17</span> Moderation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">18</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="experimental-design.html"><span class="header-section-number">19</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">20</span> Sampling</a></li>
<li><a class="" href="analysis-of-variance-anova.html"><span class="header-section-number">21</span> Analysis of Variance (ANOVA)</a></li>
<li><a class="" href="multivariate-methods.html"><span class="header-section-number">22</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="quasi-experimental.html"><span class="header-section-number">23</span> Quasi-experimental</a></li>
<li><a class="" href="regression-discontinuity.html"><span class="header-section-number">24</span> Regression Discontinuity</a></li>
<li><a class="" href="difference-in-differences.html"><span class="header-section-number">25</span> Difference-in-differences</a></li>
<li><a class="" href="synthetic-control.html"><span class="header-section-number">26</span> Synthetic Control</a></li>
<li><a class="" href="event-studies.html"><span class="header-section-number">27</span> Event Studies</a></li>
<li><a class="" href="matching-methods.html"><span class="header-section-number">28</span> Matching Methods</a></li>
<li><a class="" href="interrupted-time-series.html"><span class="header-section-number">29</span> Interrupted Time Series</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">30</span> Endogeneity</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">31</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="mediation.html"><span class="header-section-number">32</span> Mediation</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">33</span> Directed Acyclic Graph</a></li>
<li><a class="" href="report.html"><span class="header-section-number">34</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">35</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">36</span> Sensitivity Analysis/ Robustness Check</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="linear-regression" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Linear Regression<a class="anchor" aria-label="anchor" href="#linear-regression"><i class="fas fa-link"></i></a>
</h1>
<div style="text-align:center">
<div class="inline-figure"><img src="images/econometrics.PNG" width="450" height="200"></div>
</div>
<ul>
<li>Estimating parameters -&gt; parametric (finite parameters)</li>
<li>Estimating functions -&gt; non-parametric</li>
</ul>
<p><strong>Estimator Desirable Properties</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Unbiased</strong></p></li>
<li><p><strong>Consistency</strong></p></li>
</ol>
<ul>
<li><span class="math inline">\(plim\hat{\beta_n}=\beta\)</span></li>
<li>based on the law of large numbers, we can derive consistency</li>
<li>More observations means more precise, closer to the true value.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Efficiency</strong></li>
</ol>
<ul>
<li>
<p>Minimum variance in comparison to another estimator.</p>
<ul>
<li>OLS is BLUE (best linear unbiased estimator) means that OLS is the most efficient among the class of linear unbiased estimator <a href="linear-regression.html#gauss-markov-theorem">Gauss-Markov Theorem</a>
</li>
<li>If we have correct distributional assumptions, then the Maximum Likelihood is asymptotically efficient among consistent estimators.</li>
</ul>
</li>
</ul>
<div id="ordinary-least-squares" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Ordinary Least Squares<a class="anchor" aria-label="anchor" href="#ordinary-least-squares"><i class="fas fa-link"></i></a>
</h2>
<p>The most fundamental model in statistics or econometric is a OLS linear regression. OLS = Maximum likelihood when the error term is assumed to be normally distributed.</p>
<p>Regression is still great if the underlying CEF (conditional expectation function) is not linear. Because regression has the following properties:</p>
<ol style="list-style-type: decimal">
<li>For <span class="math inline">\(E[Y_i | X_{1i}, \dots, X_{Ki}] = a + \sum_{k=1}^K b_k X_{ki}\)</span> (i.e., the CEF of <span class="math inline">\(Y_i\)</span> on <span class="math inline">\(X_{1i}, \dots, X_{Ki}\)</span> is linear, then the regression of <span class="math inline">\(Y_i\)</span> on <span class="math inline">\(X_{1i}, \dots, X_{Ki}\)</span> is the CEF</li>
<li>For <span class="math inline">\(E[Y_i | X_{1i} , \dots, X_{Ki}]\)</span> is a nonlinear function of the conditioning variables, the regression of <span class="math inline">\(Y_i\)</span> on <span class="math inline">\(X_{1i}, \dots, X_{Ki}\)</span> will give you the best linear approximation to the nonlinear CEF (i.e., minimize the expected squared deviation between the fitted values from the linear model and the CEF).</li>
</ol>
<div id="simple-regression-basic-model" class="section level3" number="5.1.1">
<h3>
<span class="header-section-number">5.1.1</span> Simple Regression (Basic Model)<a class="anchor" aria-label="anchor" href="#simple-regression-basic-model"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \epsilon_i
\]</span></p>
<ul>
<li>
<span class="math inline">\(Y_i\)</span>: response (dependent) variable at i-th observation</li>
<li>
<span class="math inline">\(\beta_0,\beta_1\)</span>: regression parameters for intercept and slope.</li>
<li>
<span class="math inline">\(X_i\)</span>: known constant (independent or predictor variable) for i-th observation</li>
<li>
<span class="math inline">\(\epsilon_i\)</span>: random error term</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
E(\epsilon_i) &amp;= 0 \\
var(\epsilon_i) &amp;= \sigma^2 \\
cov(\epsilon_i,\epsilon_j) &amp;= 0  \text{ for all } i \neq j
\end{aligned}
\]</span></p>
<p><span class="math inline">\(Y_i\)</span> is random since <span class="math inline">\(\epsilon_i\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
E(Y_i) &amp;= E(\beta_0 + \beta_1 X_i + \epsilon_i) \\
&amp;= E(\beta_0) + E(\beta_1 X_i) + E(\epsilon) \\
&amp;= \beta_0 + \beta_1 X_i
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
var(Y_i) &amp;= var(\beta_0 + \beta_1 X_i + \epsilon_i) \\
&amp;= var(\epsilon_i) \\
&amp;= \sigma^2
\end{aligned}
\]</span></p>
<p>Since <span class="math inline">\(cov(\epsilon_i, \epsilon_j) = 0\)</span> (uncorrelated), the outcome in any one trail has no effect on the outcome of any other. Hence, <span class="math inline">\(Y_i, Y_j\)</span> are uncorrelated as well (conditioned on the <span class="math inline">\(X\)</span>’s)</p>
<p><strong>Note</strong><br><a href="linear-regression.html#ordinary-least-squares">Least Squares</a> does not require a distributional assumption</p>
<p>Relationship between bivariate regression and covariance</p>
<p>Covariance between 2 variables:</p>
<p><span class="math display">\[
C(X_i, Y_i) = E[(X_i - E[X_i])(Y_i - E[Y_i])]
\]</span></p>
<p>Which has the following properties</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(C(X_i, X_i) = \sigma^2_X\)</span></li>
<li>If either <span class="math inline">\(E(X_i) = 0 | E(Y_i) = 0\)</span>, then <span class="math inline">\(Cov(X_i, Y_i) = E[X_i Y_i]\)</span>
</li>
<li>Given <span class="math inline">\(W_i = a + b X_i\)</span> and <span class="math inline">\(Z_i = c + d Y_i\)</span>, then <span class="math inline">\(Cov(W_i, Z_i) = bdC(X_i, Y_i)\)</span>
</li>
</ol>
<p>For the bivariate regression, the slope is</p>
<p><span class="math display">\[
\beta = \frac{Cov(Y_i, X_i)}{Var(X_i)}
\]</span></p>
<p>To extend this to a multivariate case</p>
<p><span class="math display">\[
\beta_k = \frac{C(Y_i, \tilde{X}_{ki})}{Var(\tilde{X}_{ki})}
\]</span></p>
<p>Where <span class="math inline">\(\tilde{X}_{ki}\)</span> is the residual from a regression of <span class="math inline">\(X_{ki}\)</span> on the <span class="math inline">\(K-1\)</span> other covariates included in the model</p>
<p>And intercept</p>
<p><span class="math display">\[
\alpha = E[Y_i] - \beta E(X_i)
\]</span></p>
<div id="estimation" class="section level4" number="5.1.1.1">
<h4>
<span class="header-section-number">5.1.1.1</span> Estimation<a class="anchor" aria-label="anchor" href="#estimation"><i class="fas fa-link"></i></a>
</h4>
<p>Deviation of <span class="math inline">\(Y_i\)</span> from its expected value:</p>
<p><span class="math display">\[
Y_i - E(Y_i) = Y_i - (\beta_0 + \beta_1 X_i)
\]</span></p>
<p>Consider the sum of the square of such deviations:</p>
<p><span class="math display">\[
Q = \sum_{i=1}^{n} (Y_i - \beta_0 -\beta_1 X_i)^2
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
b_1 &amp;= \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^{n}(X_i - \bar{X})^2} \\
b_0 &amp;= \frac{1}{n}(\sum_{i=1}^{n}Y_i - b_1\sum_{i=1}^{n}X_i) = \bar{Y} - b_1 \bar{X}
\end{aligned}
\]</span></p>
</div>
<div id="properties-of-least-least-estimators" class="section level4" number="5.1.1.2">
<h4>
<span class="header-section-number">5.1.1.2</span> Properties of Least Least Estimators<a class="anchor" aria-label="anchor" href="#properties-of-least-least-estimators"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
\begin{aligned}
E(b_1) &amp;= \beta_1 \\
E(b_0) &amp;= E(\bar{Y}) - \bar{X}\beta_1 \\
E(\bar{Y}) &amp;= \beta_0 + \beta_1 \bar{X} \\
E(b_0) &amp;= \beta_0 \\
var(b_1) &amp;= \frac{\sigma^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2} \\
var(b_0) &amp;= \sigma^2 (\frac{1}{n} + \frac{\bar{X}^2}{\sum (X_i - \bar{X})^2})
\end{aligned}
\]</span></p>
<p><span class="math inline">\(var(b_1) \to 0\)</span> as more measurements are taken at more <span class="math inline">\(X_i\)</span> values (unless <span class="math inline">\(X_i\)</span> is at its mean value)<br><span class="math inline">\(var(b_0) \to 0\)</span> as <span class="math inline">\(n\)</span> increases when the <span class="math inline">\(X_i\)</span> values are judiciously selected.</p>
<p><strong>Mean Square Error</strong></p>
<p><span class="math display">\[
MSE = \frac{SSE}{n-2} = \frac{\sum_{i=1}^{n}e_i^2}{n-2} = \frac{\sum(Y_i - \hat{Y_i})^2}{n-2}
\]</span></p>
<p>Unbiased estimator of MSE:</p>
<p><span class="math display">\[
E(MSE) = \sigma^2
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
s^2(b_1) &amp;= \widehat{var(b_1)} = \frac{MSE}{\sum_{i=1}^{n}(X_i - \bar{X})^2} \\
s^2(b_0) &amp;= \widehat{var(b_0)} = MSE(\frac{1}{n} + \frac{\bar{X}^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2})
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
E(s^2(b_1)) &amp;= var(b_1) \\
E(s^2(b_0)) &amp;= var(b_0)
\end{aligned}
\]</span></p>
</div>
<div id="residuals" class="section level4" number="5.1.1.3">
<h4>
<span class="header-section-number">5.1.1.3</span> Residuals<a class="anchor" aria-label="anchor" href="#residuals"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
e_i = Y_i - \hat{Y} = Y_i - (b_0 + b_1 X_i)
\]</span></p>
<ul>
<li>
<span class="math inline">\(e_i\)</span> is an estimate of <span class="math inline">\(\epsilon_i = Y_i - E(Y_i)\)</span>
</li>
<li>
<span class="math inline">\(\epsilon_i\)</span> is always unknown since we don’t know the true <span class="math inline">\(\beta_0, \beta_1\)</span>
</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\sum_{i=1}^{n} e_i &amp;= 0 \\
\sum_{i=1}^{n} X_i e_i &amp;= 0
\end{aligned}
\]</span></p>
<p>Residual properties</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(E[e_i] =0\)</span></li>
<li>
<span class="math inline">\(E[X_i e_i] = 0\)</span> and <span class="math inline">\(E[\hat{Y}_i e_i ] = 0\)</span>
</li>
</ol>
</div>
<div id="inference" class="section level4" number="5.1.1.4">
<h4>
<span class="header-section-number">5.1.1.4</span> Inference<a class="anchor" aria-label="anchor" href="#inference"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Normality Assumption</strong></p>
<ul>
<li>Least Squares estimation does not require assumptions of normality.</li>
<li>However, to do inference on the parameters, we need distributional assumptions.</li>
<li>Inference on <span class="math inline">\(\beta_0,\beta_1\)</span> and <span class="math inline">\(Y_h\)</span> are not extremely sensitive to moderate departures from normality, especially if the sample size is large</li>
<li>Inference on <span class="math inline">\(Y_{pred}\)</span> is very sensitive to the normality assumptions.</li>
</ul>
<p><strong>Normal Error Regression Model</strong></p>
<p><span class="math display">\[
Y_i \sim N(\beta_0+\beta_1X_i, \sigma^2)
\]</span></p>
<div id="beta_1" class="section level5" number="5.1.1.4.1">
<h5>
<span class="header-section-number">5.1.1.4.1</span> <span class="math inline">\(\beta_1\)</span><a class="anchor" aria-label="anchor" href="#beta_1"><i class="fas fa-link"></i></a>
</h5>
<p>Under the normal error model,</p>
<p><span class="math display">\[
b_1 \sim N(\beta_1,\frac{\sigma^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2})
\]</span></p>
<p>A linear combination of independent normal random variable is normally distributed</p>
<p>Hence,</p>
<p><span class="math display">\[
\frac{b_1 - \beta_1}{s(b_1)} \sim t_{n-2}
\]</span></p>
<p>A <span class="math inline">\((1-\alpha) 100 \%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> is</p>
<p><span class="math display">\[
b_1 \pm t_{t-\alpha/2 ; n-2}s(b_1)
\]</span></p>
</div>
<div id="beta_0" class="section level5" number="5.1.1.4.2">
<h5>
<span class="header-section-number">5.1.1.4.2</span> <span class="math inline">\(\beta_0\)</span><a class="anchor" aria-label="anchor" href="#beta_0"><i class="fas fa-link"></i></a>
</h5>
<p>Under the normal error model, the sampling distribution for <span class="math inline">\(b_0\)</span> is</p>
<p><span class="math display">\[
b_0 \sim N(\beta_0,\sigma^2(\frac{1}{n} + \frac{\bar{X}^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2}))
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
\frac{b_0 - \beta_0}{s(b_0)} \sim t_{n-2}
\]</span> A <span class="math inline">\((1-\alpha)100 \%\)</span> confidence interval for <span class="math inline">\(\beta_0\)</span> is</p>
<p><span class="math display">\[
b_0 \pm t_{1-\alpha/2;n-2}s(b_0)
\]</span></p>
</div>
<div id="mean-response" class="section level5" number="5.1.1.4.3">
<h5>
<span class="header-section-number">5.1.1.4.3</span> Mean Response<a class="anchor" aria-label="anchor" href="#mean-response"><i class="fas fa-link"></i></a>
</h5>
<p>Let <span class="math inline">\(X_h\)</span> denote the level of X for which we wish to estimate the mean response</p>
<ul>
<li>We denote the mean response when <span class="math inline">\(X = X_h\)</span> by <span class="math inline">\(E(Y_h)\)</span><br>
</li>
<li>A point estimator of <span class="math inline">\(E(Y_h)\)</span> is <span class="math inline">\(\hat{Y}_h\)</span>:</li>
</ul>
<p><span class="math display">\[
\hat{Y}_h = b_0 + b_1 X_h
\]</span> <strong>Note</strong></p>
<p><span class="math display">\[
\begin{aligned}
E(\bar{Y}_h) &amp;= E(b_0 + b_1X_h) \\
&amp;= \beta_0 + \beta_1 X_h \\
&amp;= E(Y_h)
\end{aligned}
\]</span> (unbiased estimator)</p>
<p><span class="math display">\[
\begin{aligned}
var(\hat{Y}_h) &amp;= var(b_0 + b_1 X_h) \\
&amp;= var(\hat{Y} + b_1 (X_h - \bar{X})) \\
&amp;= var(\bar{Y}) + (X_h - \bar{X})^2var(b_1) + 2(X_h - \bar{X})cov(\bar{Y},b_1) \\
&amp;= \frac{\sigma^2}{n} + (X_h - \bar{X})^2 \frac{\sigma^2}{\sum(X_i - \bar{X})^2} \\
&amp;= \sigma^2(\frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum_{i=1}^{n} (X_i - \bar{X})^2})
\end{aligned}
\]</span></p>
<p>Since <span class="math inline">\(cov(\bar{Y},b_1) = 0\)</span> due to the iid assumption on <span class="math inline">\(\epsilon_i\)</span></p>
<p>An estimate of this variance is</p>
<p><span class="math display">\[
s^2(\hat{Y}_h) = MSE (\frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2})
\]</span></p>
<p>the sampling distribution for the mean response is</p>
<p><span class="math display">\[
\begin{aligned}
\hat{Y}_h &amp;\sim N(E(Y_h),var(\hat{Y_h})) \\
\frac{\hat{Y}_h - E(Y_h)}{s(\hat{Y}_h)} &amp;\sim t_{n-2}
\end{aligned}
\]</span></p>
<p>A <span class="math inline">\(100(1-\alpha) \%\)</span> CI for <span class="math inline">\(E(Y_h)\)</span> is</p>
<p><span class="math display">\[
\hat{Y}_h \pm t_{1-\alpha/2;n-2}s(\hat{Y}_h)
\]</span></p>
</div>
<div id="prediction-of-a-new-observation" class="section level5" number="5.1.1.4.4">
<h5>
<span class="header-section-number">5.1.1.4.4</span> Prediction of a new observation<a class="anchor" aria-label="anchor" href="#prediction-of-a-new-observation"><i class="fas fa-link"></i></a>
</h5>
<p>Regarding the <a href="linear-regression.html#mean-response">Mean Response</a>, we are interested in estimating <strong>mean</strong> of the distribution of Y given a certain X.</p>
<p>Now, we want to <strong>predict</strong> an individual outcome for the distribution of Y at a given X. We call <span class="math inline">\(Y_{pred}\)</span></p>
<p>Estimation of mean response versus prediction of a new observation:</p>
<ul>
<li><p>the point estimates are the same in both cases: <span class="math inline">\(\hat{Y}_{pred} = \hat{Y}_h\)</span></p></li>
<li>
<p>It is the variance of the prediction that is different; hence, prediction intervals are different than confidence intervals. The prediction variance must consider:</p>
<ul>
<li>Variation in the mean of the distribution of <span class="math inline">\(Y\)</span>
</li>
<li>Variation within the distribution of <span class="math inline">\(Y\)</span>
</li>
</ul>
</li>
</ul>
<p>We want to predict: mean response + error</p>
<p><span class="math display">\[
\beta_0 + \beta_1 X_h + \epsilon
\]</span></p>
<p>Since <span class="math inline">\(E(\epsilon) = 0\)</span>, use the least squares predictor:</p>
<p><span class="math display">\[
\hat{Y}_h = b_0 + b_1 X_h
\]</span></p>
<p>The variance of the predictor is</p>
<p><span class="math display">\[
\begin{aligned}
var(b_0 + b_1 X_h + \epsilon) &amp;= var(b_0 + b_1 X_h) + var(\epsilon) \\
&amp;= \sigma^2(\frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2}) + \sigma^2 \\
&amp;= \sigma^2(1+\frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2})
\end{aligned}
\]</span></p>
<p>An estimate of the variance is given by</p>
<p><span class="math display">\[
s^2(pred)= MSE (1+ \frac{1}{n} + \frac{(X_h - \bar{X})^2}{\sum_{i=1}^{n}(X_i - \bar{X})^2})
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\frac{Y_{pred}-\hat{Y}_h}{s(pred)} \sim t_{n-2}
\]</span></p>
<p><span class="math inline">\(100(1-\alpha) \%\)</span> prediction interval is</p>
<p><span class="math display">\[
\bar{Y}_h \pm t_{1-\alpha/2; n-2}s(pred)
\]</span></p>
<p>The prediction interval is very sensitive to the distributional assumption on the errors, <span class="math inline">\(\epsilon\)</span></p>
</div>
<div id="confidence-band" class="section level5" number="5.1.1.4.5">
<h5>
<span class="header-section-number">5.1.1.4.5</span> Confidence Band<a class="anchor" aria-label="anchor" href="#confidence-band"><i class="fas fa-link"></i></a>
</h5>
<p>We want to know the confidence interval for the entire regression line, so we can draw conclusions about any and all mean response fo the entire regression line <span class="math inline">\(E(Y) = \beta_0 + \beta_1 X\)</span> rather than for a given response <span class="math inline">\(Y\)</span></p>
<p><strong>Working-Hotelling Confidence Band</strong></p>
<p>For a given <span class="math inline">\(X_h\)</span>, this band is</p>
<p><span class="math display">\[
\hat{Y}_h \pm W s(\hat{Y}_h)
\]</span> where <span class="math inline">\(W^2 = 2F_{1-\alpha;2,n-2}\)</span>, which is just 2 times the F-stat with 2 and <span class="math inline">\(n-2\)</span> degrees of freedom</p>
<ul>
<li>the interval width will change with each <span class="math inline">\(X_h\)</span> (since <span class="math inline">\(s(\hat{Y}_h)\)</span> changes)<br>
</li>
<li>the boundary values for this confidence band will always define a hyperbole containing the regression line<br>
</li>
<li>will be smallest at <span class="math inline">\(X = \bar{X}\)</span>
</li>
</ul>
</div>
</div>
<div id="anova" class="section level4" number="5.1.1.5">
<h4>
<span class="header-section-number">5.1.1.5</span> ANOVA<a class="anchor" aria-label="anchor" href="#anova"><i class="fas fa-link"></i></a>
</h4>
<p>Partitioning the Total Sum of Squares: Consider the corrected Total sum of squares:</p>
<p><span class="math display">\[
SSTO = \sum_{i=1}^{n} (Y_i -\bar{Y})^2
\]</span></p>
<p>Measures the overall dispersion in the response variable<br>
We use the term corrected because we correct for mean, the uncorrected total sum of squares is given by <span class="math inline">\(\sum Y_i^2\)</span></p>
<p>use <span class="math inline">\(\hat{Y}_i = b_0 + b_1 X_i\)</span> to estimate the conditional mean for Y at <span class="math inline">\(X_i\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\sum_{i=1}^n (Y_i - \bar{Y})^2 &amp;= \sum_{i=1}^n (Y_i - \hat{Y}_i + \hat{Y}_i - \bar{Y})^2 \\
&amp;= \sum_{i=1}^n(Y_i - \hat{Y}_i)^2 + \sum_{i=1}^n(\hat{Y}_i - \bar{Y})^2 + 2\sum_{i=1}^n(Y_i - \hat{Y}_i)(\hat{Y}_i-\bar{Y}) \\
&amp;= \sum_{i=1}^n(Y_i - \hat{Y}_i)^2 + \sum_{i=1}^n(\bar{Y}_i -\bar{Y})^2 \\
STTO &amp;= SSE + SSR \\
\end{aligned}
\]</span></p>
<p>where SSR is the regression sum of squares, which measures how the conditional mean varies about a central value.</p>
<p>The cross-product term in the decomposition is 0:</p>
<p><span class="math display">\[
\begin{aligned}
\sum_{i=1}^n (Y_i - \hat{Y}_i)(\hat{Y}_i - \bar{Y}) &amp;= \sum_{i=1}^{n}(Y_i - \bar{Y} -b_1 (X_i - \bar{X}))(\bar{Y} + b_1 (X_i - \bar{X})-\bar{Y}) \\
&amp;= b_1 \sum_{i=1}^{n} (Y_i - \bar{Y})(X_i - \bar{X}) - b_1^2\sum_{i=1}^{n}(X_i - \bar{X})^2 \\
&amp;= b_1 \frac{\sum_{i=1}^{n}(Y_i -\bar{Y})(X_i - \bar{X})}{\sum_{i=1}^{n}(X_i - \bar{X})^2} \sum_{i=1}^{n}(X_i - \bar{X})^2 - b_1^2\sum_{i=1}^{n}(X_i - \bar{X})^2 \\
&amp;= b_1^2 \sum_{i=1}^{n}(X_i - \bar{X})^2 - b_1^2 \sum_{i=1}^{n}(X_i - \bar{X})^2 \\
&amp;= 0
\end{aligned}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\begin{aligned}
SSTO &amp;= SSR + SSE \\
(n-1 d.f) &amp;= (1 d.f.) + (n-2 d.f.)
\end{aligned}
\]</span></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="23%">
<col width="10%">
<col width="20%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th>Source of Variation</th>
<th>Sum of Squares</th>
<th>df</th>
<th>Mean Square</th>
<th>F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regression (model)</td>
<td>SSR</td>
<td><span class="math inline">\(1\)</span></td>
<td>MSR = SSR/df</td>
<td>MSR/MSE</td>
</tr>
<tr class="even">
<td>Error</td>
<td>SSE</td>
<td><span class="math inline">\(n-2\)</span></td>
<td>MSE = SSE/df</td>
<td></td>
</tr>
<tr class="odd">
<td>Total (Corrected)</td>
<td>SSTO</td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div>
<p><span class="math display">\[
\begin{aligned}
E(MSE) &amp;= \sigma^2 \\
E(MSR) &amp;= \sigma^2 + \beta_1^2 \sum_{i=1}^{n} (X_i - \bar{X})^2
\end{aligned}
\]</span></p>
<ul>
<li>If <span class="math inline">\(\beta_1 = 0\)</span>, then these two expected values are the same<br>
</li>
<li>if <span class="math inline">\(\beta_1 \neq 0\)</span> then E(MSR) will be larger than E(MSE)</li>
</ul>
<p>which means the ratio of these two quantities, we can infer something about <span class="math inline">\(\beta_1\)</span></p>
<p>Distribution theory tells us that if <span class="math inline">\(\epsilon_i \sim iid N(0,\sigma^2)\)</span> and assuming <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true,</p>
<p><span class="math display">\[
\begin{aligned}
\frac{MSE}{\sigma^2} &amp;\sim \chi_{n-2}^2 \\
\frac{MSR}{\sigma^2} &amp;\sim \chi_{1}^2 \text{ if } \beta_1=0
\end{aligned}
\]</span></p>
<p>where these two chi-square random variables are independent.</p>
<p>Since the ratio of 2 independent chi-square random variable follows an F distribution, we consider:</p>
<p><span class="math display">\[
F = \frac{MSR}{MSE} \sim F_{1,n-2}
\]</span></p>
<p>when <span class="math inline">\(\beta_1 =0\)</span>. Thus, we reject <span class="math inline">\(H_0: \beta_1 = 0\)</span> (or <span class="math inline">\(E(Y_i)\)</span> = constant) at <span class="math inline">\(\alpha\)</span> if</p>
<p><span class="math display">\[
F &gt; F_{1 - \alpha;1,n-2}
\]</span></p>
<p>this is the only null hypothesis that can be tested with this approach.</p>
<p><strong>Coefficient of Determination</strong></p>
<p><span class="math display">\[
R^2 = \frac{SSR}{SSTO} = 1- \frac{SSE}{SSTO}
\]</span></p>
<p>where <span class="math inline">\(0 \le R^2 \le 1\)</span></p>
<p><strong>Interpretation</strong>: The proportionate reduction of the total variation in <span class="math inline">\(Y\)</span> after fitting a linear model in <span class="math inline">\(X\)</span>.</p>
<p>It is not really correct to say that <span class="math inline">\(R^2\)</span> is the “variation in <span class="math inline">\(Y\)</span> explained by <span class="math inline">\(X\)</span>”.</p>
<p><span class="math inline">\(R^2\)</span> is related to the correlation coefficient between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
R^2 = (r)^2
\]</span></p>
<p>where <span class="math inline">\(r= corr(x,y)\)</span> is an estimate of the Pearson correlation coefficient. Also, note</p>
<p><span class="math display">\[
\begin{aligned}
b_1 &amp;= (\frac{\sum_{i=1}^{n}(Y_i - \bar{Y})^2}{\sum_{i=1}^{n} (X_i - \bar{X})^2})^{1/2} \\
r &amp;= \frac{s_y}{s_x} r
\end{aligned}
\]</span></p>
<p><strong>Lack of Fit</strong></p>
<p><span class="math inline">\(Y_{11},Y_{21}, \dots ,Y_{n_1,1}\)</span>: <span class="math inline">\(n_1\)</span> repeat obs at <span class="math inline">\(X_1\)</span></p>
<p><span class="math inline">\(Y_{1c},Y_{2c}, \dots ,Y_{n_c,c}\)</span>: <span class="math inline">\(n_c\)</span> repeat obs at <span class="math inline">\(X_c\)</span></p>
<p>So, there are <span class="math inline">\(c\)</span> distinct <span class="math inline">\(X\)</span> values.</p>
<p>Let <span class="math inline">\(\bar{Y}_j\)</span> be the mean over replicates for <span class="math inline">\(X_j\)</span></p>
<p>Partition the Error Sum of Squares:</p>
<p><span class="math display">\[
\begin{aligned}
\sum_{i} \sum_{j} (Y_{ij} - \hat{Y}_{ij})^2 &amp;= \sum_{i} \sum_{j} (Y_{ij} - \bar{Y}_j + \bar{Y}_j + \hat{Y}_{ij})^2 \\
&amp;=  \sum_{i} \sum_{j} (Y_{ij} - \bar{Y}_j)^2 + \sum_{i} \sum_{j} (\bar{Y}_j - \hat{Y}_{ij})^2 + \text{cross product term} \\
&amp;= \sum_{i} \sum_{j}(Y_{ij} - \bar{Y}_j)^2 + \sum_j n_j (\bar{Y}_j- \hat{Y}_{ij})^2 \\
SSE &amp;= SSPE + SSLF \\
\end{aligned}
\]</span></p>
<ul>
<li>SSPE: “pure error sum of squares” has <span class="math inline">\(n-c\)</span> degrees of freedom since we need to estimate <span class="math inline">\(c\)</span> means<br>
</li>
<li>SSLF: “lack of fit sum of squares” has <span class="math inline">\(c - 2\)</span> degrees of freedom (the number of unique <span class="math inline">\(X\)</span> values - number of parameters used to specify the conditional mean regression model)</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
MSPE &amp;= \frac{SSPE}{df_{pe}} = \frac{SSPE}{n-c} \\
MSLF &amp;= \frac{SSLF}{df_{lf}} = \frac{SSLF}{c-2}
\end{aligned}
\]</span></p>
<p>The <strong>F-test for Lack-of-Fit</strong> tests</p>
<p><span class="math display">\[
\begin{aligned}
H_0: Y_{ij} &amp;= \beta_0 + \beta_1 X_i + \epsilon_{ij}, \epsilon_{ij} \sim iid N(0,\sigma^2) \\
H_a: Y_{ij} &amp;= \alpha_0 + \alpha_1 X_i + f(X_i, Z_1,...) + \epsilon_{ij}^*,\epsilon_{ij}^* \sim iid N(0, \sigma^2)
\end{aligned}
\]</span></p>
<p><span class="math inline">\(E(MSPE) = \sigma^2\)</span> under either <span class="math inline">\(H_0\)</span>, <span class="math inline">\(H_a\)</span></p>
<p><span class="math inline">\(E(MSLF) = \sigma^2 + \frac{\sum n_j(f(X_i,...))^2}{n-2}\)</span> in general and</p>
<p><span class="math inline">\(E(MSLF) = \sigma^2\)</span> when <span class="math inline">\(H_0\)</span> is true</p>
<p>We reject <span class="math inline">\(H_0\)</span> (i.e., the model <span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + \epsilon_i\)</span> is not adequate) if</p>
<p><span class="math display">\[
F = \frac{MSLF}{MSPE} &gt; F_{1-\alpha;c-2,n-c}
\]</span></p>
<p>Failing to reject <span class="math inline">\(H_0\)</span> does not imply that <span class="math inline">\(H_0: Y_{ij} = \beta_0 + \beta_1 X_i + \epsilon_{ij}\)</span> is exactly true, but it suggests that this model may provide a reasonable approximation to the true model.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="30%">
<col width="22%">
<col width="10%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th>Source of Variation</th>
<th>Sum of Squares</th>
<th>df</th>
<th>Mean Square</th>
<th>F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td>SSR</td>
<td><span class="math inline">\(1\)</span></td>
<td>MSR</td>
<td>MSR / MSE</td>
</tr>
<tr class="even">
<td>Error</td>
<td>SSE</td>
<td><span class="math inline">\(n-2\)</span></td>
<td>MSE</td>
<td></td>
</tr>
<tr class="odd">
<td>Lack of fit</td>
<td>SSLF</td>
<td><span class="math inline">\(c-2\)</span></td>
<td>MSLF</td>
<td>MSLF / MSPE</td>
</tr>
<tr class="even">
<td>Pure Error</td>
<td>SSPE</td>
<td><span class="math inline">\(n-c\)</span></td>
<td>MSPE</td>
<td></td>
</tr>
<tr class="odd">
<td>Total (Corrected)</td>
<td>SSTO</td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div>
<p>Repeat observations have an effect on <span class="math inline">\(R^2\)</span>:</p>
<ul>
<li>It is impossible for <span class="math inline">\(R^2\)</span> to attain 1 when repeat obs. exist (SSE can’t be 0)</li>
<li>The maximum <span class="math inline">\(R^2\)</span> attainable in this situation:</li>
</ul>
<p><span class="math display">\[
R^2_{max} = \frac{SSTo - SSPE}{SSTO}
\]</span></p>
<ul>
<li>Not all levels of X need have repeat observations.</li>
<li>Typically, when <span class="math inline">\(H_0\)</span> is appropriate, one still uses MSE as the estimate for <span class="math inline">\(\sigma^2\)</span> rather than MSPE, Since MSE has more degrees of freedom, sometimes people will pool these estimates.</li>
</ul>
<p><strong>Joint Inference</strong><br>
The confidence coefficient for both <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> considered simultaneously is <span class="math inline">\(\le \alpha\)</span></p>
<p>Let</p>
<ul>
<li>
<span class="math inline">\(\bar{A}_1\)</span> be the event that the first interval covers <span class="math inline">\(\beta_0\)</span>
</li>
<li>
<span class="math inline">\(\bar{A}_2\)</span> be the event that the second interval covers <span class="math inline">\(\beta_1\)</span>
</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
P(\bar{A}_1) &amp;= 1 - \alpha \\
P(\bar{A}_2) &amp;= 1 - \alpha
\end{aligned}
\]</span></p>
<p>The probability that both <span class="math inline">\(\bar{A}_1\)</span> and <span class="math inline">\(\bar{A}_2\)</span></p>
<p><span class="math display">\[
\begin{aligned}
P(\bar{A}_1 \cap \bar{A}_2) &amp;= 1 - P(\bar{A}_1 \cup \bar{A}_2) \\
&amp;= 1 - P(A_1) - P(A_2) + P(A_1 \cap A_2) \\
&amp;\ge 1 - P(A_1) - P(A_2) \\
&amp;= 1 - 2\alpha
\end{aligned}
\]</span></p>
<p>If <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> have separate 95% confidence intervals, the joint (family) confidence coefficient is at least <span class="math inline">\(1 - 2(0.05) = 0.9\)</span>. This is called a <strong>Bonferroni Inequality</strong></p>
<p>We could use a procedure in which we obtained <span class="math inline">\(1-\alpha/2\)</span> confidence intervals for the two regression parameters separately, then the joint (Bonferroni) family confidence coefficient would be at least <span class="math inline">\(1- \alpha\)</span></p>
<p>The <span class="math inline">\(1-\alpha\)</span> joint Bonferroni confidence interval for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> is given by calculating:</p>
<p><span class="math display">\[
\begin{aligned}
b_0 &amp;\pm B s(b_0) \\
b_1 &amp;\pm B s(b_1)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(B= t_{1-\alpha/4;n-2}\)</span></p>
<p>Interpretation: If repeated samples were taken and the joint <span class="math inline">\((1-\alpha)\)</span> intervals for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> were obtained, <span class="math inline">\((1-\alpha)100\)</span>% of the joint intervals would contain the true pair <span class="math inline">\((\beta_0, \beta_1)\)</span>. That is, in <span class="math inline">\(\alpha \times 100\)</span>% of the samples, one or both intervals would not contain the true value.</p>
<ul>
<li>The Bonferroni interval is <strong>conservative</strong>. It is a lower bound and the joint intervals will tend to be correct more than <span class="math inline">\((1-\alpha)100\)</span>% of the time (lower power). People usually consider a larger <span class="math inline">\(\alpha\)</span> for the Bonferroni joint tests (e.g, <span class="math inline">\(\alpha=0.1\)</span>)</li>
<li>The Bonferroni procedure extends to testing more than 2 parameters. Say we are interested in testing <span class="math inline">\(\beta_0,\beta_1,..., \beta_{g-1}\)</span> (g parameters to test). Then, the joint Bonferroni interval is obtained by calculating the <span class="math inline">\((1-\alpha/g)\)</span> 100% level interval for each separately.</li>
<li>For example, if <span class="math inline">\(\alpha = 0.05\)</span> and <span class="math inline">\(g=10\)</span>, each individual test is done at the <span class="math inline">\(1- \frac{.05}{10}\)</span> level. For 2-sided intervals, this corresponds to using <span class="math inline">\(t_{1-\frac{0.05}{2(10)};n-p}\)</span> in the CI formula. This procedure works best if g is relatively small, otherwise the intervals for each individual parameter are very wide and the test is way too conservative.</li>
<li>
<span class="math inline">\(b_0,b_1\)</span> are usually correlated (negatively if <span class="math inline">\(\bar{X} &gt;0\)</span> and positively if <span class="math inline">\(\bar{X}&lt;0\)</span>)</li>
<li>Other multiple comparison procedures are available.</li>
</ul>
</div>
<div id="assumptions" class="section level4" number="5.1.1.6">
<h4>
<span class="header-section-number">5.1.1.6</span> Assumptions<a class="anchor" aria-label="anchor" href="#assumptions"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Linearity of the regression function</li>
<li>Error terms have constant variance</li>
<li>Error terms are independent</li>
<li>No outliers</li>
<li>Error terms are normally distributed</li>
<li>No Omitted variables</li>
</ul>
</div>
<div id="diagnostics" class="section level4" number="5.1.1.7">
<h4>
<span class="header-section-number">5.1.1.7</span> Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<p>Constant Variance</p>
<ul>
<li>Plot residuals vs. X</li>
</ul>
</li>
<li>
<p>Outliers</p>
<ul>
<li><p>plot residuals vs. X</p></li>
<li><p>box plots</p></li>
<li><p>stem-leaf plots</p></li>
<li><p>scatter plots</p></li>
</ul>
</li>
</ul>
<p>We could use standardize the residuals to have unit variance. These standardized residuals are called studentized residuals:</p>
<p><span class="math display">\[
r_i = \frac{e_i -\bar{e}}{s(e_i)} = \frac{e_i}{s(e_i)}
\]</span></p>
<p>A simplified standardization procedure gives semi-studentized residuals:</p>
<p><span class="math display">\[
e_i^* = \frac{e_i - \bar{e}}{\sqrt{MSE}} = \frac{e_i}{\sqrt{MSE}}
\]</span></p>
<p><strong>Non-independent of Error Terms</strong></p>
<ul>
<li>plot residuals vs. time</li>
</ul>
<p>Residuals <span class="math inline">\(e_i\)</span> are not independent random variables because they involve the fitted values <span class="math inline">\(\hat{Y}_i\)</span>, which are based on the same fitted regression function.</p>
<p>If the sample size is large, the dependency among <span class="math inline">\(e_i\)</span> is relatively unimportant.</p>
<p>To detect non-independence, it helps to plot the residual for the <span class="math inline">\(i\)</span>-th response vs. the <span class="math inline">\((i-1)\)</span>-th</p>
<p><strong>Non-normality of Error Terms</strong></p>
<p>to detect non-normality (distribution plots of residuals, box plots of residuals, stem-leaf plots of residuals, normal probability plots of residuals)</p>
<ul>
<li>Need relatively large sample sizes.</li>
<li>Other types of departure affect the distribution of the residuals (wrong regression function, non-constant error variance,…)</li>
</ul>
<div id="objective-tests-of-model-assumptions" class="section level5" number="5.1.1.7.1">
<h5>
<span class="header-section-number">5.1.1.7.1</span> Objective Tests of Model Assumptions<a class="anchor" aria-label="anchor" href="#objective-tests-of-model-assumptions"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>
<p>Normality</p>
<ul>
<li>Use <a href="descriptive-stat.html#methods-based-on-empirical-cumulative-distribution-function">Methods based on empirical cumulative distribution function</a> to test on residuals.</li>
</ul>
</li>
<li>
<p>Constancy of error variance</p>
<ul>
<li><a href="linear-regression.html#brown-forsythe-test-modified-levene-test">Brown-Forsythe Test (Modified Levene Test)</a></li>
<li><a href="linear-regression.html#breusch-pagan-test-cook-weisberg-test">Breusch-Pagan Test (Cook-Weisberg Test)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="remedial-measures" class="section level4" number="5.1.1.8">
<h4>
<span class="header-section-number">5.1.1.8</span> Remedial Measures<a class="anchor" aria-label="anchor" href="#remedial-measures"><i class="fas fa-link"></i></a>
</h4>
<p>If the simple linear regression is not appropriate, one can:</p>
<ul>
<li>more complicated models</li>
<li>transformations on <span class="math inline">\(X\)</span> and/or <span class="math inline">\(Y\)</span> (may not be “optimal” results)</li>
</ul>
<p>Remedial measures based on deviations:</p>
<ul>
<li>
<p>Non-linearity:</p>
<ul>
<li><a href="Non-normality%20often%20occurs%20with%20non-constant%20error%20variances;%20need%20to%20transform%20to%20constant%20error%20variance%20first,%20then%20check%20normality.">Transformations</a></li>
<li>more complicated models</li>
</ul>
</li>
<li>
<p>Non-constant error variance:</p>
<ul>
<li><a href="linear-regression.html#weighted-least-squares">Weighted Least Squares</a></li>
<li><a href="Non-normality%20often%20occurs%20with%20non-constant%20error%20variances;%20need%20to%20transform%20to%20constant%20error%20variance%20first,%20then%20check%20normality.">Transformations</a></li>
</ul>
</li>
<li>
<p>Correlated errors:</p>
<ul>
<li>serially correlated error models (times series)</li>
</ul>
</li>
<li><p>Non-normality</p></li>
<li><p>Additional variables: multiple regression.</p></li>
<li>
<p>Outliers:</p>
<ul>
<li>Robust estimation.</li>
</ul>
</li>
</ul>
<div id="transformations" class="section level5" number="5.1.1.8.1">
<h5>
<span class="header-section-number">5.1.1.8.1</span> Transformations<a class="anchor" aria-label="anchor" href="#transformations"><i class="fas fa-link"></i></a>
</h5>
<p>use transformations of one or both variables before performing the regression analysis.<br>
The properties of least-squares estimates apply to the transformed regression, not the original variable.</p>
<p>If we transform the Y variable and perform regression to get:</p>
<p><span class="math display">\[
g(Y_i) = b_0 + b_1 X_i
\]</span></p>
<p>Transform back:</p>
<p><span class="math display">\[
\hat{Y}_i = g^{-1}(b_0 + b_1 X_i)
\]</span></p>
<p><span class="math inline">\(\hat{Y}_i\)</span> will be biased. we can correct this bias.</p>
<p><strong>Box-Cox Family Transformations</strong></p>
<p><span class="math display">\[
Y'= Y^{\lambda}
\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is a parameter to be determined from the data.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center"><span class="math inline">\(\lambda\)</span></th>
<th align="center"><span class="math inline">\(Y'\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center"><span class="math inline">\(Y^2\)</span></td>
</tr>
<tr class="even">
<td align="center">0.5</td>
<td align="center"><span class="math inline">\(\sqrt{Y}\)</span></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center"><span class="math inline">\(ln(Y)\)</span></td>
</tr>
<tr class="even">
<td align="center">-0.5</td>
<td align="center"><span class="math inline">\(1/\sqrt{Y}\)</span></td>
</tr>
<tr class="odd">
<td align="center">-1</td>
<td align="center"><span class="math inline">\(1/Y\)</span></td>
</tr>
</tbody>
</table></div>
<p>To pick <span class="math inline">\(\lambda\)</span>, we can do estimation by:</p>
<ul>
<li>trial and error</li>
<li>maximum likelihood</li>
<li>numerical search</li>
</ul>
<p><strong>Variance Stabilizing Transformations</strong></p>
<p>A general method for finding a variance stabilizing transformation, when the standard deviation is a function of the mean, is the <strong>delta method</strong> - an application of a Taylor series expansion.</p>
<p><span class="math display">\[
\sigma = \sqrt{var(Y)} = f(\mu)
\]</span></p>
<p>where <span class="math inline">\(\mu = E(Y)\)</span> and <span class="math inline">\(f(\mu)\)</span> is some smooth function of the mean.</p>
<p>Consider the transformation <span class="math inline">\(h(Y)\)</span>. Expand this function in a Taylor series about <span class="math inline">\(\mu\)</span>. Then,</p>
<p><span class="math display">\[
h(Y) = h(\mu) + h'(\mu)(Y-\mu) + \text{small terms}
\]</span></p>
<p>we want to select the function h(.) so that the variance of h(Y) is nearly constant for all values of <span class="math inline">\(\mu= E(Y)\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
const &amp;= var(h(Y)) \\
&amp;= var(h(\mu) + h'(\mu)(Y-\mu)) \\
&amp;= (h'(\mu))^2 var(Y-\mu) \\
&amp;= (h'(\mu))^2 var(Y) \\
&amp;= (h'(\mu))^2(f(\mu))^2 \\
\end{aligned}
\]</span></p>
<p>we must have,</p>
<p><span class="math display">\[
h'(\mu) \propto \frac{1}{f(\mu)}
\]</span></p>
<p>then,</p>
<p><span class="math display">\[
h(\mu) = \int\frac{1}{f(\mu)}d\mu
\]</span></p>
<p>Example: For the Poisson distribution: <span class="math inline">\(\sigma^2 = var(Y) = E(Y) = \mu\)</span></p>
<p>Then,</p>
<p><span class="math display">\[
\begin{aligned}
\sigma = f(\mu) &amp;= \sqrt{mu} \\
h'(\mu) &amp;\propto \frac{1}{\mu} = \mu^{-.5}
\end{aligned}
\]</span></p>
<p>Then, the variance stabilizing transformation is:</p>
<p><span class="math display">\[
h(\mu) = \int \mu^{-.5} d\mu = \frac{1}{2} \sqrt{\mu}
\]</span></p>
<p>hence, <span class="math inline">\(\sqrt{Y}\)</span> is used as the variance stabilizing transformation.</p>
<p>If we don’t know <span class="math inline">\(f(\mu)\)</span></p>
<ol style="list-style-type: decimal">
<li>Trial and error. Look at residuals plots</li>
<li>Ask researchers about previous studies or find published results on similar experiments and determine what transformation was used.</li>
<li>If you have multiple observations <span class="math inline">\(Y_{ij}\)</span> at the same X values, compute <span class="math inline">\(\bar{Y}_i\)</span> and <span class="math inline">\(s_i\)</span> and plot them<br>
If <span class="math inline">\(s_i \propto \bar{Y}_i^{\lambda}\)</span> then consider <span class="math inline">\(s_i = a \bar{Y}_i^{\lambda}\)</span> or <span class="math inline">\(ln(s_i) = ln(a) + \lambda ln(\bar{Y}_i)\)</span>. So regression the natural log of <span class="math inline">\(s_i\)</span> on the natural log of <span class="math inline">\(\bar{Y}_i\)</span> gives <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{\lambda}\)</span> and suggests the form of <span class="math inline">\(f(\mu)\)</span> If we don’t have multiple obs, might still be able to “group” the observations to get <span class="math inline">\(\bar{Y}_i\)</span> and <span class="math inline">\(s_i\)</span>.</li>
</ol>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="25%">
<col width="37%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th>Transformation</th>
<th>Situation</th>
<th>Comments</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\sqrt{Y}\)</span></td>
<td><span class="math inline">\(var(\epsilon_i) = k E(Y_i)\)</span></td>
<td>counts from Poisson dist</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\  sqrt{Y} + \sqrt{Y+1}\)</span></td>
<td><span class="math inline">\(var(\epsilon_i) = k E(Y_i)\)</span></td>
<td>small counts or zeroes</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(log(Y)\)</span></td>
<td><span class="math inline">\(var(\epsilon_i) = k (E(Y_i))^2\)</span></td>
<td>positive integers with wide range</td>
</tr>
<tr class="even">
<td><span class="math inline">\(log(Y+1)\)</span></td>
<td><span class="math inline">\(var(\epsilon_i) = k(E(Y_i))^2\)</span></td>
<td>some counts zero</td>
</tr>
<tr class="odd">
<td>1/Y</td>
<td><span class="math inline">\(var(\epsilon_i) = k(E(Y_i))^4\)</span></td>
<td>most responses near zero, others large</td>
</tr>
<tr class="even">
<td><span class="math inline">\(arcsin(\sqrt{Y})\)</span></td>
<td><span class="math inline">\(var(\epsilon_i) = k E(Y_i)(1-E(Y_i))\)</span></td>
<td>data are binomial proportions or %</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div id="multiple-linear-regression" class="section level3" number="5.1.2">
<h3>
<span class="header-section-number">5.1.2</span> Multiple Linear Regression<a class="anchor" aria-label="anchor" href="#multiple-linear-regression"><i class="fas fa-link"></i></a>
</h3>
<p>Geometry of Least Squares</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{\hat{y}} &amp;= \mathbf{Xb} \\
&amp;= \mathbf{X(X'X)^{-1}X'y} \\
&amp;= \mathbf{Hy}
\end{aligned}
\]</span></p>
<p>sometimes <span class="math inline">\(\mathbf{H}\)</span> is denoted as <span class="math inline">\(\mathbf{P}\)</span>.</p>
<p><span class="math inline">\(\mathbf{H}\)</span> is the projection operator.<br><span class="math display">\[
\mathbf{\hat{y}= Hy}
\]</span></p>
<p>is the projection of y onto the linear space spanned by the columns of <span class="math inline">\(\mathbf{X}\)</span> (model space). The dimension of the model space is the rank of <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>Facts:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\mathbf{H}\)</span> is symmetric (i.e., <span class="math inline">\(\mathbf{H} = \mathbf{H}'\)</span>)<br>
</li>
<li><span class="math inline">\(\mathbf{HH} = \mathbf{H}\)</span></li>
</ol>
<p><span class="math display">\[
\begin{aligned}
\mathbf{HH} &amp;= \mathbf{X(X'X)^{-1}X'X(X'X)^{-1}X'} \\
&amp;= \mathbf{X(X'X)^{-1}IX'} \\
&amp;= \mathbf{X(X'X)^{-1}X'}
\end{aligned}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>
<span class="math inline">\(\mathbf{H}\)</span> is an <span class="math inline">\(n \times n\)</span> matrix with <span class="math inline">\(rank(\mathbf{H}) = rank(\mathbf{X})\)</span><br>
</li>
<li>
<span class="math inline">\(\mathbf{(I-H) = I - X(X'X)^{-1}X'}\)</span> is also a projection operator. It projects onto the <span class="math inline">\(n - k\)</span> dimensional space that is orthogonal to the <span class="math inline">\(k\)</span> dimensional space spanned by the columns of <span class="math inline">\(\mathbf{X}\)</span>
</li>
<li><span class="math inline">\(\mathbf{H(I-H)=(I-H)H = 0}\)</span></li>
</ol>
<p>Partition of uncorrected total sum of squares:</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{y'y} &amp;= \mathbf{\hat{y}'\hat{y} + e'e} \\
&amp;= \mathbf{(Hy)'(Hy) + ((I-H)y)'((I-H)y)} \\
&amp;= \mathbf{y'H'Hy + y'(I-H)'(I-H)y} \\
&amp;= \mathbf{y'Hy + y'(I-H)y} \\
\end{aligned}
\]</span></p>
<p>or partition for the corrected total sum of squares:</p>
<p><span class="math display">\[
\mathbf{y'(I-H_1)y = y'(H-H_1)y + y'(I-H)y}
\]</span></p>
<p>where <span class="math inline">\(H_1 = \frac{1}{n} J = 1'(1'1)1\)</span></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td><span class="math inline">\(SSR = \mathbf{y' (H-\frac{1}{n}J)y}\)</span></td>
<td><span class="math inline">\(p - 1\)</span></td>
<td><span class="math inline">\(SSR/(p-1)\)</span></td>
<td><span class="math inline">\(MSR /MSE\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(SSE = \mathbf{y'(I - H)y}\)</span></td>
<td><span class="math inline">\(n - p\)</span></td>
<td><span class="math inline">\(SSE /(n-p)\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(\mathbf{y'y - y'Jy/n}\)</span></td>
<td><span class="math inline">\(n -1\)</span></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div>
<p>Equivalently, we can express</p>
<p><span class="math display">\[
\mathbf{Y = X\hat{\beta} + (Y - X\hat{\beta})}
\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\mathbf{\hat{Y} = X \hat{\beta}}\)</span> = sum of a vector of fitted values</li>
<li>
<span class="math inline">\(\mathbf{e = ( Y - X \hat{\beta})}\)</span> = residual</li>
<li>
<span class="math inline">\(\mathbf{Y}\)</span> is the <span class="math inline">\(n \times 1\)</span> vector in a n-dimensional space <span class="math inline">\(R^n\)</span>
</li>
<li>
<span class="math inline">\(\mathbf{X}\)</span> is an <span class="math inline">\(n \times p\)</span> full rank matrix. and its columns generate a <span class="math inline">\(p\)</span>-dimensional subspace of <span class="math inline">\(R^n\)</span>. Hence, any estimator <span class="math inline">\(\mathbf{X \hat{\beta}}\)</span> is also in this subspace.</li>
</ul>
<p>We choose least squares estimator that minimize the distance between <span class="math inline">\(\mathbf{Y}\)</span> and <span class="math inline">\(\mathbf{X \hat{\beta}}\)</span>, which is the <strong>orthogonal projection</strong> of <span class="math inline">\(\mathbf{Y}\)</span> onto <span class="math inline">\(\mathbf{X\beta}\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
||\mathbf{Y} - \mathbf{X}\hat{\beta}||^2 &amp;= \mathbf{||Y - X\hat{\beta}||}^2 + \mathbf{||X \hat{\beta}||}^2 \\
&amp;= \mathbf{(Y - X\hat{\beta})'(Y - X\hat{\beta}) +(X \hat{\beta})'(X \hat{\beta})} \\
&amp;= \mathbf{(Y - X\hat{\beta})'Y - (Y - X\hat{\beta})'X\hat{\beta} + \hat{\beta}' X'X\hat{\beta}} \\
&amp;= \mathbf{(Y-X\hat{\beta})'Y + \hat{\beta}'X'X(XX')^{-1}X'Y} \\
&amp;= \mathbf{Y'Y - \hat{\beta}'X'Y + \hat{\beta}'X'Y}
\end{aligned}
\]</span></p>
<p>where the norm of a <span class="math inline">\((p \times 1)\)</span> vector <span class="math inline">\(\mathbf{a}\)</span> is defined by:</p>
<p><span class="math display">\[
\mathbf{||a|| = \sqrt{a'a}} = \sqrt{\sum_{i=1}^p a^2_i}
\]</span></p>
<p>Coefficient of Multiple Determination</p>
<p><span class="math display">\[
R^2 = \frac{SSR}{SSTO}= 1- \frac{SSE}{SSTO}
\]</span></p>
<p>Adjusted Coefficient of Multiple Determination</p>
<p><span class="math display">\[
R^2_a = 1 - \frac{SSE/(n-p)}{SSTO/(n-1)} = 1 - \frac{(n-1)SSE}{(n-p)SSTO}
\]</span></p>
<p>Sequential and Partial Sums of Squares:</p>
<p>In a regression model with coefficients <span class="math inline">\(\beta = (\beta_0, \beta_1,...,\beta_{p-1})'\)</span>, we denote the uncorrected and corrected SS by</p>
<p><span class="math display">\[
\begin{aligned}
SSM &amp;= SS(\beta_0, \beta_1,...,\beta_{p-1}) \\
SSM_m &amp;= SS(\beta_0, \beta_1,...,\beta_{p-1}|\beta_0)
\end{aligned}
\]</span></p>
<p>There are 2 decompositions of <span class="math inline">\(SSM_m\)</span>:</p>
<ul>
<li>
<strong>Sequential SS</strong>: (not unique -depends on order, also referred to as Type I SS, and is the default of <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> in R)<br><span class="math display">\[
SSM_m = SS(\beta_1 | \beta_0) + SS(\beta_2 | \beta_0, \beta_1) + ...+ SS(\beta_{p-1}| \beta_0,...,\beta_{p-2})
\]</span>
</li>
<li>
<strong>Partial SS</strong>: (use more in practice - contribution of each given all of the others)</li>
</ul>
<p><span class="math display">\[
SSM_m = SS(\beta_1 | \beta_0,\beta_2,...,\beta_{p-1}) + ... + SS(\beta_{p-1}| \beta_0, \beta_1,...,\beta_{p-2})
\]</span></p>
</div>
<div id="ols-assumptions" class="section level3" number="5.1.3">
<h3>
<span class="header-section-number">5.1.3</span> OLS Assumptions<a class="anchor" aria-label="anchor" href="#ols-assumptions"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><a href="linear-regression.html#a1-linearity">A1 Linearity</a></li>
<li><a href="linear-regression.html#a2-full-rank">A2 Full rank</a></li>
<li><a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3 Exogeneity of Independent Variables</a></li>
<li><a href="linear-regression.html#a4-homoskedasticity">A4 Homoskedasticity</a></li>
<li><a href="linear-regression.html#a5-data-generation-random-sampling">A5 Data Generation (random Sampling)</a></li>
<li><a href="linear-regression.html#a6-normal-distribution">A6 Normal Distribution</a></li>
</ul>
<div id="a1-linearity" class="section level4" number="5.1.3.1">
<h4>
<span class="header-section-number">5.1.3.1</span> A1 Linearity<a class="anchor" aria-label="anchor" href="#a1-linearity"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A1">\[\begin{equation}
A1: y=\mathbf{x}\beta + \epsilon
\tag{5.1}
\end{equation}\]</span>
<p>Not restrictive</p>
<ul>
<li>
<span class="math inline">\(x\)</span> can be nonlinear transformation including interactions, natural log, quadratic</li>
</ul>
<p>With A3 (Exogeneity of Independent), linearity can be restrictive</p>
<div id="log-model" class="section level5" number="5.1.3.1.1">
<h5>
<span class="header-section-number">5.1.3.1.1</span> Log Model<a class="anchor" aria-label="anchor" href="#log-model"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="24%">
<col width="24%">
<col width="24%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>Model</th>
<th>Form</th>
<th>Interpretation of <span class="math inline">\(\beta\)</span>
</th>
<th>In words</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Level-Level</td>
<td><span class="math inline">\(y =\beta_0+\beta_1x+\epsilon\)</span></td>
<td><span class="math inline">\(\Delta y = \beta_1 \Delta x\)</span></td>
<td>A unit change in <span class="math inline">\(x\)</span> will result in <span class="math inline">\(\beta_1\)</span> unit change in <span class="math inline">\(y\)</span>
</td>
</tr>
<tr class="even">
<td>Log-Level</td>
<td><span class="math inline">\(ln(y) = \beta_0 + \beta_1x + \epsilon\)</span></td>
<td><span class="math inline">\(\% \Delta y=100 \beta_1 \Delta x\)</span></td>
<td>A unit change in <span class="math inline">\(x\)</span> result in 100 <span class="math inline">\(\beta_1\)</span> % change in <span class="math inline">\(y\)</span>
</td>
</tr>
<tr class="odd">
<td>Level-Log</td>
<td><span class="math inline">\(y = \beta _0 + \beta_1 ln (x) + \epsilon\)</span></td>
<td><span class="math inline">\(\Delta y = (\beta_1/ 100)\%\Delta x\)</span></td>
<td>One percent change in <span class="math inline">\(x\)</span> result in <span class="math inline">\(\beta_1/100\)</span> units change in <span class="math inline">\(y\)</span>
</td>
</tr>
<tr class="even">
<td>Log-Log</td>
<td><span class="math inline">\(ln(y) = \beta_0 + \beta_1 l n(x) +\epsilon\)</span></td>
<td><span class="math inline">\(\% \Delta y= \beta _1 \% \Delta x\)</span></td>
<td>One percent change in <span class="math inline">\(x\)</span> result in <span class="math inline">\(\beta_1\)</span> percent change in <span class="math inline">\(y\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="higher-orders" class="section level5" number="5.1.3.1.2">
<h5>
<span class="header-section-number">5.1.3.1.2</span> Higher Orders<a class="anchor" aria-label="anchor" href="#higher-orders"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math inline">\(y=\beta_0 + x_1\beta_1 + x_1^2\beta_2 + \epsilon\)</span></p>
<p><span class="math display">\[
\frac{\partial y}{\partial x_1}=\beta_1 + 2x_1\beta_2
\]</span></p>
<ul>
<li>The effect of <span class="math inline">\(x_1\)</span> on y depends on the level of <span class="math inline">\(x_1\)</span>
</li>
<li>The partial effect at the average = <span class="math inline">\(\beta_1+2E(x_1)\beta_2\)</span>
</li>
<li>Average Partial Effect = <span class="math inline">\(E(\beta_1 + 2x_1\beta_2)\)</span>
</li>
</ul>
</div>
<div id="interactions" class="section level5" number="5.1.3.1.3">
<h5>
<span class="header-section-number">5.1.3.1.3</span> Interactions<a class="anchor" aria-label="anchor" href="#interactions"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math inline">\(y=\beta_0 + x_1\beta_1 + x_2\beta_2 + x_1x_2\beta_3 + \epsilon\)</span></p>
<ul>
<li>
<span class="math inline">\(\beta_1\)</span> is the average effect on y for a unit change in <span class="math inline">\(x_1\)</span> when <span class="math inline">\(x_2=0\)</span>
</li>
<li>
<span class="math inline">\(\beta_1 + x_2\beta_3\)</span> is the partial effect of <span class="math inline">\(x_1\)</span> on y which depends on the level of <span class="math inline">\(x_2\)</span>
</li>
</ul>
</div>
</div>
<div id="a2-full-rank" class="section level4" number="5.1.3.2">
<h4>
<span class="header-section-number">5.1.3.2</span> A2 Full rank<a class="anchor" aria-label="anchor" href="#a2-full-rank"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A2">\[\begin{equation}
A2: rank(E(x'x))=k
\tag{5.2}
\end{equation}\]</span>
<p>also known as <strong>identification condition</strong></p>
<ul>
<li>columns of <span class="math inline">\(\mathbf{x}\)</span> cannot be written as a linear function of the other columns</li>
<li>which ensures that each parameter is unique and exists in the population regression equation</li>
</ul>
</div>
<div id="a3-exogeneity-of-independent-variables" class="section level4" number="5.1.3.3">
<h4>
<span class="header-section-number">5.1.3.3</span> A3 Exogeneity of Independent Variables<a class="anchor" aria-label="anchor" href="#a3-exogeneity-of-independent-variables"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A3">\[\begin{equation}
A3: E[\epsilon|x_1,x_2,...,x_k]=E[\epsilon|\mathbf{x}]=0
\tag{5.3}
\end{equation}\]</span>
<p><strong>strict exogeneity</strong></p>
<ul>
<li>also known as <strong>mean independence</strong> check back on <a href="prerequisites.html#correlation-and-independence">Correlation and Independence</a>
</li>
<li>by the <a href="prerequisites.html#law-of-iterated-expectations">Law of Iterated Expectations</a> <span class="math inline">\(E(\epsilon)=0\)</span>, which can be satisfied by always including an intercept.</li>
<li>independent variables do not carry information for prediction of <span class="math inline">\(\epsilon\)</span>
</li>
<li>A3 implies <span class="math inline">\(E(y|x)=x\beta\)</span>, which means the conditional mean function must be a linear function of <span class="math inline">\(x\)</span> <a href="linear-regression.html#a1-linearity">A1 Linearity</a>
</li>
</ul>
<div id="a3a" class="section level5" number="5.1.3.3.1">
<h5>
<span class="header-section-number">5.1.3.3.1</span> A3a<a class="anchor" aria-label="anchor" href="#a3a"><i class="fas fa-link"></i></a>
</h5>
<p>Weaker Exogeneity Assumption</p>
<p><strong>Exogeneity of Independent variables</strong></p>
<p>A3a: <span class="math inline">\(E(\mathbf{x_i'}\epsilon_i)=0\)</span></p>
<ul>
<li><p><span class="math inline">\(x_i\)</span> is <strong>uncorrelated</strong> with <span class="math inline">\(\epsilon_i\)</span> <a href="prerequisites.html#correlation-and-independence">Correlation and Independence</a></p></li>
<li>
<p>Weaker than <strong>mean independence</strong> A3</p>
<ul>
<li>A3 implies A3a, not the reverse</li>
<li>No causality interpretations</li>
<li>Cannot test the difference</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="a4-homoskedasticity" class="section level4" number="5.1.3.4">
<h4>
<span class="header-section-number">5.1.3.4</span> A4 Homoskedasticity<a class="anchor" aria-label="anchor" href="#a4-homoskedasticity"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A4">\[\begin{equation}
A4: Var(\epsilon|x)=Var(\epsilon)=\sigma^2
\tag{5.4}
\end{equation}\]</span>
<ul>
<li>Variation in the disturbance to be the same over the independent variables</li>
</ul>
</div>
<div id="a5-data-generation-random-sampling" class="section level4" number="5.1.3.5">
<h4>
<span class="header-section-number">5.1.3.5</span> A5 Data Generation (random Sampling)<a class="anchor" aria-label="anchor" href="#a5-data-generation-random-sampling"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A5">\[\begin{equation}
A5: {y_i,x_{i1},...,x_{ik-1}: i = 1,..., n}
\tag{5.5}
\end{equation}\]</span>
<p>is a random sample</p>
<ul>
<li><p>random sample mean samples are independent and identically distributed (iid) from a joint distribution of <span class="math inline">\((y,\mathbf{x})\)</span></p></li>
<li>
<p>with <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> and <a href="linear-regression.html#a4-homoskedasticity">A4</a>, we have</p>
<ul>
<li>
<strong>Strict Exogeneity</strong>: <span class="math inline">\(E(\epsilon_i|x_1,...,x_n)=0\)</span>. independent variables do not carry information for prediction of <span class="math inline">\(\epsilon\)</span>
</li>
<li>
<strong>Non-autocorrelation</strong>: <span class="math inline">\(E(\epsilon_i\epsilon_j|x_1,...,x_n)=0\)</span> The error term is uncorrelated across the draws conditional on the independent variables <span class="math inline">\(\rightarrow\)</span> <span class="math inline">\(A4: Var(\epsilon|\mathbf{X})=Var(\epsilon)=\sigma^2I_n\)</span>
</li>
</ul>
</li>
<li><p>In times series and spatial settings, A5 is less likely to hold.</p></li>
</ul>
<div id="a5a" class="section level5" number="5.1.3.5.1">
<h5>
<span class="header-section-number">5.1.3.5.1</span> A5a<a class="anchor" aria-label="anchor" href="#a5a"><i class="fas fa-link"></i></a>
</h5>
<p>A stochastic process <span class="math inline">\(\{x_t\}_{t=1}^T\)</span> is <strong>stationary</strong> if for every collection fo time indices <span class="math inline">\(\{t_1,t_2,...,t_m\}\)</span>, the joint distribution of</p>
<p><span class="math display">\[
x_{t_1},x_{t_2},...,x_{t_m}
\]</span></p>
<p>is the same as the joint distribution of</p>
<p><span class="math display">\[
x_{t_1+h},x_{t_2+h},...,x_{t_m+h}
\]</span></p>
<p>for any <span class="math inline">\(h \ge 1\)</span></p>
<ul>
<li>The joint distribution for the first ten observation is the same for the next ten, etc.</li>
<li>Independent draws automatically satisfies this</li>
</ul>
<p>A stochastic process <span class="math inline">\(\{x_t\}_{t=1}^T\)</span> is <strong>weakly stationary</strong> if <span class="math inline">\(x_t\)</span> and <span class="math inline">\(x_{t+h}\)</span> are “almost independent” as h increases without bounds.</p>
<ul>
<li>two observation that are very far apart should be “almost independent”</li>
</ul>
<p>Common Weakly Dependent Processes</p>
<ol style="list-style-type: decimal">
<li>Moving Average process of order 1 (MA(1))</li>
</ol>
<p>MA(1) means that there is only one period lag.</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= u_t + \alpha_1 u_{t-1} \\
E(y_t) &amp;= E(u_t) + \alpha_1E(u_{t-1}) = 0 \\
Var(y_t) &amp;= var(u_t) + \alpha_1 var(u_{t-1}) \\
&amp;= \sigma^2 + \alpha_1^2 \sigma^2 \\
&amp;= \sigma^2(1+\alpha_1^2)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(u_t\)</span> is drawn iid over t with variance <span class="math inline">\(\sigma^2\)</span></p>
<p>An increase in the absolute value of <span class="math inline">\(\alpha_1\)</span> increases the variance</p>
<p>When the MA(1) process can be <strong>inverted</strong> (<span class="math inline">\(|\alpha|&lt;1\)</span> then</p>
<p><span class="math display">\[
u_t = y_t - \alpha_1u_{t-1}
\]</span></p>
<p>called the autoregressive representation (express current observation in term of past observation).</p>
<p>We can expand it to more than 1 lag, then we have MA(q) process</p>
<p><span class="math display">\[
y_t = u_t + \alpha_1 u_{t-1} + ... + \alpha_q u_{t-q}
\]</span></p>
<p>where <span class="math inline">\(u_t \sim WN(0,\sigma^2)\)</span></p>
<ul>
<li>Covariance stationary: irrespective of the value of the parameters.</li>
<li>Invertibility when <span class="math inline">\(\alpha &lt; 1\)</span>
</li>
<li>The conditional mean of MA(q) depends on the q lags (long-term memory).</li>
<li>In MA(q), all autocorrelations beyond q are 0.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
Cov(y_t,y_{t-1}) &amp;= Cov(u_t + \alpha_1 u_{t-1},u_{t-1}+\alpha_1u_{t-2}) \\
&amp;= \alpha_1var(u_{t-1}) \\
&amp;= \alpha_1\sigma^2
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
Cov(y_t,y_{t-2}) &amp;= Cov(u_t + \alpha_1 u_{t-1},u_{t-2}+\alpha_{1}u_{t-3}) \\
&amp;= 0
\end{aligned}
\]</span></p>
<p>An MA models a linear relationship between the dependent variable and the current and past values of a stochastic term.</p>
<ol start="2" style="list-style-type: decimal">
<li>Auto regressive process of order 1 (AR(1))</li>
</ol>
<p><span class="math display">\[
y_t = \rho y_{t-1}+ u_t, |\rho|&lt;1
\]</span></p>
<p>where <span class="math inline">\(u_t\)</span> is drawn iid over t with variance <span class="math inline">\(\sigma^2\)</span></p>
<p><span class="math display">\[
\begin{aligned}
Cov(y_t,y_{t-1}) &amp;= Cov(\rho y_{t-1} + u-t,y_{t-1}) \\
&amp;= \rho Var(y_{t-1}) \\
&amp;= \rho \frac{\sigma^2}{1-\rho^2}
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
Cov(y_t,y_{t-h}) &amp;= \rho^h \frac{\sigma^2}{1-\rho^2}
\end{aligned}
\]</span></p>
<p>Stationarity: in the continuum of t, the distribution of each t is the same</p>
<p><span class="math display">\[
\begin{aligned}
E(y_t) &amp;= E(y_{t-1}) = ...= E(y_0) \\
y_1 &amp;= \rho y_0 + u_1
\end{aligned}
\]</span></p>
<p>where the initial observation <span class="math inline">\(y_0=0\)</span></p>
<p>Assume <span class="math inline">\(E(y_t)=0\)</span></p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= \rho^t y_{t-t} + \rho^{t-1}u_1 + \rho^{t-2}u_2 +...+ \rho u_{t-1} + u_t \\
&amp;= \rho^t y_0 + \rho^{t-1}u_1 + \rho^{t-2}u_2 +...+ \rho u_{t-1} + u_t
\end{aligned}
\]</span></p>
<p>Hence, <span class="math inline">\(y_t\)</span> is the weighted of all of the <span class="math inline">\(u_t\)</span> time observations before. y will be correlated with all the previous observations as well as future observations.</p>
<p><span class="math display">\[
\begin{aligned}
Var(y_t) &amp;= Var(\rho y_{t-1} + u_t) \\
&amp;= \rho^2 Var(y_{t-1}) + Var(u_t) + 2\rho Cov(y_{t-1}u_t) \\
&amp;= \rho^2 Var(y_{t-1}) + \sigma^2
\end{aligned}
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
Var(y_t) = \frac{\sigma^2}{1-\rho^2}
\]</span></p>
<p>to have Variance constantly over time, then <span class="math inline">\(\rho \neq 1\)</span> or <span class="math inline">\(-1\)</span>.</p>
<p><strong>Then</strong> stationarity requires <span class="math inline">\(\rho \neq 1\)</span> or -1. weakly dependent process <span class="math inline">\(|\rho|&lt;1\)</span></p>
<p>To estimate the AR(1) process, we use <strong>Yule-Walker Equation</strong></p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= \epsilon_t + \phi y_{t-1} \\
y_t y_{t-\tau} &amp;= \epsilon_t y_{t-\tau} + \phi y_{t-1}y_{t-\tau}
\end{aligned}
\]</span></p>
<p>For <span class="math inline">\(\tau \ge 1\)</span>, we have</p>
<p><span class="math display">\[
\gamma \tau = \phi \gamma (\tau -1)
\]</span></p>
<p><span class="math display">\[
\rho_t = \phi^t
\]</span></p>
<p>when you generalize to <span class="math inline">\(p\)</span>-th order autoregressive process, AR(p):</p>
<p><span class="math display">\[
y_t = \phi_1 y_{t-1} + \phi_2 y_{t-2} + ... + \phi_p y_{t-p} + \epsilon_t
\]</span></p>
<p>AR(p) process is <strong>covariance stationary</strong>, and decay in autocorrelations.</p>
<p>When we combine MA(q) and AR(p), we have ARMA(p,q) process, where you can see seasonality. For example, ARMA(1,1)</p>
<p><span class="math display">\[
y_t = \phi y_{t-1} + \epsilon_t + \alpha \epsilon_{t-1}
\]</span></p>
<p>Random Walk process</p>
<p><span class="math display">\[
y_t = y_0 + \sum_{s=1}^{t}u_t
\]</span></p>
<ul>
<li>not stationary : when <span class="math inline">\(y_0 = 0\)</span> then <span class="math inline">\(E(y_t)= 0\)</span>, but <span class="math inline">\(Var(y_t)=t\sigma^2\)</span>. Further along in the spectrum, the variance will be larger</li>
<li>not weakly dependent: <span class="math inline">\(Cov(\sum_{s=1}^{t}u_s,\sum_{s=1}^{t-h}u_s) = (t-h)\sigma^2\)</span>. So the covariance (fixed) is not diminishing as h increases</li>
</ul>
<p>Assumption <a href="linear-regression.html#a5a">A5a</a>: <span class="math inline">\(\{y_t,x_{t1},..,x_{tk-1} \}\)</span></p>
<p>where <span class="math inline">\(t=1,...,T\)</span> are <strong>stationary and weakly dependent processes</strong>.</p>
<p>Alternative <a href="prerequisites.html#weak-law">Weak Law</a>, <a href="prerequisites.html#central-limit-theorem">Central Limit Theorem</a><br>
If <span class="math inline">\(z_t\)</span> is a weakly dependent stationary process with a finite first absolute moment and <span class="math inline">\(E(z_t) = \mu\)</span>, then</p>
<p><span class="math display">\[
T^{-1}\sum_{t=1}^{T}z_t \to^p \mu
\]</span></p>
<p>If additional regulatory conditions hold <span class="citation">(<a href="references.html#ref-greene1990gamma">Greene 1990</a>)</span>, then</p>
<p><span class="math display">\[
\sqrt{T}(\bar{z}-\mu) \to^d N(0,B)
\]</span></p>
<p>where <span class="math inline">\(B= Var(z_t) + 2\sum_{h=1}^{\infty}Cov(z_t,z_{t-h})\)</span></p>
</div>
</div>
<div id="a6-normal-distribution" class="section level4" number="5.1.3.6">
<h4>
<span class="header-section-number">5.1.3.6</span> A6 Normal Distribution<a class="anchor" aria-label="anchor" href="#a6-normal-distribution"><i class="fas fa-link"></i></a>
</h4>
<span class="math display" id="eq:A6">\[\begin{equation}
A6: \epsilon|\mathbf{x}\sim N(0,\sigma^2I_n)
\tag{5.6}
\end{equation}\]</span>
<p>The error term is normally distributed</p>
<p>From A1-A3, we have <strong>identification</strong> (also known as <strong>Orthogonality Condition</strong>) of the population parameter <span class="math inline">\(\beta\)</span></p>
<p><span class="math display">\[
\begin{aligned}
y &amp;= {x}\beta + \epsilon &amp;&amp; \text{A1} \\
x'y &amp;= x'x\beta + x'\epsilon &amp;&amp; \text{} \\
E(x'y) &amp;= E(x'x)\beta + E(x'\epsilon)  &amp;&amp; \text{} \\
E(x'y) &amp;= E(x'x)\beta &amp;&amp; \text{A3} \\
[E(x'x)]^{-1}E(x'y) &amp;= [E(x'x)]^{-1}E(x'x)\beta &amp;&amp; \text{A2} \\
[E(x'x)]^{-1}E(x'y) &amp;= \beta
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\beta\)</span> is the row vector of parameters that produces the best predictor of y we choose the min of <span class="math inline">\(\gamma\)</span> :</p>
<p><span class="math display">\[
\underset{\gamma}{\operatorname{argmin}}E((y-x\gamma)^2)
\]</span></p>
<p>First Order Condition</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial((y-x\gamma)^2)}{\partial\gamma}&amp;=0 \\
-2E(x'(y-x\gamma))&amp;=0 \\
E(x'y)-E(x'x\gamma) &amp;=0 \\
E(x'y) &amp;= E(x'x)\gamma \\
(E(x'x))^{-1}E(x'y) &amp;= \gamma
\end{aligned}
\]</span></p>
<p>Second Order Condition</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial^2E((y-x\gamma)^2)}{\partial \gamma'^2}&amp;=0 \\
E(\frac{\partial(y-x\partial)^2)}{\partial\gamma\partial\gamma'}) &amp;= 2E(x'x)
\end{aligned}
\]</span></p>
<p>If <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> holds, then <span class="math inline">\(2E(x'x)\)</span> is PSD <span class="math inline">\(\rightarrow\)</span> minimum</p>
</div>
</div>
<div id="theorems" class="section level3" number="5.1.4">
<h3>
<span class="header-section-number">5.1.4</span> Theorems<a class="anchor" aria-label="anchor" href="#theorems"><i class="fas fa-link"></i></a>
</h3>
<div id="frisch-waugh-lovell-theorem" class="section level4" number="5.1.4.1">
<h4>
<span class="header-section-number">5.1.4.1</span> Frisch-Waugh-Lovell Theorem<a class="anchor" aria-label="anchor" href="#frisch-waugh-lovell-theorem"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
\mathbf{y=X\beta + \epsilon=X_1\beta_1+X_2\beta_2 +\epsilon}
\]</span></p>
<p>Equivalently,</p>
<p><span class="math display">\[
\left(
\begin{array}
{cc}
X_1'X_1 &amp; X_1'X_2 \\
X_2'X_1 &amp; X_2'X_2
\end{array}
\right)
\left(
\begin{array}
{c}
\hat{\beta_1} \\
\hat{\beta_2}
\end{array}
\right)
=
\left(
\begin{array}{c}
X_1'y \\
X_2'y
\end{array}
\right)
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
\mathbf{\hat{\beta_1}=(X_1'X_1)^{-1}X_1'y - (X_1'X_1)^{-1}X_1'X_2\hat{\beta_2}}
\]</span></p>
<ol style="list-style-type: decimal">
<li>Betas from the multiple regression are not the same as the betas from each of the individual simple regression</li>
<li>Different set of X will affect all the coefficient estimates.</li>
<li>If <span class="math inline">\(X_1'X_2 = 0\)</span> or <span class="math inline">\(\hat{\beta_2}=0\)</span>, then 1 and 2 do not hold.</li>
</ol>
</div>
<div id="gauss-markov-theorem" class="section level4" number="5.1.4.2">
<h4>
<span class="header-section-number">5.1.4.2</span> Gauss-Markov Theorem<a class="anchor" aria-label="anchor" href="#gauss-markov-theorem"><i class="fas fa-link"></i></a>
</h4>
<p>For a linear regression model</p>
<p><span class="math display">\[
\mathbf{y=X\beta + \epsilon}
\]</span></p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a>, <a href="linear-regression.html#a4-homoskedasticity">A4</a>, OLS estimator defined as</p>
<p><span class="math display">\[
\hat{\beta} = \mathbf{(X'X)^{-1}X'y}
\]</span></p>
<p>is the minimum variance linear (in <span class="math inline">\(y\)</span>) unbiased estimator of <span class="math inline">\(\beta\)</span></p>
<p>Let <span class="math inline">\(\tilde{\beta}=\mathbf{Cy}\)</span>, be another linear estimator where <span class="math inline">\(\mathbf{C}\)</span> is <span class="math inline">\(k \times n\)</span> and only function of <span class="math inline">\(\mathbf{X}\)</span>), then for it be unbiased,</p>
<p><span class="math display">\[
\begin{aligned}
E(\tilde{\beta}|\mathbf{X}) &amp;= E(\mathbf{Cy|X}) \\
&amp;= E(\mathbf{CX\beta + C\epsilon|X}) \\
&amp;= \mathbf{CX\beta}
\end{aligned}
\]</span></p>
<p>which equals the true parameter <span class="math inline">\(\beta\)</span> only if <span class="math inline">\(\mathbf{CX=I}\)</span><br>
Equivalently, <span class="math inline">\(\tilde{\beta} = \beta + \mathbf{C}\epsilon\)</span> and the variance of the estimator is <span class="math inline">\(Var(\tilde{\beta}|\mathbf{X}) = \sigma^2\mathbf{CC'}\)</span></p>
<p>To show minimum variance,</p>
<p><span class="math display">\[
\begin{aligned}
&amp;=\sigma^2\mathbf{(C-(X'X)^{-1}X')(C-(X'X)^{-1}X')'} \\
&amp;= \sigma^2\mathbf{(CC' - CX(X'X)^{-1})-(X'X)^{-1}X'C + (X'X)^{-1}X'X(X'X)^{-1})} \\
&amp;= \sigma^2 (\mathbf{CC' - (X'X)^{-1}-(X'X)^{-1} + (X'X)^{-1}}) \\
&amp;= \sigma^2\mathbf{CC'} - \sigma^2(\mathbf{X'X})^{-1} \\
&amp;= Var(\tilde{\beta}|\mathbf{X}) - Var(\hat{\beta}|\mathbf{X})
\end{aligned}
\]</span></p>
<p><strong>Hierarchy of OLS Assumptions</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="24%">
<col width="24%">
<col width="27%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>Identification Data Description</th>
<th>Unbiasedness Consistency</th>
<th>
<a href="#gauss-%20markov-theorem">Gauss- Markov</a> (BLUE) Asymptotic Inference (z and Chi-squared)</th>
<th>Classical LM (BUE) Small-sample Inference (t and F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Variation in <span class="math inline">\(\mathbf{X}\)</span>
</td>
<td>Variation in <span class="math inline">\(\mathbf{X}\)</span>
</td>
<td>Variation in <span class="math inline">\(\mathbf{X}\)</span>
</td>
<td>Variation in <span class="math inline">\(\mathbf{X}\)</span>
</td>
</tr>
<tr class="even">
<td></td>
<td>Random Sampling</td>
<td>Random Sampling</td>
<td>Random Sampling</td>
</tr>
<tr class="odd">
<td></td>
<td>Linearity in Parameters</td>
<td>Linearity in Parameters</td>
<td>Linearity in Parameters</td>
</tr>
<tr class="even">
<td></td>
<td>Zero Conditional Mean</td>
<td>Zero Conditional Mean</td>
<td>Zero Conditional Mean</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td>
<span class="math inline">\(\mathbf{H}\)</span> homoskedasticity</td>
<td>
<span class="math inline">\(\mathbf{H}\)</span> homoskedasticity</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td>Normality of Errors</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="variable-selection" class="section level3" number="5.1.5">
<h3>
<span class="header-section-number">5.1.5</span> Variable Selection<a class="anchor" aria-label="anchor" href="#variable-selection"><i class="fas fa-link"></i></a>
</h3>
<p>depends on</p>
<ul>
<li>Objectives or goals</li>
<li>Previously acquired expertise</li>
<li>Availability of data</li>
<li>Availability of computer software</li>
</ul>
<p>Let <span class="math inline">\(P - 1\)</span> be the number of possible <span class="math inline">\(X\)</span> variables</p>
<div id="mallowss-c_p-statistic" class="section level4" number="5.1.5.1">
<h4>
<span class="header-section-number">5.1.5.1</span> Mallows’s <span class="math inline">\(C_p\)</span> Statistic<a class="anchor" aria-label="anchor" href="#mallowss-c_p-statistic"><i class="fas fa-link"></i></a>
</h4>
<p>(Mallows, 1973, Technometrics, 15, 661-675)</p>
<p>A measure of the predictive ability of a fitted model</p>
<p>Let <span class="math inline">\(\hat{Y}_{ip}\)</span> be the predicted value of <span class="math inline">\(Y_i\)</span> using the model with <span class="math inline">\(p\)</span> parameters.</p>
<p>The total standardized mean square error of prediction is:</p>
<p><span class="math display">\[
\begin{aligned}
\Gamma_p &amp;= \frac{\sum_{i=1}^n E(\hat{Y}_{ip}-E(Y_i))^2}{\sigma^2} \\
&amp;= \frac{\sum_{i=1}^n [E(\hat{Y}_{ip})-E(Y_i)]^2+\sum_{i=1}^n var(\hat{Y}_{ip})}{\sigma^2}
\end{aligned}
\]</span></p>
<p>the first term in the numerator is the (bias)^2 term and the 2nd term is the prediction variance term.</p>
<ul>
<li>bias term decreases as more variables are added to the model.<br>
</li>
<li>if we assume the full model <span class="math inline">\((p=P)\)</span> is the true model, then <span class="math inline">\(E(\hat{Y}_{ip}) - E(Y_i) = 0\)</span> and the bias is 0.<br>
</li>
<li>Prediction variance increase as more variables are added to the model <span class="math inline">\(\sum var(\hat{Y}_{ip}) = p \sigma^2\)</span><br>
</li>
<li>thus, a tradeoff between bias and variance terns is achieved by minimizing <span class="math inline">\(\Gamma_p\)</span>.<br>
</li>
<li>Since <span class="math inline">\(\Gamma_p\)</span> is unknown (due to <span class="math inline">\(\beta\)</span>). we use an estimate: <span class="math inline">\(C_p = \frac{SSE_p}{\hat{\sigma^2}}- (n-2p)\)</span> which is an unbiased estimate of <span class="math inline">\(\Gamma_p\)</span><br>
</li>
<li>As more variables are added to the model, the <span class="math inline">\(SSE_p\)</span> decreases but 2p increases. where <span class="math inline">\(\hat{\sigma^2}=MSE(X_1,..,X_{P-1})\)</span> the MSE with all possible X variables in the model.<br>
</li>
<li>when there is no bias then <span class="math inline">\(E(C_p) \approx p\)</span>. Thus, good models have <span class="math inline">\(C_p\)</span> close to p.<br>
</li>
<li>Prediction: consider models with <span class="math inline">\(C_p \le p\)</span><br>
</li>
<li>Parameter estimation: consider models with <span class="math inline">\(C_p \le 2p -(P-1)\)</span>. Fewer variables should be eliminated from the model to avoid excess bias in the estimates.</li>
</ul>
</div>
<div id="akaike-information-criterion-aic" class="section level4" number="5.1.5.2">
<h4>
<span class="header-section-number">5.1.5.2</span> Akaike Information Criterion (AIC)<a class="anchor" aria-label="anchor" href="#akaike-information-criterion-aic"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
AUC = n ln(\frac{SSE_p}{n}) + 2p
\]</span></p>
<ul>
<li>increasing <span class="math inline">\(p\)</span> (number of parameters) leads first-term decreases, and second-term increases.</li>
<li>We want model with small values of AIC. If the AIC increases when a parameter is added to the model, that parameter is not needed.</li>
<li>AIC represents a tradeoff between precision of fit against the number of parameters used.</li>
</ul>
</div>
<div id="bayes-or-schwarz-information-criterion" class="section level4" number="5.1.5.3">
<h4>
<span class="header-section-number">5.1.5.3</span> Bayes (or Schwarz) Information Criterion<a class="anchor" aria-label="anchor" href="#bayes-or-schwarz-information-criterion"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
BIC = n \ln(\frac{SSE_p}{n})+ (\ln n)p
\]</span></p>
<p>The coefficient in front of p tends to penalize more heavily models with a larger number of parameters (as compared to AIC).</p>
</div>
<div id="prediction-error-sum-of-squares-press" class="section level4" number="5.1.5.4">
<h4>
<span class="header-section-number">5.1.5.4</span> Prediction Error Sum of Squares (PRESS)<a class="anchor" aria-label="anchor" href="#prediction-error-sum-of-squares-press"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
PRESS_p = \sum_{i=1}^{n} (Y_i - \hat{Y}_{i(i)})^2
\]</span></p>
<p>where <span class="math inline">\(\hat{Y}_{i(i)}\)</span> is the prediction of the i-th response when the i-th observation is not used, obtained for the model with p parameters.</p>
<ul>
<li>evaluates the predictive ability of a postulated model by omitting one observation at a time.<br>
</li>
<li>We want small <span class="math inline">\(PRESS_p\)</span> values<br>
</li>
<li>It can be computationally intensive when you have large p.</li>
</ul>
</div>
<div id="best-subsets-algorithm" class="section level4" number="5.1.5.5">
<h4>
<span class="header-section-number">5.1.5.5</span> Best Subsets Algorithm<a class="anchor" aria-label="anchor" href="#best-subsets-algorithm"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>“leap and bounds” algorithm of <span class="citation">(<a href="references.html#ref-furnival2000regressions">Furnival and Wilson 2000</a>)</span> combines comparison of SSE for different subset models with control over the sequence in which the subset regression are computed.<br>
</li>
<li>Guarantees finding the best m subset regressions within each subset size with less computational burden than all possible subsets.</li>
</ul>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"leaps"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/leaps/man/regsubsets.html">regsubsets</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="stepwise-selection-procedures" class="section level4" number="5.1.5.6">
<h4>
<span class="header-section-number">5.1.5.6</span> Stepwise Selection Procedures<a class="anchor" aria-label="anchor" href="#stepwise-selection-procedures"><i class="fas fa-link"></i></a>
</h4>
<p>The <strong>forward stepwise</strong> procedure:</p>
<ul>
<li>finds a plausible subset sequentially.</li>
<li>at each step, a variable is added or deleted.</li>
<li>criterion for adding or deleting is based on SSE, <span class="math inline">\(R^2\)</span>, t, or F-statistic.</li>
</ul>
<p>Note:</p>
<ul>
<li>Instead of using exact F-values, computer packages usually specify the equivalent “significance” level. For example, SLE is the “significance” level to enter, and SLS is the “significance” level to stay. The SLE and SLS are guides rather than true tests of significance.<br>
</li>
<li>The choice of SLE and SLS represents a balancing of opposing tendencies. Use of large SLE values tends to result in too many predictor variables; models with small SLE tend to be under-specified resulting in <span class="math inline">\(\sigma^2\)</span> being badly overestimated.<br>
</li>
<li>As for choice of SLE, can choose between 0.05 and 0.5.<br>
</li>
<li>If SLE &gt; SLS then a cycling pattern may occur. Although most computer packages can detect can stop when it happens. A quick fix: SLS = SLE /2 <span class="citation">(<a href="references.html#ref-bendel1977comparison">Bendel and Afifi 1977</a>)</span>.<br>
</li>
<li>If SLE &lt; SLS then the procedure is conservative and may lead variables with low contribution to be retained.<br>
</li>
<li>Order of variable entry does not matter.</li>
</ul>
<p>Automated Selection Procedures:</p>
<ul>
<li>Forward selection: Same idea as forward stepwise except it doesn’t test if variables should be dropped once enter. (not as good as forward stepwise).<br>
</li>
<li>Backward Elimination: begin with all variables and identifies the one with the smallest F-value to be dropped.</li>
</ul>
</div>
</div>
<div id="diagnostics-1" class="section level3" number="5.1.6">
<h3>
<span class="header-section-number">5.1.6</span> Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics-1"><i class="fas fa-link"></i></a>
</h3>
<div id="normality-of-errors" class="section level4" number="5.1.6.1">
<h4>
<span class="header-section-number">5.1.6.1</span> Normality of errors<a class="anchor" aria-label="anchor" href="#normality-of-errors"><i class="fas fa-link"></i></a>
</h4>
<p>could use <a href="descriptive-stat.html#methods-based-on-normal-probability-plot">Methods based on normal probability plot</a> or <a href="descriptive-stat.html#methods-based-on-empirical-cumulative-distribution-function">Methods based on empirical cumulative distribution function</a></p>
<p>or plots such as</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="05-regression_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="influential-observationsoutliers" class="section level4" number="5.1.6.2">
<h4>
<span class="header-section-number">5.1.6.2</span> Influential observations/outliers<a class="anchor" aria-label="anchor" href="#influential-observationsoutliers"><i class="fas fa-link"></i></a>
</h4>
<div id="hat-matrix" class="section level5" number="5.1.6.2.1">
<h5>
<span class="header-section-number">5.1.6.2.1</span> Hat matrix<a class="anchor" aria-label="anchor" href="#hat-matrix"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[
\mathbf{H = X(X'X)^{-1}}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{\hat{Y}= HY, e = (I-H)Y}\)</span> and <span class="math inline">\(var(\mathbf{e}) = \sigma^2 (\mathbf{I-H})\)</span></p>
<ul>
<li>
<span class="math inline">\(\sigma^2(e_i) = \sigma^2 (1-h_{ii})\)</span>, where <span class="math inline">\(h_{ii}\)</span> is the <span class="math inline">\(i\)</span>-th element of the main diagonal of <span class="math inline">\(\mathbf{H}\)</span> (must be between 0 and 1).<br>
</li>
<li>
<span class="math inline">\(\sum_{i=1}^{n} h_{ii} = p\)</span><br>
</li>
<li>
<span class="math inline">\(cov(e_i,e_j) = -h_{ii}\sigma^2\)</span> where <span class="math inline">\(i \neq j\)</span><br>
</li>
<li>Estimate: <span class="math inline">\(s^2(e_i) = MSE (1-h_{ii})\)</span><br>
</li>
<li>Estimate: <span class="math inline">\(\hat{cov}(e_i,e_j) = -h_{ij}(MSE)\)</span>; if model assumption are correct, this covariance is very small for large data sets.<br>
</li>
<li>If <span class="math inline">\(\mathbf{x}_i = [1 X_{i,1} ... X_{i,p-1}]'\)</span> (the vector of X-values for a given response), then <span class="math inline">\(h_{ii} = \mathbf{x_i'(X'X)^{-1}x_i}\)</span> (depends on relative positions of the design points <span class="math inline">\(X_{i,1},...,X_{i,p-1}\)</span>)</li>
</ul>
</div>
<div id="studentized-residuals" class="section level5" number="5.1.6.2.2">
<h5>
<span class="header-section-number">5.1.6.2.2</span> Studentized Residuals<a class="anchor" aria-label="anchor" href="#studentized-residuals"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[
\begin{aligned}
r_i &amp;= \frac{e_i}{s(e_i)} \\
r_i &amp;\sim N(0,1)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(s(e_i) = \sqrt{MSE(1-h_{ii})}\)</span>. <span class="math inline">\(r_i\)</span> is called the studentized residual or standardized residual.</p>
<ul>
<li>you can use the semi-studentized residual before, <span class="math inline">\(e_i^*= e_i \sqrt{MSE}\)</span>. This doesn’t take into account the different variances for each <span class="math inline">\(e_i\)</span>.</li>
</ul>
<p>We would want to see the model without a particular value. You delete the <span class="math inline">\(i\)</span>-th case, fit the regression to the remaining <span class="math inline">\(n-1\)</span> cases, get estimated responses for the <span class="math inline">\(i\)</span>-th case, <span class="math inline">\(\hat{Y}_{i(i)}\)</span>, and find the difference, called the <strong>deleted residual</strong>:</p>
<p><span class="math display">\[
\begin{aligned}
d_i &amp;= Y_i - \hat{Y}_{i(i)} \\
&amp;= \frac{e_i}{1-h_{ii}}
\end{aligned}
\]</span></p>
<p>we don’t need to recompute the regression model for each case</p>
<p>As <span class="math inline">\(h_{ii}\)</span> increases, <span class="math inline">\(d_i\)</span> increases.</p>
<p><span class="math display">\[
s^2(d_i)= \frac{MSE_{(i)}}{1-h_{ii}}
\]</span></p>
<p>where <span class="math inline">\(MSE_{(i)}\)</span> is the mean square error when the i-th case is omitted.</p>
<p>Let</p>
<p><span class="math display">\[
t_i = \frac{d_i}{s(d_i)} = \frac{e_i}{\sqrt{MSE_{(i)}(1-h_{ii})}}
\]</span></p>
<p>be the <strong>studentized deleted residual</strong>, which follows a t-distribution with <span class="math inline">\(n-p-1\)</span> df.</p>
<p><span class="math display">\[
(n-p)MSE = (n-p-1)MSE_{(i)}+ \frac{e^2_{i}}{1-h_{ii}}
\]</span></p>
<p>hence, we do not need to fit regressions for each case and</p>
<p><span class="math display">\[
t_i = e_i (\frac{n-p-1}{SSE(1-h_{ii})-e^2_i})^{1/2}
\]</span></p>
<p>The outlying <span class="math inline">\(Y\)</span>-observations are those cases whose studentized deleted residuals are large in absolute value. If there are many residuals to consider, a Bonferroni critical value can be can (<span class="math inline">\(t_{1-\alpha/2n;n-p-1}\)</span>)</p>
<p><strong>Outlying X Observations</strong></p>
<p>Recall, <span class="math inline">\(0 \le h_{ii} \le 1\)</span> and <span class="math inline">\(\sum_{i=1}^{n}h_{ii}=p\)</span> (the total number of parameters)</p>
<p>A large <span class="math inline">\(h_{ii}\)</span> indicates that the <span class="math inline">\(i\)</span>-th case is distant from the center of all <span class="math inline">\(X\)</span> observations (the <strong>leverage</strong> of the <span class="math inline">\(i\)</span>-th case). That is, a large value suggests that the observation exercises substantial leverage in determining the fitted value <span class="math inline">\(\hat{Y}_i\)</span></p>
<p>We have <span class="math inline">\(\mathbf{\hat{Y}=HY}\)</span>, a linear combination of Y-values; <span class="math inline">\(h_{ii}\)</span> is the weight of the observation <span class="math inline">\(Y_i\)</span>; so <span class="math inline">\(h_{ii}\)</span> measures the role of the X values in determining how important <span class="math inline">\(Y_i\)</span> is in affecting the <span class="math inline">\(\hat{Y}_i\)</span>.</p>
<p>Large <span class="math inline">\(h_{ii}\)</span> implies <span class="math inline">\(var(e_i)\)</span> is small, so larger <span class="math inline">\(h_{ii}\)</span> implies that <span class="math inline">\(\hat{Y}_i\)</span> is close to <span class="math inline">\(Y_i\)</span></p>
<ul>
<li>small data sets: <span class="math inline">\(h_{ii} &gt; .5\)</span> suggests “large”.<br>
</li>
<li>large data sets: <span class="math inline">\(h_{ii} &gt; \frac{2p}{n}\)</span> is “large.</li>
</ul>
<p>Using the hat matrix to identify extrapolation:</p>
<ul>
<li>Let <span class="math inline">\(\mathbf{x_{new}}\)</span> be a vector containing the X values for which an inference about a mean response or a new observation is to be made.<br>
</li>
<li>Let <span class="math inline">\(\mathbf{X}\)</span> be the data design matrix used to fit the data. Then, if <span class="math inline">\(h_{new,new} = \mathbf{x_{new}(X'X)^{-1}x_{new}}\)</span> is within the range of leverage values (<span class="math inline">\(h_{ii}\)</span>) for cases in the data set, no extrapolation is involved; otherwise; extrapolation is indicated.</li>
</ul>
<p><strong>Identifying Influential Cases</strong>:</p>
<p>by influential we mean that exclusion of an observation causes major changes int he fitted regression. (not all outliers are influential)</p>
<ul>
<li>Influence on Single Fitted Values: <a href="linear-regression.html#dffits">DFFITS</a>
</li>
<li>Influence on All Fitted Values: <a href="linear-regression.html#cooks-d">Cook’s D</a>
</li>
<li>Influence on the Regression Coefficients: <a href="linear-regression.html#dfbetas">DFBETAS</a>
</li>
</ul>
</div>
<div id="dffits" class="section level5" number="5.1.6.2.3">
<h5>
<span class="header-section-number">5.1.6.2.3</span> DFFITS<a class="anchor" aria-label="anchor" href="#dffits"><i class="fas fa-link"></i></a>
</h5>
<p>Influence on Single Fitted Values: <a href="linear-regression.html#dffits">DFFITS</a></p>
<p><span class="math display">\[
\begin{aligned}
(DFFITS)_i &amp;= \frac{\hat{Y}_i - \hat{Y}_{i(i)}}{\sqrt{MSE_{(i)}h_{ii}}} \\
&amp;= t_i (\frac{h_{ii}}{1-h_{ii}})^{1/2}
\end{aligned}
\]</span></p>
<ul>
<li><p>the standardized difference between the i-th fitted value with all observations and with the i-th case removed.</p></li>
<li><p>studentized deleted residual multiplied by a factor that is a function fo the i-th leverage value.</p></li>
<li>
<p>influence if:</p>
<ul>
<li>small to medium data sets: <span class="math inline">\(|DFFITS|&gt;1\)</span>
</li>
<li>large data sets: <span class="math inline">\(|DFFITS|&gt; 2 \sqrt{p/n}\)</span>
</li>
</ul>
</li>
</ul>
</div>
<div id="cooks-d" class="section level5" number="5.1.6.2.4">
<h5>
<span class="header-section-number">5.1.6.2.4</span> Cook’s D<a class="anchor" aria-label="anchor" href="#cooks-d"><i class="fas fa-link"></i></a>
</h5>
<p>Influence on All Fitted Values: <a href="linear-regression.html#cooks-d">Cook’s D</a></p>
<p><span class="math display">\[
\begin{aligned}
D_i &amp;= \frac{\sum_{j=1}^{n}(\hat{Y}_j - \hat{Y}_{j(i)})^2}{p(MSE)} \\
&amp;= \frac{e^2_i}{p(MSE)}(\frac{h_{ii}}{(1-h_{ii})^2})
\end{aligned}
\]</span></p>
<p>gives the influence of i-th case on all fitted values.</p>
<p>If <span class="math inline">\(e_i\)</span> increases or <span class="math inline">\(h_{ii}\)</span> increases, then <span class="math inline">\(D_i\)</span> increases.</p>
<p><span class="math inline">\(D_i\)</span> is a percentile of an <span class="math inline">\(F_{(p,n-p)}\)</span> distribution. If the percentile is greater than <span class="math inline">\(.5(50\%)\)</span> then the <span class="math inline">\(i\)</span>-th case has major influence. In practice, if <span class="math inline">\(D_i &gt;4/n\)</span>, then the <span class="math inline">\(i\)</span>-th case has major influence.</p>
</div>
<div id="dfbetas" class="section level5" number="5.1.6.2.5">
<h5>
<span class="header-section-number">5.1.6.2.5</span> DFBETAS<a class="anchor" aria-label="anchor" href="#dfbetas"><i class="fas fa-link"></i></a>
</h5>
<p>Influence on the Regression Coefficients: <a href="linear-regression.html#dfbetas">DFBETAS</a></p>
<p><span class="math display">\[
(DFBETAS)_{k(i)} = \frac{b_k - b_{k(i)}}{\sqrt{MSE_{(i)}c_{kk}}}
\]</span></p>
<p>for <span class="math inline">\(k = 0,...,p-1\)</span> and <span class="math inline">\(c_{kk}\)</span> is the k-th diagonal element of <span class="math inline">\(\mathbf{X'X}^{-1}\)</span></p>
<p>Influence of the <span class="math inline">\(i\)</span>-th case on each regression coefficient <span class="math inline">\(b_k\)</span> <span class="math inline">\((k=0,\dots,p-1)\)</span> is the difference between the estimated regression coefficients based on all <span class="math inline">\(n\)</span> cases and the regression coefficients obtained when the <span class="math inline">\(i\)</span>-th case is omitted (<span class="math inline">\(b_{k(i)}\)</span>)</p>
<ul>
<li>small data sets: <span class="math inline">\(|DFBETA|&gt;1\)</span>
</li>
<li>large data sets: <span class="math inline">\(|DFBETA| &gt; 2\sqrt{n}\)</span>
</li>
<li>Sign of DFBETA inculcates whether inclusion of a case leads to an increase or a decrease in estimates of the regression coefficient.</li>
</ul>
</div>
</div>
<div id="collinearity" class="section level4" number="5.1.6.3">
<h4>
<span class="header-section-number">5.1.6.3</span> Collinearity<a class="anchor" aria-label="anchor" href="#collinearity"><i class="fas fa-link"></i></a>
</h4>
<p>Multicollinearity refers to correlation among explanatory variables.</p>
<ul>
<li>large changes in the estimated regression coefficient when a predictor variable is added or deleted, or when an observation is altered or deleted.<br>
</li>
<li>non insignificant results in individual tests on regression coefficients for important predictor variables.<br>
</li>
<li>estimated regression coefficients with an algebraic sign that is the opposite of that expected from theoretical consideration or prior experience.<br>
</li>
<li>large coefficients of simple correlation between pairs of predictor variables in the correlation matrix.<br>
</li>
<li>wide confidence intervals for the regression coefficients representing important predictor variables.</li>
</ul>
<p>When some of <span class="math inline">\(X\)</span> variables are so highly correlated that the inverse <span class="math inline">\((X'X)^{-1}\)</span> does not exist or is very computationally unstable.</p>
<p>Correlated Predictor Variables: if some X variables are “perfectly” correlated, the system is undetermined and there are an infinite number of models that fit the data. That is, if <span class="math inline">\(X'X\)</span> is singular, then <span class="math inline">\((X'X)^{-1}\)</span> doesn’t exist. Then,</p>
<ul>
<li>parameters cannot be interpreted (<span class="math inline">\(\mathbf{b = (X'X)^{-1}X'y}\)</span>)<br>
</li>
<li>sampling variability is infinite (<span class="math inline">\(\mathbf{s^2(b) = MSE (X'X)^{-1}}\)</span>)</li>
</ul>
<div id="vifs" class="section level5" number="5.1.6.3.1">
<h5>
<span class="header-section-number">5.1.6.3.1</span> VIFs<a class="anchor" aria-label="anchor" href="#vifs"><i class="fas fa-link"></i></a>
</h5>
<p>Let <span class="math inline">\(R^2_k\)</span> be the coefficient of multiple determination when <span class="math inline">\(X_k\)</span> is regressed on the <span class="math inline">\(p - 2\)</span> other <span class="math inline">\(X\)</span> variables in the model. Then,</p>
<p><span class="math display">\[
VIF_k = \frac{1}{1-R^2_k}
\]</span></p>
<ul>
<li>large values indicate that a near collinearity is causing the variance of <span class="math inline">\(b_k\)</span> to be inflated, <span class="math inline">\(var(b_k) \propto \sigma^2 (VIF_k)\)</span><br>
</li>
<li>Typically, the rule of thumb is that <span class="math inline">\(VIF &gt; 4\)</span> mean you should see why this is the case, and <span class="math inline">\(VIF_k &gt; 10\)</span> indicates a serious problem collinearity problem that could result in poor parameters estimates.<br>
</li>
<li>the mean of all VIF’s provide an estimate of the ratio of the true multicollinearity to a model where the <span class="math inline">\(X\)</span> variables are uncorrelated<br>
</li>
<li>serious multicollinearity if <span class="math inline">\(avg(VIF) &gt;&gt;1\)</span>
</li>
</ul>
</div>
<div id="condition-number" class="section level5" number="5.1.6.3.2">
<h5>
<span class="header-section-number">5.1.6.3.2</span> Condition Number<a class="anchor" aria-label="anchor" href="#condition-number"><i class="fas fa-link"></i></a>
</h5>
<p><strong>Condition Number</strong></p>
<p>spectral decomposition</p>
<p><span class="math display">\[
\mathbf{X'X}= \sum_{i=1}^{p} \lambda_i \mathbf{u_i u_i'}
\]</span></p>
<p>where <span class="math inline">\(\lambda_i\)</span> is the eigenvalue and <span class="math inline">\(\mathbf{u}_i\)</span> is the eigenvector. <span class="math inline">\(\lambda_1 &gt; ...&gt;\lambda_p\)</span> and the eigenvecotrs are orthogonal:</p>
<p><span class="math display">\[
\begin{cases}
\mathbf{u_i'u_j} =
0&amp;\text{for $i \neq j$}\\
1&amp;\text{for $i =j$}\\
\end{cases}
\]</span></p>
<p>The condition number is then</p>
<p><span class="math display">\[
k = \sqrt{\frac{\lambda_{max}}{\lambda_{min}}}
\]</span></p>
<ul>
<li>values <span class="math inline">\(k&gt;30\)</span> are cause for concern<br>
</li>
<li>values <span class="math inline">\(30&lt;k&lt;100\)</span> imply moderate dependencies.<br>
</li>
<li>values <span class="math inline">\(k&gt;100\)</span> imply strong collinearity</li>
</ul>
<p><strong>Condition index</strong></p>
<p><span class="math display">\[
\delta_i = \sqrt{\frac{\lambda_{max}}{\lambda_i}}
\]</span></p>
<p>where <span class="math inline">\(i = 1,...,p\)</span></p>
<p>we can find the proportion of the total variance associated with the k-th regression coefficient and the i-th eigen mode:</p>
<p><span class="math display">\[
\frac{u_{ik}^2/\lambda_i}{\sum_j (u^2_{jk}/\lambda_j)}
\]</span></p>
<p>These variance proportions can be helpful for identifying serious collinearity</p>
<ul>
<li>the condition index must be large</li>
<li>the variance proportions must be large (&gt;,5) for at least two regression coefficients.</li>
</ul>
</div>
</div>
<div id="constancy-of-error-variance" class="section level4" number="5.1.6.4">
<h4>
<span class="header-section-number">5.1.6.4</span> Constancy of Error Variance<a class="anchor" aria-label="anchor" href="#constancy-of-error-variance"><i class="fas fa-link"></i></a>
</h4>
<div id="brown-forsythe-test-modified-levene-test" class="section level5" number="5.1.6.4.1">
<h5>
<span class="header-section-number">5.1.6.4.1</span> Brown-Forsythe Test (Modified Levene Test)<a class="anchor" aria-label="anchor" href="#brown-forsythe-test-modified-levene-test"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>Does not depend on normality<br>
</li>
<li>Applicable when error variance increases or decreases with <span class="math inline">\(X\)</span><br>
</li>
<li>relatively large sample size needed (so we can ignore dependency between residuals)<br>
</li>
<li>Split residuals into 2 groups (<span class="math inline">\(e_{i1}, i = 1, ..., n_1; e_{i2}, j=1,...,n_2\)</span>)<br>
</li>
<li>Let <span class="math inline">\(d_{i1}= |e_{i1}-\tilde{e}_{1}|\)</span> where <span class="math inline">\(\tilde{e}_{1}\)</span> is the median of group 1.<br>
</li>
<li>Let <span class="math inline">\(d_{j2}=|e_{j2}-\tilde{e}_{2}|\)</span>.<br>
</li>
<li>Then, a 2-sample t-test:<br><span class="math display">\[
t_L = \frac{\bar{d}_1 - \bar{d}_2}{s\sqrt{1/n_1+1/n_2}}
\]</span> where <span class="math display">\[
s^2 = \frac{\sum_i(d_{i1}-\bar{d}_1)^2+\sum_j(d_{j2}-\bar{d}_2)^2}{n-2}
\]</span> If <span class="math inline">\(|t_L|&gt;t_{1-\alpha/2;n-2}\)</span> conclude the error variance is not constant.</li>
</ul>
</div>
<div id="breusch-pagan-test-cook-weisberg-test" class="section level5" number="5.1.6.4.2">
<h5>
<span class="header-section-number">5.1.6.4.2</span> Breusch-Pagan Test (Cook-Weisberg Test)<a class="anchor" aria-label="anchor" href="#breusch-pagan-test-cook-weisberg-test"><i class="fas fa-link"></i></a>
</h5>
<p>Assume the error terms are independent and normally distributed, and</p>
<p><span class="math display">\[
\sigma^2_i = \gamma_0 + \gamma_1 X_i
\]</span></p>
<p>Constant error variance corresponds to <span class="math inline">\(\gamma_1 = 0\)</span>, i.e., test</p>
<ul>
<li><span class="math inline">\(H_0: \gamma_1 =0\)</span></li>
<li><span class="math inline">\(H_1: \gamma_1 \neq 0\)</span></li>
</ul>
<p>by regressing the squared residuals on X in the usual manner. Obtain the regression sum of squares from this: <span class="math inline">\(SSR^*\)</span> (the SSR from the regression of <span class="math inline">\(e^2_i\)</span> on <span class="math inline">\(X_i\)</span>). Then, define</p>
<p><span class="math display">\[
X^2_{BP} = \frac{SSR^*/2}{(SSE/n)^2}
\]</span></p>
<p>where SSE is the error sum of squares from the regression of Y on X.</p>
<p>If <span class="math inline">\(H_0: \gamma_1 = 0\)</span> holds and n is reasonably large, <span class="math inline">\(X^2_{BP}\)</span> follows approximately the <span class="math inline">\(\chi^2\)</span> distribution with 1 d.f. We reject <span class="math inline">\(H_0\)</span> (Homogeneous variance) if <span class="math inline">\(X^2_{BP} &gt; \chi^2_{1-\alpha;1}\)</span></p>
</div>
</div>
<div id="independence" class="section level4" number="5.1.6.5">
<h4>
<span class="header-section-number">5.1.6.5</span> Independence<a class="anchor" aria-label="anchor" href="#independence"><i class="fas fa-link"></i></a>
</h4>
<div id="plots" class="section level5" number="5.1.6.5.1">
<h5>
<span class="header-section-number">5.1.6.5.1</span> Plots<a class="anchor" aria-label="anchor" href="#plots"><i class="fas fa-link"></i></a>
</h5>
</div>
<div id="durbin-watson" class="section level5" number="5.1.6.5.2">
<h5>
<span class="header-section-number">5.1.6.5.2</span> Durbin-Watson<a class="anchor" aria-label="anchor" href="#durbin-watson"><i class="fas fa-link"></i></a>
</h5>
</div>
<div id="time-series" class="section level5" number="5.1.6.5.3">
<h5>
<span class="header-section-number">5.1.6.5.3</span> Time-series<a class="anchor" aria-label="anchor" href="#time-series"><i class="fas fa-link"></i></a>
</h5>
</div>
<div id="spatial-statistics" class="section level5" number="5.1.6.5.4">
<h5>
<span class="header-section-number">5.1.6.5.4</span> Spatial Statistics<a class="anchor" aria-label="anchor" href="#spatial-statistics"><i class="fas fa-link"></i></a>
</h5>
</div>
</div>
</div>
<div id="model-validation" class="section level3" number="5.1.7">
<h3>
<span class="header-section-number">5.1.7</span> Model Validation<a class="anchor" aria-label="anchor" href="#model-validation"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>split data into 2 groups: training (model building) sample and validation (prediction) sample.<br></p></li>
<li>
<p>the model MSE will tend to underestimate the inherent variability in making future predictions. to consider actual predictive ability, consider mean squared prediction error (MSPE):<br><span class="math display">\[
MSPE = \frac{\sum_{i=1}^{n} (Y_i- \hat{Y}_i)^2}{n^*}
\]</span></p>
<ul>
<li>where <span class="math inline">\(Y_i\)</span> is the known value of the response variable in the <span class="math inline">\(i\)</span>-th validation case.</li>
<li>
<span class="math inline">\(\hat{Y}_i\)</span> is the predicted value based on a model fit with the training data set.</li>
<li>
<span class="math inline">\(n^*\)</span> is the number of cases in the validation set.</li>
</ul>
</li>
<li><p>we want MSPE to be close to MSE (in which MSE is not biased); so look at the the ratio MSPE / MSE (closer to 1, the better).</p></li>
</ul>
</div>
<div id="finite-sample-properties" class="section level3" number="5.1.8">
<h3>
<span class="header-section-number">5.1.8</span> Finite Sample Properties<a class="anchor" aria-label="anchor" href="#finite-sample-properties"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><span class="math inline">\(n\)</span> is fixed</p></li>
<li>
<p><strong>Bias</strong> On average, how close is our estimate to the true value</p>
<ul>
<li><p><span class="math inline">\(Bias = E(\hat{\beta}) -\beta\)</span> where <span class="math inline">\(\beta\)</span> is the true parameter value and <span class="math inline">\(\hat{\beta}\)</span> is the estimator for <span class="math inline">\(\beta\)</span></p></li>
<li>
<p>An estimator is <strong>unbiased</strong> when</p>
<ul>
<li>
<span class="math inline">\(Bias = E(\hat{\beta}) -\beta = 0\)</span> or <span class="math inline">\(E(\hat{\beta})=\beta\)</span>
</li>
<li>means that the estimator will produce estimates that are, on average, equal to the value it it trying to estimate</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Distribution of an estimator</strong>: An estimator is a function of random variables (data)</p></li>
<li><p><strong>Standard Deviation</strong>: the spread of the estimator.</p></li>
</ul>
<p><strong>OLS</strong></p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a> <a href="linear-regression.html#a2-full-rank">A2</a> <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a>, OLS is unbiased</p>
<p><span class="math display">\[
\begin{aligned}
E(\hat{\beta}) &amp;= E(\mathbf{(X'X)^{-1}X'y}) &amp;&amp; \text{A2}\\
     &amp;= E(\mathbf{(X'X)^{-1}X'(X\beta + \epsilon)}) &amp;&amp; \text{A1}\\
     &amp;= E(\mathbf{(X'X)^{-1}X'X\beta + (X'X)^{-1}X'\epsilon})  &amp;&amp; \text{} \\
     &amp;= E(\beta + \mathbf{(X'X)^{-1}X'\epsilon}) \\
     &amp;= \beta + E(\mathbf{(X'X^{-1}\epsilon)}) \\
     &amp;= \beta + E(E((\mathbf{X'X)^{-1}X'\epsilon|X})) &amp;&amp;\text{LIE} \\
     &amp;= \beta + E((\mathbf{X'X)^{-1}X'}E\mathbf{(\epsilon|X})) \\
     &amp;= \beta + E((\mathbf{X'X)^{-1}X'}0)) &amp;&amp; \text{A3} \\
     &amp;= \beta
\end{aligned}
\]</span></p>
<p>where LIE stands for <a href="prerequisites.html#law-of-iterated-expectation">Law of Iterated Expectation</a></p>
<p>If <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> does not hold, then OLS will be <strong>biased</strong></p>
<p>From <strong>Frisch-Waugh-Lovell Theorem</strong>, if we have the omitted variable <span class="math inline">\(\hat{\beta}_2 \neq 0\)</span> and <span class="math inline">\(\mathbf{X_1'X_2} \neq 0\)</span>, then the omitted variable will cause OLS estimator to be biased.</p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a> <a href="linear-regression.html#a2-full-rank">A2</a> <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> <a href="linear-regression.html#a4-homoskedasticity">A4</a>, we have the conditional variance of the OLS estimator as follows]</p>
<p><span class="math display">\[
\begin{aligned}
Var(\hat{\beta}|\mathbf{X}) &amp;= Var(\beta + \mathbf{(X'X)^{-1}X'\epsilon|X}) &amp;&amp; \text{A1-A2}\\
    &amp;= Var((\mathbf{X'X)^{-1}X'\epsilon|X)} \\
    &amp;= \mathbf{X'X^{-1}X'} Var(\epsilon|\mathbf{X})\mathbf{X(X'X)^{-1}} \\
    &amp;= \mathbf{X'X^{-1}X'} \sigma^2I \mathbf{X(X'X)^{-1}} &amp;&amp; \text{A4} \\
    &amp;= \sigma^2\mathbf{X'X^{-1}X'} I \mathbf{X(X'X)^{-1}} \\
    &amp;= \sigma^2\mathbf{(X'X)^{-1}}
\end{aligned}
\]</span></p>
<p>Sources of variation</p>
<ol style="list-style-type: decimal">
<li>
<p><span class="math inline">\(\sigma^2=Var(\epsilon_i|\mathbf{X})\)</span></p>
<ul>
<li>The amount of unexplained variation <span class="math inline">\(\epsilon_i\)</span> is large relative to the explained <span class="math inline">\(\mathbf{x_i \beta}\)</span> variation</li>
</ul>
</li>
<li>
<p>“Small” <span class="math inline">\(Var(x_{i1}), Var(x_{i1}),..\)</span></p>
<ul>
<li>Not a lot of variation in <span class="math inline">\(\mathbf{X}\)</span> (no information)</li>
<li>small sample size</li>
</ul>
</li>
<li>
<p>“Strong” correlation between the explanatory variables</p>
<ul>
<li>
<span class="math inline">\(x_{i1}\)</span> is highly correlated with a linear combination of 1, <span class="math inline">\(x_{i2}\)</span>, <span class="math inline">\(x_{i3}\)</span>, …</li>
<li>include many irrelevant variables will contribute to this.</li>
<li>If <span class="math inline">\(x_1\)</span> is perfectly determined in the regression <span class="math inline">\(\rightarrow\)</span> <strong>Perfect Collinearity</strong> <span class="math inline">\(\rightarrow\)</span> <a href="linear-regression.html#a2-full-rank">A2</a> is violated.</li>
<li>If <span class="math inline">\(x_1\)</span> is highly correlated with a linear combination of other variables, then we have <strong>Multicollinearity</strong>
</li>
</ul>
</li>
</ol>
<div id="check-for-multicollinearity" class="section level4" number="5.1.8.1">
<h4>
<span class="header-section-number">5.1.8.1</span> Check for Multicollinearity<a class="anchor" aria-label="anchor" href="#check-for-multicollinearity"><i class="fas fa-link"></i></a>
</h4>
<p><strong>Variance Inflation Factor</strong> (VIF) Rule of thumb <span class="math inline">\(VIF \ge 10\)</span> is large</p>
<p><span class="math display">\[
VIF = \frac{1}{1-R_1^2}
\]</span></p>
</div>
<div id="standard-errors" class="section level4" number="5.1.8.2">
<h4>
<span class="header-section-number">5.1.8.2</span> Standard Errors<a class="anchor" aria-label="anchor" href="#standard-errors"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="math inline">\(Var(\hat{\beta}|\mathbf{X})=\sigma^2\mathbf{(X'X)^{-1}}\)</span> is the variance of the estimate <span class="math inline">\(\hat{\beta}\)</span>
</li>
<li>
<strong>Standard Errors</strong> are estimators/estimates of the standard deviation (square root of the variance) of the estimator <span class="math inline">\(\hat{\beta}\)</span>
</li>
<li>Under A1-A5, then we can estimate <span class="math inline">\(\sigma^2=Var(\epsilon^2|\mathbf{X})\)</span> the standard errors as</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
s^2 &amp;= \frac{1}{n-k}\sum_{i=1}^{n}e_i^2 \\
&amp;= \frac{1}{n-k}SSR
\end{aligned}
\]</span></p>
<ul>
<li>degrees of freedom adjustment: because <span class="math inline">\(e_i \neq \epsilon_i\)</span> and are estimated using k estimates for <span class="math inline">\(\beta\)</span>, we lose degrees of freedom in our variance estimate.</li>
<li>
<span class="math inline">\(s=\sqrt{s^2}\)</span> is a biased estimator for the standard deviation ([Jensen’s Inequality])</li>
</ul>
<p><strong>Standard Errors for</strong> <span class="math inline">\(\hat{\beta}\)</span></p>
<p><span class="math display">\[
\begin{aligned}
SE(\hat{\beta}_{j-1})&amp;=s\sqrt{[(\mathbf{X'X})^{-1}]_{jj}} \\
&amp;= \frac{s}{\sqrt{SST_{j-1}(1-R_{j-1}^2)}}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(SST_{j-1}\)</span> and <span class="math inline">\(R_{j-1}^2\)</span> from the following regression</p>
<p><span class="math inline">\(x_{j-1}\)</span> on 1, <span class="math inline">\(x_1\)</span>,… <span class="math inline">\(x_{j-2}\)</span>,<span class="math inline">\(x_j\)</span>,<span class="math inline">\(x_{j+1}\)</span>, …, <span class="math inline">\(x_{k-1}\)</span></p>
<p><strong>Summary of Finite Sample Properties</strong></p>
<ul>
<li>Under A1-A3: OLS is unbiased</li>
<li>Under A1-A4: The variance of the OLS estimator is <span class="math inline">\(Var(\hat{\beta}|\mathbf{X})=\sigma^2\mathbf{(X'X)^{-1}}\)</span>
</li>
<li>Under A1-A4, A6: OLS estimator <span class="math inline">\(\hat{\beta} \sim N(\beta,\sigma^2\mathbf{(X'X)^{-1}})\)</span>
</li>
<li>Under A1-A4, Gauss-Markov Theorem holds <span class="math inline">\(\rightarrow\)</span> OLS is BLUE</li>
<li>Under A1-A5, the above standard errors are unbiased estimator of standard deviation for <span class="math inline">\(\hat{\beta}\)</span>
</li>
</ul>
</div>
</div>
<div id="large-sample-properties" class="section level3" number="5.1.9">
<h3>
<span class="header-section-number">5.1.9</span> Large Sample Properties<a class="anchor" aria-label="anchor" href="#large-sample-properties"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Let <span class="math inline">\(n \rightarrow \infty\)</span>
</li>
<li>A perspective that allows us to evaluate the “quality” of estimators when finite sample properties are not informative, or impossible to compute</li>
<li>Consistency, asymptotic distribution, asymptotic variance</li>
</ul>
<p><strong>Motivation</strong></p>
<ul>
<li>
<a href="linear-regression.html#finite-sample-properties">Finite Sample Properties</a> need strong assumption <a href="linear-regression.html#a1-linearity">A1</a> <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> <a href="linear-regression.html#a4-homoskedasticity">A4</a> <a href="linear-regression.html#a6-normal-distribution">A6</a>
</li>
<li>Other estimation such as GLS, MLE need to be analyzed using <a href="linear-regression.html#large-sample-properties">Large Sample Properties</a>
</li>
</ul>
<p>Let <span class="math inline">\(\mu(\mathbf{X})=E(y|\mathbf{X})\)</span> be the <strong>Conditional Expectation Function</strong></p>
<ul>
<li>
<span class="math inline">\(\mu(\mathbf{X})\)</span> is the minimum mean squared predictor (over all possible functions)</li>
</ul>
<p><span class="math display">\[
minE((y-f(\mathbf{X}))^2)
\]</span></p>
<p>under A1 and A3,</p>
<p><span class="math display">\[
\mu(\mathbf{X})=\mathbf{X}\beta
\]</span></p>
<p>Then the <strong>linear projection</strong></p>
<p><span class="math display">\[
L(y|1,\mathbf{X})=\gamma_0 + \mathbf{X}Var(X)^{-1}Cov(X,Y)
\]</span></p>
<p>where <span class="math inline">\(\mathbf{X}Var(X)^{-1}Cov(X,Y)=\gamma\)</span></p>
<p>is the minimum mean squared linear approximation to be conditional mean function</p>
<p><span class="math display">\[
(\gamma_0,\gamma) = arg min E((E(y|\mathbf{X})-(a+\mathbf{Xb})^2)
\]</span></p>
<ul>
<li>OLS is always <strong>consistent</strong> for the linear projection, but not necessarily unbiased.</li>
<li>Linear projection has no causal interpretation</li>
<li>Linear projection does not depend on assumption A1 and A3</li>
</ul>
<p>Evaluating an estimator using large sample properties:</p>
<ul>
<li>Consistency: measure of centrality</li>
<li>Limiting Distribution: the shape of the scaled estimator as the sample size increases</li>
<li>Asymptotic variance: spread of the estimator with regards to its limiting distribution.</li>
</ul>
<p>An estimator <span class="math inline">\(\hat{\theta}\)</span> is consistent for <span class="math inline">\(\theta\)</span> if <span class="math inline">\(\hat{\theta}_n \to^p \theta\)</span></p>
<ul>
<li>As n increases, the estimator converges to the population parameter value.</li>
<li>Unbiased does not imply consistency and consistency does not imply unbiased.</li>
</ul>
<p>Based on <a href="prerequisites.html#weak-law">Weak Law</a> of Large Numbers</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\beta} &amp;= \mathbf{(X'X)^{-1}X'y} \\
&amp;= \mathbf{(\sum_{i=1}^{n}x_i'x_i)^{-1} \sum_{i=1}^{n}x_i'y_i} \\
&amp;= (n^{-1}\mathbf{\sum_{i=1}^{n}x_i'x_i)^{-1}} n^{-1}\mathbf{\sum_{i=1}^{n}x_i'y_i}
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
plim(\hat{\beta}) &amp;= plim((n^{-1}\mathbf{\sum_{i=1}^{n}x_i'x_i)^{-1}} n^{-1}\mathbf{\sum_{i=1}^{n}x_i'y_i}) \\
&amp;= plim((n^{-1}\mathbf{\sum_{i=1}^{n}x_i'x_i)^{-1}})plim(n^{-1}\mathbf{\sum_{i=1}^{n}x_i'y_i}) \\
&amp;= (plim(n^{-1}\mathbf{\sum_{i=1}^{n}x_i'x_i)^{-1}})plim(n^{-1}\mathbf{\sum_{i=1}^{n}x_i'y_i}) \text{ due to A2, A5} \\
&amp;= E(\mathbf{x_i'x_i})^{-1}E(\mathbf{x_i'y_i})
\end{aligned}
\]</span></p>
<p><span class="math display">\[
E(\mathbf{x_i'x_i})^{-1}E(\mathbf{x_i'y_i}) = \beta + E(\mathbf{x_i'x_i})^{-1}E(\mathbf{x_i'\epsilon_i})
\]</span></p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a>, <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> OLS is consistent, but not guarantee unbiased.</p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a>, <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>, and <span class="math inline">\(\mathbf{x_i'x_i}\)</span> has finite first and second moments (<a href="prerequisites.html#central-limit-theorem">CLT</a>), <span class="math inline">\(Var(\mathbf{x_i'}\epsilon_i)=\mathbf{B}\)</span></p>
<ul>
<li><span class="math inline">\((n^{-1}\sum_{i=1}^{n}\mathbf{x_i'x_i})^{-1} \to^p (E(\mathbf{x'_ix_i}))^{-1}\)</span></li>
<li><span class="math inline">\(\sqrt{n}(n^{-1}\sum_{i=1}^{n}\mathbf{x_i'}\epsilon_i) \to^d N(0,\mathbf{B})\)</span></li>
</ul>
<p><span class="math display">\[
\sqrt{n}(\hat{\beta}-\beta) = (n^{-1}\sum_{i=1}^{n}\mathbf{x_i'x_i})^{-1}\sqrt{n}(n^{-1}\sum_{i=1}^{n}\mathbf{x_i'x_i}) \to^{d} N(0,\Sigma)
\]</span></p>
<p>where <span class="math inline">\(\Sigma=(E(\mathbf{x_i'x_i}))^{-1}\mathbf{B}(E(\mathbf{x_i'x_i}))^{-1}\)</span></p>
<ul>
<li><p>holds under <a href="linear-regression.html#a3a">A3a</a></p></li>
<li>
<p>Do not need <a href="linear-regression.html#a4-homoskedasticity">A4</a> and <a href="linear-regression.html#a6-normal-distribution">A6</a> to apply CLT</p>
<ul>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> does not hold, then <span class="math inline">\(\mathbf{B}=Var(\mathbf{x_i'}\epsilon_i)=\sigma^2E(x_i'x_i)\)</span> which means <span class="math inline">\(\Sigma=\sigma^2(E(\mathbf{x_i'x_i}))^{-1}\)</span>, use standard errors</li>
</ul>
</li>
</ul>
<p>Heteroskedasticity can be from</p>
<ul>
<li>Limited dependent variable</li>
<li>Dependent variables with large/skewed ranges</li>
</ul>
<p>Solving Asymptotic Variance</p>
<p><span class="math display">\[
\begin{aligned}
\Sigma &amp;= (E(\mathbf{x_i'x_i}))^{-1}\mathbf{B}(E(\mathbf{x_i'x_i}))^{-1} \\
&amp;= (E(\mathbf{x_i'x_i}))^{-1}Var(\mathbf{x_i'}\epsilon_i)(E(\mathbf{x_i'x_i}))^{-1} \\
&amp;= (E(\mathbf{x_i'x_i}))^{-1}E[(\mathbf{x_i'}\epsilon_i-0)(\mathbf{x_i'}\epsilon_i-0)](E(\mathbf{x_i'x_i}))^{-1} &amp; \text{A3a} \\
&amp;= (E(\mathbf{x_i'x_i}))^{-1}E[E(\mathbf{\epsilon_i^2|x_i)x_i'x_i]}(E(\mathbf{x_i'x_i}))^{-1} &amp; \text{LIE} \\
&amp;= (E(\mathbf{x_i'x_i}))^{-1}\sigma^2E(\mathbf{x_i'x_i})(E(\mathbf{x_i'x_i}))^{-1} &amp; \text{A4} \\
&amp;= \sigma^2(E(\mathbf{x_i'x_i}))
\end{aligned}
\]</span></p>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a>, <a href="linear-regression.html#a4-homoskedasticity">A4</a>, <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>:</p>
<p><span class="math display">\[
\sqrt{n}(\hat{\beta}-\beta) \to^d N(0,\sigma^2(E(\mathbf{x_i'x_i}))^{-1})
\]</span></p>
<ul>
<li>The Asymptotic variance is approximation for the variance in the scaled random variable for <span class="math inline">\(\sqrt{n}(\hat{\beta}-\beta)\)</span> when n is large.</li>
<li>use <span class="math inline">\(Avar(\sqrt{n}(\hat{\beta}-\beta))/n\)</span> as an approximation for finite sample variance for large n:</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
Avar(\sqrt{n}(\hat{\beta}-\beta)) &amp;\approx Var(\sqrt{n}(\hat{\beta}-\beta)) \\
Avar(\sqrt{n}(\hat{\beta}-\beta))/n &amp;\approx Var(\sqrt{n}(\hat{\beta}-\beta))/n = Var(\hat{\beta})
\end{aligned}
\]</span></p>
<ul>
<li>
<span class="math inline">\(Avar(.)\)</span> does not behave the same way as <span class="math inline">\(Var(.)\)</span>
</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
Avar(\sqrt{n}(\hat{\beta}-\beta))/n &amp;\neq Avar(\sqrt{n}(\hat{\beta}-\beta)/\sqrt{n}) \\
&amp;\neq Avar(\hat{\beta})
\end{aligned}
\]</span></p>
<p>In <a href="linear-regression.html#finite-sample-properties">Finite Sample Properties</a>, we calculate standard errors as an estimate for the conditional standard deviation:</p>
<p><span class="math display">\[
SE_{fs}(\hat{\beta}_{j-1})=\sqrt{\hat{Var}}(\hat{\beta}_{j-1}|\mathbf{X}) = \sqrt{s^2[\mathbf{(X'X)}^{-1}]_{jj}}
\]</span></p>
<p>In <a href="linear-regression.html#large-sample-properties">Large Sample Properties</a>, we calculate standard errors as an estimate for the square root of asymptotic variance</p>
<p><span class="math display">\[
SE_{ls}(\hat{\beta}_{j-1})=\sqrt{\hat{Avar}(\sqrt{n}\hat{\beta}_{j-1})/n} = \sqrt{s^2[\mathbf{(X'X)}^{-1}]_{jj}}
\]</span></p>
<p>Hence, the standard error estimator is the same for finite sample and large sample.</p>
<ul>
<li>Same estimator, but conceptually estimating two different things.</li>
<li>Valid under weaker assumptions: the assumptions needed to produce a consistent estimator for the finite sample conditional variance (A1-A5) are stronger than those needed to produce a consistent estimator for the asymptotic variance (A1,A2,A3a,A4,A5)</li>
</ul>
<p>Suppose that <span class="math inline">\(y_1,...,y_n\)</span> are a random sample from some population with mean <span class="math inline">\(\mu\)</span> and variance-covariance matrix <span class="math inline">\(\Sigma\)</span></p>
<ul>
<li>
<span class="math inline">\(\bar{y} = \frac{1}{n}\sum_{i=1}^{n} y_i\)</span> is a consistent estimator for <span class="math inline">\(\mu\)</span><br>
</li>
<li>
<span class="math inline">\(S = \frac{1}{n-1}\sum_{i=1}^{n} (y_i -\bar{y})(y_i-\bar{y})'\)</span> is a consistent estimator for <span class="math inline">\(\Sigma\)</span>.<br>
</li>
<li>Multivariate Central limit Theorem: Similar to the univariate case, <span class="math inline">\(\sqrt{n}(\bar{y}-\mu) \sim N_p(0,\Sigma)\)</span>, when <span class="math inline">\(n\)</span> is large relative to p (e.g., <span class="math inline">\(n \ge 25p\)</span>). Equivalently, <span class="math inline">\(\bar{y} \sim N_p(\mu,\Sigma/n)\)</span>.<br>
</li>
<li>Wald’s Theorem: <span class="math inline">\(n(\bar{y} - \mu)'S^{-1}(\bar{y}-\mu) \sim \chi^2_{(p)}\)</span> when <span class="math inline">\(n\)</span> is large relative to <span class="math inline">\(p\)</span>.</li>
</ul>
</div>
</div>
<div id="feasible-generalized-least-squares" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Feasible Generalized Least Squares<a class="anchor" aria-label="anchor" href="#feasible-generalized-least-squares"><i class="fas fa-link"></i></a>
</h2>
<p>Motivation for a more efficient estimator</p>
<ul>
<li><p><a href="linear-regression.html#gauss-markov-theorem">Gauss-Markov Theorem</a> holds under A1-A4</p></li>
<li>
<p>A4: <span class="math inline">\(Var(\epsilon| \mathbf{X} )=\sigma^2I_n\)</span></p>
<ul>
<li>Heteroskedasticity: <span class="math inline">\(Var(\epsilon_i|\mathbf{X}) \neq \sigma^2I_n\)</span>
</li>
<li>Serial Correlation: <span class="math inline">\(Cov(\epsilon_i,\epsilon_j|\mathbf{X}) \neq 0\)</span>
</li>
</ul>
</li>
<li><p>Without A4, how can we know which unbiased estimator is the most efficient?</p></li>
</ul>
<p>Original (unweighted) model:</p>
<p><span class="math display">\[
\mathbf{y=X\beta+ \epsilon}
\]</span></p>
<p>Suppose A1-A3 hold, but A4 does not hold,</p>
<p><span class="math display">\[
\mathbf{Var(\epsilon|X)=\Omega \neq \sigma^2 I_n}
\]</span></p>
<p>We will try to use OLS to estimate the transformed (weighted) model</p>
<p><span class="math display">\[
\mathbf{wy=wX\beta + w\epsilon}
\]</span></p>
<p>We need to choose <span class="math inline">\(\mathbf{w}\)</span> so that</p>
<p><span class="math display">\[
\mathbf{w'w = \Omega^{-1}}
\]</span></p>
<p>then <span class="math inline">\(\mathbf{w}\)</span> (full-rank matrix) is the <strong>Cholesky decomposition</strong> of <span class="math inline">\(\mathbf{\Omega^{-1}}\)</span> (full-rank matrix)</p>
<p>In other words, <span class="math inline">\(\mathbf{w}\)</span> is the squared root of <span class="math inline">\(\Omega\)</span> (squared root version in matrix)</p>
<p><span class="math display">\[
\begin{aligned}
\Omega &amp;= var(\epsilon | X) \\
\Omega^{-1} &amp;= var(\epsilon | X)^{-1}
\end{aligned}
\]</span></p>
<p>Then, the transformed equation (IGLS) will have the following properties.</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{\hat{\beta}_{IGLS}} &amp;= \mathbf{(X'w'wX)^{-1}X'w'wy} \\
&amp; = \mathbf{(X'\Omega^{-1}X)^{-1}X'\Omega^{-1}y} \\
&amp; = \mathbf{\beta + X'\Omega^{-1}X'\Omega^{-1}\epsilon}
\end{aligned}
\]</span></p>
<p>Since A1-A3 hold for the unweighted model</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{E(\hat{\beta}_{IGLS}|X)} &amp; = E(\mathbf{\beta + (X'\Omega^{-1}X'\Omega^{-1}\epsilon)}|X)\\
&amp; = \mathbf{\beta + E(X'\Omega^{-1}X'\Omega^{-1}\epsilon)|X)} \\
&amp; = \mathbf{\beta + X'\Omega^{-1}X'\Omega^{-1}E(\epsilon|X)}  &amp;&amp; \text{since A3}: E(\epsilon|X)=0 \\
&amp; = \mathbf{\beta}
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\rightarrow\)</span> IGLS estimator is unbiased</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{Var(w\epsilon|X)} &amp;= \mathbf{wVar(\epsilon|X)w'} \\
&amp; = \mathbf{w\Omega w'} \\
&amp; = \mathbf{w(w'w)^{-1}w'} &amp;&amp; \text{since w is a full-rank matrix}\\
&amp; = \mathbf{ww^{-1}(w')^{-1}w'} \\
&amp; = \mathbf{I_n}
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\rightarrow\)</span> A4 holds for the transformed (weighted) equation</p>
<p>Then, the variance for the estimator is</p>
<p><span class="math display">\[
\begin{aligned}
Var(\hat{\beta}_{IGLS}|\mathbf{X}) &amp; = \mathbf{Var(\beta + (X'\Omega ^{-1}X)^{-1}X'\Omega^{-1}\epsilon|X)} \\
&amp;= \mathbf{Var((X'\Omega ^{-1}X)^{-1}X'\Omega^{-1}\epsilon|X)} \\
&amp;= \mathbf{(X'\Omega ^{-1}X)^{-1}X'\Omega^{-1} Var(\epsilon|X)   \Omega^{-1}X(X'\Omega ^{-1}X)^{-1}} &amp;&amp; \text{because A4 holds}\\
&amp;= \mathbf{(X'\Omega ^{-1}X)^{-1}X'\Omega^{-1} \Omega \Omega^{-1} \Omega^{-1}X(X'\Omega ^{-1}X)^{-1}} \\
&amp;= \mathbf{(X'\Omega ^{-1}X)^{-1}}
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(A = \mathbf{(X'X)^{-1}X'-(X'\Omega ^{-1} X)X' \Omega^{-1}}\)</span> then <span class="math display">\[
Var(\hat{\beta}_{OLS}|X)- Var(\hat{\beta}_{IGLS}|X) = A\Omega A'
\]</span> And <span class="math inline">\(\Omega\)</span> is Positive Semi Definite, then <span class="math inline">\(A\Omega A'\)</span> also PSD, then IGLS is more efficient</p>
<p>The name <strong>Infeasible</strong> comes from the fact that it is impossible to compute this estimator.</p>
<p><span class="math display">\[
\mathbf{w} =
\left(
\begin{array}{ccccc}
w_{11} &amp; 0 &amp; 0 &amp; ... &amp; 0 \\
w_{21} &amp; w_{22} &amp; 0 &amp; ... &amp; 0 \\
w_{31} &amp; w_{32} &amp; w_{33} &amp; ... &amp; ... \\
w_{n1} &amp; w_{n2} &amp; w_{n3} &amp; ... &amp; w_{nn} \\
\end{array}
\right)
\]</span></p>
<p>With <span class="math inline">\(n(n+1)/2\)</span> number of elements and n observations <span class="math inline">\(\rightarrow\)</span> infeasible to estimate. (number of equation &gt; data)</p>
<p>Hence, we need to make assumption on <span class="math inline">\(\Omega\)</span> to make it feasible to estimate <span class="math inline">\(\mathbf{w}\)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<a href="linear-regression.html#heteroskedasticity">Heteroskedasticity</a> : multiplicative exponential model</li>
<li><a href="linear-regression.html#ar1">AR(1)</a></li>
<li><a href="linear-regression.html#cluster">Cluster</a></li>
</ol>
<div id="heteroskedasticity" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Heteroskedasticity<a class="anchor" aria-label="anchor" href="#heteroskedasticity"><i class="fas fa-link"></i></a>
</h3>
<span class="math display" id="eq:h-var-error-term">\[\begin{equation}
\begin{aligned}
Var(\epsilon_i |x_i) &amp; = E(\epsilon^2|x_i) \neq \sigma^2 \\
&amp; = h(x_i) = \sigma_i^2 \text{(variance of the error term is a function of x)}
\end{aligned}
\tag{5.7}
\end{equation}\]</span>
<p>For our model,</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;= x_i\beta + \epsilon_i \\
(1/\sigma_i)y_i &amp;= (1/\sigma_i)x_i\beta + (1/\sigma_i)\epsilon_i
\end{aligned}
\]</span></p>
<p>then, from <a href="linear-regression.html#eq:h-var-error-term">(5.7)</a></p>
<p><span class="math display">\[
\begin{aligned}
Var((1/\sigma_i)\epsilon_i|X) &amp;= (1/\sigma_i^2) Var(\epsilon_i|X) \\
&amp;= (1/\sigma_i^2)\sigma_i^2 \\
&amp;= 1
\end{aligned}
\]</span></p>
<p>then the weight matrix <span class="math inline">\(\mathbf{w}\)</span> in the matrix equation</p>
<p><span class="math display">\[
\mathbf{wy=wX\beta + w\epsilon}
\]</span></p>
<p><span class="math display">\[
\mathbf{w}=
\left(
\begin{array}{ccccc}
1/\sigma_1 &amp; 0 &amp; 0 &amp; ... &amp; 0 \\
0 &amp; 1/\sigma_2 &amp; 0 &amp; ... &amp; 0 \\
0 &amp; 0 &amp; 1/\sigma_3 &amp; ... &amp; . \\
. &amp; . &amp; . &amp; . &amp; 0 \\
0 &amp; 0 &amp; . &amp; . &amp; 1/\sigma_n
\end{array}
\right)
\]</span></p>
<p><strong>Infeasible Weighted Least Squares</strong></p>
<ol style="list-style-type: decimal">
<li>Assume we know <span class="math inline">\(\sigma_i^2\)</span> (Infeasible)</li>
<li>The IWLS estimator is obtained as the least squared estimated for the following weighted equation</li>
</ol>
<p><span class="math display">\[
(1/\sigma_i)y_i = (1/\sigma_i)\mathbf{x}_i\beta + (1/\sigma_i)\epsilon_i
\]</span></p>
<ul>
<li>Usual standard errors for the weighted equation are valid if <span class="math inline">\(Var(\epsilon | \mathbf{X}) = \sigma_i^2\)</span>
</li>
<li>If <span class="math inline">\(Var(\epsilon | \mathbf{X}) \neq \sigma_i^2\)</span> then heteroskedastic robust standard errors are valid.</li>
</ul>
<p><strong>Problem</strong>: We do not know <span class="math inline">\(\sigma_i^2=Var(\epsilon_i|\mathbf{x_i})=E(\epsilon_i^2|\mathbf{x}_i)\)</span></p>
<ul>
<li>
<p>One observation <span class="math inline">\(\epsilon_i\)</span> cannot estimate a sample variance estimate <span class="math inline">\(\sigma_i^2\)</span></p>
<ul>
<li>Model <span class="math inline">\(\epsilon_i^2\)</span> as reasonable (strictly positive) function of <span class="math inline">\(x_i\)</span> and independent error <span class="math inline">\(v_i\)</span> (strictly positive)</li>
</ul>
</li>
</ul>
<p><span class="math display">\[
\epsilon_i^2=v_i exp(\mathbf{x_i\gamma})
\]</span></p>
<p>Then we can apply a log transformation to recover a linear in parameters model,</p>
<p><span class="math display">\[
ln(\epsilon_i^2) = \mathbf{x_i\gamma} + ln(v_i)
\]</span></p>
<p>where <span class="math inline">\(ln(v_i)\)</span> is independent <span class="math inline">\(\mathbf{x}_i\)</span></p>
<p>We do not observe <span class="math inline">\(\epsilon_i\)</span> * OLS residual (<span class="math inline">\(e_i\)</span>) as an approximate</p>
</div>
<div id="serial-correlation" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Serial Correlation<a class="anchor" aria-label="anchor" href="#serial-correlation"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
Cov(\epsilon_i, \epsilon_j | \mathbf{X}) \neq 0
\]</span></p>
<p>Under covariance stationary,</p>
<p><span class="math display">\[
Cov(\epsilon_i,\epsilon_j|\mathbf{X}) = Cov(\epsilon_i, \epsilon_{i+h}|\mathbf{x_i,x_{i+h}})=\gamma_h
\]</span></p>
<p>And the variance covariance matrix is</p>
<p><span class="math display">\[
Var(\epsilon|\mathbf{X}) = \Omega =
\left(
\begin{array}{ccccc}
\sigma^2 &amp; \gamma_1 &amp; \gamma_2 &amp; ... &amp; \gamma_{n-1} \\
\gamma_1 &amp; \sigma^2 &amp; \gamma_1 &amp; ... &amp; \gamma_{n-2} \\
\gamma_2 &amp; \gamma_1 &amp; \sigma^2 &amp; ... &amp; ... \\
. &amp; . &amp; . &amp; . &amp; \gamma_1 \\
\gamma_{n-1} &amp; \gamma_{n-2} &amp; . &amp; \gamma_1 &amp; \sigma^2
\end{array}
\right)
\]</span></p>
<p>There n parameters to estimate - need some sort fo structure to reduce number of parameters to estimate.</p>
<ul>
<li>
<p><a href="linear-regression.html#ar1">Time Series</a></p>
<ul>
<li>Effect of inflation and deficit on Treasury Bill interest rates</li>
</ul>
</li>
<li>
<p><a href="linear-regression.html#cluster">Cross-sectional</a></p>
<ul>
<li>Clustering</li>
</ul>
</li>
</ul>
<div id="ar1" class="section level4" number="5.2.2.1">
<h4>
<span class="header-section-number">5.2.2.1</span> AR(1)<a class="anchor" aria-label="anchor" href="#ar1"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;= \beta_0 + x_t\beta_1 + \epsilon_t \\
\epsilon_t &amp;= \rho \epsilon_{t-1} + u_t
\end{aligned}
\]</span></p>
<p>and the variance covariance matrix is</p>
<p><span class="math display">\[
Var(\epsilon | \mathbf{X})= \frac{\sigma^2_u}{1-\rho}
\left(
\begin{array}{ccccc}
1 &amp; \rho &amp; \rho^2 &amp; ... &amp; \rho^{n-1} \\
\rho &amp; 1 &amp; \rho &amp; ... &amp; \rho^{n-2} \\
\rho^2 &amp; \rho &amp; 1 &amp; . &amp; . \\
. &amp; . &amp; . &amp; . &amp; \rho \\
\rho^{n-1} &amp; \rho^{n-2} &amp; . &amp; \rho &amp; 1 \\
\end{array}
\right)
\]</span></p>
<p>Hence, there is only 1 parameter to estimate: <span class="math inline">\(\rho\)</span></p>
<ul>
<li>Under A1, A2, A3a, A5a, OLS is consistent and asymptotically normal</li>
<li>Use <a href="data.html#newey-west-standard-errors">Newey West Standard Errors</a> for valid inference.</li>
<li>Apply <a href="linear-regression.html#infeasible-cochrane-orcutt">Infeasible Cochrane Orcutt</a> (as if we knew <span class="math inline">\(\rho\)</span>)</li>
<li>Because</li>
</ul>
<p><span class="math display">\[
u_t = \epsilon_t - \rho \epsilon_{t-1}
\]</span></p>
<p>satisfies A3, A4, A5 we’d like to to transform the above equation to one that has <span class="math inline">\(u_t\)</span> as the error.</p>
<p><span class="math display">\[
\begin{aligned}
y_t - \rho y_{t-1} &amp;= (\beta_0 + x\beta_1 + \epsilon_t) - \rho (\beta_0 + x_{t-1}\beta_1 + \epsilon_{t-1}) \\
&amp; = (1-\rho)\beta_0 + (x_t - \rho x_{t-1})\beta_1 + u_t
\end{aligned}
\]</span></p>
<div id="infeasible-cochrane-orcutt" class="section level5" number="5.2.2.1.1">
<h5>
<span class="header-section-number">5.2.2.1.1</span> Infeasible Cochrane Orcutt<a class="anchor" aria-label="anchor" href="#infeasible-cochrane-orcutt"><i class="fas fa-link"></i></a>
</h5>
<ol style="list-style-type: decimal">
<li>Assume that we know <span class="math inline">\(\rho\)</span> (Infeasible)</li>
<li>The ICO estimator is obtained as the least squared estimated for the following weighted first difference equation</li>
</ol>
<p><span class="math display">\[
y_t -\rho y_{t-1} = (1-\rho)\beta_0 + (x_t - \rho x_{t-1})\beta_1 + u_t
\]</span></p>
<ul>
<li>Usual standard errors for the weighted first difference equation are valid if the errors truly follow an AR(1) process</li>
<li>If the serial correlation is generated from a more complex dynamic process then <a href="data.html#newey-west-standard-errors">Newey-West HAC standard errors</a> are valid</li>
</ul>
<p><strong>Problem</strong> We do not know <span class="math inline">\(\rho\)</span></p>
<ul>
<li>
<span class="math inline">\(\rho\)</span> is the correlation between <span class="math inline">\(\epsilon_t\)</span> and <span class="math inline">\(\epsilon_{t-1}\)</span>: estimate using OLS residuals (<span class="math inline">\(e_i\)</span>) as proxy</li>
</ul>
<p><span class="math display">\[
\hat{\rho} = \frac{\sum_{t=1}^{T}e_te_{t-1}}{\sum_{t=1}^{T}e_t^2}
\]</span></p>
<p>which can be obtained from the OLS regression of</p>
<p><span class="math display">\[
e_t = \rho e_{t-1} + u_t
\]</span></p>
<p>where we suppress the intercept.</p>
<ul>
<li><p>We are losing an observation</p></li>
<li><p>By taking the first difference we are dropping the first observation</p></li>
</ul>
<p><span class="math display">\[
y_1 = \beta_0 + x_1 \beta_1 + \epsilon_1
\]</span></p>
<ul>
<li>
<a href="linear-regression.html#feasiable-prais-winsten">Feasiable Prais Winsten</a> Transformation applies the <a href="linear-regression.html#infeasible-cochrane-orcutt">Infeasible Cochrane Orcutt</a> but includes a weighted version of the first observation</li>
</ul>
<p><span class="math display">\[
(\sqrt{1-\rho^2})y_1 = \beta_0 + (\sqrt{1-\rho^2})x_1 \beta_1 + (\sqrt{1-\rho^2}) \epsilon_1
\]</span></p>
</div>
</div>
<div id="cluster" class="section level4" number="5.2.2.2">
<h4>
<span class="header-section-number">5.2.2.2</span> Cluster<a class="anchor" aria-label="anchor" href="#cluster"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[
y_{gi} = \mathbf{x}_{gi}\beta + \epsilon_{gi}
\]</span></p>
<p><span class="math display">\[
Cov(\epsilon_{gi}, \epsilon_{hj})
\begin{cases}
= 0 &amp; \text{for $g \neq h$ and any pair (i,j)} \\
\neq 0 &amp; \text{for any (i,j) pair}\\
\end{cases}
\]</span></p>
<p><strong>Intra-group Correlation</strong><br>
Each individual in a single group may be correlated but independent across groups.</p>
<ul>
<li>
<a href="linear-regression.html#a4-homoskedasticity">A4</a> is violated. usual standard errors for OLS are valid.</li>
<li>Use <strong>cluster robust standard errors</strong> for OLS.</li>
</ul>
<p>Suppose there are 3 groups with different n</p>
<p><span class="math display">\[
Var(\epsilon| \mathbf{X})= \Omega =
\left(
\begin{array}{cccccc}
\sigma^2 &amp; \delta_{12}^1 &amp; \delta_{13}^1 &amp; 0 &amp; 0 &amp; 0 \\
\delta_{12}^1 &amp; \sigma^2 &amp; \delta_{23}^1 &amp; 0 &amp; 0 &amp; 0 \\
\delta_{13}^1 &amp; \delta_{23}^1 &amp; \sigma^2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sigma^2 &amp; \delta_{12}^2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \delta_{12}^2 &amp; \sigma^2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2
\end{array}
\right)
\]</span></p>
<p>where <span class="math inline">\(Cov(\epsilon_{gi}, \epsilon_{gj}) = \delta_{ij}^g\)</span> and <span class="math inline">\(Cov(\epsilon_{gi}, \epsilon_{hj}) = 0\)</span> for any i and j</p>
<p><strong>Infeasible Generalized Least Squares (Cluster)</strong></p>
<ol style="list-style-type: decimal">
<li>Assume that <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\delta_{ij}^g\)</span> are known, plug into <span class="math inline">\(\Omega\)</span> and solve for the inverse <span class="math inline">\(\Omega^{-1}\)</span> (infeasible)</li>
<li>The Infeasible Generalized Least Squares Estimator is</li>
</ol>
<p><span class="math display">\[
\hat{\beta}_{IGLS} = \mathbf{(X'\Omega^{-1}X)^{-1}X'\Omega^{-1}y}
\]</span></p>
<p><strong>Problem</strong> * We do not know <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\delta_{ij}^g\)</span> + Can make assumptions about data generating process that is causing the clustering behavior. - Will give structure to <span class="math inline">\(Cov(\epsilon_{gi},\epsilon_{gj})= \delta_{ij}^g\)</span> which makes it feasible to estimate - if the assumptions are wrong then we should use cluster robust standard errors.</p>
<p><strong>Solution</strong> Assume <strong>group level random effects</strong> specification in the error</p>
<p><span class="math display">\[
\begin{aligned}
y_{gi} &amp;= \mathbf{g}_i \beta + c_g + u_{gi} \\
Var(c_g|\mathbf{x}_i) &amp;= \sigma^2_c \\
Var(u_{gi}|\mathbf{x}_i) &amp;= \sigma^2_u
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(c_g\)</span> and <span class="math inline">\(u_{gi}\)</span> are independent of each other, and mean independent of <span class="math inline">\(\mathbf{x}_i\)</span></p>
<ul>
<li>
<span class="math inline">\(c_g\)</span> captures the common group shocks (independent across groups)</li>
<li>
<span class="math inline">\(u_{gi}\)</span> captures the individual shocks (independent across individuals and groups)</li>
</ul>
<p>Then the error variance is</p>
<p><span class="math display">\[
Var(\epsilon| \mathbf{X})= \Omega =
\left(
\begin{array}{cccccc}
\sigma^2_c + \sigma^2_u &amp; \sigma^2_c &amp; \sigma^2_c &amp; 0 &amp; 0 &amp; 0 \\
\sigma^2_c &amp; \sigma^2 + \sigma^2_u &amp; \sigma^2_c &amp; 0 &amp; 0 &amp; 0 \\
\sigma^2_c &amp; \sigma^2_c  &amp; \sigma^2+ \sigma^2_u &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sigma^2+ \sigma^2_u &amp; \sigma^2_c &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sigma^2_c &amp; \sigma^2+ \sigma^2_u &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \sigma^2+ \sigma^2_u
\end{array}
\right)
\]</span></p>
<p>Use <a href="linear-regression.html#feasible-group-level-random-effects">Feasible group level Random Effects</a></p>
</div>
</div>
</div>
<div id="weighted-least-squares" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Weighted Least Squares<a class="anchor" aria-label="anchor" href="#weighted-least-squares"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Estimate the following equation using OLS</li>
</ol>
<p><span class="math display">\[
y_i = \mathbf{x}_i \beta + \epsilon_i
\]</span></p>
<p>and obtain the residuals <span class="math inline">\(e_i=y_i -\mathbf{x}_i \hat{\beta}\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Transform the residual and estimate the following by OLS,</li>
</ol>
<p><span class="math display">\[
ln(e_i^2)= \mathbf{x}_i\gamma + ln(v_i)
\]</span></p>
<p>and obtain the predicted values <span class="math inline">\(g_i=\mathbf{x}_i \hat{\gamma}\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>The weights will be the untransformed predicted outcome,</li>
</ol>
<p><span class="math display">\[
\hat{\sigma}_i =\sqrt{exp(g_i)}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>The FWLS (Feasible WLS) estimator is obtained as the least squared estimated for the following weighted equation</li>
</ol>
<p><span class="math display">\[
(1/\hat{\sigma}_i)y_i = (1/\hat{\sigma}_i) \mathbf{x}_i\beta + (1/\hat{\sigma}_i)\epsilon_i
\]</span></p>
<p><strong>Properties of the FWLS</strong></p>
<ul>
<li><p>The infeasible WLS estimator is unbiased under A1-A3 for the unweighted equation.</p></li>
<li><p>The FWLS estimator is NOT an unbiased estimator.</p></li>
<li>
<p>The FWLS estimator is consistent under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, (for the unweighted equation), <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>, and <span class="math inline">\(E(\mathbf{x}_i'\epsilon_i/\sigma^2_i)=0\)</span></p>
<ul>
<li>
<a href="linear-regression.html#a3a">A3a</a> is not sufficient for the above equation</li>
<li>
<a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> is sufficient for the above equation.</li>
</ul>
</li>
<li>
<p>The FWLS estimator is asymptotically more efficient than OLS if the errors have multiplicative exponential heteroskedasticity.</p>
<ul>
<li>If the errors are truly multiplicative exponential heteroskedasticity, then usual standard errors are valid</li>
<li>If we believe that there may be some mis-specification with the <strong>multiplicative exponential model</strong>, then we should report heteroskedastic robust standard errors.</li>
</ul>
</li>
</ul>
</div>
<div id="generalized-least-squares" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Generalized Least Squares<a class="anchor" aria-label="anchor" href="#generalized-least-squares"><i class="fas fa-link"></i></a>
</h2>
<p>Consider</p>
<p><span class="math display">\[
\mathbf{y = X\beta + \epsilon}
\]</span></p>
<p>where,</p>
<p><span class="math display">\[
var(\epsilon) = \mathbf{G} =
\left(
\begin{array}
{cccc}
g_{11} &amp; g_{12} &amp; ... &amp; g_{1n} \\
g_{21} &amp; g_{22} &amp; ... &amp; g_{2n} \\
. &amp; . &amp; . &amp; . \\
g_{n1} &amp; . &amp; . &amp; g_{nn}\\
\end{array}
\right)
\]</span></p>
<p>The variances are heterogeneous, and the errors are correlated.</p>
<p><span class="math display">\[
\mathbf{\hat{b}_G = (X'G^{-1}X)^{-1}X'G^{-1}Y}
\]</span></p>
<p>if we know G, we can estimate <span class="math inline">\(\mathbf{b}\)</span> just like OLS. However, we do not know G. Hence, we model the structure of G.</p>
</div>
<div id="feasiable-prais-winsten" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Feasible Prais Winsten<a class="anchor" aria-label="anchor" href="#feasiable-prais-winsten"><i class="fas fa-link"></i></a>
</h2>
<p>Weighting Matrix</p>
<p><span class="math display">\[
\mathbf{w} =
\left(
\begin{array}{ccccc}
\sqrt{1- \hat{\rho}^2} &amp; 0 &amp; 0 &amp;... &amp; 0 \\
-\hat{\rho} &amp; 1 &amp; 0 &amp; ... &amp; 0 \\
0 &amp;  -\hat{\rho} &amp; 1 &amp; &amp; . \\
. &amp; . &amp; . &amp; . &amp; 0 \\
0 &amp; . &amp; 0 &amp; -\hat{\rho} &amp; 1
\end{array}
\right)
\]</span></p>
<ol style="list-style-type: decimal">
<li>Estimate the following equation using OLS</li>
</ol>
<p><span class="math display">\[
y_t = \mathbf{x}_t \beta + \epsilon_t
\]</span></p>
<p>and obtain the residuals <span class="math inline">\(e_t = y_t - \mathbf{x}_t \hat{\beta}\)</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Estimate the correlation coefficient for the <a href="linear-regression.html#ar1">AR(1)</a> process by estimating the following by OLS (without no intercept)</li>
</ol>
<p><span class="math display">\[
e_t = \rho e_{t-1} + u_t
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Transform the outcome and independent variables <span class="math inline">\(\mathbf{wy}\)</span> and <span class="math inline">\(\mathbf{wX}\)</span> respectively (weight matrix as stated).</li>
<li>The <a href="linear-regression.html#feasiable-prais-winsten">FPW</a> estimator is obtained as the least squared estimated for the following weighted equation</li>
</ol>
<p><span class="math display">\[
\mathbf{wy = wX\beta + w\epsilon}
\]</span></p>
<p><strong>Properties of Feasible<a href="linear-regression.html#feasiable-prais-winsten">Prais Winsten</a> Estimator</strong></p>
<ul>
<li>The Infeasible PW estimator is under A1-A3 for the unweighted equation</li>
<li>The <a href="linear-regression.html#feasiable-prais-winsten">FPW</a> estimator is biased</li>
<li>The <a href="linear-regression.html#feasiable-prais-winsten">FPW</a> is consistent under <a href="linear-regression.html#a1-linearity">A1</a> <a href="linear-regression.html#a2-full-rank">A2</a> <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> and</li>
</ul>
<p><span class="math display">\[
E((\mathbf{x_t - \rho x_{t-1}})')(\epsilon_t - \rho \epsilon_{t-1})=0
\]</span></p>
<ul>
<li><p><a href="linear-regression.html#a3a">A3a</a> is not sufficient for the above equation</p></li>
<li><p><a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> is sufficient for the above equation</p></li>
<li>
<p>The <a href="linear-regression.html#feasiable-prais-winsten">FPW</a> estimator is asymptotically more efficient than OLS if the errors are truly generated as AR(1) process</p>
<ul>
<li>If the errors are truly generated as AR(1) process then usual standard errors are valid</li>
<li>If we are concerned that there may be a more complex dependence structure of heteroskedasticity, then we use <a href="data.html#newey-west-standard-errors">Newey West Standard Errors</a>
</li>
</ul>
</li>
</ul>
</div>
<div id="feasible-group-level-random-effects" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Feasible group level Random Effects<a class="anchor" aria-label="anchor" href="#feasible-group-level-random-effects"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Estimate the following equation using OLS</li>
</ol>
<p><span class="math display">\[
y_{gi} = \mathbf{x}_{gi}\beta + \epsilon_{gi}
\]</span></p>
<p>and obtain the residuals <span class="math inline">\(e_{gi} = y_{gi} - \mathbf{x}_{gi}\hat{\beta}\)</span> 2. Estimate the variance using the usual $s^2 estimator</p>
<p><span class="math display">\[
s^2 = \frac{1}{n-k}\sum_{i=1}^{n}e_i^2
\]</span></p>
<p>as an estimator for <span class="math inline">\(\sigma^2_c + \sigma^2_u\)</span> and estimate the within group correlation,</p>
<p><span class="math display">\[
\hat{\sigma}^2_c = \frac{1}{G} \sum_{g=1}^{G} (\frac{1}{\sum_{i=1}^{n_g-1}i}\sum_{i\neq j}\sum_{j}^{n_g}e_{gi}e_{gj})
\]</span></p>
<p>and plug in the estimates to obtain <span class="math inline">\(\hat{\Omega}\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li>The feasible group level RE estimator is obtained as</li>
</ol>
<p><span class="math display">\[
\hat{\beta}= \mathbf{(X'\hat{\Omega}^{-1}X)^{-1}X'\hat{\Omega}^{-1}y}
\]</span></p>
<p><strong>Properties of the <a href="linear-regression.html#feasible-group-level-random-effects">Feasible group level Random Effects</a> Estimator</strong></p>
<ul>
<li>
<p>The infeasible group RE estimator is a linear estimator and is unbiased under A1-A3 for the unweighted equation</p>
<ul>
<li>A3 requires <span class="math inline">\(E(\epsilon_{gi}|\mathbf{x}_i) = E(c_{g}|\mathbf{x}_i)+ (u_{gi}|\mathbf{x}_i)=0\)</span> so we generally assume <span class="math inline">\(E(c_{g}|\mathbf{x}_i)+ (u_{gi}|\mathbf{x}_i)=0\)</span>. The assumption <span class="math inline">\(E(c_{g}|\mathbf{x}_i)=0\)</span> is generally called <strong>random effects assumption</strong>
</li>
</ul>
</li>
<li><p>The <a href="linear-regression.html#feasible-group-level-random-effects">Feasible group level Random Effects</a> is biased</p></li>
<li>
<p>The <a href="linear-regression.html#feasible-group-level-random-effects">Feasible group level Random Effects</a> is consistent under A1-A3a, and A5a for the unweighted equation.</p>
<ul>
<li>
<a href="linear-regression.html#a3a">A3a</a> requires <span class="math inline">\(E(\mathbf{x}_i'\epsilon_{gi}) = E(\mathbf{x}_i'c_{g})+ (\mathbf{x}_i'u_{gi})=0\)</span>
</li>
</ul>
</li>
<li>
<p>The <a href="linear-regression.html#feasible-group-level-random-effects">Feasible group level Random Effects</a> estimator is asymptotically more efficient than OLS if the errors follow the random effects specification</p>
<ul>
<li>If the errors do follow the random effects specification than the usual standard errors are consistent</li>
<li>If there might be a more complex dependence structure or heteroskedasticity, then we need cluster robust standard errors.</li>
</ul>
</li>
</ul>
</div>
<div id="ridge-regression" class="section level2" number="5.7">
<h2>
<span class="header-section-number">5.7</span> Ridge Regression<a class="anchor" aria-label="anchor" href="#ridge-regression"><i class="fas fa-link"></i></a>
</h2>
<p>When we have the Collinearity problem, we could use the Ridge regression.</p>
<p>The main problem with multicollinearity is that <span class="math inline">\(\mathbf{X'X}\)</span> is “ill-conditioned”. The idea for ridge regression: adding a constant to the diagonal of <span class="math inline">\(\mathbf{X'X}\)</span> improves the conditioning</p>
<p><span class="math display">\[
\mathbf{X'X} + c\mathbf{I} (c&gt;0)
\]</span></p>
<p>The choice of c is hard. The estimator</p>
<p><span class="math display">\[
\mathbf{b}^R = (\mathbf{X'X}+c\mathbf{I})^{-1}\mathbf{X'y}
\]</span></p>
<p>is <strong>biased</strong>.</p>
<ul>
<li>It has smaller variance than the <a href="linear-regression.html#ordinary-least-squares">OLS</a> estimator; as c increases, the bias increases but the variance decreases.</li>
<li>Always exists some value of c for which the ridge regression estimator has a smaller total MSE than the <a href="linear-regression.html#ordinary-least-squares">OLS</a>
</li>
<li>The optimal c varies with application and data set.</li>
<li>To find the “optimal” <span class="math inline">\(c\)</span> we could use “ridge trace”.</li>
</ul>
<p>We plot the values of the <span class="math inline">\(p - 1\)</span> parameter estimates for different values of c, simultaneously.</p>
<ul>
<li>Typically, as c increases toward 1 the coefficients decreases to 0.</li>
<li>The values of the VIF tend to decrease rapidly as c gets bigger than 0. The VIF values begin to change slowly as <span class="math inline">\(c \to 1\)</span>.</li>
<li>Then we can examine the ridge trace and VIF values and chooses the smallest value of c where the regression coefficients first become stable in the ridge trace and the VIF values have become sufficiently small (which is very subjective).</li>
<li>Typically, this procedure is applied to the standardized regression model.</li>
</ul>
</div>
<div id="principal-component-regression" class="section level2" number="5.8">
<h2>
<span class="header-section-number">5.8</span> Principal Component Regression<a class="anchor" aria-label="anchor" href="#principal-component-regression"><i class="fas fa-link"></i></a>
</h2>
<p>This also addresses the problem of multicollinearity</p>
</div>
<div id="robust-regression" class="section level2" number="5.9">
<h2>
<span class="header-section-number">5.9</span> Robust Regression<a class="anchor" aria-label="anchor" href="#robust-regression"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>To address the problem of influential cases.</li>
<li>Can be used when a known functional form is to be fitted, and when the errors are not normal due to a few outlying cases.</li>
</ul>
<div id="least-absolute-residuals-lar-regression" class="section level3" number="5.9.1">
<h3>
<span class="header-section-number">5.9.1</span> Least Absolute Residuals (LAR) Regression<a class="anchor" aria-label="anchor" href="#least-absolute-residuals-lar-regression"><i class="fas fa-link"></i></a>
</h3>
<p>also known as minimum <span class="math inline">\(L_1\)</span>-norm regression.</p>
<p><span class="math display">\[
L_1 = \sum_{i=1}^{n}|Y_i - (\beta_0 + \beta_1 X_{i1} + .. + \beta_{p-1}X_{i,p-1})
\]</span></p>
<p>which is not sensitive to outliers and inadequacies of the model specification.</p>
</div>
<div id="least-median-of-squares-lms-regression" class="section level3" number="5.9.2">
<h3>
<span class="header-section-number">5.9.2</span> Least Median of Squares (LMS) Regression<a class="anchor" aria-label="anchor" href="#least-median-of-squares-lms-regression"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
median\{[Y_i - (\beta_0 - \beta_1X_{i1} + ... + \beta_{p-1}X_{i,p-1})]^2 \}
\]</span></p>
</div>
<div id="iteratively-reweighted-least-squares-irls-robust-regression" class="section level3" number="5.9.3">
<h3>
<span class="header-section-number">5.9.3</span> Iteratively Reweighted Least Squares (IRLS) Robust Regression<a class="anchor" aria-label="anchor" href="#iteratively-reweighted-least-squares-irls-robust-regression"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>uses <a href="linear-regression.html#weighted-least-squares">Weighted Least Squares</a> to lessen the influence of outliers.</li>
<li>the weights <span class="math inline">\(w_i\)</span> are inversely proportional to how far an outlying case is (e.g., based on the residual)</li>
<li>the weights are revised iteratively until a robust fit</li>
</ul>
<p>Process:</p>
<p>Step 1: Choose a weight function for weighting the cases.<br>
Step 2: obtain starting weights for all cases.<br>
Step 3: Use the starting weights in WLS and obtain the residuals from the fitted regression function.<br>
Step 4: use the residuals in Step 3 to obtain revised weights.<br>
Step 5: continue until convergence.</p>
<p><strong>Note</strong>:</p>
<ul>
<li>If you don’t know the form of the regression function, consider using nonparametric regression (e.g., locally weighted regression, regression trees, projection pursuit, neural networks, smoothing splines, loess, wavelets).</li>
<li>could use to detect outliers or confirm OLS.</li>
</ul>
</div>
</div>
<div id="maximum-likelihood-regression" class="section level2" number="5.10">
<h2>
<span class="header-section-number">5.10</span> Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood-regression"><i class="fas fa-link"></i></a>
</h2>
<p>Premise: find values of the parameters that maximize the probability of observing the data In other words, we try to maximize the value of theta in the likelihood function</p>
<p><span class="math display">\[
L(\theta)=\prod_{i=1}^{n}f(y_i|\theta)
\]</span></p>
<p><span class="math inline">\(f(y|\theta)\)</span> is the probability density of observing a single value of <span class="math inline">\(Y\)</span> given some value of <span class="math inline">\(\theta\)</span> <span class="math inline">\(f(y|\theta)\)</span> can be specify as various type of distributions. You can review back section <a href="prerequisites.html#distributions">Distributions</a>. For example, if <span class="math inline">\(y\)</span> is a dichotomous variable, then</p>
<p><span class="math display">\[
L(\theta)=\prod_{i=1}^{n}\theta^{y_i}(1-\theta)^{1-y_i}
\]</span></p>
<p><span class="math inline">\(\hat{\theta}\)</span> is the Maximum Likelihood estimate if <span class="math inline">\(L(\hat{\theta}) &gt; L(\theta_0)\)</span> for all values of <span class="math inline">\(\theta_0\)</span> in the parameter space.</p>
<div id="motivation-for-mle" class="section level3" number="5.10.1">
<h3>
<span class="header-section-number">5.10.1</span> Motivation for MLE<a class="anchor" aria-label="anchor" href="#motivation-for-mle"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose we know the conditional distribution of y given x:</p>
<p><span class="math display">\[
f_{Y|X}(y,x;\theta)
\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the unknown parameter of distribution. Sometimes we are only concerned with the unconditional distribution <span class="math inline">\(f_{Y}(y;\theta)\)</span></p>
<p>Then given a sample of iid data, we can calculate the joint distribution of the entire sample,</p>
<p><span class="math display">\[
f_{Y_1,...,Y_n|X_1,...,X_n(y_1,...y_n,x_1,...,x_n;\theta)}= \prod_{i=1}^{n}f_{Y|X}(y_i,x_i;\theta)
\]</span></p>
<p>The joint distribution evaluated at the sample is the likelihood (probability) that we observed this particular sample (depends on <span class="math inline">\(\theta\)</span>)</p>
<p>Idea for MLE: Given a sample, we choose our estimates of the parameters that gives the highest likelihood (probability) of observing our particular sample</p>
<p><span class="math display">\[
max_{\theta} \prod_{i=1}^{n}f_{Y|X}(y_i,x_i; \theta)
\]</span></p>
<p>Equivalently,</p>
<p><span class="math display">\[
max_{\theta} \prod_{i=1}^{n} ln(f_{Y|X}(y_i,x_i; \theta))
\]</span></p>
<p>Solving for the Maximum Likelihood Estimator</p>
<ol style="list-style-type: decimal">
<li>Solve First Order Condition</li>
</ol>
<p><span class="math display">\[
\frac{\partial}{\partial \theta}\sum_{i=1}^{n} ln(f_{Y|X}(y_i,x_i;\hat{\theta}_{MLE})) = 0
\]</span></p>
<p>where <span class="math inline">\(\hat{\theta}_{MLE}\)</span> is defined.</p>
<ol start="2" style="list-style-type: decimal">
<li>Evaluate Second Order Condition</li>
</ol>
<p><span class="math display">\[
\frac{\partial^2}{\partial \theta^2} \sum_{i=1}^{n} ln(f_{Y|X}(y_i,x_i;\hat{\theta}_{MLE})) &lt; 0
\]</span></p>
<p>where the above condition ensures we can solve for a maximum</p>
<p>Examples:<br>
Unconditional Poisson Distribution: Number of products ordered on Amazon within an hour, number of website visits a day for a political campaign.</p>
<p>Exponential Distribution: Length of time until an earthquake occurs, length of time a car battery lasts.</p>
<p><span class="math display">\[
\begin{aligned}
f_{Y|X}(y,x;\theta) &amp;= exp(-y/x\theta)/x\theta \\
f_{Y_1,..Y_n|X_1,...,X_n(y_1,...,y_n,x_1,...,x_n;\theta)} &amp;= \prod_{i=1}^{n}exp(-y_i/x_i \theta)/x_i \theta
\end{aligned}
\]</span></p>
</div>
<div id="assumption" class="section level3" number="5.10.2">
<h3>
<span class="header-section-number">5.10.2</span> Assumption<a class="anchor" aria-label="anchor" href="#assumption"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p><strong>High Level Regulatory Assumptions</strong> is the sufficient condition used to show large sample properties</p>
<ul>
<li>Hence, for each MLE, we will need to either assume or verify if the regulatory assumption holds.</li>
</ul>
</li>
<li><p>observations are independent and have the same density function.</p></li>
<li><p>Under multivariate normal assumption, maximum likelihood yields consistent estimates of the means and the covariance matrix for multivariate distribution with finite fourth moments <span class="citation">(<a href="references.html#ref-little1988test">Little 1988</a>)</span></p></li>
</ul>
<p>To find the MLE, we usually differentiate the <strong>log-likelihood</strong> function and set it equal to 0.</p>
<p><span class="math display">\[
\frac{d}{d\theta}l(\theta) = 0
\]</span></p>
<p>This is the <strong>score</strong> equation</p>
<p>Our confidence in the MLE is quantified by the “pointedness” of the log-likelihood</p>
<p><span class="math display">\[
I_O(\theta)= \frac{d^2}{d\theta^2}l(\theta) = 0
\]</span></p>
<p>called the <strong>observed information</strong></p>
<p>while</p>
<p><span class="math display">\[
I(\theta)=E[I_O(\theta;Y)]
\]</span></p>
<p>is the expected information. (also known as Fisher Information). which we base our variance of the estimator.</p>
<p><span class="math display">\[
V(\hat{\Theta}) \approx I(\theta)^{-1}
\]</span></p>
<p><strong>Consistency</strong> of MLE<br>
Suppose that <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> are iid drawn from the true conditional pdf <span class="math inline">\(f_{Y|X}(y_i,x_i;\theta_0)\)</span>. If the following regulatory assumptions hold,</p>
<ul>
<li><p>R1: If <span class="math inline">\(\theta \neq \theta_0\)</span> then <span class="math inline">\(f_{Y|X}(y_i,x_i;\theta) \neq f_{Y|X}(y_i,x_i;\theta_0)\)</span></p></li>
<li><p>R2: The set <span class="math inline">\(\Theta\)</span> that contains the true parameters <span class="math inline">\(\theta_0\)</span> is compact</p></li>
<li><p>R3: The log-likelihood <span class="math inline">\(ln(f_{Y|X}(y_i,x_i;\theta_0))\)</span> is continuous at each <span class="math inline">\(\theta\)</span> with probability 1</p></li>
<li><p>R4: <span class="math inline">\(E(sup_{\theta \in \Theta}|ln(f_{Y|X}(y_i,x_i;\theta_0))|)\)</span></p></li>
</ul>
<p>then the MLE estimator is consistent,</p>
<p><span class="math display">\[
\hat{\theta}_{MLE} \to^p \theta_0
\]</span></p>
<p><strong>Asymptotic Normality</strong> of MLE</p>
<p>Suppose that <span class="math inline">\(y_1\)</span> and <span class="math inline">\(x_i\)</span> are iid drawn from the true conditional pdf <span class="math inline">\(f_{Y|X}(y_i,x_i;\theta)\)</span>. If R1-R4 and the following hold</p>
<ul>
<li><p>R5: <span class="math inline">\(\theta_0\)</span> is in the interior of the set <span class="math inline">\(\Theta\)</span></p></li>
<li><p>R6: <span class="math inline">\(f_{Y|X}(y_i,x_i;\theta)\)</span> is twice continuously differentiable in <span class="math inline">\(\theta\)</span> and <span class="math inline">\(f_{Y|X}(y_i,x_i;\theta) &gt;0\)</span> for a neighborhood <span class="math inline">\(N \in \Theta\)</span> around <span class="math inline">\(\theta_0\)</span></p></li>
<li><p>R7: <span class="math inline">\(\int sup_{\theta \in N}||\partial f_{Y|X}(y_i,x_i;\theta)\partial\theta||d(y,x) &lt;\infty\)</span>, <span class="math inline">\(\int sup_{\theta \in N} || \partial^2 f_{Y|X}(y_i,x_i;\theta)/\partial \theta \partial \theta' || d(y,x) &lt; \infty\)</span> and <span class="math inline">\(E(sup_{\theta \in N} || \partial^2ln(f_{Y|X}(y_i,x_i;\theta)) / \partial \theta \partial \theta' ||) &lt; \infty\)</span></p></li>
<li><p>R8: The information matrix <span class="math inline">\(I(\theta_0) = Var(\partial f_{Y|X}(y,x_i; \theta_0)/\partial \theta)\)</span> exists and is non-singular</p></li>
</ul>
<p>then the MLE estimator is asymptotically normal,</p>
<p><span class="math display">\[
\sqrt{n}(\hat{\theta}_{MLE} - \theta_0) \to^d N(0,I(\theta_0)^{-1})
\]</span></p>
</div>
<div id="properties" class="section level3" number="5.10.3">
<h3>
<span class="header-section-number">5.10.3</span> Properties<a class="anchor" aria-label="anchor" href="#properties"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Consistent: estimates are approximately unbiased in large samples</p></li>
<li><p>Asymptotically efficient: approximately smaller standard errors compared to other estimator</p></li>
<li>
<p>Asymptotically normal: with repeated sampling, the estimates will have an approximately normal distribution. Suppose that <span class="math inline">\(\hat{\theta}_n\)</span> is the MLE for <span class="math inline">\(\theta\)</span> based on n independent observations. then <span class="math inline">\(\hat{\theta}_n \sim N(\theta,H^{-1})\)</span>.<br></p>
<ul>
<li>where H is called the Fisher information matrix. It contains the expected values of the second partial derivatives of the log-likelihood function. The (i.j)th element of H is <span class="math inline">\(-E(\frac{\partial^2l(\theta)}{\partial \theta_i \partial \theta_j})\)</span><br>
</li>
<li>We can estimate H by finding the form determined above, and evaluating it at <span class="math inline">\(\theta = \hat{\theta}_n\)</span>
</li>
</ul>
</li>
<li><p>Invariance: MLE for <span class="math inline">\(g(\theta) = g(\hat{\theta})\)</span> for any function g(.)</p></li>
</ol>
<p><span class="math display">\[
\hat{\Theta} \approx^d (\theta,I(\hat{\theta)^{-1}}))
\]</span></p>
<p>Explicit vs Implicit MLE</p>
<ul>
<li>If we solve the score equation to get an expression of MLE, then it’s called <strong>explicit</strong>
</li>
<li>If there is no closed form for MLE, and we need some algorithms to derive its expression, it’s called <strong>implicit</strong>
</li>
</ul>
<p><strong>Large Sample Property</strong> of MLE</p>
<p>Implicit in these theorems is the assumption that we know what the conditional distribution,</p>
<p><span class="math display">\[
f_{Y|X}(y_i,x_i;\theta_0)
\]</span></p>
<p>but just do now know the exact parameter value.</p>
<ul>
<li>Any Distributional mis-specification will result in inconsistent parameter estimates.</li>
<li>Quasi-MLE: Particular settings/ assumption that allow for certain types of distributional mis-specification (Ex: as long as the distribution is part of particular class or satisfies a particular assumption, then estimating with a wrong distribution will not lead to inconsistent parameter estimates).</li>
<li>non-parametric/ Semi-parametric estimation: no or very little distributional assumption are made. (hard to implement, derive properties, and interpret)</li>
</ul>
<p>The asymptotic variance of the MLE achieves the <strong>Cramer-Rao Lower Bound</strong> <span class="citation">C. R. Rao (<a href="references.html#ref-rao1992information">1992</a>)</span></p>
<ul>
<li>The <strong>Cramer-Rao Lower Bound</strong> is a lower brand for the asymptotic variance of a consistent and asymptotically normally distributed estimator.</li>
<li>If an estimator achieves the lower bound then it is the most efficient estimator.</li>
</ul>
<p>The maximum Likelihood estimator (assuming the distribution is correctly specified and R1-R8 hold) is the most efficient consistent and asymptotically normal estimator. * most efficient among ALL consistent estimators (not limited to unbiased or linear estimators).</p>
<p><strong>Note</strong></p>
<ul>
<li><p>ML is better choice for binary, strictly positive, count, or inherent heteroskedasticity than linear model.</p></li>
<li>
<p>ML will assume that we know the conditional distribution of the outcome, and derive an estimator using that information.</p>
<ul>
<li>Adds an assumption that we know the distribution (which is similar to <a href="linear-regression.html#a6-normal-distribution">A6 Normal Distribution</a> in linear model)</li>
<li>will produce a more efficient estimator.</li>
</ul>
</li>
</ul>
</div>
<div id="compare-to-ols" class="section level3" number="5.10.4">
<h3>
<span class="header-section-number">5.10.4</span> Compare to OLS<a class="anchor" aria-label="anchor" href="#compare-to-ols"><i class="fas fa-link"></i></a>
</h3>
<p>MLE is not a cure for most of OLS problems:</p>
<ul>
<li>To do joint inference in MLE, we typically use log-likelihood calculation, instead of F-score</li>
<li>Functional form affects estimation of MLE and OLS.</li>
<li>Perfect Collinearity/Multicollinearity: highly correlated are likely to yield large standard errors.</li>
<li>Endogeneity (Omitted variables bias, Simultaneous equations): Like OLS, MLE is also biased against this problem</li>
</ul>
</div>
<div id="application" class="section level3" number="5.10.5">
<h3>
<span class="header-section-number">5.10.5</span> Application<a class="anchor" aria-label="anchor" href="#application"><i class="fas fa-link"></i></a>
</h3>
<p>Other applications of MLE</p>
<ul>
<li>
<p>Corner Solution</p>
<ul>
<li>Ex: hours worked, donations to charity</li>
<li>Estimate with Tobit</li>
</ul>
</li>
<li>
<p>Non-negative count</p>
<ul>
<li>Ex: Numbers of arrest, Number of cigarettes smoked a day</li>
<li>Estimate with Poisson regression</li>
</ul>
</li>
<li>
<p>Multinomial Choice</p>
<ul>
<li>Ex: Demand for cars, votes for primary election</li>
<li>Estimate with mutinomial probit or logit</li>
</ul>
</li>
<li>
<p>Ordinal Choice</p>
<ul>
<li>Ex: Levels of Happiness, Levels of Income</li>
<li>Ordered Probit</li>
</ul>
</li>
</ul>
<p>Model for binary Response<br>
A binary variable will have a <a href="prerequisites.html#bernoulli">Bernoulli</a> distribution:</p>
<p><span class="math display">\[
f_Y(y_i;p) = p^{y_i}(1-p)^{(1-y_i)}
\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the probability of success. The conditional distribution is:</p>
<p><span class="math display">\[
f_{Y|X}(y_i,x_i;p(.)) = p(x_i)^{y_i} (1-p(x_i))^{(1-y_i)}
\]</span></p>
<p>So choose <span class="math inline">\(p(x_i)\)</span> to be a reasonable function of <span class="math inline">\(x_i\)</span> and unknown parameters <span class="math inline">\(\theta\)</span></p>
<p>We can use <strong>latent variable model</strong> as probability functions</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;= 1\{y_i^* &gt; 0 \}  \\
y_i^* &amp;= x_i \beta-\epsilon_i
\end{aligned}
\]</span></p>
<ul>
<li>
<span class="math inline">\(y_i^*\)</span> is a latent variable (unobserved) that is not well-defined in terms of units/magnitudes</li>
<li>
<span class="math inline">\(\epsilon_i\)</span> is a mean 0 unobserved random variable.</li>
</ul>
<p>We can rewrite the model without the latent variable,</p>
<p><span class="math display">\[
y_i = 1\{x_i beta &gt; \epsilon_i \}
\]</span></p>
<p>Then the probability function,</p>
<p><span class="math display">\[
\begin{aligned}
p(x_i) &amp;= P(y_i = 1|x_i) \\
&amp;= P(x_i \beta &gt; \epsilon_i | x_i) \\
&amp;= F_{\epsilon|X}(x_i \beta | x_i)
\end{aligned}
\]</span></p>
<p>then we need to choose a conditional distribution for <span class="math inline">\(\epsilon_i\)</span>. Hence, we can make additional strong independence assumption</p>
<p><span class="math inline">\(\epsilon_i\)</span> is independent of <span class="math inline">\(x_i\)</span></p>
<p>Then the probability function is simply,</p>
<p><span class="math display">\[
p(x_i) = F_\epsilon(x_i \beta)
\]</span></p>
<p>The probability function is also the conditional expectation function,</p>
<p><span class="math display">\[
E(y_i | x_i) = P(y_i = 1|x_i) = F_\epsilon (x_i \beta)
\]</span></p>
<p>so we allow the conditional expectation function to be non-linear.</p>
<p>Common distributional assumption</p>
<ol style="list-style-type: decimal">
<li>
<strong>Probit</strong>: Assume <span class="math inline">\(\epsilon_i\)</span> is standard normally distributed, then <span class="math inline">\(F_\epsilon(.) = \Phi(.)\)</span> is the standard normal CDF.<br>
</li>
<li>
<strong>Logit</strong>: Assume <span class="math inline">\(\epsilon_i\)</span> is standard logistically distributed, then <span class="math inline">\(F_\epsilon(.) = \Lambda(.)\)</span> is the standard normal CDF.</li>
</ol>
<p>Step to derive</p>
<ol style="list-style-type: decimal">
<li>Choose a distribution (normal or logistic) and plug into the following log likelihood,</li>
</ol>
<p><span class="math display">\[
ln(f_{Y|X} (y_i , x_i; \beta)) = y_i ln(F_\epsilon(x_i \beta)) + (1-y_i)ln(1-F_\epsilon(x_i \beta))
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Solve the MLE by finding the Maximum of</li>
</ol>
<p><span class="math display">\[
\hat{\beta}_{MLE} = argmax \sum_{i=1}^{n}ln(f_{Y|X}(y_i,x_i; \beta))
\]</span></p>
<p><strong>Properties</strong> of the Probit and Logit Estimators</p>
<ul>
<li>
<p>Probit or Logit is consistent and asymptotically normal if</p>
<ul>
<li>
<a href="linear-regression.html#a2-full-rank">A2 Full rank</a> holds: <span class="math inline">\(E(x_i' x_i)\)</span> exists and is non-singular</li>
<li>
<a href="linear-regression.html#a5-data-generation-random-sampling">A5 Data Generation (random Sampling)</a> (or <a href="linear-regression.html#a5a">A5a</a>) holds: {y_i,x_i} are iid (or stationary and weakly dependent).</li>
<li>Distributional assumptions on <span class="math inline">\(\epsilon_i\)</span> hold: Normal/Logistic and independent of <span class="math inline">\(x_i\)</span>
</li>
</ul>
</li>
<li><p>Under the same assumptions, Probit or Logit is also asymptotically efficient with asymptotic variance,</p></li>
</ul>
<p><span class="math display">\[
I(\beta_0)^{-1} = [E(\frac{(f_\epsilon(x_i \beta_0))^2}{F_\epsilon(x_i\beta_0)(1-F_\epsilon(x_i\beta_0))}x_i' x_i)]^{-1}
\]</span></p>
<p>where <span class="math inline">\(F_\epsilon(x_i\beta_0)\)</span> is the probability density function (derivative of the CDF)</p>
<div id="interpretation" class="section level4" number="5.10.5.1">
<h4>
<span class="header-section-number">5.10.5.1</span> Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math inline">\(\beta\)</span> is the average response in the latent variable associated with a change in <span class="math inline">\(x_i\)</span></p>
<ul>
<li>Magnitudes do not have meaning</li>
<li>Direction does have meaning</li>
</ul>
<p>The <strong>partial effect</strong> for a Non-linear binary response model</p>
<p><span class="math display">\[
\begin{aligned}
E(y_i |x_i) &amp;= F_\epsilon (x_i \beta) \\
PE(x_{ij}) &amp;= \frac{\partial E(y_i |x_i)}{\partial x_{ij}} = f_\epsilon (x_i \beta)\beta_j
\end{aligned}
\]</span></p>
<ul>
<li>The partial effect is the coefficient parameter <span class="math inline">\(\beta_j\)</span> multiplied by a scaling factor <span class="math inline">\(f_\epsilon (x_i \beta)\)</span><br>
</li>
<li>The scaling factor depends on <span class="math inline">\(x_i\)</span> so the partial effect changes depending on what <span class="math inline">\(x_i\)</span> is</li>
</ul>
<p>Single value for the partial effect</p>
<ul>
<li>
<strong>Partial Effect at the Average (PEA)</strong> is the partial effect for an average individual</li>
</ul>
<p><span class="math display">\[
f_{\epsilon}(\bar{x}\hat{\beta})\hat{\beta}_j
\]</span></p>
<ul>
<li>
<strong>Average Partial Effect (APE)</strong> is the average of all partial effect for each individual.</li>
</ul>
<p><span class="math display">\[
\frac{1}{n}\sum_{i=1}^{n}f_\epsilon(x_i \hat{\beta})\hat{\beta}_j
\]</span></p>
<p>In the linear model, <span class="math inline">\(APE = PEA\)</span>.</p>
<p>In a non-linear model (e.g., binary response), <span class="math inline">\(APE \neq PEA\)</span></p>

</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></div>
<div class="next"><a href="non-linear-regression.html"><span class="header-section-number">6</span> Non-linear Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#linear-regression"><span class="header-section-number">5</span> Linear Regression</a></li>
<li>
<a class="nav-link" href="#ordinary-least-squares"><span class="header-section-number">5.1</span> Ordinary Least Squares</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#simple-regression-basic-model"><span class="header-section-number">5.1.1</span> Simple Regression (Basic Model)</a></li>
<li><a class="nav-link" href="#multiple-linear-regression"><span class="header-section-number">5.1.2</span> Multiple Linear Regression</a></li>
<li><a class="nav-link" href="#ols-assumptions"><span class="header-section-number">5.1.3</span> OLS Assumptions</a></li>
<li><a class="nav-link" href="#theorems"><span class="header-section-number">5.1.4</span> Theorems</a></li>
<li><a class="nav-link" href="#variable-selection"><span class="header-section-number">5.1.5</span> Variable Selection</a></li>
<li><a class="nav-link" href="#diagnostics-1"><span class="header-section-number">5.1.6</span> Diagnostics</a></li>
<li><a class="nav-link" href="#model-validation"><span class="header-section-number">5.1.7</span> Model Validation</a></li>
<li><a class="nav-link" href="#finite-sample-properties"><span class="header-section-number">5.1.8</span> Finite Sample Properties</a></li>
<li><a class="nav-link" href="#large-sample-properties"><span class="header-section-number">5.1.9</span> Large Sample Properties</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#feasible-generalized-least-squares"><span class="header-section-number">5.2</span> Feasible Generalized Least Squares</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#heteroskedasticity"><span class="header-section-number">5.2.1</span> Heteroskedasticity</a></li>
<li><a class="nav-link" href="#serial-correlation"><span class="header-section-number">5.2.2</span> Serial Correlation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#weighted-least-squares"><span class="header-section-number">5.3</span> Weighted Least Squares</a></li>
<li><a class="nav-link" href="#generalized-least-squares"><span class="header-section-number">5.4</span> Generalized Least Squares</a></li>
<li><a class="nav-link" href="#feasiable-prais-winsten"><span class="header-section-number">5.5</span> Feasible Prais Winsten</a></li>
<li><a class="nav-link" href="#feasible-group-level-random-effects"><span class="header-section-number">5.6</span> Feasible group level Random Effects</a></li>
<li><a class="nav-link" href="#ridge-regression"><span class="header-section-number">5.7</span> Ridge Regression</a></li>
<li><a class="nav-link" href="#principal-component-regression"><span class="header-section-number">5.8</span> Principal Component Regression</a></li>
<li>
<a class="nav-link" href="#robust-regression"><span class="header-section-number">5.9</span> Robust Regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#least-absolute-residuals-lar-regression"><span class="header-section-number">5.9.1</span> Least Absolute Residuals (LAR) Regression</a></li>
<li><a class="nav-link" href="#least-median-of-squares-lms-regression"><span class="header-section-number">5.9.2</span> Least Median of Squares (LMS) Regression</a></li>
<li><a class="nav-link" href="#iteratively-reweighted-least-squares-irls-robust-regression"><span class="header-section-number">5.9.3</span> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#maximum-likelihood-regression"><span class="header-section-number">5.10</span> Maximum Likelihood</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#motivation-for-mle"><span class="header-section-number">5.10.1</span> Motivation for MLE</a></li>
<li><a class="nav-link" href="#assumption"><span class="header-section-number">5.10.2</span> Assumption</a></li>
<li><a class="nav-link" href="#properties"><span class="header-section-number">5.10.3</span> Properties</a></li>
<li><a class="nav-link" href="#compare-to-ols"><span class="header-section-number">5.10.4</span> Compare to OLS</a></li>
<li><a class="nav-link" href="#application"><span class="header-section-number">5.10.5</span> Application</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/05-regression.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/05-regression.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2023-08-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
