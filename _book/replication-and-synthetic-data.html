<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 43 Replication and Synthetic Data | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="Access to comprehensive data is pivotal for replication, especially in the realm of social sciences. Yet, data are often inaccessible due to proprietary restrictions, privacy concerns, or...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 43 Replication and Synthetic Data | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/replication-and-synthetic-data.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="Access to comprehensive data is pivotal for replication, especially in the realm of social sciences. Yet, data are often inaccessible due to proprietary restrictions, privacy concerns, or...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 43 Replication and Synthetic Data | A Guide on Data Analysis">
<meta name="twitter:description" content="Access to comprehensive data is pivotal for replication, especially in the realm of social sciences. Yet, data are often inaccessible due to proprietary restrictions, privacy concerns, or...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="sec-endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="sec-directed-acyclic-graphs.html"><span class="header-section-number">38</span> Directed Acyclic Graphs</a></li>
<li><a class="" href="sec-controls.html"><span class="header-section-number">39</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="active" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li><a class="" href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="replication-and-synthetic-data" class="section level1" number="43">
<h1>
<span class="header-section-number">43</span> Replication and Synthetic Data<a class="anchor" aria-label="anchor" href="#replication-and-synthetic-data"><i class="fas fa-link"></i></a>
</h1>
<p>Access to comprehensive data is pivotal for replication, especially in the realm of social sciences. Yet, data are often inaccessible due to proprietary restrictions, privacy concerns, or logistical constraints, making replication a challenge <span class="citation">(<a href="references.html#ref-king1995replication">G. King 1995</a>)</span>. This chapter explores the nuances of replication, exceptions to its norms, and the significance of synthetic data as a solution.</p>
<div id="the-replication-standard" class="section level2" number="43.1">
<h2>
<span class="header-section-number">43.1</span> The Replication Standard<a class="anchor" aria-label="anchor" href="#the-replication-standard"><i class="fas fa-link"></i></a>
</h2>
<p>Replicability in research ensures:</p>
<ul>
<li>
<strong>Credibility</strong> – Reinforces trust in empirical studies by allowing independent verification.</li>
<li>
<strong>Continuity</strong> – Enables future research to build upon prior findings, promoting cumulative knowledge.</li>
<li>
<strong>Visibility</strong> – Increases readership and citations, benefiting both individual researchers and the broader academic community.</li>
</ul>
<p>For research to be replicable, adhering to the <strong>replication standard</strong> is essential. This standard requires researchers to provide all necessary information—data, code, and methodological details—so that third parties can independently reproduce the study’s findings. While quantitative research often allows for clearer replication, qualitative studies pose challenges due to their depth, contextual nature, and reliance on subjective interpretation.</p>
<div id="solutions-for-empirical-replication" class="section level3" number="43.1.1">
<h3>
<span class="header-section-number">43.1.1</span> Solutions for Empirical Replication<a class="anchor" aria-label="anchor" href="#solutions-for-empirical-replication"><i class="fas fa-link"></i></a>
</h3>
<p>Several approaches help address replication challenges in empirical research:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Role of Individual Authors</strong>
<ul>
<li>Researchers must commit to transparency and provide well-documented data and code.</li>
<li>Repositories such as the <strong>Inter-University Consortium for Political and Social Research (ICPSR)</strong> offer secure, long-term storage for replication datasets.</li>
</ul>
</li>
<li>
<strong>Creation of a Replication Data Set</strong>
<ul>
<li>A dedicated <strong>replication dataset</strong> should include original data, relevant supplementary data, and the exact procedures used for analysis.</li>
<li>Metadata and documentation should be provided to ensure clarity.</li>
</ul>
</li>
<li>
<strong>Professional Data Archives</strong>
<ul>
<li>Organizations like <strong>ICPSR, Dataverse, and Zenodo</strong> facilitate open access to datasets while maintaining proper governance over sensitive information.</li>
<li>These archives help address data accessibility and preservation issues.</li>
</ul>
</li>
<li>
<strong>Educational Implications</strong>
<ul>
<li>Teaching replication strengthens students’ understanding of empirical methods and reproducibility.</li>
<li>Many graduate programs now incorporate replication studies into coursework, emphasizing their importance in methodological rigor.</li>
</ul>
</li>
</ol>
</div>
<div id="free-data-repositories" class="section level3" number="43.1.2">
<h3>
<span class="header-section-number">43.1.2</span> Free Data Repositories<a class="anchor" aria-label="anchor" href="#free-data-repositories"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Zenodo</strong>: Hosted by CERN, it provides a place for researchers to deposit datasets. It’s not subject-specific, so it caters to various disciplines.</p></li>
<li><p><strong>figshare</strong>: Allows researchers to upload, share, and cite their datasets.</p></li>
<li><p><strong>Dryad</strong>: Primarily for datasets associated with published articles in the biological and medical sciences.</p></li>
<li><p><strong>OpenICPSR</strong>: A public-facing version of the Inter-University Consortium for Political and Social Research (ICPSR) where researchers can deposit data without any cost.</p></li>
<li><p><strong>Harvard Dataverse</strong>: Hosted by Harvard University, this is an open-source repository software application dedicated to archiving, sharing, and citing research data.</p></li>
<li><p><strong>Mendeley Data</strong>: A multidisciplinary, free-to-use open access data repository where researchers can upload and share their datasets.</p></li>
<li><p><strong>Open Science Framework (OSF)</strong>: Offers both a platform for conducting research and a place to deposit datasets.</p></li>
<li><p><strong>PubMed Central</strong>: Specific to life sciences, but it’s an open repository for journal articles, preprints, and datasets.</p></li>
<li><p><strong>Registry of Research Data Repositories (re3data)</strong>: While not a repository itself, it provides a global registry of research data repositories from various academic disciplines.</p></li>
<li><p><strong>SocArXiv</strong>: An open archive for the social sciences.</p></li>
<li><p><strong>EarthArXiv</strong>: A preprints archive for earth science.</p></li>
<li><p><strong>Protein Data Bank (PDB)</strong>: For 3D structures of large biological molecules.</p></li>
<li><p><strong>Gene Expression Omnibus (GEO)</strong>: A public functional genomics data repository.</p></li>
<li><p><strong>The Language Archive (TLA)</strong>: Dedicated to data on languages worldwide, especially endangered languages.</p></li>
<li><p><strong>B2SHARE</strong>: A platform for storing and sharing research data sets in various disciplines, especially from European research projects.</p></li>
</ol>
</div>
<div id="exceptions-to-replication" class="section level3" number="43.1.3">
<h3>
<span class="header-section-number">43.1.3</span> Exceptions to Replication<a class="anchor" aria-label="anchor" href="#exceptions-to-replication"><i class="fas fa-link"></i></a>
</h3>
<p>While the replication standard is fundamental to scientific integrity, certain constraints may prevent full adherence. Some common exceptions include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Confidentiality</strong>
<ul>
<li>Some datasets contain highly sensitive information (e.g., medical records, personal financial data) that cannot be disclosed, even in a fragmented form.</li>
<li>Anonymization techniques and data aggregation can sometimes mitigate these concerns, but privacy regulations (e.g., GDPR, HIPAA) impose strict limitations.</li>
</ul>
</li>
<li>
<strong>Proprietary Data</strong>
<ul>
<li>Datasets owned by corporations, governments, or third-party vendors often have restricted access due to intellectual property concerns.</li>
<li>In many cases, researchers can share <strong>summary statistics, derived variables, or synthetic versions</strong> of the data while respecting proprietary restrictions.</li>
</ul>
</li>
<li>
<strong>Rights of First Publication</strong>
<ul>
<li>Some studies involve data embargoes, where researchers must delay public release until initial publications are completed.</li>
<li>Despite embargoes, the essential data and methodology should eventually be accessible to ensure transparency.</li>
</ul>
</li>
</ol>
</div>
<div id="replication-landscape" class="section level3" number="43.1.4">
<h3>
<span class="header-section-number">43.1.4</span> Replication Landscape<a class="anchor" aria-label="anchor" href="#replication-landscape"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Brodeur et al. (<a href="references.html#ref-brodeur2025comparing">2025</a>)</span> finds that while AI-assisted teams improve upon AI-led approaches, human-only teams remain the most effective at detecting major errors and ensuring reproducibility in quantitative social science research.</p>
<ul>
<li><p>Human teams and AI-assisted teams achieved similar reproducibility success rates, both significantly outperforming AI-led teams.</p></li>
<li><p>Human-only teams were 57 percentage points more successful than AI-led teams (p &lt; 0.001).</p></li>
<li><p>Error detection: Human teams identified significantly more major errors than AI-assisted teams (0.7 more errors per team, p = 0.017) and AI-led teams (1.1 more errors per team, p &lt; 0.001).</p></li>
<li><p>AI-assisted teams detected 0.4 more errors per team than AI-led teams (p = 0.029) but still fewer than human teams.</p></li>
<li><p>Robustness checks: Both human and AI-assisted teams were significantly better than AI-led teams in proposing (25 percentage points, p = 0.017) and implementing (33 percentage points, p = 0.005) comprehensive robustness checks.</p></li>
</ul>
<p><span class="citation">Huntington-Klein et al. (<a href="references.html#ref-huntington2025sources">2025</a>)</span> uses a three-stage many-analysts design to examine how researcher decisions influence variation in treatment effect estimates.</p>
<ul>
<li>146 research teams completed the same causal inference task three times under increasingly standardized conditions:</li>
</ul>
<pre><code>-    **Stage 1:** Few constraints (free-form analysis).

-    **Stage 2:** Prescribed research design.

-    **Stage 3:** Prescribed design plus pre-cleaned data.</code></pre>
<!-- -->
<ul>
<li><strong>Key findings:</strong></li>
</ul>
<pre><code>-    **Stage 1:** High variation in reported effects (IQR = 3.1 percentage points), with outliers.

-    **Stage 2:** Even greater variation (IQR = 4.0), due to imperfect protocol adherence.

-    **Stage 3:** Lowest variation (IQR = 2.4), suggesting data cleaning substantially reduces result heterogeneity.</code></pre>
<!-- -->
<ul>
<li><strong>Sample size convergence:</strong></li>
</ul>
<pre><code>-   IQR dropped from 295,187 (Stage 1) to 29,144 (Stage 2), and was effectively zero in Stage 3.

The results highlight the **critical role of data cleaning** in applied microeconomics and suggest **new directions for replication research**.</code></pre>
<hr>
</div>
</div>
<div id="synthetic-data" class="section level2" number="43.2">
<h2>
<span class="header-section-number">43.2</span> Synthetic Data<a class="anchor" aria-label="anchor" href="#synthetic-data"><i class="fas fa-link"></i></a>
</h2>
<p>Synthetic data, which models real data while ensuring anonymity, is becoming an essential tool in research. By generating artificial datasets that retain key statistical properties of the original data, researchers can <strong>preserve privacy, enhance data accessibility, and facilitate replication</strong>. However, synthetic data also introduces complexities and should be used with caution.</p>
<hr>
<div id="benefits-of-synthetic-data" class="section level3" number="43.2.1">
<h3>
<span class="header-section-number">43.2.1</span> Benefits of Synthetic Data<a class="anchor" aria-label="anchor" href="#benefits-of-synthetic-data"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Privacy Preservation</strong>
<ul>
<li>Protects sensitive or proprietary information while enabling research collaboration.</li>
</ul>
</li>
<li>
<strong>Data Fairness and Augmentation</strong>
<ul>
<li>Helps mitigate biases by generating more balanced datasets.</li>
<li>Can supplement real data when sample sizes are limited.</li>
</ul>
</li>
<li>
<strong>Acceleration in Research</strong>
<ul>
<li>Allows for data sharing in environments where access to real data is restricted.</li>
<li>Enables large-scale simulations without legal or ethical constraints.</li>
</ul>
</li>
</ol>
<hr>
</div>
<div id="concerns-and-limitations" class="section level3" number="43.2.2">
<h3>
<span class="header-section-number">43.2.2</span> Concerns and Limitations<a class="anchor" aria-label="anchor" href="#concerns-and-limitations"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Misconceptions About Privacy</strong>
<ul>
<li>Synthetic data does not guarantee absolute privacy—re-identification risks remain if it is too similar to the real dataset.</li>
</ul>
</li>
<li>
<strong>Challenges with Data Outliers</strong>
<ul>
<li>Rare but important data points may be poorly represented or excluded.</li>
</ul>
</li>
<li>
<strong>Risks of Solely Relying on Synthetic Data</strong>
<ul>
<li>Models trained exclusively on synthetic data may lack generalizability.</li>
<li>Differences between real and synthetic distributions can introduce biases.</li>
</ul>
</li>
</ol>
<hr>
</div>
<div id="further-insights-on-synthetic-data" class="section level3" number="43.2.3">
<h3>
<span class="header-section-number">43.2.3</span> Further Insights on Synthetic Data<a class="anchor" aria-label="anchor" href="#further-insights-on-synthetic-data"><i class="fas fa-link"></i></a>
</h3>
<p>Synthetic data acts as a bridge between <strong>model-centric and data-centric perspectives</strong>, making it a vital tool in modern research. An analogy can be drawn to <strong>viewing a replica of the Mona Lisa</strong>—the essence remains, but the original is securely stored.</p>
<p>For a deeper dive into synthetic data and its applications, refer to <span class="citation">(<a href="references.html#ref-jordon2022synthetic">Jordon et al. 2022</a>)</span>.</p>
<hr>
</div>
<div id="generating-synthetic-data" class="section level3" number="43.2.4">
<h3>
<span class="header-section-number">43.2.4</span> Generating Synthetic Data<a class="anchor" aria-label="anchor" href="#generating-synthetic-data"><i class="fas fa-link"></i></a>
</h3>
<p>When generating synthetic data, the approach depends on whether researchers have full access to the original dataset or are working under restricted conditions.</p>
<div id="when-you-have-access-to-the-original-dataset" class="section level4" number="43.2.4.1">
<h4>
<span class="header-section-number">43.2.4.1</span> When You Have Access to the Original Dataset<a class="anchor" aria-label="anchor" href="#when-you-have-access-to-the-original-dataset"><i class="fas fa-link"></i></a>
</h4>
<p>If researchers can directly use the dataset, various techniques can be employed to generate synthetic data while preserving the statistical properties of the original:</p>
<ul>
<li>
<strong>Statistical Approaches</strong>
<ul>
<li>
<strong>Parametric models (e.g., Gaussian Mixture Models)</strong>
<ul>
<li>Fit statistical distributions to real data and sample synthetic observations.</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>Machine Learning-Based Methods</strong>
<ul>
<li>
<strong>Variational Autoencoders (VAEs)</strong> – Useful for structured, complex data representations.</li>
<li>
<strong>Generative Adversarial Networks (GANs)</strong> – Effective for generating high-dimensional data (e.g., tabular, image, and text data).</li>
<li>
<strong>CTGAN (Conditional Tabular GAN)</strong> – Specifically designed for structured, tabular datasets, addressing categorical and imbalanced data challenges.</li>
</ul>
</li>
<li>
<strong>Differential Privacy Techniques</strong>
<ul>
<li>
<strong>Noise Addition</strong> – Introduces controlled noise while maintaining the overall statistical structure.</li>
</ul>
</li>
</ul>
</div>
<div id="when-you-have-a-restricted-dataset" class="section level4" number="43.2.4.2">
<h4>
<span class="header-section-number">43.2.4.2</span> When You Have a Restricted Dataset<a class="anchor" aria-label="anchor" href="#when-you-have-a-restricted-dataset"><i class="fas fa-link"></i></a>
</h4>
<p>In cases where <strong>data cannot be exported</strong> due to security, privacy, or proprietary constraints, researchers must rely on alternative strategies to generate synthetic data:</p>
<ul>
<li>
<strong>Summarization and Approximation</strong>
<ul>
<li>Extract summary statistics (e.g., means, variances, correlations) to approximate the dataset’s structure.</li>
<li>If permitted, share aggregated or anonymized data instead of raw observations.</li>
</ul>
</li>
<li>
<strong>Server-Based Computation</strong>
<ul>
<li>Conduct in-server analyses where raw data remains inaccessible, but synthetic outputs can be generated on the secure system.</li>
</ul>
</li>
<li>
<strong>Synthetic Data Generation with Preserved Properties</strong>
<ul>
<li>Use models trained on the secure dataset to produce synthetic data without directly copying real observations.</li>
<li>Ensure that key statistical relationships are maintained, even if individual values differ.</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="application-5" class="section level2" number="43.3">
<h2>
<span class="header-section-number">43.3</span> Application<a class="anchor" aria-label="anchor" href="#application-5"><i class="fas fa-link"></i></a>
</h2>
<div id="original-dataset" class="section level3" number="43.3.1">
<h3>
<span class="header-section-number">43.3.1</span> Original Dataset<a class="anchor" aria-label="anchor" href="#original-dataset"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Import libraries</li>
</ol>
<div class="sourceCode" id="cb1095"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://copula.r-forge.r-project.org/">copula</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org">moments</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/braverock/PerformanceAnalytics">PerformanceAnalytics</a></span><span class="op">)</span>  <span class="co"># For correlation plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Simulate a Complex, Nonlinear, Hierarchical Time Series</li>
</ol>
<p>Suppose we have:</p>
<ul>
<li><p><span class="math inline">\(G = 3\)</span> groups (e.g., groups 1, 2, 3)</p></li>
<li><p>Each group has <span class="math inline">\(N = 50\)</span> units (e.g., individuals or devices)</p></li>
<li><p>Each unit is measured at <span class="math inline">\(T = 20\)</span> time points</p></li>
</ul>
<p>We’ll create four continuous variables, <code>X1</code> through <code>X4</code>, each influenced by:</p>
<ul>
<li><p>A group-level random effect (different intercept by group)</p></li>
<li><p>A unit-level random effect (different intercept by unit)</p></li>
<li><p>Time (with some nonlinear relationships, e.g., sine, polynomial)</p></li>
<li><p>Nonlinear cross-relationships among X1–X4</p></li>
</ul>
<p>This gives us a total of <span class="math inline">\(3 \times 50 \times 20=3000\)</span> rows in the “original” dataset.</p>
<div class="sourceCode" id="cb1096"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">3</span>    <span class="co"># Number of groups</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span>   <span class="co"># Units per group</span></span>
<span><span class="va">Tt</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># Time points per unit</span></span>
<span></span>
<span><span class="co"># Create a data frame structure</span></span>
<span><span class="va">df_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Group-level random intercept</span></span>
<span>  <span class="va">group_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">u</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Unit-level random intercept</span></span>
<span>    <span class="va">unit_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Simulate time points</span></span>
<span>    <span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Tt</span></span>
<span>    </span>
<span>    <span class="co"># Create some base patterns</span></span>
<span>    <span class="va">X1_base</span> <span class="op">&lt;-</span> <span class="va">group_intercept</span> <span class="op">+</span> <span class="va">unit_intercept</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="va">time_points</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Nonlinear time pattern</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Introduce different relationships for X2, X3, X4</span></span>
<span>    <span class="co"># Some polynomial in time, plus dependence on X1</span></span>
<span>    <span class="va">X2_base</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X1_base</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">time_points</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>    <span class="va">X3_base</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">group_intercept</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">X1_base</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">time_points</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>    <span class="va">X4_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">X1_base</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">X2_base</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">X3_base</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>      group <span class="op">=</span> <span class="va">g</span>,</span>
<span>      unit  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="va">g</span>, <span class="st">"_U"</span>, <span class="va">u</span><span class="op">)</span>,</span>
<span>      time  <span class="op">=</span> <span class="va">time_points</span>,</span>
<span>      X1    <span class="op">=</span> <span class="va">X1_base</span>,</span>
<span>      X2    <span class="op">=</span> <span class="va">X2_base</span>,</span>
<span>      X3    <span class="op">=</span> <span class="va">X3_base</span>,</span>
<span>      X4    <span class="op">=</span> <span class="va">X4_base</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_temp</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">df_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Inspect the first rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group  unit time           X1        X2        X3         X4</span></span>
<span><span class="co">#&gt; 1     1 G1_U1    1 -0.165153398 0.2194743 0.9291383  0.3963423</span></span>
<span><span class="co">#&gt; 2     1 G1_U1    2 -0.272044371 0.8553408 2.0535411 -0.3918278</span></span>
<span><span class="co">#&gt; 3     1 G1_U1    3 -0.085064371 1.3197242 2.0929304 -0.3268864</span></span>
<span><span class="co">#&gt; 4     1 G1_U1    4  0.384804697 1.6420667 1.7088991  0.6649585</span></span>
<span><span class="co">#&gt; 5     1 G1_U1    5  0.258089835 2.8179465 2.0732799  0.7771992</span></span>
<span><span class="co">#&gt; 6     1 G1_U1    6  0.003462448 3.0460239 2.2910647  0.4905209</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Explore the Original Dataset</li>
</ol>
<p>Let’s do some <strong>descriptive statistics</strong> and look at the <strong>correlations</strong> among X1–X4.<br>
Because we have repeated measures (time series) nested in units and groups, these correlations are “pooled” across all rows. This is a simplification, but it will let us demonstrate how to do a copula-based synthetic approach.</p>
<div class="sourceCode" id="cb1097"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Descriptive stats (overall)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;        X1                X2                 X3                X4         </span></span>
<span><span class="co">#&gt;  Min.   :-4.8316   Min.   :-0.02119   Min.   :-0.7811   Min.   :-1.2191  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.8272   1st Qu.: 4.47120   1st Qu.: 1.5865   1st Qu.: 0.5339  </span></span>
<span><span class="co">#&gt;  Median :-0.3883   Median : 7.08316   Median : 2.4366   Median : 1.1073  </span></span>
<span><span class="co">#&gt;  Mean   :-0.6520   Mean   : 7.76411   Mean   : 2.3832   Mean   : 1.3118  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.4869   3rd Qu.: 9.65271   3rd Qu.: 3.3120   3rd Qu.: 1.8859  </span></span>
<span><span class="co">#&gt;  Max.   : 2.5247   Max.   :33.30223   Max.   : 4.9642   Max.   : 6.8820</span></span>
<span></span>
<span><span class="co"># Skewness &amp; Kurtosis</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">skewness</span><span class="op">)</span></span>
<span><span class="co">#&gt;         X1         X2         X3         X4 </span></span>
<span><span class="co">#&gt; -0.3515255  1.3614289 -0.3142704  0.9435834</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">kurtosis</span><span class="op">)</span></span>
<span><span class="co">#&gt;         X1         X2         X3         X4 </span></span>
<span><span class="co">#&gt; -0.7689287  2.6280956 -0.6086295  1.1138128</span></span>
<span></span>
<span><span class="co"># Correlation matrix</span></span>
<span><span class="op">(</span><span class="va">cor_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;            X1         X2         X3         X4</span></span>
<span><span class="co">#&gt; X1  1.0000000 -0.6865655  0.3948406 -0.7035793</span></span>
<span><span class="co">#&gt; X2 -0.6865655  1.0000000  0.1301602  0.7532715</span></span>
<span><span class="co">#&gt; X3  0.3948406  0.1301602  1.0000000 -0.3660620</span></span>
<span><span class="co">#&gt; X4 -0.7035793  0.7532715 -0.3660620  1.0000000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/chart.Correlation.html">chart.Correlation</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  histogram <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></div>
<ol start="4" style="list-style-type: decimal">
<li>Convert to Pseudo-Observations for Copula Fitting</li>
</ol>
<p>Copulas need variables in <span class="math inline">\([0,1]\)</span> space, so we use the <strong>empirical CDF</strong> (“probability integral transform”) on each variable.</p>
<blockquote>
<p><strong>Important</strong>: We have discrete variables like <code>group</code>, or ID-like columns such as <code>unit</code>. For the synthetic generation of group/unit/time, we have multiple strategies:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Model them as random</strong>: e.g., re-sample <code>group</code>, <code>unit</code>, <code>time</code> from the original distribution.</p></li>
<li><p><strong>Treat them as continuous</strong> in a copula (not recommended for true IDs).</p></li>
<li><p><strong>Do a hierarchical approach</strong>: fit a separate copula for each group or each time slice (advanced).</p></li>
</ol>
</blockquote>
<p>For simplicity, we’ll:</p>
<ol style="list-style-type: decimal">
<li><p>Re-sample <code>group</code> and <code>time</code> from their original distributions (like “bootstrapping”).</p></li>
<li><p>Use a <strong>multivariate copula</strong> only for <code>X1–X4</code>.</p></li>
</ol>
<div class="sourceCode" id="cb1098"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the numeric columns we want to transform</span></span>
<span><span class="va">original_data</span> <span class="op">&lt;-</span> <span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert each to uniform [0,1] by empirical CDF</span></span>
<span><span class="va">u_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/pobs.html">pobs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">original_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check ranges (should be between 0 and 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">u_data</span>, <span class="fl">2</span>, <span class="va">range</span><span class="op">)</span></span>
<span><span class="co">#&gt;                X1           X2           X3           X4</span></span>
<span><span class="co">#&gt; [1,] 0.0003332223 0.0003332223 0.0003332223 0.0003332223</span></span>
<span><span class="co">#&gt; [2,] 0.9996667777 0.9996667777 0.9996667777 0.9996667777</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Fit a Copula Model</li>
</ol>
<p>We’ll fit a <strong>Gaussian copula</strong> (you could try <strong>t-copula</strong> or <strong>vine copulas</strong> for heavier tails or more complex dependencies). We use maximum likelihood estimation:</p>
<div class="sourceCode" id="cb1099"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define an unstructured Gaussian copula</span></span>
<span><span class="va">gaussCop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/ellipCopula.html">normalCopula</a></span><span class="op">(</span>dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">u_data</span><span class="op">)</span>, dispstr <span class="op">=</span> <span class="st">"un"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit to the pseudo-observations</span></span>
<span><span class="va">fit_gauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/fitCopula.html">fitCopula</a></span><span class="op">(</span><span class="va">gaussCop</span>, data <span class="op">=</span> <span class="va">u_data</span>, method <span class="op">=</span> <span class="st">"ml"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_gauss</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call: fitCopula(gaussCop, data = u_data, method = "ml")</span></span>
<span><span class="co">#&gt; Fit based on "maximum likelihood" and 3000 4-dimensional observations.</span></span>
<span><span class="co">#&gt; Normal copula, dim. d = 4 </span></span>
<span><span class="co">#&gt;       Estimate Std. Error</span></span>
<span><span class="co">#&gt; rho.1  -0.5746      0.010</span></span>
<span><span class="co">#&gt; rho.2   0.3024      0.014</span></span>
<span><span class="co">#&gt; rho.3  -0.5762      0.010</span></span>
<span><span class="co">#&gt; rho.4   0.2188      0.013</span></span>
<span><span class="co">#&gt; rho.5   0.6477      0.008</span></span>
<span><span class="co">#&gt; rho.6  -0.3562      0.012</span></span>
<span><span class="co">#&gt; The maximized loglikelihood is 2885 </span></span>
<span><span class="co">#&gt; Optimization converged</span></span>
<span><span class="co">#&gt; Number of loglikelihood evaluations:</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;       68       14</span></span></code></pre></div>
<p>Check the estimated correlation matrix within the copula. This should reflect the dependency among X1–X4 (though not time, group, or unit).</p>
<ol start="6" style="list-style-type: decimal">
<li>Generate Synthetic Data</li>
</ol>
<ul>
<li>Synthetic X1–X4
<ol style="list-style-type: decimal">
<li>
<strong>Sample</strong> from the fitted copula to get synthetic <span class="math inline">\([0,1]\)</span> values.</li>
<li>
<strong>Invert</strong> them via the original empirical distributions (quantiles).</li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb1100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_synth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span>  <span class="co"># same size as original</span></span>
<span></span>
<span><span class="co"># Sample from the copula</span></span>
<span><span class="va">u_synth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/copula/man/Copula.html">rCopula</a></span><span class="op">(</span><span class="va">n_synth</span>, <span class="va">fit_gauss</span><span class="op">@</span><span class="va">copula</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert from [0,1] -&gt; real scale by matching original distribution</span></span>
<span><span class="va">synth_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>    X1_synth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">original_data</span><span class="op">$</span><span class="va">X1</span>, probs <span class="op">=</span> <span class="va">u_synth</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>                        type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    X2_synth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">original_data</span><span class="op">$</span><span class="va">X2</span>, probs <span class="op">=</span> <span class="va">u_synth</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>                        type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    X3_synth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">original_data</span><span class="op">$</span><span class="va">X3</span>, probs <span class="op">=</span> <span class="va">u_synth</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>,</span>
<span>                        type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    X4_synth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">original_data</span><span class="op">$</span><span class="va">X4</span>, probs <span class="op">=</span> <span class="va">u_synth</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span>,</span>
<span>                        type <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">synth_X</span><span class="op">)</span></span>
<span><span class="co">#&gt;                X1_synth X2_synth  X3_synth   X4_synth</span></span>
<span><span class="co">#&gt; 68.93791982%  0.2965446 3.488621 2.0876565  0.9336342</span></span>
<span><span class="co">#&gt; 40.75838264% -0.8903883 5.341148 3.4134562  0.4857101</span></span>
<span><span class="co">#&gt; 80.51755107%  0.6841892 2.536933 0.5329199  1.3494999</span></span>
<span><span class="co">#&gt; 29.87601496% -1.5123574 8.127288 0.4861639  3.2120501</span></span>
<span><span class="co">#&gt; 68.75449744%  0.2855353 3.219903 2.1439338 -0.3848253</span></span>
<span><span class="co">#&gt; 35.73763642% -1.1651872 5.717179 2.7372298  0.6252287</span></span></code></pre></div>
<ul>
<li>Synthetic Group, Unit, and Time</li>
</ul>
<p>A simple approach is to:</p>
<ul>
<li><p><strong>Re-sample “group”</strong> with the same probabilities as the original distribution.</p></li>
<li><p><strong>Re-sample “unit”</strong> within each group or treat it as purely random labels (depending on your needs).</p></li>
<li><p><strong>Re-sample “time”</strong> from the original distribution or replicate the same time points.</p></li>
</ul>
<p>Below, we do a simplistic approach: for each row, pick a random row from the original data to copy <code>group</code>, <code>unit</code>, and <code>time</code>. This preserves the real distribution of group/time pairs and the frequency of each unit. (But it does <strong>not</strong> preserve the original time-series ordering or autoregressive structure!)</p>
<div class="sourceCode" id="cb1101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indices</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           size <span class="op">=</span> <span class="va">n_synth</span>,</span>
<span>           replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">synth_meta</span> <span class="op">&lt;-</span> <span class="va">df_original</span><span class="op">[</span><span class="va">indices</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"unit"</span>, <span class="st">"time"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Combine the meta-info with the synthetic X's</span></span>
<span><span class="va">df_synth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">synth_meta</span>, <span class="va">synth_X</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">)</span></span>
<span><span class="co">#&gt;      group   unit time   X1_synth X2_synth  X3_synth   X4_synth</span></span>
<span><span class="co">#&gt; 1029     2  G2_U2    9  0.2965446 3.488621 2.0876565  0.9336342</span></span>
<span><span class="co">#&gt; 2279     3 G3_U14   19 -0.8903883 5.341148 3.4134562  0.4857101</span></span>
<span><span class="co">#&gt; 1885     2 G2_U45    5  0.6841892 2.536933 0.5329199  1.3494999</span></span>
<span><span class="co">#&gt; 2251     3 G3_U13   11 -1.5123574 8.127288 0.4861639  3.2120501</span></span>
<span><span class="co">#&gt; 1160     2  G2_U8   20  0.2855353 3.219903 2.1439338 -0.3848253</span></span>
<span><span class="co">#&gt; 2222     3 G3_U12    2 -1.1651872 5.717179 2.7372298  0.6252287</span></span></code></pre></div>
<p>If you <strong>need</strong> to preserve the exact time-ordering or real “per-unit” correlation across time, you’d need a more advanced approach (e.g., separate copula by unit or a hierarchical time-series model).</p>
<ol start="7" style="list-style-type: decimal">
<li>Validate the Synthetic Data</li>
</ol>
<ul>
<li>Compare Descriptive Statistics</li>
</ul>
<div class="sourceCode" id="cb1102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original</span></span>
<span><span class="va">orig_means</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">colMeans</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">orig_sds</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">orig_skew</span>   <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">skewness</span><span class="op">)</span></span>
<span><span class="va">orig_kurt</span>   <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">kurtosis</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Synthetic</span></span>
<span><span class="va">synth_means</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">colMeans</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">synth_sds</span>   <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">synth_skew</span>  <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">skewness</span><span class="op">)</span></span>
<span><span class="va">synth_kurt</span>  <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">kurtosis</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="st">"### Means ###\nOriginal:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">orig_means</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nSynthetic:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_means</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ### Means ###</span></span>
<span><span class="co">#&gt; Original: -0.652 7.764 2.383 1.312 </span></span>
<span><span class="co">#&gt; Synthetic: -0.642 7.741 2.372 1.287</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="st">"### SDs ###\nOriginal:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">orig_sds</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nSynthetic:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_sds</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ### SDs ###</span></span>
<span><span class="co">#&gt; Original: 1.448 4.937 1.16 1.102 </span></span>
<span><span class="co">#&gt; Synthetic: 1.449 5.046 1.159 1.102</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="st">"### Skewness ###\nOriginal:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">orig_skew</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nSynthetic:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_skew</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ### Skewness ###</span></span>
<span><span class="co">#&gt; Original: -0.352 1.361 -0.314 0.944 </span></span>
<span><span class="co">#&gt; Synthetic: -0.349 1.353 -0.317 1.017</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>    <span class="st">"### Kurtosis ###\nOriginal:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">orig_kurt</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\nSynthetic:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_kurt</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; ### Kurtosis ###</span></span>
<span><span class="co">#&gt; Original: -0.769 2.628 -0.609 1.114 </span></span>
<span><span class="co">#&gt; Synthetic: -0.744 2.465 -0.619 1.381</span></span></code></pre></div>
<ul>
<li>Compare Correlation Matrices</li>
</ul>
<div class="sourceCode" id="cb1103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Original correlation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original correlation:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;        X1     X2     X3     X4</span></span>
<span><span class="co">#&gt; X1  1.000 -0.687  0.395 -0.704</span></span>
<span><span class="co">#&gt; X2 -0.687  1.000  0.130  0.753</span></span>
<span><span class="co">#&gt; X3  0.395  0.130  1.000 -0.366</span></span>
<span><span class="co">#&gt; X4 -0.704  0.753 -0.366  1.000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSynthetic correlation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Synthetic correlation:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X1_synth X2_synth X3_synth X4_synth</span></span>
<span><span class="co">#&gt; X1_synth    1.000   -0.562    0.288   -0.565</span></span>
<span><span class="co">#&gt; X2_synth   -0.562    1.000    0.195    0.636</span></span>
<span><span class="co">#&gt; X3_synth    0.288    0.195    1.000   -0.346</span></span>
<span><span class="co">#&gt; X4_synth   -0.565    0.636   -0.346    1.000</span></span></code></pre></div>
<ul>
<li>Visual Comparison of Distributions</li>
</ul>
<div class="sourceCode" id="cb1104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>        <span class="va">df_original</span><span class="op">[[</span><span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>        <span class="va">df_synth</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"_synth"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        breaks <span class="op">=</span> <span class="fl">30</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">"Synthetic"</span>, <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/legend.html">legend</a></span><span class="op">(</span></span>
<span>        <span class="st">"topright"</span>,</span>
<span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="st">"Synthetic"</span><span class="op">)</span>,</span>
<span>        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;"></div>
<ul>
<li>Correlation Plot for Synthetic Data</li>
</ul>
<div class="sourceCode" id="cb1105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/chart.Correlation.html">chart.Correlation</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1_synth"</span>, <span class="st">"X2_synth"</span>, <span class="st">"X3_synth"</span>, <span class="st">"X4_synth"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                  histogram <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;"></div>
<ul>
<li><p><strong>Indistinguishability</strong>: If the synthetic summary statistics (means, variances, skewness, kurtosis) and correlation structure match closely, the synthetic data is often “indistinguishable” from the original for many analytical purposes.</p></li>
<li>
<p><strong>Hierarchical / Time-Series</strong>: True hierarchical time-series replication (i.e., preserving each unit’s time autocorrelation and group structure) may require more advanced methods, such as:</p>
<ul>
<li><p><strong>Hierarchical copulas</strong> or <strong>vine copulas</strong> over time slices.</p></li>
<li><p><strong>Mixed-effects / random-effects</strong> modeling (e.g., for group and unit) plus a copula for residuals.</p></li>
<li><p><strong>Deep generative approaches</strong> (e.g., TimeGAN) for strong temporal dynamics, currently more common in Python.</p></li>
</ul>
</li>
<li>
<p><strong>Categorical Variables</strong>: For strictly categorical variables (e.g., group, unit ID), you can:</p>
<ul>
<li><p>Fit separate copulas within each group.</p></li>
<li><p>Convert categories to numeric in a naive way (not recommended for actual IDs) or use specialized <strong>discrete copulas</strong>.</p></li>
</ul>
</li>
<li><p><strong>Privacy Considerations</strong>: Even if data is synthetic, do check that it doesn’t inadvertently leak private information (e.g., via memorizing outliers). Techniques like <strong>differential privacy</strong> or <strong>post-hoc checks</strong> might be required.</p></li>
</ul>
</div>
<div id="restricted-dataset" class="section level3" number="43.3.2">
<h3>
<span class="header-section-number">43.3.2</span> Restricted Dataset<a class="anchor" aria-label="anchor" href="#restricted-dataset"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><strong>Generate the “Original” Complex Dataset</strong></li>
</ol>
<p>We’ll simulate a hierarchical time-series with:</p>
<ul>
<li><p><span class="math inline">\(G = 3\)</span> groups</p></li>
<li><p><span class="math inline">\(N = 50\)</span> units per group</p></li>
<li><p><span class="math inline">\(T = 20\)</span> time points per unit</p></li>
<li><p>Nonlinear relationships between <code>X1</code>, <code>X2</code>, <code>X3</code>, <code>X4</code>.</p></li>
</ul>
<div class="sourceCode" id="cb1106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Generate "df_original" (what the partner owns internally)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">3</span>    <span class="co"># Number of groups</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">50</span>   <span class="co"># Units per group</span></span>
<span><span class="va">Tt</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># Time points per unit</span></span>
<span></span>
<span><span class="va">df_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Group-level random intercept</span></span>
<span>  <span class="va">group_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">u</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Unit-level random intercept</span></span>
<span>    <span class="va">unit_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Simulate time points</span></span>
<span>    <span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">Tt</span></span>
<span>    </span>
<span>    <span class="co"># Create some base patterns (X1)</span></span>
<span>    <span class="va">X1_base</span> <span class="op">&lt;-</span> <span class="va">group_intercept</span> <span class="op">+</span> <span class="va">unit_intercept</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="va">time_points</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Nonlinear time pattern</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># X2 depends on polynomial in time, plus dependence on X1</span></span>
<span>    <span class="va">X2_base</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X1_base</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">time_points</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, <span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># X3 depends on group intercept, negative correlation with X1, and log(time)</span></span>
<span>    <span class="va">X3_base</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">group_intercept</span> <span class="op">-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">X1_base</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">time_points</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># X4 depends on X1, X2, X3 in a more complex, nonlinear form</span></span>
<span>    <span class="va">X4_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">X1_base</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">X2_base</span> <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X3_base</span> <span class="op">+</span> </span>
<span>               <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">Tt</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>      group <span class="op">=</span> <span class="va">g</span>,</span>
<span>      unit  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="va">g</span>, <span class="st">"_U"</span>, <span class="va">u</span><span class="op">)</span>,</span>
<span>      time  <span class="op">=</span> <span class="va">time_points</span>,</span>
<span>      X1    <span class="op">=</span> <span class="va">X1_base</span>,</span>
<span>      X2    <span class="op">=</span> <span class="va">X2_base</span>,</span>
<span>      X3    <span class="op">=</span> <span class="va">X3_base</span>,</span>
<span>      X4    <span class="op">=</span> <span class="va">X4_base</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df_temp</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">df_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Inspect the first rows (just for illustration)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group  unit time           X1        X2        X3         X4</span></span>
<span><span class="co">#&gt; 1     1 G1_U1    1 -0.165153398 0.2194743 0.9291383  0.3963423</span></span>
<span><span class="co">#&gt; 2     1 G1_U1    2 -0.272044371 0.8553408 2.0535411 -0.3918278</span></span>
<span><span class="co">#&gt; 3     1 G1_U1    3 -0.085064371 1.3197242 2.0929304 -0.3268864</span></span>
<span><span class="co">#&gt; 4     1 G1_U1    4  0.384804697 1.6420667 1.7088991  0.6649585</span></span>
<span><span class="co">#&gt; 5     1 G1_U1    5  0.258089835 2.8179465 2.0732799  0.7771992</span></span>
<span><span class="co">#&gt; 6     1 G1_U1    6  0.003462448 3.0460239 2.2910647  0.4905209</span></span></code></pre></div>
<p>At this point, imagine <code>df_original</code> lives <em>only</em> on the partner’s server and cannot be exported in its raw form.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Manually Collect Summary Statistics (Inside Secure Server)</strong></li>
</ol>
<p>Within the secure environment, you would run commands to get:</p>
<ul>
<li><p>Means, standard deviations for each variable</p></li>
<li><p>Correlation matrix</p></li>
<li><p>Group distribution info (how many groups, units, etc.)</p></li>
<li><p>Any other relevant stats (min, max, skewness, kurtosis, etc.) you might use</p></li>
</ul>
<p>Below, we’ll do that <em>directly</em> in code—<strong>but in reality</strong>, you would just write these numbers down or save them in a doc, not export the raw data.</p>
<div class="sourceCode" id="cb1107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 2: Summaries from "df_original" (pretend we can't take the actual df out)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For demonstration, we'll compute them here:</span></span>
<span><span class="va">stats_summary</span> <span class="op">&lt;-</span> <span class="va">df_original</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>    mean_X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html">mean</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>    mean_X3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html">mean</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>    mean_X4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html">mean</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>    </span>
<span>    sd_X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>    sd_X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>    sd_X3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>    sd_X4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the correlation matrix among (X1, X2, X3, X4)</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also note the group info</span></span>
<span><span class="va">unique_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html">unique</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">group_sizes</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html">table</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">N_groups</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">unique_groups</span><span class="op">)</span></span>
<span><span class="va">unit_example</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html">unique</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">$</span><span class="va">unit</span><span class="op">[</span><span class="va">df_original</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_points</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html">unique</a></span><span class="op">(</span><span class="va">df_original</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">df_original</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">df_original</span><span class="op">$</span><span class="va">unit</span> <span class="op">==</span> <span class="st">"G1_U1"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print them out as if we wrote them down</span></span>
<span><span class="va">stats_summary</span></span>
<span><span class="co">#&gt;     mean_X1  mean_X2  mean_X3  mean_X4    sd_X1    sd_X2    sd_X3    sd_X4</span></span>
<span><span class="co">#&gt; 1 -0.651988 7.764111 2.383214 1.311789 1.448297 4.937284 1.160375 1.102264</span></span>
<span><span class="va">cor_matrix</span></span>
<span><span class="co">#&gt;            X1         X2         X3         X4</span></span>
<span><span class="co">#&gt; X1  1.0000000 -0.6865655  0.3948406 -0.7035793</span></span>
<span><span class="co">#&gt; X2 -0.6865655  1.0000000  0.1301602  0.7532715</span></span>
<span><span class="co">#&gt; X3  0.3948406  0.1301602  1.0000000 -0.3660620</span></span>
<span><span class="co">#&gt; X4 -0.7035793  0.7532715 -0.3660620  1.0000000</span></span>
<span><span class="va">group_sizes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    1    2    3 </span></span>
<span><span class="co">#&gt; 1000 1000 1000</span></span>
<span><span class="va">N_groups</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="va">unit_example</span></span>
<span><span class="co">#&gt; [1] 50</span></span>
<span><span class="va">time_points</span></span>
<span><span class="co">#&gt; [1] 20</span></span></code></pre></div>
<p><strong>Example Output</strong> (numbers will vary):</p>
<ul>
<li><p>Means, SDs of each variable</p></li>
<li><p>4×4 correlation matrix</p></li>
<li><p><code>group_sizes</code>: each group has 50×20 = 1000 rows</p></li>
<li><p><code>N_groups</code>: 3</p></li>
</ul>
<p><strong>Simulating What We “Take Out”</strong></p>
<p>Pretend these are the <strong>only</strong> data you’re allowed to copy into your local machine:</p>
<div class="sourceCode" id="cb1108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># (Pretend these are typed or copy-pasted from the secure environment)</span></span>
<span></span>
<span><span class="co"># Means and SDs:</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">stats_summary</span><span class="op">$</span><span class="va">mean_X1</span>, <span class="va">stats_summary</span><span class="op">$</span><span class="va">mean_X2</span>, </span>
<span>           <span class="va">stats_summary</span><span class="op">$</span><span class="va">mean_X3</span>, <span class="va">stats_summary</span><span class="op">$</span><span class="va">mean_X4</span><span class="op">)</span></span>
<span><span class="va">sds</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">stats_summary</span><span class="op">$</span><span class="va">sd_X1</span>,   <span class="va">stats_summary</span><span class="op">$</span><span class="va">sd_X2</span>,   </span>
<span>           <span class="va">stats_summary</span><span class="op">$</span><span class="va">sd_X3</span>,   <span class="va">stats_summary</span><span class="op">$</span><span class="va">sd_X4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Correlation matrix:</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="va">cor_matrix</span></span>
<span></span>
<span><span class="co"># Hierarchical structure info:</span></span>
<span><span class="va">G_outside</span>   <span class="op">&lt;-</span> <span class="va">N_groups</span>  <span class="co"># 3</span></span>
<span><span class="va">N_outside</span>   <span class="op">&lt;-</span> <span class="va">unit_example</span>  <span class="co"># 50</span></span>
<span><span class="va">Tt_outside</span>  <span class="op">&lt;-</span> <span class="va">time_points</span>   <span class="co"># 20</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Reconstruct Covariance Matrix and Distribution (Outside)</strong></li>
</ol>
<p>Outside, you now have:</p>
<ul>
<li><p>A mean vector for <code>(X1, X2, X3, X4)</code></p></li>
<li><p>Standard deviations for each</p></li>
<li><p>A correlation matrix <span class="math inline">\(R\)</span></p></li>
<li><p>Basic knowledge: 3 groups, 50 units each, 20 time points each (or however the real data is structured)</p></li>
</ul>
<p>Build the covariance <span class="math inline">\(\Sigma\)</span> from the correlation matrix and SDs:</p>
<div class="sourceCode" id="cb1109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 3: Covariance matrix = diag(SDs) %*% R %*% diag(SDs)</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html">diag</a></span><span class="op">(</span><span class="va">sds</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">R</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html">diag</a></span><span class="op">(</span><span class="va">sds</span><span class="op">)</span></span>
<span><span class="va">Sigma</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]</span></span>
<span><span class="co">#&gt; [1,]  2.0975651 -4.9093928  0.6635565 -1.1231984</span></span>
<span><span class="co">#&gt; [2,] -4.9093928 24.3767734  0.7457009  4.0994482</span></span>
<span><span class="co">#&gt; [3,]  0.6635565  0.7457009  1.3464702 -0.4682079</span></span>
<span><span class="co">#&gt; [4,] -1.1231984  4.0994482 -0.4682079  1.2149866</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Generate a Synthetic Dataset Matching Those Stats</strong></li>
</ol>
<p>We’ll replicate the same <strong>hierarchical shape</strong>: 3 groups, 50 units, 20 time points. But we’ll fill in <code>(X1, X2, X3, X4)</code> by sampling from <strong>multivariate normal</strong> with <code>(means, Sigma)</code>.</p>
<blockquote>
<p>In practice, you might want to add back random intercepts for groups or time trends if your manual stats include that. However, if all you have are overall means, SDs, and a correlation matrix, the simplest approach is to assume a single global distribution for X1–X4.</p>
</blockquote>
<div class="sourceCode" id="cb1110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span>  <span class="co"># Synthetic data seed (different from original)</span></span>
<span></span>
<span><span class="va">df_synth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G_outside</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">u</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N_outside</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Tt_outside</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Draw one sample from the 4D normal</span></span>
<span>      <span class="va">X_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="va">means</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        group <span class="op">=</span> <span class="va">g</span>,</span>
<span>        unit  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="va">g</span>, <span class="st">"_U"</span>, <span class="va">u</span><span class="op">)</span>,</span>
<span>        time  <span class="op">=</span> <span class="va">t</span>,</span>
<span>        X1    <span class="op">=</span> <span class="va">X_vector</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>        X2    <span class="op">=</span> <span class="va">X_vector</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        X3    <span class="op">=</span> <span class="va">X_vector</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>        X4    <span class="op">=</span> <span class="va">X_vector</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">df_synth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_synth</span>, <span class="va">df_temp</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Check the first rows of the synthetic dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group  unit time          X1        X2       X3        X4</span></span>
<span><span class="co">#&gt; 1     1 G1_U1    1  0.55555434  9.484499 3.729036 1.3156911</span></span>
<span><span class="co">#&gt; 2     1 G1_U1    2 -1.33012636  9.275848 3.202148 0.1467821</span></span>
<span><span class="co">#&gt; 3     1 G1_U1    3 -0.02332833 12.858857 3.425945 2.1621458</span></span>
<span><span class="co">#&gt; 4     1 G1_U1    4  0.84430687  3.253564 1.536901 0.5493251</span></span>
<span><span class="co">#&gt; 5     1 G1_U1    5  0.04440973  7.617650 1.552945 1.0185252</span></span>
<span><span class="co">#&gt; 6     1 G1_U1    6 -2.70087059 13.626038 1.959473 2.6224373</span></span></code></pre></div>
<p>At this point, <code>df_synth</code> is a dataset that has the same shape (3 groups × 50 units × 20 time points = 3000 rows) and is drawn from the same approximate distribution (matching the partner’s means, SDs, correlation matrix).</p>
<p>Alternatively, if the goal is to capture even skewness and kurtosis, it’s a bit more complex.</p>
<div class="sourceCode" id="cb1111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>   <span class="co"># For multivariate normal correlation structure</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://azzalini.stat.unipd.it/SN/">sn</a></span><span class="op">)</span>     <span class="co"># For skewed normal distribution</span></span>
<span></span>
<span><span class="co"># Step 1: Define Structure</span></span>
<span><span class="va">num_groups</span> <span class="op">&lt;-</span> <span class="fl">10</span>   <span class="co"># Number of groups</span></span>
<span><span class="va">num_timepoints</span> <span class="op">&lt;-</span> <span class="fl">50</span>  <span class="co"># Time series length per group</span></span>
<span><span class="va">total_samples</span> <span class="op">&lt;-</span> <span class="va">num_groups</span> <span class="op">*</span> <span class="va">num_timepoints</span>  <span class="co"># Total data points</span></span>
<span></span>
<span><span class="co"># Define statistical properties for each group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span></span>
<span><span class="va">group_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">num_groups</span>, mean<span class="op">=</span><span class="fl">50</span>, sd<span class="op">=</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># Each group has a different mean</span></span>
<span><span class="va">group_variances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">num_groups</span>, <span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span>  <span class="co"># Random variance per group</span></span>
<span><span class="va">group_skewness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">num_groups</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># Skewness for each group</span></span>
<span><span class="co"># group_kurtosis &lt;- runif(num_groups, 3, 6)  # Excess kurtosis for each group</span></span>
<span></span>
<span><span class="co"># Define AR(3) autocorrelation coefficients</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span>  <span class="co"># AR(3) coefficients (must sum to &lt; 1 for stationarity)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>  <span class="co"># Order of the AR process</span></span>
<span></span>
<span><span class="co"># Define correlation matrix for groups (cross-sectional correlation)</span></span>
<span><span class="va">group_corr_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow<span class="op">=</span><span class="va">num_groups</span>, ncol<span class="op">=</span><span class="va">num_groups</span><span class="op">)</span>  <span class="co"># Moderate correlation</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/diag.html">diag</a></span><span class="op">(</span><span class="va">group_corr_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co"># Set diagonal to 1 for perfect self-correlation</span></span>
<span></span>
<span><span class="co"># Cholesky decomposition for group-level correlation</span></span>
<span><span class="va">chol_decomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/chol-methods.html">chol</a></span><span class="op">(</span><span class="va">group_corr_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Generate Hierarchical Time Series Data</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_groups</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate base time series (AR(p) process)</span></span>
<span>    <span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">num_timepoints</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Initialize first 'p' values randomly</span></span>
<span>    <span class="va">ts_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">p</span>, mean<span class="op">=</span><span class="va">group_means</span><span class="op">[</span><span class="va">g</span><span class="op">]</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">group_variances</span><span class="op">[</span><span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  </span>
<span>    </span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="op">(</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">num_timepoints</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># AR(p) process with multiple past values</span></span>
<span>        <span class="va">ts_data</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">phi</span> <span class="op">*</span> <span class="va">ts_data</span><span class="op">[</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean<span class="op">=</span><span class="fl">0</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">group_variances</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">phi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># Add skewness using skewed normal distribution</span></span>
<span>    <span class="va">ts_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sn/man/dsn.html">rsn</a></span><span class="op">(</span><span class="va">num_timepoints</span>, xi<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mean.html">mean</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span>, omega<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/sn/man/sd.html">sd</a></span><span class="op">(</span><span class="va">ts_data</span><span class="op">)</span>, alpha<span class="op">=</span><span class="va">group_skewness</span><span class="op">[</span><span class="va">g</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Store data in list</span></span>
<span>    <span class="va">data_list</span><span class="op">[[</span><span class="va">g</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        Group <span class="op">=</span> <span class="va">g</span>,</span>
<span>        Time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_timepoints</span>,</span>
<span>        Value <span class="op">=</span> <span class="va">ts_data</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Combine all group data into a single DataFrame</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">data_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Apply Cross-Group Correlation</span></span>
<span><span class="co"># Reshape the dataset for correlation application</span></span>
<span><span class="va">wide_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">df</span>, idvar<span class="op">=</span><span class="st">"Time"</span>, timevar<span class="op">=</span><span class="st">"Group"</span>, direction<span class="op">=</span><span class="st">"wide"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply correlation across groups at each time step</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">num_timepoints</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">wide_df</span><span class="op">[</span><span class="va">t</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">wide_df</span><span class="op">[</span><span class="va">t</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">chol_decomp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Convert back to long format correctly</span></span>
<span><span class="va">long_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/reshape.html">reshape</a></span><span class="op">(</span><span class="va">wide_df</span>, </span>
<span>                   varying<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">wide_df</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># Select all group columns</span></span>
<span>                   v.names<span class="op">=</span><span class="st">"Value"</span>, </span>
<span>                   idvar<span class="op">=</span><span class="st">"Time"</span>, </span>
<span>                   timevar<span class="op">=</span><span class="st">"Group"</span>, </span>
<span>                   times<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">num_groups</span>, </span>
<span>                   direction<span class="op">=</span><span class="st">"long"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure no unexpected columns</span></span>
<span><span class="va">long_df</span> <span class="op">&lt;-</span> <span class="va">long_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Group"</span>, <span class="st">"Value"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Display first few rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">long_df</span><span class="op">)</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Evaluate &amp; Compare</strong></li>
</ol>
<p>In reality, you might do this comparison inside the partner’s environment to confirm your synthetic data is a close match. For demonstration, we’ll just compare directly here.</p>
<div class="sourceCode" id="cb1112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 5: Evaluate</span></span>
<span></span>
<span><span class="co"># A) Check Means &amp; SDs</span></span>
<span><span class="va">synth_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html">colMeans</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">synth_sds</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Original (Collected) Means:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">means</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original (Collected) Means:</span></span>
<span><span class="co">#&gt;  -0.652 7.764 2.383 1.312</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Synthetic Means:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_means</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Synthetic Means:</span></span>
<span><span class="co">#&gt;  -0.627 7.882 2.441 1.315</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Original (Collected) SDs:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sds</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original (Collected) SDs:</span></span>
<span><span class="co">#&gt;  1.448 4.937 1.16 1.102</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Synthetic SDs:\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_sds</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Synthetic SDs:</span></span>
<span><span class="co">#&gt;  1.467 4.939 1.159 1.103</span></span>
<span></span>
<span><span class="co"># B) Check Correlation</span></span>
<span><span class="va">synth_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Original (Collected) Correlation Matrix:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original (Collected) Correlation Matrix:</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">R</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        X1     X2     X3     X4</span></span>
<span><span class="co">#&gt; X1  1.000 -0.687  0.395 -0.704</span></span>
<span><span class="co">#&gt; X2 -0.687  1.000  0.130  0.753</span></span>
<span><span class="co">#&gt; X3  0.395  0.130  1.000 -0.366</span></span>
<span><span class="co">#&gt; X4 -0.704  0.753 -0.366  1.000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSynthetic Correlation Matrix:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Synthetic Correlation Matrix:</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">synth_cor</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        X1     X2     X3     X4</span></span>
<span><span class="co">#&gt; X1  1.000 -0.693  0.402 -0.704</span></span>
<span><span class="co">#&gt; X2 -0.693  1.000  0.114  0.756</span></span>
<span><span class="co">#&gt; X3  0.402  0.114  1.000 -0.376</span></span>
<span><span class="co">#&gt; X4 -0.704  0.756 -0.376  1.000</span></span></code></pre></div>
<p>You should see that the synthetic dataset’s means, SDs, and correlation matrix are <strong>very close</strong> to the manually collected values from <code>df_original</code>.</p>
<div class="sourceCode" id="cb1113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Histograms or density plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">$</span><span class="va">X1</span>, main<span class="op">=</span><span class="st">"X1 Synthetic"</span>, col<span class="op">=</span><span class="st">"lightblue"</span>, breaks<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">$</span><span class="va">X2</span>, main<span class="op">=</span><span class="st">"X2 Synthetic"</span>, col<span class="op">=</span><span class="st">"lightblue"</span>, breaks<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">$</span><span class="va">X3</span>, main<span class="op">=</span><span class="st">"X3 Synthetic"</span>, col<span class="op">=</span><span class="st">"lightblue"</span>, breaks<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">$</span><span class="va">X4</span>, main<span class="op">=</span><span class="st">"X4 Synthetic"</span>, col<span class="op">=</span><span class="st">"lightblue"</span>, breaks<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-19-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Pairwise correlation scatterplots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/braverock/PerformanceAnalytics">PerformanceAnalytics</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/PerformanceAnalytics/man/chart.Correlation.html">chart.Correlation</a></span><span class="op">(</span><span class="va">df_synth</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>,<span class="st">"X2"</span>,<span class="st">"X3"</span>,<span class="st">"X4"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                  histogram<span class="op">=</span><span class="cn">TRUE</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-19-2.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="synthpop" class="section level3" number="43.3.3">
<h3>
<span class="header-section-number">43.3.3</span> Synthpop<a class="anchor" aria-label="anchor" href="#synthpop"><i class="fas fa-link"></i></a>
</h3>
<p>The easiest way to create synthetic data is to use the <code>synthpop</code> package.</p>
<div class="sourceCode" id="cb1115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">synthpop</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># library(effectsize)</span></span>
<span><span class="co"># library(see)</span></span>
<span><span class="co"># library(patchwork)</span></span>
<span><span class="co"># library(knitr)</span></span>
<span><span class="co"># library(kableExtra)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span><span class="co">#&gt; 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span><span class="co">#&gt; 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span><span class="co">#&gt; 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span><span class="co">#&gt; 6          5.4         3.9          1.7         0.4  setosa</span></span>
<span></span>
<span><span class="fu">synthpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/codebook.syn.html">codebook.syn</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; $tab</span></span>
<span><span class="co">#&gt;       variable   class nmiss perctmiss ndistinct</span></span>
<span><span class="co">#&gt; 1 Sepal.Length numeric     0         0        35</span></span>
<span><span class="co">#&gt; 2  Sepal.Width numeric     0         0        23</span></span>
<span><span class="co">#&gt; 3 Petal.Length numeric     0         0        43</span></span>
<span><span class="co">#&gt; 4  Petal.Width numeric     0         0        22</span></span>
<span><span class="co">#&gt; 5      Species  factor     0         0         3</span></span>
<span><span class="co">#&gt;                             details</span></span>
<span><span class="co">#&gt; 1                  Range: 4.3 - 7.9</span></span>
<span><span class="co">#&gt; 2                    Range: 2 - 4.4</span></span>
<span><span class="co">#&gt; 3                    Range: 1 - 6.9</span></span>
<span><span class="co">#&gt; 4                  Range: 0.1 - 2.5</span></span>
<span><span class="co">#&gt; 5 'setosa' 'versicolor' 'virginica'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $labs</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="va">syn_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/syn.html">syn</a></span><span class="op">(</span><span class="va">iris</span>, seed <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Synthesis</span></span>
<span><span class="co">#&gt; -----------</span></span>
<span><span class="co">#&gt;  Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span></span>
<span><span class="co"># check for replciated uniques</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/replicated.uniques.html">replicated.uniques</a></span><span class="op">(</span><span class="va">syn_df</span>, <span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; Uniques and replicated uniques for  1  synthesised data set(s)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  from keys:  Sepal.Length Sepal.Width Petal.Length Petal.Width Species </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                               Number from total     %</span></span>
<span><span class="co">#&gt; Original                         148        150 98.67</span></span>
<span><span class="co">#&gt; Synthetic                        137        150 91.33</span></span>
<span><span class="co">#&gt; Synthetic uniques in original     17        150 11.33</span></span>
<span><span class="co">#&gt; Replicated uniques                17        150 11.33</span></span>
<span><span class="co">#&gt; To view possible exclusions from synthesised data set(s) check components</span></span>
<span><span class="co">#&gt;   synU.rm (suggested for low-fidelity synthesis) or  repU.rm (for high fidelity)</span></span>
<span></span>
<span></span>
<span><span class="co"># remove replicated uniques and adds a FAKE_DATA label </span></span>
<span><span class="co"># (in case a person can see his or own data in </span></span>
<span><span class="co"># the replicated data by chance)</span></span>
<span></span>
<span><span class="va">syn_df_sdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/sdc.html">sdc</a></span><span class="op">(</span><span class="va">syn_df</span>, <span class="va">iris</span>, </span>
<span>                  label <span class="op">=</span> <span class="st">"FAKE_DATA"</span>,</span>
<span>                  rm.replicated.uniques <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; no. of replicated uniques removed: 17</span></span></code></pre></div>
<div class="sourceCode" id="cb1116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">syn_df</span><span class="op">$</span><span class="va">syn</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-21-2.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_ori</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Petal.Length</span> , data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="co"># performance::check_model(lm_ori)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_ori</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Sepal.Length ~ Sepal.Width + Petal.Length, data = iris)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.96159 -0.23489  0.00077  0.21453  0.78557 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   2.24914    0.24797    9.07 7.04e-16 ***</span></span>
<span><span class="co">#&gt; Sepal.Width   0.59552    0.06933    8.59 1.16e-14 ***</span></span>
<span><span class="co">#&gt; Petal.Length  0.47192    0.01712   27.57  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.3333 on 147 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8402, Adjusted R-squared:  0.838 </span></span>
<span><span class="co">#&gt; F-statistic: 386.4 on 2 and 147 DF,  p-value: &lt; 2.2e-16</span></span>
<span></span>
<span><span class="va">lm_syn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Petal.Length</span> , data <span class="op">=</span> <span class="va">syn_df</span><span class="op">$</span><span class="va">syn</span><span class="op">)</span></span>
<span><span class="co"># performance::check_model(lm_syn)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">lm_syn</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Sepal.Length ~ Sepal.Width + Petal.Length, data = syn_df$syn)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.79165 -0.22790 -0.01448  0.15893  1.13360 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   2.96449    0.24538  12.081  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; Sepal.Width   0.39214    0.06816   5.754  4.9e-08 ***</span></span>
<span><span class="co">#&gt; Petal.Length  0.45267    0.01743  25.974  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.3658 on 147 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8246, Adjusted R-squared:  0.8222 </span></span>
<span><span class="co">#&gt; F-statistic: 345.6 on 2 and 147 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Open data can be assessed for its utility in two distinct ways:</p>
<ol style="list-style-type: decimal">
<li><p><strong>General Utility</strong>: This refers to the broad resemblances within the dataset, allowing for preliminary data exploration.</p></li>
<li><p><strong>Specific Utility</strong>: This focuses on the comparability of models derived from synthetic and original datasets, emphasizing analytical reproducibility.</p></li>
</ol>
<p>For General utility</p>
<div class="sourceCode" id="cb1119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/compare.html">compare</a></span><span class="op">(</span><span class="va">syn_df</span>, <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>Specific utility</p>
<div class="sourceCode" id="cb1120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># just like regular lm, but for synthetic data</span></span>
<span><span class="va">lm_syn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/glm.synds.html">lm.synds</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span> <span class="op">+</span> <span class="va">Petal.Length</span> , data <span class="op">=</span> <span class="va">syn_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/synthpop/man/compare.html">compare</a></span><span class="op">(</span><span class="va">lm_syn</span>, <span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call used to fit models to the data:</span></span>
<span><span class="co">#&gt; lm.synds(formula = Sepal.Length ~ Sepal.Width + Petal.Length, </span></span>
<span><span class="co">#&gt;     data = syn_df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Differences between results based on synthetic and observed data:</span></span>
<span><span class="co">#&gt;              Synthetic  Observed        Diff Std. coef diff CI overlap</span></span>
<span><span class="co">#&gt; (Intercept)  2.9644900 2.2491402  0.71534988       2.884829  0.2640608</span></span>
<span><span class="co">#&gt; Sepal.Width  0.3921429 0.5955247 -0.20338187      -2.933611  0.2516161</span></span>
<span><span class="co">#&gt; Petal.Length 0.4526695 0.4719200 -0.01925058      -1.124602  0.7131064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Measures for one synthesis and 3 coefficients</span></span>
<span><span class="co">#&gt; Mean confidence interval overlap:  0.4095944</span></span>
<span><span class="co">#&gt; Mean absolute std. coef diff:  2.314347</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mahalanobis distance ratio for lack-of-fit (target 1.0): 3.08</span></span>
<span><span class="co">#&gt; Lack-of-fit test: 9.23442; p-value 0.0263 for test that synthesis model is</span></span>
<span><span class="co">#&gt; compatible with a chi-squared test with 3 degrees of freedom.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence interval plot:</span></span></code></pre></div>
<div class="inline-figure"><img src="43-rep_synthetic_data_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb1121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># summary(lm_syn)</span></span></code></pre></div>
<p>You basically want your lack-of-fit test to be non-significant.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></div>
<div class="next"><a href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#replication-and-synthetic-data"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li>
<a class="nav-link" href="#the-replication-standard"><span class="header-section-number">43.1</span> The Replication Standard</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#solutions-for-empirical-replication"><span class="header-section-number">43.1.1</span> Solutions for Empirical Replication</a></li>
<li><a class="nav-link" href="#free-data-repositories"><span class="header-section-number">43.1.2</span> Free Data Repositories</a></li>
<li><a class="nav-link" href="#exceptions-to-replication"><span class="header-section-number">43.1.3</span> Exceptions to Replication</a></li>
<li><a class="nav-link" href="#replication-landscape"><span class="header-section-number">43.1.4</span> Replication Landscape</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#synthetic-data"><span class="header-section-number">43.2</span> Synthetic Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#benefits-of-synthetic-data"><span class="header-section-number">43.2.1</span> Benefits of Synthetic Data</a></li>
<li><a class="nav-link" href="#concerns-and-limitations"><span class="header-section-number">43.2.2</span> Concerns and Limitations</a></li>
<li><a class="nav-link" href="#further-insights-on-synthetic-data"><span class="header-section-number">43.2.3</span> Further Insights on Synthetic Data</a></li>
<li><a class="nav-link" href="#generating-synthetic-data"><span class="header-section-number">43.2.4</span> Generating Synthetic Data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#application-5"><span class="header-section-number">43.3</span> Application</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#original-dataset"><span class="header-section-number">43.3.1</span> Original Dataset</a></li>
<li><a class="nav-link" href="#restricted-dataset"><span class="header-section-number">43.3.2</span> Restricted Dataset</a></li>
<li><a class="nav-link" href="#synthpop"><span class="header-section-number">43.3.3</span> Synthpop</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/43-rep_synthetic_data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/43-rep_synthetic_data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-05-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
