<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Variable Transformation | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="12.1 Continuous Variables Transforming continuous variables can be useful for various reasons, including: Changing the scale of variables to make them more interpretable or comparable. Reducing...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 12 Variable Transformation | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/variable-transformation.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="12.1 Continuous Variables Transforming continuous variables can be useful for various reasons, including: Changing the scale of variables to make them more interpretable or comparable. Reducing...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Variable Transformation | A Guide on Data Analysis">
<meta name="twitter:description" content="12.1 Continuous Variables Transforming continuous variables can be useful for various reasons, including: Changing the scale of variables to make them more interpretable or comparable. Reducing...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="active" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">38</span> Controls</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">39</span> Directed Acyclic Graph</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li><a class="" href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="variable-transformation" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Variable Transformation<a class="anchor" aria-label="anchor" href="#variable-transformation"><i class="fas fa-link"></i></a>
</h1>
<div id="continuous-variables" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Continuous Variables<a class="anchor" aria-label="anchor" href="#continuous-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Transforming continuous variables can be useful for various reasons, including:</p>
<ul>
<li>
<strong>Changing the scale of variables</strong> to make them more interpretable or comparable.</li>
<li>
<strong>Reducing skewness</strong> to approximate a normal distribution, which can improve statistical inference.</li>
<li>
<strong>Stabilizing variance</strong> in cases of heteroskedasticity.</li>
<li>
<strong>Enhancing interpretability</strong> in business applications (e.g., logarithmic transformations for financial data).</li>
</ul>
<hr>
<div id="standardization-z-score-normalization" class="section level3" number="12.1.1">
<h3>
<span class="header-section-number">12.1.1</span> Standardization (Z-score Normalization)<a class="anchor" aria-label="anchor" href="#standardization-z-score-normalization"><i class="fas fa-link"></i></a>
</h3>
<p>A common transformation to center and scale data:</p>
<p><span class="math display">\[
x_i' = \frac{x_i - \bar{x}}{s}
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(x_i\)</span> is the original value,</li>
<li>
<span class="math inline">\(\bar{x}\)</span> is the sample mean,</li>
<li>
<span class="math inline">\(s\)</span> is the sample standard deviation.</li>
</ul>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When variables have different units of measurement and need to be on a common scale.</p></li>
<li><p>When a few large numbers dominate the dataset.</p></li>
</ul>
<hr>
</div>
<div id="min-max-scaling-normalization" class="section level3" number="12.1.2">
<h3>
<span class="header-section-number">12.1.2</span> Min-Max Scaling (Normalization)<a class="anchor" aria-label="anchor" href="#min-max-scaling-normalization"><i class="fas fa-link"></i></a>
</h3>
<p>Rescales data to a fixed range, typically <span class="math inline">\([0,1]\)</span>:</p>
<p><span class="math display">\[
x_i' = \frac{x_i - x_{\min}}{x_{\max} - x_{\min}}
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When working with fixed-interval data (e.g., percentages, proportions).</p></li>
<li><p>When preserving relative relationships between values is important.</p></li>
<li><p>Caution: This method is sensitive to outliers, as extreme values determine the range.</p></li>
</ul>
<hr>
</div>
<div id="square-root-and-cube-root-transformations" class="section level3" number="12.1.3">
<h3>
<span class="header-section-number">12.1.3</span> Square Root and Cube Root Transformations<a class="anchor" aria-label="anchor" href="#square-root-and-cube-root-transformations"><i class="fas fa-link"></i></a>
</h3>
<p>Useful for handling <strong>positive skewness</strong> and <strong>heteroskedasticity</strong>:</p>
<ul>
<li>
<strong>Square root:</strong> Reduces moderate skewness and variance.</li>
<li>
<strong>Cube root:</strong> Works on more extreme skewness and allows negative values.</li>
</ul>
<p><strong>Common Use Cases:</strong></p>
<ul>
<li><p><strong>Frequency count data</strong> (e.g., website visits, sales transactions).</p></li>
<li><p><strong>Data with many small values or zeros</strong> (e.g., income distributions in microfinance).</p></li>
</ul>
<hr>
</div>
<div id="sec-logarithmic-transformation" class="section level3" number="12.1.4">
<h3>
<span class="header-section-number">12.1.4</span> Logarithmic Transformation<a class="anchor" aria-label="anchor" href="#sec-logarithmic-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>Logarithmic transformations are particularly useful for handling highly skewed data. They compress large values while expanding small values, which helps with heteroskedasticity and normality assumptions.</p>
<div id="common-log-transformations" class="section level4" number="12.1.4.1">
<h4>
<span class="header-section-number">12.1.4.1</span> Common Log Transformations<a class="anchor" aria-label="anchor" href="#common-log-transformations"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="55%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Formula</th>
<th>When to Use</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(x_i' = \log(x_i)\)</span></td>
<td>When all values are positive.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_i' = \log(x_i + 1)\)</span></td>
<td>When data contains zeros.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_i' = \log(x_i + c)\)</span></td>
<td>Choosing <span class="math inline">\(c\)</span> depends on context.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_i' = \frac{x_i}{|x_i|} \log |x_i|\)</span></td>
<td>When data contains negative values.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_i'^\lambda = \log(x_i + \sqrt{x_i^2 + \lambda})\)</span></td>
<td>Generalized log transformation.</td>
</tr>
</tbody>
</table></div>
<p>Selecting the constant <span class="math inline">\(c\)</span> is critical:</p>
<ul>
<li>If <span class="math inline">\(c\)</span> is too large, it can obscure the true nature of the data.</li>
<li>If <span class="math inline">\(c\)</span> is too small, the transformation might not effectively reduce skewness.</li>
</ul>
<p>From a statistical modeling perspective:</p>
<ul>
<li>
<strong>For inference-based models</strong>, the choice of <span class="math inline">\(c\)</span> can significantly impact the fit. See <span class="citation">(<a href="references.html#ref-ekwaru2018overlooked">Ekwaru and Veugelers 2018</a>)</span>.</li>
<li>
<strong>In causal inference</strong> (e.g., DID, IV), improper log transformations (e.g., logging zero values) can introduce bias <span class="citation">(<a href="references.html#ref-chen2024logs">J. Chen and Roth 2024</a>)</span>.</li>
</ul>
</div>
<div id="when-is-log-transformation-problematic" class="section level4" number="12.1.4.2">
<h4>
<span class="header-section-number">12.1.4.2</span> When is Log Transformation Problematic?<a class="anchor" aria-label="anchor" href="#when-is-log-transformation-problematic"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>When <strong>zero values have a meaningful interpretation</strong> (e.g., income of unemployed individuals).</li>
<li>When <strong>data are censored</strong> (e.g., income data truncated at reporting thresholds).</li>
<li>When <strong>measurement error exists</strong> (e.g., rounding errors from survey responses).</li>
</ul>
<p>If zeros are <strong>small but meaningful</strong> (e.g., revenue from startups), then using <span class="math inline">\(\log(x + c)\)</span> may be acceptable.</p>
<hr>
<div class="sourceCode" id="cb473"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load dataset</span></span>
<span><span class="va">cars</span> <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/cars.html">cars</a></span></span>
<span></span>
<span><span class="co"># Original values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 4 7 7 8 9</span></span>
<span></span>
<span><span class="co"># Log transformation (basic)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.386294 1.386294 1.945910 1.945910 2.079442 2.197225</span></span>
<span></span>
<span><span class="co"># Log transformation for zero-inflated data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.609438 1.609438 2.079442 2.079442 2.197225 2.302585</span></span></code></pre></div>
</div>
</div>
<div id="exponential-transformation" class="section level3" number="12.1.5">
<h3>
<span class="header-section-number">12.1.5</span> Exponential Transformation<a class="anchor" aria-label="anchor" href="#exponential-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The exponential transformation is useful when data exhibit negative skewness or when an underlying logarithmic trend is suspected, such as in survival analysis and decay models.</p>
<p>When to Use:</p>
<ul>
<li><p>Negatively skewed distributions.</p></li>
<li><p>Processes that follow an exponential trend (e.g., population growth, depreciation of assets).</p></li>
</ul>
<hr>
</div>
<div id="power-transformation" class="section level3" number="12.1.6">
<h3>
<span class="header-section-number">12.1.6</span> Power Transformation<a class="anchor" aria-label="anchor" href="#power-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>Power transformations help adjust skewness, particularly for negatively skewed data.</p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When variables have a negatively skewed distribution.</p></li>
<li><p>When the relationship between variables is non-linear.</p></li>
</ul>
<p>Common power transformations include:</p>
<ul>
<li><p>Square transformation: <span class="math inline">\(x^2\)</span> (moderate adjustment).</p></li>
<li><p>Cubic transformation: <span class="math inline">\(x^3\)</span> (stronger adjustment).</p></li>
<li><p>Fourth-root transformation: <span class="math inline">\(x^{1/4}\)</span> (more subtle than square root).</p></li>
</ul>
<hr>
</div>
<div id="inverse-reciprocal-transformation" class="section level3" number="12.1.7">
<h3>
<span class="header-section-number">12.1.7</span> Inverse (Reciprocal) Transformation<a class="anchor" aria-label="anchor" href="#inverse-reciprocal-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The inverse transformation is useful for handling platykurtic (flat) distributions or positively skewed data.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
x_i' = \frac{1}{x_i}
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>Reducing extreme values in positively skewed distributions.</p></li>
<li><p>Ratio data (e.g., speed = distance/time).</p></li>
<li><p>When the variable has a natural lower bound (e.g., time to completion).</p></li>
</ul>
<div class="sourceCode" id="cb474"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data(cars)</span></span>
<span><span class="va">cars</span> <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/cars.html">cars</a></span></span>
<span></span>
<span><span class="co"># Original distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  2 10  4 22 16 10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb475"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Reciprocal transformation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-2-2.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="hyperbolic-arcsine-transformation" class="section level3" number="12.1.8">
<h3>
<span class="header-section-number">12.1.8</span> Hyperbolic Arcsine Transformation<a class="anchor" aria-label="anchor" href="#hyperbolic-arcsine-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The arcsinh (inverse hyperbolic sine) transformation is useful for handling proportion variables (0-1) and skewed distributions. It behaves similarly to the logarithmic transformation but has the advantage of handling zero and negative values.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
\text{arcsinh}(Y) = \log(\sqrt{1 + Y^2} + Y)
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>Proportion variables (e.g., market share, probability estimates).</p></li>
<li><p>Data with extreme skewness where log transformation is problematic.</p></li>
<li><p>Variables containing zeros or negative values (unlike log, arcsinh handles zeros naturally).</p></li>
<li><p>Alternative to log transformation for handling zeros.</p></li>
</ul>
<div class="sourceCode" id="cb476"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize original distribution </span></span>
<span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb477"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alternative histogram  </span></span>
<span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/truehist.html">truehist</a></span><span class="op">(</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-3-2.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb478"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Apply arcsinh transformation </span></span>
<span><span class="va">as_dist</span> <span class="op">&lt;-</span> <span class="fu">bestNormalize</span><span class="fu">::</span><span class="fu"><a href="https://petersonr.github.io/bestNormalize/reference/arcsinh_x.html">arcsinh_x</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span> </span>
<span><span class="va">as_dist</span></span>
<span><span class="co">#&gt; Standardized asinh(x) Transformation with 50 nonmissing obs.:</span></span>
<span><span class="co">#&gt;  Relevant statistics:</span></span>
<span><span class="co">#&gt;  - mean (before standardization) = 4.230843 </span></span>
<span><span class="co">#&gt;  - sd (before standardization) = 0.7710887</span></span>
<span><span class="va">as_dist</span><span class="op">$</span><span class="va">x.t</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-3-3.png" width="90%" style="display: block; margin: auto;"></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Paper</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="citation">Azoulay, Fons-Rosen, and Zivin (<a href="references.html#ref-azoulay2019does">2019</a>)</span></td>
<td>Elasticity</td>
</tr>
<tr class="even">
<td><span class="citation">Faber and Gaubert (<a href="references.html#ref-faber2019tourism">2019</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="odd">
<td><span class="citation">Hjort and Poulsen (<a href="references.html#ref-hjort2019arrival">2019</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="even">
<td><span class="citation">M. S. Johnson (<a href="references.html#ref-johnson2020regulation">2020</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="odd">
<td><span class="citation">Beerli et al. (<a href="references.html#ref-beerli2021abolition">2021</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="even">
<td><span class="citation">Norris, Pecenco, and Weaver (<a href="references.html#ref-norris2021effects">2021</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="odd">
<td><span class="citation">Berkouwer and Dean (<a href="references.html#ref-berkouwer2022credit">2022</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="even">
<td><span class="citation">Cabral, Cui, and Dworsky (<a href="references.html#ref-cabral2022demand">2022</a>)</span></td>
<td>Elasticity</td>
</tr>
<tr class="odd">
<td><span class="citation">Carranza et al. (<a href="references.html#ref-carranza2022job">2022</a>)</span></td>
<td>Percentage</td>
</tr>
<tr class="even">
<td><span class="citation">Mirenda, Mocetti, and Rizzica (<a href="references.html#ref-mirenda2022economic">2022</a>)</span></td>
<td>Percentage</td>
</tr>
</tbody>
</table></div>
<p>Consider a simple regression model: <span class="math display">\[ Y = \beta X + \epsilon \]</span> When both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are transformed:</p>
<ul>
<li>The coefficient estimate <span class="math inline">\(\beta\)</span> represents <strong>elasticity</strong>: <em>A 1% increase in</em> <span class="math inline">\(X\)</span> leads to a <span class="math inline">\(\beta\)</span>% change in <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>When only <span class="math inline">\(Y\)</span> is transformed:</p>
<ul>
<li>The coefficient estimate represents a <strong>percentage change in</strong> <span class="math inline">\(Y\)</span> for a one-unit change in <span class="math inline">\(X\)</span>.</li>
</ul>
<p>This makes the arcsinh transformation particularly valuable for <strong>log-linear models</strong> where zero values exist.</p>
</div>
<div id="ordered-quantile-normalization-rank-based-transformation" class="section level3" number="12.1.9">
<h3>
<span class="header-section-number">12.1.9</span> Ordered Quantile Normalization (Rank-Based Transformation)<a class="anchor" aria-label="anchor" href="#ordered-quantile-normalization-rank-based-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The Ordered Quantile Normalization (OQN) technique transforms data into a normal distribution using rank-based methods <span class="citation">(<a href="references.html#ref-bartlett1947use">Bartlett 1947</a>)</span>.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
x_i' = \Phi^{-1} \left( \frac{\text{rank}(x_i) - 1/2}{\text{length}(x)} \right)
\]</span></p>
<p>where <span class="math inline">\(\Phi^{-1}\)</span> is the inverse normal cumulative distribution function.</p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When data are <strong>heavily skewed</strong> or <strong>contain extreme values</strong>.</p></li>
<li><p>When normality is required for <strong>parametric tests</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb479"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ord_dist</span> <span class="op">&lt;-</span> <span class="fu">bestNormalize</span><span class="fu">::</span><span class="fu"><a href="https://petersonr.github.io/bestNormalize/reference/orderNorm.html">orderNorm</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span>
<span><span class="va">ord_dist</span></span>
<span><span class="co">#&gt; orderNorm Transformation with 50 nonmissing obs and ties</span></span>
<span><span class="co">#&gt;  - 35 unique values </span></span>
<span><span class="co">#&gt;  - Original quantiles:</span></span>
<span><span class="co">#&gt;   0%  25%  50%  75% 100% </span></span>
<span><span class="co">#&gt;    2   26   36   56  120</span></span>
<span><span class="va">ord_dist</span><span class="op">$</span><span class="va">x.t</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="lambert-w-x-f-transformation" class="section level3" number="12.1.10">
<h3>
<span class="header-section-number">12.1.10</span> Lambert W x F Transformation<a class="anchor" aria-label="anchor" href="#lambert-w-x-f-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The Lambert W transformation is a more advanced method that normalizes data by removing skewness and heavy tails.</p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When traditional transformations (e.g., log, Box-Cox) fail.</p></li>
<li><p>When dealing with heavy-tailed distributions.</p></li>
</ul>
<div class="sourceCode" id="cb480"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/cars.html">cars</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  2 10  4 22 16 10</span></span>
<span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb481"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Apply Lambert W transformation</span></span>
<span><span class="va">l_dist</span> <span class="op">&lt;-</span> <span class="fu">LambertW</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/LambertW/man/Gaussianize.html">Gaussianize</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span>
<span><span class="va">l_dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-5-2.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="inverse-hyperbolic-sine-transformation" class="section level3" number="12.1.11">
<h3>
<span class="header-section-number">12.1.11</span> Inverse Hyperbolic Sine Transformation<a class="anchor" aria-label="anchor" href="#inverse-hyperbolic-sine-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The Inverse Hyperbolic Sine (IHS) transformation is similar to the log transformation but handles zero and negative values <span class="citation">(<a href="references.html#ref-johnson1949">N. L. Johnson 1949</a>)</span>.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
f(x,\theta) = \frac{\sinh^{-1} (\theta x)}{\theta} = \frac{\log(\theta x + (\theta^2 x^2 + 1)^{1/2})}{\theta}
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>When data contain zeros or negative values.</p></li>
<li><p>Alternative to log transformation in economic and financial modeling.</p></li>
</ul>
</div>
<div id="sec-box-cox-transformation" class="section level3" number="12.1.12">
<h3>
<span class="header-section-number">12.1.12</span> Box-Cox Transformation<a class="anchor" aria-label="anchor" href="#sec-box-cox-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The Box-Cox transformation is a power transformation designed to improve linearity and normality <span class="citation">(<a href="references.html#ref-manly1976exponential">Manly 1976</a>; <a href="references.html#ref-bickel1981analysis">Bickel and Doksum 1981</a>; <a href="references.html#ref-box1981analysis">Box and Cox 1981</a>)</span>.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
x_i'^\lambda = \begin{cases} \frac{x_i^\lambda-1}{\lambda} &amp; \text{if } \lambda \neq 0\\ \log(x_i) &amp; \text{if } \lambda = 0 \end{cases}
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>To fix non-linearity in the error terms of regression models.</p></li>
<li><p>When data are strictly positive</p></li>
</ul>
<div class="sourceCode" id="cb482"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="co"># data(cars)</span></span>
<span><span class="va">cars</span> <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/cars.html">cars</a></span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span> <span class="op">~</span> <span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-2.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-3.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-4.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb483"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Find optimal lambda</span></span>
<span><span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">mod</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-5.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb484"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">best_lambda</span> <span class="op">&lt;-</span> <span class="va">bc</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">bc</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Apply transformation</span></span>
<span><span class="va">mod_lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span> <span class="op">^</span> <span class="va">best_lambda</span> <span class="op">~</span> <span class="va">cars</span><span class="op">$</span><span class="va">dist</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod_lambda</span><span class="op">)</span></span></code></pre></div>
<p><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-6.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-7.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-8.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-6-9.png" width="90%" style="display: block; margin: auto;"></p>
<p>For the <strong>two-parameter Box-Cox transformation</strong>, we use:</p>
<p><span class="math display">\[
x_i' (\lambda_1, \lambda_2) = \begin{cases} \frac{(x_i + \lambda_2)^{\lambda_1}-1}{\lambda_1} &amp; \text{if } \lambda_1 \neq 0 \\ \log(x_i + \lambda_2) &amp; \text{if } \lambda_1 = 0 \end{cases}
\]</span></p>
<div class="sourceCode" id="cb485"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two-parameter Box-Cox transformation</span></span>
<span><span class="va">two_bc</span> <span class="op">&lt;-</span> <span class="fu">geoR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geoR/man/boxcoxfit.html">boxcoxfit</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span></span>
<span><span class="va">two_bc</span></span>
<span><span class="co">#&gt; Fitted parameters:</span></span>
<span><span class="co">#&gt;    lambda      beta   sigmasq </span></span>
<span><span class="co">#&gt;  1.028798 15.253008 31.935297 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence code returned by optim: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">two_bc</span><span class="op">)</span></span></code></pre></div>
<p><img src="12-variable_transformation_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-7-2.png" width="90%" style="display: block; margin: auto;"></p>
</div>
<div id="yeo-johnson-transformation" class="section level3" number="12.1.13">
<h3>
<span class="header-section-number">12.1.13</span> Yeo-Johnson Transformation<a class="anchor" aria-label="anchor" href="#yeo-johnson-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>Similar to <a href="variable-transformation.html#sec-box-cox-transformation">Box-Cox</a> (when <span class="math inline">\(\lambda = 1\)</span>), but allows for negative values.</p>
<p><strong>Formula:</strong></p>
<p><span class="math display">\[
x_i'^\lambda = \begin{cases} \frac{(x_i+1)^\lambda -1}{\lambda} &amp; \text{if } \lambda \neq0, x_i \ge 0 \\ \log(x_i + 1) &amp; \text{if } \lambda = 0, x_i \ge 0 \\ \frac{-[(-x_i+1)^{2-\lambda}-1]}{2 - \lambda} &amp; \text{if } \lambda \neq 2, x_i &lt;0 \\ -\log(-x_i + 1) &amp; \text{if } \lambda = 2, x_i &lt;0 \end{cases}
\]</span></p>
<div class="sourceCode" id="cb486"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># data(cars)</span></span>
<span><span class="va">cars</span> <span class="op">=</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/cars.html">cars</a></span></span>
<span><span class="va">yj_speed</span> <span class="op">&lt;-</span> <span class="fu">bestNormalize</span><span class="fu">::</span><span class="fu"><a href="https://petersonr.github.io/bestNormalize/reference/yeojohnson.html">yeojohnson</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">speed</span><span class="op">)</span></span>
<span><span class="va">yj_speed</span><span class="op">$</span><span class="va">x.t</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="rankgauss-transformation" class="section level3" number="12.1.14">
<h3>
<span class="header-section-number">12.1.14</span> RankGauss Transformation<a class="anchor" aria-label="anchor" href="#rankgauss-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>A rank-based transformation that maps values to a normal distribution.</p>
<p>When to Use:</p>
<ul>
<li>To handle skewed data while preserving rank order.</li>
</ul>
</div>
<div id="automatically-choosing-the-best-transformation" class="section level3" number="12.1.15">
<h3>
<span class="header-section-number">12.1.15</span> Automatically Choosing the Best Transformation<a class="anchor" aria-label="anchor" href="#automatically-choosing-the-best-transformation"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>bestNormalize</code> package selects the <strong>best transformation</strong> for a given dataset.</p>
<div class="sourceCode" id="cb487"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestdist</span> <span class="op">&lt;-</span> <span class="fu">bestNormalize</span><span class="fu">::</span><span class="fu"><a href="https://petersonr.github.io/bestNormalize/reference/bestNormalize.html">bestNormalize</a></span><span class="op">(</span><span class="va">cars</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span></span>
<span><span class="va">bestdist</span><span class="op">$</span><span class="va">x.t</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-variable_transformation_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="categorical-variables" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Categorical Variables<a class="anchor" aria-label="anchor" href="#categorical-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Transforming categorical variables into numerical representations is essential for machine learning models and statistical analysis. The key objectives include:</p>
<ul>
<li>Converting categorical data into a format suitable for numerical models.</li>
<li>Improving model interpretability and performance.</li>
<li>Handling high-cardinality categorical variables efficiently.</li>
</ul>
<hr>
<p>There are multiple ways to transform categorical variables, each with its advantages and use cases. The choice depends on factors like <strong>cardinality</strong>, <strong>ordinality</strong>, and <strong>model type</strong>.</p>
<div id="one-hot-encoding-dummy-variables" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> One-Hot Encoding (Dummy Variables)<a class="anchor" aria-label="anchor" href="#one-hot-encoding-dummy-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Creates binary indicator variables for each category.</p>
<p><strong>Formula:</strong><br>
For a categorical variable with <span class="math inline">\(k\)</span> unique values, create <span class="math inline">\(k\)</span> binary columns:</p>
<p><span class="math display">\[
x_i' =
\begin{cases}
1 &amp; \text{if } x_i = \text{category} \\
0 &amp; \text{otherwise}
\end{cases}
\]</span></p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>Low-cardinality categorical variables (e.g., Red, Blue, Green).</p></li>
<li><p>Tree-based models (e.g., Random Forest, XGBoost).</p></li>
<li><p>Linear regression models (dummy variables prevent information loss).</p></li>
</ul>
<div class="sourceCode" id="cb488"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">dummy_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/dummyVars.html">dummyVars</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Species</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">one_hot_encoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">dummy_vars</span>, newdata <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">one_hot_encoded</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Species.setosa Species.versicolor Species.virginica</span></span>
<span><span class="co">#&gt; 1              1                  0                 0</span></span>
<span><span class="co">#&gt; 2              1                  0                 0</span></span>
<span><span class="co">#&gt; 3              1                  0                 0</span></span>
<span><span class="co">#&gt; 4              1                  0                 0</span></span>
<span><span class="co">#&gt; 5              1                  0                 0</span></span>
<span><span class="co">#&gt; 6              1                  0                 0</span></span></code></pre></div>
</div>
<div id="label-encoding" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Label Encoding<a class="anchor" aria-label="anchor" href="#label-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Assigns integer values to categories.</p>
<p><strong>Formula:</strong><br>
If a categorical variable has <span class="math inline">\(k\)</span> unique values:</p>
<p><span class="math display">\[
\text{Category } \rightarrow \text{Integer}
\]</span></p>
<p>Example:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Category</th>
<th>Encoded Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Red</td>
<td>1</td>
</tr>
<tr class="even">
<td>Blue</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Green</td>
<td>3</td>
</tr>
</tbody>
</table></div>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>Ordinal categorical variables (e.g., Low, Medium, High).</p></li>
<li><p>Neural networks (use embeddings instead of one-hot).</p></li>
<li><p>Memory-efficient encoding for high-cardinality features.</p></li>
</ul>
<div class="sourceCode" id="cb489"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species_encoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species_encoded</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1</span></span></code></pre></div>
</div>
<div id="feature-hashing-hash-encoding" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Feature Hashing (Hash Encoding)<a class="anchor" aria-label="anchor" href="#feature-hashing-hash-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Maps categories to a <strong>fixed number of hash bins</strong>, reducing memory usage.</p>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>High-cardinality categorical variables (e.g., user IDs, URLs).</p></li>
<li><p>Scenarios where an exact category match isnt needed.</p></li>
<li><p>Sparse models (e.g., text data in NLP).</p></li>
</ul>
<div class="sourceCode" id="cb490"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://text2vec.org">text2vec</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org">Matrix</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert the 'Species' factor to character tokens</span></span>
<span><span class="va">tokens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/text2vec/man/tokenizers.html">word_tokenizer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create an iterator over tokens</span></span>
<span><span class="va">it</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/text2vec/man/itoken.html">itoken</a></span><span class="op">(</span><span class="va">tokens</span>, progressbar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the hash_vectorizer with a specified hash size (8 in this case)</span></span>
<span><span class="va">vectorizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/text2vec/man/vectorizers.html">hash_vectorizer</a></span><span class="op">(</span>hash_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a Document-Term Matrix (DTM) using the hashed features</span></span>
<span><span class="va">hashed_dtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/text2vec/man/create_dtm.html">create_dtm</a></span><span class="op">(</span><span class="va">it</span>, <span class="va">vectorizer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect the first few rows of the hashed feature matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">hashed_dtm</span><span class="op">)</span></span>
<span><span class="co">#&gt; 6 x 8 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;                  </span></span>
<span><span class="co">#&gt; 1 . . . . . . 1 .</span></span>
<span><span class="co">#&gt; 2 . . . . . . 1 .</span></span>
<span><span class="co">#&gt; 3 . . . . . . 1 .</span></span>
<span><span class="co">#&gt; 4 . . . . . . 1 .</span></span>
<span><span class="co">#&gt; 5 . . . . . . 1 .</span></span>
<span><span class="co">#&gt; 6 . . . . . . 1 .</span></span></code></pre></div>
<ul>
<li><p><strong>word_tokenizer</strong>: This function splits the character vector into tokens. Since <code>iris$Species</code> is already a categorical variable with values like <code>"setosa"</code>, <code>"versicolor"</code>, and <code>"virginica"</code>, each value becomes a token.</p></li>
<li><p><strong>itoken</strong>: Creates an iterator over the tokens.</p></li>
<li><p><strong>hash_vectorizer</strong>: Sets up a hashing vectorizer that transforms tokens into a sparse feature space of size <code>2^3 = 8</code> (because <code>hash_size = 8</code> means <span class="math inline">\(2^8\)</span> bins; if you intend exactly 8 bins, you might adjust the parameter accordingly).</p></li>
<li><p><strong>create_dtm</strong>: Builds the document-term matrix (which in this case is analogous to a feature matrix for each observation).</p></li>
</ul>
</div>
<div id="binary-encoding" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> Binary Encoding<a class="anchor" aria-label="anchor" href="#binary-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Converts categories to binary representations and distributes them across multiple columns.</p>
<p><strong>Example:</strong><br>
For four categories (A, B, C, D):</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Category</th>
<th>Binary Code</th>
<th>Encoded Columns</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>00</td>
<td>0, 0</td>
</tr>
<tr class="even">
<td>B</td>
<td>01</td>
<td>0, 1</td>
</tr>
<tr class="odd">
<td>C</td>
<td>10</td>
<td>1, 0</td>
</tr>
<tr class="even">
<td>D</td>
<td>11</td>
<td>1, 1</td>
</tr>
</tbody>
</table></div>
<p><strong>When to Use:</strong></p>
<ul>
<li><p>High-cardinality categorical features (less memory than one-hot encoding).</p></li>
<li><p>Tree-based models (preserves some ordinal information).</p></li>
</ul>
<div class="sourceCode" id="cb491"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ben519/mltools">mltools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert the Species column to a data.table and perform one-hot encoding</span></span>
<span><span class="va">binary_encoded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mltools/man/one_hot.html">one_hot</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="st">"Species"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">binary_encoded</span><span class="op">)</span></span>
<span><span class="co">#&gt;    V1_setosa V1_versicolor V1_virginica</span></span>
<span><span class="co">#&gt;        &lt;int&gt;         &lt;int&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1:         1             0            0</span></span>
<span><span class="co">#&gt; 2:         1             0            0</span></span>
<span><span class="co">#&gt; 3:         1             0            0</span></span>
<span><span class="co">#&gt; 4:         1             0            0</span></span>
<span><span class="co">#&gt; 5:         1             0            0</span></span>
<span><span class="co">#&gt; 6:         1             0            0</span></span></code></pre></div>
</div>
<div id="base-n-encoding-generalized-binary-encoding" class="section level3" number="12.2.5">
<h3>
<span class="header-section-number">12.2.5</span> Base-N Encoding (Generalized Binary Encoding)<a class="anchor" aria-label="anchor" href="#base-n-encoding-generalized-binary-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Expands Binary Encoding to base <span class="math inline">\(N\)</span> instead of binary.</p>
<p>When to Use:</p>
<ul>
<li>Similar to Binary Encoding, but allows for greater flexibility.</li>
</ul>
</div>
<div id="frequency-encoding" class="section level3" number="12.2.6">
<h3>
<span class="header-section-number">12.2.6</span> Frequency Encoding<a class="anchor" aria-label="anchor" href="#frequency-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Replaces each category with its frequency (proportion) in the dataset.</p>
<p><strong>Formula:</strong> <span class="math display">\[
x_i' = \frac{\text{count}(x_i)}{\text{total count}}
\]</span> <strong>When to Use:</strong></p>
<ul>
<li><p>High-cardinality categorical variables.</p></li>
<li><p>Feature engineering for boosting algorithms (e.g., LightGBM).</p></li>
</ul>
<div class="sourceCode" id="cb492"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">freq_encoding</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="va">iris</span><span class="op">$</span><span class="va">Species_freq</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="op">~</span> <span class="va">freq_encoding</span><span class="op">[</span><span class="va">.</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species_freq</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333 0.3333333 0.3333333 0.3333333</span></span></code></pre></div>
</div>
<div id="target-encoding-mean-encoding" class="section level3" number="12.2.7">
<h3>
<span class="header-section-number">12.2.7</span> Target Encoding (Mean Encoding)<a class="anchor" aria-label="anchor" href="#target-encoding-mean-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Encodes categories using the mean of the target variable.</p>
<p><strong>Formula:</strong> <span class="math display">\[
x_i' = E[Y | X = x_i]
\]</span> <strong>When to Use:</strong></p>
<ul>
<li><p>Predictive models with categorical features strongly correlated with the target.</p></li>
<li><p>High-cardinality categorical variables.</p></li>
<li><p>Risk: Can lead to data leakage (use cross-validation).</p></li>
</ul>
<div class="sourceCode" id="cb493"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="va">iris_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris_dt</span><span class="op">[</span>, <span class="va">Species_mean</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">Species</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris_dt</span><span class="op">$</span><span class="va">Species_mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.006 5.006 5.006 5.006 5.006 5.006</span></span></code></pre></div>
</div>
<div id="ordinal-encoding" class="section level3" number="12.2.8">
<h3>
<span class="header-section-number">12.2.8</span> Ordinal Encoding<a class="anchor" aria-label="anchor" href="#ordinal-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Maps categories to <strong>ordered integer values</strong> based on logical ranking.</p>
<p><strong>Example:</strong></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Category</th>
<th>Ordinal Encoding</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Low</td>
<td>1</td>
</tr>
<tr class="even">
<td>Medium</td>
<td>2</td>
</tr>
<tr class="odd">
<td>High</td>
<td>3</td>
</tr>
</tbody>
</table></div>
<p><strong>When to Use:</strong></p>
<ul>
<li>Ordinal variables with meaningful order (e.g., satisfaction ratings).</li>
</ul>
<div class="sourceCode" id="cb494"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris</span><span class="op">$</span><span class="va">Species_ordinal</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, </span>
<span>                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"setosa"</span>, <span class="st">"versicolor"</span>, <span class="st">"virginica"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species_ordinal</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 1 1 1 1</span></span></code></pre></div>
</div>
<div id="weight-of-evidence-encoding" class="section level3" number="12.2.9">
<h3>
<span class="header-section-number">12.2.9</span> Weight of Evidence Encoding<a class="anchor" aria-label="anchor" href="#weight-of-evidence-encoding"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p><strong>Concept:</strong><br>
WoE is a method to convert categorical data into numerical values that capture the strength of the relationship between a feature (or category) and a binary outcome (like default vs.non-default).</p></li>
<li>
<p><strong>The Formula:</strong> <span class="math display">\[
\text{WoE} = \log \left( \frac{P(X_i | Y=1)}{P(X_i | Y=0)} \right)
\]</span></p>
<ul>
<li><p><span class="math inline">\((X_i | Y=1)\)</span>: The probability (or proportion) of observing category <span class="math inline">\(X_i\)</span> given the positive outcome (e.g., a good credit event).</p></li>
<li><p><span class="math inline">\(P(X_i | Y=0)\)</span>: The probability of observing category <span class="math inline">\(X_i\)</span> given the negative outcome (e.g., a bad credit event).</p></li>
<li>
<p><strong>Logarithm:</strong> Taking the log of the ratio gives us a symmetric scale where:</p>
<ul>
<li><p>A positive WoE indicates the category is more associated with the positive outcome.</p></li>
<li><p>A negative WoE indicates the category is more associated with the negative outcome.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>When and Why to Use WoE Encoding?</p>
<ul>
<li><p><strong>Logistic Regression in Credit Scoring:</strong><br>
Logistic regression models predict probabilities in terms of log-odds. WoE encoding aligns well with this because it essentially expresses how the odds of the positive outcome change with different categories. This is why its popular in credit scoring models.</p></li>
<li><p><strong>Interpretability:</strong><br>
The WoE transformation makes it easier to understand and interpret the relationship between each category of a variable and the outcome. Each categorys WoE value tells you whether it increases or decreases the odds of a particular event (e.g., default).</p></li>
</ul>
<p>Imagine you have a feature Employment Status with categories Employed and Unemployed:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Calculate Proportions:</strong></p>
<ul>
<li><p><span class="math inline">\(P(\text{Employed} | Y=1) = 0.8\)</span> (80% of good credit cases are employed)</p></li>
<li><p><span class="math inline">\(P(\text{Employed} | Y=0) = 0.4\)</span> (40% of bad credit cases are employed)</p></li>
</ul>
</li>
<li><p><strong>Compute WoE for Employed:</strong> <span class="math display">\[
\text{WoE}_{\text{Employed}} = \log \left( \frac{0.8}{0.4} \right) = \log(2) \approx 0.693
\]</span> A positive value indicates that being employed increases the odds of a good credit outcome.</p></li>
<li>
<p><strong>Repeat for Unemployed:</strong><br>
Suppose:</p>
<ul>
<li><p><span class="math inline">\(P(\text{Unemployed} | Y=1) = 0.2\)</span></p></li>
<li><p><span class="math inline">\(P(\text{Unemployed} | Y=0) = 0.6\)</span> <span class="math display">\[
\text{WoE}_{\text{Unemployed}} = \log \left( \frac{0.2}{0.6} \right) = \log\left(\frac{1}{3}\right) \approx -1.099
\]</span> A negative value indicates that being unemployed is associated with a higher likelihood of a bad credit outcome.</p></li>
</ul>
</li>
</ol>
<p>Why is WoE Valuable?</p>
<ul>
<li><p><strong>Linear Relationship:</strong><br>
When you plug these WoE values into a logistic regression, the model essentially adds these values linearly, which fits nicely with how logistic regression models the log-odds.</p></li>
<li><p><strong>Stability &amp; Handling of Missing Values:</strong><br>
WoE can also help in smoothing out fluctuations in categorical data, especially when there are many levels or some levels with few observations.</p></li>
<li><p><strong>Regulatory Acceptance:</strong><br>
In industries like banking, WoE is widely accepted because of its clear interpretability, which is crucial for compliance and transparency in credit risk modeling.</p></li>
</ul>
<div class="sourceCode" id="cb495"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a sample dataset</span></span>
<span><span class="co"># We assume 100 good credit cases and 100 bad credit cases</span></span>
<span><span class="co"># Good credit: 80 "Employed" and 20 "Unemployed"</span></span>
<span><span class="co"># Bad credit: 40 "Employed" and 60 "Unemployed"</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  employment_status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Employed"</span>, <span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Unemployed"</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Employed"</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Unemployed"</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  credit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate counts for each category</span></span>
<span><span class="va">woe_table</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">employment_status</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    good <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">credit</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    bad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">credit</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate the distribution for good and bad credit cases</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    dist_good <span class="op">=</span> <span class="va">good</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">good</span><span class="op">)</span>,</span>
<span>    dist_bad <span class="op">=</span> <span class="va">bad</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bad</span><span class="op">)</span>,</span>
<span>    WoE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">dist_good</span> <span class="op">/</span> <span class="va">dist_bad</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the WoE table</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">woe_table</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">employment_status</th>
<th align="right">good</th>
<th align="right">bad</th>
<th align="right">dist_good</th>
<th align="right">dist_bad</th>
<th align="right">WoE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Employed</td>
<td align="right">80</td>
<td align="right">40</td>
<td align="right">0.8</td>
<td align="right">0.4</td>
<td align="right">0.6931472</td>
</tr>
<tr class="even">
<td align="left">Unemployed</td>
<td align="right">20</td>
<td align="right">60</td>
<td align="right">0.2</td>
<td align="right">0.6</td>
<td align="right">-1.0986123</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb496"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Merge the WoE values into the original data</span></span>
<span><span class="va">data_woe</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">woe_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">employment_status</span>, <span class="va">WoE</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"employment_status"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data_woe</span><span class="op">)</span></span>
<span><span class="co">#&gt;   employment_status credit       WoE</span></span>
<span><span class="co">#&gt; 1          Employed      1 0.6931472</span></span>
<span><span class="co">#&gt; 2          Employed      1 0.6931472</span></span>
<span><span class="co">#&gt; 3          Employed      1 0.6931472</span></span>
<span><span class="co">#&gt; 4          Employed      1 0.6931472</span></span>
<span><span class="co">#&gt; 5          Employed      1 0.6931472</span></span>
<span><span class="co">#&gt; 6          Employed      1 0.6931472</span></span>
<span></span>
<span></span>
<span><span class="co"># Fit a logistic regression model using WoE as predictor</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">credit</span> <span class="op">~</span> <span class="va">WoE</span>, data <span class="op">=</span> <span class="va">data_woe</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary of the model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = credit ~ WoE, family = binomial, data = data_woe)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept) 1.023e-12  1.552e-01   0.000        1    </span></span>
<span><span class="co">#&gt; WoE         1.000e+00  1.801e-01   5.552 2.83e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 277.26  on 199  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 242.74  on 198  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 246.74</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>When you fit a logistic regression using the WoE-encoded variable, the model is essentially: <span class="math display">\[
\log\left(\frac{P(Y=1)}{P(Y=0)}\right) = \beta_0 + \beta_1 \cdot \text{WoE}
\]</span> Here, <strong>WoE</strong> represents the Weight of Evidence value for a given category.</p>
<ul>
<li><p><strong>Log Odds Change:</strong><br><span class="math inline">\(\beta_1\)</span> indicates how much the log odds of a good credit outcome change for a one-unit increase in WoE. For example, if <span class="math inline">\(\beta_1 = 0.5\)</span>, then a one-unit increase in WoE is associated with an increase of 0.5 in the log odds of having a good credit outcome.</p></li>
<li><p><strong>Odds Ratio:</strong><br>
If you exponentiate <span class="math inline">\(\beta_1\)</span>, you get the odds ratio. For instance, if <span class="math inline">\(\beta_1 = 0.5\)</span>, then <span class="math inline">\(\exp(0.5) \approx 1.65\)</span>. This means that for each one-unit increase in WoE, the odds of having a good credit outcome are multiplied by about 1.65.</p></li>
</ul>
<p>Why is This Meaningful?</p>
<ul>
<li><p><strong>Direct Link to the Data:</strong><br>
The WoE value itself is a transformation of the original categorical variable that reflects the ratio of the proportions of good to bad outcomes for that category. By using WoE, youre directly incorporating this information into the model.</p></li>
<li>
<p><strong>Interpretability:</strong><br>
The interpretation becomes intuitive:</p>
<ul>
<li><p>A <strong>positive</strong> WoE indicates that the category is more associated with a good outcome.</p></li>
<li><p>A <strong>negative</strong> WoE indicates that the category is more associated with a bad outcome.</p></li>
</ul>
<p>Thus, if <span class="math inline">\(\beta_1\)</span> is positive, it suggests that as the category moves to one with a higher WoE (i.e., more favorable for a good outcome), the likelihood of a good outcome increases.</p>
</li>
</ul>
</div>
<div id="helmert-encoding" class="section level3" number="12.2.10">
<h3>
<span class="header-section-number">12.2.10</span> Helmert Encoding<a class="anchor" aria-label="anchor" href="#helmert-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Compares each category against the mean of previous categories.</p>
<p><strong>When to Use:</strong></p>
<ul>
<li>ANOVA models and categorical regression.</li>
</ul>
</div>
<div id="probability-ratio-encoding" class="section level3" number="12.2.11">
<h3>
<span class="header-section-number">12.2.11</span> Probability Ratio Encoding<a class="anchor" aria-label="anchor" href="#probability-ratio-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Encodes categories using the probability ratio of the target variable.</p>
</div>
<div id="backward-difference-encoding" class="section level3" number="12.2.12">
<h3>
<span class="header-section-number">12.2.12</span> Backward Difference Encoding<a class="anchor" aria-label="anchor" href="#backward-difference-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Compares each category against the mean of all remaining categories.</p>
</div>
<div id="leave-one-out-encoding" class="section level3" number="12.2.13">
<h3>
<span class="header-section-number">12.2.13</span> Leave-One-Out Encoding<a class="anchor" aria-label="anchor" href="#leave-one-out-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Similar to target encoding, but excludes the current observation to avoid bias.</p>
</div>
<div id="james-stein-encoding" class="section level3" number="12.2.14">
<h3>
<span class="header-section-number">12.2.14</span> James-Stein Encoding<a class="anchor" aria-label="anchor" href="#james-stein-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>A smoothed version of target encoding, reducing overfitting.</p>
</div>
<div id="m-estimator-encoding" class="section level3" number="12.2.15">
<h3>
<span class="header-section-number">12.2.15</span> M-Estimator Encoding<a class="anchor" aria-label="anchor" href="#m-estimator-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Uses a Bayesian prior to smooth target encoding.</p>
</div>
<div id="thermometer-encoding" class="section level3" number="12.2.16">
<h3>
<span class="header-section-number">12.2.16</span> Thermometer Encoding<a class="anchor" aria-label="anchor" href="#thermometer-encoding"><i class="fas fa-link"></i></a>
</h3>
<p>Similar to one-hot encoding, but retains ordinal structure.</p>
</div>
<div id="choosing-the-right-encoding-method" class="section level3" number="12.2.17">
<h3>
<span class="header-section-number">12.2.17</span> Choosing the Right Encoding Method<a class="anchor" aria-label="anchor" href="#choosing-the-right-encoding-method"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th>Encoding Method</th>
<th>Best for Low Cardinality</th>
<th>Best for High Cardinality</th>
<th>Handles Ordinality</th>
<th>Suitable for Tree Models</th>
<th>Suitable for Linear Models</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>One-Hot Encoding</td>
<td> Yes</td>
<td> No</td>
<td> No</td>
<td> Yes</td>
<td> Yes</td>
</tr>
<tr class="even">
<td>Label Encoding</td>
<td> Yes</td>
<td> Yes</td>
<td> Yes</td>
<td> No</td>
<td> Yes</td>
</tr>
<tr class="odd">
<td>Target Encoding</td>
<td> Yes</td>
<td> Yes</td>
<td> No</td>
<td> Yes</td>
<td> Yes</td>
</tr>
<tr class="even">
<td>Frequency Encoding</td>
<td> Yes</td>
<td> Yes</td>
<td> No</td>
<td> Yes</td>
<td> Yes</td>
</tr>
<tr class="odd">
<td>Binary Encoding</td>
<td> Yes</td>
<td> Yes</td>
<td> No</td>
<td> Yes</td>
<td> Yes</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="data.html"><span class="header-section-number">11</span> Data</a></div>
<div class="next"><a href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#variable-transformation"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li>
<a class="nav-link" href="#continuous-variables"><span class="header-section-number">12.1</span> Continuous Variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#standardization-z-score-normalization"><span class="header-section-number">12.1.1</span> Standardization (Z-score Normalization)</a></li>
<li><a class="nav-link" href="#min-max-scaling-normalization"><span class="header-section-number">12.1.2</span> Min-Max Scaling (Normalization)</a></li>
<li><a class="nav-link" href="#square-root-and-cube-root-transformations"><span class="header-section-number">12.1.3</span> Square Root and Cube Root Transformations</a></li>
<li><a class="nav-link" href="#sec-logarithmic-transformation"><span class="header-section-number">12.1.4</span> Logarithmic Transformation</a></li>
<li><a class="nav-link" href="#exponential-transformation"><span class="header-section-number">12.1.5</span> Exponential Transformation</a></li>
<li><a class="nav-link" href="#power-transformation"><span class="header-section-number">12.1.6</span> Power Transformation</a></li>
<li><a class="nav-link" href="#inverse-reciprocal-transformation"><span class="header-section-number">12.1.7</span> Inverse (Reciprocal) Transformation</a></li>
<li><a class="nav-link" href="#hyperbolic-arcsine-transformation"><span class="header-section-number">12.1.8</span> Hyperbolic Arcsine Transformation</a></li>
<li><a class="nav-link" href="#ordered-quantile-normalization-rank-based-transformation"><span class="header-section-number">12.1.9</span> Ordered Quantile Normalization (Rank-Based Transformation)</a></li>
<li><a class="nav-link" href="#lambert-w-x-f-transformation"><span class="header-section-number">12.1.10</span> Lambert W x F Transformation</a></li>
<li><a class="nav-link" href="#inverse-hyperbolic-sine-transformation"><span class="header-section-number">12.1.11</span> Inverse Hyperbolic Sine Transformation</a></li>
<li><a class="nav-link" href="#sec-box-cox-transformation"><span class="header-section-number">12.1.12</span> Box-Cox Transformation</a></li>
<li><a class="nav-link" href="#yeo-johnson-transformation"><span class="header-section-number">12.1.13</span> Yeo-Johnson Transformation</a></li>
<li><a class="nav-link" href="#rankgauss-transformation"><span class="header-section-number">12.1.14</span> RankGauss Transformation</a></li>
<li><a class="nav-link" href="#automatically-choosing-the-best-transformation"><span class="header-section-number">12.1.15</span> Automatically Choosing the Best Transformation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#categorical-variables"><span class="header-section-number">12.2</span> Categorical Variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#one-hot-encoding-dummy-variables"><span class="header-section-number">12.2.1</span> One-Hot Encoding (Dummy Variables)</a></li>
<li><a class="nav-link" href="#label-encoding"><span class="header-section-number">12.2.2</span> Label Encoding</a></li>
<li><a class="nav-link" href="#feature-hashing-hash-encoding"><span class="header-section-number">12.2.3</span> Feature Hashing (Hash Encoding)</a></li>
<li><a class="nav-link" href="#binary-encoding"><span class="header-section-number">12.2.4</span> Binary Encoding</a></li>
<li><a class="nav-link" href="#base-n-encoding-generalized-binary-encoding"><span class="header-section-number">12.2.5</span> Base-N Encoding (Generalized Binary Encoding)</a></li>
<li><a class="nav-link" href="#frequency-encoding"><span class="header-section-number">12.2.6</span> Frequency Encoding</a></li>
<li><a class="nav-link" href="#target-encoding-mean-encoding"><span class="header-section-number">12.2.7</span> Target Encoding (Mean Encoding)</a></li>
<li><a class="nav-link" href="#ordinal-encoding"><span class="header-section-number">12.2.8</span> Ordinal Encoding</a></li>
<li><a class="nav-link" href="#weight-of-evidence-encoding"><span class="header-section-number">12.2.9</span> Weight of Evidence Encoding</a></li>
<li><a class="nav-link" href="#helmert-encoding"><span class="header-section-number">12.2.10</span> Helmert Encoding</a></li>
<li><a class="nav-link" href="#probability-ratio-encoding"><span class="header-section-number">12.2.11</span> Probability Ratio Encoding</a></li>
<li><a class="nav-link" href="#backward-difference-encoding"><span class="header-section-number">12.2.12</span> Backward Difference Encoding</a></li>
<li><a class="nav-link" href="#leave-one-out-encoding"><span class="header-section-number">12.2.13</span> Leave-One-Out Encoding</a></li>
<li><a class="nav-link" href="#james-stein-encoding"><span class="header-section-number">12.2.14</span> James-Stein Encoding</a></li>
<li><a class="nav-link" href="#m-estimator-encoding"><span class="header-section-number">12.2.15</span> M-Estimator Encoding</a></li>
<li><a class="nav-link" href="#thermometer-encoding"><span class="header-section-number">12.2.16</span> Thermometer Encoding</a></li>
<li><a class="nav-link" href="#choosing-the-right-encoding-method"><span class="header-section-number">12.2.17</span> Choosing the Right Encoding Method</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/12-variable_transformation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/12-variable_transformation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-04-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
