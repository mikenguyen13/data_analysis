<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Data | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="There are multiple ways to categorize data. For example, Qualitative vs. Quantitative: Qualitative Quantitative in-depth interviews, documents, focus groups, case study, ethnography. open-ended...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Chapter 12 Data | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/data.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="There are multiple ways to categorize data. For example, Qualitative vs. Quantitative: Qualitative Quantitative in-depth interviews, documents, focus groups, case study, ethnography. open-ended...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Data | A Guide on Data Analysis">
<meta name="twitter:description" content="There are multiple ways to categorize data. For example, Qualitative vs. Quantitative: Qualitative Quantitative in-depth interviews, documents, focus groups, case study, ethnography. open-ended...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-stat.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="model-specification.html"><span class="header-section-number">10</span> Model Specification</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></li>
<li><a class="active" href="data.html"><span class="header-section-number">12</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">13</span> Variable Transformation</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">14</span> Hypothesis Testing</a></li>
<li><a class="" href="marginal-effects.html"><span class="header-section-number">15</span> Marginal Effects</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">16</span> Prediction and Estimation</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">17</span> Moderation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="causal-inference.html"><span class="header-section-number">18</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="experimental-design.html"><span class="header-section-number">19</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">20</span> Sampling</a></li>
<li><a class="" href="analysis-of-variance-anova.html"><span class="header-section-number">21</span> Analysis of Variance (ANOVA)</a></li>
<li><a class="" href="multivariate-methods.html"><span class="header-section-number">22</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="quasi-experimental.html"><span class="header-section-number">23</span> Quasi-experimental</a></li>
<li><a class="" href="regression-discontinuity.html"><span class="header-section-number">24</span> Regression Discontinuity</a></li>
<li><a class="" href="difference-in-differences.html"><span class="header-section-number">25</span> Difference-in-differences</a></li>
<li><a class="" href="synthetic-control.html"><span class="header-section-number">26</span> Synthetic Control</a></li>
<li><a class="" href="event-studies.html"><span class="header-section-number">27</span> Event Studies</a></li>
<li><a class="" href="matching-methods.html"><span class="header-section-number">28</span> Matching Methods</a></li>
<li><a class="" href="interrupted-time-series.html"><span class="header-section-number">29</span> Interrupted Time Series</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">30</span> Endogeneity</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">31</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="mediation.html"><span class="header-section-number">32</span> Mediation</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">33</span> Directed Acyclic Graph</a></li>
<li><a class="" href="report.html"><span class="header-section-number">34</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">35</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">36</span> Sensitivity Analysis/ Robustness Check</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="data" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h1>
<p>There are multiple ways to categorize data. For example,</p>
<ul>
<li>Qualitative vs. Quantitative:</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="55%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Qualitative</th>
<th>Quantitative</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>in-depth interviews, documents, focus groups, case study, ethnography. open-ended questions. observations in words</td>
<td>experiments, observation in words, survey with closed-end questions, structured interviews</td>
</tr>
<tr class="even">
<td>language, descriptive</td>
<td>quantities, numbers</td>
</tr>
<tr class="odd">
<td>Text-based</td>
<td>Numbers-based</td>
</tr>
<tr class="even">
<td>Subjective</td>
<td>Objectivity</td>
</tr>
</tbody>
</table></div>
<div id="cross-sectional" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Cross-Sectional<a class="anchor" aria-label="anchor" href="#cross-sectional"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="time-series-1" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Time Series<a class="anchor" aria-label="anchor" href="#time-series-1"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[
y_t = \beta_0 + x_{t1}\beta_1 + x_{t2}\beta_2 + ... + x_{t(k-1)}\beta_{k-1} + \epsilon_t
\]</span></p>
<p>Examples</p>
<ul>
<li>
<p>Static Model</p>
<ul>
<li><span class="math inline">\(y_t=\beta_0 + x_1\beta_1 + x_2\beta_2 - x_3\beta_3 - \epsilon_t\)</span></li>
</ul>
</li>
<li>
<p>Finite Distributed Lag model</p>
<ul>
<li><span class="math inline">\(y_t=\beta_0 + pe_t\delta_0 + pe_{t-1}\delta_1 +pe_{t-2}\delta_2 + \epsilon_t\)</span></li>
<li>
<strong>Long Run Propensity (LRP)</strong> is <span class="math inline">\(LRP = \delta_0 + \delta_1 + \delta_2\)</span>
</li>
</ul>
</li>
<li>
<p>Dynamic Model</p>
<ul>
<li><span class="math inline">\(GDP_t = \beta_0 + \beta_1GDP_{t-1} - \epsilon_t\)</span></li>
</ul>
</li>
</ul>
<p><a href="linear-regression.html#finite-sample-properties">Finite Sample Properties</a> for <a href="data.html#time-series-1">Time Series</a>:</p>
<ul>
<li>A1-A3: OLS is unbiased</li>
<li>A1-A4: usual standard errors are consistent and <a href="linear-regression.html#gauss-markov-theorem">Gauss-Markov Theorem</a> holds (OLS is BLUE)</li>
<li>A1-A6, A6: Finite Sample <a href="linear-mixed-models.html#wald-test-GLMM">Wald Test</a> (t-test and F-test) are valid</li>
</ul>
<p><a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> might not hold under time series setting</p>
<ul>
<li>Spurious Time Trend - solvable</li>
<li>
<a href="linear-regression.html#a3-exogeneity-of-independent-variables">Strict</a> vs Contemporaneous Exogeneity - not solvable</li>
</ul>
<p>In time series data, there are many processes:</p>
<ul>
<li>Autoregressive model of order p: AR(p)</li>
<li>Moving average model of order q: MA(q)</li>
<li>Autoregressive model of order p and moving average model of order q: ARMA(p,q)</li>
<li>Autoregressive conditional heteroskedasticity model of order p: ARCH(p)</li>
<li>Generalized Autoregressive conditional heteroskedasticity of orders p and q; GARCH(p.q)</li>
</ul>
<div id="deterministic-time-trend" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Deterministic Time trend<a class="anchor" aria-label="anchor" href="#deterministic-time-trend"><i class="fas fa-link"></i></a>
</h3>
<p>Both the dependent and independent variables are trending over time</p>
<p><strong>Spurious Time Series Regression</strong></p>
<p><span class="math display">\[
y_t = \alpha_0 + t\alpha_1 + v_t
\]</span></p>
<p>and x takes the form</p>
<p><span class="math display">\[
x_t = \lambda_0 + t\lambda_1 + u_t
\]</span></p>
<ul>
<li>
<span class="math inline">\(\alpha_1 \neq 0\)</span> and <span class="math inline">\(\lambda_1 \neq 0\)</span>
</li>
<li>
<span class="math inline">\(v_t\)</span> and <span class="math inline">\(u_t\)</span> are independent</li>
<li>there is no relationship between <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span>
</li>
</ul>
<p>If we estimate the regression,</p>
<p><span class="math display">\[
y_t = \beta_0 + x_t\beta_1 + \epsilon_t
\]</span></p>
<p>so the true <span class="math inline">\(\beta_1=0\)</span></p>
<ul>
<li>Inconsistent: <span class="math inline">\(plim(\hat{\beta}_1)=\frac{\alpha_1}{\lambda_1}\)</span>
</li>
<li>Invalid Inference: <span class="math inline">\(|t| \to^d \infty\)</span> for <span class="math inline">\(H_0: \beta_1=0\)</span>, will always reject the null as <span class="math inline">\(n \to \infty\)</span>
</li>
<li>Uninformative <span class="math inline">\(R^2\)</span>: <span class="math inline">\(plim(R^2) = 1\)</span> will be able to perfectly predict as <span class="math inline">\(n \to \infty\)</span>
</li>
</ul>
<p>We can rewrite the equation as</p>
<p><span class="math display">\[
\begin{aligned}
y_t &amp;=\beta_0 + \beta_1x_t+\epsilon_t \\
\epsilon_t &amp;= \alpha_1t + v_t
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\beta_0 = \alpha_0\)</span> and <span class="math inline">\(\beta_1=0\)</span>. Since <span class="math inline">\(x_t\)</span> is a deterministic function of time, <span class="math inline">\(\epsilon_t\)</span> is correlated with <span class="math inline">\(x_t\)</span> and we have the usual omitted variable bias.<br>
Even when <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are related (<span class="math inline">\(\beta_1 \neq 0\)</span>) but they are both trending over time, we still get spurious results with the simple regression on <span class="math inline">\(y_t\)</span> on <span class="math inline">\(x_t\)</span></p>
<p><strong>Solutions to Spurious Trend</strong></p>
<ol style="list-style-type: decimal">
<li>
<p>Include time trend <span class="math inline">\(t\)</span> as an additional control</p>
<ul>
<li>consistent parameter estimates and valid inference</li>
</ul>
</li>
<li>
<p>Detrend both dependent and independent variables and then regress the detrended outcome on detrended independent variables (i.e., regress residuals <span class="math inline">\(\hat{u}_t\)</span> on residuals <span class="math inline">\(\hat{v}_t\)</span>)</p>
<ul>
<li>
<p>Detrending is the same as partialing out in the <a href="linear-regression.html#frisch-waugh-lovell-theorem">Frisch-Waugh-Lovell Theorem</a></p>
<ul>
<li>Could allow for non-linear time trends by including <span class="math inline">\(t\)</span> <span class="math inline">\(t^2\)</span>, and <span class="math inline">\(\exp(t)\)</span>
</li>
<li>Allow for seasonality by including indicators for relevant “seasons” (quarters, months, weeks).</li>
</ul>
</li>
</ul>
</li>
</ol>
<p><a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> does not hold under:</p>
<ul>
<li>
<p><a href="data.html#feedback-effect">Feedback Effect</a></p>
<ul>
<li>
<span class="math inline">\(\epsilon_t\)</span> influences next period’s independent variables</li>
</ul>
</li>
<li>
<p><a href="data.html#dynamic-specification">Dynamic Specification</a></p>
<ul>
<li>include last time period outcome as an explanatory variable</li>
</ul>
</li>
<li>
<p><a href="data.html#dynamically-complete">Dynamically Complete</a></p>
<ul>
<li>For finite distrusted lag model, the number of lags needs to be absolutely correct.</li>
</ul>
</li>
</ul>
</div>
<div id="feedback-effect" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Feedback Effect<a class="anchor" aria-label="anchor" href="#feedback-effect"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
y_t = \beta_0 + x_t\beta_1 + \epsilon_t
\]</span></p>
<p><a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a></p>
<p><span class="math display">\[
E(\epsilon_t|\mathbf{X})= E(\epsilon_t| x_1,x_2, ...,x_t,x_{t+1},...,x_T)
\]</span></p>
<p>will not equal 0, because <span class="math inline">\(y_t\)</span> will likely influence <span class="math inline">\(x_{t+1},..,x_T\)</span></p>
<ul>
<li>
<a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> is violated because we require the error to be uncorrelated with all time observation of the independent regressors (<strong>strict exogeneity</strong>)</li>
</ul>
</div>
<div id="dynamic-specification" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Dynamic Specification<a class="anchor" aria-label="anchor" href="#dynamic-specification"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
y_t = \beta_0 + y_{t-1}\beta_1 + \epsilon_t
\]</span></p>
<p><span class="math display">\[
E(\epsilon_t|\mathbf{X})= E(\epsilon_t| y_1,y_2, ...,y_t,y_{t+1},...,y_T)
\]</span></p>
<p>will not equal 0, because <span class="math inline">\(y_t\)</span> and <span class="math inline">\(\epsilon_t\)</span> are inherently correlated</p>
<ul>
<li>
<a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> is violated because we require the error to be uncorrelated with all time observation of the independent regressors (<strong>strict exogeneity</strong>)</li>
<li>
<a href="data.html#dynamic-specification">Dynamic Specification</a> is not allowed under <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a>
</li>
</ul>
</div>
<div id="dynamically-complete" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> Dynamically Complete<a class="anchor" aria-label="anchor" href="#dynamically-complete"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
y_t = \beta_0 + x_t\delta_0 + x_{t-1}\delta_1 + \epsilon_t
\]</span></p>
<p><span class="math display">\[
E(\epsilon_t|\mathbf{X})= E(\epsilon_t| x_1,x_2, ...,x_t,x_{t+1},...,x_T)
\]</span></p>
<p>will not equal 0, because if we did not include enough lags, <span class="math inline">\(x_{t-2}\)</span> and <span class="math inline">\(\epsilon_t\)</span> are correlated</p>
<ul>
<li>
<a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> is violated because we require the error to be uncorrelated with all time observation of the independent regressors (strict exogeneity)</li>
<li>Can be corrected by including more lags (but when stop? )</li>
</ul>
<p>Without <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a></p>
<ul>
<li>OLS is biased</li>
<li><a href="linear-regression.html#gauss-markov-theorem">Gauss-Markov Theorem</a></li>
<li>
<a href="linear-regression.html#finite-sample-properties">Finite Sample Properties</a> are invalid</li>
</ul>
<p>then, we can</p>
<ul>
<li>Focus on <a href="linear-regression.html#large-sample-properties">Large Sample Properties</a>
</li>
<li>Can use <a href="linear-regression.html#a3a">A3a</a> instead of <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a>
</li>
</ul>
<p><a href="linear-regression.html#a3a">A3a</a> in time series become</p>
<p><span class="math display">\[
A3a: E(\mathbf{x}_t'\epsilon_t)= 0
\]</span></p>
<p>only the regressors in this time period need to be independent from the error in this time period (<strong>Contemporaneous Exogeneity</strong>)</p>
<ul>
<li>
<span class="math inline">\(\epsilon_t\)</span> can be correlated with <span class="math inline">\(...,x_{t-2},x_{t-1},x_{t+1}, x_{t+2},...\)</span>
</li>
<li>can have a dynamic specification <span class="math inline">\(y_t = \beta_0 + y_{t-1}\beta_1 + \epsilon_t\)</span>
</li>
</ul>
<p>Deriving <a href="linear-regression.html#large-sample-properties">Large Sample Properties</a> for Time Series</p>
<ul>
<li><p>Assumptions <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a></p></li>
<li>
<p><a href="prerequisites.html#weak-law">Weak Law</a> and <a href="prerequisites.html#central-limit-theorem">Central Limit Theorem</a> depend on <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a></p>
<ul>
<li>
<span class="math inline">\(x_t\)</span> and <span class="math inline">\(\epsilon_t\)</span> are dependent over t</li>
<li>without <a href="prerequisites.html#weak-law">Weak Law</a> or <a href="prerequisites.html#central-limit-theorem">Central Limit Theorem</a> depend on <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>, we cannot have <a href="linear-regression.html#large-sample-properties">Large Sample Properties</a> for <a href="linear-regression.html#ordinary-least-squares">OLS</a>
</li>
<li>Instead of <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a>, we consider <a href="linear-regression.html#a5a">A5a</a>
</li>
</ul>
</li>
<li>
<p>Derivation of the Asymptotic Variance depends on <a href="linear-regression.html#a4-homoskedasticity">A4</a></p>
<ul>
<li>time series setting introduces <strong>Serial Correlation</strong>: <span class="math inline">\(Cov(\epsilon_t, \epsilon_s) \neq 0\)</span>
</li>
</ul>
</li>
</ul>
<p>under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a>, and <a href="linear-regression.html#a5a">A5a</a>, <a href="linear-regression.html#ordinary-least-squares">OLS estimator</a> is <strong>consistent</strong>, and <strong>asymptotically normal</strong></p>
</div>
<div id="highly-persistent-data" class="section level3" number="12.2.5">
<h3>
<span class="header-section-number">12.2.5</span> Highly Persistent Data<a class="anchor" aria-label="anchor" href="#highly-persistent-data"><i class="fas fa-link"></i></a>
</h3>
<p>If <span class="math inline">\(y_t, \mathbf{x}_t\)</span> are not weakly dependent stationary process</p>
<ul>
<li><p><span class="math inline">\(y_t\)</span> and <span class="math inline">\(y_{t-h}\)</span> are not almost independent for large h</p></li>
<li><p><a href="linear-regression.html#a5a">A5a</a> does not hold and OLS is not <strong>consistent</strong> and does not have a limiting distribution.</p></li>
<li><p>Example + Random Walk <span class="math inline">\(y_t = y_{t-1} + u_t\)</span> + Random Walk with a drift: <span class="math inline">\(y_t = \alpha+ y_{t-1} + u_t\)</span></p></li>
</ul>
<p><strong>Solution</strong> First difference is a stationary process</p>
<p><span class="math display">\[
y_t - y_{t-1} = u_t
\]</span></p>
<ul>
<li>If <span class="math inline">\(u_t\)</span> is a weakly dependent process (also called integrated of order 0) then <span class="math inline">\(y_t\)</span> is said to be difference-stationary process (integrated of order 1)</li>
<li>For regression, if <span class="math inline">\(\{y_t, \mathbf{x}_t \}\)</span> are random walks (integrated at order 1), can consistently estimate the first difference equation</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
y_t - y_{t-1} &amp;= (\mathbf{x}_t - \mathbf{x}_{t-1}\beta + \epsilon_t - \epsilon_{t-1}) \\
\Delta y_t &amp;= \Delta \mathbf{x}\beta + \Delta u_t
\end{aligned}
\]</span></p>
<p><strong>Unit Root Test</strong></p>
<p><span class="math display">\[
y_t = \alpha + \alpha y_{t-1} + u_t
\]</span></p>
<p>tests if <span class="math inline">\(\rho=1\)</span> (integrated of order 1)<br></p>
<ul>
<li>Under the null <span class="math inline">\(H_0: \rho = 1\)</span>, OLS is not consistent or asymptotically normal.</li>
<li>Under the alternative <span class="math inline">\(H_a: \rho &lt; 1\)</span>, OLS is consistent and asymptotically normal.</li>
<li>usual t-test is not valid, will need to use the transformed equation to produce a valid test.</li>
</ul>
<p><strong>Dickey-Fuller Test</strong> <span class="math display">\[
\Delta y_t= \alpha + \theta y_{t-1} + v_t
\]</span> where <span class="math inline">\(\theta = \rho -1\)</span><br></p>
<ul>
<li>
<span class="math inline">\(H_0: \theta = 0\)</span> and <span class="math inline">\(H_a: \theta &lt; 0\)</span>
</li>
<li>Under the null, <span class="math inline">\(\Delta y_t\)</span> is weakly dependent but <span class="math inline">\(y_{t-1}\)</span> is not.</li>
<li>Dickey and Fuller derived the non-normal asymptotic distribution. If you reject the null then <span class="math inline">\(y_t\)</span> is not a random walk.</li>
</ul>
<p>Concerns with the standard Dickey Fuller Test<br>
1. Only considers a fairly simplistic dynamic relationship</p>
<p><span class="math display">\[
\Delta y_t = \alpha + \theta y_{t-1} + \gamma_1 \Delta_{t-1} + ..+ \gamma_p \Delta_{t-p} +v_t
\]</span></p>
<ul>
<li>with one additional lag, under the null <span class="math inline">\(\Delta_{y_t}\)</span> is an AR(1) process and under the alternative <span class="math inline">\(y_t\)</span> is an AR(2) process.</li>
<li>Solution: include lags of <span class="math inline">\(\Delta_{y_t}\)</span> as controls.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Does not allow for time trend <span class="math display">\[
\Delta y_t = \alpha + \theta y_{t-1} + \delta t + v_t
\]</span>
</li>
</ol>
<ul>
<li>allows <span class="math inline">\(y_t\)</span> to have a quadratic relationship with <span class="math inline">\(t\)</span>
</li>
<li>Solution: include time trend (changes the critical values).</li>
</ul>
<p><strong>Adjusted Dickey-Fuller Test</strong> <span class="math display">\[
\Delta y_t = \alpha + \theta y_{t-1} + \delta t + \gamma_1 \Delta y_{t-1} + ... + \gamma_p \Delta y_{t-p} + v_t
\]</span> where <span class="math inline">\(\theta = 1 - \rho\)</span><br></p>
<ul>
<li>
<span class="math inline">\(H_0: \theta_1 = 0\)</span> and <span class="math inline">\(H_a: \theta_1 &lt; 0\)</span>
</li>
<li>Under the null, <span class="math inline">\(\Delta y_t\)</span> is weakly dependent but <span class="math inline">\(y_{t-1}\)</span> is not</li>
<li>Critical values are different with the time trend, if you reject the null then <span class="math inline">\(y_t\)</span> is not a random walk.</li>
</ul>
<div id="newey-west-standard-errors" class="section level5" number="12.2.5.0.1">
<h5>
<span class="header-section-number">12.2.5.0.1</span> Newey West Standard Errors<a class="anchor" aria-label="anchor" href="#newey-west-standard-errors"><i class="fas fa-link"></i></a>
</h5>
<p>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> does not hold, we can use Newey West Standard Errors (HAC - Heteroskedasticity Autocorrelation Consistent)</p>
<p><span class="math display">\[
\hat{B} = T^{-1} \sum_{t=1}^{T} e_t^2 \mathbf{x'_tx_t} + \sum_{h=1}^{g}(1-\frac{h}{g+1})T^{-1}\sum_{t=h+1}^{T} e_t e_{t-h}(\mathbf{x_t'x_{t-h}+ x_{t-h}'x_t})
\]</span></p>
<ul>
<li><p>estimates the covariances up to a distance g part</p></li>
<li><p>downweights to insure <span class="math inline">\(\hat{B}\)</span> is PSD</p></li>
<li>
<p>How to choose g:</p>
<ul>
<li>For yearly data: <span class="math inline">\(g = 1\)</span> or 2 is likely to account for most of the correlation</li>
<li>For quarterly or monthly data: g should be larger ($g = 4$ or 8 for quarterly and <span class="math inline">\(g = 12\)</span> or 14 for monthly)</li>
<li>can also take integer part of <span class="math inline">\(4(T/100)^{2/9}\)</span> or integer part of <span class="math inline">\(T^{1/4}\)</span>
</li>
</ul>
</li>
</ul>
<p><strong>Testing for Serial Correlation</strong></p>
<ol style="list-style-type: decimal">
<li><p>Run OLS regression of <span class="math inline">\(y_t\)</span> on <span class="math inline">\(\mathbf{x_t}\)</span> and obtain residuals <span class="math inline">\(e_t\)</span></p></li>
<li><p>Run OLS regression of <span class="math inline">\(e_t\)</span> on <span class="math inline">\(\mathbf{x}_t, e_{t-1}\)</span> and test whether coefficient on <span class="math inline">\(e_{t-1}\)</span> is significant.</p></li>
<li>
<p>Reject the null of no serial correlation if the coefficient is significant at the 5% level.</p>
<ul>
<li>Test using heteroskedastic robust standard errors</li>
<li>can include <span class="math inline">\(e_{t-2},e_{t-3},..\)</span> in step 2 to test for higher order serial correlation (t-test would now be an F-test of joint significance)</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<div id="repeated-cross-sections" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Repeated Cross Sections<a class="anchor" aria-label="anchor" href="#repeated-cross-sections"><i class="fas fa-link"></i></a>
</h2>
<p>For each time point (day, month, year, etc.), a set of data is sampled. This set of data can be different among different time points.</p>
<p>For example, you can sample different groups of students each time you survey.</p>
<p>Allowing structural change in pooled cross section</p>
<p><span class="math display">\[
y_i = \mathbf{x}_i \beta + \delta_1 y_1 + ... + \delta_T y_T + \epsilon_i
\]</span></p>
<p>Dummy variables for all but one time period</p>
<ul>
<li>allows different intercept for each time period</li>
<li>allows outcome to change on average for each time period</li>
</ul>
<p>Allowing for structural change in pooled cross section</p>
<p><span class="math display">\[
y_i = \mathbf{x}_i \beta + \mathbf{x}_i y_1 \gamma_1 + ... + \mathbf{x}_i y_T \gamma_T + \delta_1 y_1 + ...+ \delta_T y_T + \epsilon_i
\]</span></p>
<p>Interact <span class="math inline">\(x_i\)</span> with time period dummy variables</p>
<ul>
<li>allows different slopes for each time period</li>
<li>allows effects to change based on time period (<strong>structural break</strong>)</li>
<li>Interacting all time period dummies with <span class="math inline">\(x_i\)</span> can produce many variables - use hypothesis testing to determine which structural breaks are needed.</li>
</ul>
<div id="pooled-cross-section" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> Pooled Cross Section<a class="anchor" aria-label="anchor" href="#pooled-cross-section"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[
y_i=\mathbf{x_i\beta +x_i \times y1\gamma_1 + ...+ x_i \times yT\gamma_T + \delta_1y_1+...+ \delta_Ty_T + \epsilon_i}
\]</span></p>
<p>Interact <span class="math inline">\(x_i\)</span> with time period dummy variables</p>
<ul>
<li><p>allows different slopes for each time period</p></li>
<li>
<p>allows effect to change based on time period (structural break)</p>
<ul>
<li>interacting all time period dummies with <span class="math inline">\(x_i\)</span> can produce many variables - use hypothesis testing to determine which structural breaks are needed.</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="panel-data" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Panel Data<a class="anchor" aria-label="anchor" href="#panel-data"><i class="fas fa-link"></i></a>
</h2>
<p>Detail notes in R can be found <a href="https://cran.r-project.org/web/packages/plm/vignettes/plmPackage.html#robust">here</a></p>
<p>Follows an individual over T time periods.</p>
<p>Panel data structure is like having n samples of time series data</p>
<p><strong>Characteristics</strong></p>
<ul>
<li><p>Information both across individuals and over time (cross-sectional and time-series)</p></li>
<li><p>N individuals and T time periods</p></li>
<li>
<p>Data can be either</p>
<ul>
<li>Balanced: all individuals are observed in all time periods</li>
<li>Unbalanced: all individuals are not observed in all time periods.</li>
</ul>
</li>
<li><p>Assume correlation (clustering) over time for a given individual, with independence over individuals.</p></li>
</ul>
<p><strong>Types</strong></p>
<ul>
<li>Short panel: many individuals and few time periods.</li>
<li>Long panel: many time periods and few individuals</li>
<li>Both: many time periods and many individuals</li>
</ul>
<p><strong>Time Trends and Time Effects</strong></p>
<ul>
<li>Nonlinear</li>
<li>Seasonality</li>
<li>Discontinuous shocks</li>
</ul>
<p><strong>Regressors</strong></p>
<ul>
<li>Time-invariant regressors <span class="math inline">\(x_{it}=x_i\)</span> for all t (e.g., gender, race, education) have zero within variation</li>
<li>Individual-invariant regressors <span class="math inline">\(x_{it}=x_{t}\)</span> for all i (e.g., time trend, economy trends) have zero between variation</li>
</ul>
<p><strong>Variation for the dependent variable and regressors</strong></p>
<ul>
<li>Overall variation: variation over time and individuals.</li>
<li>Between variation: variation between individuals</li>
<li>Within variation: variation within individuals (over time).</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="19%">
<col width="80%">
</colgroup>
<thead><tr class="header">
<th>Estimate</th>
<th>Formula</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Individual mean</td>
<td><span class="math inline">\(\bar{x_i}= \frac{1}{T} \sum_{t}x_{it}\)</span></td>
</tr>
<tr class="even">
<td>Overall mean</td>
<td><span class="math inline">\(\bar{x}=\frac{1}{NT} \sum_{i} \sum_t x_{it}\)</span></td>
</tr>
<tr class="odd">
<td>Overall Variance</td>
<td><span class="math inline">\(s _O^2 = \frac{1}{NT-1} \sum_i \sum_t (x_{it} - \bar{x})^2\)</span></td>
</tr>
<tr class="even">
<td>Between variance</td>
<td><span class="math inline">\(s_B^2 = \frac{1}{N-1} \sum_i (\bar{x_i} -\bar{x})^2\)</span></td>
</tr>
<tr class="odd">
<td>Within variance</td>
<td><span class="math inline">\(s_W^2= \frac{1}{NT-1} \sum_i \sum_t (x_{it} - \bar{x_i})^2 = \frac{1}{NT-1} \sum_i \sum_t (x_{it} - \bar{x_i} +\bar{x})^2\)</span></td>
</tr>
</tbody>
</table></div>
<p><strong>Note</strong>: <span class="math inline">\(s_O^2 \approx s_B^2 + s_W^2\)</span></p>
<p>Since we have n observation for each time period t, we can control for each time effect separately by including time dummies (time effects)</p>
<p><span class="math display">\[
y_{it}=\mathbf{x_{it}\beta} + d_1\delta_1+...+d_{T-1}\delta_{T-1} + \epsilon_{it}
\]</span></p>
<p><strong>Note</strong>: we cannot use these many time dummies in time series data because in time series data, our n is 1. Hence, there is no variation, and sometimes not enough data compared to variables to estimate coefficients.</p>
<p><strong>Unobserved Effects Model</strong> Similar to group clustering, assume that there is a random effect that captures differences across individuals but is constant in time.</p>
<p><span class="math display">\[
y_it=\mathbf{x_{it}\beta} + d_1\delta_1+...+d_{T-1}\delta_{T-1} + c_i + u_{it}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(c_i + u_{it} = \epsilon_{it}\)</span></li>
<li>
<span class="math inline">\(c_i\)</span> unobserved individual heterogeneity (effect)</li>
<li>
<span class="math inline">\(u_{it}\)</span> idiosyncratic shock</li>
<li>
<span class="math inline">\(\epsilon_{it}\)</span> unobserved error term.</li>
</ul>
<div id="pooled-ols-estimator" class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> Pooled OLS Estimator<a class="anchor" aria-label="anchor" href="#pooled-ols-estimator"><i class="fas fa-link"></i></a>
</h3>
<p>If <span class="math inline">\(c_i\)</span> is uncorrelated with <span class="math inline">\(x_{it}\)</span></p>
<p><span class="math display">\[
E(\mathbf{x_{it}'}(c_i+u_{it})) = 0
\]</span></p>
<p>then <a href="linear-regression.html#a3a">A3a</a> still holds. And we have Pooled OLS consistent.</p>
<p>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> does not hold, OLS is still consistent, but not efficient, and we need cluster robust SE.</p>
<p>Sufficient for <a href="linear-regression.html#a3a">A3a</a> to hold, we need</p>
<ul>
<li>
<strong>Exogeneity</strong> for <span class="math inline">\(u_{it}\)</span> <a href="linear-regression.html#a3a">A3a</a> (contemporaneous exogeneity): <span class="math inline">\(E(\mathbf{x_{it}'}u_{it})=0\)</span> time varying error</li>
<li>
<strong>Random Effect Assumption</strong> (time constant error): <span class="math inline">\(E(\mathbf{x_{it}'}c_{i})=0\)</span>
</li>
</ul>
<p>Pooled OLS will give you consistent coefficient estimates under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a> (for both <span class="math inline">\(u_{it}\)</span> and RE assumption), and <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> (randomly sampling across i).</p>
</div>
<div id="individual-specific-effects-model" class="section level3" number="12.4.2">
<h3>
<span class="header-section-number">12.4.2</span> Individual-specific effects model<a class="anchor" aria-label="anchor" href="#individual-specific-effects-model"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>If we believe that there is unobserved heterogeneity across individual (e.g., unobserved ability of an individual affects <span class="math inline">\(y\)</span>), If the individual-specific effects are correlated with the regressors, then we have the <a href="data.html#fixed-effects-estimator">Fixed Effects Estimator</a>. and if they are not correlated we have the <a href="data.html#random-effects-estimator">Random Effects Estimator</a>.</li>
</ul>
<div id="random-effects-estimator" class="section level4" number="12.4.2.1">
<h4>
<span class="header-section-number">12.4.2.1</span> Random Effects Estimator<a class="anchor" aria-label="anchor" href="#random-effects-estimator"><i class="fas fa-link"></i></a>
</h4>
<p>Random Effects estimator is the Feasible GLS estimator that assumes <span class="math inline">\(u_{it}\)</span> is serially uncorrelated and homoskedastic</p>
<ul>
<li>
<p>Under <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a3a">A3a</a> (for both <span class="math inline">\(u_{it}\)</span> and RE assumption) and <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> (randomly sampling across i), RE estimator is consistent.</p>
<ul>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> holds for <span class="math inline">\(u_{it}\)</span>, RE is the most efficient estimator</li>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> fails to hold (may be heteroskedasticity across i, and serial correlation over t), then RE is not the most efficient, but still more efficient than pooled OLS.</li>
</ul>
</li>
</ul>
</div>
<div id="fixed-effects-estimator" class="section level4" number="12.4.2.2">
<h4>
<span class="header-section-number">12.4.2.2</span> Fixed Effects Estimator<a class="anchor" aria-label="anchor" href="#fixed-effects-estimator"><i class="fas fa-link"></i></a>
</h4>
<p>also known as <strong>Within Estimator</strong> uses within variation (over time)</p>
<p>If the <strong>RE assumption</strong> is not hold (<span class="math inline">\(E(\mathbf{x_{it}'}c_i) \neq 0\)</span>), then A3a does not hold (<span class="math inline">\(E(\mathbf{x_{it}'}\epsilon_i) \neq 0\)</span>).</p>
<p>Hence, the OLS and RE are inconsistent/biased (because of omitted variable bias)</p>
<p>However, FE can only fix bias due to time-invariant factors (both observables and unobservables) correlated with treatment (not time-variant factors that correlated with the treatment).</p>
<p>The traditional FE technique is flawed when lagged dependent variables are included in the model. <span class="citation">(<a href="references.html#ref-nickell1981biases">Nickell 1981</a>)</span> <span class="citation">(<a href="references.html#ref-narayanan2013estimating">Narayanan and Nair 2013</a>)</span></p>
<p>With measurement error in the independent, FE will exacerbate the errors-in-the-variables bias.</p>
<div id="demean-approach" class="section level5" number="12.4.2.2.1">
<h5>
<span class="header-section-number">12.4.2.2.1</span> Demean Approach<a class="anchor" aria-label="anchor" href="#demean-approach"><i class="fas fa-link"></i></a>
</h5>
<p>To deal with violation in <span class="math inline">\(c_i\)</span>, we have</p>
<p><span class="math display">\[
y_{it}= \mathbf{x_{it} \beta} + c_i + u_{it}
\]</span></p>
<p><span class="math display">\[
\bar{y_i}=\bar{\mathbf{x_i}} \beta + c_i + \bar{u_i}
\]</span></p>
<p>where the second equation is the time averaged equation</p>
<p>using <strong>within transformation</strong>, we have</p>
<p><span class="math display">\[
y_{it} - \bar{y_i} = \mathbf{(x_{it} - \bar{x_i})}\beta + u_{it} - \bar{u_i}
\]</span></p>
<p>because <span class="math inline">\(c_i\)</span> is time constant.</p>
<p>The Fixed Effects estimator uses POLS on the transformed equation</p>
<p><span class="math display">\[
y_{it} - \bar{y_i} = \mathbf{(x_{it} - \bar{x_i})} \beta + d_1\delta_1 + ... + d_{T-2}\delta_{T-2} + u_{it} - \bar{u_i}
\]</span></p>
<ul>
<li><p>we need <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> (strict exogeneity) (<span class="math inline">\(E((\mathbf{x_{it}-\bar{x_i}})'(u_{it}-\bar{u_i})=0\)</span>) to have FE consistent.</p></li>
<li>
<p>Variables that are time constant will be absorbed into <span class="math inline">\(c_i\)</span>. Hence we cannot make inference on time constant independent variables.</p>
<ul>
<li>If you are interested in the effects of time-invariant variables, you could consider the OLS or <strong>between estimator</strong>
</li>
</ul>
</li>
<li><p>It’s recommended that you should still use cluster robust standard errors.</p></li>
</ul>
</div>
<div id="dummy-approach" class="section level5" number="12.4.2.2.2">
<h5>
<span class="header-section-number">12.4.2.2.2</span> Dummy Approach<a class="anchor" aria-label="anchor" href="#dummy-approach"><i class="fas fa-link"></i></a>
</h5>
<p>Equivalent to the within transformation (i.e., mathematically equivalent to <a href="data.html#demean-approach">Demean Approach</a>), we can have the fixed effect estimator be the same with the dummy regression</p>
<p><span class="math display">\[
y_{it} = x_{it}\beta + d_1\delta_1 + ... + d_{T-2}\delta_{T-2} + c_1\gamma_1 + ... + c_{n-1}\gamma_{n-1} + u_{it}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
c_i
=
\begin{cases}
1 &amp;\text{if observation is i} \\
0 &amp;\text{otherwise} \\
\end{cases}
\]</span></p>
<ul>
<li>The standard error is incorrectly calculated.</li>
<li>the FE within transformation is controlling for any difference across individual which is allowed to correlated with observables.</li>
</ul>
</div>
<div id="first-difference-approach" class="section level5" number="12.4.2.2.3">
<h5>
<span class="header-section-number">12.4.2.2.3</span> First-difference Approach<a class="anchor" aria-label="anchor" href="#first-difference-approach"><i class="fas fa-link"></i></a>
</h5>
<p>Economists typically use this approach</p>
<p><span class="math display">\[
y_{it} - y_{i (t-1)} = (\mathbf{x}_{it} - \mathbf{x}_{i(t-1)}) \beta +  + (u_{it} - u_{i(t-1)})
\]</span></p>
</div>
<div id="fixed-effects-summary" class="section level5" number="12.4.2.2.4">
<h5>
<span class="header-section-number">12.4.2.2.4</span> Fixed Effects Summary<a class="anchor" aria-label="anchor" href="#fixed-effects-summary"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>
<p>The three approaches are <strong>almost</strong> equivalent.</p>
<ul>
<li><p><a href="data.html#demean-approach">Demean Approach</a> is mathematically equivalent to <a href="data.html#dummy-approach">Dummy Approach</a></p></li>
<li><p>If you have only 1 period, all 3 are the same.</p></li>
</ul>
</li>
<li>
<p>Since fixed effect is a within estimator, only <strong>status changes</strong> can contribute to <span class="math inline">\(\beta\)</span> variation.</p>
<ul>
<li>Hence, with a small number of changes then the standard error for <span class="math inline">\(\beta\)</span> will explode</li>
</ul>
</li>
<li>
<p>Status changes mean subjects change from (1) control to treatment group or (2) treatment to control group. Those who have status change, we call them <strong>switchers</strong>.</p>
<ul>
<li><p>Treatment effect is typically <strong>non-directional</strong>.</p></li>
<li><p>You can give a parameter for the direction if needed.</p></li>
</ul>
</li>
<li>
<p>Issues:</p>
<ul>
<li><p>You could have fundamental difference between switchers and non-switchers. Even though we can’t definitive test this, but providing descriptive statistics on switchers and non-switchers can give us confidence in our conclusion.</p></li>
<li><p>Because fixed effects focus on bias reduction, you might have larger variance (typically, with fixed effects you will have less df)</p></li>
</ul>
</li>
<li><p>If the true model is <a href="data.html#random-effects-estimator">random effect</a>, economists typically don’t care, especially when <span class="math inline">\(c_i\)</span> is the random effect and <span class="math inline">\(c_i \perp x_{it}\)</span> (because RE assumption is that it is unrelated to <span class="math inline">\(x_{it}\)</span>). The reason why economists don’t care is because RE wouldn’t correct bias, it only improves efficiency over OLS.</p></li>
<li><p>You can estimate FE for different units (not just individuals).</p></li>
<li><p>FE removes bias from time invariant factors but not without costs because it uses within variation, which imposes strict exogeneity assumption on <span class="math inline">\(u_{it}\)</span>: <span class="math inline">\(E[(x_{it} - \bar{x}_{i})(u_{it} - \bar{u}_{it})]=0\)</span></p></li>
</ul>
<p>Recall</p>
<p><span class="math display">\[
Y_{it} = \beta_0 + X_{it}\beta_1 + \alpha_i + u_{it}
\]</span></p>
<p>where <span class="math inline">\(\epsilon_{it} = \alpha_i + u_{it}\)</span></p>
<p><span class="math display">\[
\hat{\sigma}^2_\epsilon = \frac{SSR_{OLS}}{NT - K}
\]</span></p>
<p><span class="math display">\[
\hat{\sigma}^2_u = \frac{SSR_{FE}}{NT - (N+K)} = \frac{SSR_{FE}}{N(T-1)-K}
\]</span></p>
<p>It’s ambiguous whether your variance of error changes up or down because SSR can increase while the denominator decreases.</p>
<p>FE can be unbiased, but not consistent (i.e., not converging to the true effect)</p>
</div>
<div id="fe-examples" class="section level5" number="12.4.2.2.5">
<h5>
<span class="header-section-number">12.4.2.2.5</span> FE Examples<a class="anchor" aria-label="anchor" href="#fe-examples"><i class="fas fa-link"></i></a>
</h5>
</div>
<div id="blau1999" class="section level5" number="12.4.2.2.6">
<h5>
<span class="header-section-number">12.4.2.2.6</span> <span class="citation">Blau (<a href="references.html#ref-blau1999">1999</a>)</span><a class="anchor" aria-label="anchor" href="#blau1999"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li><p>Intergenerational mobility</p></li>
<li><p>If we transfer resources to low income family, can we generate upward mobility (increase ability)?</p></li>
</ul>
<p>Mechanisms for intergenerational mobility</p>
<ol style="list-style-type: decimal">
<li>Genetic (policy can’t affect) (i.e., ability endowment)</li>
<li>Environmental indirect</li>
<li>Environmental direct</li>
</ol>
<p><span class="math display">\[
\frac{\% \Delta \text{Human capital}}{\% \Delta \text{income}}
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>Financial transfer</li>
</ol>
<p>Income measures:</p>
<ol style="list-style-type: decimal">
<li>Total household income</li>
<li>Wage income</li>
<li>Non-wage income</li>
<li>Annual versus permanent income</li>
</ol>
<p>Core control variables:</p>
<p><strong>Bad controls are those jointly determined with dependent variable</strong></p>
<p>Control by mother = choice by mother</p>
<p>Uncontrolled by mothers:</p>
<ul>
<li><p>mother race</p></li>
<li><p>location of birth</p></li>
<li><p>education of parents</p></li>
<li><p>household structure at age 14</p></li>
</ul>
<p><span class="math display">\[
Y_{ijt} = X_{jt} \beta_i + I_{jt} \alpha_i + \epsilon_{ijt}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(i\)</span> = test</p></li>
<li><p><span class="math inline">\(j\)</span> = individual (child)</p></li>
<li><p><span class="math inline">\(t\)</span> = time</p></li>
</ul>
<p>Grandmother’s model</p>
<p>Since child is nested within mother and mother nested within grandmother, the fixed effect of child is included in the fixed effect of mother, which is included in the fixed-effect of grandmother</p>
<p><span class="math display">\[
Y_{ijgmt} = X_{it} \beta_{i} + I_{jt} \alpha_i + \gamma_g + u_{ijgmt}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(i\)</span> = test, <span class="math inline">\(j\)</span> = kid, <span class="math inline">\(m\)</span> = mother, <span class="math inline">\(g\)</span> = grandmother</p></li>
<li><p>where <span class="math inline">\(\gamma_g\)</span> includes <span class="math inline">\(\gamma_m\)</span> includes <span class="math inline">\(\gamma_j\)</span></p></li>
</ul>
<p>Grandma fixed-effect</p>
<p>Pros:</p>
<ul>
<li><p>control for some genetics + fixed characteristics of how mother are raised</p></li>
<li><p>can estimate effect of parameter income</p></li>
</ul>
<p>Con:</p>
<ul>
<li>Might not be a sufficient control</li>
</ul>
<p>Common to cluster a the fixed-effect level (common correlated component)</p>
<p><strong>Fixed effect exaggerates attenuation bias</strong></p>
<p>Error rate on survey can help you fix this (plug in the number only , but not the uncertainty associated with that number).</p>
</div>
<div id="babcock2010" class="section level5" number="12.4.2.2.7">
<h5>
<span class="header-section-number">12.4.2.2.7</span> <span class="citation">Babcock (<a href="references.html#ref-babcock2010">2010</a>)</span><a class="anchor" aria-label="anchor" href="#babcock2010"><i class="fas fa-link"></i></a>
</h5>
<p><span class="math display">\[
T_{ijct} = \alpha_0 + S_{jct} \alpha_1 + X_{ijct} \alpha_2 + u_{ijct}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(S_{jct}\)</span> is the average class expectation</p></li>
<li><p><span class="math inline">\(X_{ijct}\alpha_2\)</span> is the individual characteristics</p></li>
<li><p><span class="math inline">\(i\)</span> student</p></li>
<li><p><span class="math inline">\(j\)</span> instructor</p></li>
<li><p><span class="math inline">\(c\)</span> course</p></li>
<li><p><span class="math inline">\(t\)</span> time</p></li>
</ul>
<p><span class="math display">\[
T_{ijct} = \beta_0+ S_{jct} \beta_1+ X_{ijct} \beta_2 +\mu_{jc} + \epsilon_{ijct}
\]</span></p>
<p>where <span class="math inline">\(\mu_{jc}\)</span> is instructor by course fixed effect (unique id), which is different from <span class="math inline">\((\theta_j + \delta_c)\)</span></p>
<ol style="list-style-type: decimal">
<li>Decrease course shopping because conditioned on available information (<span class="math inline">\(\mu_{jc}\)</span>) (class grade and instructor’s info).</li>
<li>Grade expectation change even though class materials stay the same</li>
</ol>
<p>Identification strategy is</p>
<ul>
<li>Under (fixed) time-varying factor that could bias my coefficient (simultaneity)</li>
</ul>
<p><span class="math display">\[
Y_{ijt} = X_{it} \beta_1 + \text{Teacher Experience}_{jt} \beta_2 + \text{Teacher education}_{jt} \beta_3 + \text{Teacher score}_{it}\beta_4 + \dots + \epsilon_{ijt}
\]</span></p>
<p>Drop teacher characteristics, and include teacher dummy effect</p>
<p><span class="math display">\[
Y_{ijt} = X_{it} \alpha + \Gamma_{it} \theta_j + u_{ijt}
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the within teacher (conditional on teacher fixed effect) and <span class="math inline">\(j = 1 \to (J-1)\)</span></p>
<p>Nuisance in the sense that we don’t about the interpretation of <span class="math inline">\(\alpha\)</span></p>
<p>The least we can say about <span class="math inline">\(\theta_j\)</span> is the teacher effect conditional on student test score.</p>
<p><span class="math display">\[
Y_{ijt} = X_{it} \gamma + \epsilon_{ijt}
\]</span></p>
<p><span class="math inline">\(\gamma\)</span> is between within (unconditional) and <span class="math inline">\(e_{ijt}\)</span> is the prediction error</p>
<p><span class="math display">\[
e_{ijt} = T_{it} \delta_j + \tilde{e}_{ijt}
\]</span></p>
<p>where <span class="math inline">\(\delta_j\)</span> is the mean for each group</p>
<p><span class="math display">\[
Y_{ijkt} = Y_{ijkt-1} + X_{it} \beta + T_{it} \tau_j + (W_i + P_k + \epsilon_{ijkt})
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(Y_{ijkt-1}\)</span> = lag control</p></li>
<li><p><span class="math inline">\(\tau_j\)</span> = teacher fixed time</p></li>
<li><p><span class="math inline">\(W_i\)</span> is the student fixed effect</p></li>
<li><p><span class="math inline">\(P_k\)</span> is the school fixed effect</p></li>
<li><p><span class="math inline">\(u_{ijkt} = W_i + P_k + \epsilon_{ijkt}\)</span></p></li>
</ul>
<p>And we worry about selection on class and school</p>
<p>Bias in <span class="math inline">\(\tau\)</span> (for 1 teacher) is</p>
<p><span class="math display">\[
\frac{1}{N_j} \sum_{i = 1}^N (W_i + P_k + \epsilon_{ijkt})
\]</span></p>
<p>where <span class="math inline">\(N_j\)</span> = the number of student in class with teacher <span class="math inline">\(j\)</span></p>
<p>then we can <span class="math inline">\(P_k + \frac{1}{N_j} \sum_{i = 1}^{N_j} (W_i + \epsilon_{ijkt})\)</span></p>
<p>Shocks from small class can bias <span class="math inline">\(\tau\)</span></p>
<p><span class="math display">\[
\frac{1}{N_j} \sum_{i = 1}^{N_j} \epsilon_{ijkt} \neq 0
\]</span></p>
<p>which will inflate the teacher fixed effect</p>
<p>Even if we create random teacher fixed effect and put it in the model, it still contains bias mentioned above which can still <span class="math inline">\(\tau\)</span> (but we do not know the way it will affect - whether more positive or negative).</p>
<p>If teachers switch schools, then we can estimate both teacher and school fixed effect (<strong>mobility web</strong> thin vs. thick)</p>
<p>Mobility web refers to the web of switchers (i.e., from one status to another).</p>
<p><span class="math display">\[
Y_{ijkt} = Y_{ijk(t-1)} \alpha + X_{it}\beta + T_{it} \tau + P_k + \epsilon_{ijkt}
\]</span></p>
<p>If we demean (fixed-effect), <span class="math inline">\(\tau\)</span> (teacher fixed effect) will go away</p>
<p>If you want to examine teacher fixed effect, we have to include teacher fixed effect</p>
<p>Control for school, the article argues that there is no selection bias</p>
<p>For <span class="math inline">\(\frac{1}{N_j} \sum_{i =1}^{N_j} \epsilon_{ijkt}\)</span> (teacher-level average residuals), <span class="math inline">\(var(\tau)\)</span> does not change with <span class="math inline">\(N_j\)</span> (Figure 2 in the paper). In words, the quality of teachers is not a function of the number of students</p>
<p>If <span class="math inline">\(var(\tau) =0\)</span> it means that teacher quality does not matter</p>
<p>Spin-off of <a href="endogeneity.html#measurement-error">Measurement Error</a>: Sampling error or estimation error</p>
<p><span class="math display">\[
\hat{\tau}_j = \tau_j + \lambda_j
\]</span></p>
<p><span class="math display">\[
var(\hat{\tau}) = var(\tau + \lambda)
\]</span></p>
<p>Assume <span class="math inline">\(cov(\tau_j, \lambda_j)=0\)</span> (reasonable) In words, your randomness in getting children does not correlation with teacher quality.</p>
<p>Hence,</p>
<p><span class="math display">\[
\begin{aligned}
var(\hat{\tau}) &amp;= var(\tau) + var(\lambda) \\
var(\tau) &amp;= var(\hat{\tau}) - var(\lambda) \\
\end{aligned}
\]</span></p>
<p>We have <span class="math inline">\(var(\hat{\tau})\)</span> and we need to estimate <span class="math inline">\(var(\lambda)\)</span></p>
<p><span class="math display">\[
var(\lambda) = \frac{1}{J} \sum_{j=1}^J \hat{\sigma}^2_j
\]</span> where <span class="math inline">\(\hat{\sigma}^2_j\)</span> is the squared standard error of the teacher <span class="math inline">\(j\)</span> (a function of <span class="math inline">\(n\)</span>)</p>
<p>Hence,</p>
<p><span class="math display">\[
\frac{var(\tau)}{var(\hat{\tau})} = \text{reliability} = \text{true variance signal}
\]</span> also known as how much noise in <span class="math inline">\(\hat{\tau}\)</span> and</p>
<p><span class="math display">\[
1 - \frac{var(\tau)}{var(\hat{\tau})} = \text{noise}
\]</span></p>
<p>Even in cases where the true relationship is that <span class="math inline">\(\tau\)</span> is a function of <span class="math inline">\(N_j\)</span>, then our recovery method for <span class="math inline">\(\lambda\)</span> is still not affected</p>
<p>To examine our assumption</p>
<p><span class="math display">\[
\hat{\tau}_j = \beta_0 + X_j \beta_1 + \epsilon_j
\]</span></p>
<p>Regressing teacher fixed-effect on teacher characteristics should give us <span class="math inline">\(R^2\)</span> close to 0, because teacher characteristics cannot predict sampling error (<span class="math inline">\(\hat{\tau}\)</span> contain sampling error)</p>
</div>
</div>
</div>
<div id="tests-for-assumptions" class="section level3" number="12.4.3">
<h3>
<span class="header-section-number">12.4.3</span> Tests for Assumptions<a class="anchor" aria-label="anchor" href="#tests-for-assumptions"><i class="fas fa-link"></i></a>
</h3>
<p>We typically don’t test heteroskedasticity because we will use robust covariance matrix estimation anyway.</p>
<p>Dataset</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=plm">"plm"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"EmplUK"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Produc"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Grunfeld"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Wages"</span>, package<span class="op">=</span><span class="st">"plm"</span><span class="op">)</span></span></code></pre></div>
<div id="poolability" class="section level4" number="12.4.3.1">
<h4>
<span class="header-section-number">12.4.3.1</span> Poolability<a class="anchor" aria-label="anchor" href="#poolability"><i class="fas fa-link"></i></a>
</h4>
<p>also known as an F test of stability (or Chow test) for the coefficients</p>
<p><span class="math inline">\(H_0\)</span>: All individuals have the same coefficients (i.e., equal coefficients for all individuals).</p>
<p><span class="math inline">\(H_a\)</span> Different individuals have different coefficients.</p>
<p>Notes:</p>
<ul>
<li>Under a within (i.e., fixed) model, different intercepts for each individual are assumed</li>
<li>Under random model, same intercept is assumed</li>
</ul>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=plm">plm</a></span><span class="op">)</span></span>
<span><span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pooltest.html">pooltest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, model<span class="op">=</span><span class="st">"within"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F statistic</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; F = 5.7805, df1 = 18, df2 = 170, p-value = 1.219e-10</span></span>
<span><span class="co">#&gt; alternative hypothesis: unstability</span></span></code></pre></div>
<p>Hence, we reject the null hypothesis that coefficients are stable. Then, we should use the random model.</p>
</div>
<div id="individual-and-time-effects" class="section level4" number="12.4.3.2">
<h4>
<span class="header-section-number">12.4.3.2</span> Individual and time effects<a class="anchor" aria-label="anchor" href="#individual-and-time-effects"><i class="fas fa-link"></i></a>
</h4>
<p>use the Lagrange multiplier test to test the presence of individual or time or both (i.e., individual and time).</p>
<p>Types:</p>
<ul>
<li>
<code>honda</code>: <span class="citation">(<a href="references.html#ref-honda1985testing">Honda 1985</a>)</span> Default</li>
<li>
<code>bp</code>: <span class="citation">(<a href="references.html#ref-Breusch_1980">Breusch and Pagan 1980</a>)</span> for unbalanced panels</li>
<li>
<code>kw</code>: <span class="citation">(<a href="references.html#ref-King_1997">M. L. King and Wu 1997</a>)</span> unbalanced panels, and two-way effects</li>
<li>
<code>ghm</code>: <span class="citation">(<a href="references.html#ref-gourieroux1982likelihood">Gourieroux, Holly, and Monfort 1982</a>)</span>: two-way effects</li>
</ul>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pFtest.html">pFtest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, effect<span class="op">=</span><span class="st">"twoways"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F test for twoways effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; F = 17.403, df1 = 28, df2 = 169, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: significant effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pFtest.html">pFtest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, effect<span class="op">=</span><span class="st">"individual"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F test for individual effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; F = 49.177, df1 = 9, df2 = 188, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: significant effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pFtest.html">pFtest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, effect<span class="op">=</span><span class="st">"time"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  F test for time effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; F = 0.23451, df1 = 19, df2 = 178, p-value = 0.9997</span></span>
<span><span class="co">#&gt; alternative hypothesis: significant effects</span></span></code></pre></div>
</div>
<div id="cross-sectional-dependencecontemporaneous-correlation" class="section level4" number="12.4.3.3">
<h4>
<span class="header-section-number">12.4.3.3</span> Cross-sectional dependence/contemporaneous correlation<a class="anchor" aria-label="anchor" href="#cross-sectional-dependencecontemporaneous-correlation"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Null hypothesis: residuals across entities are not correlated.</li>
</ul>
<div id="global-cross-sectional-dependence" class="section level5" number="12.4.3.3.1">
<h5>
<span class="header-section-number">12.4.3.3.1</span> Global cross-sectional dependence<a class="anchor" aria-label="anchor" href="#global-cross-sectional-dependence"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, model<span class="op">=</span><span class="st">"within"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pesaran CD test for cross-sectional dependence in panels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; z = 4.6612, p-value = 3.144e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: cross-sectional dependence</span></span></code></pre></div>
</div>
<div id="local-cross-sectional-dependence" class="section level5" number="12.4.3.3.2">
<h5>
<span class="header-section-number">12.4.3.3.2</span> Local cross-sectional dependence<a class="anchor" aria-label="anchor" href="#local-cross-sectional-dependence"><i class="fas fa-link"></i></a>
</h5>
<p>use the same command, but supply matrix <code>w</code> to the argument.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">inv</span><span class="op">~</span><span class="va">value</span><span class="op">+</span><span class="va">capital</span>, data<span class="op">=</span><span class="va">Grunfeld</span>, model<span class="op">=</span><span class="st">"within"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Pesaran CD test for cross-sectional dependence in panels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; z = 4.6612, p-value = 3.144e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: cross-sectional dependence</span></span></code></pre></div>
</div>
</div>
<div id="serial-correlation-1" class="section level4" number="12.4.3.4">
<h4>
<span class="header-section-number">12.4.3.4</span> Serial Correlation<a class="anchor" aria-label="anchor" href="#serial-correlation-1"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Null hypothesis: there is no serial correlation</p></li>
<li><p>usually seen in macro panels with long time series (large N and T), not seen in micro panels (small T and large N)</p></li>
<li><p>Serial correlation can arise from individual effects(i.e., time-invariant error component), or idiosyncratic error terms (e..g, in the case of AR(1) process). But typically, when we refer to serial correlation, we refer to the second one.</p></li>
<li>
<p>Can be</p>
<ul>
<li><p><strong>marginal</strong> test: only 1 of the two above dependence (but can be biased towards rejection)</p></li>
<li><p><strong>joint</strong> test: both dependencies (but don’t know which one is causing the problem)</p></li>
<li><p><strong>conditional</strong> test: assume you correctly specify one dependence structure, test whether the other departure is present.</p></li>
</ul>
</li>
</ul>
<div id="unobserved-effect-test" class="section level5" number="12.4.3.4.1">
<h5>
<span class="header-section-number">12.4.3.4.1</span> Unobserved effect test<a class="anchor" aria-label="anchor" href="#unobserved-effect-test"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>
<p>semi-parametric test (the test statistic <span class="math inline">\(W \dot{\sim} N\)</span> regardless of the distribution of the errors) with <span class="math inline">\(H_0: \sigma^2_\mu = 0\)</span> (i.e., no unobserved effects in the residuals), favors pooled OLS.</p>
<ul>
<li>Under the null, covariance matrix of the residuals = its diagonal (off-diagonal = 0)</li>
</ul>
</li>
<li><p>It is robust against both <strong>unobserved effects</strong> that are constant within every group, and any kind of <strong>serial correlation</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pwtest.html">pwtest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">+</span> <span class="va">unemp</span>, data <span class="op">=</span> <span class="va">Produc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wooldridge's test for unobserved individual effects</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  formula</span></span>
<span><span class="co">#&gt; z = 3.9383, p-value = 8.207e-05</span></span>
<span><span class="co">#&gt; alternative hypothesis: unobserved effect</span></span></code></pre></div>
<p>Here, we reject the null hypothesis that the no unobserved effects in the residuals. Hence, we will exclude using pooled OLS.</p>
</div>
<div id="locally-robust-tests-for-random-effects-and-serial-correlation" class="section level5" number="12.4.3.4.2">
<h5>
<span class="header-section-number">12.4.3.4.2</span> Locally robust tests for random effects and serial correlation<a class="anchor" aria-label="anchor" href="#locally-robust-tests-for-random-effects-and-serial-correlation"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>A joint LM test for <strong>random effects</strong> and <strong>serial correlation</strong> assuming normality and homoskedasticity of the idiosyncratic errors [<span class="citation">Baltagi and Li (<a href="references.html#ref-baltagi1991joint">1991</a>)</span>]<span class="citation">(<a href="references.html#ref-baltagi1995testing">Baltagi and Li 1995</a>)</span>
</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbsytest.html">pbsytest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">+</span> <span class="va">unemp</span>,</span>
<span>         data <span class="op">=</span> <span class="va">Produc</span>,</span>
<span>         test <span class="op">=</span> <span class="st">"j"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Baltagi and Li AR-RE joint test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  formula</span></span>
<span><span class="co">#&gt; chisq = 4187.6, df = 2, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: AR(1) errors or random effects</span></span></code></pre></div>
<p>Here, we reject the null hypothesis that there is no presence of <strong>serial correlation,</strong> and <strong>random effects</strong>. But we still do not know whether it is because of serial correlation, of random effects or of both</p>
<p>To know the departure from the null assumption, we can use <span class="citation">Bera, Sosa-Escudero, and Yoon (<a href="references.html#ref-bera2001tests">2001</a>)</span>’s test for first-order serial correlation or random effects (both under normality and homoskedasticity assumption of the error).</p>
<p>BSY for serial correlation</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbsytest.html">pbsytest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">+</span> <span class="va">unemp</span>,</span>
<span>         data <span class="op">=</span> <span class="va">Produc</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Bera, Sosa-Escudero and Yoon locally robust test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  formula</span></span>
<span><span class="co">#&gt; chisq = 52.636, df = 1, p-value = 4.015e-13</span></span>
<span><span class="co">#&gt; alternative hypothesis: AR(1) errors sub random effects</span></span></code></pre></div>
<p>BSY for random effects</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbsytest.html">pbsytest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span><span class="op">+</span><span class="va">unemp</span>, </span>
<span>         data<span class="op">=</span><span class="va">Produc</span>, </span>
<span>         test<span class="op">=</span><span class="st">"re"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Bera, Sosa-Escudero and Yoon locally robust test (one-sided)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  formula</span></span>
<span><span class="co">#&gt; z = 57.914, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: random effects sub AR(1) errors</span></span></code></pre></div>
<p>Since BSY is only locally robust, if you “know” there is no serial correlation, then this test is based on LM test is more superior:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/plmtest.html">plmtest</a></span><span class="op">(</span><span class="va">inv</span> <span class="op">~</span> <span class="va">value</span> <span class="op">+</span> <span class="va">capital</span>, data <span class="op">=</span> <span class="va">Grunfeld</span>, </span>
<span>        type <span class="op">=</span> <span class="st">"honda"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lagrange Multiplier Test - (Honda)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; normal = 28.252, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: significant effects</span></span></code></pre></div>
<p>On the other hand, if you know there is no random effects, to test for serial correlation, use <span class="citation">(<a href="references.html#ref-breusch1978testing">Breusch 1978</a>)</span>-<span class="citation">(<a href="references.html#ref-godfrey1978testing">Godfrey 1978</a>)</span>’s test</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bgtest.html">bgtest</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If you “know” there are random effects, use <span class="citation">(<a href="references.html#ref-baltagi1995testing">Baltagi and Li 1995</a>)</span>’s. to test for serial correlation in both AR(1) and MA(1) processes.</p>
<p><span class="math inline">\(H_0\)</span>: Uncorrelated errors.</p>
<p>Note:</p>
<ul>
<li>one-sided only has power against positive serial correlation.</li>
<li>applicable to only balanced panels.</li>
</ul>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbltest.html">pbltest</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">gsp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pcap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pc</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">+</span> <span class="va">unemp</span>,</span>
<span>    data <span class="op">=</span> <span class="va">Produc</span>,</span>
<span>    alternative <span class="op">=</span> <span class="st">"onesided"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Baltagi and Li one-sided LM test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp</span></span>
<span><span class="co">#&gt; z = 21.69, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: AR(1)/MA(1) errors in RE panel model</span></span></code></pre></div>
<p>General serial correlation tests</p>
<ul>
<li>applicable to random effects model, OLS, and FE (with large T, also known as long panel).</li>
<li>can also test higher-order serial correlation</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbgtest.html">pbgtest</a></span><span class="op">(</span><span class="fu">plm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">inv</span> <span class="op">~</span> <span class="va">value</span> <span class="op">+</span> <span class="va">capital</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">Grunfeld</span>,</span>
<span>                      model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span>,</span>
<span>             order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Breusch-Godfrey/Wooldridge test for serial correlation in panel models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; chisq = 42.587, df = 2, p-value = 5.655e-10</span></span>
<span><span class="co">#&gt; alternative hypothesis: serial correlation in idiosyncratic errors</span></span></code></pre></div>
<p>in the case of short panels (small T and large n), we can use</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pwartest.html">pwartest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">capital</span><span class="op">)</span>, data<span class="op">=</span><span class="va">EmplUK</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wooldridge's test for serial correlation in FE panels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  plm.model</span></span>
<span><span class="co">#&gt; F = 312.3, df1 = 1, df2 = 889, p-value &lt; 2.2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: serial correlation</span></span></code></pre></div>
</div>
</div>
<div id="unit-rootsstationarity" class="section level4" number="12.4.3.5">
<h4>
<span class="header-section-number">12.4.3.5</span> Unit roots/stationarity<a class="anchor" aria-label="anchor" href="#unit-rootsstationarity"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>Dickey-Fuller test for stochastic trends.</li>
<li>Null hypothesis: the series is non-stationary (unit root)</li>
<li>You would want your test to be less than the critical value (p&lt;.5) so that there is evidence there is not unit roots.</li>
</ul>
</div>
<div id="heteroskedasticity-2" class="section level4" number="12.4.3.6">
<h4>
<span class="header-section-number">12.4.3.6</span> Heteroskedasticity<a class="anchor" aria-label="anchor" href="#heteroskedasticity-2"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p>Breusch-Pagan test</p></li>
<li><p>Null hypothesis: the data is homoskedastic</p></li>
<li><p>If there is evidence for heteroskedasticity, robust covariance matrix is advised.</p></li>
<li>
<p>To control for heteroskedasticity: Robust covariance matrix estimation (Sandwich estimator)</p>
<ul>
<li>“white1” - for general heteroskedasticity but no serial correlation (check serial correlation first). Recommended for random effects.</li>
<li>“white2” - is “white1” restricted to a common variance within groups. Recommended for random effects.</li>
<li>“arellano” - both heteroskedasticity and serial correlation. Recommended for fixed effects</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="model-selection" class="section level3" number="12.4.4">
<h3>
<span class="header-section-number">12.4.4</span> Model Selection<a class="anchor" aria-label="anchor" href="#model-selection"><i class="fas fa-link"></i></a>
</h3>
<div id="pols-vs.-re" class="section level4" number="12.4.4.1">
<h4>
<span class="header-section-number">12.4.4.1</span> POLS vs. RE<a class="anchor" aria-label="anchor" href="#pols-vs.-re"><i class="fas fa-link"></i></a>
</h4>
<p>The continuum between RE (used FGLS which more assumption ) and POLS check back on the section of FGLS</p>
<p><strong>Breusch-Pagan LM</strong> test</p>
<ul>
<li>Test for the random effect model based on the OLS residual</li>
<li>Null hypothesis: variances across entities is zero. In another word, no panel effect.</li>
<li>If the test is significant, RE is preferable compared to POLS</li>
</ul>
</div>
<div id="fe-vs.-re" class="section level4" number="12.4.4.2">
<h4>
<span class="header-section-number">12.4.4.2</span> FE vs. RE<a class="anchor" aria-label="anchor" href="#fe-vs.-re"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>RE does not require strict exogeneity for consistency (feedback effect between residual and covariates)</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="31%">
<col width="68%">
</colgroup>
<thead><tr class="header">
<th>Hypothesis</th>
<th>If true</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(H_0: Cov(c_i,\mathbf{x_{it}})=0\)</span></td>
<td>
<span class="math inline">\(\hat{\beta}_{RE}\)</span> is consistent and efficient, while <span class="math inline">\(\hat{\beta}_{FE}\)</span> is consistent</td>
</tr>
<tr class="even">
<td><span class="math inline">\(H_0: Cov(c_i,\mathbf{x_{it}}) \neq 0\)</span></td>
<td>
<span class="math inline">\(\hat{\beta}_{RE}\)</span> is inconsistent, while <span class="math inline">\(\hat{\beta}_{FE}\)</span> is consistent</td>
</tr>
</tbody>
</table></div>
<p><strong>Hausman Test</strong></p>
<p>For the Hausman test to run, you need to assume that</p>
<ul>
<li>strict exogeneity hold</li>
<li>A4 to hold for <span class="math inline">\(u_{it}\)</span>
</li>
</ul>
<p>Then,</p>
<ul>
<li>Hausman test statistic: <span class="math inline">\(H=(\hat{\beta}_{RE}-\hat{\beta}_{FE})'(V(\hat{\beta}_{RE})- V(\hat{\beta}_{FE}))(\hat{\beta}_{RE}-\hat{\beta}_{FE}) \sim \chi_{n(X)}^2\)</span> where <span class="math inline">\(n(X)\)</span> is the number of parameters for the time-varying regressors.</li>
<li>A low p-value means that we would reject the null hypothesis and prefer FE</li>
<li>A high p-value means that we would not reject the null hypothesis and consider RE estimator.</li>
</ul>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">inv</span> <span class="op">~</span> <span class="va">value</span> <span class="op">+</span> <span class="va">capital</span>, data <span class="op">=</span> <span class="va">Grunfeld</span>, model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">inv</span> <span class="op">~</span> <span class="va">value</span> <span class="op">+</span> <span class="va">capital</span>, data <span class="op">=</span> <span class="va">Grunfeld</span>, model <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/phtest.html">phtest</a></span><span class="op">(</span><span class="va">gw</span>, <span class="va">gr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Hausman Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  inv ~ value + capital</span></span>
<span><span class="co">#&gt; chisq = 2.3304, df = 2, p-value = 0.3119</span></span>
<span><span class="co">#&gt; alternative hypothesis: one model is inconsistent</span></span></code></pre></div>
<ul>
<li>Violation Estimator</li>
<li>Basic Estimator</li>
<li>Instrumental variable Estimator</li>
<li>Variable Coefficients estimator</li>
<li>Generalized Method of Moments estimator</li>
<li>General FGLS estimator</li>
<li>Means groups estimator</li>
<li>CCEMG</li>
<li>Estimator for limited dependent variables</li>
</ul>
</div>
</div>
<div id="summary-3" class="section level3" number="12.4.5">
<h3>
<span class="header-section-number">12.4.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-3"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>All three estimators (POLS, RE, FE) require <a href="linear-regression.html#a1-linearity">A1</a>, <a href="linear-regression.html#a2-full-rank">A2</a>, <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> (for individuals) to be consistent. Additionally,</p></li>
<li>
<p>POLS is consistent under A3a(for <span class="math inline">\(u_{it}\)</span>): <span class="math inline">\(E(\mathbf{x}_{it}'u_{it})=0\)</span>, and RE Assumption <span class="math inline">\(E(\mathbf{x}_{it}'c_{i})=0\)</span></p>
<ul>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> does not hold, use cluster robust SE but POLS is not efficient</li>
</ul>
</li>
<li>
<p>RE is consistent under A3a(for <span class="math inline">\(u_{it}\)</span>): <span class="math inline">\(E(\mathbf{x}_{it}'u_{it})=0\)</span>, and RE Assumption <span class="math inline">\(E(\mathbf{x}_{it}'c_{i})=0\)</span></p>
<ul>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> (for <span class="math inline">\(u_{it}\)</span>) holds then usual SE are valid and RE is most efficient</li>
<li>If <a href="linear-regression.html#a4-homoskedasticity">A4</a> (for <span class="math inline">\(u_{it}\)</span>) does not hold, use cluster robust SE ,and RE is no longer most efficient (but still more efficient than POLS)</li>
</ul>
</li>
<li>
<p>FE is consistent under <a href="linear-regression.html#a3-exogeneity-of-independent-variables">A3</a> <span class="math inline">\(E((\mathbf{x}_{it}-\bar{\mathbf{x}}_{it})'(u_{it} -\bar{u}_{it}))=0\)</span></p>
<ul>
<li>Cannot estimate effects of time constant variables</li>
<li>A4 generally does not hold for <span class="math inline">\(u_{it} -\bar{u}_{it}\)</span> so cluster robust SE are needed</li>
</ul>
</li>
</ul>
<p><strong>Note</strong>: <a href="linear-regression.html#a5-data-generation-random-sampling">A5</a> for individual (not for time dimension) implies that you have <a href="linear-regression.html#a5a">A5a</a> for the entire data set.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Estimator / True Model</th>
<th>POLS</th>
<th>RE</th>
<th>FE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>POLS</td>
<td>Consistent</td>
<td>Consistent</td>
<td>Inconsistent</td>
</tr>
<tr class="even">
<td>FE</td>
<td>Consistent</td>
<td>Consistent</td>
<td>Consistent</td>
</tr>
<tr class="odd">
<td>RE</td>
<td>Consistent</td>
<td>Consistent</td>
<td>Inconsistent</td>
</tr>
</tbody>
</table></div>
<p>Based on table provided by <a href="https://sites.google.com/site/econometricsacademy/econometrics-models/panel-data-models">Ani Katchova</a></p>
</div>
<div id="application-8" class="section level3" number="12.4.6">
<h3>
<span class="header-section-number">12.4.6</span> Application<a class="anchor" aria-label="anchor" href="#application-8"><i class="fas fa-link"></i></a>
</h3>
<div id="plm-package" class="section level4" number="12.4.6.1">
<h4>
<span class="header-section-number">12.4.6.1</span> <code>plm</code> package<a class="anchor" aria-label="anchor" href="#plm-package"><i class="fas fa-link"></i></a>
</h4>
<p>Recommended application of <code>plm</code> can be found <a href="https://cran.r-project.org/web/packages/plm/vignettes/B_plmFunction.html">here</a> and <a href="https://cran.r-project.org/web/packages/plm/vignettes/C_plmModelComponents.html">here</a> by Yves Croissant</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("plm")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=plm">"plm"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">foreign</a></span><span class="op">)</span></span>
<span><span class="va">Panel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.dta.html">read.dta</a></span><span class="op">(</span><span class="st">"http://dss.princeton.edu/training/Panel101.dta"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">Panel</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set data as panel data</span></span>
<span><span class="va">pdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pdata.frame.html">pdata.frame</a></span><span class="op">(</span><span class="va">Panel</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pooled OLS estimator</span></span>
<span><span class="va">pooling</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"pooling"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pooling</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Between estimator</span></span>
<span><span class="va">between</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"between"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">between</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First differences estimator</span></span>
<span><span class="va">firstdiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"fd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">firstdiff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fixed effects or within estimator</span></span>
<span><span class="va">fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fixed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random effects estimator</span></span>
<span><span class="va">random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># LM test for random effects versus OLS</span></span>
<span><span class="co"># Accept Null, then OLS, Reject Null then RE</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/plmtest.html">plmtest</a></span><span class="op">(</span><span class="va">pooling</span>, effect <span class="op">=</span> <span class="st">"individual"</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bp"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># other type: "honda", "kw"," "ghm"; other effect : "time" "twoways"</span></span>
<span></span>
<span></span>
<span><span class="co"># B-P/LM and Pesaran CD (cross-sectional dependence) test</span></span>
<span><span class="co"># Breusch and Pagan's original LM statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">fixed</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># Pesaran's CD statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pcdtest.html">pcdtest</a></span><span class="op">(</span><span class="va">fixed</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cd"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Serial Correlation</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pbgtest.html">pbgtest</a></span><span class="op">(</span><span class="va">fixed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># stationary</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"tseries"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html">adf.test</a></span><span class="op">(</span><span class="va">pdata</span><span class="op">$</span><span class="va">y</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># LM test for fixed effects versus OLS</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/pFtest.html">pFtest</a></span><span class="op">(</span><span class="va">fixed</span>, <span class="va">pooling</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hausman test for fixed versus random effects model</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/phtest.html">phtest</a></span><span class="op">(</span><span class="va">random</span>, <span class="va">fixed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Breusch-Pagan heteroskedasticity</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pdata</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If there is presence of heteroskedasticity</span></span>
<span><span class="co">## For RE model</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span> <span class="co">#orginal coef</span></span>
<span></span>
<span><span class="co"># Heteroskedasticity consistent coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">random</span>, <span class="va">vcovHC</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HC0"</span>, <span class="st">"HC1"</span>, <span class="st">"HC2"</span>, <span class="st">"HC3"</span>, <span class="st">"HC4"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">random</span>, type <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#show HC SE of the coef</span></span>
<span><span class="co"># HC0 - heteroskedasticity consistent. The default.</span></span>
<span><span class="co"># HC1,HC2, HC3 – Recommended for small samples. </span></span>
<span><span class="co"># HC3 gives less weight to influential observations.</span></span>
<span><span class="co"># HC4 - small samples with influential observations</span></span>
<span><span class="co"># HAC - heteroskedasticity and autocorrelation consistent</span></span>
<span></span>
<span><span class="co">## For FE model</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">fixed</span><span class="op">)</span> <span class="co"># Original coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">fixed</span>, <span class="va">vcovHC</span><span class="op">)</span> <span class="co"># Heteroskedasticity consistent coefficients</span></span>
<span></span>
<span><span class="co"># Heteroskedasticity consistent coefficients (Arellano)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html">coeftest</a></span><span class="op">(</span><span class="va">fixed</span>, <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">fixed</span>, method <span class="op">=</span> <span class="st">"arellano"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HC0"</span>, <span class="st">"HC1"</span>, <span class="st">"HC2"</span>, <span class="st">"HC3"</span>, <span class="st">"HC4"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">fixed</span>, type <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#show HC SE of the coef</span></span></code></pre></div>
<p><strong>Advanced</strong></p>
<p>Other methods to estimate the random model:</p>
<ul>
<li>
<code>"swar"</code>: <em>default</em> <span class="citation">(<a href="references.html#ref-swamy1972exact">Swamy and Arora 1972</a>)</span>
</li>
<li>
<code>"walhus"</code>: <span class="citation">(<a href="references.html#ref-wallace1969use">Wallace and Hussain 1969</a>)</span>
</li>
<li>
<code>"amemiya"</code>: <span class="citation">(<a href="references.html#ref-amemiya1971estimation">Amemiya 1971</a>)</span>
</li>
<li>
<code>"nerlove"</code>” <span class="citation">(<a href="references.html#ref-nerlove1971further">Nerlove 1971</a>)</span>
</li>
</ul>
<p>Other effects:</p>
<ul>
<li>Individual effects: <em>default</em>
</li>
<li>Time effects: <code>"time"</code>
</li>
<li>Individual and time effects: <code>"twoways"</code>
</li>
</ul>
<p><strong>Note</strong>: no random two-ways effect model for <code>random.method = "nerlove"</code></p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">amemiya</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span></span>
<span>        <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>        data <span class="op">=</span> <span class="va">pdata</span>,</span>
<span>        model <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>        random.method <span class="op">=</span> <span class="st">"amemiya"</span>,</span>
<span>        effect <span class="op">=</span> <span class="st">"twoways"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>To call the estimation of the variance of the error components</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/ercomp.html">ercomp</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>,</span>
<span>       data <span class="op">=</span> <span class="va">pdata</span>,</span>
<span>       method <span class="op">=</span> <span class="st">"amemiya"</span>,</span>
<span>       effect <span class="op">=</span> <span class="st">"twoways"</span><span class="op">)</span></span></code></pre></div>
<p>Check for the unbalancedness. Closer to 1 indicates balanced data <span class="citation">(<a href="references.html#ref-ahrens1981two">Ahrens and Pincus 1981</a>)</span></p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/plm/man/punbalancedness.html">punbalancedness</a></span><span class="op">(</span><span class="va">random</span><span class="op">)</span></span></code></pre></div>
<p><strong>Instrumental variable</strong></p>
<ul>
<li>
<code>"bvk"</code>: default <span class="citation">(<a href="references.html#ref-balestra1987full">Balestra and Varadharajan-Krishnakumar 1987</a>)</span>
</li>
<li>
<code>"baltagi"</code>: <span class="citation">(<a href="references.html#ref-baltagi1981simultaneous">Baltagi 1981</a>)</span>
</li>
<li>
<code>"am"</code> <span class="citation">(<a href="references.html#ref-amemiya1986instrumental">Amemiya and MaCurdy 1986</a>)</span>
</li>
<li>
<code>"bms"</code>: <span class="citation">(<a href="references.html#ref-breusch1989efficient">Breusch, Mizon, and Schmidt 1989</a>)</span>
</li>
</ul>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">instr</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plm/man/plm.html">plm</a></span><span class="op">(</span></span>
<span>        <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">X_ins</span>,</span>
<span>        data <span class="op">=</span> <span class="va">pdata</span>,</span>
<span>        random.method <span class="op">=</span> <span class="st">"ht"</span>,</span>
<span>        model <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>        inst.method <span class="op">=</span> <span class="st">"baltagi"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div id="other-estimators" class="section level5" number="12.4.6.1.1">
<h5>
<span class="header-section-number">12.4.6.1.1</span> Other Estimators<a class="anchor" aria-label="anchor" href="#other-estimators"><i class="fas fa-link"></i></a>
</h5>
<div id="variable-coefficients-model" class="section level6" number="12.4.6.1.1.1">
<h6>
<span class="header-section-number">12.4.6.1.1.1</span> Variable Coefficients Model<a class="anchor" aria-label="anchor" href="#variable-coefficients-model"><i class="fas fa-link"></i></a>
</h6>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixed_pvcm</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pvcm.html">pvcm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="va">random_pvcm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pvcm.html">pvcm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, data <span class="op">=</span> <span class="va">pdata</span>, model <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code></pre></div>
<p>More details can be found <a href="https://cran.r-project.org/web/packages/plm/vignettes/plmPackage.html">here</a></p>
</div>
<div id="generalized-method-of-moments-estimator" class="section level6" number="12.4.6.1.1.2">
<h6>
<span class="header-section-number">12.4.6.1.1.2</span> Generalized Method of Moments Estimator<a class="anchor" aria-label="anchor" href="#generalized-method-of-moments-estimator"><i class="fas fa-link"></i></a>
</h6>
<p>Typically use in dynamic models. Example is from <a href="https://cran.r-project.org/web/packages/plm/vignettes/plmPackage.html">plm package</a></p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pgmm.html">pgmm</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">capital</span><span class="op">)</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">capital</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">EmplUK</span>,</span>
<span>    effect <span class="op">=</span> <span class="st">"twoways"</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"onestep"</span>,</span>
<span>    transformation <span class="op">=</span> <span class="st">"ld"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">z2</span>, robust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="general-feasible-generalized-least-squares-models" class="section level6" number="12.4.6.1.1.3">
<h6>
<span class="header-section-number">12.4.6.1.1.3</span> General Feasible Generalized Least Squares Models<a class="anchor" aria-label="anchor" href="#general-feasible-generalized-least-squares-models"><i class="fas fa-link"></i></a>
</h6>
<p>Assume there is no cross-sectional correlation Robust against intragroup heteroskedasticity and serial correlation. Suited when n is much larger than T (long panel) However, inefficient under group-wise heteorskedasticity.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random Effects</span></span>
<span><span class="va">zz</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pggls.html">pggls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">capital</span><span class="op">)</span>,</span>
<span>          data <span class="op">=</span> <span class="va">EmplUK</span>,</span>
<span>          model <span class="op">=</span> <span class="st">"pooling"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fixed</span></span>
<span><span class="va">zz</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/plm/man/pggls.html">pggls</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">emp</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">capital</span><span class="op">)</span>,</span>
<span>          data <span class="op">=</span> <span class="va">EmplUK</span>,</span>
<span>          model <span class="op">=</span> <span class="st">"within"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="fixest-package" class="section level4" number="12.4.6.2">
<h4>
<span class="header-section-number">12.4.6.2</span> <code>fixest</code> package<a class="anchor" aria-label="anchor" href="#fixest-package"><i class="fas fa-link"></i></a>
</h4>
<p>Available functions</p>
<ul>
<li><p><code>feols</code>: linear models</p></li>
<li><p><code>feglm</code>: generalized linear models</p></li>
<li><p><code>femlm</code>: maximum likelihood estimation</p></li>
<li><p><code>feNmlm</code>: non-linear in RHS parameters</p></li>
<li><p><code>fepois</code>: Poisson fixed-effect</p></li>
<li><p><code>fenegbin</code>: negative binomial fixed-effect</p></li>
</ul>
<p>Notes</p>
<ul>
<li>can only work for <code>fixest</code> object</li>
</ul>
<p>Examples by the package’s <a href="https://cran.r-project.org/web/packages/fixest/vignettes/exporting_tables.html">authors</a></p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setting a dictionary</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/setFixest_dict.html">setFixest_dict</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        Ozone   <span class="op">=</span> <span class="st">"Ozone (ppb)"</span>,</span>
<span>        Solar.R <span class="op">=</span> <span class="st">"Solar Radiation (Langleys)"</span>,</span>
<span>        Wind    <span class="op">=</span> <span class="st">"Wind Speed (mph)"</span>,</span>
<span>        Temp    <span class="op">=</span> <span class="st">"Temperature"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># On multiple estimations: see the dedicated vignette</span></span>
<span><span class="va">est</span> <span class="op">=</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>    <span class="va">Ozone</span> <span class="op">~</span> <span class="va">Solar.R</span> <span class="op">+</span> <span class="fu">sw0</span><span class="op">(</span><span class="va">Wind</span> <span class="op">+</span> <span class="va">Temp</span><span class="op">)</span> <span class="op">|</span> <span class="fu">csw</span><span class="op">(</span><span class="va">Month</span>, <span class="va">Day</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">airquality</span>,</span>
<span>    cluster <span class="op">=</span> <span class="op">~</span> <span class="va">Day</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                         est.1              est.2</span></span>
<span><span class="co">#&gt; Dependent Var.:                   Ozone (ppb)        Ozone (ppb)</span></span>
<span><span class="co">#&gt;                                                                 </span></span>
<span><span class="co">#&gt; Solar Radiation (Langleys) 0.1148*** (0.0234)   0.0522* (0.0202)</span></span>
<span><span class="co">#&gt; Wind Speed (mph)                              -3.109*** (0.7986)</span></span>
<span><span class="co">#&gt; Temperature                                    1.875*** (0.3671)</span></span>
<span><span class="co">#&gt; Fixed-Effects:             ------------------ ------------------</span></span>
<span><span class="co">#&gt; Month                                     Yes                Yes</span></span>
<span><span class="co">#&gt; Day                                        No                 No</span></span>
<span><span class="co">#&gt; __________________________ __________________ __________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                       by: Day            by: Day</span></span>
<span><span class="co">#&gt; Observations                              111                111</span></span>
<span><span class="co">#&gt; R2                                    0.31974            0.63686</span></span>
<span><span class="co">#&gt; Within R2                             0.12245            0.53154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                        est.3              est.4</span></span>
<span><span class="co">#&gt; Dependent Var.:                  Ozone (ppb)        Ozone (ppb)</span></span>
<span><span class="co">#&gt;                                                                </span></span>
<span><span class="co">#&gt; Solar Radiation (Langleys) 0.1078** (0.0329)   0.0509* (0.0236)</span></span>
<span><span class="co">#&gt; Wind Speed (mph)                             -3.289*** (0.7777)</span></span>
<span><span class="co">#&gt; Temperature                                   2.052*** (0.2415)</span></span>
<span><span class="co">#&gt; Fixed-Effects:             ----------------- ------------------</span></span>
<span><span class="co">#&gt; Month                                    Yes                Yes</span></span>
<span><span class="co">#&gt; Day                                      Yes                Yes</span></span>
<span><span class="co">#&gt; __________________________ _________________ __________________</span></span>
<span><span class="co">#&gt; S.E.: Clustered                      by: Day            by: Day</span></span>
<span><span class="co">#&gt; Observations                             111                111</span></span>
<span><span class="co">#&gt; R2                                   0.58018            0.81604</span></span>
<span><span class="co">#&gt; Within R2                            0.12074            0.61471</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="co"># in latex</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="va">est</span>, tex <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; \begingroup</span></span>
<span><span class="co">#&gt; \centering</span></span>
<span><span class="co">#&gt; \begin{tabular}{lcccc}</span></span>
<span><span class="co">#&gt;    \tabularnewline \midrule \midrule</span></span>
<span><span class="co">#&gt;    Dependent Variable: &amp; \multicolumn{4}{c}{Ozone (ppb)}\\</span></span>
<span><span class="co">#&gt;    Model:                     &amp; (1)            &amp; (2)            &amp; (3)            &amp; (4)\\  </span></span>
<span><span class="co">#&gt;    \midrule</span></span>
<span><span class="co">#&gt;    \emph{Variables}\\</span></span>
<span><span class="co">#&gt;    Solar Radiation (Langleys) &amp; 0.1148$^{***}$ &amp; 0.0522$^{**}$  &amp; 0.1078$^{***}$ &amp; 0.0509$^{**}$\\   </span></span>
<span><span class="co">#&gt;                               &amp; (0.0234)       &amp; (0.0202)       &amp; (0.0329)       &amp; (0.0236)\\   </span></span>
<span><span class="co">#&gt;    Wind Speed (mph)           &amp;                &amp; -3.109$^{***}$ &amp;                &amp; -3.289$^{***}$\\   </span></span>
<span><span class="co">#&gt;                               &amp;                &amp; (0.7986)       &amp;                &amp; (0.7777)\\   </span></span>
<span><span class="co">#&gt;    Temperature                &amp;                &amp; 1.875$^{***}$  &amp;                &amp; 2.052$^{***}$\\   </span></span>
<span><span class="co">#&gt;                               &amp;                &amp; (0.3671)       &amp;                &amp; (0.2415)\\   </span></span>
<span><span class="co">#&gt;    \midrule</span></span>
<span><span class="co">#&gt;    \emph{Fixed-effects}\\</span></span>
<span><span class="co">#&gt;    Month                      &amp; Yes            &amp; Yes            &amp; Yes            &amp; Yes\\  </span></span>
<span><span class="co">#&gt;    Day                        &amp;                &amp;                &amp; Yes            &amp; Yes\\  </span></span>
<span><span class="co">#&gt;    \midrule</span></span>
<span><span class="co">#&gt;    \emph{Fit statistics}\\</span></span>
<span><span class="co">#&gt;    Observations               &amp; 111            &amp; 111            &amp; 111            &amp; 111\\  </span></span>
<span><span class="co">#&gt;    R$^2$                      &amp; 0.31974        &amp; 0.63686        &amp; 0.58018        &amp; 0.81604\\  </span></span>
<span><span class="co">#&gt;    Within R$^2$               &amp; 0.12245        &amp; 0.53154        &amp; 0.12074        &amp; 0.61471\\  </span></span>
<span><span class="co">#&gt;    \midrule \midrule</span></span>
<span><span class="co">#&gt;    \multicolumn{5}{l}{\emph{Clustered (Day) standard-errors in parentheses}}\\</span></span>
<span><span class="co">#&gt;    \multicolumn{5}{l}{\emph{Signif. Codes: ***: 0.01, **: 0.05, *: 0.1}}\\</span></span>
<span><span class="co">#&gt; \end{tabular}</span></span>
<span><span class="co">#&gt; \par\endgroup</span></span>
<span></span>
<span></span>
<span><span class="co"># get the fixed-effects coefficients for 1 model</span></span>
<span><span class="va">fixedEffects</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html">fixef</a></span><span class="op">(</span><span class="va">est</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fixedEffects</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fixed_effects coefficients</span></span>
<span><span class="co">#&gt; Number of fixed-effects for variable Month is 5.</span></span>
<span><span class="co">#&gt;  Mean = 19.6 Variance = 272</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; COEFFICIENTS:</span></span>
<span><span class="co">#&gt;   Month:     5     6     7     8     9</span></span>
<span><span class="co">#&gt;          3.219 8.288 34.26 40.12 12.13</span></span>
<span></span>
<span><span class="co"># see the fixed effects for one dimension</span></span>
<span><span class="va">fixedEffects</span><span class="op">$</span><span class="va">Month</span></span>
<span><span class="co">#&gt;         5         6         7         8         9 </span></span>
<span><span class="co">#&gt;  3.218876  8.287899 34.260812 40.122257 12.130971</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fixedEffects</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="12-data_files/figure-html/unnamed-chunk-24-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>For <a href="https://cran.r-project.org/web/packages/fixest/vignettes/multiple_estimations.html">multiple estimation</a></p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set up</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/">fixest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># let R know the base dataset (the biggest/ultimate </span></span>
<span><span class="co"># dataset that includes everything in your analysis)</span></span>
<span><span class="va">base</span> <span class="op">=</span> <span class="va">iris</span></span>
<span></span>
<span><span class="co"># rename variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"species"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_multi</span> <span class="op">=</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="fu">csw</span><span class="op">(</span><span class="va">x2</span>, <span class="va">x2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|</span></span>
<span>        <span class="fu">sw0</span><span class="op">(</span><span class="va">species</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">base</span>,</span>
<span>    fsplit <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>    lean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    vcov <span class="op">=</span> <span class="st">"hc1"</span> <span class="co"># can also clustered at the fixed effect level</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># it's recommended to use vcov at </span></span>
<span><span class="co"># estimation stage, not summary stage</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res_multi</span>, <span class="st">"compact"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         sample   fixef lhs               rhs     (Intercept)                x1</span></span>
<span><span class="co">#&gt; 1  Full sample 1        y1 x1 + x2           4.19*** (0.104)  0.542*** (0.076)</span></span>
<span><span class="co">#&gt; 2  Full sample 1        y1 x1 + x2 + I(x2^2) 4.27*** (0.101)  0.719*** (0.082)</span></span>
<span><span class="co">#&gt; 3  Full sample 1        y2 x1 + x2           3.59*** (0.103) -0.257*** (0.066)</span></span>
<span><span class="co">#&gt; 4  Full sample 1        y2 x1 + x2 + I(x2^2) 3.68*** (0.097)    -0.030 (0.078)</span></span>
<span><span class="co">#&gt; 5  Full sample species  y1 x1 + x2                            0.906*** (0.076)</span></span>
<span><span class="co">#&gt; 6  Full sample species  y1 x1 + x2 + I(x2^2)                  0.900*** (0.077)</span></span>
<span><span class="co">#&gt; 7  Full sample species  y2 x1 + x2                              0.155* (0.073)</span></span>
<span><span class="co">#&gt; 8  Full sample species  y2 x1 + x2 + I(x2^2)                    0.148. (0.075)</span></span>
<span><span class="co">#&gt; 9  setosa      1        y1 x1 + x2           4.25*** (0.474)     0.399 (0.325)</span></span>
<span><span class="co">#&gt; 10 setosa      1        y1 x1 + x2 + I(x2^2) 4.00*** (0.504)     0.405 (0.325)</span></span>
<span><span class="co">#&gt; 11 setosa      1        y2 x1 + x2           2.89*** (0.416)     0.247 (0.305)</span></span>
<span><span class="co">#&gt; 12 setosa      1        y2 x1 + x2 + I(x2^2) 2.82*** (0.423)     0.248 (0.304)</span></span>
<span><span class="co">#&gt; 13 setosa      species  y1 x1 + x2                               0.399 (0.325)</span></span>
<span><span class="co">#&gt; 14 setosa      species  y1 x1 + x2 + I(x2^2)                     0.405 (0.325)</span></span>
<span><span class="co">#&gt; 15 setosa      species  y2 x1 + x2                               0.247 (0.305)</span></span>
<span><span class="co">#&gt; 16 setosa      species  y2 x1 + x2 + I(x2^2)                     0.248 (0.304)</span></span>
<span><span class="co">#&gt; 17 versicolor  1        y1 x1 + x2           2.38*** (0.423)  0.934*** (0.166)</span></span>
<span><span class="co">#&gt; 18 versicolor  1        y1 x1 + x2 + I(x2^2)   0.323 (1.44)   0.901*** (0.164)</span></span>
<span><span class="co">#&gt; 19 versicolor  1        y2 x1 + x2           1.25*** (0.275)     0.067 (0.095)</span></span>
<span><span class="co">#&gt; 20 versicolor  1        y2 x1 + x2 + I(x2^2)   0.097 (1.01)      0.048 (0.099)</span></span>
<span><span class="co">#&gt; 21 versicolor  species  y1 x1 + x2                            0.934*** (0.166)</span></span>
<span><span class="co">#&gt; 22 versicolor  species  y1 x1 + x2 + I(x2^2)                  0.901*** (0.164)</span></span>
<span><span class="co">#&gt; 23 versicolor  species  y2 x1 + x2                               0.067 (0.095)</span></span>
<span><span class="co">#&gt; 24 versicolor  species  y2 x1 + x2 + I(x2^2)                     0.048 (0.099)</span></span>
<span><span class="co">#&gt; 25 virginica   1        y1 x1 + x2             1.05. (0.539)  0.995*** (0.090)</span></span>
<span><span class="co">#&gt; 26 virginica   1        y1 x1 + x2 + I(x2^2)   -2.39 (2.04)   0.994*** (0.088)</span></span>
<span><span class="co">#&gt; 27 virginica   1        y2 x1 + x2             1.06. (0.572)     0.149 (0.107)</span></span>
<span><span class="co">#&gt; 28 virginica   1        y2 x1 + x2 + I(x2^2)    1.10 (1.76)      0.149 (0.108)</span></span>
<span><span class="co">#&gt; 29 virginica   species  y1 x1 + x2                            0.995*** (0.090)</span></span>
<span><span class="co">#&gt; 30 virginica   species  y1 x1 + x2 + I(x2^2)                  0.994*** (0.088)</span></span>
<span><span class="co">#&gt; 31 virginica   species  y2 x1 + x2                               0.149 (0.107)</span></span>
<span><span class="co">#&gt; 32 virginica   species  y2 x1 + x2 + I(x2^2)                     0.149 (0.108)</span></span>
<span><span class="co">#&gt;                  x2          I(x2^2)</span></span>
<span><span class="co">#&gt; 1   -0.320. (0.170)                 </span></span>
<span><span class="co">#&gt; 2  -1.52*** (0.307) 0.348*** (0.075)</span></span>
<span><span class="co">#&gt; 3    0.364* (0.142)                 </span></span>
<span><span class="co">#&gt; 4  -1.18*** (0.313) 0.446*** (0.074)</span></span>
<span><span class="co">#&gt; 5    -0.006 (0.163)                 </span></span>
<span><span class="co">#&gt; 6     0.290 (0.408)   -0.088 (0.117)</span></span>
<span><span class="co">#&gt; 7  0.623*** (0.114)                 </span></span>
<span><span class="co">#&gt; 8    0.951* (0.472)   -0.097 (0.125)</span></span>
<span><span class="co">#&gt; 9    0.712. (0.418)                 </span></span>
<span><span class="co">#&gt; 10    2.51. (1.47)     -2.91 (2.10) </span></span>
<span><span class="co">#&gt; 11    0.702 (0.560)                 </span></span>
<span><span class="co">#&gt; 12     1.27 (2.39)    -0.911 (3.28) </span></span>
<span><span class="co">#&gt; 13   0.712. (0.418)                 </span></span>
<span><span class="co">#&gt; 14    2.51. (1.47)     -2.91 (2.10) </span></span>
<span><span class="co">#&gt; 15    0.702 (0.560)                 </span></span>
<span><span class="co">#&gt; 16     1.27 (2.39)    -0.911 (3.28) </span></span>
<span><span class="co">#&gt; 17   -0.320 (0.364)                 </span></span>
<span><span class="co">#&gt; 18     3.01 (2.31)     -1.24 (0.841)</span></span>
<span><span class="co">#&gt; 19 0.929*** (0.244)                 </span></span>
<span><span class="co">#&gt; 20    2.80. (1.65)    -0.695 (0.583)</span></span>
<span><span class="co">#&gt; 21   -0.320 (0.364)                 </span></span>
<span><span class="co">#&gt; 22     3.01 (2.31)     -1.24 (0.841)</span></span>
<span><span class="co">#&gt; 23 0.929*** (0.244)                 </span></span>
<span><span class="co">#&gt; 24    2.80. (1.65)    -0.695 (0.583)</span></span>
<span><span class="co">#&gt; 25    0.007 (0.205)                 </span></span>
<span><span class="co">#&gt; 26    3.50. (2.09)    -0.870 (0.519)</span></span>
<span><span class="co">#&gt; 27 0.535*** (0.122)                 </span></span>
<span><span class="co">#&gt; 28    0.503 (1.56)     0.008 (0.388)</span></span>
<span><span class="co">#&gt; 29    0.007 (0.205)                 </span></span>
<span><span class="co">#&gt; 30    3.50. (2.09)    -0.870 (0.519)</span></span>
<span><span class="co">#&gt; 31 0.535*** (0.122)                 </span></span>
<span><span class="co">#&gt; 32    0.503 (1.56)     0.008 (0.388)</span></span>
<span></span>
<span><span class="co"># call the first 3 estimated models only</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="va">res_multi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>       </span>
<span>       <span class="co"># customize the headers</span></span>
<span>       headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mod1"</span>, <span class="st">"mod2"</span>, <span class="st">"mod3"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt;                   res_multi[1:3].1   res_multi[1:3].2    res_multi[1:3].3</span></span>
<span><span class="co">#&gt;                               mod1               mod2                mod3</span></span>
<span><span class="co">#&gt; Dependent Var.:                 y1                 y1                  y2</span></span>
<span><span class="co">#&gt;                                                                          </span></span>
<span><span class="co">#&gt; Constant         4.191*** (0.1037)  4.266*** (0.1007)   3.587*** (0.1031)</span></span>
<span><span class="co">#&gt; x1              0.5418*** (0.0761) 0.7189*** (0.0815) -0.2571*** (0.0664)</span></span>
<span><span class="co">#&gt; x2               -0.3196. (0.1700) -1.522*** (0.3072)    0.3640* (0.1419)</span></span>
<span><span class="co">#&gt; x2 square                          0.3479*** (0.0748)                    </span></span>
<span><span class="co">#&gt; _______________ __________________ __________________ ___________________</span></span>
<span><span class="co">#&gt; S.E. type       Heteroskedas.-rob. Heteroskedas.-rob. Heteroskedast.-rob.</span></span>
<span><span class="co">#&gt; Observations                   150                150                 150</span></span>
<span><span class="co">#&gt; R2                         0.76626            0.79456             0.21310</span></span>
<span><span class="co">#&gt; Adj. R2                    0.76308            0.79034             0.20240</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div id="multiple-estimation-left-hand-side" class="section level5" number="12.4.6.2.1">
<h5>
<span class="header-section-number">12.4.6.2.1</span> Multiple estimation (Left-hand side)<a class="anchor" aria-label="anchor" href="#multiple-estimation-left-hand-side"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li>When you have multiple interested dependent variables</li>
</ul>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">y1</span>, <span class="va">y2</span><span class="op">)</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, <span class="va">base</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 feols(c(y1, y2)..1 feols(c(y1, y2) ..2</span></span>
<span><span class="co">#&gt; Dependent Var.:                 y1                  y2</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt; Constant         4.191*** (0.0970)   3.587*** (0.0937)</span></span>
<span><span class="co">#&gt; x1              0.5418*** (0.0693) -0.2571*** (0.0669)</span></span>
<span><span class="co">#&gt; x2               -0.3196* (0.1605)    0.3640* (0.1550)</span></span>
<span><span class="co">#&gt; _______________ __________________ ___________________</span></span>
<span><span class="co">#&gt; S.E. type                      IID                 IID</span></span>
<span><span class="co">#&gt; Observations                   150                 150</span></span>
<span><span class="co">#&gt; R2                         0.76626             0.21310</span></span>
<span><span class="co">#&gt; Adj. R2                    0.76308             0.20240</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>To input a list of dependent variable</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">depvars</span>, <span class="kw">function</span><span class="op">(</span><span class="va">var</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/xpd.html">xpd</a></span><span class="op">(</span><span class="va">..lhs</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, ..lhs <span class="op">=</span> <span class="va">var</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">base</span><span class="op">)</span></span>
<span>    <span class="co"># summary(res)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt;                            model 1             model 2</span></span>
<span><span class="co">#&gt; Dependent Var.:                 y1                  y2</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt; Constant         4.191*** (0.0970)   3.587*** (0.0937)</span></span>
<span><span class="co">#&gt; x1              0.5418*** (0.0693) -0.2571*** (0.0669)</span></span>
<span><span class="co">#&gt; x2               -0.3196* (0.1605)    0.3640* (0.1550)</span></span>
<span><span class="co">#&gt; _______________ __________________ ___________________</span></span>
<span><span class="co">#&gt; S.E. type                      IID                 IID</span></span>
<span><span class="co">#&gt; Observations                   150                 150</span></span>
<span><span class="co">#&gt; R2                         0.76626             0.21310</span></span>
<span><span class="co">#&gt; Adj. R2                    0.76308             0.20240</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div id="multiple-estimation-right-hand-side" class="section level5" number="12.4.6.2.2">
<h5>
<span class="header-section-number">12.4.6.2.2</span> Multiple estimation (Right-hand side)<a class="anchor" aria-label="anchor" href="#multiple-estimation-right-hand-side"><i class="fas fa-link"></i></a>
</h5>
<p>Options to write the functions</p>
<ul>
<li>
<p><code>sw</code> (stepwise): sequentially analyze each elements</p>
<ul>
<li>
<code>y ~ sw(x1, x2)</code> will be estimated as <code>y ~ x1</code> and <code>y ~ x2</code>
</li>
</ul>
</li>
<li>
<p><code>sw0</code> (stepwise 0): similar to <code>sw</code> but also estimate a model without the elements in the set first</p>
<ul>
<li>
<code>y ~ sw(x1, x2)</code> will be estimated as <code>y ~ 1</code> and <code>y ~ x1</code> and <code>y ~ x2</code>
</li>
</ul>
</li>
<li>
<p><code>csw</code> (cumulative stepwise): sequentially add each element of the set to the formula</p>
<ul>
<li>
<code>y ~ csw(x1, x2)</code> will be estimated as <code>y ~ x1</code> and <code>y ~ x1 + x2</code>
</li>
</ul>
</li>
<li>
<p><code>csw0</code> (cumulative stepwise 0): similar to <code>csw</code> but also estimate a model without the elements in the set first</p>
<ul>
<li>
<code>y ~ csw(x1, x2)</code> will be estimated as <code>y~ 1</code> <code>y ~ x1</code> and <code>y ~ x1 + x2</code>
</li>
</ul>
</li>
<li>
<p><code>mvsw</code> (multiverse stepwise): all possible combination of the elements in the set (it will get large very quick).</p>
<ul>
<li>
<code>mvsw(x1, x2, x3)</code> will be <code>sw0(x1, x2, x3, x1 + x2, x1 + x3, x2 + x3, x1 + x2 + x3)</code>
</li>
</ul>
</li>
</ul>
</div>
<div id="split-sample-estimation" class="section level5" number="12.4.6.2.3">
<h5>
<span class="header-section-number">12.4.6.2.3</span> Split sample estimation<a class="anchor" aria-label="anchor" href="#split-sample-estimation"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/etable.html">etable</a></span><span class="op">(</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html">feols</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, fsplit <span class="op">=</span> <span class="op">~</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">base</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  feols(y1 ~ x1 +..1 feols(y1 ~ x1 ..2 feols(y1 ~ x1 +..3</span></span>
<span><span class="co">#&gt; Sample (species)        Full sample            setosa         versicolor</span></span>
<span><span class="co">#&gt; Dependent Var.:                  y1                y1                 y1</span></span>
<span><span class="co">#&gt;                                                                         </span></span>
<span><span class="co">#&gt; Constant          4.191*** (0.0970) 4.248*** (0.4114)  2.381*** (0.4493)</span></span>
<span><span class="co">#&gt; x1               0.5418*** (0.0693)   0.3990 (0.2958) 0.9342*** (0.1693)</span></span>
<span><span class="co">#&gt; x2                -0.3196* (0.1605)   0.7121 (0.4874)   -0.3200 (0.4024)</span></span>
<span><span class="co">#&gt; ________________ __________________ _________________ __________________</span></span>
<span><span class="co">#&gt; S.E. type                       IID               IID                IID</span></span>
<span><span class="co">#&gt; Observations                    150                50                 50</span></span>
<span><span class="co">#&gt; R2                          0.76626           0.11173            0.57432</span></span>
<span><span class="co">#&gt; Adj. R2                     0.76308           0.07393            0.55620</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                  feols(y1 ~ x1 +..4</span></span>
<span><span class="co">#&gt; Sample (species)          virginica</span></span>
<span><span class="co">#&gt; Dependent Var.:                  y1</span></span>
<span><span class="co">#&gt;                                    </span></span>
<span><span class="co">#&gt; Constant            1.052* (0.5139)</span></span>
<span><span class="co">#&gt; x1               0.9946*** (0.0893)</span></span>
<span><span class="co">#&gt; x2                  0.0071 (0.1795)</span></span>
<span><span class="co">#&gt; ________________ __________________</span></span>
<span><span class="co">#&gt; S.E. type                       IID</span></span>
<span><span class="co">#&gt; Observations                     50</span></span>
<span><span class="co">#&gt; R2                          0.74689</span></span>
<span><span class="co">#&gt; Adj. R2                     0.73612</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div id="standard-errors-1" class="section level5" number="12.4.6.2.4">
<h5>
<span class="header-section-number">12.4.6.2.4</span> Standard Errors<a class="anchor" aria-label="anchor" href="#standard-errors-1"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li><p><code>iid</code>: errors are homoskedastic and independent and identically distributed</p></li>
<li><p><code>hetero</code>: errors are heteroskedastic using White correction</p></li>
<li><p><code>cluster</code>: errors are correlated within the cluster groups</p></li>
<li>
<p><code>newey_west</code>: <span class="citation">(<a href="references.html#ref-newey1986simple">Newey and West 1986</a>)</span> use for time series or panel data. Errors are heteroskedastic and serially correlated.</p>
<ul>
<li><p><code>vcov = newey_west ~ id + period</code> where <code>id</code> is the subject id and <code>period</code> is time period of the panel.</p></li>
<li><p>to specify lag period to consider <code>vcov = newey_west(2) ~ id + period</code> where we’re considering 2 lag periods.</p></li>
</ul>
</li>
<li>
<p><code>driscoll_kraay</code> <span class="citation">(<a href="references.html#ref-driscoll1998consistent">Driscoll and Kraay 1998</a>)</span> use for panel data. Errors are cross-sectionally and serially correlated.</p>
<ul>
<li><code>vcov = discoll_kraay ~ period</code></li>
</ul>
</li>
<li>
<p><code>conley</code>: <span class="citation">(<a href="references.html#ref-conley1999gmm">Conley 1999</a>)</span> for cross-section data. Errors are spatially correlated</p>
<ul>
<li><p><code>vcov = conley ~ latitude + longitude</code></p></li>
<li><p>to specify the distance cutoff, <code>vcov = vcov_conley(lat = "lat", lon = "long", cutoff = 100, distance = "spherical")</code>, which will use the <code><a href="https://lrberge.github.io/fixest/reference/vcov_conley.html">conley()</a></code> helper function.</p></li>
</ul>
</li>
<li>
<p><code>hc</code>: from the <code>sandwich</code> package</p>
<ul>
<li><code>vcov = function(x) sandwich::vcovHC(x, type = "HC1"))</code></li>
</ul>
</li>
</ul>
<p>To let R know which SE estimation you want to use, insert <code>vcov = vcov_type ~ variables</code></p>
</div>
<div id="small-sample-correction" class="section level5" number="12.4.6.2.5">
<h5>
<span class="header-section-number">12.4.6.2.5</span> Small sample correction<a class="anchor" aria-label="anchor" href="#small-sample-correction"><i class="fas fa-link"></i></a>
</h5>
<p>To specify that R needs to use small sample correction add</p>
<p><code>ssc = ssc(adj = T, cluster.adj = T)</code></p>

</div>
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="imputation-missing-data.html"><span class="header-section-number">11</span> Imputation (Missing Data)</a></div>
<div class="next"><a href="variable-transformation.html"><span class="header-section-number">13</span> Variable Transformation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#data"><span class="header-section-number">12</span> Data</a></li>
<li><a class="nav-link" href="#cross-sectional"><span class="header-section-number">12.1</span> Cross-Sectional</a></li>
<li>
<a class="nav-link" href="#time-series-1"><span class="header-section-number">12.2</span> Time Series</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#deterministic-time-trend"><span class="header-section-number">12.2.1</span> Deterministic Time trend</a></li>
<li><a class="nav-link" href="#feedback-effect"><span class="header-section-number">12.2.2</span> Feedback Effect</a></li>
<li><a class="nav-link" href="#dynamic-specification"><span class="header-section-number">12.2.3</span> Dynamic Specification</a></li>
<li><a class="nav-link" href="#dynamically-complete"><span class="header-section-number">12.2.4</span> Dynamically Complete</a></li>
<li><a class="nav-link" href="#highly-persistent-data"><span class="header-section-number">12.2.5</span> Highly Persistent Data</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#repeated-cross-sections"><span class="header-section-number">12.3</span> Repeated Cross Sections</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#pooled-cross-section"><span class="header-section-number">12.3.1</span> Pooled Cross Section</a></li></ul>
</li>
<li>
<a class="nav-link" href="#panel-data"><span class="header-section-number">12.4</span> Panel Data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pooled-ols-estimator"><span class="header-section-number">12.4.1</span> Pooled OLS Estimator</a></li>
<li><a class="nav-link" href="#individual-specific-effects-model"><span class="header-section-number">12.4.2</span> Individual-specific effects model</a></li>
<li><a class="nav-link" href="#tests-for-assumptions"><span class="header-section-number">12.4.3</span> Tests for Assumptions</a></li>
<li><a class="nav-link" href="#model-selection"><span class="header-section-number">12.4.4</span> Model Selection</a></li>
<li><a class="nav-link" href="#summary-3"><span class="header-section-number">12.4.5</span> Summary</a></li>
<li><a class="nav-link" href="#application-8"><span class="header-section-number">12.4.6</span> Application</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/12-data.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/12-data.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2023-08-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
