<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 Non-linear Least Squares | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 Non-linear Least Squares | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Non-linear Least Squares | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2024-12-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="inference-1.html"/>
<link rel="next" href="generalized-linear-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="more-books.html"><a href="more-books.html"><i class="fa fa-check"></i>More books</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function-mgf"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function (MGF)</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.6</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#law-of-iterated-expectation"><i class="fa fa-check"></i><b>2.3.5</b> Law of Iterated Expectation</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.6</b> Convergence</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.7</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.8" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.8</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.1</b> Medium size</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.2</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>3.5</b> Summary</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="summary.html"><a href="summary.html#visualization"><i class="fa fa-check"></i><b>3.5.1</b> Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.1</b> One Sample Inference</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#the-mean"><i class="fa fa-check"></i><b>4.1.1</b> The Mean</a></li>
<li class="chapter" data-level="4.1.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#single-variance"><i class="fa fa-check"></i><b>4.1.2</b> Single Variance</a></li>
<li class="chapter" data-level="4.1.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#single-proportion-p"><i class="fa fa-check"></i><b>4.1.3</b> Single Proportion (p)</a></li>
<li class="chapter" data-level="4.1.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#power"><i class="fa fa-check"></i><b>4.1.4</b> Power</a></li>
<li class="chapter" data-level="4.1.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#sample-size"><i class="fa fa-check"></i><b>4.1.5</b> Sample Size</a></li>
<li class="chapter" data-level="4.1.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#note"><i class="fa fa-check"></i><b>4.1.6</b> Note</a></li>
<li class="chapter" data-level="4.1.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#one-sample-non-parametric-methods"><i class="fa fa-check"></i><b>4.1.7</b> One-sample Non-parametric Methods</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.2</b> Two Sample Inference</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#means"><i class="fa fa-check"></i><b>4.2.1</b> Means</a></li>
<li class="chapter" data-level="4.2.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#variances"><i class="fa fa-check"></i><b>4.2.2</b> Variances</a></li>
<li class="chapter" data-level="4.2.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power-1"><i class="fa fa-check"></i><b>4.2.3</b> Power</a></li>
<li class="chapter" data-level="4.2.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#sample-size-1"><i class="fa fa-check"></i><b>4.2.4</b> Sample Size</a></li>
<li class="chapter" data-level="4.2.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.2.5</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.2.6" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.2.6</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.3</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#inferences-for-small-samples"><i class="fa fa-check"></i><b>4.3.1</b> Inferences for Small Samples</a></li>
<li class="chapter" data-level="4.3.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#test-of-association"><i class="fa fa-check"></i><b>4.3.2</b> Test of Association</a></li>
<li class="chapter" data-level="4.3.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.3.3</b> Ordinal Association</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="divergence-metrics-and-test-for-comparing-distributions.html"><a href="divergence-metrics-and-test-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.4</b> Divergence Metrics and Test for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="divergence-metrics-and-test-for-comparing-distributions.html"><a href="divergence-metrics-and-test-for-comparing-distributions.html#kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.4.1</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.4.2" data-path="divergence-metrics-and-test-for-comparing-distributions.html"><a href="divergence-metrics-and-test-for-comparing-distributions.html#jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.4.2</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.4.3" data-path="divergence-metrics-and-test-for-comparing-distributions.html"><a href="divergence-metrics-and-test-for-comparing-distributions.html#wasserstein-distance"><i class="fa fa-check"></i><b>4.4.3</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.4.4" data-path="divergence-metrics-and-test-for-comparing-distributions.html"><a href="divergence-metrics-and-test-for-comparing-distributions.html#kolmogorov-smirnov-test-1"><i class="fa fa-check"></i><b>4.4.4</b> Kolmogorov-Smirnov Test</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic Model)</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-assumptions"><i class="fa fa-check"></i><b>5.1.3</b> OLS Assumptions</a></li>
<li class="chapter" data-level="5.1.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#theorems"><i class="fa fa-check"></i><b>5.1.4</b> Theorems</a></li>
<li class="chapter" data-level="5.1.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variable-selection"><i class="fa fa-check"></i><b>5.1.5</b> Variable Selection</a></li>
<li class="chapter" data-level="5.1.6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#diagnostics-1"><i class="fa fa-check"></i><b>5.1.6</b> Diagnostics</a></li>
<li class="chapter" data-level="5.1.7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#model-validation"><i class="fa fa-check"></i><b>5.1.7</b> Model Validation</a></li>
<li class="chapter" data-level="5.1.8" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#finite-sample-properties"><i class="fa fa-check"></i><b>5.1.8</b> Finite Sample Properties</a></li>
<li class="chapter" data-level="5.1.9" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#large-sample-properties"><i class="fa fa-check"></i><b>5.1.9</b> Large Sample Properties</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Feasible Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#heteroskedasticity"><i class="fa fa-check"></i><b>5.2.1</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="5.2.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#serial-correlation"><i class="fa fa-check"></i><b>5.2.2</b> Serial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="weighted-least-squares.html"><a href="weighted-least-squares.html"><i class="fa fa-check"></i><b>5.3</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="5.4" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.4</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="5.5" data-path="feasiable-prais-winsten.html"><a href="feasiable-prais-winsten.html"><i class="fa fa-check"></i><b>5.5</b> Feasible Prais Winsten</a></li>
<li class="chapter" data-level="5.6" data-path="feasible-group-level-random-effects.html"><a href="feasible-group-level-random-effects.html"><i class="fa fa-check"></i><b>5.6</b> Feasible group level Random Effects</a></li>
<li class="chapter" data-level="5.7" data-path="ridge-regression.html"><a href="ridge-regression.html"><i class="fa fa-check"></i><b>5.7</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.8" data-path="principal-component-regression.html"><a href="principal-component-regression.html"><i class="fa fa-check"></i><b>5.8</b> Principal Component Regression</a></li>
<li class="chapter" data-level="5.9" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>5.9</b> Robust Regression</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="robust-regression.html"><a href="robust-regression.html#least-absolute-residuals-lar-regression"><i class="fa fa-check"></i><b>5.9.1</b> Least Absolute Residuals (LAR) Regression</a></li>
<li class="chapter" data-level="5.9.2" data-path="robust-regression.html"><a href="robust-regression.html#least-median-of-squares-lms-regression"><i class="fa fa-check"></i><b>5.9.2</b> Least Median of Squares (LMS) Regression</a></li>
<li class="chapter" data-level="5.9.3" data-path="robust-regression.html"><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression"><i class="fa fa-check"></i><b>5.9.3</b> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html"><i class="fa fa-check"></i><b>5.10</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.10.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.10.2" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#assumption"><i class="fa fa-check"></i><b>5.10.2</b> Assumption</a></li>
<li class="chapter" data-level="5.10.3" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#properties"><i class="fa fa-check"></i><b>5.10.3</b> Properties</a></li>
<li class="chapter" data-level="5.10.4" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#compare-to-ols"><i class="fa fa-check"></i><b>5.10.4</b> Compare to OLS</a></li>
<li class="chapter" data-level="5.10.5" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#application"><i class="fa fa-check"></i><b>5.10.5</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference-1.html"><a href="inference-1.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference-1.html"><a href="inference-1.html#linear-function-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Function of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference-1.html"><a href="inference-1.html#nonlinear"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.2.1</b> Alternative of Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#practical-considerations"><i class="fa fa-check"></i><b>6.2.2</b> Practical Considerations</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#modelestimation-adequacy"><i class="fa fa-check"></i><b>6.2.3</b> Model/Estimation Adequacy</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#application-1"><i class="fa fa-check"></i><b>6.2.4</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression-1.html"><a href="logistic-regression-1.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-regression-1.html"><a href="logistic-regression-1.html#application-2"><i class="fa fa-check"></i><b>7.1.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="probit-regression.html"><a href="probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a></li>
<li class="chapter" data-level="7.3" data-path="binomial-regression.html"><a href="binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a></li>
<li class="chapter" data-level="7.4" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="poisson-regression.html"><a href="poisson-regression.html#application-3"><i class="fa fa-check"></i><b>7.4.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="negative-binomial-regression.html"><a href="negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.6" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i><b>7.6</b> Multinomial</a></li>
<li class="chapter" data-level="7.7" data-path="generalization.html"><a href="generalization.html"><i class="fa fa-check"></i><b>7.7</b> Generalization</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="generalization.html"><a href="generalization.html#estimation-1"><i class="fa fa-check"></i><b>7.7.1</b> Estimation</a></li>
<li class="chapter" data-level="7.7.2" data-path="generalization.html"><a href="generalization.html#inference-2"><i class="fa fa-check"></i><b>7.7.2</b> Inference</a></li>
<li class="chapter" data-level="7.7.3" data-path="generalization.html"><a href="generalization.html#deviance"><i class="fa fa-check"></i><b>7.7.3</b> Deviance</a></li>
<li class="chapter" data-level="7.7.4" data-path="generalization.html"><a href="generalization.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.7.4</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.7.5" data-path="generalization.html"><a href="generalization.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.7.5</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.7.6" data-path="generalization.html"><a href="generalization.html#over-dispersion"><i class="fa fa-check"></i><b>7.7.6</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#random-intercepts-model"><i class="fa fa-check"></i><b>8.1.1</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models"><i class="fa fa-check"></i><b>8.1.2</b> Covariance Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-2.html"><a href="estimation-2.html"><i class="fa fa-check"></i><b>8.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-2.html"><a href="estimation-2.html#estimating-mathbfv"><i class="fa fa-check"></i><b>8.2.1</b> Estimating <span class="math inline">\(\mathbf{V}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-3.html"><a href="inference-3.html"><i class="fa fa-check"></i><b>8.3</b> Inference</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-3.html"><a href="inference-3.html#parameters-beta"><i class="fa fa-check"></i><b>8.3.1</b> Parameters <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-3.html"><a href="inference-3.html#variance-components"><i class="fa fa-check"></i><b>8.3.2</b> Variance Components</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria.html"><a href="information-criteria.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria.html"><a href="information-criteria.html#akaikes-information-criteria-aic"><i class="fa fa-check"></i><b>8.4.1</b> Akaike’s Information Criteria (AIC)</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria.html"><a href="information-criteria.html#corrected-aic-aicc"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC (AICC)</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria.html"><a href="information-criteria.html#bayesian-information-criteria-bic"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criteria (BIC)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-4"><i class="fa fa-check"></i><b>8.5.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a></li>
<li class="chapter" data-level="8.8" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>8.8</b> Application</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-5.html"><a href="application-5.html#example-1-pulps"><i class="fa fa-check"></i><b>8.8.1</b> Example 1 (Pulps)</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-5.html"><a href="application-5.html#example-2-rats"><i class="fa fa-check"></i><b>8.8.2</b> Example 2 (Rats)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-5.html"><a href="application-5.html#example-3-agridat"><i class="fa fa-check"></i><b>8.8.3</b> Example 3 (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="nonlinear-and-generalized-linear-mixed-models.html"><a href="nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="estimation-3.html"><a href="estimation-3.html"><i class="fa fa-check"></i><b>9.1</b> Estimation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.1.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.1.2" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-linearization"><i class="fa fa-check"></i><b>9.1.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.1.3" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.1.3</b> Estimation by Bayesian Hierarchical Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="application-6.html"><a href="application-6.html"><i class="fa fa-check"></i><b>9.2</b> Application</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="application-6.html"><a href="application-6.html#binomial-cbpp-data"><i class="fa fa-check"></i><b>9.2.1</b> Binomial (CBPP Data)</a></li>
<li class="chapter" data-level="9.2.2" data-path="application-6.html"><a href="application-6.html#count-owl-data"><i class="fa fa-check"></i><b>9.2.2</b> Count (Owl Data)</a></li>
<li class="chapter" data-level="9.2.3" data-path="application-6.html"><a href="application-6.html#binomial"><i class="fa fa-check"></i><b>9.2.3</b> Binomial</a></li>
<li class="chapter" data-level="9.2.4" data-path="application-6.html"><a href="application-6.html#example-from-schabenberger_2001-section-8.4.1"><i class="fa fa-check"></i><b>9.2.4</b> Example from <span class="citation">(Schabenberger and Pierce 2001)</span> section 8.4.1</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.3</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="10" data-path="model-specification.html"><a href="model-specification.html"><i class="fa fa-check"></i><b>10</b> Model Specification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="nested-model.html"><a href="nested-model.html"><i class="fa fa-check"></i><b>10.1</b> Nested Model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="nested-model.html"><a href="nested-model.html#chow-test"><i class="fa fa-check"></i><b>10.1.1</b> Chow test</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="non-nested-model.html"><a href="non-nested-model.html"><i class="fa fa-check"></i><b>10.2</b> Non-Nested Model</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="non-nested-model.html"><a href="non-nested-model.html#davidson-mackinnon-test"><i class="fa fa-check"></i><b>10.2.1</b> Davidson-Mackinnon test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html"><i class="fa fa-check"></i><b>10.3</b> Heteroskedasticity</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#breusch-pagan-test"><i class="fa fa-check"></i><b>10.3.1</b> Breusch-Pagan test</a></li>
<li class="chapter" data-level="10.3.2" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#white-test"><i class="fa fa-check"></i><b>10.3.2</b> White test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>11</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assumptions-1.html"><a href="assumptions-1.html"><i class="fa fa-check"></i><b>11.1</b> Assumptions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="assumptions-1.html"><a href="assumptions-1.html#missing-completely-at-random-mcar"><i class="fa fa-check"></i><b>11.1.1</b> Missing Completely at Random (MCAR)</a></li>
<li class="chapter" data-level="11.1.2" data-path="assumptions-1.html"><a href="assumptions-1.html#missing-at-random-mar"><i class="fa fa-check"></i><b>11.1.2</b> Missing at Random (MAR)</a></li>
<li class="chapter" data-level="11.1.3" data-path="assumptions-1.html"><a href="assumptions-1.html#ignorable"><i class="fa fa-check"></i><b>11.1.3</b> Ignorable</a></li>
<li class="chapter" data-level="11.1.4" data-path="assumptions-1.html"><a href="assumptions-1.html#nonignorable"><i class="fa fa-check"></i><b>11.1.4</b> Nonignorable</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html"><i class="fa fa-check"></i><b>11.2</b> Solutions to Missing data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#listwise-deletion"><i class="fa fa-check"></i><b>11.2.1</b> Listwise Deletion</a></li>
<li class="chapter" data-level="11.2.2" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#pairwise-deletion"><i class="fa fa-check"></i><b>11.2.2</b> Pairwise Deletion</a></li>
<li class="chapter" data-level="11.2.3" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#dummy-variable-adjustment"><i class="fa fa-check"></i><b>11.2.3</b> Dummy Variable Adjustment</a></li>
<li class="chapter" data-level="11.2.4" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#imputation"><i class="fa fa-check"></i><b>11.2.4</b> Imputation</a></li>
<li class="chapter" data-level="11.2.5" data-path="solutions-to-missing-data.html"><a href="solutions-to-missing-data.html#other-methods"><i class="fa fa-check"></i><b>11.2.5</b> Other methods</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>11.3</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="11.4" data-path="another-perspective.html"><a href="another-perspective.html"><i class="fa fa-check"></i><b>11.4</b> Another Perspective</a></li>
<li class="chapter" data-level="11.5" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html"><i class="fa fa-check"></i><b>11.5</b> Diagnosing the Mechanism</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html#mar-vs.-mnar"><i class="fa fa-check"></i><b>11.5.1</b> MAR vs. MNAR</a></li>
<li class="chapter" data-level="11.5.2" data-path="diagnosing-the-mechanism.html"><a href="diagnosing-the-mechanism.html#mcar-vs.-mar"><i class="fa fa-check"></i><b>11.5.2</b> MCAR vs. MAR</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="application-7.html"><a href="application-7.html"><i class="fa fa-check"></i><b>11.6</b> Application</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="application-7.html"><a href="application-7.html#imputation-with-mean-median-mode"><i class="fa fa-check"></i><b>11.6.1</b> Imputation with mean / median / mode</a></li>
<li class="chapter" data-level="11.6.2" data-path="application-7.html"><a href="application-7.html#knn"><i class="fa fa-check"></i><b>11.6.2</b> KNN</a></li>
<li class="chapter" data-level="11.6.3" data-path="application-7.html"><a href="application-7.html#rpart"><i class="fa fa-check"></i><b>11.6.3</b> rpart</a></li>
<li class="chapter" data-level="11.6.4" data-path="application-7.html"><a href="application-7.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>11.6.4</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="11.6.5" data-path="application-7.html"><a href="application-7.html#amelia"><i class="fa fa-check"></i><b>11.6.5</b> Amelia</a></li>
<li class="chapter" data-level="11.6.6" data-path="application-7.html"><a href="application-7.html#missforest"><i class="fa fa-check"></i><b>11.6.6</b> missForest</a></li>
<li class="chapter" data-level="11.6.7" data-path="application-7.html"><a href="application-7.html#hmisc"><i class="fa fa-check"></i><b>11.6.7</b> Hmisc</a></li>
<li class="chapter" data-level="11.6.8" data-path="application-7.html"><a href="application-7.html#mi"><i class="fa fa-check"></i><b>11.6.8</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>12</b> Data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cross-sectional.html"><a href="cross-sectional.html"><i class="fa fa-check"></i><b>12.1</b> Cross-Sectional</a></li>
<li class="chapter" data-level="12.2" data-path="time-series-1.html"><a href="time-series-1.html"><i class="fa fa-check"></i><b>12.2</b> Time Series</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="time-series-1.html"><a href="time-series-1.html#deterministic-time-trend"><i class="fa fa-check"></i><b>12.2.1</b> Deterministic Time trend</a></li>
<li class="chapter" data-level="12.2.2" data-path="time-series-1.html"><a href="time-series-1.html#feedback-effect"><i class="fa fa-check"></i><b>12.2.2</b> Feedback Effect</a></li>
<li class="chapter" data-level="12.2.3" data-path="time-series-1.html"><a href="time-series-1.html#dynamic-specification"><i class="fa fa-check"></i><b>12.2.3</b> Dynamic Specification</a></li>
<li class="chapter" data-level="12.2.4" data-path="time-series-1.html"><a href="time-series-1.html#dynamically-complete"><i class="fa fa-check"></i><b>12.2.4</b> Dynamically Complete</a></li>
<li class="chapter" data-level="12.2.5" data-path="time-series-1.html"><a href="time-series-1.html#highly-persistent-data"><i class="fa fa-check"></i><b>12.2.5</b> Highly Persistent Data</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html"><i class="fa fa-check"></i><b>12.3</b> Repeated Cross Sections</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html#pooled-cross-section"><i class="fa fa-check"></i><b>12.3.1</b> Pooled Cross Section</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>12.4</b> Panel Data</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="panel-data.html"><a href="panel-data.html#pooled-ols-estimator"><i class="fa fa-check"></i><b>12.4.1</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="12.4.2" data-path="panel-data.html"><a href="panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>12.4.2</b> Individual-specific effects model</a></li>
<li class="chapter" data-level="12.4.3" data-path="panel-data.html"><a href="panel-data.html#tests-for-assumptions"><i class="fa fa-check"></i><b>12.4.3</b> Tests for Assumptions</a></li>
<li class="chapter" data-level="12.4.4" data-path="panel-data.html"><a href="panel-data.html#model-selection"><i class="fa fa-check"></i><b>12.4.4</b> Model Selection</a></li>
<li class="chapter" data-level="12.4.5" data-path="panel-data.html"><a href="panel-data.html#summary-2"><i class="fa fa-check"></i><b>12.4.5</b> Summary</a></li>
<li class="chapter" data-level="12.4.6" data-path="panel-data.html"><a href="panel-data.html#application-8"><i class="fa fa-check"></i><b>12.4.6</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>13</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>13.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization"><i class="fa fa-check"></i><b>13.1.1</b> Standardization</a></li>
<li class="chapter" data-level="13.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling"><i class="fa fa-check"></i><b>13.1.2</b> Min-max scaling</a></li>
<li class="chapter" data-level="13.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-rootcube-root"><i class="fa fa-check"></i><b>13.1.3</b> Square Root/Cube Root</a></li>
<li class="chapter" data-level="13.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#logarithmic"><i class="fa fa-check"></i><b>13.1.4</b> Logarithmic</a></li>
<li class="chapter" data-level="13.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential"><i class="fa fa-check"></i><b>13.1.5</b> Exponential</a></li>
<li class="chapter" data-level="13.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-2"><i class="fa fa-check"></i><b>13.1.6</b> Power</a></li>
<li class="chapter" data-level="13.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inversereciprocal"><i class="fa fa-check"></i><b>13.1.7</b> Inverse/Reciprocal</a></li>
<li class="chapter" data-level="13.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine"><i class="fa fa-check"></i><b>13.1.8</b> Hyperbolic arcsine</a></li>
<li class="chapter" data-level="13.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-norm"><i class="fa fa-check"></i><b>13.1.9</b> Ordered Quantile Norm</a></li>
<li class="chapter" data-level="13.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#arcsinh"><i class="fa fa-check"></i><b>13.1.10</b> Arcsinh</a></li>
<li class="chapter" data-level="13.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>13.1.11</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="13.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-ihs-transformation"><i class="fa fa-check"></i><b>13.1.12</b> Inverse Hyperbolic Sine (IHS) transformation</a></li>
<li class="chapter" data-level="13.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#box-cox-transformation"><i class="fa fa-check"></i><b>13.1.13</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="13.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>13.1.14</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="13.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss"><i class="fa fa-check"></i><b>13.1.15</b> RankGauss</a></li>
<li class="chapter" data-level="13.1.16" data-path="continuous-variables.html"><a href="continuous-variables.html#summary-3"><i class="fa fa-check"></i><b>13.1.16</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>13.2</b> Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>14</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="14.1" data-path="types-of-hypothesis-testing.html"><a href="types-of-hypothesis-testing.html"><i class="fa fa-check"></i><b>14.1</b> Types of hypothesis testing</a></li>
<li class="chapter" data-level="14.2" data-path="wald-test.html"><a href="wald-test.html"><i class="fa fa-check"></i><b>14.2</b> Wald test</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="wald-test.html"><a href="wald-test.html#multiple-hypothesis"><i class="fa fa-check"></i><b>14.2.1</b> Multiple Hypothesis</a></li>
<li class="chapter" data-level="14.2.2" data-path="wald-test.html"><a href="wald-test.html#linear-combination"><i class="fa fa-check"></i><b>14.2.2</b> Linear Combination</a></li>
<li class="chapter" data-level="14.2.3" data-path="wald-test.html"><a href="wald-test.html#estimate-difference-in-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Estimate Difference in Coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="wald-test.html"><a href="wald-test.html#application-9"><i class="fa fa-check"></i><b>14.2.4</b> Application</a></li>
<li class="chapter" data-level="14.2.5" data-path="wald-test.html"><a href="wald-test.html#nonlinear-1"><i class="fa fa-check"></i><b>14.2.5</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="the-likelihood-ratio-test.html"><a href="the-likelihood-ratio-test.html"><i class="fa fa-check"></i><b>14.3</b> The likelihood ratio test</a></li>
<li class="chapter" data-level="14.4" data-path="lagrange-multiplier-score.html"><a href="lagrange-multiplier-score.html"><i class="fa fa-check"></i><b>14.4</b> Lagrange Multiplier (Score)</a></li>
<li class="chapter" data-level="14.5" data-path="two-one-sided-tests-tost-equivalence-testing.html"><a href="two-one-sided-tests-tost-equivalence-testing.html"><i class="fa fa-check"></i><b>14.5</b> Two One-Sided Tests (TOST) Equivalence Testing</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="marginal-effects.html"><a href="marginal-effects.html"><i class="fa fa-check"></i><b>15</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="15.1" data-path="delta-method.html"><a href="delta-method.html"><i class="fa fa-check"></i><b>15.1</b> Delta Method</a></li>
<li class="chapter" data-level="15.2" data-path="average-marginal-effect-algorithm.html"><a href="average-marginal-effect-algorithm.html"><i class="fa fa-check"></i><b>15.2</b> Average Marginal Effect Algorithm</a></li>
<li class="chapter" data-level="15.3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>15.3</b> Packages</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="packages.html"><a href="packages.html#marginaleffects"><i class="fa fa-check"></i><b>15.3.1</b> MarginalEffects</a></li>
<li class="chapter" data-level="15.3.2" data-path="packages.html"><a href="packages.html#margins"><i class="fa fa-check"></i><b>15.3.2</b> margins</a></li>
<li class="chapter" data-level="15.3.3" data-path="packages.html"><a href="packages.html#mfx"><i class="fa fa-check"></i><b>15.3.3</b> mfx</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>16</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="prediction-1.html"><a href="prediction-1.html"><i class="fa fa-check"></i><b>16.1</b> Prediction</a></li>
<li class="chapter" data-level="16.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>16.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="16.3" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>16.3</b> Causation versus Prediction</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>17</b> Moderation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="emmeans-package.html"><a href="emmeans-package.html"><i class="fa fa-check"></i><b>17.1</b> emmeans package</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="emmeans-package.html"><a href="emmeans-package.html#continuous-by-continuous"><i class="fa fa-check"></i><b>17.1.1</b> Continuous by continuous</a></li>
<li class="chapter" data-level="17.1.2" data-path="emmeans-package.html"><a href="emmeans-package.html#continuous-by-categorical"><i class="fa fa-check"></i><b>17.1.2</b> Continuous by categorical</a></li>
<li class="chapter" data-level="17.1.3" data-path="emmeans-package.html"><a href="emmeans-package.html#categorical-by-categorical"><i class="fa fa-check"></i><b>17.1.3</b> Categorical by categorical</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="probmod-package.html"><a href="probmod-package.html"><i class="fa fa-check"></i><b>17.2</b> probmod package</a></li>
<li class="chapter" data-level="17.3" data-path="interactions-package.html"><a href="interactions-package.html"><i class="fa fa-check"></i><b>17.3</b> interactions package</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="interactions-package.html"><a href="interactions-package.html#continuous-interaction"><i class="fa fa-check"></i><b>17.3.1</b> Continuous interaction</a></li>
<li class="chapter" data-level="17.3.2" data-path="interactions-package.html"><a href="interactions-package.html#categorical-interaction"><i class="fa fa-check"></i><b>17.3.2</b> Categorical interaction</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="interactionr-package.html"><a href="interactionr-package.html"><i class="fa fa-check"></i><b>17.4</b> interactionR package</a></li>
<li class="chapter" data-level="17.5" data-path="sjplot-package.html"><a href="sjplot-package.html"><i class="fa fa-check"></i><b>17.5</b> sjPlot package</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="18" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>18</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="18.1" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html"><i class="fa fa-check"></i><b>18.1</b> Treatment effect types</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#average-treatment-effects"><i class="fa fa-check"></i><b>18.1.1</b> Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.2" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#conditional-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.2</b> Conditional Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.3" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#intent-to-treat-effects"><i class="fa fa-check"></i><b>18.1.3</b> Intent-to-treat Effects</a></li>
<li class="chapter" data-level="18.1.4" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#local-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.5" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.6" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>18.1.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="18.1.7" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#quantile-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.8" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#mediation-effects"><i class="fa fa-check"></i><b>18.1.8</b> Mediation Effects</a></li>
<li class="chapter" data-level="18.1.9" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#log-odds-treatment-effects"><i class="fa fa-check"></i><b>18.1.9</b> Log-odds Treatment Effects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="19" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>19</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="19.1" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>19.1</b> Notes</a></li>
<li class="chapter" data-level="19.2" data-path="semi-random-experiment.html"><a href="semi-random-experiment.html"><i class="fa fa-check"></i><b>19.2</b> Semi-random Experiment</a></li>
<li class="chapter" data-level="19.3" data-path="rerandomization.html"><a href="rerandomization.html"><i class="fa fa-check"></i><b>19.3</b> Rerandomization</a></li>
<li class="chapter" data-level="19.4" data-path="two-stage-randomized-experiments-with-interference-and-noncompliance.html"><a href="two-stage-randomized-experiments-with-interference-and-noncompliance.html"><i class="fa fa-check"></i><b>19.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>20</b> Sampling</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simple-sampling.html"><a href="simple-sampling.html"><i class="fa fa-check"></i><b>20.1</b> Simple Sampling</a></li>
<li class="chapter" data-level="20.2" data-path="stratified-sampling.html"><a href="stratified-sampling.html"><i class="fa fa-check"></i><b>20.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="20.3" data-path="unequal-probability-sampling.html"><a href="unequal-probability-sampling.html"><i class="fa fa-check"></i><b>20.3</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="20.4" data-path="balanced-sampling.html"><a href="balanced-sampling.html"><i class="fa fa-check"></i><b>20.4</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="balanced-sampling.html"><a href="balanced-sampling.html#cube"><i class="fa fa-check"></i><b>20.4.1</b> Cube</a></li>
<li class="chapter" data-level="20.4.2" data-path="balanced-sampling.html"><a href="balanced-sampling.html#stratification"><i class="fa fa-check"></i><b>20.4.2</b> Stratification</a></li>
<li class="chapter" data-level="20.4.3" data-path="balanced-sampling.html"><a href="balanced-sampling.html#cluster-1"><i class="fa fa-check"></i><b>20.4.3</b> Cluster</a></li>
<li class="chapter" data-level="20.4.4" data-path="balanced-sampling.html"><a href="balanced-sampling.html#two-stage"><i class="fa fa-check"></i><b>20.4.4</b> Two-stage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>21</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="21.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html"><i class="fa fa-check"></i><b>21.1</b> Completely Randomized Design (CRD)</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>21.1.1</b> Single Factor Fixed Effects Model</a></li>
<li class="chapter" data-level="21.1.2" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-random-effects-model"><i class="fa fa-check"></i><b>21.1.2</b> Single Factor Random Effects Model</a></li>
<li class="chapter" data-level="21.1.3" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova"><i class="fa fa-check"></i><b>21.1.3</b> Two Factor Fixed Effect ANOVA</a></li>
<li class="chapter" data-level="21.1.4" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-random-effects-anova"><i class="fa fa-check"></i><b>21.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="21.1.5" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>21.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html"><i class="fa fa-check"></i><b>21.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#kruskal-wallis"><i class="fa fa-check"></i><b>21.2.1</b> Kruskal-Wallis</a></li>
<li class="chapter" data-level="21.2.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#friedman-test"><i class="fa fa-check"></i><b>21.2.2</b> Friedman Test</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>21.3</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>21.3.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="21.3.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>21.3.2</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html"><i class="fa fa-check"></i><b>21.4</b> Randomized Block Designs</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html#tukey-test-of-additivity"><i class="fa fa-check"></i><b>21.4.1</b> Tukey Test of Additivity</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>21.5</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-designs"><i class="fa fa-check"></i><b>21.5.1</b> Two-Factor Nested Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>21.6</b> Single Factor Covariance Model</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>22</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="22.0.1" data-path="multivariate-methods.html"><a href="multivariate-methods.html#properties-of-mvn"><i class="fa fa-check"></i><b>22.0.1</b> Properties of MVN</a></li>
<li class="chapter" data-level="22.0.2" data-path="multivariate-methods.html"><a href="multivariate-methods.html#mean-vector-inference"><i class="fa fa-check"></i><b>22.0.2</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="22.0.3" data-path="multivariate-methods.html"><a href="multivariate-methods.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>22.0.3</b> General Hypothesis Testing</a></li>
<li class="chapter" data-level="22.1" data-path="manova.html"><a href="manova.html"><i class="fa fa-check"></i><b>22.1</b> MANOVA</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="manova.html"><a href="manova.html#testing-general-hypotheses"><i class="fa fa-check"></i><b>22.1.1</b> Testing General Hypotheses</a></li>
<li class="chapter" data-level="22.1.2" data-path="manova.html"><a href="manova.html#profile-analysis"><i class="fa fa-check"></i><b>22.1.2</b> Profile Analysis</a></li>
<li class="chapter" data-level="22.1.3" data-path="manova.html"><a href="manova.html#summary-5"><i class="fa fa-check"></i><b>22.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>22.2</b> Principal Components</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="principal-components.html"><a href="principal-components.html#population-principal-components"><i class="fa fa-check"></i><b>22.2.1</b> Population Principal Components</a></li>
<li class="chapter" data-level="22.2.2" data-path="principal-components.html"><a href="principal-components.html#sample-principal-components"><i class="fa fa-check"></i><b>22.2.2</b> Sample Principal Components</a></li>
<li class="chapter" data-level="22.2.3" data-path="principal-components.html"><a href="principal-components.html#application-10"><i class="fa fa-check"></i><b>22.2.3</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>22.3</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="factor-analysis.html"><a href="factor-analysis.html#methods-of-estimation"><i class="fa fa-check"></i><b>22.3.1</b> Methods of Estimation</a></li>
<li class="chapter" data-level="22.3.2" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-rotation"><i class="fa fa-check"></i><b>22.3.2</b> Factor Rotation</a></li>
<li class="chapter" data-level="22.3.3" data-path="factor-analysis.html"><a href="factor-analysis.html#estimation-of-factor-scores"><i class="fa fa-check"></i><b>22.3.3</b> Estimation of Factor Scores</a></li>
<li class="chapter" data-level="22.3.4" data-path="factor-analysis.html"><a href="factor-analysis.html#model-diagnostic"><i class="fa fa-check"></i><b>22.3.4</b> Model Diagnostic</a></li>
<li class="chapter" data-level="22.3.5" data-path="factor-analysis.html"><a href="factor-analysis.html#application-11"><i class="fa fa-check"></i><b>22.3.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>22.4</b> Discriminant Analysis</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#known-populations"><i class="fa fa-check"></i><b>22.4.1</b> Known Populations</a></li>
<li class="chapter" data-level="22.4.2" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#probabilities-of-misclassification"><i class="fa fa-check"></i><b>22.4.2</b> Probabilities of Misclassification</a></li>
<li class="chapter" data-level="22.4.3" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#unknown-populations-nonparametric-discrimination"><i class="fa fa-check"></i><b>22.4.3</b> Unknown Populations/ Nonparametric Discrimination</a></li>
<li class="chapter" data-level="22.4.4" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#application-12"><i class="fa fa-check"></i><b>22.4.4</b> Application</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="23" data-path="quasi-experimental.html"><a href="quasi-experimental.html"><i class="fa fa-check"></i><b>23</b> Quasi-experimental</a>
<ul>
<li class="chapter" data-level="23.1" data-path="natural-experiments.html"><a href="natural-experiments.html"><i class="fa fa-check"></i><b>23.1</b> Natural Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>24</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="24.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>24.1</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based"><i class="fa fa-check"></i><b>24.1.1</b> Local Randomization-based</a></li>
<li class="chapter" data-level="24.1.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#continuity-based"><i class="fa fa-check"></i><b>24.1.2</b> Continuity-based</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>24.2</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="specification-checks.html"><a href="specification-checks.html#balance-checks"><i class="fa fa-check"></i><b>24.2.1</b> Balance Checks</a></li>
<li class="chapter" data-level="24.2.2" data-path="specification-checks.html"><a href="specification-checks.html#sortingbunchingmanipulation"><i class="fa fa-check"></i><b>24.2.2</b> Sorting/Bunching/Manipulation</a></li>
<li class="chapter" data-level="24.2.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>24.2.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="24.2.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>24.2.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="24.2.5" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>24.2.5</b> Manipulation Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="fuzzy-rd-design.html"><a href="fuzzy-rd-design.html"><i class="fa fa-check"></i><b>24.3</b> Fuzzy RD Design</a></li>
<li class="chapter" data-level="24.4" data-path="regression-kink-design.html"><a href="regression-kink-design.html"><i class="fa fa-check"></i><b>24.4</b> Regression Kink Design</a></li>
<li class="chapter" data-level="24.5" data-path="multi-cutoff.html"><a href="multi-cutoff.html"><i class="fa fa-check"></i><b>24.5</b> Multi-cutoff</a></li>
<li class="chapter" data-level="24.6" data-path="multi-score.html"><a href="multi-score.html"><i class="fa fa-check"></i><b>24.6</b> Multi-score</a></li>
<li class="chapter" data-level="24.7" data-path="steps-for-sharp-rd.html"><a href="steps-for-sharp-rd.html"><i class="fa fa-check"></i><b>24.7</b> Steps for Sharp RD</a></li>
<li class="chapter" data-level="24.8" data-path="steps-for-fuzzy-rd.html"><a href="steps-for-fuzzy-rd.html"><i class="fa fa-check"></i><b>24.8</b> Steps for Fuzzy RD</a></li>
<li class="chapter" data-level="24.9" data-path="steps-for-rdit-regression-discontinuity-in-time.html"><a href="steps-for-rdit-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>24.9</b> Steps for RDiT (Regression Discontinuity in Time)</a></li>
<li class="chapter" data-level="24.10" data-path="evaluation-of-an-rd.html"><a href="evaluation-of-an-rd.html"><i class="fa fa-check"></i><b>24.10</b> Evaluation of an RD</a></li>
<li class="chapter" data-level="24.11" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>24.11</b> Applications</a>
<ul>
<li class="chapter" data-level="24.11.1" data-path="applications.html"><a href="applications.html#example-1-1"><i class="fa fa-check"></i><b>24.11.1</b> Example 1</a></li>
<li class="chapter" data-level="24.11.2" data-path="applications.html"><a href="applications.html#example-2"><i class="fa fa-check"></i><b>24.11.2</b> Example 2</a></li>
<li class="chapter" data-level="24.11.3" data-path="applications.html"><a href="applications.html#example-3"><i class="fa fa-check"></i><b>24.11.3</b> Example 3</a></li>
<li class="chapter" data-level="24.11.4" data-path="applications.html"><a href="applications.html#example-4"><i class="fa fa-check"></i><b>24.11.4</b> Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="synthetic-difference-in-differences.html"><a href="synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>25</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="25.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>25.1</b> Understanding</a></li>
<li class="chapter" data-level="25.2" data-path="application-13.html"><a href="application-13.html"><i class="fa fa-check"></i><b>25.2</b> Application</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="application-13.html"><a href="application-13.html#block-treatment"><i class="fa fa-check"></i><b>25.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="25.2.2" data-path="application-13.html"><a href="application-13.html#staggered-adoption"><i class="fa fa-check"></i><b>25.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>26</b> Difference-in-differences</a>
<ul>
<li class="chapter" data-level="26.1" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>26.1</b> Visualization</a></li>
<li class="chapter" data-level="26.2" data-path="simple-dif-n-dif.html"><a href="simple-dif-n-dif.html"><i class="fa fa-check"></i><b>26.2</b> Simple Dif-n-dif</a></li>
<li class="chapter" data-level="26.3" data-path="notes-1.html"><a href="notes-1.html"><i class="fa fa-check"></i><b>26.3</b> Notes</a></li>
<li class="chapter" data-level="26.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>26.4</b> Standard Errors</a></li>
<li class="chapter" data-level="26.5" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>26.5</b> Examples</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="examples.html"><a href="examples.html#example-by-doleac2020unintended"><i class="fa fa-check"></i><b>26.5.1</b> Example by <span class="citation">Doleac and Hansen (2020)</span></a></li>
<li class="chapter" data-level="26.5.2" data-path="examples.html"><a href="examples.html#example-from-princeton"><i class="fa fa-check"></i><b>26.5.2</b> Example from Princeton</a></li>
<li class="chapter" data-level="26.5.3" data-path="examples.html"><a href="examples.html#example-by-card1993minimum"><i class="fa fa-check"></i><b>26.5.3</b> Example by <span class="citation">Card and Krueger (1993)</span></a></li>
<li class="chapter" data-level="26.5.4" data-path="examples.html"><a href="examples.html#example-by-butcher2014effects"><i class="fa fa-check"></i><b>26.5.4</b> Example by <span class="citation">Butcher, McEwan, and Weerapana (2014)</span></a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>26.6</b> One Difference</a></li>
<li class="chapter" data-level="26.7" data-path="two-way-fixed-effects.html"><a href="two-way-fixed-effects.html"><i class="fa fa-check"></i><b>26.7</b> Two-way Fixed-effects</a></li>
<li class="chapter" data-level="26.8" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>26.8</b> Multiple periods and variation in treatment timing</a></li>
<li class="chapter" data-level="26.9" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html"><i class="fa fa-check"></i><b>26.9</b> Staggered Dif-n-dif</a>
<ul>
<li class="chapter" data-level="26.9.1" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#stacked-did"><i class="fa fa-check"></i><b>26.9.1</b> Stacked DID</a></li>
<li class="chapter" data-level="26.9.2" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#goodman-bacon-decomposition"><i class="fa fa-check"></i><b>26.9.2</b> Goodman-Bacon Decomposition</a></li>
<li class="chapter" data-level="26.9.3" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#did-with-in-and-out-treatment-condition"><i class="fa fa-check"></i><b>26.9.3</b> DID with in and out treatment condition</a></li>
<li class="chapter" data-level="26.9.4" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#gardner2022two-and-borusyak2021revisiting"><i class="fa fa-check"></i><b>26.9.4</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2021)</span></a></li>
<li class="chapter" data-level="26.9.5" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#de2020two"><i class="fa fa-check"></i><b>26.9.5</b> <span class="citation">Clément De Chaisemartin and d’Haultfoeuille (2020)</span></a></li>
<li class="chapter" data-level="26.9.6" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#callaway2021difference"><i class="fa fa-check"></i><b>26.9.6</b> <span class="citation">Callaway and Sant’Anna (2021)</span></a></li>
<li class="chapter" data-level="26.9.7" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#sun2021estimating"><i class="fa fa-check"></i><b>26.9.7</b> <span class="citation">L. Sun and Abraham (2021)</span></a></li>
<li class="chapter" data-level="26.9.8" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#wooldridge2022simple"><i class="fa fa-check"></i><b>26.9.8</b> <span class="citation">Wooldridge (2022)</span></a></li>
<li class="chapter" data-level="26.9.9" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#doubly-robust-did"><i class="fa fa-check"></i><b>26.9.9</b> Doubly Robust DiD</a></li>
<li class="chapter" data-level="26.9.10" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#augmentedforward-did"><i class="fa fa-check"></i><b>26.9.10</b> Augmented/Forward DID</a></li>
</ul></li>
<li class="chapter" data-level="26.10" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>26.10</b> Multiple Treatments</a></li>
<li class="chapter" data-level="26.11" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>26.11</b> Mediation Under DiD</a></li>
<li class="chapter" data-level="26.12" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>26.12</b> Assumptions</a>
<ul>
<li class="chapter" data-level="26.12.1" data-path="assumptions-2.html"><a href="assumptions-2.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>26.12.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="26.12.2" data-path="assumptions-2.html"><a href="assumptions-2.html#placebo-test-1"><i class="fa fa-check"></i><b>26.12.2</b> Placebo Test</a></li>
<li class="chapter" data-level="26.12.3" data-path="assumptions-2.html"><a href="assumptions-2.html#assumption-violations"><i class="fa fa-check"></i><b>26.12.3</b> Assumption Violations</a></li>
<li class="chapter" data-level="26.12.4" data-path="assumptions-2.html"><a href="assumptions-2.html#robustness-checks"><i class="fa fa-check"></i><b>26.12.4</b> Robustness Checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="changes-in-changes.html"><a href="changes-in-changes.html"><i class="fa fa-check"></i><b>27</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="27.1" data-path="application-14.html"><a href="application-14.html"><i class="fa fa-check"></i><b>27.1</b> Application</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="application-14.html"><a href="application-14.html#ecic-package"><i class="fa fa-check"></i><b>27.1.1</b> ECIC package</a></li>
<li class="chapter" data-level="27.1.2" data-path="application-14.html"><a href="application-14.html#qte-package"><i class="fa fa-check"></i><b>27.1.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="synthetic-control.html"><a href="synthetic-control.html"><i class="fa fa-check"></i><b>28</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="28.1" data-path="applications-1.html"><a href="applications-1.html"><i class="fa fa-check"></i><b>28.1</b> Applications</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="applications-1.html"><a href="applications-1.html#example-1-2"><i class="fa fa-check"></i><b>28.1.1</b> Example 1</a></li>
<li class="chapter" data-level="28.1.2" data-path="applications-1.html"><a href="applications-1.html#example-2-1"><i class="fa fa-check"></i><b>28.1.2</b> Example 2</a></li>
<li class="chapter" data-level="28.1.3" data-path="applications-1.html"><a href="applications-1.html#example-3-1"><i class="fa fa-check"></i><b>28.1.3</b> Example 3</a></li>
<li class="chapter" data-level="28.1.4" data-path="applications-1.html"><a href="applications-1.html#example-4-1"><i class="fa fa-check"></i><b>28.1.4</b> Example 4</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="augmented-synthetic-control-method.html"><a href="augmented-synthetic-control-method.html"><i class="fa fa-check"></i><b>28.2</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="28.3" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>28.3</b> Synthetic Control with Staggered Adoption</a></li>
<li class="chapter" data-level="28.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>28.4</b> Bayesian Synthetic Control</a></li>
<li class="chapter" data-level="28.5" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>28.5</b> Generalized Synthetic Control</a></li>
<li class="chapter" data-level="28.6" data-path="other-advances.html"><a href="other-advances.html"><i class="fa fa-check"></i><b>28.6</b> Other Advances</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="event-studies.html"><a href="event-studies.html"><i class="fa fa-check"></i><b>29</b> Event Studies</a>
<ul>
<li class="chapter" data-level="29.1" data-path="other-issues.html"><a href="other-issues.html"><i class="fa fa-check"></i><b>29.1</b> Other Issues</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="other-issues.html"><a href="other-issues.html#event-studies-in-marketing"><i class="fa fa-check"></i><b>29.1.1</b> Event Studies in marketing</a></li>
<li class="chapter" data-level="29.1.2" data-path="other-issues.html"><a href="other-issues.html#economic-significance"><i class="fa fa-check"></i><b>29.1.2</b> Economic significance</a></li>
<li class="chapter" data-level="29.1.3" data-path="other-issues.html"><a href="other-issues.html#statistical-power"><i class="fa fa-check"></i><b>29.1.3</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>29.2</b> Testing</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="testing.html"><a href="testing.html#parametric-test"><i class="fa fa-check"></i><b>29.2.1</b> Parametric Test</a></li>
<li class="chapter" data-level="29.2.2" data-path="testing.html"><a href="testing.html#non-parametric-test"><i class="fa fa-check"></i><b>29.2.2</b> Non-parametric Test</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i><b>29.3</b> Sample</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="sample.html"><a href="sample.html#confounders"><i class="fa fa-check"></i><b>29.3.1</b> Confounders</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="biases.html"><a href="biases.html"><i class="fa fa-check"></i><b>29.4</b> Biases</a></li>
<li class="chapter" data-level="29.5" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>29.5</b> Long-run event studies</a>
<ul>
<li class="chapter" data-level="29.5.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>29.5.1</b> Buy and Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="29.5.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>29.5.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="29.5.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>29.5.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>29.6</b> Aggregation</a>
<ul>
<li class="chapter" data-level="29.6.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>29.6.1</b> Over Time</a></li>
<li class="chapter" data-level="29.6.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-over-time"><i class="fa fa-check"></i><b>29.6.2</b> Across Firms + Over Time</a></li>
</ul></li>
<li class="chapter" data-level="29.7" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>29.7</b> Heterogeneity in the event effect</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-in-marketing"><i class="fa fa-check"></i><b>29.7.1</b> Common variables in marketing</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>29.8</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="29.8.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models"><i class="fa fa-check"></i><b>29.8.1</b> Statistical Models</a></li>
<li class="chapter" data-level="29.8.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-model"><i class="fa fa-check"></i><b>29.8.2</b> Economic Model</a></li>
</ul></li>
<li class="chapter" data-level="29.9" data-path="application-15.html"><a href="application-15.html"><i class="fa fa-check"></i><b>29.9</b> Application</a>
<ul>
<li class="chapter" data-level="29.9.1" data-path="application-15.html"><a href="application-15.html#eventus"><i class="fa fa-check"></i><b>29.9.1</b> Eventus</a></li>
<li class="chapter" data-level="29.9.2" data-path="application-15.html"><a href="application-15.html#evenstudies"><i class="fa fa-check"></i><b>29.9.2</b> Evenstudies</a></li>
<li class="chapter" data-level="29.9.3" data-path="application-15.html"><a href="application-15.html#eventstudy"><i class="fa fa-check"></i><b>29.9.3</b> EventStudy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="instrumental-variables.html"><a href="instrumental-variables.html"><i class="fa fa-check"></i><b>30</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="30.1" data-path="framework.html"><a href="framework.html"><i class="fa fa-check"></i><b>30.1</b> Framework</a></li>
<li class="chapter" data-level="30.2" data-path="estimation-4.html"><a href="estimation-4.html"><i class="fa fa-check"></i><b>30.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="estimation-4.html"><a href="estimation-4.html#sls-estimation"><i class="fa fa-check"></i><b>30.2.1</b> 2SLS Estimation</a></li>
<li class="chapter" data-level="30.2.2" data-path="estimation-4.html"><a href="estimation-4.html#iv-gmm"><i class="fa fa-check"></i><b>30.2.2</b> IV-GMM</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="inference-4.html"><a href="inference-4.html"><i class="fa fa-check"></i><b>30.3</b> Inference</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="inference-4.html"><a href="inference-4.html#ar-approach"><i class="fa fa-check"></i><b>30.3.1</b> AR approach</a></li>
<li class="chapter" data-level="30.3.2" data-path="inference-4.html"><a href="inference-4.html#tf-procedure"><i class="fa fa-check"></i><b>30.3.2</b> tF Procedure</a></li>
<li class="chapter" data-level="30.3.3" data-path="inference-4.html"><a href="inference-4.html#ak-approach"><i class="fa fa-check"></i><b>30.3.3</b> AK approach</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>30.4</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#relevance-assumption"><i class="fa fa-check"></i><b>30.4.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="30.4.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#exogeneity-assumption"><i class="fa fa-check"></i><b>30.4.2</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="negative-r2.html"><a href="negative-r2.html"><i class="fa fa-check"></i><b>30.5</b> Negative <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="30.6" data-path="treatment-intensity.html"><a href="treatment-intensity.html"><i class="fa fa-check"></i><b>30.6</b> Treatment Intensity</a></li>
<li class="chapter" data-level="30.7" data-path="control-function.html"><a href="control-function.html"><i class="fa fa-check"></i><b>30.7</b> Control Function</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="control-function.html"><a href="control-function.html#simulation"><i class="fa fa-check"></i><b>30.7.1</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="new-advances.html"><a href="new-advances.html"><i class="fa fa-check"></i><b>30.8</b> New Advances</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="matching-methods.html"><a href="matching-methods.html"><i class="fa fa-check"></i><b>31</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="31.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html"><i class="fa fa-check"></i><b>31.1</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchit"><i class="fa fa-check"></i><b>31.1.1</b> MatchIt</a></li>
<li class="chapter" data-level="31.1.2" data-path="selection-on-observables.html"><a href="selection-on-observables.html#designmatch"><i class="fa fa-check"></i><b>31.1.2</b> designmatch</a></li>
<li class="chapter" data-level="31.1.3" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>31.1.3</b> MatchingFrontier</a></li>
<li class="chapter" data-level="31.1.4" data-path="selection-on-observables.html"><a href="selection-on-observables.html#propensity-scores"><i class="fa fa-check"></i><b>31.1.4</b> Propensity Scores</a></li>
<li class="chapter" data-level="31.1.5" data-path="selection-on-observables.html"><a href="selection-on-observables.html#mahalanobis-distance"><i class="fa fa-check"></i><b>31.1.5</b> Mahalanobis Distance</a></li>
<li class="chapter" data-level="31.1.6" data-path="selection-on-observables.html"><a href="selection-on-observables.html#coarsened-exact-matching"><i class="fa fa-check"></i><b>31.1.6</b> Coarsened Exact Matching</a></li>
<li class="chapter" data-level="31.1.7" data-path="selection-on-observables.html"><a href="selection-on-observables.html#genetic-matching"><i class="fa fa-check"></i><b>31.1.7</b> Genetic Matching</a></li>
<li class="chapter" data-level="31.1.8" data-path="selection-on-observables.html"><a href="selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>31.1.8</b> Entropy Balancing</a></li>
<li class="chapter" data-level="31.1.9" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>31.1.9</b> Matching for high-dimensional data</a></li>
<li class="chapter" data-level="31.1.10" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-time-series-cross-section-data"><i class="fa fa-check"></i><b>31.1.10</b> Matching for time series-cross-section data</a></li>
<li class="chapter" data-level="31.1.11" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>31.1.11</b> Matching for multiple treatments</a></li>
<li class="chapter" data-level="31.1.12" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>31.1.12</b> Matching for multi-level treatments</a></li>
<li class="chapter" data-level="31.1.13" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-repeated-treatments"><i class="fa fa-check"></i><b>31.1.13</b> Matching for repeated treatments</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html"><i class="fa fa-check"></i><b>31.2</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#rosenbaum-bounds"><i class="fa fa-check"></i><b>31.2.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="31.2.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#relative-correlation-restrictions"><i class="fa fa-check"></i><b>31.2.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="31.2.3" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#coefficient-stability-bounds"><i class="fa fa-check"></i><b>31.2.3</b> Coefficient-stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html"><i class="fa fa-check"></i><b>32</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="32.1" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>32.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="32.2" data-path="multiple-groups.html"><a href="multiple-groups.html"><i class="fa fa-check"></i><b>32.2</b> Multiple Groups</a></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="33" data-path="endogeneity.html"><a href="endogeneity.html"><i class="fa fa-check"></i><b>33</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="33.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html"><i class="fa fa-check"></i><b>33.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#measurement-error"><i class="fa fa-check"></i><b>33.1.1</b> Measurement Error</a></li>
<li class="chapter" data-level="33.1.2" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#simultaneity"><i class="fa fa-check"></i><b>33.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="33.1.3" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#endogenous-treatment-solutions"><i class="fa fa-check"></i><b>33.1.3</b> Endogenous Treatment Solutions</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html"><i class="fa fa-check"></i><b>33.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="33.2.1" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-2"><i class="fa fa-check"></i><b>33.2.1</b> Tobit-2</a></li>
<li class="chapter" data-level="33.2.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-5"><i class="fa fa-check"></i><b>33.2.2</b> Tobit-5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>34</b> Other Biases</a>
<ul>
<li class="chapter" data-level="34.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html"><i class="fa fa-check"></i><b>34.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="34.1.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html#simpsons-paradox"><i class="fa fa-check"></i><b>34.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="contamination-bias.html"><a href="contamination-bias.html"><i class="fa fa-check"></i><b>34.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="34.3" data-path="survivorship-bias.html"><a href="survivorship-bias.html"><i class="fa fa-check"></i><b>34.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="34.4" data-path="publication-bias.html"><a href="publication-bias.html"><i class="fa fa-check"></i><b>34.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="controls.html"><a href="controls.html"><i class="fa fa-check"></i><b>35</b> Controls</a>
<ul>
<li class="chapter" data-level="35.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>35.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>35.1.1</b> M-bias</a></li>
<li class="chapter" data-level="35.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification"><i class="fa fa-check"></i><b>35.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="35.1.3" data-path="bad-controls.html"><a href="bad-controls.html#overcontrol-bias"><i class="fa fa-check"></i><b>35.1.3</b> Overcontrol bias</a></li>
<li class="chapter" data-level="35.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>35.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="35.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>35.1.5</b> Case-control Bias</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>35.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>35.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="35.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>35.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>35.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="35.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>35.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="35.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>35.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="35.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>35.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="35.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>35.3.4</b> Bad Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="35.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>35.4</b> Choosing Controls</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>36</b> Mediation</a>
<ul>
<li class="chapter" data-level="36.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>36.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-3"><i class="fa fa-check"></i><b>36.1.1</b> Assumptions</a></li>
<li class="chapter" data-level="36.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>36.1.2</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="36.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation"><i class="fa fa-check"></i><b>36.1.3</b> Multiple Mediation</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="causal-inference-approach.html"><a href="causal-inference-approach.html"><i class="fa fa-check"></i><b>36.2</b> Causal Inference Approach</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="causal-inference-approach.html"><a href="causal-inference-approach.html#example-1-mediation-traditional"><i class="fa fa-check"></i><b>36.2.1</b> Example 1</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="model-based-causal-mediation-analysis.html"><a href="model-based-causal-mediation-analysis.html"><i class="fa fa-check"></i><b>36.3</b> Model-based causal mediation analysis</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="directed-acyclic-graph.html"><a href="directed-acyclic-graph.html"><i class="fa fa-check"></i><b>37</b> Directed Acyclic Graph</a>
<ul>
<li class="chapter" data-level="37.1" data-path="basic-notations.html"><a href="basic-notations.html"><i class="fa fa-check"></i><b>37.1</b> Basic Notations</a></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="38" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>38</b> Report</a>
<ul>
<li class="chapter" data-level="38.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>38.1</b> One summary table</a></li>
<li class="chapter" data-level="38.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>38.2</b> Model Comparison</a></li>
<li class="chapter" data-level="38.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>38.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="38.4" data-path="standard-errors-3.html"><a href="standard-errors-3.html"><i class="fa fa-check"></i><b>38.4</b> Standard Errors</a></li>
<li class="chapter" data-level="38.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>38.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="38.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>38.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="38.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>38.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>39</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="40" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>40</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="40.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>40.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="40.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>40.1.1</b> starbility</a></li>
<li class="chapter" data-level="40.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>40.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="40.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>40.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="40.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>40.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>41</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="41.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>41.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="41.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>41.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="41.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>41.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="41.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>41.1.3</b> Exceptions to Replication</a></li>
</ul></li>
<li class="chapter" data-level="41.2" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html"><i class="fa fa-check"></i><b>41.2</b> Synthetic Data: An Overview</a>
<ul>
<li class="chapter" data-level="41.2.1" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#benefits"><i class="fa fa-check"></i><b>41.2.1</b> Benefits</a></li>
<li class="chapter" data-level="41.2.2" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#concerns"><i class="fa fa-check"></i><b>41.2.2</b> Concerns</a></li>
<li class="chapter" data-level="41.2.3" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>41.2.3</b> Further Insights on Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="application-16.html"><a href="application-16.html"><i class="fa fa-check"></i><b>41.3</b> Application</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packageslibaries-on-your-local-machine.html"><a href="install-all-necessary-packageslibaries-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="non-linear-least-squares" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Non-linear Least Squares<a href="non-linear-least-squares.html#non-linear-least-squares" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The LS estimate of <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\hat{\theta}\)</span> is the set of parameters that minimizes the residual sum of squares:<br />
<span class="math display">\[
S(\hat{\theta}) = SSE(\hat{\theta}) = \sum_{i=1}^{n}\{Y_i - f(\mathbf{x_i};\hat{\theta})\}^2
\]</span></li>
<li>to obtain the solution, we can consider the partial derivatives of <span class="math inline">\(S(\theta)\)</span> with respect to each <span class="math inline">\(\theta_j\)</span> and set them to 0, which gives a system of p equations. Each normal equation is <span class="math display">\[
\frac{\partial S(\theta)}{\partial \theta_j} = -2\sum_{i=1}^{n}\{Y_i -f(\mathbf{x}_i;\theta)\}[\frac{\partial(\mathbf{x}_i;\theta)}{\partial \theta_j}] = 0
\]</span></li>
<li>but we can’t obtain a solution directly/analytically for this equation.</li>
</ul>
<p><strong>Numerical Solutions</strong></p>
<ul>
<li><p>Grid search</p>
<ul>
<li>A “grid” of possible parameter values and see which one minimize the residual sum of squares.</li>
<li>finer grid = greater accuracy</li>
<li>could be inefficient, and hard when p is large.</li>
</ul></li>
<li><p>Gauss-Newton Algorithm</p>
<ul>
<li>we have an initial estimate of <span class="math inline">\(\theta\)</span> denoted as <span class="math inline">\(\hat{\theta}^{(0)}\)</span></li>
<li>use a Taylor expansions of <span class="math inline">\(f(\mathbf{x}_i;\theta)\)</span> as a function of <span class="math inline">\(\theta\)</span> about the point <span class="math inline">\(\hat{\theta}^{(0)}\)</span></li>
</ul></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
Y_i &amp;= f(x_i;\theta) + \epsilon_i \\
&amp;= f(x_i;\theta) + \sum_{j=1}^{p}\{\frac{\partial f(x_i;\theta)}{\partial \theta_j}\}_{\theta = \hat{\theta}^{(0)}} (\theta_j - \hat{\theta}^{(0)}) + \text{remainder} + \epsilon_i
\end{aligned}
\]</span></p>
<p>Equivalently,</p>
<p>In matrix notation,</p>
<p><span class="math display">\[
\mathbf{Y} =
\left[
\begin{array}
{c}
Y_1 \\
. \\
Y_n
\end{array}
\right]
\]</span></p>
<p><span class="math display">\[
\mathbf{f}(\hat{\theta}^{(0)}) =
\left[
\begin{array}
{c}
f(\mathbf{x_1,\hat{\theta}}^{(0)}) \\
. \\
f(\mathbf{x_n,\hat{\theta}}^{(0)})
\end{array}
\right]
\]</span></p>
<p><span class="math display">\[
\mathbf{\epsilon} =
\left[
\begin{array}
{c}
\epsilon_1 \\
. \\
\epsilon_n
\end{array}
\right]
\]</span></p>
<p><span class="math display">\[
\mathbf{F}(\hat{\theta}^{(0)}) =
\left[
\begin{array}
{ccc}
\frac{\partial f(x_1,\mathbf{\theta})}{\partial \theta_1} &amp; ... &amp; \frac{\partial f(x_1,\mathbf{\theta})}{\partial \theta_p}\\
. &amp; . &amp; . \\
\frac{\partial f(x_n,\mathbf{\theta})}{\partial \theta_1} &amp; ... &amp; \frac{\partial f(x_n,\mathbf{\theta})}{\partial \theta_p}
\end{array} \right]_{\theta = \hat{\theta}^{(0)}}
\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[
\mathbf{Y} = \mathbf{f}(\hat{\theta}^{(0)}) + \mathbf{F}(\hat{\theta}^{(0)})(\theta - \hat{\theta}^{(0)}) + \epsilon + \text{remainder}
\]</span></p>
<p>where we assume that the remainder is small and the error term is only assumed to be iid with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>We can rewrite the above equation as</p>
<p><span class="math display">\[
\mathbf{Y} - \mathbf{f}(\hat{\theta}^{(0)}) \approx \mathbf{F}(\hat{\theta}^{(0)})(\theta - \hat{\theta}^{(0)}) + \epsilon
\]</span></p>
<p>where it is in the form of linear model. After we solve for <span class="math inline">\((\theta - \hat{\theta}^{(0)})\)</span> and let it equal to <span class="math inline">\(\hat{\delta}^{(1)}\)</span><br />
Then we new estimate is given by adding the Gauss increment adjustment to the initial estimate <span class="math inline">\(\hat{\theta}^{(1)} = \hat{\theta}^{(0)} + \hat{\delta}^{(1)}\)</span><br />
We can repeat this process.</p>
<p>Gauss-Newton Algorithm Steps:</p>
<ol style="list-style-type: decimal">
<li>initial estimate <span class="math inline">\(\hat{\theta}^{(0)}\)</span>, set j = 0</li>
<li>Taylor series expansion and calculate <span class="math inline">\(\mathbf{f}(\hat{\theta}^{(j)})\)</span> and <span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span></li>
<li>Use OLS to get <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span></li>
<li>get the new estimate <span class="math inline">\(\hat{\theta}^{(j+1)}\)</span>, return to step 2</li>
<li>continue until “convergence”</li>
<li>With the final parameter estimate <span class="math inline">\(\hat{\theta}\)</span>, we can estimate <span class="math inline">\(\sigma^2\)</span> if <span class="math inline">\(\epsilon \sim (\mathbf{0}, \sigma^2 \mathbf{I})\)</span> by</li>
</ol>
<p><span class="math display">\[
\hat{\sigma}^2= \frac{1}{n-p}(\mathbf{Y}-\mathbf{f}(x;\hat{\theta}))&#39;(\mathbf{Y}-\mathbf{f}(x;\hat{\theta}))
\]</span></p>
<p><strong>Criteria for convergence</strong></p>
<ol style="list-style-type: decimal">
<li>Minor change in the objective function (SSE = residual sum of squares)<br />
<span class="math display">\[
\frac{|SSE(\hat{\theta}^{(j+1)})-SSE(\hat{\theta}^{(j)})|}{SSE(\hat{\theta}^{(j)})} &lt; \gamma_1
\]</span></li>
<li>Minor change in the parameter estimates<br />
<span class="math display">\[
|\hat{\theta}^{(j+1)}-\hat{\theta}^{(j)}| &lt; \gamma_2
\]</span></li>
<li>“residual projection” criterion of <span class="citation">(<a href="#ref-bates1981relative">Bates and Watts 1981</a>)</span></li>
</ol>
<div id="alternative-of-gauss-newton-algorithm" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Alternative of Gauss-Newton Algorithm<a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="gauss-newton-algorithm" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Gauss-Newton Algorithm<a href="non-linear-least-squares.html#gauss-newton-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Normal equations:</p>
<p><span class="math display">\[
\frac{\partial SSE(\theta)}{\partial \theta} = 2\mathbf{F}(\theta)&#39;[\mathbf{Y}-\mathbf{f}(\theta)]
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\hat{\theta}^{(j+1)} &amp;= \hat{\theta}^{(j)} + \hat{\delta}^{(j+1)} \\
&amp;= \hat{\theta}^{(j)} + [\mathbf{F}((\hat{\theta})^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})]^{-1}\mathbf{F}(\hat{\theta})^{(j)} \\
&amp;= \hat{\theta}^{(j)} - \frac{1}{2}[\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})]^{-1}\frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta}
\end{aligned}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta}\)</span> is a gradient vector (points in the direction in which the SSE increases most rapidly). This path is known as steepest ascent.<br />
</li>
<li><span class="math inline">\([\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})]^{-1}\)</span> indicates how far to move<br />
</li>
<li><span class="math inline">\(-1/2\)</span>: indicator of the direction of steepest descent.</li>
</ul>
</div>
<div id="modified-gauss-newton-algorithm" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Modified Gauss-Newton Algorithm<a href="non-linear-least-squares.html#modified-gauss-newton-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To avoid overstepping (the local min), we can use the modified Gauss-Newton Algorithm. We define a new proposal for <span class="math inline">\(\theta\)</span></p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} + \alpha_j \hat{\delta}^{(j+1)}, 0 &lt; \alpha_j &lt; 1
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\alpha_j\)</span> (called the “learning rate”): is used to modify the step length.</li>
</ul>
<p>We could also have <span class="math inline">\(\alpha \times 1/2\)</span>, but typically it is assumed to be absorbed into the learning rate.</p>
<p>A way to choose <span class="math inline">\(\alpha_j\)</span>, we can use <strong>step halving</strong></p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} + \frac{1}{2^k}\hat{\delta}^{(j+1)}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(k\)</span> is the smallest non-negative integer such that<br />
<span class="math display">\[
SSE(\hat{\theta}^{(j)}+\frac{1}{2^k}\hat{\delta}^{(j+1)}) &lt; SSE(\hat{\theta}^{(j)})
\]</span> which means we try <span class="math inline">\(\hat{\delta}^{(j+1)}\)</span>, then <span class="math inline">\(\hat{\delta}^{(j+1)}/2\)</span>, <span class="math inline">\(\hat{\delta}^{(j+1)}/4\)</span>, etc.</li>
</ul>
<p>The most general form of the convergence algorithm is</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{A}_j \frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\mathbf{A}_j\)</span> is a positive definite matrix</li>
<li><span class="math inline">\(\alpha_j\)</span> is the learning rate</li>
<li><span class="math inline">\(\frac{\partial Q(\hat{\theta}^{(j)})}{\partial \theta}\)</span>is the gradient based on some objective function Q (a function of <span class="math inline">\(\theta\)</span>), which is typically the SSE in nonlinear regression applications (e.g., cross-entropy for classification).</li>
</ul>
<p>Refer back to the <strong>Modified Gauss-Newton Algorithm</strong>, we can see it is in this form</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} =\hat{\theta}^{(j)} - \alpha_j[\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})]^{-1}\frac{\partial SSE(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where Q = SSE, <span class="math inline">\([\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})]^{-1} = \mathbf{A}\)</span></p>
</div>
<div id="steepest-descent" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> Steepest Descent<a href="non-linear-least-squares.html#steepest-descent" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>(also known just “gradient descent”)</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{I}_{p \times p}\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<ul>
<li>slow to converge, moves rapidly initially.</li>
<li>could be use for starting values</li>
</ul>
</div>
<div id="levenberg--marquardt" class="section level4 hasAnchor" number="6.2.1.4">
<h4><span class="header-section-number">6.2.1.4</span> Levenberg -Marquardt<a href="non-linear-least-squares.html#levenberg--marquardt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j [\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})+ \tau \mathbf{I}_{p \times p}]\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>which is a compromise between the <a href="non-linear-least-squares.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a> and the <a href="non-linear-least-squares.html#steepest-descent">Steepest Descent</a>.</p>
<ul>
<li>best when <span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})&#39;\mathbf{F}(\hat{\theta}^{(j)})\)</span> is nearly singular (<span class="math inline">\(\mathbf{F}(\hat{\theta}^{(j)})\)</span> isn’t of full rank)<br />
</li>
<li>similar to ridge regression<br />
</li>
<li>If <span class="math inline">\(SSE(\hat{\theta}^{(j+1)}) &lt; SSE(\hat{\theta}^{(j)})\)</span>, then <span class="math inline">\(\tau= \tau/10\)</span> for the next iteration. Otherwise, <span class="math inline">\(\tau = 10 \tau\)</span></li>
</ul>
</div>
<div id="newton-raphson" class="section level4 hasAnchor" number="6.2.1.5">
<h4><span class="header-section-number">6.2.1.5</span> Newton-Raphson<a href="non-linear-least-squares.html#newton-raphson" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j [\frac{\partial^2Q(\hat{\theta}^{(j)})}{\partial \theta \partial \theta&#39;}]^{-1}\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>The <strong>Hessian matrix</strong> can be rewritten as:</p>
<p><span class="math display">\[
\frac{ \partial^2Q(\hat{ \theta}^{(j)})}{ \partial \theta \partial \theta&#39;} = 2 \mathbf{F}((\hat{ \theta})^{(j)})&#39; \mathbf{F} ( \hat{\theta}^{(j)}) - 2\sum_{i=1}^{n} [Y_i - f(x_i;\theta)] \frac{\partial^2f(x_i;\theta)}{\partial \theta \partial \theta&#39;}
\]</span></p>
<p>which contains the same term that <a href="non-linear-least-squares.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a>, combined with one containing the second partial derivatives of f(). (methods that require the second derivatives of the objective function are known as “second-order methods”.)<br />
However, the last term <span class="math inline">\(\frac{\partial^2f(x_i;\theta)}{\partial \theta \partial \theta&#39;}\)</span> can sometimes be non-singular.</p>
</div>
<div id="quasi-newton" class="section level4 hasAnchor" number="6.2.1.6">
<h4><span class="header-section-number">6.2.1.6</span> Quasi-Newton<a href="non-linear-least-squares.html#quasi-newton" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>update <span class="math inline">\(\theta\)</span> according to</p>
<p><span class="math display">\[
\hat{\theta}^{(j+1)} = \hat{\theta}^{(j)} - \alpha_j \mathbf{H}_j^{-1}\frac{\partial \mathbf{Q}(\hat{\theta}^{(j)})}{\partial \theta}
\]</span></p>
<p>where <span class="math inline">\(H_j\)</span> is a symmetric positive definite approximation to the Hessian, which gets closer as <span class="math inline">\(j \to \infty\)</span>.</p>
<ul>
<li><span class="math inline">\(\mathbf{H}_j\)</span> is computed iteratively<br />
</li>
<li>Among first-order methods (where only first derivatives are required), this method performs best.</li>
</ul>
</div>
<div id="derivative-free-methods" class="section level4 hasAnchor" number="6.2.1.7">
<h4><span class="header-section-number">6.2.1.7</span> Derivative Free Methods<a href="non-linear-least-squares.html#derivative-free-methods" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>secant Method</strong>: like <a href="non-linear-least-squares.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a>, but calculates the derivatives numerically from past iterations.</li>
<li><strong>Simplex Methods</strong></li>
<li><strong>Genetic Algorithm</strong></li>
<li><strong>Differential Evolution Algorithms</strong></li>
<li><strong>Particle Swarm Optimization</strong></li>
<li><strong>Ant Colony Optimization</strong></li>
</ul>
</div>
</div>
<div id="practical-considerations" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Practical Considerations<a href="non-linear-least-squares.html#practical-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To converge, algorithm need good initial estimates.</p>
<ul>
<li><p>Starting values:</p>
<ul>
<li>Prior or theoretical info</li>
<li>A grid search or a graph of <span class="math inline">\(SSE(\theta)\)</span></li>
<li>could also use OLS to get starting values.</li>
<li>Model interpretation: if you have some idea regarding the form of the objective function, then you can try to guess the initial value.</li>
<li>Expected Value Parameterization</li>
</ul></li>
<li><p>Constrained Parameters: (constraints on parameters like <span class="math inline">\(\theta_i&gt;a,a&lt; \theta_i &lt;b\)</span>)</p>
<ul>
<li>fit the model first to see if the converged parameter estimates satisfy the constraints.</li>
<li>if they don’t satisfy, then try re-parameterizing</li>
</ul></li>
</ul>
<div id="failure-to-converge" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Failure to converge<a href="non-linear-least-squares.html#failure-to-converge" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(SSE(\theta)\)</span> may be “flat” in a neighborhood of the minimum.</li>
<li>You can try different or “better” starting values.</li>
<li>Might suggest the model is too complex for the data, might consider simpler model.</li>
</ul>
</div>
<div id="convergence-to-a-local-minimum" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Convergence to a Local Minimum<a href="non-linear-least-squares.html#convergence-to-a-local-minimum" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Linear least squares has the property that <span class="math inline">\(SSE(\theta) = \mathbf{(Y-X\beta)&#39;(Y-X\beta)}\)</span>, which is quadratic and has a unique minimum (or maximum).</li>
<li>Nonlinear east squares need not have a unique minimum</li>
<li>Using different starting values can help</li>
<li>If the dimension of <span class="math inline">\(\theta\)</span> is low, graph <span class="math inline">\(SSE(\theta)\)</span> as a function of <span class="math inline">\(\theta_i\)</span></li>
<li>Different algorithm can help (e.g., genetic algorithm, particle swarm)</li>
</ul>
<p>To converge, algorithms need good initial estimates.</p>
<ul>
<li><p>Starting values:</p>
<ul>
<li>prior or theoretical info</li>
<li>A grid search or a graph</li>
<li>OLS estimates as starting values</li>
<li>Model interpretation</li>
<li>Expected Value Parameterization</li>
</ul></li>
<li><p>Constrained Parameters:</p>
<ul>
<li>try the model without the constraints first.</li>
<li>If the resulted parameter estimates does not satisfy the constraint, try re-parameterizing</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="non-linear-least-squares.html#cb108-1" tabindex="-1"></a><span class="co"># Grid search</span></span>
<span id="cb108-2"><a href="non-linear-least-squares.html#cb108-2" tabindex="-1"></a><span class="co"># choose grid of a and b values</span></span>
<span id="cb108-3"><a href="non-linear-least-squares.html#cb108-3" tabindex="-1"></a>aseq <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">18</span>,.<span class="dv">2</span>)</span>
<span id="cb108-4"><a href="non-linear-least-squares.html#cb108-4" tabindex="-1"></a>bseq <span class="ot">=</span> <span class="fu">seq</span>(.<span class="dv">001</span>,.<span class="dv">075</span>,.<span class="dv">001</span>)</span>
<span id="cb108-5"><a href="non-linear-least-squares.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="non-linear-least-squares.html#cb108-6" tabindex="-1"></a>na <span class="ot">=</span> <span class="fu">length</span>(aseq)</span>
<span id="cb108-7"><a href="non-linear-least-squares.html#cb108-7" tabindex="-1"></a>nb <span class="ot">=</span> <span class="fu">length</span>(bseq)</span>
<span id="cb108-8"><a href="non-linear-least-squares.html#cb108-8" tabindex="-1"></a>SSout <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,na<span class="sc">*</span>nb,<span class="dv">3</span>) <span class="co">#matrix to save output</span></span>
<span id="cb108-9"><a href="non-linear-least-squares.html#cb108-9" tabindex="-1"></a>cnt <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb108-10"><a href="non-linear-least-squares.html#cb108-10" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>na){</span>
<span id="cb108-11"><a href="non-linear-least-squares.html#cb108-11" tabindex="-1"></a>   <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb){</span>
<span id="cb108-12"><a href="non-linear-least-squares.html#cb108-12" tabindex="-1"></a>      cnt <span class="ot">=</span> cnt<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb108-13"><a href="non-linear-least-squares.html#cb108-13" tabindex="-1"></a>      ypred <span class="ot">=</span> <span class="fu">mod</span>(aseq[k],bseq[j],x) <span class="co">#evaluate model w/ these parms</span></span>
<span id="cb108-14"><a href="non-linear-least-squares.html#cb108-14" tabindex="-1"></a>      ss <span class="ot">=</span> <span class="fu">sum</span>((y<span class="sc">-</span>ypred)<span class="sc">^</span><span class="dv">2</span>)  <span class="co">#this is our SSE objective function</span></span>
<span id="cb108-15"><a href="non-linear-least-squares.html#cb108-15" tabindex="-1"></a>      <span class="co">#save values of a, b, and SSE</span></span>
<span id="cb108-16"><a href="non-linear-least-squares.html#cb108-16" tabindex="-1"></a>      SSout[cnt,<span class="dv">1</span>]<span class="ot">=</span>aseq[k]</span>
<span id="cb108-17"><a href="non-linear-least-squares.html#cb108-17" tabindex="-1"></a>      SSout[cnt,<span class="dv">2</span>]<span class="ot">=</span>bseq[j]</span>
<span id="cb108-18"><a href="non-linear-least-squares.html#cb108-18" tabindex="-1"></a>      SSout[cnt,<span class="dv">3</span>]<span class="ot">=</span>ss</span>
<span id="cb108-19"><a href="non-linear-least-squares.html#cb108-19" tabindex="-1"></a>   }</span>
<span id="cb108-20"><a href="non-linear-least-squares.html#cb108-20" tabindex="-1"></a>}</span>
<span id="cb108-21"><a href="non-linear-least-squares.html#cb108-21" tabindex="-1"></a><span class="co">#find minimum SSE and associated a,b values</span></span>
<span id="cb108-22"><a href="non-linear-least-squares.html#cb108-22" tabindex="-1"></a>mn_indx <span class="ot">=</span> <span class="fu">which.min</span>(SSout[,<span class="dv">3</span>])</span>
<span id="cb108-23"><a href="non-linear-least-squares.html#cb108-23" tabindex="-1"></a>astrt <span class="ot">=</span> SSout[mn_indx,<span class="dv">1</span>]</span>
<span id="cb108-24"><a href="non-linear-least-squares.html#cb108-24" tabindex="-1"></a>bstrt <span class="ot">=</span> SSout[mn_indx,<span class="dv">2</span>]</span>
<span id="cb108-25"><a href="non-linear-least-squares.html#cb108-25" tabindex="-1"></a><span class="co">#now, run nls function with these starting values</span></span>
<span id="cb108-26"><a href="non-linear-least-squares.html#cb108-26" tabindex="-1"></a>nlin_modG<span class="ot">=</span><span class="fu">nls</span>(y<span class="sc">~</span><span class="fu">mod</span>(a,b,x),<span class="at">start=</span><span class="fu">list</span>(<span class="at">a=</span>astrt,<span class="at">b=</span>bstrt)) </span>
<span id="cb108-27"><a href="non-linear-least-squares.html#cb108-27" tabindex="-1"></a></span>
<span id="cb108-28"><a href="non-linear-least-squares.html#cb108-28" tabindex="-1"></a>nlin_modG</span>
<span id="cb108-29"><a href="non-linear-least-squares.html#cb108-29" tabindex="-1"></a><span class="co">#&gt; Nonlinear regression model</span></span>
<span id="cb108-30"><a href="non-linear-least-squares.html#cb108-30" tabindex="-1"></a><span class="co">#&gt;   model: y ~ mod(a, b, x)</span></span>
<span id="cb108-31"><a href="non-linear-least-squares.html#cb108-31" tabindex="-1"></a><span class="co">#&gt;    data: parent.frame()</span></span>
<span id="cb108-32"><a href="non-linear-least-squares.html#cb108-32" tabindex="-1"></a><span class="co">#&gt;        a        b </span></span>
<span id="cb108-33"><a href="non-linear-least-squares.html#cb108-33" tabindex="-1"></a><span class="co">#&gt; 13.60391  0.01911 </span></span>
<span id="cb108-34"><a href="non-linear-least-squares.html#cb108-34" tabindex="-1"></a><span class="co">#&gt;  residual sum-of-squares: 235.5</span></span>
<span id="cb108-35"><a href="non-linear-least-squares.html#cb108-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb108-36"><a href="non-linear-least-squares.html#cb108-36" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 3 </span></span>
<span id="cb108-37"><a href="non-linear-least-squares.html#cb108-37" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 2.293e-07</span></span>
<span id="cb108-38"><a href="non-linear-least-squares.html#cb108-38" tabindex="-1"></a><span class="co"># Note, the package `nls_multstart` will allow you </span></span>
<span id="cb108-39"><a href="non-linear-least-squares.html#cb108-39" tabindex="-1"></a><span class="co"># to do a grid search without programming your own loop</span></span></code></pre></div>
<p>For prediction interval</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="non-linear-least-squares.html#cb109-1" tabindex="-1"></a><span class="fu">plotFit</span>(</span>
<span id="cb109-2"><a href="non-linear-least-squares.html#cb109-2" tabindex="-1"></a>  nlin_modG,</span>
<span id="cb109-3"><a href="non-linear-least-squares.html#cb109-3" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb109-4"><a href="non-linear-least-squares.html#cb109-4" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb109-5"><a href="non-linear-least-squares.html#cb109-5" tabindex="-1"></a>  <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb109-6"><a href="non-linear-least-squares.html#cb109-6" tabindex="-1"></a>  <span class="at">col.conf =</span> <span class="st">&quot;skyblue4&quot;</span>,</span>
<span id="cb109-7"><a href="non-linear-least-squares.html#cb109-7" tabindex="-1"></a>  <span class="at">col.pred =</span> <span class="st">&quot;lightskyblue2&quot;</span>,</span>
<span id="cb109-8"><a href="non-linear-least-squares.html#cb109-8" tabindex="-1"></a>  <span class="at">data =</span> datf</span>
<span id="cb109-9"><a href="non-linear-least-squares.html#cb109-9" tabindex="-1"></a>)  </span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-5-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Based on the forms of your function, you can also have programmed starting values from <code>nls</code> function (e.e.g, logistic growth, asymptotic regression, etc).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="non-linear-least-squares.html#cb110-1" tabindex="-1"></a><span class="fu">apropos</span>(<span class="st">&quot;^SS&quot;</span>)</span>
<span id="cb110-2"><a href="non-linear-least-squares.html#cb110-2" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;ss&quot;          &quot;SSasymp&quot;     &quot;SSasympOff&quot;  &quot;SSasympOrig&quot; &quot;SSbiexp&quot;    </span></span>
<span id="cb110-3"><a href="non-linear-least-squares.html#cb110-3" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;SSD&quot;         &quot;SSfol&quot;       &quot;SSfpl&quot;       &quot;SSgompertz&quot;  &quot;SSlogis&quot;    </span></span>
<span id="cb110-4"><a href="non-linear-least-squares.html#cb110-4" tabindex="-1"></a><span class="co">#&gt; [11] &quot;SSmicmen&quot;    &quot;SSout&quot;       &quot;SSweibull&quot;</span></span></code></pre></div>
<p>For example, a logistic growth model:</p>
<p><span class="math display">\[
P = \frac{K}{1+ exp(P_0+ rt)} + \epsilon
\]</span></p>
<p>where</p>
<ul>
<li>P = population at time t</li>
<li>K = carrying capacity</li>
<li>r = population growth rate</li>
</ul>
<p>but in <code>R</code> you have slight different parameterization:</p>
<p><span class="math display">\[
P = \frac{asym}{1 + exp(\frac{xmid - t}{scal})}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(asym\)</span> = carrying capacity</li>
<li><span class="math inline">\(xmid\)</span> = the x value at the inflection point of the curve</li>
<li><span class="math inline">\(scal\)</span> = scaling parameter.</li>
</ul>
<p>Hence, you have</p>
<ul>
<li><span class="math inline">\(K = asym\)</span></li>
<li><span class="math inline">\(r = -1/scal\)</span></li>
<li><span class="math inline">\(P_0 = -rxmid\)</span></li>
</ul>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="non-linear-least-squares.html#cb111-1" tabindex="-1"></a><span class="co"># simulated data</span></span>
<span id="cb111-2"><a href="non-linear-least-squares.html#cb111-2" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>)</span>
<span id="cb111-3"><a href="non-linear-least-squares.html#cb111-3" tabindex="-1"></a>population <span class="ot">&lt;-</span></span>
<span id="cb111-4"><a href="non-linear-least-squares.html#cb111-4" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">2.8</span>, <span class="fl">4.2</span>, <span class="fl">3.5</span>, <span class="fl">6.3</span>, <span class="fl">15.7</span>, <span class="fl">21.3</span>, <span class="fl">23.7</span>, <span class="fl">25.1</span>, <span class="fl">25.8</span>, <span class="fl">25.9</span>)</span>
<span id="cb111-5"><a href="non-linear-least-squares.html#cb111-5" tabindex="-1"></a><span class="fu">plot</span>(time, population, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="non-linear-least-squares.html#cb112-1" tabindex="-1"></a></span>
<span id="cb112-2"><a href="non-linear-least-squares.html#cb112-2" tabindex="-1"></a><span class="co"># model fitting</span></span>
<span id="cb112-3"><a href="non-linear-least-squares.html#cb112-3" tabindex="-1"></a>logisticModelSS <span class="ot">&lt;-</span> <span class="fu">nls</span>(population <span class="sc">~</span> <span class="fu">SSlogis</span>(time, Asym, xmid, scal))</span>
<span id="cb112-4"><a href="non-linear-least-squares.html#cb112-4" tabindex="-1"></a><span class="fu">summary</span>(logisticModelSS)</span>
<span id="cb112-5"><a href="non-linear-least-squares.html#cb112-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-6"><a href="non-linear-least-squares.html#cb112-6" tabindex="-1"></a><span class="co">#&gt; Formula: population ~ SSlogis(time, Asym, xmid, scal)</span></span>
<span id="cb112-7"><a href="non-linear-least-squares.html#cb112-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-8"><a href="non-linear-least-squares.html#cb112-8" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb112-9"><a href="non-linear-least-squares.html#cb112-9" tabindex="-1"></a><span class="co">#&gt;      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb112-10"><a href="non-linear-least-squares.html#cb112-10" tabindex="-1"></a><span class="co">#&gt; Asym  25.5029     0.3666   69.56 3.34e-11 ***</span></span>
<span id="cb112-11"><a href="non-linear-least-squares.html#cb112-11" tabindex="-1"></a><span class="co">#&gt; xmid   8.7347     0.3007   29.05 1.48e-08 ***</span></span>
<span id="cb112-12"><a href="non-linear-least-squares.html#cb112-12" tabindex="-1"></a><span class="co">#&gt; scal   3.6353     0.2186   16.63 6.96e-07 ***</span></span>
<span id="cb112-13"><a href="non-linear-least-squares.html#cb112-13" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb112-14"><a href="non-linear-least-squares.html#cb112-14" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb112-15"><a href="non-linear-least-squares.html#cb112-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-16"><a href="non-linear-least-squares.html#cb112-16" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6528 on 7 degrees of freedom</span></span>
<span id="cb112-17"><a href="non-linear-least-squares.html#cb112-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-18"><a href="non-linear-least-squares.html#cb112-18" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 1 </span></span>
<span id="cb112-19"><a href="non-linear-least-squares.html#cb112-19" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 1.908e-06</span></span>
<span id="cb112-20"><a href="non-linear-least-squares.html#cb112-20" tabindex="-1"></a><span class="fu">coef</span>(logisticModelSS)</span>
<span id="cb112-21"><a href="non-linear-least-squares.html#cb112-21" tabindex="-1"></a><span class="co">#&gt;      Asym      xmid      scal </span></span>
<span id="cb112-22"><a href="non-linear-least-squares.html#cb112-22" tabindex="-1"></a><span class="co">#&gt; 25.502890  8.734698  3.635333</span></span></code></pre></div>
<p>Other parameterization</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="non-linear-least-squares.html#cb113-1" tabindex="-1"></a><span class="co">#convert to other parameterization</span></span>
<span id="cb113-2"><a href="non-linear-least-squares.html#cb113-2" tabindex="-1"></a>Ks <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(logisticModelSS)[<span class="dv">1</span>])</span>
<span id="cb113-3"><a href="non-linear-least-squares.html#cb113-3" tabindex="-1"></a>rs <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(logisticModelSS)[<span class="dv">3</span>])</span>
<span id="cb113-4"><a href="non-linear-least-squares.html#cb113-4" tabindex="-1"></a>Pos <span class="ot">=</span> <span class="sc">-</span>rs <span class="sc">*</span> <span class="fu">as.numeric</span>(<span class="fu">coef</span>(logisticModelSS)[<span class="dv">2</span>])</span>
<span id="cb113-5"><a href="non-linear-least-squares.html#cb113-5" tabindex="-1"></a><span class="co">#let&#39;s refit with these parameters</span></span>
<span id="cb113-6"><a href="non-linear-least-squares.html#cb113-6" tabindex="-1"></a>logisticModel <span class="ot">&lt;-</span></span>
<span id="cb113-7"><a href="non-linear-least-squares.html#cb113-7" tabindex="-1"></a>    <span class="fu">nls</span>(population <span class="sc">~</span> K <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(Po <span class="sc">+</span> r <span class="sc">*</span> time)),</span>
<span id="cb113-8"><a href="non-linear-least-squares.html#cb113-8" tabindex="-1"></a>        <span class="at">start =</span> <span class="fu">list</span>(<span class="at">Po =</span> Pos, <span class="at">r =</span> rs, <span class="at">K =</span> Ks))</span>
<span id="cb113-9"><a href="non-linear-least-squares.html#cb113-9" tabindex="-1"></a><span class="fu">summary</span>(logisticModel)</span>
<span id="cb113-10"><a href="non-linear-least-squares.html#cb113-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-11"><a href="non-linear-least-squares.html#cb113-11" tabindex="-1"></a><span class="co">#&gt; Formula: population ~ K/(1 + exp(Po + r * time))</span></span>
<span id="cb113-12"><a href="non-linear-least-squares.html#cb113-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-13"><a href="non-linear-least-squares.html#cb113-13" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb113-14"><a href="non-linear-least-squares.html#cb113-14" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb113-15"><a href="non-linear-least-squares.html#cb113-15" tabindex="-1"></a><span class="co">#&gt; Po  2.40272    0.12702   18.92 2.87e-07 ***</span></span>
<span id="cb113-16"><a href="non-linear-least-squares.html#cb113-16" tabindex="-1"></a><span class="co">#&gt; r  -0.27508    0.01654  -16.63 6.96e-07 ***</span></span>
<span id="cb113-17"><a href="non-linear-least-squares.html#cb113-17" tabindex="-1"></a><span class="co">#&gt; K  25.50289    0.36665   69.56 3.34e-11 ***</span></span>
<span id="cb113-18"><a href="non-linear-least-squares.html#cb113-18" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb113-19"><a href="non-linear-least-squares.html#cb113-19" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb113-20"><a href="non-linear-least-squares.html#cb113-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-21"><a href="non-linear-least-squares.html#cb113-21" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6528 on 7 degrees of freedom</span></span>
<span id="cb113-22"><a href="non-linear-least-squares.html#cb113-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb113-23"><a href="non-linear-least-squares.html#cb113-23" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 0 </span></span>
<span id="cb113-24"><a href="non-linear-least-squares.html#cb113-24" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 1.924e-06</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="non-linear-least-squares.html#cb114-1" tabindex="-1"></a><span class="co">#note: initial values =  solution (highly unusual, but ok)</span></span>
<span id="cb114-2"><a href="non-linear-least-squares.html#cb114-2" tabindex="-1"></a><span class="fu">plot</span>(time, population, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb114-3"><a href="non-linear-least-squares.html#cb114-3" tabindex="-1"></a><span class="fu">lines</span>(time, <span class="fu">predict</span>(logisticModel), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>If can also define your own self-starting function if your models are uncommon (built in <code>nls</code>)</p>
<p>Example is based on <span class="citation">(<a href="#ref-Schabenberger_2001">Schabenberger and Pierce 2001</a>)</span></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="non-linear-least-squares.html#cb115-1" tabindex="-1"></a><span class="co">#Load data</span></span>
<span id="cb115-2"><a href="non-linear-least-squares.html#cb115-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;images/dat.txt&quot;</span>, <span class="at">header =</span> T)</span>
<span id="cb115-3"><a href="non-linear-least-squares.html#cb115-3" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb115-4"><a href="non-linear-least-squares.html#cb115-4" tabindex="-1"></a>dat.plot <span class="ot">&lt;-</span></span>
<span id="cb115-5"><a href="non-linear-least-squares.html#cb115-5" tabindex="-1"></a>    <span class="fu">ggplot</span>(dat) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(</span>
<span id="cb115-6"><a href="non-linear-least-squares.html#cb115-6" tabindex="-1"></a>        <span class="at">x =</span> no3,</span>
<span id="cb115-7"><a href="non-linear-least-squares.html#cb115-7" tabindex="-1"></a>        <span class="at">y =</span> ryp,</span>
<span id="cb115-8"><a href="non-linear-least-squares.html#cb115-8" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">as.factor</span>(depth)</span>
<span id="cb115-9"><a href="non-linear-least-squares.html#cb115-9" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb115-10"><a href="non-linear-least-squares.html#cb115-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&#39;Depth (cm)&#39;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&#39;Soil NO3&#39;</span>) <span class="sc">+</span> </span>
<span id="cb115-11"><a href="non-linear-least-squares.html#cb115-11" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&#39;relative yield percent&#39;</span>)</span>
<span id="cb115-12"><a href="non-linear-least-squares.html#cb115-12" tabindex="-1"></a></span>
<span id="cb115-13"><a href="non-linear-least-squares.html#cb115-13" tabindex="-1"></a>dat.plot</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The suggested model (known as plateau model) is</p>
<p><span class="math display">\[
E(Y_{ij}) = (\beta_{0j} + \beta_{1j}N_{ij})I_{N_{ij}\le \alpha_j} + (\beta_{0j} + \beta_{1j}\alpha_j)I_{N_{ij} &gt; \alpha_j}
\]</span></p>
<p>where</p>
<ul>
<li>N is an observation</li>
<li>i is a particular observation</li>
<li>j = 1,2 corresponding to depths (30,60)</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="non-linear-least-squares.html#cb116-1" tabindex="-1"></a><span class="co">#First define model as a function</span></span>
<span id="cb116-2"><a href="non-linear-least-squares.html#cb116-2" tabindex="-1"></a>nonlinModel <span class="ot">&lt;-</span> <span class="cf">function</span>(predictor, b0, b1, alpha) {</span>
<span id="cb116-3"><a href="non-linear-least-squares.html#cb116-3" tabindex="-1"></a>    <span class="fu">ifelse</span>(predictor <span class="sc">&lt;=</span> alpha,</span>
<span id="cb116-4"><a href="non-linear-least-squares.html#cb116-4" tabindex="-1"></a>           <span class="co">#if observation less than cutoff simple linear model</span></span>
<span id="cb116-5"><a href="non-linear-least-squares.html#cb116-5" tabindex="-1"></a>           b0 <span class="sc">+</span> b1 <span class="sc">*</span> predictor, </span>
<span id="cb116-6"><a href="non-linear-least-squares.html#cb116-6" tabindex="-1"></a>           b0 <span class="sc">+</span> b1 <span class="sc">*</span> alpha) <span class="co">#otherwise flat line</span></span>
<span id="cb116-7"><a href="non-linear-least-squares.html#cb116-7" tabindex="-1"></a>}</span></code></pre></div>
<p>define <code>selfStart</code> function. Because we defined our model to be linear in the first part and then plateau (remain constant) we can use the first half of our predictors (sorted by increasing value) to get an initial estimate for the slope and intercept of the model, and the last predictor value (alpha) can be the starting value for the plateau parameter.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="non-linear-least-squares.html#cb117-1" tabindex="-1"></a>nonlinModelInit <span class="ot">&lt;-</span> <span class="cf">function</span>(mCall, LHS, data) {</span>
<span id="cb117-2"><a href="non-linear-least-squares.html#cb117-2" tabindex="-1"></a>    <span class="co"># sort data by increasing predictor value -</span></span>
<span id="cb117-3"><a href="non-linear-least-squares.html#cb117-3" tabindex="-1"></a>    <span class="co"># done so we can just use the low level </span></span>
<span id="cb117-4"><a href="non-linear-least-squares.html#cb117-4" tabindex="-1"></a>    <span class="co"># no3 conc to fit a simple model</span></span>
<span id="cb117-5"><a href="non-linear-least-squares.html#cb117-5" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sortedXyData</span>(mCall[[<span class="st">&#39;predictor&#39;</span>]], LHS, data)</span>
<span id="cb117-6"><a href="non-linear-least-squares.html#cb117-6" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(xy)</span>
<span id="cb117-7"><a href="non-linear-least-squares.html#cb117-7" tabindex="-1"></a>    <span class="co">#For the first half of the data a simple linear model is fit</span></span>
<span id="cb117-8"><a href="non-linear-least-squares.html#cb117-8" tabindex="-1"></a>    lmFit <span class="ot">&lt;-</span> <span class="fu">lm</span>(xy[<span class="dv">1</span><span class="sc">:</span>(n <span class="sc">/</span> <span class="dv">2</span>), <span class="st">&#39;y&#39;</span>] <span class="sc">~</span> xy[<span class="dv">1</span><span class="sc">:</span>(n <span class="sc">/</span> <span class="dv">2</span>), <span class="st">&#39;x&#39;</span>])</span>
<span id="cb117-9"><a href="non-linear-least-squares.html#cb117-9" tabindex="-1"></a>    b0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmFit)[<span class="dv">1</span>]</span>
<span id="cb117-10"><a href="non-linear-least-squares.html#cb117-10" tabindex="-1"></a>    b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(lmFit)[<span class="dv">2</span>]</span>
<span id="cb117-11"><a href="non-linear-least-squares.html#cb117-11" tabindex="-1"></a>    <span class="co"># for the cut off to the flat part select the last </span></span>
<span id="cb117-12"><a href="non-linear-least-squares.html#cb117-12" tabindex="-1"></a>    <span class="co"># x value used in creating linear model</span></span>
<span id="cb117-13"><a href="non-linear-least-squares.html#cb117-13" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> xy[(n <span class="sc">/</span> <span class="dv">2</span>), <span class="st">&#39;x&#39;</span>]</span>
<span id="cb117-14"><a href="non-linear-least-squares.html#cb117-14" tabindex="-1"></a>    value <span class="ot">&lt;-</span> <span class="fu">c</span>(b0, b1, alpha)</span>
<span id="cb117-15"><a href="non-linear-least-squares.html#cb117-15" tabindex="-1"></a>    <span class="fu">names</span>(value) <span class="ot">&lt;-</span> mCall[<span class="fu">c</span>(<span class="st">&#39;b0&#39;</span>, <span class="st">&#39;b1&#39;</span>, <span class="st">&#39;alpha&#39;</span>)]</span>
<span id="cb117-16"><a href="non-linear-least-squares.html#cb117-16" tabindex="-1"></a>    value</span>
<span id="cb117-17"><a href="non-linear-least-squares.html#cb117-17" tabindex="-1"></a>}</span></code></pre></div>
<p>combine model and custom function to calculate starting values.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="non-linear-least-squares.html#cb118-1" tabindex="-1"></a>SS_nonlinModel <span class="ot">&lt;-</span> <span class="fu">selfStart</span>(nonlinModel,nonlinModelInit,<span class="fu">c</span>(<span class="st">&#39;b0&#39;</span>,<span class="st">&#39;b1&#39;</span>,<span class="st">&#39;alpha&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="non-linear-least-squares.html#cb119-1" tabindex="-1"></a><span class="co"># Above code defined model and selfStart now just need to call it for each of the depths</span></span>
<span id="cb119-2"><a href="non-linear-least-squares.html#cb119-2" tabindex="-1"></a>sep30_nls <span class="ot">&lt;-</span></span>
<span id="cb119-3"><a href="non-linear-least-squares.html#cb119-3" tabindex="-1"></a>    <span class="fu">nls</span>(ryp <span class="sc">~</span> <span class="fu">SS_nonlinModel</span>(<span class="at">predictor =</span> no3, b0, b1, alpha),</span>
<span id="cb119-4"><a href="non-linear-least-squares.html#cb119-4" tabindex="-1"></a>        <span class="at">data =</span> dat[dat<span class="sc">$</span>depth <span class="sc">==</span> <span class="dv">30</span>,])</span>
<span id="cb119-5"><a href="non-linear-least-squares.html#cb119-5" tabindex="-1"></a></span>
<span id="cb119-6"><a href="non-linear-least-squares.html#cb119-6" tabindex="-1"></a>sep60_nls <span class="ot">&lt;-</span></span>
<span id="cb119-7"><a href="non-linear-least-squares.html#cb119-7" tabindex="-1"></a>    <span class="fu">nls</span>(ryp <span class="sc">~</span> <span class="fu">SS_nonlinModel</span>(<span class="at">predictor =</span> no3, b0, b1, alpha),</span>
<span id="cb119-8"><a href="non-linear-least-squares.html#cb119-8" tabindex="-1"></a>        <span class="at">data =</span> dat[dat<span class="sc">$</span>depth <span class="sc">==</span> <span class="dv">60</span>,])</span>
<span id="cb119-9"><a href="non-linear-least-squares.html#cb119-9" tabindex="-1"></a></span>
<span id="cb119-10"><a href="non-linear-least-squares.html#cb119-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb119-11"><a href="non-linear-least-squares.html#cb119-11" tabindex="-1"></a><span class="fu">plotFit</span>(</span>
<span id="cb119-12"><a href="non-linear-least-squares.html#cb119-12" tabindex="-1"></a>    sep30_nls,</span>
<span id="cb119-13"><a href="non-linear-least-squares.html#cb119-13" tabindex="-1"></a>    <span class="at">interval =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb119-14"><a href="non-linear-least-squares.html#cb119-14" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb119-15"><a href="non-linear-least-squares.html#cb119-15" tabindex="-1"></a>    <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-16"><a href="non-linear-least-squares.html#cb119-16" tabindex="-1"></a>    <span class="at">col.conf =</span> <span class="st">&quot;skyblue4&quot;</span>,</span>
<span id="cb119-17"><a href="non-linear-least-squares.html#cb119-17" tabindex="-1"></a>    <span class="at">col.pred =</span> <span class="st">&quot;lightskyblue2&quot;</span>,</span>
<span id="cb119-18"><a href="non-linear-least-squares.html#cb119-18" tabindex="-1"></a>    <span class="at">data =</span> dat[dat<span class="sc">$</span>depth <span class="sc">==</span> <span class="dv">30</span>,],</span>
<span id="cb119-19"><a href="non-linear-least-squares.html#cb119-19" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&#39;Results 30 cm depth&#39;</span>,</span>
<span id="cb119-20"><a href="non-linear-least-squares.html#cb119-20" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&#39;relative yield percent&#39;</span>,</span>
<span id="cb119-21"><a href="non-linear-least-squares.html#cb119-21" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&#39;Soil NO3 concentration&#39;</span>,</span>
<span id="cb119-22"><a href="non-linear-least-squares.html#cb119-22" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb119-23"><a href="non-linear-least-squares.html#cb119-23" tabindex="-1"></a>)</span>
<span id="cb119-24"><a href="non-linear-least-squares.html#cb119-24" tabindex="-1"></a><span class="fu">plotFit</span>(</span>
<span id="cb119-25"><a href="non-linear-least-squares.html#cb119-25" tabindex="-1"></a>    sep60_nls,</span>
<span id="cb119-26"><a href="non-linear-least-squares.html#cb119-26" tabindex="-1"></a>    <span class="at">interval =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb119-27"><a href="non-linear-least-squares.html#cb119-27" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb119-28"><a href="non-linear-least-squares.html#cb119-28" tabindex="-1"></a>    <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb119-29"><a href="non-linear-least-squares.html#cb119-29" tabindex="-1"></a>    <span class="at">col.conf =</span> <span class="st">&quot;lightpink4&quot;</span>,</span>
<span id="cb119-30"><a href="non-linear-least-squares.html#cb119-30" tabindex="-1"></a>    <span class="at">col.pred =</span> <span class="st">&quot;lightpink2&quot;</span>,</span>
<span id="cb119-31"><a href="non-linear-least-squares.html#cb119-31" tabindex="-1"></a>    <span class="at">data =</span> dat[dat<span class="sc">$</span>depth <span class="sc">==</span> <span class="dv">60</span>,],</span>
<span id="cb119-32"><a href="non-linear-least-squares.html#cb119-32" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&#39;Results 60 cm depth&#39;</span>,</span>
<span id="cb119-33"><a href="non-linear-least-squares.html#cb119-33" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&#39;relative yield percent&#39;</span>,</span>
<span id="cb119-34"><a href="non-linear-least-squares.html#cb119-34" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&#39;Soil NO3 concentration&#39;</span>,</span>
<span id="cb119-35"><a href="non-linear-least-squares.html#cb119-35" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>)</span>
<span id="cb119-36"><a href="non-linear-least-squares.html#cb119-36" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="non-linear-least-squares.html#cb120-1" tabindex="-1"></a><span class="fu">summary</span>(sep30_nls)</span>
<span id="cb120-2"><a href="non-linear-least-squares.html#cb120-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-3"><a href="non-linear-least-squares.html#cb120-3" tabindex="-1"></a><span class="co">#&gt; Formula: ryp ~ SS_nonlinModel(predictor = no3, b0, b1, alpha)</span></span>
<span id="cb120-4"><a href="non-linear-least-squares.html#cb120-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-5"><a href="non-linear-least-squares.html#cb120-5" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb120-6"><a href="non-linear-least-squares.html#cb120-6" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb120-7"><a href="non-linear-least-squares.html#cb120-7" tabindex="-1"></a><span class="co">#&gt; b0     15.1943     2.9781   5.102 6.89e-07 ***</span></span>
<span id="cb120-8"><a href="non-linear-least-squares.html#cb120-8" tabindex="-1"></a><span class="co">#&gt; b1      3.5760     0.1853  19.297  &lt; 2e-16 ***</span></span>
<span id="cb120-9"><a href="non-linear-least-squares.html#cb120-9" tabindex="-1"></a><span class="co">#&gt; alpha  23.1324     0.5098  45.373  &lt; 2e-16 ***</span></span>
<span id="cb120-10"><a href="non-linear-least-squares.html#cb120-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb120-11"><a href="non-linear-least-squares.html#cb120-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb120-12"><a href="non-linear-least-squares.html#cb120-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-13"><a href="non-linear-least-squares.html#cb120-13" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 8.258 on 237 degrees of freedom</span></span>
<span id="cb120-14"><a href="non-linear-least-squares.html#cb120-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-15"><a href="non-linear-least-squares.html#cb120-15" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 6 </span></span>
<span id="cb120-16"><a href="non-linear-least-squares.html#cb120-16" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 3.608e-09</span></span>
<span id="cb120-17"><a href="non-linear-least-squares.html#cb120-17" tabindex="-1"></a><span class="fu">summary</span>(sep60_nls)</span>
<span id="cb120-18"><a href="non-linear-least-squares.html#cb120-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-19"><a href="non-linear-least-squares.html#cb120-19" tabindex="-1"></a><span class="co">#&gt; Formula: ryp ~ SS_nonlinModel(predictor = no3, b0, b1, alpha)</span></span>
<span id="cb120-20"><a href="non-linear-least-squares.html#cb120-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-21"><a href="non-linear-least-squares.html#cb120-21" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb120-22"><a href="non-linear-least-squares.html#cb120-22" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb120-23"><a href="non-linear-least-squares.html#cb120-23" tabindex="-1"></a><span class="co">#&gt; b0      5.4519     2.9785    1.83   0.0684 .  </span></span>
<span id="cb120-24"><a href="non-linear-least-squares.html#cb120-24" tabindex="-1"></a><span class="co">#&gt; b1      5.6820     0.2529   22.46   &lt;2e-16 ***</span></span>
<span id="cb120-25"><a href="non-linear-least-squares.html#cb120-25" tabindex="-1"></a><span class="co">#&gt; alpha  16.2863     0.2818   57.80   &lt;2e-16 ***</span></span>
<span id="cb120-26"><a href="non-linear-least-squares.html#cb120-26" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb120-27"><a href="non-linear-least-squares.html#cb120-27" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb120-28"><a href="non-linear-least-squares.html#cb120-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-29"><a href="non-linear-least-squares.html#cb120-29" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 7.427 on 237 degrees of freedom</span></span>
<span id="cb120-30"><a href="non-linear-least-squares.html#cb120-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-31"><a href="non-linear-least-squares.html#cb120-31" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 5 </span></span>
<span id="cb120-32"><a href="non-linear-least-squares.html#cb120-32" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 8.571e-09</span></span></code></pre></div>
<p>Instead of modeling the depths model separately we model them together - so there is a common slope, intercept, and plateau.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="non-linear-least-squares.html#cb121-1" tabindex="-1"></a>red_nls <span class="ot">&lt;-</span></span>
<span id="cb121-2"><a href="non-linear-least-squares.html#cb121-2" tabindex="-1"></a>  <span class="fu">nls</span>(ryp <span class="sc">~</span> <span class="fu">SS_nonlinModel</span>(<span class="at">predictor =</span> no3, b0, b1, alpha), </span>
<span id="cb121-3"><a href="non-linear-least-squares.html#cb121-3" tabindex="-1"></a>      <span class="at">data =</span> dat)</span>
<span id="cb121-4"><a href="non-linear-least-squares.html#cb121-4" tabindex="-1"></a></span>
<span id="cb121-5"><a href="non-linear-least-squares.html#cb121-5" tabindex="-1"></a><span class="fu">summary</span>(red_nls)</span>
<span id="cb121-6"><a href="non-linear-least-squares.html#cb121-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-7"><a href="non-linear-least-squares.html#cb121-7" tabindex="-1"></a><span class="co">#&gt; Formula: ryp ~ SS_nonlinModel(predictor = no3, b0, b1, alpha)</span></span>
<span id="cb121-8"><a href="non-linear-least-squares.html#cb121-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-9"><a href="non-linear-least-squares.html#cb121-9" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb121-10"><a href="non-linear-least-squares.html#cb121-10" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb121-11"><a href="non-linear-least-squares.html#cb121-11" tabindex="-1"></a><span class="co">#&gt; b0      8.7901     2.7688   3.175   0.0016 ** </span></span>
<span id="cb121-12"><a href="non-linear-least-squares.html#cb121-12" tabindex="-1"></a><span class="co">#&gt; b1      4.8995     0.2207  22.203   &lt;2e-16 ***</span></span>
<span id="cb121-13"><a href="non-linear-least-squares.html#cb121-13" tabindex="-1"></a><span class="co">#&gt; alpha  18.0333     0.3242  55.630   &lt;2e-16 ***</span></span>
<span id="cb121-14"><a href="non-linear-least-squares.html#cb121-14" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb121-15"><a href="non-linear-least-squares.html#cb121-15" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb121-16"><a href="non-linear-least-squares.html#cb121-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-17"><a href="non-linear-least-squares.html#cb121-17" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 9.13 on 477 degrees of freedom</span></span>
<span id="cb121-18"><a href="non-linear-least-squares.html#cb121-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-19"><a href="non-linear-least-squares.html#cb121-19" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 7 </span></span>
<span id="cb121-20"><a href="non-linear-least-squares.html#cb121-20" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 7.126e-09</span></span>
<span id="cb121-21"><a href="non-linear-least-squares.html#cb121-21" tabindex="-1"></a></span>
<span id="cb121-22"><a href="non-linear-least-squares.html#cb121-22" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb121-23"><a href="non-linear-least-squares.html#cb121-23" tabindex="-1"></a><span class="fu">plotFit</span>(</span>
<span id="cb121-24"><a href="non-linear-least-squares.html#cb121-24" tabindex="-1"></a>  red_nls,</span>
<span id="cb121-25"><a href="non-linear-least-squares.html#cb121-25" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb121-26"><a href="non-linear-least-squares.html#cb121-26" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb121-27"><a href="non-linear-least-squares.html#cb121-27" tabindex="-1"></a>  <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb121-28"><a href="non-linear-least-squares.html#cb121-28" tabindex="-1"></a>  <span class="at">col.conf =</span> <span class="st">&quot;lightblue4&quot;</span>,</span>
<span id="cb121-29"><a href="non-linear-least-squares.html#cb121-29" tabindex="-1"></a>  <span class="at">col.pred =</span> <span class="st">&quot;lightblue2&quot;</span>,</span>
<span id="cb121-30"><a href="non-linear-least-squares.html#cb121-30" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb121-31"><a href="non-linear-least-squares.html#cb121-31" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&#39;Results combined&#39;</span>,</span>
<span id="cb121-32"><a href="non-linear-least-squares.html#cb121-32" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&#39;relative yield percent&#39;</span>,</span>
<span id="cb121-33"><a href="non-linear-least-squares.html#cb121-33" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&#39;Soil NO3 concentration&#39;</span></span>
<span id="cb121-34"><a href="non-linear-least-squares.html#cb121-34" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/reduce-model-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Examine residual values for the combined model.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="non-linear-least-squares.html#cb122-1" tabindex="-1"></a><span class="fu">library</span>(nlstools)</span>
<span id="cb122-2"><a href="non-linear-least-squares.html#cb122-2" tabindex="-1"></a><span class="co"># using nlstools nlsResiduals function to get some quick residual plots</span></span>
<span id="cb122-3"><a href="non-linear-least-squares.html#cb122-3" tabindex="-1"></a><span class="co"># can also use test.nlsResiduals(resid)</span></span>
<span id="cb122-4"><a href="non-linear-least-squares.html#cb122-4" tabindex="-1"></a><span class="co"># https://www.rdocumentation.org/packages/nlstools/versions/1.0-2</span></span>
<span id="cb122-5"><a href="non-linear-least-squares.html#cb122-5" tabindex="-1"></a>resid <span class="ot">&lt;-</span> <span class="fu">nlsResiduals</span>(red_nls)</span>
<span id="cb122-6"><a href="non-linear-least-squares.html#cb122-6" tabindex="-1"></a><span class="fu">plot</span>(resid)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/reduce-model-resid-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>can we test whether the parameters for the two soil depth fits are significantly different? To know if the combined model is appropriate, we consider a parameterization where we let the parameters for the 60cm model be equal to the parameters from the 30cm model plus some increment:</p>
<p><span class="math display">\[
\begin{aligned}
\beta_{02} &amp;= \beta_{01} + d_0 \\
\beta_{12} &amp;= \beta_{11} + d_1 \\
\alpha_{2} &amp;= \alpha_{1} + d_a
\end{aligned}
\]</span></p>
<p>We can implement this in the following function:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="non-linear-least-squares.html#cb123-1" tabindex="-1"></a>nonlinModelF <span class="ot">&lt;-</span> <span class="cf">function</span>(predictor,soildep,b01,b11,a1,d0,d1,da){</span>
<span id="cb123-2"><a href="non-linear-least-squares.html#cb123-2" tabindex="-1"></a>   b02 <span class="ot">=</span> b01 <span class="sc">+</span> d0 <span class="co">#make 60cm parms = 30cm parms + increment</span></span>
<span id="cb123-3"><a href="non-linear-least-squares.html#cb123-3" tabindex="-1"></a>   b12 <span class="ot">=</span> b11 <span class="sc">+</span> d1</span>
<span id="cb123-4"><a href="non-linear-least-squares.html#cb123-4" tabindex="-1"></a>   a2 <span class="ot">=</span> a1 <span class="sc">+</span> da</span>
<span id="cb123-5"><a href="non-linear-least-squares.html#cb123-5" tabindex="-1"></a>   </span>
<span id="cb123-6"><a href="non-linear-least-squares.html#cb123-6" tabindex="-1"></a>   y1 <span class="ot">=</span> <span class="fu">ifelse</span>(predictor<span class="sc">&lt;=</span>a1, </span>
<span id="cb123-7"><a href="non-linear-least-squares.html#cb123-7" tabindex="-1"></a>        <span class="co">#if observation less than cutoff simple linear model</span></span>
<span id="cb123-8"><a href="non-linear-least-squares.html#cb123-8" tabindex="-1"></a>         b01<span class="sc">+</span>b11<span class="sc">*</span>predictor, </span>
<span id="cb123-9"><a href="non-linear-least-squares.html#cb123-9" tabindex="-1"></a>         b01<span class="sc">+</span>b11<span class="sc">*</span>a1) <span class="co"># otherwise flat line</span></span>
<span id="cb123-10"><a href="non-linear-least-squares.html#cb123-10" tabindex="-1"></a>   y2 <span class="ot">=</span> <span class="fu">ifelse</span>(predictor<span class="sc">&lt;=</span>a2, </span>
<span id="cb123-11"><a href="non-linear-least-squares.html#cb123-11" tabindex="-1"></a>               b02<span class="sc">+</span>b12<span class="sc">*</span>predictor, </span>
<span id="cb123-12"><a href="non-linear-least-squares.html#cb123-12" tabindex="-1"></a>               b02<span class="sc">+</span>b12<span class="sc">*</span>a2) </span>
<span id="cb123-13"><a href="non-linear-least-squares.html#cb123-13" tabindex="-1"></a>   y <span class="ot">=</span>  y1<span class="sc">*</span>(soildep <span class="sc">==</span> <span class="dv">30</span>) <span class="sc">+</span> y2<span class="sc">*</span>(soildep <span class="sc">==</span> <span class="dv">60</span>)  <span class="co">#combine models</span></span>
<span id="cb123-14"><a href="non-linear-least-squares.html#cb123-14" tabindex="-1"></a>   <span class="fu">return</span>(y)</span>
<span id="cb123-15"><a href="non-linear-least-squares.html#cb123-15" tabindex="-1"></a>}</span></code></pre></div>
<p>Starting values are easy now because we fit each model individually.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="non-linear-least-squares.html#cb124-1" tabindex="-1"></a>Soil_full <span class="ot">=</span> <span class="fu">nls</span>(</span>
<span id="cb124-2"><a href="non-linear-least-squares.html#cb124-2" tabindex="-1"></a>    ryp <span class="sc">~</span> <span class="fu">nonlinModelF</span>(</span>
<span id="cb124-3"><a href="non-linear-least-squares.html#cb124-3" tabindex="-1"></a>        <span class="at">predictor =</span> no3,</span>
<span id="cb124-4"><a href="non-linear-least-squares.html#cb124-4" tabindex="-1"></a>        <span class="at">soildep =</span> depth,</span>
<span id="cb124-5"><a href="non-linear-least-squares.html#cb124-5" tabindex="-1"></a>        b01,</span>
<span id="cb124-6"><a href="non-linear-least-squares.html#cb124-6" tabindex="-1"></a>        b11,</span>
<span id="cb124-7"><a href="non-linear-least-squares.html#cb124-7" tabindex="-1"></a>        a1,</span>
<span id="cb124-8"><a href="non-linear-least-squares.html#cb124-8" tabindex="-1"></a>        d0,</span>
<span id="cb124-9"><a href="non-linear-least-squares.html#cb124-9" tabindex="-1"></a>        d1,</span>
<span id="cb124-10"><a href="non-linear-least-squares.html#cb124-10" tabindex="-1"></a>        da</span>
<span id="cb124-11"><a href="non-linear-least-squares.html#cb124-11" tabindex="-1"></a>    ),</span>
<span id="cb124-12"><a href="non-linear-least-squares.html#cb124-12" tabindex="-1"></a>    <span class="at">data =</span> dat,</span>
<span id="cb124-13"><a href="non-linear-least-squares.html#cb124-13" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb124-14"><a href="non-linear-least-squares.html#cb124-14" tabindex="-1"></a>        <span class="at">b01 =</span> <span class="fl">15.2</span>,</span>
<span id="cb124-15"><a href="non-linear-least-squares.html#cb124-15" tabindex="-1"></a>        <span class="at">b11 =</span> <span class="fl">3.58</span>,</span>
<span id="cb124-16"><a href="non-linear-least-squares.html#cb124-16" tabindex="-1"></a>        <span class="at">a1 =</span> <span class="fl">23.13</span>,</span>
<span id="cb124-17"><a href="non-linear-least-squares.html#cb124-17" tabindex="-1"></a>        <span class="at">d0 =</span> <span class="sc">-</span><span class="fl">9.74</span>,</span>
<span id="cb124-18"><a href="non-linear-least-squares.html#cb124-18" tabindex="-1"></a>        <span class="at">d1 =</span> <span class="fl">2.11</span>,</span>
<span id="cb124-19"><a href="non-linear-least-squares.html#cb124-19" tabindex="-1"></a>        <span class="at">da =</span> <span class="sc">-</span><span class="fl">6.85</span></span>
<span id="cb124-20"><a href="non-linear-least-squares.html#cb124-20" tabindex="-1"></a>    )</span>
<span id="cb124-21"><a href="non-linear-least-squares.html#cb124-21" tabindex="-1"></a>)</span>
<span id="cb124-22"><a href="non-linear-least-squares.html#cb124-22" tabindex="-1"></a></span>
<span id="cb124-23"><a href="non-linear-least-squares.html#cb124-23" tabindex="-1"></a><span class="fu">summary</span>(Soil_full)</span>
<span id="cb124-24"><a href="non-linear-least-squares.html#cb124-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-25"><a href="non-linear-least-squares.html#cb124-25" tabindex="-1"></a><span class="co">#&gt; Formula: ryp ~ nonlinModelF(predictor = no3, soildep = depth, b01, b11, </span></span>
<span id="cb124-26"><a href="non-linear-least-squares.html#cb124-26" tabindex="-1"></a><span class="co">#&gt;     a1, d0, d1, da)</span></span>
<span id="cb124-27"><a href="non-linear-least-squares.html#cb124-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-28"><a href="non-linear-least-squares.html#cb124-28" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb124-29"><a href="non-linear-least-squares.html#cb124-29" tabindex="-1"></a><span class="co">#&gt;     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb124-30"><a href="non-linear-least-squares.html#cb124-30" tabindex="-1"></a><span class="co">#&gt; b01  15.1943     2.8322   5.365 1.27e-07 ***</span></span>
<span id="cb124-31"><a href="non-linear-least-squares.html#cb124-31" tabindex="-1"></a><span class="co">#&gt; b11   3.5760     0.1762  20.291  &lt; 2e-16 ***</span></span>
<span id="cb124-32"><a href="non-linear-least-squares.html#cb124-32" tabindex="-1"></a><span class="co">#&gt; a1   23.1324     0.4848  47.711  &lt; 2e-16 ***</span></span>
<span id="cb124-33"><a href="non-linear-least-squares.html#cb124-33" tabindex="-1"></a><span class="co">#&gt; d0   -9.7424     4.2357  -2.300   0.0219 *  </span></span>
<span id="cb124-34"><a href="non-linear-least-squares.html#cb124-34" tabindex="-1"></a><span class="co">#&gt; d1    2.1060     0.3203   6.575 1.29e-10 ***</span></span>
<span id="cb124-35"><a href="non-linear-least-squares.html#cb124-35" tabindex="-1"></a><span class="co">#&gt; da   -6.8461     0.5691 -12.030  &lt; 2e-16 ***</span></span>
<span id="cb124-36"><a href="non-linear-least-squares.html#cb124-36" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb124-37"><a href="non-linear-least-squares.html#cb124-37" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb124-38"><a href="non-linear-least-squares.html#cb124-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-39"><a href="non-linear-least-squares.html#cb124-39" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 7.854 on 474 degrees of freedom</span></span>
<span id="cb124-40"><a href="non-linear-least-squares.html#cb124-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb124-41"><a href="non-linear-least-squares.html#cb124-41" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 1 </span></span>
<span id="cb124-42"><a href="non-linear-least-squares.html#cb124-42" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 3.742e-06</span></span></code></pre></div>
<p>So, the increment parameters, <span class="math inline">\(d_1\)</span>,<span class="math inline">\(d_2\)</span>,<span class="math inline">\(d_a\)</span> are all significantly different from 0, suggesting that we should have two models here.</p>
</div>
</div>
<div id="modelestimation-adequacy" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Model/Estimation Adequacy<a href="non-linear-least-squares.html#modelestimation-adequacy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">(<a href="#ref-bates1980relative">Bates and Watts 1980</a>)</span> assess nonlinearity in terms of 2 components of curvature:</p>
<ul>
<li><p><strong>Intrinsic nonlinearity</strong>: the degree of bending and twisting in <span class="math inline">\(f(\theta)\)</span>; our estimation approach assumes that the true function is relatively flat (planar) in the neighborhood fo <span class="math inline">\(\hat{\theta}\)</span>, which would not be true if <span class="math inline">\(f()\)</span> has a lot of “bending” in the neighborhood of <span class="math inline">\(\hat{\theta}\)</span> (independent of parameterization)</p>
<ul>
<li><p>If bad, the distribution of residuals will be seriously distorted</p></li>
<li><p>slow to converge</p></li>
<li><p>difficult to identify ( could use this function <code>rms.curve</code>)</p></li>
<li><p>Solution:</p>
<ul>
<li>could use higher order Taylor expansions estimation</li>
<li>Bayesian method</li>
</ul></li>
</ul></li>
<li><p><strong>Parameter effects nonlinearity</strong>: degree to which curvature (nonlinearity) is affected by choice of <span class="math inline">\(\theta\)</span> (data dependent; dependent on parameterization)</p>
<ul>
<li>leads to problems with inference on <span class="math inline">\(\hat{\theta}\)</span></li>
<li><code>rms.curve</code> in <code>MASS</code> can identify</li>
<li>bootstrap-based inference can also be used</li>
<li>Solution: try to reparaemterize.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="non-linear-least-squares.html#cb125-1" tabindex="-1"></a><span class="co">#check parameter effects and intrinsic curvature</span></span>
<span id="cb125-2"><a href="non-linear-least-squares.html#cb125-2" tabindex="-1"></a></span>
<span id="cb125-3"><a href="non-linear-least-squares.html#cb125-3" tabindex="-1"></a>modD <span class="ot">=</span> <span class="fu">deriv3</span>(<span class="sc">~</span> a<span class="sc">*</span><span class="fu">exp</span>(b<span class="sc">*</span>x), <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>),<span class="cf">function</span>(a,b,x) <span class="cn">NULL</span>)</span>
<span id="cb125-4"><a href="non-linear-least-squares.html#cb125-4" tabindex="-1"></a></span>
<span id="cb125-5"><a href="non-linear-least-squares.html#cb125-5" tabindex="-1"></a>nlin_modD <span class="ot">=</span> <span class="fu">nls</span>(y <span class="sc">~</span> <span class="fu">modD</span>(a, b, x),</span>
<span id="cb125-6"><a href="non-linear-least-squares.html#cb125-6" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> astrt, <span class="at">b =</span> bstrt),</span>
<span id="cb125-7"><a href="non-linear-least-squares.html#cb125-7" tabindex="-1"></a>                <span class="at">data =</span> datf)</span>
<span id="cb125-8"><a href="non-linear-least-squares.html#cb125-8" tabindex="-1"></a></span>
<span id="cb125-9"><a href="non-linear-least-squares.html#cb125-9" tabindex="-1"></a><span class="fu">rms.curv</span>(nlin_modD)</span>
<span id="cb125-10"><a href="non-linear-least-squares.html#cb125-10" tabindex="-1"></a><span class="co">#&gt; Parameter effects: c^theta x sqrt(F) = 0.0626 </span></span>
<span id="cb125-11"><a href="non-linear-least-squares.html#cb125-11" tabindex="-1"></a><span class="co">#&gt;         Intrinsic: c^iota  x sqrt(F) = 0.0062</span></span></code></pre></div>
<p>In linear model, we have <a href="linear-regression.html#linear-regression">Linear Regression</a>, we have goodness of fit measure as <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
R^2 &amp;= \frac{SSR}{SSTO} = 1- \frac{SSE}{SSTO} \\
&amp;= \frac{\sum_{i=1}^n (\hat{Y}_i- \bar{Y})^2}{\sum_{i=1}^n (Y_i- \bar{Y})^2} = 1- \frac{\sum_{i=1}^n ({Y}_i- \hat{Y})^2}{\sum_{i=1}^n (Y_i- \bar{Y})^2}
\end{aligned}
\]</span></p>
<p>but not valid in the nonlinear case because the error sum of squares and model sum of squares do not add to the total corrected sum of squares</p>
<p><span class="math display">\[
SSR + SSE \neq SST
\]</span></p>
<p>but we can use pseudo-<span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[
R^2_{pseudo} = 1 - \frac{\sum_{i=1}^n ({Y}_i- \hat{Y})^2}{\sum_{i=1}^n (Y_i- \bar{Y})^2}
\]</span></p>
<p>But we can’t interpret this as the proportion of variability explained by the model. We should use as a relative comparison of different models.</p>
<p><strong>Residual Plots</strong>: standardize, similar to OLS. useful when the intrinsic curvature is small:</p>
<p>The studentized residuals</p>
<p><span class="math display">\[
r_i = \frac{e_i}{s\sqrt{1-\hat{c}_i}}
\]</span></p>
<p>where <span class="math inline">\(\hat{c}_i\)</span>is the i-th diagonal of <span class="math inline">\(\mathbf{\hat{H}= F(\hat{\theta})[F(\hat{\theta})&#39;F(\hat{\theta})]^{-1}F(\hat{\theta})&#39;}\)</span></p>
<p>We could have problems of</p>
<ul>
<li><p>Collinearity: the condition number of <span class="math inline">\(\mathbf{[F(\hat{\theta})&#39;F(\hat{\theta})]^{-1}}\)</span> should be less than 30. Follow <span class="citation">(<a href="#ref-Magel_1987">Magel and Hertsgaard 1987</a>)</span>; reparameterize if possible</p></li>
<li><p>Leverage: Like <a href="ordinary-least-squares.html#ordinary-least-squares">OLS</a>, but consider <span class="math inline">\(\mathbf{\hat{H}= F(\hat{\theta})[F(\hat{\theta})&#39;F(\hat{\theta})]^{-1}F(\hat{\theta})&#39;}\)</span> (also known as “tangent plant hat matrix”) <span class="citation">(<a href="#ref-Laurent_1992">St Laurent and Cook 1992</a>)</span></p></li>
<li><p>Heterogeneous Errors: weighted Non-linear Least Squares</p></li>
<li><p>Correlated Errors:</p>
<ul>
<li>Generalized Nonlinear Least Squares</li>
<li>Nonlinear Mixed Models</li>
<li>Bayesian methods</li>
</ul></li>
</ul>
</div>
<div id="application-1" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Application<a href="non-linear-least-squares.html#application-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
y_i = \frac{\theta_0 + \theta_1 x_i}{1 + \theta_2 \exp(0.4 x_i)} + \epsilon_i
\]</span></p>
<p>where <span class="math inline">\(i = 1,..,n\)</span></p>
<p>Get the starting values</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="non-linear-least-squares.html#cb126-1" tabindex="-1"></a><span class="fu">plot</span>(my_data)</span></code></pre></div>
<p><img src="06-nonlinear-regession_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>We notice that <span class="math inline">\(Y_{max} = \theta_0 + \theta_1 x_i\)</span> in which we can find x_i from data</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="non-linear-least-squares.html#cb127-1" tabindex="-1"></a><span class="fu">max</span>(my_data<span class="sc">$</span>y)</span>
<span id="cb127-2"><a href="non-linear-least-squares.html#cb127-2" tabindex="-1"></a><span class="co">#&gt; [1] 2.6722</span></span>
<span id="cb127-3"><a href="non-linear-least-squares.html#cb127-3" tabindex="-1"></a>my_data<span class="sc">$</span>x[<span class="fu">which.max</span>(my_data<span class="sc">$</span>y)]</span>
<span id="cb127-4"><a href="non-linear-least-squares.html#cb127-4" tabindex="-1"></a><span class="co">#&gt; [1] 0.0094</span></span></code></pre></div>
<p>hence, <span class="math inline">\(x = 0.0094\)</span> when <span class="math inline">\(y = 2.6722\)</span> when we have the first equation as</p>
<p><span class="math display">\[
2.6722 = \theta_0 + 0.0094 \theta_1
\]</span></p>
<p><span class="math display">\[
\theta_0 + 0.0094 \theta_1 + 0 \theta_2 = 2.6722
\]</span></p>
<p>Secondly, we notice that we can obtain the “average” of y when</p>
<p><span class="math display">\[
1+ \theta_2 exp(0.4 x) = 2
\]</span></p>
<p>then we can find this average numbers of x and y</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="non-linear-least-squares.html#cb128-1" tabindex="-1"></a><span class="co"># find mean y</span></span>
<span id="cb128-2"><a href="non-linear-least-squares.html#cb128-2" tabindex="-1"></a><span class="fu">mean</span>(my_data<span class="sc">$</span>y) </span>
<span id="cb128-3"><a href="non-linear-least-squares.html#cb128-3" tabindex="-1"></a><span class="co">#&gt; [1] -0.0747864</span></span>
<span id="cb128-4"><a href="non-linear-least-squares.html#cb128-4" tabindex="-1"></a></span>
<span id="cb128-5"><a href="non-linear-least-squares.html#cb128-5" tabindex="-1"></a><span class="co"># find y closest to its mean</span></span>
<span id="cb128-6"><a href="non-linear-least-squares.html#cb128-6" tabindex="-1"></a>my_data<span class="sc">$</span>y[<span class="fu">which.min</span>(<span class="fu">abs</span>(my_data<span class="sc">$</span>y <span class="sc">-</span> (<span class="fu">mean</span>(my_data<span class="sc">$</span>y))))] </span>
<span id="cb128-7"><a href="non-linear-least-squares.html#cb128-7" tabindex="-1"></a><span class="co">#&gt; [1] -0.0773</span></span>
<span id="cb128-8"><a href="non-linear-least-squares.html#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="non-linear-least-squares.html#cb128-9" tabindex="-1"></a></span>
<span id="cb128-10"><a href="non-linear-least-squares.html#cb128-10" tabindex="-1"></a><span class="co"># find x closest to the mean y</span></span>
<span id="cb128-11"><a href="non-linear-least-squares.html#cb128-11" tabindex="-1"></a>my_data<span class="sc">$</span>x[<span class="fu">which.min</span>(<span class="fu">abs</span>(my_data<span class="sc">$</span>y <span class="sc">-</span> (<span class="fu">mean</span>(my_data<span class="sc">$</span>y))))] </span>
<span id="cb128-12"><a href="non-linear-least-squares.html#cb128-12" tabindex="-1"></a><span class="co">#&gt; [1] 11.0648</span></span></code></pre></div>
<p>we have the second equation</p>
<p><span class="math display">\[
1 + \theta_2 exp(0.4*11.0648) = 2
\]</span></p>
<p><span class="math display">\[
0 \theta_1 + 0 \theta_1 + 83.58967 \theta_2 = 1
\]</span></p>
<p>Thirdly, we can plug in the value of x closest to 1 to find the value of y</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="non-linear-least-squares.html#cb129-1" tabindex="-1"></a><span class="co"># find value of x closet to 1</span></span>
<span id="cb129-2"><a href="non-linear-least-squares.html#cb129-2" tabindex="-1"></a>my_data<span class="sc">$</span>x[<span class="fu">which.min</span>(<span class="fu">abs</span>(my_data<span class="sc">$</span>x <span class="sc">-</span> <span class="dv">1</span>))] </span>
<span id="cb129-3"><a href="non-linear-least-squares.html#cb129-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.9895</span></span>
<span id="cb129-4"><a href="non-linear-least-squares.html#cb129-4" tabindex="-1"></a></span>
<span id="cb129-5"><a href="non-linear-least-squares.html#cb129-5" tabindex="-1"></a><span class="co"># find index of x closest to 1</span></span>
<span id="cb129-6"><a href="non-linear-least-squares.html#cb129-6" tabindex="-1"></a><span class="fu">match</span>(my_data<span class="sc">$</span>x[<span class="fu">which.min</span>(<span class="fu">abs</span>(my_data<span class="sc">$</span>x <span class="sc">-</span> <span class="dv">1</span>))], my_data<span class="sc">$</span>x) </span>
<span id="cb129-7"><a href="non-linear-least-squares.html#cb129-7" tabindex="-1"></a><span class="co">#&gt; [1] 14</span></span>
<span id="cb129-8"><a href="non-linear-least-squares.html#cb129-8" tabindex="-1"></a></span>
<span id="cb129-9"><a href="non-linear-least-squares.html#cb129-9" tabindex="-1"></a><span class="co"># find y value</span></span>
<span id="cb129-10"><a href="non-linear-least-squares.html#cb129-10" tabindex="-1"></a>my_data<span class="sc">$</span>y[<span class="fu">match</span>(my_data<span class="sc">$</span>x[<span class="fu">which.min</span>(<span class="fu">abs</span>(my_data<span class="sc">$</span>x <span class="sc">-</span> <span class="dv">1</span>))], my_data<span class="sc">$</span>x)]</span>
<span id="cb129-11"><a href="non-linear-least-squares.html#cb129-11" tabindex="-1"></a><span class="co">#&gt; [1] 1.4577</span></span></code></pre></div>
<p>hence we have</p>
<p><span class="math display">\[
1.457 = \frac{\theta_0 + \theta_1*0.9895}{1 + \theta_2 exp(0.4*0.9895)}
\]</span></p>
<p><span class="math display">\[
1.457 + 2.164479 *\theta_2 = \theta_0 + \theta_1*0.9895
\]</span></p>
<p><span class="math display">\[
\theta_0 + \theta_1*0.9895 -  2.164479 *\theta_2 = 1.457
\]</span></p>
<p>with 3 equations, we can solve them to get the starting value for <span class="math inline">\(\theta_0,\theta_1, \theta_2\)</span></p>
<p><span class="math display">\[
\theta_0 + 0.0094 \theta_1 + 0 \theta_2 = 2.6722
\]</span></p>
<p><span class="math display">\[
0 \theta_1 + 0 \theta_1 + 83.58967 \theta_2 = 1
\]</span></p>
<p><span class="math display">\[
\theta_0 + \theta_1*0.9895 -  2.164479 *\theta_2 = 1.457
\]</span></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="non-linear-least-squares.html#cb130-1" tabindex="-1"></a><span class="fu">library</span>(matlib)</span>
<span id="cb130-2"><a href="non-linear-least-squares.html#cb130-2" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb130-3"><a href="non-linear-least-squares.html#cb130-3" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.0094</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">83.58967</span>, <span class="dv">1</span>, <span class="fl">0.9895</span>,<span class="sc">-</span><span class="fl">2.164479</span>),</span>
<span id="cb130-4"><a href="non-linear-least-squares.html#cb130-4" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb130-5"><a href="non-linear-least-squares.html#cb130-5" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb130-6"><a href="non-linear-least-squares.html#cb130-6" tabindex="-1"></a>    <span class="at">byrow =</span> T</span>
<span id="cb130-7"><a href="non-linear-least-squares.html#cb130-7" tabindex="-1"></a>)</span>
<span id="cb130-8"><a href="non-linear-least-squares.html#cb130-8" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">2.6722</span>, <span class="dv">1</span>, <span class="fl">1.457</span>)</span>
<span id="cb130-9"><a href="non-linear-least-squares.html#cb130-9" tabindex="-1"></a><span class="fu">showEqn</span>(A, b)</span>
<span id="cb130-10"><a href="non-linear-least-squares.html#cb130-10" tabindex="-1"></a><span class="co">#&gt; 0*x1 + 0.0094*x2        + 0*x3  =  2.6722 </span></span>
<span id="cb130-11"><a href="non-linear-least-squares.html#cb130-11" tabindex="-1"></a><span class="co">#&gt; 0*x1      + 0*x2 + 83.58967*x3  =       1 </span></span>
<span id="cb130-12"><a href="non-linear-least-squares.html#cb130-12" tabindex="-1"></a><span class="co">#&gt; 1*x1 + 0.9895*x2 - 2.164479*x3  =   1.457</span></span>
<span id="cb130-13"><a href="non-linear-least-squares.html#cb130-13" tabindex="-1"></a><span class="fu">Solve</span>(A, b, <span class="at">fractions =</span> F)</span>
<span id="cb130-14"><a href="non-linear-least-squares.html#cb130-14" tabindex="-1"></a><span class="co">#&gt; x1      =  -279.80879739 </span></span>
<span id="cb130-15"><a href="non-linear-least-squares.html#cb130-15" tabindex="-1"></a><span class="co">#&gt;   x2    =   284.27659574 </span></span>
<span id="cb130-16"><a href="non-linear-least-squares.html#cb130-16" tabindex="-1"></a><span class="co">#&gt;     x3  =      0.0119632</span></span></code></pre></div>
<p>Construct manually <a href="non-linear-least-squares.html#gauss-newton-algorithm">Gauss-Newton Algorithm</a></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="non-linear-least-squares.html#cb131-1" tabindex="-1"></a><span class="co">#starting value</span></span>
<span id="cb131-2"><a href="non-linear-least-squares.html#cb131-2" tabindex="-1"></a>theta_0_strt <span class="ot">=</span> <span class="sc">-</span><span class="fl">279.80879739</span></span>
<span id="cb131-3"><a href="non-linear-least-squares.html#cb131-3" tabindex="-1"></a>theta_1_strt <span class="ot">=</span>  <span class="fl">284.27659574</span></span>
<span id="cb131-4"><a href="non-linear-least-squares.html#cb131-4" tabindex="-1"></a>theta_2_strt <span class="ot">=</span> <span class="fl">0.0119632</span></span>
<span id="cb131-5"><a href="non-linear-least-squares.html#cb131-5" tabindex="-1"></a></span>
<span id="cb131-6"><a href="non-linear-least-squares.html#cb131-6" tabindex="-1"></a><span class="co">#model</span></span>
<span id="cb131-7"><a href="non-linear-least-squares.html#cb131-7" tabindex="-1"></a>mod_4 <span class="ot">=</span> <span class="cf">function</span>(theta_0, theta_1, theta_2, x) {</span>
<span id="cb131-8"><a href="non-linear-least-squares.html#cb131-8" tabindex="-1"></a>    (theta_0 <span class="sc">+</span> theta_1 <span class="sc">*</span> x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> theta_2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.4</span> <span class="sc">*</span> x))</span>
<span id="cb131-9"><a href="non-linear-least-squares.html#cb131-9" tabindex="-1"></a>}</span>
<span id="cb131-10"><a href="non-linear-least-squares.html#cb131-10" tabindex="-1"></a></span>
<span id="cb131-11"><a href="non-linear-least-squares.html#cb131-11" tabindex="-1"></a><span class="co">#define a function</span></span>
<span id="cb131-12"><a href="non-linear-least-squares.html#cb131-12" tabindex="-1"></a>f_4 <span class="ot">=</span> <span class="fu">expression</span>((theta_0 <span class="sc">+</span> theta_1 <span class="sc">*</span> x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> theta_2 <span class="sc">*</span> <span class="fu">exp</span>(<span class="fl">0.4</span> <span class="sc">*</span> x)))</span>
<span id="cb131-13"><a href="non-linear-least-squares.html#cb131-13" tabindex="-1"></a></span>
<span id="cb131-14"><a href="non-linear-least-squares.html#cb131-14" tabindex="-1"></a><span class="co">#take the first derivative</span></span>
<span id="cb131-15"><a href="non-linear-least-squares.html#cb131-15" tabindex="-1"></a>df_4.d_theta_0 <span class="ot">=</span> <span class="fu">D</span>(f_4, <span class="st">&#39;theta_0&#39;</span>)</span>
<span id="cb131-16"><a href="non-linear-least-squares.html#cb131-16" tabindex="-1"></a></span>
<span id="cb131-17"><a href="non-linear-least-squares.html#cb131-17" tabindex="-1"></a>df_4.d_theta_1 <span class="ot">=</span> <span class="fu">D</span>(f_4, <span class="st">&#39;theta_1&#39;</span>)</span>
<span id="cb131-18"><a href="non-linear-least-squares.html#cb131-18" tabindex="-1"></a></span>
<span id="cb131-19"><a href="non-linear-least-squares.html#cb131-19" tabindex="-1"></a>df_4.d_theta_2 <span class="ot">=</span> <span class="fu">D</span>(f_4, <span class="st">&#39;theta_2&#39;</span>)</span>
<span id="cb131-20"><a href="non-linear-least-squares.html#cb131-20" tabindex="-1"></a></span>
<span id="cb131-21"><a href="non-linear-least-squares.html#cb131-21" tabindex="-1"></a><span class="co"># save the result of all iterations</span></span>
<span id="cb131-22"><a href="non-linear-least-squares.html#cb131-22" tabindex="-1"></a>theta_vec <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(theta_0_strt, theta_1_strt, theta_2_strt))</span>
<span id="cb131-23"><a href="non-linear-least-squares.html#cb131-23" tabindex="-1"></a>delta <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb131-24"><a href="non-linear-least-squares.html#cb131-24" tabindex="-1"></a></span>
<span id="cb131-25"><a href="non-linear-least-squares.html#cb131-25" tabindex="-1"></a>f_theta <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">eval</span>(</span>
<span id="cb131-26"><a href="non-linear-least-squares.html#cb131-26" tabindex="-1"></a>    f_4,</span>
<span id="cb131-27"><a href="non-linear-least-squares.html#cb131-27" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb131-28"><a href="non-linear-least-squares.html#cb131-28" tabindex="-1"></a>        <span class="at">x =</span> my_data<span class="sc">$</span>x,</span>
<span id="cb131-29"><a href="non-linear-least-squares.html#cb131-29" tabindex="-1"></a>        <span class="at">theta_0 =</span> theta_vec[<span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb131-30"><a href="non-linear-least-squares.html#cb131-30" tabindex="-1"></a>        <span class="at">theta_1 =</span> theta_vec[<span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb131-31"><a href="non-linear-least-squares.html#cb131-31" tabindex="-1"></a>        <span class="at">theta_2 =</span> theta_vec[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb131-32"><a href="non-linear-least-squares.html#cb131-32" tabindex="-1"></a>    )</span>
<span id="cb131-33"><a href="non-linear-least-squares.html#cb131-33" tabindex="-1"></a>))</span>
<span id="cb131-34"><a href="non-linear-least-squares.html#cb131-34" tabindex="-1"></a></span>
<span id="cb131-35"><a href="non-linear-least-squares.html#cb131-35" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb131-36"><a href="non-linear-least-squares.html#cb131-36" tabindex="-1"></a></span>
<span id="cb131-37"><a href="non-linear-least-squares.html#cb131-37" tabindex="-1"></a><span class="cf">repeat</span> {</span>
<span id="cb131-38"><a href="non-linear-least-squares.html#cb131-38" tabindex="-1"></a>    F_theta_0 <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">cbind</span>(</span>
<span id="cb131-39"><a href="non-linear-least-squares.html#cb131-39" tabindex="-1"></a>        <span class="fu">eval</span>(</span>
<span id="cb131-40"><a href="non-linear-least-squares.html#cb131-40" tabindex="-1"></a>            df_4.d_theta_0,</span>
<span id="cb131-41"><a href="non-linear-least-squares.html#cb131-41" tabindex="-1"></a>            <span class="fu">list</span>(</span>
<span id="cb131-42"><a href="non-linear-least-squares.html#cb131-42" tabindex="-1"></a>                <span class="at">x =</span> my_data<span class="sc">$</span>x,</span>
<span id="cb131-43"><a href="non-linear-least-squares.html#cb131-43" tabindex="-1"></a>                <span class="at">theta_0 =</span> theta_vec[<span class="dv">1</span>, i],</span>
<span id="cb131-44"><a href="non-linear-least-squares.html#cb131-44" tabindex="-1"></a>                <span class="at">theta_1 =</span> theta_vec[<span class="dv">2</span>, i],</span>
<span id="cb131-45"><a href="non-linear-least-squares.html#cb131-45" tabindex="-1"></a>                <span class="at">theta_2 =</span> theta_vec[<span class="dv">3</span>, i]</span>
<span id="cb131-46"><a href="non-linear-least-squares.html#cb131-46" tabindex="-1"></a>            )</span>
<span id="cb131-47"><a href="non-linear-least-squares.html#cb131-47" tabindex="-1"></a>        ),</span>
<span id="cb131-48"><a href="non-linear-least-squares.html#cb131-48" tabindex="-1"></a>        <span class="fu">eval</span>(</span>
<span id="cb131-49"><a href="non-linear-least-squares.html#cb131-49" tabindex="-1"></a>            df_4.d_theta_1,</span>
<span id="cb131-50"><a href="non-linear-least-squares.html#cb131-50" tabindex="-1"></a>            <span class="fu">list</span>(</span>
<span id="cb131-51"><a href="non-linear-least-squares.html#cb131-51" tabindex="-1"></a>                <span class="at">x =</span> my_data<span class="sc">$</span>x,</span>
<span id="cb131-52"><a href="non-linear-least-squares.html#cb131-52" tabindex="-1"></a>                <span class="at">theta_0 =</span> theta_vec[<span class="dv">1</span>, i],</span>
<span id="cb131-53"><a href="non-linear-least-squares.html#cb131-53" tabindex="-1"></a>                <span class="at">theta_1 =</span> theta_vec[<span class="dv">2</span>, i],</span>
<span id="cb131-54"><a href="non-linear-least-squares.html#cb131-54" tabindex="-1"></a>                <span class="at">theta_2 =</span> theta_vec[<span class="dv">3</span>, i]</span>
<span id="cb131-55"><a href="non-linear-least-squares.html#cb131-55" tabindex="-1"></a>            )</span>
<span id="cb131-56"><a href="non-linear-least-squares.html#cb131-56" tabindex="-1"></a>        ),</span>
<span id="cb131-57"><a href="non-linear-least-squares.html#cb131-57" tabindex="-1"></a>        <span class="fu">eval</span>(</span>
<span id="cb131-58"><a href="non-linear-least-squares.html#cb131-58" tabindex="-1"></a>            df_4.d_theta_2,</span>
<span id="cb131-59"><a href="non-linear-least-squares.html#cb131-59" tabindex="-1"></a>            <span class="fu">list</span>(</span>
<span id="cb131-60"><a href="non-linear-least-squares.html#cb131-60" tabindex="-1"></a>                <span class="at">x =</span> my_data<span class="sc">$</span>x,</span>
<span id="cb131-61"><a href="non-linear-least-squares.html#cb131-61" tabindex="-1"></a>                <span class="at">theta_0 =</span> theta_vec[<span class="dv">1</span>, i],</span>
<span id="cb131-62"><a href="non-linear-least-squares.html#cb131-62" tabindex="-1"></a>                <span class="at">theta_1 =</span> theta_vec[<span class="dv">2</span>, i],</span>
<span id="cb131-63"><a href="non-linear-least-squares.html#cb131-63" tabindex="-1"></a>                <span class="at">theta_2 =</span> theta_vec[<span class="dv">3</span>, i]</span>
<span id="cb131-64"><a href="non-linear-least-squares.html#cb131-64" tabindex="-1"></a>            )</span>
<span id="cb131-65"><a href="non-linear-least-squares.html#cb131-65" tabindex="-1"></a>        )</span>
<span id="cb131-66"><a href="non-linear-least-squares.html#cb131-66" tabindex="-1"></a>    ))</span>
<span id="cb131-67"><a href="non-linear-least-squares.html#cb131-67" tabindex="-1"></a>    delta[, i] <span class="ot">=</span> (<span class="fu">solve</span>(<span class="fu">t</span>(F_theta_0) <span class="sc">%*%</span> F_theta_0)) <span class="sc">%*%</span> <span class="fu">t</span>(F_theta_0) <span class="sc">%*%</span> (my_data<span class="sc">$</span>y <span class="sc">-</span> f_theta[, i])</span>
<span id="cb131-68"><a href="non-linear-least-squares.html#cb131-68" tabindex="-1"></a>    theta_vec <span class="ot">=</span> <span class="fu">cbind</span>(theta_vec, <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>))</span>
<span id="cb131-69"><a href="non-linear-least-squares.html#cb131-69" tabindex="-1"></a>    theta_vec[, i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">=</span> theta_vec[, i] <span class="sc">+</span> delta[, i]</span>
<span id="cb131-70"><a href="non-linear-least-squares.html#cb131-70" tabindex="-1"></a>    i <span class="ot">=</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb131-71"><a href="non-linear-least-squares.html#cb131-71" tabindex="-1"></a>    </span>
<span id="cb131-72"><a href="non-linear-least-squares.html#cb131-72" tabindex="-1"></a>    f_theta <span class="ot">=</span> <span class="fu">cbind</span>(f_theta, <span class="fu">as.matrix</span>(<span class="fu">eval</span>(</span>
<span id="cb131-73"><a href="non-linear-least-squares.html#cb131-73" tabindex="-1"></a>        f_4,</span>
<span id="cb131-74"><a href="non-linear-least-squares.html#cb131-74" tabindex="-1"></a>        <span class="fu">list</span>(</span>
<span id="cb131-75"><a href="non-linear-least-squares.html#cb131-75" tabindex="-1"></a>            <span class="at">x =</span> my_data<span class="sc">$</span>x,</span>
<span id="cb131-76"><a href="non-linear-least-squares.html#cb131-76" tabindex="-1"></a>            <span class="at">theta_0 =</span> theta_vec[<span class="dv">1</span>, i],</span>
<span id="cb131-77"><a href="non-linear-least-squares.html#cb131-77" tabindex="-1"></a>            <span class="at">theta_1 =</span> theta_vec[<span class="dv">2</span>, i],</span>
<span id="cb131-78"><a href="non-linear-least-squares.html#cb131-78" tabindex="-1"></a>            <span class="at">theta_2 =</span> theta_vec[<span class="dv">3</span>, i]</span>
<span id="cb131-79"><a href="non-linear-least-squares.html#cb131-79" tabindex="-1"></a>        )</span>
<span id="cb131-80"><a href="non-linear-least-squares.html#cb131-80" tabindex="-1"></a>    )))</span>
<span id="cb131-81"><a href="non-linear-least-squares.html#cb131-81" tabindex="-1"></a>    delta <span class="ot">=</span> <span class="fu">cbind</span>(delta, <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>))</span>
<span id="cb131-82"><a href="non-linear-least-squares.html#cb131-82" tabindex="-1"></a>    </span>
<span id="cb131-83"><a href="non-linear-least-squares.html#cb131-83" tabindex="-1"></a>    <span class="co">#convergence criteria based on SSE</span></span>
<span id="cb131-84"><a href="non-linear-least-squares.html#cb131-84" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(<span class="fu">sum</span>((my_data<span class="sc">$</span>y <span class="sc">-</span> f_theta[, i]) <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>((my_data<span class="sc">$</span>y <span class="sc">-</span> f_theta[, i <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">/</span> (<span class="fu">sum</span>((my_data<span class="sc">$</span>y <span class="sc">-</span> f_theta[, i <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">&lt;</span> <span class="fl">0.001</span>) {</span>
<span id="cb131-85"><a href="non-linear-least-squares.html#cb131-85" tabindex="-1"></a>        <span class="cf">break</span></span>
<span id="cb131-86"><a href="non-linear-least-squares.html#cb131-86" tabindex="-1"></a>    }</span>
<span id="cb131-87"><a href="non-linear-least-squares.html#cb131-87" tabindex="-1"></a>}</span>
<span id="cb131-88"><a href="non-linear-least-squares.html#cb131-88" tabindex="-1"></a>delta</span>
<span id="cb131-89"><a href="non-linear-least-squares.html#cb131-89" tabindex="-1"></a><span class="co">#&gt;               [,1]        [,2]        [,3]       [,4]       [,5]       [,6]</span></span>
<span id="cb131-90"><a href="non-linear-least-squares.html#cb131-90" tabindex="-1"></a><span class="co">#&gt; [1,]  2.811840e+02 -0.03929013  0.43160654  0.6904856  0.6746748  0.4056460</span></span>
<span id="cb131-91"><a href="non-linear-least-squares.html#cb131-91" tabindex="-1"></a><span class="co">#&gt; [2,] -2.846545e+02  0.03198446 -0.16403964 -0.2895487 -0.2933345 -0.1734087</span></span>
<span id="cb131-92"><a href="non-linear-least-squares.html#cb131-92" tabindex="-1"></a><span class="co">#&gt; [3,] -1.804567e-05  0.01530258  0.05137285  0.1183271  0.1613129  0.1160404</span></span>
<span id="cb131-93"><a href="non-linear-least-squares.html#cb131-93" tabindex="-1"></a><span class="co">#&gt;             [,7] [,8]</span></span>
<span id="cb131-94"><a href="non-linear-least-squares.html#cb131-94" tabindex="-1"></a><span class="co">#&gt; [1,]  0.09517681   NA</span></span>
<span id="cb131-95"><a href="non-linear-least-squares.html#cb131-95" tabindex="-1"></a><span class="co">#&gt; [2,] -0.03928239   NA</span></span>
<span id="cb131-96"><a href="non-linear-least-squares.html#cb131-96" tabindex="-1"></a><span class="co">#&gt; [3,]  0.03004911   NA</span></span>
<span id="cb131-97"><a href="non-linear-least-squares.html#cb131-97" tabindex="-1"></a>theta_vec</span>
<span id="cb131-98"><a href="non-linear-least-squares.html#cb131-98" tabindex="-1"></a><span class="co">#&gt;              [,1]        [,2]        [,3]        [,4]       [,5]       [,6]</span></span>
<span id="cb131-99"><a href="non-linear-least-squares.html#cb131-99" tabindex="-1"></a><span class="co">#&gt; [1,] -279.8087974  1.37521388  1.33592375  1.76753029  2.4580158  3.1326907</span></span>
<span id="cb131-100"><a href="non-linear-least-squares.html#cb131-100" tabindex="-1"></a><span class="co">#&gt; [2,]  284.2765957 -0.37788712 -0.34590266 -0.50994230 -0.7994910 -1.0928255</span></span>
<span id="cb131-101"><a href="non-linear-least-squares.html#cb131-101" tabindex="-1"></a><span class="co">#&gt; [3,]    0.0119632  0.01194515  0.02724773  0.07862059  0.1969477  0.3582607</span></span>
<span id="cb131-102"><a href="non-linear-least-squares.html#cb131-102" tabindex="-1"></a><span class="co">#&gt;            [,7]       [,8]</span></span>
<span id="cb131-103"><a href="non-linear-least-squares.html#cb131-103" tabindex="-1"></a><span class="co">#&gt; [1,]  3.5383367  3.6335135</span></span>
<span id="cb131-104"><a href="non-linear-least-squares.html#cb131-104" tabindex="-1"></a><span class="co">#&gt; [2,] -1.2662342 -1.3055166</span></span>
<span id="cb131-105"><a href="non-linear-least-squares.html#cb131-105" tabindex="-1"></a><span class="co">#&gt; [3,]  0.4743011  0.5043502</span></span>
<span id="cb131-106"><a href="non-linear-least-squares.html#cb131-106" tabindex="-1"></a></span>
<span id="cb131-107"><a href="non-linear-least-squares.html#cb131-107" tabindex="-1"></a><span class="fu">head</span>(f_theta)</span>
<span id="cb131-108"><a href="non-linear-least-squares.html#cb131-108" tabindex="-1"></a><span class="co">#&gt;           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]</span></span>
<span id="cb131-109"><a href="non-linear-least-squares.html#cb131-109" tabindex="-1"></a><span class="co">#&gt; [1,] -273.8482 1.355410 1.297194 1.633802 2.046023 2.296554 2.389041 2.404144</span></span>
<span id="cb131-110"><a href="non-linear-least-squares.html#cb131-110" tabindex="-1"></a><span class="co">#&gt; [2,] -209.0859 1.268192 1.216738 1.514575 1.863098 2.059505 2.126009 2.135969</span></span>
<span id="cb131-111"><a href="non-linear-least-squares.html#cb131-111" tabindex="-1"></a><span class="co">#&gt; [3,] -190.3323 1.242916 1.193433 1.480136 1.810629 1.992095 2.051603 2.060202</span></span>
<span id="cb131-112"><a href="non-linear-least-squares.html#cb131-112" tabindex="-1"></a><span class="co">#&gt; [4,] -177.1891 1.225196 1.177099 1.456024 1.774000 1.945197 1.999945 2.007625</span></span>
<span id="cb131-113"><a href="non-linear-least-squares.html#cb131-113" tabindex="-1"></a><span class="co">#&gt; [5,] -148.5872 1.186618 1.141549 1.403631 1.694715 1.844154 1.888953 1.894730</span></span>
<span id="cb131-114"><a href="non-linear-least-squares.html#cb131-114" tabindex="-1"></a><span class="co">#&gt; [6,] -119.9585 1.147980 1.105961 1.351301 1.615968 1.744450 1.779859 1.783866</span></span>
<span id="cb131-115"><a href="non-linear-least-squares.html#cb131-115" tabindex="-1"></a></span>
<span id="cb131-116"><a href="non-linear-least-squares.html#cb131-116" tabindex="-1"></a><span class="co"># estimate sigma^2</span></span>
<span id="cb131-117"><a href="non-linear-least-squares.html#cb131-117" tabindex="-1"></a></span>
<span id="cb131-118"><a href="non-linear-least-squares.html#cb131-118" tabindex="-1"></a>sigma2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="fu">nrow</span>(my_data) <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">*</span> (<span class="fu">t</span>(my_data<span class="sc">$</span>y <span class="sc">-</span> (f_theta[, <span class="fu">ncol</span>(f_theta)]))) <span class="sc">%*%</span></span>
<span id="cb131-119"><a href="non-linear-least-squares.html#cb131-119" tabindex="-1"></a>    (my_data<span class="sc">$</span>y <span class="sc">-</span> (f_theta[, <span class="fu">ncol</span>(f_theta)])) <span class="co"># p = 3</span></span>
<span id="cb131-120"><a href="non-linear-least-squares.html#cb131-120" tabindex="-1"></a>sigma2</span>
<span id="cb131-121"><a href="non-linear-least-squares.html#cb131-121" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb131-122"><a href="non-linear-least-squares.html#cb131-122" tabindex="-1"></a><span class="co">#&gt; [1,] 0.0801686</span></span></code></pre></div>
<p>After 8 iterations, my function has converged. And objective function value at convergence is</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="non-linear-least-squares.html#cb132-1" tabindex="-1"></a><span class="fu">sum</span>((my_data<span class="sc">$</span>y <span class="sc">-</span> f_theta[,i])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb132-2"><a href="non-linear-least-squares.html#cb132-2" tabindex="-1"></a><span class="co">#&gt; [1] 19.80165</span></span></code></pre></div>
<p>and the parameters of <span class="math inline">\(\theta\)</span>s are</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="non-linear-least-squares.html#cb133-1" tabindex="-1"></a>theta_vec[,<span class="fu">ncol</span>(theta_vec)]</span>
<span id="cb133-2"><a href="non-linear-least-squares.html#cb133-2" tabindex="-1"></a><span class="co">#&gt; [1]  3.6335135 -1.3055166  0.5043502</span></span></code></pre></div>
<p>and the asymptotic variance covariance matrix is</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="non-linear-least-squares.html#cb134-1" tabindex="-1"></a><span class="fu">as.numeric</span>(sigma2)<span class="sc">*</span><span class="fu">as.matrix</span>(<span class="fu">solve</span>(<span class="fu">crossprod</span>(F_theta_0)))</span>
<span id="cb134-2"><a href="non-linear-least-squares.html#cb134-2" tabindex="-1"></a><span class="co">#&gt;             [,1]        [,2]        [,3]</span></span>
<span id="cb134-3"><a href="non-linear-least-squares.html#cb134-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.11552571 -0.04817428  0.02685848</span></span>
<span id="cb134-4"><a href="non-linear-least-squares.html#cb134-4" tabindex="-1"></a><span class="co">#&gt; [2,] -0.04817428  0.02100861 -0.01158212</span></span>
<span id="cb134-5"><a href="non-linear-least-squares.html#cb134-5" tabindex="-1"></a><span class="co">#&gt; [3,]  0.02685848 -0.01158212  0.00703916</span></span></code></pre></div>
<p>Issue that I encounter in this problem was that it was very sensitive to starting values. when I tried the value of 1 for all <span class="math inline">\(\theta\)</span>s, I have vastly different parameter estimates. Then, I try to use the model interpretation to try to find reasonable starting values.</p>
<p>Check with predefined function in <code>nls</code></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="non-linear-least-squares.html#cb135-1" tabindex="-1"></a>nlin_4 <span class="ot">=</span> <span class="fu">nls</span>(</span>
<span id="cb135-2"><a href="non-linear-least-squares.html#cb135-2" tabindex="-1"></a>    y <span class="sc">~</span> <span class="fu">mod_4</span>(theta_0, theta_1, theta_2, x),</span>
<span id="cb135-3"><a href="non-linear-least-squares.html#cb135-3" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(</span>
<span id="cb135-4"><a href="non-linear-least-squares.html#cb135-4" tabindex="-1"></a>        <span class="at">theta_0 =</span> <span class="sc">-</span><span class="fl">279.80879739</span> ,</span>
<span id="cb135-5"><a href="non-linear-least-squares.html#cb135-5" tabindex="-1"></a>        <span class="at">theta_1 =</span> <span class="fl">284.27659574</span> ,</span>
<span id="cb135-6"><a href="non-linear-least-squares.html#cb135-6" tabindex="-1"></a>        <span class="at">theta_2 =</span> <span class="fl">0.0119632</span></span>
<span id="cb135-7"><a href="non-linear-least-squares.html#cb135-7" tabindex="-1"></a>    ),</span>
<span id="cb135-8"><a href="non-linear-least-squares.html#cb135-8" tabindex="-1"></a>    <span class="at">data =</span> my_data</span>
<span id="cb135-9"><a href="non-linear-least-squares.html#cb135-9" tabindex="-1"></a>)</span>
<span id="cb135-10"><a href="non-linear-least-squares.html#cb135-10" tabindex="-1"></a>nlin_4</span>
<span id="cb135-11"><a href="non-linear-least-squares.html#cb135-11" tabindex="-1"></a><span class="co">#&gt; Nonlinear regression model</span></span>
<span id="cb135-12"><a href="non-linear-least-squares.html#cb135-12" tabindex="-1"></a><span class="co">#&gt;   model: y ~ mod_4(theta_0, theta_1, theta_2, x)</span></span>
<span id="cb135-13"><a href="non-linear-least-squares.html#cb135-13" tabindex="-1"></a><span class="co">#&gt;    data: my_data</span></span>
<span id="cb135-14"><a href="non-linear-least-squares.html#cb135-14" tabindex="-1"></a><span class="co">#&gt; theta_0 theta_1 theta_2 </span></span>
<span id="cb135-15"><a href="non-linear-least-squares.html#cb135-15" tabindex="-1"></a><span class="co">#&gt;  3.6359 -1.3064  0.5053 </span></span>
<span id="cb135-16"><a href="non-linear-least-squares.html#cb135-16" tabindex="-1"></a><span class="co">#&gt;  residual sum-of-squares: 19.8</span></span>
<span id="cb135-17"><a href="non-linear-least-squares.html#cb135-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb135-18"><a href="non-linear-least-squares.html#cb135-18" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 9 </span></span>
<span id="cb135-19"><a href="non-linear-least-squares.html#cb135-19" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 2.294e-07</span></span></code></pre></div>

</div>
</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bates1980relative" class="csl-entry">
Bates, Douglas M, and Donald G Watts. 1980. <span>“Relative Curvature Measures of Nonlinearity.”</span> <em>Journal of the Royal Statistical Society: Series B (Methodological)</em> 42 (1): 1–16.
</div>
<div id="ref-bates1981relative" class="csl-entry">
———. 1981. <span>“A Relative Off Set Orthogonality Convergence Criterion for Nonlinear Least Squares.”</span> <em>Technometrics</em> 23 (2): 179–83.
</div>
<div id="ref-Magel_1987" class="csl-entry">
Magel, Rhonda C, and Doris Hertsgaard. 1987. <span>“A Collinearity Diagnostic for Nonlinear Regression: A Collinearity Diagnostic.”</span> <em>Communications in Statistics-Simulation and Computation</em> 16 (1): 85–97.
</div>
<div id="ref-Schabenberger_2001" class="csl-entry">
Schabenberger, Oliver, and Francis J Pierce. 2001. <em>Contemporary Statistical Models for the Plant and Soil Sciences</em>. CRC press.
</div>
<div id="ref-Laurent_1992" class="csl-entry">
St Laurent, Roy T, and R Dennis Cook. 1992. <span>“Leverage and Superleverage in Nonlinear Regression.”</span> <em>Journal of the American Statistical Association</em> 87 (420): 985–90.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/06-nonlinear-regession.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mikenguyen13/data_analysis/blob/main/06-nonlinear-regession.Rmd",
"text": null
},
"download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
