<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>30.11 Remedies for Staggered DiD Biases | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="30.11 Remedies for Staggered DiD Biases | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="30.11 Remedies for Staggered DiD Biases | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2025-03-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="key-assumptions-of-staggered-did-designs.html"/>
<link rel="next" href="multiple-treatments.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="more-books.html"><a href="more-books.html"><i class="fa fa-check"></i>More books</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
<li class="chapter" data-level="2.1.6" data-path="matrix-theory.html"><a href="matrix-theory.html#cholesky-decomposition"><i class="fa fa-check"></i><b>2.1.6</b> Cholesky Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#skewness"><i class="fa fa-check"></i><b>2.2.6</b> Skewness</a></li>
<li class="chapter" data-level="2.2.7" data-path="probability-theory.html"><a href="probability-theory.html#kurtosis"><i class="fa fa-check"></i><b>2.2.7</b> Kurtosis</a></li>
<li class="chapter" data-level="2.2.8" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.8</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.5</b> Convergence</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.6</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.7</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.1</b> Medium size</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.2</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
<li class="chapter" data-level="3.4.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#general-approach-to-bivariate-statistics"><i class="fa fa-check"></i><b>3.4.4</b> General Approach to Bivariate Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Testing Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i><b>4.1.1</b> Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> Errors in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-role-of-distributions-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> The Role of Distributions in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-test-statistic"><i class="fa fa-check"></i><b>4.1.4</b> The Test Statistic</a></li>
<li class="chapter" data-level="4.1.5" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#critical-values-and-rejection-regions-1"><i class="fa fa-check"></i><b>4.1.5</b> Critical Values and Rejection Regions</a></li>
<li class="chapter" data-level="4.1.6" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#visualizing-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.6</b> Visualizing Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html"><i class="fa fa-check"></i><b>4.2</b> Key Concepts and Definitions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#random-sample"><i class="fa fa-check"></i><b>4.2.1</b> Random Sample</a></li>
<li class="chapter" data-level="4.2.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#sample-statistics"><i class="fa fa-check"></i><b>4.2.2</b> Sample Statistics</a></li>
<li class="chapter" data-level="4.2.3" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#distribution-of-the-sample-mean"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-mean"><i class="fa fa-check"></i><b>4.3.1</b> For Single Mean</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-independent-samples"><i class="fa fa-check"></i><b>4.3.2</b> For Difference of Means, Independent Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-paired-samples"><i class="fa fa-check"></i><b>4.3.3</b> For Difference of Means, Paired Samples</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-two-proportions"><i class="fa fa-check"></i><b>4.3.4</b> For Difference of Two Proportions</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-proportion"><i class="fa fa-check"></i><b>4.3.5</b> For Single Proportion</a></li>
<li class="chapter" data-level="4.3.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-variance"><i class="fa fa-check"></i><b>4.3.6</b> For Single Variance</a></li>
<li class="chapter" data-level="4.3.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.3.7</b> Non-parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.4</b> Two-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-means"><i class="fa fa-check"></i><b>4.4.1</b> For Means</a></li>
<li class="chapter" data-level="4.4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-variances"><i class="fa fa-check"></i><b>4.4.2</b> For Variances</a></li>
<li class="chapter" data-level="4.4.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power"><i class="fa fa-check"></i><b>4.4.3</b> Power</a></li>
<li class="chapter" data-level="4.4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.4.4</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.4.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.4.5</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.5</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#association-tests"><i class="fa fa-check"></i><b>4.5.1</b> Association Tests</a></li>
<li class="chapter" data-level="4.5.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.5.2</b> Ordinal Association</a></li>
<li class="chapter" data-level="4.5.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-trend"><i class="fa fa-check"></i><b>4.5.3</b> Ordinal Trend</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.6</b> Divergence Metrics and Tests for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kolmogorov-smirnov-test-1"><i class="fa fa-check"></i><b>4.6.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#anderson-darling-test-1"><i class="fa fa-check"></i><b>4.6.2</b> Anderson-Darling Test</a></li>
<li class="chapter" data-level="4.6.3" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.6.3</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.6.4" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#cramér-von-mises-test"><i class="fa fa-check"></i><b>4.6.4</b> Cramér-von Mises Test</a></li>
<li class="chapter" data-level="4.6.5" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.6.5</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.6.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.6.6</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.6.7" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#hellinger-distance"><i class="fa fa-check"></i><b>4.6.7</b> Hellinger Distance</a></li>
<li class="chapter" data-level="4.6.8" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#bhattacharyya-distance"><i class="fa fa-check"></i><b>4.6.8</b> Bhattacharyya Distance</a></li>
<li class="chapter" data-level="4.6.9" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#wasserstein-distance"><i class="fa fa-check"></i><b>4.6.9</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.6.10" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#energy-distance"><i class="fa fa-check"></i><b>4.6.10</b> Energy Distance</a></li>
<li class="chapter" data-level="4.6.11" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#total-variation-distance"><i class="fa fa-check"></i><b>4.6.11</b> Total Variation Distance</a></li>
<li class="chapter" data-level="4.6.12" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#summary"><i class="fa fa-check"></i><b>4.6.12</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic) Model</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#infeasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.1</b> Infeasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#feasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.2</b> Feasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.3" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#weighted-least-squares"><i class="fa fa-check"></i><b>5.2.3</b> Weighted Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html"><i class="fa fa-check"></i><b>5.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.3.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#key-quantities-for-inference"><i class="fa fa-check"></i><b>5.3.2</b> Key Quantities for Inference</a></li>
<li class="chapter" data-level="5.3.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#assumptions-of-mle"><i class="fa fa-check"></i><b>5.3.3</b> Assumptions of MLE</a></li>
<li class="chapter" data-level="5.3.4" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#properties-of-mle"><i class="fa fa-check"></i><b>5.3.4</b> Properties of MLE</a></li>
<li class="chapter" data-level="5.3.5" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#practical-considerations"><i class="fa fa-check"></i><b>5.3.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="5.3.6" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#comparison-of-mle-and-ols"><i class="fa fa-check"></i><b>5.3.6</b> Comparison of MLE and OLS</a></li>
<li class="chapter" data-level="5.3.7" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#applications-of-mle"><i class="fa fa-check"></i><b>5.3.7</b> Applications of MLE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html"><i class="fa fa-check"></i><b>5.4</b> Penalized (Regularized) Estimators</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#motivation-for-penalized-estimators"><i class="fa fa-check"></i><b>5.4.1</b> Motivation for Penalized Estimators</a></li>
<li class="chapter" data-level="5.4.2" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#ridge-regression"><i class="fa fa-check"></i><b>5.4.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.4.3" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#lasso-regression"><i class="fa fa-check"></i><b>5.4.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="5.4.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#elastic-net"><i class="fa fa-check"></i><b>5.4.4</b> Elastic Net</a></li>
<li class="chapter" data-level="5.4.5" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#tuning-parameter-selection"><i class="fa fa-check"></i><b>5.4.5</b> Tuning Parameter Selection</a></li>
<li class="chapter" data-level="5.4.6" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#properties-of-penalized-estimators"><i class="fa fa-check"></i><b>5.4.6</b> Properties of Penalized Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="robust-estimators.html"><a href="robust-estimators.html"><i class="fa fa-check"></i><b>5.5</b> Robust Estimators</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="robust-estimators.html"><a href="robust-estimators.html#motivation-for-robust-estimation"><i class="fa fa-check"></i><b>5.5.1</b> Motivation for Robust Estimation</a></li>
<li class="chapter" data-level="5.5.2" data-path="robust-estimators.html"><a href="robust-estimators.html#m-estimators"><i class="fa fa-check"></i><b>5.5.2</b> <span class="math inline">\(M\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.3" data-path="robust-estimators.html"><a href="robust-estimators.html#r-estimators"><i class="fa fa-check"></i><b>5.5.3</b> <span class="math inline">\(R\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.4" data-path="robust-estimators.html"><a href="robust-estimators.html#l-estimators"><i class="fa fa-check"></i><b>5.5.4</b> <span class="math inline">\(L\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.5" data-path="robust-estimators.html"><a href="robust-estimators.html#least-trimmed-squares-lts"><i class="fa fa-check"></i><b>5.5.5</b> Least Trimmed Squares (LTS)</a></li>
<li class="chapter" data-level="5.5.6" data-path="robust-estimators.html"><a href="robust-estimators.html#s-estimators"><i class="fa fa-check"></i><b>5.5.6</b> <span class="math inline">\(S\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.7" data-path="robust-estimators.html"><a href="robust-estimators.html#mm-estimators"><i class="fa fa-check"></i><b>5.5.7</b> <span class="math inline">\(MM\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.8" data-path="robust-estimators.html"><a href="robust-estimators.html#practical-considerations-1"><i class="fa fa-check"></i><b>5.5.8</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="partial-least-squares.html"><a href="partial-least-squares.html"><i class="fa fa-check"></i><b>5.6</b> Partial Least Squares</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="partial-least-squares.html"><a href="partial-least-squares.html#motivation-for-pls"><i class="fa fa-check"></i><b>5.6.1</b> Motivation for PLS</a></li>
<li class="chapter" data-level="5.6.2" data-path="partial-least-squares.html"><a href="partial-least-squares.html#steps-to-construct-pls-components"><i class="fa fa-check"></i><b>5.6.2</b> Steps to Construct PLS Components</a></li>
<li class="chapter" data-level="5.6.3" data-path="partial-least-squares.html"><a href="partial-least-squares.html#properties-of-pls"><i class="fa fa-check"></i><b>5.6.3</b> Properties of PLS</a></li>
<li class="chapter" data-level="5.6.4" data-path="partial-least-squares.html"><a href="partial-least-squares.html#comparison-with-related-methods"><i class="fa fa-check"></i><b>5.6.4</b> Comparison with Related Methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference.html"><a href="inference.html#linear-functions-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Functions of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference.html"><a href="inference.html#nonlinear-functions-of-parameters"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear Functions of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Iterative Optimization</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#derivative-free"><i class="fa fa-check"></i><b>6.2.2</b> Derivative-Free</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic Heuristic</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.4</b> Linearization</a></li>
<li class="chapter" data-level="6.2.5" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.5</b> Hybrid</a></li>
<li class="chapter" data-level="6.2.6" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#comparison-of-nonlinear-optimizers"><i class="fa fa-check"></i><b>6.2.6</b> Comparison of Nonlinear Optimizers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html"><i class="fa fa-check"></i><b>6.3</b> Practical Considerations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#selecting-starting-values"><i class="fa fa-check"></i><b>6.3.1</b> Selecting Starting Values</a></li>
<li class="chapter" data-level="6.3.2" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#handling-constrained-parameters"><i class="fa fa-check"></i><b>6.3.2</b> Handling Constrained Parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#failure-to-converge"><i class="fa fa-check"></i><b>6.3.3</b> Failure to Converge</a></li>
<li class="chapter" data-level="6.3.4" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#convergence-to-a-local-minimum"><i class="fa fa-check"></i><b>6.3.4</b> Convergence to a Local Minimum</a></li>
<li class="chapter" data-level="6.3.5" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#model-adequacy-and-estimation-considerations"><i class="fa fa-check"></i><b>6.3.5</b> Model Adequacy and Estimation Considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>6.4</b> Application</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="application.html"><a href="application.html#nonlinear-estimation-using-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.4.1</b> Nonlinear Estimation Using Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.4.2" data-path="application.html"><a href="application.html#logistic-growth-model"><i class="fa fa-check"></i><b>6.4.2</b> Logistic Growth Model</a></li>
<li class="chapter" data-level="6.4.3" data-path="application.html"><a href="application.html#nonlinear-plateau-model"><i class="fa fa-check"></i><b>6.4.3</b> Nonlinear Plateau Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#logistic-model"><i class="fa fa-check"></i><b>7.1.1</b> Logistic Model</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#sec-likelihood-function-logistic"><i class="fa fa-check"></i><b>7.1.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="7.1.3" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#fisher-information-matrix"><i class="fa fa-check"></i><b>7.1.3</b> Fisher Information Matrix</a></li>
<li class="chapter" data-level="7.1.4" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#inference-in-logistic-regression"><i class="fa fa-check"></i><b>7.1.4</b> Inference in Logistic Regression</a></li>
<li class="chapter" data-level="7.1.5" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#application-logistic-regression"><i class="fa fa-check"></i><b>7.1.5</b> Application: Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#probit-model"><i class="fa fa-check"></i><b>7.2.1</b> Probit Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#application-probit-regression"><i class="fa fa-check"></i><b>7.2.2</b> Application: Probit Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#dataset-overview"><i class="fa fa-check"></i><b>7.3.1</b> Dataset Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-logistic-model"><i class="fa fa-check"></i><b>7.3.2</b> Apply Logistic Model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-probit-model"><i class="fa fa-check"></i><b>7.3.3</b> Apply Probit Model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#the-poisson-distribution"><i class="fa fa-check"></i><b>7.4.1</b> The Poisson Distribution</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#poisson-model"><i class="fa fa-check"></i><b>7.4.2</b> Poisson Model</a></li>
<li class="chapter" data-level="7.4.3" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#link-function-choices"><i class="fa fa-check"></i><b>7.4.3</b> Link Function Choices</a></li>
<li class="chapter" data-level="7.4.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#application-poisson-regression"><i class="fa fa-check"></i><b>7.4.4</b> Application: Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>7.5.1</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#application-negative-binomial-regression"><i class="fa fa-check"></i><b>7.5.2</b> Application: Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.5.3" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#fitting-a-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>7.5.3</b> Fitting a Zero-Inflated Negative Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html"><i class="fa fa-check"></i><b>7.6</b> Quasi-Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#is-quasi-poisson-regression-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.6.1</b> Is Quasi-Poisson Regression a Generalized Linear Model?</a></li>
<li class="chapter" data-level="7.6.2" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#application-quasi-poisson-regression"><i class="fa fa-check"></i><b>7.6.2</b> Application: Quasi-Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.7</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#the-multinomial-distribution"><i class="fa fa-check"></i><b>7.7.1</b> The Multinomial Distribution</a></li>
<li class="chapter" data-level="7.7.2" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#modeling-probabilities-using-log-odds"><i class="fa fa-check"></i><b>7.7.2</b> Modeling Probabilities Using Log-Odds</a></li>
<li class="chapter" data-level="7.7.3" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#softmax-representation"><i class="fa fa-check"></i><b>7.7.3</b> Softmax Representation</a></li>
<li class="chapter" data-level="7.7.4" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#log-odds-ratio-between-two-categories"><i class="fa fa-check"></i><b>7.7.4</b> Log-Odds Ratio Between Two Categories</a></li>
<li class="chapter" data-level="7.7.5" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#estimation"><i class="fa fa-check"></i><b>7.7.5</b> Estimation</a></li>
<li class="chapter" data-level="7.7.6" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#interpretation-of-coefficients"><i class="fa fa-check"></i><b>7.7.6</b> Interpretation of Coefficients</a></li>
<li class="chapter" data-level="7.7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-multinomial-logistic-regression"><i class="fa fa-check"></i><b>7.7.7</b> Application: Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.7.8" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-gamma-regression"><i class="fa fa-check"></i><b>7.7.8</b> Application: Gamma Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html"><i class="fa fa-check"></i><b>7.8</b> Generalization of Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#exponential-family"><i class="fa fa-check"></i><b>7.8.1</b> Exponential Family</a></li>
<li class="chapter" data-level="7.8.2" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#properties-of-glm-exponential-families"><i class="fa fa-check"></i><b>7.8.2</b> Properties of GLM Exponential Families</a></li>
<li class="chapter" data-level="7.8.3" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#structure-of-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.8.3</b> Structure of a Generalized Linear Model</a></li>
<li class="chapter" data-level="7.8.4" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#components-of-a-glm"><i class="fa fa-check"></i><b>7.8.4</b> Components of a GLM</a></li>
<li class="chapter" data-level="7.8.5" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#canonical-link"><i class="fa fa-check"></i><b>7.8.5</b> Canonical Link</a></li>
<li class="chapter" data-level="7.8.6" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inverse-link-functions"><i class="fa fa-check"></i><b>7.8.6</b> Inverse Link Functions</a></li>
<li class="chapter" data-level="7.8.7" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#estimation-of-parameters-in-glms"><i class="fa fa-check"></i><b>7.8.7</b> Estimation of Parameters in GLMs</a></li>
<li class="chapter" data-level="7.8.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inference-1"><i class="fa fa-check"></i><b>7.8.8</b> Inference</a></li>
<li class="chapter" data-level="7.8.9" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#deviance"><i class="fa fa-check"></i><b>7.8.9</b> Deviance</a></li>
<li class="chapter" data-level="7.8.10" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.8.10</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.8.11" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.8.11</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.8.12" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#over-dispersion"><i class="fa fa-check"></i><b>7.8.12</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-linear-mixed-models.html"><a href="sec-linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#motivation-a-repeated-measurements-example"><i class="fa fa-check"></i><b>8.1.1</b> Motivation: A Repeated Measurements Example</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#example-linear-mixed-model-for-repeated-measurements"><i class="fa fa-check"></i><b>8.1.2</b> Example: Linear Mixed Model for Repeated Measurements</a></li>
<li class="chapter" data-level="8.1.3" data-path="dependent-data.html"><a href="dependent-data.html#sec-random-intercepts-model-lmm"><i class="fa fa-check"></i><b>8.1.3</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.4" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models-in-linear-mixed-models"><i class="fa fa-check"></i><b>8.1.4</b> Covariance Models in Linear Mixed Models</a></li>
<li class="chapter" data-level="8.1.5" data-path="dependent-data.html"><a href="dependent-data.html#covariance-structures-in-mixed-models"><i class="fa fa-check"></i><b>8.1.5</b> Covariance Structures in Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.2</b> Estimation in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#interpretation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.1</b> Interpretation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#derivation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.2</b> Derivation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#bayesian-interpretation-of-linear-mixed-models"><i class="fa fa-check"></i><b>8.2.3</b> Bayesian Interpretation of Linear Mixed Models</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>8.2.4</b> Estimating the Variance-Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.3</b> Inference in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-fixed-effects-beta"><i class="fa fa-check"></i><b>8.3.1</b> Inference for Fixed Effects (<span class="math inline">\(\beta\)</span>)</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-variance-components-theta"><i class="fa fa-check"></i><b>8.3.2</b> Inference for Variance Components (<span class="math inline">\(\theta\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria for Model Selection</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-akaike-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.1</b> Akaike Information Criterion</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-corrected-aic-lmm"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-bayesian-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="8.4.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#practical-example-with-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.4</b> Practical Example with Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#example-setup"><i class="fa fa-check"></i><b>8.5.1</b> Example Setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#statistical-model-for-split-plot-designs"><i class="fa fa-check"></i><b>8.5.2</b> Statistical Model for Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#approaches-to-analyzing-split-plot-designs"><i class="fa fa-check"></i><b>8.5.3</b> Approaches to Analyzing Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-split-plot-design"><i class="fa fa-check"></i><b>8.5.4</b> Application: Split-Plot Design</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html#variance-covariance-structure-power-model"><i class="fa fa-check"></i><b>8.7.1</b> Variance-Covariance Structure: Power Model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html"><i class="fa fa-check"></i><b>8.8</b> Application: Mixed Models in Practice</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-1-pulp-brightness-analysis"><i class="fa fa-check"></i><b>8.8.1</b> Example 1: Pulp Brightness Analysis</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-2-penicillin-yield-glmm-with-blocking"><i class="fa fa-check"></i><b>8.8.2</b> Example 2: Penicillin Yield (GLMM with Blocking)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-3-growth-in-rats-over-time"><i class="fa fa-check"></i><b>8.8.3</b> Example 3: Growth in Rats Over Time</a></li>
<li class="chapter" data-level="8.8.4" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-4-tree-water-use-agridat"><i class="fa fa-check"></i><b>8.8.4</b> Example 4: Tree Water Use (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-nonlinear-and-generalized-linear-mixed-models.html"><a href="sec-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-nonlinear-mixed-models.html"><a href="sec-nonlinear-mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Nonlinear Mixed Models</a></li>
<li class="chapter" data-level="9.2" data-path="sec-generalized-linear-mixed-models.html"><a href="sec-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.2</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="9.3" data-path="relationship-between-nlmms-and-glmms.html"><a href="relationship-between-nlmms-and-glmms.html"><i class="fa fa-check"></i><b>9.3</b> Relationship Between NLMMs and GLMMs</a></li>
<li class="chapter" data-level="9.4" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html"><i class="fa fa-check"></i><b>9.4</b> Marginal Properties of GLMMs</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-mean-of-y_i"><i class="fa fa-check"></i><b>9.4.1</b> Marginal Mean of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-variance-of-y_i"><i class="fa fa-check"></i><b>9.4.2</b> Marginal Variance of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.3" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-covariance-of-mathbfy"><i class="fa fa-check"></i><b>9.4.3</b> Marginal Covariance of <span class="math inline">\(\mathbf{y}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.5</b> Estimation in Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.5.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.5.2" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#sec-estimation-by-linearization-glmm"><i class="fa fa-check"></i><b>9.5.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.5.3" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.5.3</b> Estimation by Bayesian Hierarchical Models</a></li>
<li class="chapter" data-level="9.5.4" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#practical-implementation-in-r"><i class="fa fa-check"></i><b>9.5.4</b> Practical Implementation in R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.6</b> Application: Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-data-cbpp-dataset"><i class="fa fa-check"></i><b>9.6.1</b> Binomial Data: CBPP Dataset</a></li>
<li class="chapter" data-level="9.6.2" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#count-data-owl-dataset"><i class="fa fa-check"></i><b>9.6.2</b> Count Data: Owl Dataset</a></li>
<li class="chapter" data-level="9.6.3" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-example-gotway-hessian-fly-data"><i class="fa fa-check"></i><b>9.6.3</b> Binomial Example: Gotway Hessian Fly Data</a></li>
<li class="chapter" data-level="9.6.4" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#nonlinear-mixed-model-yellow-poplar-data"><i class="fa fa-check"></i><b>9.6.4</b> Nonlinear Mixed Model: Yellow Poplar Data</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-nonparametric-regression.html"><a href="sec-nonparametric-regression.html"><i class="fa fa-check"></i><b>10</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html"><i class="fa fa-check"></i><b>10.1</b> Why Nonparametric?</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html#flexibility"><i class="fa fa-check"></i><b>10.1.1</b> Flexibility</a></li>
<li class="chapter" data-level="10.1.2" data-path="why-nonparametric.html"><a href="why-nonparametric.html#fewer-assumptions"><i class="fa fa-check"></i><b>10.1.2</b> Fewer Assumptions</a></li>
<li class="chapter" data-level="10.1.3" data-path="why-nonparametric.html"><a href="why-nonparametric.html#interpretability"><i class="fa fa-check"></i><b>10.1.3</b> Interpretability</a></li>
<li class="chapter" data-level="10.1.4" data-path="why-nonparametric.html"><a href="why-nonparametric.html#practical-considerations-3"><i class="fa fa-check"></i><b>10.1.4</b> Practical Considerations</a></li>
<li class="chapter" data-level="10.1.5" data-path="why-nonparametric.html"><a href="why-nonparametric.html#balancing-parametric-and-nonparametric-approaches"><i class="fa fa-check"></i><b>10.1.5</b> Balancing Parametric and Nonparametric Approaches</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html"><i class="fa fa-check"></i><b>10.2</b> Basic Concepts in Nonparametric Estimation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>10.2.1</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="10.2.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#kernel-smoothing-and-local-averages"><i class="fa fa-check"></i><b>10.2.2</b> Kernel Smoothing and Local Averages</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html"><i class="fa fa-check"></i><b>10.3</b> Kernel Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#basic-setup"><i class="fa fa-check"></i><b>10.3.1</b> Basic Setup</a></li>
<li class="chapter" data-level="10.3.2" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-nadaraya-watson-kernel-estimator"><i class="fa fa-check"></i><b>10.3.2</b> Nadaraya-Watson Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-priestley-chao-kernel-estimator"><i class="fa fa-check"></i><b>10.3.3</b> Priestley–Chao Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.4" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-gasser-mueller-kernel-estimator"><i class="fa fa-check"></i><b>10.3.4</b> Gasser–Müller Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.5" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#comparison-of-kernel-based-estimators"><i class="fa fa-check"></i><b>10.3.5</b> Comparison of Kernel-Based Estimators</a></li>
<li class="chapter" data-level="10.3.6" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#bandwidth-selection"><i class="fa fa-check"></i><b>10.3.6</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.3.7" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#asymptotic-properties"><i class="fa fa-check"></i><b>10.3.7</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="10.3.8" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#derivation-of-the-nadaraya-watson-estimator"><i class="fa fa-check"></i><b>10.3.8</b> Derivation of the Nadaraya-Watson Estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html"><i class="fa fa-check"></i><b>10.4</b> Local Polynomial Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#local-polynomial-fitting"><i class="fa fa-check"></i><b>10.4.1</b> Local Polynomial Fitting</a></li>
<li class="chapter" data-level="10.4.2" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#mathematical-form-of-the-solution"><i class="fa fa-check"></i><b>10.4.2</b> Mathematical Form of the Solution</a></li>
<li class="chapter" data-level="10.4.3" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bias-variance-and-asymptotics"><i class="fa fa-check"></i><b>10.4.3</b> Bias, Variance, and Asymptotics</a></li>
<li class="chapter" data-level="10.4.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#sec-special-case-local-linear-regression"><i class="fa fa-check"></i><b>10.4.4</b> Special Case: Local Linear Regression</a></li>
<li class="chapter" data-level="10.4.5" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bandwidth-selection-1"><i class="fa fa-check"></i><b>10.4.5</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.4.6" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#asymptotic-properties-summary"><i class="fa fa-check"></i><b>10.4.6</b> Asymptotic Properties Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html"><i class="fa fa-check"></i><b>10.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#properties-and-form-of-the-smoothing-spline"><i class="fa fa-check"></i><b>10.5.1</b> Properties and Form of the Smoothing Spline</a></li>
<li class="chapter" data-level="10.5.2" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#choice-of-lambda"><i class="fa fa-check"></i><b>10.5.2</b> Choice of <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="10.5.3" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#connection-to-reproducing-kernel-hilbert-spaces"><i class="fa fa-check"></i><b>10.5.3</b> Connection to Reproducing Kernel Hilbert Spaces</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.6</b> Confidence Intervals in Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#asymptotic-normality"><i class="fa fa-check"></i><b>10.6.1</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="10.6.2" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#bootstrap-methods"><i class="fa fa-check"></i><b>10.6.2</b> Bootstrap Methods</a></li>
<li class="chapter" data-level="10.6.3" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#practical-considerations-4"><i class="fa fa-check"></i><b>10.6.3</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html"><i class="fa fa-check"></i><b>10.7</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#estimation-via-penalized-likelihood"><i class="fa fa-check"></i><b>10.7.1</b> Estimation via Penalized Likelihood</a></li>
<li class="chapter" data-level="10.7.2" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#interpretation-of-gams"><i class="fa fa-check"></i><b>10.7.2</b> Interpretation of GAMs</a></li>
<li class="chapter" data-level="10.7.3" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#model-selection-and-smoothing-parameter-estimation"><i class="fa fa-check"></i><b>10.7.3</b> Model Selection and Smoothing Parameter Estimation</a></li>
<li class="chapter" data-level="10.7.4" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#extensions-of-gams"><i class="fa fa-check"></i><b>10.7.4</b> Extensions of GAMs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html"><i class="fa fa-check"></i><b>10.8</b> Regression Trees and Random Forests</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-regression-trees"><i class="fa fa-check"></i><b>10.8.1</b> Regression Trees</a></li>
<li class="chapter" data-level="10.8.2" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-random-forests"><i class="fa fa-check"></i><b>10.8.2</b> Random Forests</a></li>
<li class="chapter" data-level="10.8.3" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#theoretical-insights"><i class="fa fa-check"></i><b>10.8.3</b> Theoretical Insights</a></li>
<li class="chapter" data-level="10.8.4" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#feature-importance-in-random-forests"><i class="fa fa-check"></i><b>10.8.4</b> Feature Importance in Random Forests</a></li>
<li class="chapter" data-level="10.8.5" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#advantages-and-limitations-of-tree-based-methods"><i class="fa fa-check"></i><b>10.8.5</b> Advantages and Limitations of Tree-Based Methods</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html"><i class="fa fa-check"></i><b>10.9</b> Wavelet Regression</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-series-expansion"><i class="fa fa-check"></i><b>10.9.1</b> Wavelet Series Expansion</a></li>
<li class="chapter" data-level="10.9.2" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-regression-model"><i class="fa fa-check"></i><b>10.9.2</b> Wavelet Regression Model</a></li>
<li class="chapter" data-level="10.9.3" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-shrinkage-and-thresholding"><i class="fa fa-check"></i><b>10.9.3</b> Wavelet Shrinkage and Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.10</b> Multivariate Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#the-curse-of-dimensionality"><i class="fa fa-check"></i><b>10.10.1</b> The Curse of Dimensionality</a></li>
<li class="chapter" data-level="10.10.2" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-kernel-regression"><i class="fa fa-check"></i><b>10.10.2</b> Multivariate Kernel Regression</a></li>
<li class="chapter" data-level="10.10.3" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-splines"><i class="fa fa-check"></i><b>10.10.3</b> Multivariate Splines</a></li>
<li class="chapter" data-level="10.10.4" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#additive-models-gams"><i class="fa fa-check"></i><b>10.10.4</b> Additive Models (GAMs)</a></li>
<li class="chapter" data-level="10.10.5" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#radial-basis-functions"><i class="fa fa-check"></i><b>10.10.5</b> Radial Basis Functions</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html"><i class="fa fa-check"></i><b>10.11</b> Conclusion: The Evolving Landscape of Regression Analysis</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#key-takeaways-1"><i class="fa fa-check"></i><b>10.11.1</b> Key Takeaways</a></li>
<li class="chapter" data-level="10.11.2" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#the-art-and-science-of-regression"><i class="fa fa-check"></i><b>10.11.2</b> The Art and Science of Regression</a></li>
<li class="chapter" data-level="10.11.3" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#looking-forward"><i class="fa fa-check"></i><b>10.11.3</b> Looking Forward</a></li>
<li class="chapter" data-level="10.11.4" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#final-thoughts"><i class="fa fa-check"></i><b>10.11.4</b> Final Thoughts</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="11" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>11</b> Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>11.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-types.html"><a href="data-types.html#qualitative-vs.-quantitative-data"><i class="fa fa-check"></i><b>11.1.1</b> Qualitative vs. Quantitative Data</a></li>
<li class="chapter" data-level="11.1.2" data-path="data-types.html"><a href="data-types.html#other-ways-to-classify-data"><i class="fa fa-check"></i><b>11.1.2</b> Other Ways to Classify Data</a></li>
<li class="chapter" data-level="11.1.3" data-path="data-types.html"><a href="data-types.html#data-by-observational-structure-over-time"><i class="fa fa-check"></i><b>11.1.3</b> Data by Observational Structure Over Time</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sec-cross-sectional-data.html"><a href="sec-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.2</b> Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html"><i class="fa fa-check"></i><b>11.3</b> Time Series Data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#statistical-properties-of-time-series-models"><i class="fa fa-check"></i><b>11.3.1</b> Statistical Properties of Time Series Models</a></li>
<li class="chapter" data-level="11.3.2" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#common-time-series-processes"><i class="fa fa-check"></i><b>11.3.2</b> Common Time Series Processes</a></li>
<li class="chapter" data-level="11.3.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#deterministic-time-trends"><i class="fa fa-check"></i><b>11.3.3</b> Deterministic Time Trends</a></li>
<li class="chapter" data-level="11.3.4" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#violations-of-exogeneity-in-time-series-models"><i class="fa fa-check"></i><b>11.3.4</b> Violations of Exogeneity in Time Series Models</a></li>
<li class="chapter" data-level="11.3.5" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#consequences-of-exogeneity-violations"><i class="fa fa-check"></i><b>11.3.5</b> Consequences of Exogeneity Violations</a></li>
<li class="chapter" data-level="11.3.6" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#highly-persistent-data"><i class="fa fa-check"></i><b>11.3.6</b> Highly Persistent Data</a></li>
<li class="chapter" data-level="11.3.7" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-unit-root-testing"><i class="fa fa-check"></i><b>11.3.7</b> Unit Root Testing</a></li>
<li class="chapter" data-level="11.3.8" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-newey-west-standard-errors"><i class="fa fa-check"></i><b>11.3.8</b> Newey-West Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.4</b> Repeated Cross-Sectional Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#key-characteristics"><i class="fa fa-check"></i><b>11.4.1</b> Key Characteristics</a></li>
<li class="chapter" data-level="11.4.2" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#statistical-modeling-for-repeated-cross-sections"><i class="fa fa-check"></i><b>11.4.2</b> Statistical Modeling for Repeated Cross-Sections</a></li>
<li class="chapter" data-level="11.4.3" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#advantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.3</b> Advantages of Repeated Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.4.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#disadvantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.4</b> Disadvantages of Repeated Cross-Sectional Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html"><i class="fa fa-check"></i><b>11.5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sec-panel-data.html"><a href="sec-panel-data.html#advantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.1</b> Advantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.2" data-path="sec-panel-data.html"><a href="sec-panel-data.html#disadvantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.2</b> Disadvantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.3" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sources-of-variation-in-panel-data"><i class="fa fa-check"></i><b>11.5.3</b> Sources of Variation in Panel Data</a></li>
<li class="chapter" data-level="11.5.4" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-pooled-ols-estimator"><i class="fa fa-check"></i><b>11.5.4</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="11.5.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>11.5.5</b> Individual-Specific Effects Model</a></li>
<li class="chapter" data-level="11.5.6" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-random-effects-estimator"><i class="fa fa-check"></i><b>11.5.6</b> Random Effects Estimator</a></li>
<li class="chapter" data-level="11.5.7" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-fixed-effects-estimator"><i class="fa fa-check"></i><b>11.5.7</b> Fixed Effects Estimator</a></li>
<li class="chapter" data-level="11.5.8" data-path="sec-panel-data.html"><a href="sec-panel-data.html#tests-for-assumptions-in-panel-data-analysis"><i class="fa fa-check"></i><b>11.5.8</b> Tests for Assumptions in Panel Data Analysis</a></li>
<li class="chapter" data-level="11.5.9" data-path="sec-panel-data.html"><a href="sec-panel-data.html#model-selection-in-panel-data"><i class="fa fa-check"></i><b>11.5.9</b> Model Selection in Panel Data</a></li>
<li class="chapter" data-level="11.5.10" data-path="sec-panel-data.html"><a href="sec-panel-data.html#alternative-estimators"><i class="fa fa-check"></i><b>11.5.10</b> Alternative Estimators</a></li>
<li class="chapter" data-level="11.5.11" data-path="sec-panel-data.html"><a href="sec-panel-data.html#application-1"><i class="fa fa-check"></i><b>11.5.11</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="choosing-the-right-type-of-data.html"><a href="choosing-the-right-type-of-data.html"><i class="fa fa-check"></i><b>11.6</b> Choosing the Right Type of Data</a></li>
<li class="chapter" data-level="11.7" data-path="data-quality-and-ethical-considerations.html"><a href="data-quality-and-ethical-considerations.html"><i class="fa fa-check"></i><b>11.7</b> Data Quality and Ethical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>12</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>12.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization-z-score-normalization"><i class="fa fa-check"></i><b>12.1.1</b> Standardization (Z-score Normalization)</a></li>
<li class="chapter" data-level="12.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling-normalization"><i class="fa fa-check"></i><b>12.1.2</b> Min-Max Scaling (Normalization)</a></li>
<li class="chapter" data-level="12.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-root-and-cube-root-transformations"><i class="fa fa-check"></i><b>12.1.3</b> Square Root and Cube Root Transformations</a></li>
<li class="chapter" data-level="12.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-logarithmic-transformation"><i class="fa fa-check"></i><b>12.1.4</b> Logarithmic Transformation</a></li>
<li class="chapter" data-level="12.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential-transformation"><i class="fa fa-check"></i><b>12.1.5</b> Exponential Transformation</a></li>
<li class="chapter" data-level="12.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-transformation"><i class="fa fa-check"></i><b>12.1.6</b> Power Transformation</a></li>
<li class="chapter" data-level="12.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-reciprocal-transformation"><i class="fa fa-check"></i><b>12.1.7</b> Inverse (Reciprocal) Transformation</a></li>
<li class="chapter" data-level="12.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine-transformation"><i class="fa fa-check"></i><b>12.1.8</b> Hyperbolic Arcsine Transformation</a></li>
<li class="chapter" data-level="12.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-normalization-rank-based-transformation"><i class="fa fa-check"></i><b>12.1.9</b> Ordered Quantile Normalization (Rank-Based Transformation)</a></li>
<li class="chapter" data-level="12.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>12.1.10</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="12.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-transformation"><i class="fa fa-check"></i><b>12.1.11</b> Inverse Hyperbolic Sine Transformation</a></li>
<li class="chapter" data-level="12.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-box-cox-transformation"><i class="fa fa-check"></i><b>12.1.12</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="12.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>12.1.13</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="12.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss-transformation"><i class="fa fa-check"></i><b>12.1.14</b> RankGauss Transformation</a></li>
<li class="chapter" data-level="12.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#automatically-choosing-the-best-transformation"><i class="fa fa-check"></i><b>12.1.15</b> Automatically Choosing the Best Transformation</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>12.2</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="categorical-variables.html"><a href="categorical-variables.html#one-hot-encoding-dummy-variables"><i class="fa fa-check"></i><b>12.2.1</b> One-Hot Encoding (Dummy Variables)</a></li>
<li class="chapter" data-level="12.2.2" data-path="categorical-variables.html"><a href="categorical-variables.html#label-encoding"><i class="fa fa-check"></i><b>12.2.2</b> Label Encoding</a></li>
<li class="chapter" data-level="12.2.3" data-path="categorical-variables.html"><a href="categorical-variables.html#feature-hashing-hash-encoding"><i class="fa fa-check"></i><b>12.2.3</b> Feature Hashing (Hash Encoding)</a></li>
<li class="chapter" data-level="12.2.4" data-path="categorical-variables.html"><a href="categorical-variables.html#binary-encoding"><i class="fa fa-check"></i><b>12.2.4</b> Binary Encoding</a></li>
<li class="chapter" data-level="12.2.5" data-path="categorical-variables.html"><a href="categorical-variables.html#base-n-encoding-generalized-binary-encoding"><i class="fa fa-check"></i><b>12.2.5</b> Base-N Encoding (Generalized Binary Encoding)</a></li>
<li class="chapter" data-level="12.2.6" data-path="categorical-variables.html"><a href="categorical-variables.html#frequency-encoding"><i class="fa fa-check"></i><b>12.2.6</b> Frequency Encoding</a></li>
<li class="chapter" data-level="12.2.7" data-path="categorical-variables.html"><a href="categorical-variables.html#target-encoding-mean-encoding"><i class="fa fa-check"></i><b>12.2.7</b> Target Encoding (Mean Encoding)</a></li>
<li class="chapter" data-level="12.2.8" data-path="categorical-variables.html"><a href="categorical-variables.html#ordinal-encoding"><i class="fa fa-check"></i><b>12.2.8</b> Ordinal Encoding</a></li>
<li class="chapter" data-level="12.2.9" data-path="categorical-variables.html"><a href="categorical-variables.html#weight-of-evidence-encoding"><i class="fa fa-check"></i><b>12.2.9</b> Weight of Evidence Encoding</a></li>
<li class="chapter" data-level="12.2.10" data-path="categorical-variables.html"><a href="categorical-variables.html#helmert-encoding"><i class="fa fa-check"></i><b>12.2.10</b> Helmert Encoding</a></li>
<li class="chapter" data-level="12.2.11" data-path="categorical-variables.html"><a href="categorical-variables.html#probability-ratio-encoding"><i class="fa fa-check"></i><b>12.2.11</b> Probability Ratio Encoding</a></li>
<li class="chapter" data-level="12.2.12" data-path="categorical-variables.html"><a href="categorical-variables.html#backward-difference-encoding"><i class="fa fa-check"></i><b>12.2.12</b> Backward Difference Encoding</a></li>
<li class="chapter" data-level="12.2.13" data-path="categorical-variables.html"><a href="categorical-variables.html#leave-one-out-encoding"><i class="fa fa-check"></i><b>12.2.13</b> Leave-One-Out Encoding</a></li>
<li class="chapter" data-level="12.2.14" data-path="categorical-variables.html"><a href="categorical-variables.html#james-stein-encoding"><i class="fa fa-check"></i><b>12.2.14</b> James-Stein Encoding</a></li>
<li class="chapter" data-level="12.2.15" data-path="categorical-variables.html"><a href="categorical-variables.html#m-estimator-encoding"><i class="fa fa-check"></i><b>12.2.15</b> M-Estimator Encoding</a></li>
<li class="chapter" data-level="12.2.16" data-path="categorical-variables.html"><a href="categorical-variables.html#thermometer-encoding"><i class="fa fa-check"></i><b>12.2.16</b> Thermometer Encoding</a></li>
<li class="chapter" data-level="12.2.17" data-path="categorical-variables.html"><a href="categorical-variables.html#choosing-the-right-encoding-method"><i class="fa fa-check"></i><b>12.2.17</b> Choosing the Right Encoding Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>13</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html"><i class="fa fa-check"></i><b>13.1</b> Introduction to Missing Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#types-of-imputation"><i class="fa fa-check"></i><b>13.1.1</b> Types of Imputation</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#when-and-why-to-use-imputation"><i class="fa fa-check"></i><b>13.1.2</b> When and Why to Use Imputation</a></li>
<li class="chapter" data-level="13.1.3" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#importance-of-missing-data-treatment-in-statistical-modeling"><i class="fa fa-check"></i><b>13.1.3</b> Importance of Missing Data Treatment in Statistical Modeling</a></li>
<li class="chapter" data-level="13.1.4" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#prevalence-of-missing-data-across-domains"><i class="fa fa-check"></i><b>13.1.4</b> Prevalence of Missing Data Across Domains</a></li>
<li class="chapter" data-level="13.1.5" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#practical-considerations-for-imputation"><i class="fa fa-check"></i><b>13.1.5</b> Practical Considerations for Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html"><i class="fa fa-check"></i><b>13.2</b> Theoretical Foundations of Missing Data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#definition-and-classification-of-missing-data"><i class="fa fa-check"></i><b>13.2.1</b> Definition and Classification of Missing Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>13.2.2</b> Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.2.3" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#relationship-between-mechanisms-and-ignorability"><i class="fa fa-check"></i><b>13.2.3</b> Relationship Between Mechanisms and Ignorability</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html"><i class="fa fa-check"></i><b>13.3</b> Diagnosing the Missing Data Mechanism</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#descriptive-methods"><i class="fa fa-check"></i><b>13.3.1</b> Descriptive Methods</a></li>
<li class="chapter" data-level="13.3.2" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#statistical-tests-for-missing-data-mechanisms"><i class="fa fa-check"></i><b>13.3.2</b> Statistical Tests for Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.3.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#assessing-mar-and-mnar"><i class="fa fa-check"></i><b>13.3.3</b> Assessing MAR and MNAR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html"><i class="fa fa-check"></i><b>13.4</b> Methods for Handling Missing Data</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#basic-methods"><i class="fa fa-check"></i><b>13.4.1</b> Basic Methods</a></li>
<li class="chapter" data-level="13.4.2" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#single-imputation-techniques"><i class="fa fa-check"></i><b>13.4.2</b> Single Imputation Techniques</a></li>
<li class="chapter" data-level="13.4.3" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#machine-learning-and-modern-approaches"><i class="fa fa-check"></i><b>13.4.3</b> Machine Learning and Modern Approaches</a></li>
<li class="chapter" data-level="13.4.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>13.4.4</b> Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html"><i class="fa fa-check"></i><b>13.5</b> Evaluation of Imputation Methods</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#statistical-metrics-for-assessing-imputation-quality"><i class="fa fa-check"></i><b>13.5.1</b> Statistical Metrics for Assessing Imputation Quality</a></li>
<li class="chapter" data-level="13.5.2" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#bias-variance-tradeoff-in-imputation"><i class="fa fa-check"></i><b>13.5.2</b> Bias-Variance Tradeoff in Imputation</a></li>
<li class="chapter" data-level="13.5.3" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>13.5.3</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="13.5.4" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#validation-using-simulated-data-and-real-world-case-studies"><i class="fa fa-check"></i><b>13.5.4</b> Validation Using Simulated Data and Real-World Case Studies</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>13.6</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="13.7" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html"><i class="fa fa-check"></i><b>13.7</b> Challenges and Ethical Considerations</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#challenges-in-high-dimensional-data"><i class="fa fa-check"></i><b>13.7.1</b> Challenges in High-Dimensional Data</a></li>
<li class="chapter" data-level="13.7.2" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#missing-data-in-big-data-contexts"><i class="fa fa-check"></i><b>13.7.2</b> Missing Data in Big Data Contexts</a></li>
<li class="chapter" data-level="13.7.3" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#ethical-concerns"><i class="fa fa-check"></i><b>13.7.3</b> Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html"><i class="fa fa-check"></i><b>13.8</b> Emerging Trends in Missing Data Handling</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#advances-in-neural-network-approaches"><i class="fa fa-check"></i><b>13.8.1</b> Advances in Neural Network Approaches</a></li>
<li class="chapter" data-level="13.8.2" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#integration-with-reinforcement-learning"><i class="fa fa-check"></i><b>13.8.2</b> Integration with Reinforcement Learning</a></li>
<li class="chapter" data-level="13.8.3" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#synthetic-data-generation-for-missing-data"><i class="fa fa-check"></i><b>13.8.3</b> Synthetic Data Generation for Missing Data</a></li>
<li class="chapter" data-level="13.8.4" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#federated-learning-and-privacy-preserving-imputation"><i class="fa fa-check"></i><b>13.8.4</b> Federated Learning and Privacy-Preserving Imputation</a></li>
<li class="chapter" data-level="13.8.5" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#imputation-in-streaming-and-online-data-environments"><i class="fa fa-check"></i><b>13.8.5</b> Imputation in Streaming and Online Data Environments</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html"><i class="fa fa-check"></i><b>13.9</b> Application of Imputation</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="application-of-imputation.html"><a href="application-of-imputation.html#visualizing-missing-data"><i class="fa fa-check"></i><b>13.9.1</b> Visualizing Missing Data</a></li>
<li class="chapter" data-level="13.9.2" data-path="application-of-imputation.html"><a href="application-of-imputation.html#how-many-imputations"><i class="fa fa-check"></i><b>13.9.2</b> How Many Imputations?</a></li>
<li class="chapter" data-level="13.9.3" data-path="application-of-imputation.html"><a href="application-of-imputation.html#generating-missing-data-for-demonstration"><i class="fa fa-check"></i><b>13.9.3</b> Generating Missing Data for Demonstration</a></li>
<li class="chapter" data-level="13.9.4" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-mean-median-and-mode"><i class="fa fa-check"></i><b>13.9.4</b> Imputation with Mean, Median, and Mode</a></li>
<li class="chapter" data-level="13.9.5" data-path="application-of-imputation.html"><a href="application-of-imputation.html#k-nearest-neighbors-knn-imputation"><i class="fa fa-check"></i><b>13.9.5</b> K-Nearest Neighbors (KNN) Imputation</a></li>
<li class="chapter" data-level="13.9.6" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-decision-trees-rpart"><i class="fa fa-check"></i><b>13.9.6</b> Imputation with Decision Trees (rpart)</a></li>
<li class="chapter" data-level="13.9.7" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>13.9.7</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="13.9.8" data-path="application-of-imputation.html"><a href="application-of-imputation.html#amelia"><i class="fa fa-check"></i><b>13.9.8</b> Amelia</a></li>
<li class="chapter" data-level="13.9.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html#missforest"><i class="fa fa-check"></i><b>13.9.9</b> missForest</a></li>
<li class="chapter" data-level="13.9.10" data-path="application-of-imputation.html"><a href="application-of-imputation.html#hmisc"><i class="fa fa-check"></i><b>13.9.10</b> Hmisc</a></li>
<li class="chapter" data-level="13.9.11" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mi"><i class="fa fa-check"></i><b>13.9.11</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="model-specification-tests.html"><a href="model-specification-tests.html"><i class="fa fa-check"></i><b>14</b> Model Specification Tests</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html"><i class="fa fa-check"></i><b>14.1</b> Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-wald-test-nested"><i class="fa fa-check"></i><b>14.1.1</b> Wald Test</a></li>
<li class="chapter" data-level="14.1.2" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-likelihood-ratio-test-nested"><i class="fa fa-check"></i><b>14.1.2</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="14.1.3" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-f-test-for-linear-regression-nested"><i class="fa fa-check"></i><b>14.1.3</b> F-Test (for Linear Regression)</a></li>
<li class="chapter" data-level="14.1.4" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-chow-test"><i class="fa fa-check"></i><b>14.1.4</b> Chow Test</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html"><i class="fa fa-check"></i><b>14.2</b> Non-Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-vuong-test"><i class="fa fa-check"></i><b>14.2.1</b> Vuong Test</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-davidson--mackinnon-j-test"><i class="fa fa-check"></i><b>14.2.2</b> Davidson–MacKinnon J-Test</a></li>
<li class="chapter" data-level="14.2.3" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#adjusted-r2"><i class="fa fa-check"></i><b>14.2.3</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="14.2.4" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#comparing-models-with-transformed-dependent-variables"><i class="fa fa-check"></i><b>14.2.4</b> Comparing Models with Transformed Dependent Variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html"><i class="fa fa-check"></i><b>14.3</b> Heteroskedasticity Tests</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-breusch--pagan-test"><i class="fa fa-check"></i><b>14.3.1</b> Breusch–Pagan Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-white-test-hetero"><i class="fa fa-check"></i><b>14.3.2</b> White Test</a></li>
<li class="chapter" data-level="14.3.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-goldfeld--quandt-test"><i class="fa fa-check"></i><b>14.3.3</b> Goldfeld–Quandt Test</a></li>
<li class="chapter" data-level="14.3.4" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-park-test"><i class="fa fa-check"></i><b>14.3.4</b> Park Test</a></li>
<li class="chapter" data-level="14.3.5" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-glejser-test"><i class="fa fa-check"></i><b>14.3.5</b> Glejser Test</a></li>
<li class="chapter" data-level="14.3.6" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#summary-of-heteroskedasticity-tests"><i class="fa fa-check"></i><b>14.3.6</b> Summary of Heteroskedasticity Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html"><i class="fa fa-check"></i><b>14.4</b> Functional Form Tests</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-ramsey-reset-test"><i class="fa fa-check"></i><b>14.4.1</b> Ramsey RESET Test (Regression Equation Specification Error Test)</a></li>
<li class="chapter" data-level="14.4.2" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-harvey--collier-test"><i class="fa fa-check"></i><b>14.4.2</b> Harvey–Collier Test</a></li>
<li class="chapter" data-level="14.4.3" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-rainbow-test"><i class="fa fa-check"></i><b>14.4.3</b> Rainbow Test</a></li>
<li class="chapter" data-level="14.4.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html#summary-of-functional-form-tests"><i class="fa fa-check"></i><b>14.4.4</b> Summary of Functional Form Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html"><i class="fa fa-check"></i><b>14.5</b> Autocorrelation Tests</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-durbin--watson-test"><i class="fa fa-check"></i><b>14.5.1</b> Durbin–Watson Test</a></li>
<li class="chapter" data-level="14.5.2" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-breusch--godfrey-test"><i class="fa fa-check"></i><b>14.5.2</b> Breusch–Godfrey Test</a></li>
<li class="chapter" data-level="14.5.3" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-ljung--box-test"><i class="fa fa-check"></i><b>14.5.3</b> Ljung–Box Test (or Box–Pierce Test)</a></li>
<li class="chapter" data-level="14.5.4" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-runs-test"><i class="fa fa-check"></i><b>14.5.4</b> Runs Test</a></li>
<li class="chapter" data-level="14.5.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#summary-of-autocorrelation-tests"><i class="fa fa-check"></i><b>14.5.5</b> Summary of Autocorrelation Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html"><i class="fa fa-check"></i><b>14.6</b> Multicollinearity Diagnostics</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-variance-inflation-factor"><i class="fa fa-check"></i><b>14.6.1</b> Variance Inflation Factor</a></li>
<li class="chapter" data-level="14.6.2" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-tolerance-statistic"><i class="fa fa-check"></i><b>14.6.2</b> Tolerance Statistic</a></li>
<li class="chapter" data-level="14.6.3" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-condition-index-and-eigenvalue-decomposition"><i class="fa fa-check"></i><b>14.6.3</b> Condition Index and Eigenvalue Decomposition</a></li>
<li class="chapter" data-level="14.6.4" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-pairwise-correlation-matrix"><i class="fa fa-check"></i><b>14.6.4</b> Pairwise Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.5" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-determinant-of-the-correlation-matrix"><i class="fa fa-check"></i><b>14.6.5</b> Determinant of the Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#summary-of-multicollinearity-diagnostics"><i class="fa fa-check"></i><b>14.6.6</b> Summary of Multicollinearity Diagnostics</a></li>
<li class="chapter" data-level="14.6.7" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#addressing-multicollinearity"><i class="fa fa-check"></i><b>14.6.7</b> Addressing Multicollinearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>15</b> Variable Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html"><i class="fa fa-check"></i><b>15.1</b> Filter Methods (Statistical Criteria, Model-Agnostic)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#information-criteria-based-selection"><i class="fa fa-check"></i><b>15.1.1</b> Information Criteria-Based Selection</a></li>
<li class="chapter" data-level="15.1.2" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#univariate-selection-methods"><i class="fa fa-check"></i><b>15.1.2</b> Univariate Selection Methods</a></li>
<li class="chapter" data-level="15.1.3" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#correlation-based-feature-selection"><i class="fa fa-check"></i><b>15.1.3</b> Correlation-Based Feature Selection</a></li>
<li class="chapter" data-level="15.1.4" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#variance-thresholding"><i class="fa fa-check"></i><b>15.1.4</b> Variance Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html"><i class="fa fa-check"></i><b>15.2</b> Wrapper Methods (Model-Based Subset Evaluation)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#best-subsets-algorithm-1"><i class="fa fa-check"></i><b>15.2.1</b> Best Subsets Algorithm</a></li>
<li class="chapter" data-level="15.2.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#stepwise-selection-methods-1"><i class="fa fa-check"></i><b>15.2.2</b> Stepwise Selection Methods</a></li>
<li class="chapter" data-level="15.2.3" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#branch-and-bound-algorithm-1"><i class="fa fa-check"></i><b>15.2.3</b> Branch-and-Bound Algorithm</a></li>
<li class="chapter" data-level="15.2.4" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#recursive-feature-elimination"><i class="fa fa-check"></i><b>15.2.4</b> Recursive Feature Elimination</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html"><i class="fa fa-check"></i><b>15.3</b> Embedded Methods (Integrated into Model Training)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#regularization-based-selection"><i class="fa fa-check"></i><b>15.3.1</b> Regularization-Based Selection</a></li>
<li class="chapter" data-level="15.3.2" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#tree-based-feature-importance"><i class="fa fa-check"></i><b>15.3.2</b> Tree-Based Feature Importance</a></li>
<li class="chapter" data-level="15.3.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#genetic-algorithms-1"><i class="fa fa-check"></i><b>15.3.3</b> Genetic Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="summary-table-1.html"><a href="summary-table-1.html"><i class="fa fa-check"></i><b>15.4</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>16</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>16.1</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#error-types-in-hypothesis-testing"><i class="fa fa-check"></i><b>16.1.1</b> Error Types in Hypothesis Testing</a></li>
<li class="chapter" data-level="16.1.2" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#hypothesis-testing-framework-1"><i class="fa fa-check"></i><b>16.1.2</b> Hypothesis Testing Framework</a></li>
<li class="chapter" data-level="16.1.3" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#interpreting-hypothesis-testing-results"><i class="fa fa-check"></i><b>16.1.3</b> Interpreting Hypothesis Testing Results</a></li>
<li class="chapter" data-level="16.1.4" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#understanding-p-values"><i class="fa fa-check"></i><b>16.1.4</b> Understanding p-Values</a></li>
<li class="chapter" data-level="16.1.5" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#the-role-of-sample-size"><i class="fa fa-check"></i><b>16.1.5</b> The Role of Sample Size</a></li>
<li class="chapter" data-level="16.1.6" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#p-value-hacking"><i class="fa fa-check"></i><b>16.1.6</b> p-Value Hacking</a></li>
<li class="chapter" data-level="16.1.7" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#practical-vs.-statistical-significance"><i class="fa fa-check"></i><b>16.1.7</b> Practical vs. Statistical Significance</a></li>
<li class="chapter" data-level="16.1.8" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#mitigating-the-misuse-of-p-values"><i class="fa fa-check"></i><b>16.1.8</b> Mitigating the Misuse of p-Values</a></li>
<li class="chapter" data-level="16.1.9" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-wald-test"><i class="fa fa-check"></i><b>16.1.9</b> Wald Test</a></li>
<li class="chapter" data-level="16.1.10" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-likelihood-ratio-test"><i class="fa fa-check"></i><b>16.1.10</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="16.1.11" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#lagrange-multiplier-score"><i class="fa fa-check"></i><b>16.1.11</b> Lagrange Multiplier (Score) Test</a></li>
<li class="chapter" data-level="16.1.12" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#comparing-hypothesis-tests"><i class="fa fa-check"></i><b>16.1.12</b> Comparing Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html"><i class="fa fa-check"></i><b>16.2</b> Two One-Sided Tests Equivalence Testing</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-to-use-tost"><i class="fa fa-check"></i><b>16.2.1</b> When to Use TOST?</a></li>
<li class="chapter" data-level="16.2.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#interpretation-of-the-tost-procedure"><i class="fa fa-check"></i><b>16.2.2</b> Interpretation of the TOST Procedure</a></li>
<li class="chapter" data-level="16.2.3" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#relationship-to-confidence-intervals"><i class="fa fa-check"></i><b>16.2.3</b> Relationship to Confidence Intervals</a></li>
<li class="chapter" data-level="16.2.4" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#example-1-testing-the-equivalence-of-two-means"><i class="fa fa-check"></i><b>16.2.4</b> Example 1: Testing the Equivalence of Two Means</a></li>
<li class="chapter" data-level="16.2.5" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#advantages-of-tost-equivalence-testing"><i class="fa fa-check"></i><b>16.2.5</b> Advantages of TOST Equivalence Testing</a></li>
<li class="chapter" data-level="16.2.6" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-not-to-use-tost"><i class="fa fa-check"></i><b>16.2.6</b> When <em>Not</em> to Use TOST</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html"><i class="fa fa-check"></i><b>16.3</b> False Discovery Rate</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-hochberg-procedure"><i class="fa fa-check"></i><b>16.3.1</b> Benjamini-Hochberg Procedure</a></li>
<li class="chapter" data-level="16.3.2" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-yekutieli-procedure"><i class="fa fa-check"></i><b>16.3.2</b> Benjamini-Yekutieli Procedure</a></li>
<li class="chapter" data-level="16.3.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-storeys-q-value-approach"><i class="fa fa-check"></i><b>16.3.3</b> Storey’s q-value Approach</a></li>
<li class="chapter" data-level="16.3.4" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#summary-false-discovery-rate-methods"><i class="fa fa-check"></i><b>16.3.4</b> Summary: False Discovery Rate Methods</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="comparison-of-testing-frameworks.html"><a href="comparison-of-testing-frameworks.html"><i class="fa fa-check"></i><b>16.4</b> Comparison of Testing Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-marginal-effects.html"><a href="sec-marginal-effects.html"><i class="fa fa-check"></i><b>17</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html"><i class="fa fa-check"></i><b>17.1</b> Definition of Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-analytical-derivation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.1</b> Analytical Derivation of Marginal Effects</a></li>
<li class="chapter" data-level="17.1.2" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-numerical-approximation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.2</b> Numerical Approximation of Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="marginal-effects-in-different-contexts.html"><a href="marginal-effects-in-different-contexts.html"><i class="fa fa-check"></i><b>17.2</b> Marginal Effects in Different Contexts</a></li>
<li class="chapter" data-level="17.3" data-path="marginal-effects-interpretation.html"><a href="marginal-effects-interpretation.html"><i class="fa fa-check"></i><b>17.3</b> Marginal Effects Interpretation</a></li>
<li class="chapter" data-level="17.4" data-path="sec-delta-method.html"><a href="sec-delta-method.html"><i class="fa fa-check"></i><b>17.4</b> Delta Method</a></li>
<li class="chapter" data-level="17.5" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html"><i class="fa fa-check"></i><b>17.5</b> Comparison: Delta Method vs. Alternative Approaches</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html#example-applying-the-delta-method-in-a-logistic-regression"><i class="fa fa-check"></i><b>17.5.1</b> Example: Applying the Delta Method in a logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html"><i class="fa fa-check"></i><b>17.6</b> Types of Marginal Effect</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-average-marginal-effect"><i class="fa fa-check"></i><b>17.6.1</b> Average Marginal Effect</a></li>
<li class="chapter" data-level="17.6.2" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-mean"><i class="fa fa-check"></i><b>17.6.2</b> Marginal Effects at the Mean</a></li>
<li class="chapter" data-level="17.6.3" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-average"><i class="fa fa-check"></i><b>17.6.3</b> Marginal Effects at the Average</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html"><i class="fa fa-check"></i><b>17.7</b> Packages for Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#marginaleffects-package-recommended"><i class="fa fa-check"></i><b>17.7.1</b> <code>marginaleffects</code> Package (Recommended)</a></li>
<li class="chapter" data-level="17.7.2" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#margins-package"><i class="fa fa-check"></i><b>17.7.2</b> <code>margins</code> Package</a></li>
<li class="chapter" data-level="17.7.3" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#mfx-package"><i class="fa fa-check"></i><b>17.7.3</b> <code>mfx</code> Package</a></li>
<li class="chapter" data-level="17.7.4" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#comparison-of-packages"><i class="fa fa-check"></i><b>17.7.4</b> Comparison of Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>18</b> Moderation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="types-of-moderation-analyses.html"><a href="types-of-moderation-analyses.html"><i class="fa fa-check"></i><b>18.1</b> Types of Moderation Analyses</a></li>
<li class="chapter" data-level="18.2" data-path="key-terminology.html"><a href="key-terminology.html"><i class="fa fa-check"></i><b>18.2</b> Key Terminology</a></li>
<li class="chapter" data-level="18.3" data-path="moderation-model.html"><a href="moderation-model.html"><i class="fa fa-check"></i><b>18.3</b> Moderation Model</a></li>
<li class="chapter" data-level="18.4" data-path="types-of-interactions.html"><a href="types-of-interactions.html"><i class="fa fa-check"></i><b>18.4</b> Types of Interactions</a></li>
<li class="chapter" data-level="18.5" data-path="three-way-interactions.html"><a href="three-way-interactions.html"><i class="fa fa-check"></i><b>18.5</b> Three-Way Interactions</a></li>
<li class="chapter" data-level="18.6" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18.6</b> Additional Resources</a></li>
<li class="chapter" data-level="18.7" data-path="application-2.html"><a href="application-2.html"><i class="fa fa-check"></i><b>18.7</b> Application</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="application-2.html"><a href="application-2.html#emmeans-package"><i class="fa fa-check"></i><b>18.7.1</b> <code>emmeans</code> Package</a></li>
<li class="chapter" data-level="18.7.2" data-path="application-2.html"><a href="application-2.html#probemod-package"><i class="fa fa-check"></i><b>18.7.2</b> <code>probemod</code> Package</a></li>
<li class="chapter" data-level="18.7.3" data-path="application-2.html"><a href="application-2.html#interactions-package"><i class="fa fa-check"></i><b>18.7.3</b> <code>interactions</code> Package</a></li>
<li class="chapter" data-level="18.7.4" data-path="application-2.html"><a href="application-2.html#interactionr-package"><i class="fa fa-check"></i><b>18.7.4</b> <code>interactionR</code> Package</a></li>
<li class="chapter" data-level="18.7.5" data-path="application-2.html"><a href="application-2.html#sjplot-package"><i class="fa fa-check"></i><b>18.7.5</b> <code>sjPlot</code> Package</a></li>
<li class="chapter" data-level="18.7.6" data-path="application-2.html"><a href="application-2.html#summary-of-moderation-analysis-packages"><i class="fa fa-check"></i><b>18.7.6</b> Summary of Moderation Analysis Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>19</b> Mediation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>19.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#steps-in-the-traditional-mediation-model"><i class="fa fa-check"></i><b>19.1.1</b> Steps in the Traditional Mediation Model</a></li>
<li class="chapter" data-level="19.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#graphical-representation-of-mediation"><i class="fa fa-check"></i><b>19.1.2</b> Graphical Representation of Mediation</a></li>
<li class="chapter" data-level="19.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#measuring-mediation"><i class="fa fa-check"></i><b>19.1.3</b> Measuring Mediation</a></li>
<li class="chapter" data-level="19.1.4" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-linear-mediation-models"><i class="fa fa-check"></i><b>19.1.4</b> Assumptions in Linear Mediation Models</a></li>
<li class="chapter" data-level="19.1.5" data-path="traditional-approach.html"><a href="traditional-approach.html#testing-for-mediation"><i class="fa fa-check"></i><b>19.1.5</b> Testing for Mediation</a></li>
<li class="chapter" data-level="19.1.6" data-path="traditional-approach.html"><a href="traditional-approach.html#additional-considerations"><i class="fa fa-check"></i><b>19.1.6</b> Additional Considerations</a></li>
<li class="chapter" data-level="19.1.7" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-mediation-analysis"><i class="fa fa-check"></i><b>19.1.7</b> Assumptions in Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.8" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>19.1.8</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="19.1.9" data-path="traditional-approach.html"><a href="traditional-approach.html#power-analysis-for-mediation"><i class="fa fa-check"></i><b>19.1.9</b> Power Analysis for Mediation</a></li>
<li class="chapter" data-level="19.1.10" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation-analysis"><i class="fa fa-check"></i><b>19.1.10</b> Multiple Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.11" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-treatments-in-mediation"><i class="fa fa-check"></i><b>19.1.11</b> Multiple Treatments in Mediation</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html"><i class="fa fa-check"></i><b>19.2</b> Causal Inference Approach to Mediation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#sec-example-traditional-mediation-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Example: Traditional Mediation Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#two-approaches-in-causal-mediation-analysis"><i class="fa fa-check"></i><b>19.2.2</b> Two Approaches in Causal Mediation Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>20</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html"><i class="fa fa-check"></i><b>20.1</b> Conceptual Framing</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html#predictive-modeling"><i class="fa fa-check"></i><b>20.1.1</b> Predictive Modeling</a></li>
<li class="chapter" data-level="20.1.2" data-path="conceptual-framing.html"><a href="conceptual-framing.html#estimation-or-causal-inference"><i class="fa fa-check"></i><b>20.1.2</b> Estimation or Causal Inference</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html"><i class="fa fa-check"></i><b>20.2</b> Mathematical Setup</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="mathematical-setup.html"><a href="mathematical-setup.html#probability-space-and-data"><i class="fa fa-check"></i><b>20.2.1</b> Probability Space and Data</a></li>
<li class="chapter" data-level="20.2.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html#loss-functions-and-risk"><i class="fa fa-check"></i><b>20.2.2</b> Loss Functions and Risk</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html"><i class="fa fa-check"></i><b>20.3</b> Prediction in Detail</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#empirical-risk-minimization-and-generalization"><i class="fa fa-check"></i><b>20.3.1</b> Empirical Risk Minimization and Generalization</a></li>
<li class="chapter" data-level="20.3.2" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>20.3.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="20.3.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#example-linear-regression-for-prediction"><i class="fa fa-check"></i><b>20.3.3</b> Example: Linear Regression for Prediction</a></li>
<li class="chapter" data-level="20.3.4" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#applications-in-economics"><i class="fa fa-check"></i><b>20.3.4</b> Applications in Economics</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html"><i class="fa fa-check"></i><b>20.4</b> Parameter Estimation and Causal Inference</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#estimation-in-parametric-models"><i class="fa fa-check"></i><b>20.4.1</b> Estimation in Parametric Models</a></li>
<li class="chapter" data-level="20.4.2" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#causal-inference-fundamentals"><i class="fa fa-check"></i><b>20.4.2</b> Causal Inference Fundamentals</a></li>
<li class="chapter" data-level="20.4.3" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#role-of-identification"><i class="fa fa-check"></i><b>20.4.3</b> Role of Identification</a></li>
<li class="chapter" data-level="20.4.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#challenges-1"><i class="fa fa-check"></i><b>20.4.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>20.5</b> Causation versus Prediction</a></li>
<li class="chapter" data-level="20.6" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html"><i class="fa fa-check"></i><b>20.6</b> Illustrative Equations and Mathematical Contrasts</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#risk-minimization-vs.-consistency"><i class="fa fa-check"></i><b>20.6.1</b> Risk Minimization vs. Consistency</a></li>
<li class="chapter" data-level="20.6.2" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#partial-derivatives-vs.-predictions"><i class="fa fa-check"></i><b>20.6.2</b> Partial Derivatives vs. Predictions</a></li>
<li class="chapter" data-level="20.6.3" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#example-high-dimensional-regularization"><i class="fa fa-check"></i><b>20.6.3</b> Example: High-Dimensional Regularization</a></li>
<li class="chapter" data-level="20.6.4" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#potential-outcomes-notation"><i class="fa fa-check"></i><b>20.6.4</b> Potential Outcomes Notation</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html"><i class="fa fa-check"></i><b>20.7</b> Extended Mathematical Points</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#m-estimation-and-asymptotic-theory"><i class="fa fa-check"></i><b>20.7.1</b> M-Estimation and Asymptotic Theory</a></li>
<li class="chapter" data-level="20.7.2" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#the-danger-of-omitted-variables"><i class="fa fa-check"></i><b>20.7.2</b> The Danger of Omitted Variables</a></li>
<li class="chapter" data-level="20.7.3" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#cross-validation-vs.-statistical-testing"><i class="fa fa-check"></i><b>20.7.3</b> Cross-Validation vs. Statistical Testing</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="putting-it-all-together-comparing-objectives.html"><a href="putting-it-all-together-comparing-objectives.html"><i class="fa fa-check"></i><b>20.8</b> Putting It All Together: Comparing Objectives</a></li>
<li class="chapter" data-level="20.9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>20.9</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="21" data-path="sec-causal-inference.html"><a href="sec-causal-inference.html"><i class="fa fa-check"></i><b>21</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-the-ladder-of-causation.html"><a href="sec-the-ladder-of-causation.html"><i class="fa fa-check"></i><b>21.1</b> The Ladder of Causation</a></li>
<li class="chapter" data-level="21.2" data-path="the-formal-notation-of-causality.html"><a href="the-formal-notation-of-causality.html"><i class="fa fa-check"></i><b>21.2</b> The Formal Notation of Causality</a></li>
<li class="chapter" data-level="21.3" data-path="the-7-tools-of-structural-causal-models.html"><a href="the-7-tools-of-structural-causal-models.html"><i class="fa fa-check"></i><b>21.3</b> The 7 Tools of Structural Causal Models</a></li>
<li class="chapter" data-level="21.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html"><i class="fa fa-check"></i><b>21.4</b> Simpson’s Paradox</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#what-is-simpsons-paradox"><i class="fa fa-check"></i><b>21.4.1</b> What is Simpson’s Paradox?</a></li>
<li class="chapter" data-level="21.4.2" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-is-this-important"><i class="fa fa-check"></i><b>21.4.2</b> Why is this Important?</a></li>
<li class="chapter" data-level="21.4.3" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#comparison-between-simpsons-paradox-and-omitted-variable-bias"><i class="fa fa-check"></i><b>21.4.3</b> Comparison between Simpson’s Paradox and Omitted Variable Bias</a></li>
<li class="chapter" data-level="21.4.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#illustrating-simpsons-paradox-marketing-campaign-success-rates"><i class="fa fa-check"></i><b>21.4.4</b> Illustrating Simpson’s Paradox: Marketing Campaign Success Rates</a></li>
<li class="chapter" data-level="21.4.5" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-does-this-happen"><i class="fa fa-check"></i><b>21.4.5</b> Why Does This Happen?</a></li>
<li class="chapter" data-level="21.4.6" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#how-does-causal-inference-solve-this"><i class="fa fa-check"></i><b>21.4.6</b> How Does Causal Inference Solve This?</a></li>
<li class="chapter" data-level="21.4.7" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#correcting-simpsons-paradox-with-regression-adjustment"><i class="fa fa-check"></i><b>21.4.7</b> Correcting Simpson’s Paradox with Regression Adjustment</a></li>
<li class="chapter" data-level="21.4.8" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#key-takeaways-3"><i class="fa fa-check"></i><b>21.4.8</b> Key Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="additional-resources-1.html"><a href="additional-resources-1.html"><i class="fa fa-check"></i><b>21.5</b> Additional Resources</a></li>
<li class="chapter" data-level="21.6" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html"><i class="fa fa-check"></i><b>21.6</b> Experimental vs. Quasi-Experimental Designs</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html#criticisms-of-quasi-experimental-designs"><i class="fa fa-check"></i><b>21.6.1</b> Criticisms of Quasi-Experimental Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="hierarchical-ordering-of-causal-tools.html"><a href="hierarchical-ordering-of-causal-tools.html"><i class="fa fa-check"></i><b>21.7</b> Hierarchical Ordering of Causal Tools</a></li>
<li class="chapter" data-level="21.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html"><i class="fa fa-check"></i><b>21.8</b> Types of Validity in Research</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-measurement-validity"><i class="fa fa-check"></i><b>21.8.1</b> Measurement Validity</a></li>
<li class="chapter" data-level="21.8.2" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-construct-validity"><i class="fa fa-check"></i><b>21.8.2</b> Construct Validity</a></li>
<li class="chapter" data-level="21.8.3" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-criterion-validity"><i class="fa fa-check"></i><b>21.8.3</b> Criterion Validity</a></li>
<li class="chapter" data-level="21.8.4" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-internal-validity"><i class="fa fa-check"></i><b>21.8.4</b> Internal Validity</a></li>
<li class="chapter" data-level="21.8.5" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-external-validity"><i class="fa fa-check"></i><b>21.8.5</b> External Validity</a></li>
<li class="chapter" data-level="21.8.6" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-ecological-validity"><i class="fa fa-check"></i><b>21.8.6</b> Ecological Validity</a></li>
<li class="chapter" data-level="21.8.7" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-statistical-conclusion-validity"><i class="fa fa-check"></i><b>21.8.7</b> Statistical Conclusion Validity</a></li>
<li class="chapter" data-level="21.8.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#putting-it-all-together"><i class="fa fa-check"></i><b>21.8.8</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html"><i class="fa fa-check"></i><b>21.9</b> Types of Subjects in a Treatment Setting</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#non-switchers"><i class="fa fa-check"></i><b>21.9.1</b> Non-Switchers</a></li>
<li class="chapter" data-level="21.9.2" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#switchers"><i class="fa fa-check"></i><b>21.9.2</b> Switchers</a></li>
<li class="chapter" data-level="21.9.3" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#classification-of-individuals-based-on-treatment-assignment"><i class="fa fa-check"></i><b>21.9.3</b> Classification of Individuals Based on Treatment Assignment</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html"><i class="fa fa-check"></i><b>21.10</b> Types of Treatment Effects</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-average-treatment-effect"><i class="fa fa-check"></i><b>21.10.1</b> Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.2" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-conditional-average-treatment-effect-"><i class="fa fa-check"></i><b>21.10.2</b> Conditional Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.3" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-intention-to-treat-effect"><i class="fa fa-check"></i><b>21.10.3</b> Intention-to-Treat Effect</a></li>
<li class="chapter" data-level="21.10.4" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-local-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.5" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.6" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>21.10.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="21.10.7" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-quantile-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.8" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-log-odds-treatment-effects-for-binary-outcomes"><i class="fa fa-check"></i><b>21.10.8</b> Log-Odds Treatment Effects for Binary Outcomes</a></li>
<li class="chapter" data-level="21.10.9" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#summary-table-treatment-effect-estimands"><i class="fa fa-check"></i><b>21.10.9</b> Summary Table: Treatment Effect Estimands</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="22" data-path="sec-experimental-design.html"><a href="sec-experimental-design.html"><i class="fa fa-check"></i><b>22</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="22.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>22.1</b> Principles of Experimental Design</a></li>
<li class="chapter" data-level="22.2" data-path="sec-the-gold-standard-randomized-controlled-trials.html"><a href="sec-the-gold-standard-randomized-controlled-trials.html"><i class="fa fa-check"></i><b>22.2</b> The Gold Standard: Randomized Controlled Trials</a></li>
<li class="chapter" data-level="22.3" data-path="selection-problem.html"><a href="selection-problem.html"><i class="fa fa-check"></i><b>22.3</b> Selection Problem</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="selection-problem.html"><a href="selection-problem.html#the-observed-difference-in-outcomes"><i class="fa fa-check"></i><b>22.3.1</b> The Observed Difference in Outcomes</a></li>
<li class="chapter" data-level="22.3.2" data-path="selection-problem.html"><a href="selection-problem.html#eliminating-selection-bias-with-random-assignment"><i class="fa fa-check"></i><b>22.3.2</b> Eliminating Selection Bias with Random Assignment</a></li>
<li class="chapter" data-level="22.3.3" data-path="selection-problem.html"><a href="selection-problem.html#another-representation-under-regression"><i class="fa fa-check"></i><b>22.3.3</b> Another Representation Under Regression</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html"><i class="fa fa-check"></i><b>22.4</b> Classical Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.4.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="22.4.2" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#randomized-block-design"><i class="fa fa-check"></i><b>22.4.2</b> Randomized Block Design</a></li>
<li class="chapter" data-level="22.4.3" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#factorial-design"><i class="fa fa-check"></i><b>22.4.3</b> Factorial Design</a></li>
<li class="chapter" data-level="22.4.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#crossover-design"><i class="fa fa-check"></i><b>22.4.4</b> Crossover Design</a></li>
<li class="chapter" data-level="22.4.5" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#split-plot-design"><i class="fa fa-check"></i><b>22.4.5</b> Split-Plot Design</a></li>
<li class="chapter" data-level="22.4.6" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#latin-square-design"><i class="fa fa-check"></i><b>22.4.6</b> Latin Square Design</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html"><i class="fa fa-check"></i><b>22.5</b> Advanced Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#semi-random-experiments"><i class="fa fa-check"></i><b>22.5.1</b> Semi-Random Experiments</a></li>
<li class="chapter" data-level="22.5.2" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#re-randomization"><i class="fa fa-check"></i><b>22.5.2</b> Re-Randomization</a></li>
<li class="chapter" data-level="22.5.3" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments"><i class="fa fa-check"></i><b>22.5.3</b> Two-Stage Randomized Experiments</a></li>
<li class="chapter" data-level="22.5.4" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments-with-interference-and-noncompliance"><i class="fa fa-check"></i><b>22.5.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="emerging-research.html"><a href="emerging-research.html"><i class="fa fa-check"></i><b>22.6</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="emerging-research.html"><a href="emerging-research.html#covariate-balancing-in-online-ab-testing-the-pigeonhole-design"><i class="fa fa-check"></i><b>22.6.1</b> Covariate Balancing in Online A/B Testing: The Pigeonhole Design</a></li>
<li class="chapter" data-level="22.6.2" data-path="emerging-research.html"><a href="emerging-research.html#sec-handling-zero-valued-outcomes"><i class="fa fa-check"></i><b>22.6.2</b> Handling Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>23</b> Sampling</a>
<ul>
<li class="chapter" data-level="23.1" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>23.1</b> Population and Sample</a></li>
<li class="chapter" data-level="23.2" data-path="probability-sampling.html"><a href="probability-sampling.html"><i class="fa fa-check"></i><b>23.2</b> Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-simple-random-sampling"><i class="fa fa-check"></i><b>23.2.1</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="23.2.2" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-stratified-sampling"><i class="fa fa-check"></i><b>23.2.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="23.2.3" data-path="probability-sampling.html"><a href="probability-sampling.html#systematic-sampling"><i class="fa fa-check"></i><b>23.2.3</b> Systematic Sampling</a></li>
<li class="chapter" data-level="23.2.4" data-path="probability-sampling.html"><a href="probability-sampling.html#cluster-sampling"><i class="fa fa-check"></i><b>23.2.4</b> Cluster Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html"><i class="fa fa-check"></i><b>23.3</b> Non-Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#convenience-sampling"><i class="fa fa-check"></i><b>23.3.1</b> Convenience Sampling</a></li>
<li class="chapter" data-level="23.3.2" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#quota-sampling"><i class="fa fa-check"></i><b>23.3.2</b> Quota Sampling</a></li>
<li class="chapter" data-level="23.3.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#snowball-sampling"><i class="fa fa-check"></i><b>23.3.3</b> Snowball Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="sec-unequal-probability-sampling.html"><a href="sec-unequal-probability-sampling.html"><i class="fa fa-check"></i><b>23.4</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="23.5" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html"><i class="fa fa-check"></i><b>23.5</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#cube-method-for-balanced-sampling"><i class="fa fa-check"></i><b>23.5.1</b> Cube Method for Balanced Sampling</a></li>
<li class="chapter" data-level="23.5.2" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-with-stratification"><i class="fa fa-check"></i><b>23.5.2</b> Balanced Sampling with Stratification</a></li>
<li class="chapter" data-level="23.5.3" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-cluster-sampling"><i class="fa fa-check"></i><b>23.5.3</b> Balanced Sampling in Cluster Sampling</a></li>
<li class="chapter" data-level="23.5.4" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-two-stage-sampling"><i class="fa fa-check"></i><b>23.5.4</b> Balanced Sampling in Two-Stage Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="sample-size-determination.html"><a href="sample-size-determination.html"><i class="fa fa-check"></i><b>23.6</b> Sample Size Determination</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="sec-analysis-of-variance-anova.html"><a href="sec-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>24</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="24.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html"><i class="fa fa-check"></i><b>24.1</b> Completely Randomized Design</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>24.1.1</b> Single-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.2" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-random-effects-model"><i class="fa fa-check"></i><b>24.1.2</b> Single Factor Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.3" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-factor-fixed-effects-anova"><i class="fa fa-check"></i><b>24.1.3</b> Two-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.4" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-random-effects-anova"><i class="fa fa-check"></i><b>24.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.5" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>24.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html"><i class="fa fa-check"></i><b>24.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#kruskal-wallis-test-one-way-nonparametric-anova"><i class="fa fa-check"></i><b>24.2.1</b> Kruskal-Wallis Test (One-Way Nonparametric ANOVA)</a></li>
<li class="chapter" data-level="24.2.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#friedman-test-nonparametric-two-way-anova"><i class="fa fa-check"></i><b>24.2.2</b> Friedman Test (Nonparametric Two-Way ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="sec-randomized-block-designs.html"><a href="sec-randomized-block-designs.html"><i class="fa fa-check"></i><b>24.3</b> Randomized Block Designs</a></li>
<li class="chapter" data-level="24.4" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>24.4</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-design"><i class="fa fa-check"></i><b>24.4.1</b> Two-Factor Nested Design</a></li>
<li class="chapter" data-level="24.4.2" data-path="nested-designs.html"><a href="nested-designs.html#unbalanced-nested-two-factor-designs"><i class="fa fa-check"></i><b>24.4.2</b> Unbalanced Nested Two-Factor Designs</a></li>
<li class="chapter" data-level="24.4.3" data-path="nested-designs.html"><a href="nested-designs.html#random-factor-effects"><i class="fa fa-check"></i><b>24.4.3</b> Random Factor Effects</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>24.5</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>24.5.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="24.5.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#single-factor-studies"><i class="fa fa-check"></i><b>24.5.2</b> Single Factor Studies</a></li>
<li class="chapter" data-level="24.5.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#multi-factor-studies"><i class="fa fa-check"></i><b>24.5.3</b> Multi-Factor Studies</a></li>
<li class="chapter" data-level="24.5.4" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#procedure-for-sample-size-selection"><i class="fa fa-check"></i><b>24.5.4</b> Procedure for Sample Size Selection</a></li>
<li class="chapter" data-level="24.5.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>24.5.5</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>24.6</b> Single Factor Covariance Model</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#statistical-inference-for-treatment-effects"><i class="fa fa-check"></i><b>24.6.1</b> Statistical Inference for Treatment Effects</a></li>
<li class="chapter" data-level="24.6.2" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#testing-for-parallel-slopes"><i class="fa fa-check"></i><b>24.6.2</b> Testing for Parallel Slopes</a></li>
<li class="chapter" data-level="24.6.3" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#adjusted-means"><i class="fa fa-check"></i><b>24.6.3</b> Adjusted Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sec-multivariate-methods.html"><a href="sec-multivariate-methods.html"><i class="fa fa-check"></i><b>25</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="25.1" data-path="basic-understanding.html"><a href="basic-understanding.html"><i class="fa fa-check"></i><b>25.1</b> Basic Understanding</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-random-vectors"><i class="fa fa-check"></i><b>25.1.1</b> Multivariate Random Vectors</a></li>
<li class="chapter" data-level="25.1.2" data-path="basic-understanding.html"><a href="basic-understanding.html#sec-covariance-matrix-multivariate"><i class="fa fa-check"></i><b>25.1.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="25.1.3" data-path="basic-understanding.html"><a href="basic-understanding.html#equalities-in-expectation-and-variance"><i class="fa fa-check"></i><b>25.1.3</b> Equalities in Expectation and Variance</a></li>
<li class="chapter" data-level="25.1.4" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-normal-distribution-1"><i class="fa fa-check"></i><b>25.1.4</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="25.1.5" data-path="basic-understanding.html"><a href="basic-understanding.html#test-of-multivariate-normality"><i class="fa fa-check"></i><b>25.1.5</b> Test of Multivariate Normality</a></li>
<li class="chapter" data-level="25.1.6" data-path="basic-understanding.html"><a href="basic-understanding.html#mean-vector-inference"><i class="fa fa-check"></i><b>25.1.6</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="25.1.7" data-path="basic-understanding.html"><a href="basic-understanding.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>25.1.7</b> General Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>25.2</b> Multivariate Analysis of Variance</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#one-way-manova"><i class="fa fa-check"></i><b>25.2.1</b> One-Way MANOVA</a></li>
<li class="chapter" data-level="25.2.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#sec-profile-analysis"><i class="fa fa-check"></i><b>25.2.2</b> Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="statistical-test-selection-for-comparing-means.html"><a href="statistical-test-selection-for-comparing-means.html"><i class="fa fa-check"></i><b>25.3</b> Statistical Test Selection for Comparing Means</a></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="26" data-path="sec-quasi-experimental.html"><a href="sec-quasi-experimental.html"><i class="fa fa-check"></i><b>26</b> Quasi-Experimental Methods</a>
<ul>
<li class="chapter" data-level="26.1" data-path="identification-strategy-in-quasi-experiments.html"><a href="identification-strategy-in-quasi-experiments.html"><i class="fa fa-check"></i><b>26.1</b> Identification Strategy in Quasi-Experiments</a></li>
<li class="chapter" data-level="26.2" data-path="robustness-checks.html"><a href="robustness-checks.html"><i class="fa fa-check"></i><b>26.2</b> Robustness Checks</a></li>
<li class="chapter" data-level="26.3" data-path="establishing-mechanisms.html"><a href="establishing-mechanisms.html"><i class="fa fa-check"></i><b>26.3</b> Establishing Mechanisms</a></li>
<li class="chapter" data-level="26.4" data-path="limitations-of-quasi-experiments.html"><a href="limitations-of-quasi-experiments.html"><i class="fa fa-check"></i><b>26.4</b> Limitations of Quasi-Experiments</a></li>
<li class="chapter" data-level="26.5" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html"><i class="fa fa-check"></i><b>26.5</b> Assumptions for Identifying Treatment Effects</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-sutva"><i class="fa fa-check"></i><b>26.5.1</b> Stable Unit Treatment Value Assumption</a></li>
<li class="chapter" data-level="26.5.2" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-conditional-ignorability-assumption"><i class="fa fa-check"></i><b>26.5.2</b> Conditional Ignorability Assumption</a></li>
<li class="chapter" data-level="26.5.3" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-overlap-positivity-assumption"><i class="fa fa-check"></i><b>26.5.3</b> Overlap (Positivity) Assumption</a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html"><i class="fa fa-check"></i><b>26.6</b> Natural Experiments</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#the-problem-of-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.1</b> The Problem of Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.2" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#statistical-challenges-in-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.2</b> Statistical Challenges in Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.3" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#solutions-multiple-testing-corrections"><i class="fa fa-check"></i><b>26.6.3</b> Solutions: Multiple Testing Corrections</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html"><i class="fa fa-check"></i><b>26.7</b> Design vs. Model-Based Approaches</a>
<ul>
<li class="chapter" data-level="26.7.1" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-design-based"><i class="fa fa-check"></i><b>26.7.1</b> Design-Based Perspective</a></li>
<li class="chapter" data-level="26.7.2" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-model-based-perspective"><i class="fa fa-check"></i><b>26.7.2</b> Model-Based Perspective</a></li>
<li class="chapter" data-level="26.7.3" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#placing-methods-along-a-spectrum"><i class="fa fa-check"></i><b>26.7.3</b> Placing Methods Along a Spectrum</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="sec-regression-discontinuity.html"><a href="sec-regression-discontinuity.html"><i class="fa fa-check"></i><b>27</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="27.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html"><i class="fa fa-check"></i><b>27.1</b> Conceptual Framework</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html#types-of-regression-discontinuity-designs"><i class="fa fa-check"></i><b>27.1.1</b> Types of Regression Discontinuity Designs</a></li>
<li class="chapter" data-level="27.1.2" data-path="conceptual-framework.html"><a href="conceptual-framework.html#assumptions-for-rd-validity"><i class="fa fa-check"></i><b>27.1.2</b> Assumptions for RD Validity</a></li>
<li class="chapter" data-level="27.1.3" data-path="conceptual-framework.html"><a href="conceptual-framework.html#threats-to-rd-validity"><i class="fa fa-check"></i><b>27.1.3</b> Threats to RD Validity</a></li>
<li class="chapter" data-level="27.1.4" data-path="conceptual-framework.html"><a href="conceptual-framework.html#violation-of-continuity-in-covariates"><i class="fa fa-check"></i><b>27.1.4</b> Violation of Continuity in Covariates</a></li>
<li class="chapter" data-level="27.1.5" data-path="conceptual-framework.html"><a href="conceptual-framework.html#multiple-discontinuities"><i class="fa fa-check"></i><b>27.1.5</b> Multiple Discontinuities</a></li>
<li class="chapter" data-level="27.1.6" data-path="conceptual-framework.html"><a href="conceptual-framework.html#manipulation-of-the-running-variable"><i class="fa fa-check"></i><b>27.1.6</b> Manipulation of the Running Variable</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html"><i class="fa fa-check"></i><b>27.2</b> Model Estimation Strategies</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#parametric-models-polynomial-regression"><i class="fa fa-check"></i><b>27.2.1</b> Parametric Models: Polynomial Regression</a></li>
<li class="chapter" data-level="27.2.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#nonparametric-models-local-regression"><i class="fa fa-check"></i><b>27.2.2</b> Nonparametric Models: Local Regression</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="formal-definition.html"><a href="formal-definition.html"><i class="fa fa-check"></i><b>27.3</b> Formal Definition</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="formal-definition.html"><a href="formal-definition.html#identification-assumptions"><i class="fa fa-check"></i><b>27.3.1</b> Identification Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>27.4</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based-approach"><i class="fa fa-check"></i><b>27.4.1</b> Local Randomization-Based Approach</a></li>
<li class="chapter" data-level="27.4.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#sec-continuity-based-approach"><i class="fa fa-check"></i><b>27.4.2</b> Continuity-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>27.5</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="specification-checks.html"><a href="specification-checks.html#sec-balance-checks"><i class="fa fa-check"></i><b>27.5.1</b> Balance Checks</a></li>
<li class="chapter" data-level="27.5.2" data-path="specification-checks.html"><a href="specification-checks.html#sec-sorting-bunching-and-manipulation"><i class="fa fa-check"></i><b>27.5.2</b> Sorting, Bunching, and Manipulation</a></li>
<li class="chapter" data-level="27.5.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>27.5.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="27.5.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>27.5.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="27.5.5" data-path="specification-checks.html"><a href="specification-checks.html#assessing-sensitivity"><i class="fa fa-check"></i><b>27.5.5</b> Assessing Sensitivity</a></li>
<li class="chapter" data-level="27.5.6" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>27.5.6</b> Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.6</b> Fuzzy Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#compliance-types"><i class="fa fa-check"></i><b>27.6.1</b> Compliance Types</a></li>
<li class="chapter" data-level="27.6.2" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect"><i class="fa fa-check"></i><b>27.6.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.6.3" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#equivalent-representation-using-expectations"><i class="fa fa-check"></i><b>27.6.3</b> Equivalent Representation Using Expectations</a></li>
<li class="chapter" data-level="27.6.4" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimation-strategies"><i class="fa fa-check"></i><b>27.6.4</b> Estimation Strategies</a></li>
<li class="chapter" data-level="27.6.5" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#practical-considerations-6"><i class="fa fa-check"></i><b>27.6.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="27.6.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#steps-for-fuzzy-rd"><i class="fa fa-check"></i><b>27.6.6</b> Steps for Fuzzy RD</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.7</b> Sharp Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.7.1" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#assumptions-for-identification"><i class="fa fa-check"></i><b>27.7.1</b> Assumptions for Identification</a></li>
<li class="chapter" data-level="27.7.2" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect-1"><i class="fa fa-check"></i><b>27.7.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.7.3" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimation-methods"><i class="fa fa-check"></i><b>27.7.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="27.7.4" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#steps-for-sharp-rd"><i class="fa fa-check"></i><b>27.7.4</b> Steps for Sharp RD</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html"><i class="fa fa-check"></i><b>27.8</b> Regression Kink Design</a>
<ul>
<li class="chapter" data-level="27.8.1" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-sharp-regression-kink-design"><i class="fa fa-check"></i><b>27.8.1</b> Identification in Sharp Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.2" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-fuzzy-regression-kink-design"><i class="fa fa-check"></i><b>27.8.2</b> Identification in Fuzzy Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.3" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#estimation-of-rkd-effects"><i class="fa fa-check"></i><b>27.8.3</b> Estimation of RKD Effects</a></li>
<li class="chapter" data-level="27.8.4" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#robustness-checks-1"><i class="fa fa-check"></i><b>27.8.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.9" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.9</b> Multi-Cutoff Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.9.1" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#identification"><i class="fa fa-check"></i><b>27.9.1</b> Identification</a></li>
<li class="chapter" data-level="27.9.2" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#key-assumptions-1"><i class="fa fa-check"></i><b>27.9.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.9.3" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#estimation-approaches"><i class="fa fa-check"></i><b>27.9.3</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.9.4" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#robustness-checks-2"><i class="fa fa-check"></i><b>27.9.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.10" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.10</b> Multi-Score Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.10.1" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#general-framework"><i class="fa fa-check"></i><b>27.10.1</b> General Framework</a></li>
<li class="chapter" data-level="27.10.2" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#identification-1"><i class="fa fa-check"></i><b>27.10.2</b> Identification</a></li>
<li class="chapter" data-level="27.10.3" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#key-assumptions-2"><i class="fa fa-check"></i><b>27.10.3</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.10.4" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#estimation-approaches-1"><i class="fa fa-check"></i><b>27.10.4</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.10.5" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#robustness-checks-3"><i class="fa fa-check"></i><b>27.10.5</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.11" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.11</b> Evaluation of a Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.11.1" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#graphical-and-formal-evidence"><i class="fa fa-check"></i><b>27.11.1</b> Graphical and Formal Evidence</a></li>
<li class="chapter" data-level="27.11.2" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#functional-form-of-the-running-variable"><i class="fa fa-check"></i><b>27.11.2</b> Functional Form of the Running Variable</a></li>
<li class="chapter" data-level="27.11.3" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#bandwidth-selection-2"><i class="fa fa-check"></i><b>27.11.3</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="27.11.4" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#addressing-potential-confounders"><i class="fa fa-check"></i><b>27.11.4</b> Addressing Potential Confounders</a></li>
<li class="chapter" data-level="27.11.5" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#external-validity-in-rd"><i class="fa fa-check"></i><b>27.11.5</b> External Validity in RD</a></li>
</ul></li>
<li class="chapter" data-level="27.12" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html"><i class="fa fa-check"></i><b>27.12</b> Applications of RD Designs</a>
<ul>
<li class="chapter" data-level="27.12.1" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#applications-in-marketing"><i class="fa fa-check"></i><b>27.12.1</b> Applications in Marketing</a></li>
<li class="chapter" data-level="27.12.2" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#r-packages-for-rd-estimation"><i class="fa fa-check"></i><b>27.12.2</b> R Packages for RD Estimation</a></li>
<li class="chapter" data-level="27.12.3" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-regression-discontinuity-in-education"><i class="fa fa-check"></i><b>27.12.3</b> Example of Regression Discontinuity in Education</a></li>
<li class="chapter" data-level="27.12.4" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-occupational-licensing-and-market-efficiency"><i class="fa fa-check"></i><b>27.12.4</b> Example of Occupational Licensing and Market Efficiency</a></li>
<li class="chapter" data-level="27.12.5" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#replicating-carpenter2009effect"><i class="fa fa-check"></i><b>27.12.5</b> Replicating <span class="citation">(Carpenter and Dobkin 2009)</span></a></li>
<li class="chapter" data-level="27.12.6" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#additional-rd-applications"><i class="fa fa-check"></i><b>27.12.6</b> Additional RD Applications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="temporal-discontinuity-designs.html"><a href="temporal-discontinuity-designs.html"><i class="fa fa-check"></i><b>28</b> Temporal Discontinuity Designs</a>
<ul>
<li class="chapter" data-level="28.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>28.1</b> Regression Discontinuity in Time</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>28.1.1</b> Estimation and Model Selection</a></li>
<li class="chapter" data-level="28.1.2" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#strengths-of-rdit"><i class="fa fa-check"></i><b>28.1.2</b> Strengths of RDiT</a></li>
<li class="chapter" data-level="28.1.3" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#limitations-and-challenges-of-rdit"><i class="fa fa-check"></i><b>28.1.3</b> Limitations and Challenges of RDiT</a></li>
<li class="chapter" data-level="28.1.4" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#recommendations-for-robustness-checks"><i class="fa fa-check"></i><b>28.1.4</b> Recommendations for Robustness Checks</a></li>
<li class="chapter" data-level="28.1.5" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#applications-of-rdit"><i class="fa fa-check"></i><b>28.1.5</b> Applications of RDiT</a></li>
<li class="chapter" data-level="28.1.6" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#empirical-example"><i class="fa fa-check"></i><b>28.1.6</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html"><i class="fa fa-check"></i><b>28.2</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#advantages-of-its"><i class="fa fa-check"></i><b>28.2.1</b> Advantages of ITS</a></li>
<li class="chapter" data-level="28.2.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#limitations-of-its"><i class="fa fa-check"></i><b>28.2.2</b> Limitations of ITS</a></li>
<li class="chapter" data-level="28.2.3" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#empirical-example-1"><i class="fa fa-check"></i><b>28.2.3</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html"><i class="fa fa-check"></i><b>28.3</b> Combining both RDiT and ITS</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#augment-an-its-model-with-a-local-discontinuity-term"><i class="fa fa-check"></i><b>28.3.1</b> Augment an ITS Model with a Local Discontinuity Term</a></li>
<li class="chapter" data-level="28.3.2" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#two-stage-or-multi-stage-modeling"><i class="fa fa-check"></i><b>28.3.2</b> Two-Stage (or Multi-Stage) Modeling</a></li>
<li class="chapter" data-level="28.3.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#hierarchical-or-multi-level-modeling"><i class="fa fa-check"></i><b>28.3.3</b> Hierarchical or Multi-Level Modeling</a></li>
<li class="chapter" data-level="28.3.4" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#empirical-example-2"><i class="fa fa-check"></i><b>28.3.4</b> Empirical Example</a></li>
<li class="chapter" data-level="28.3.5" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#practical-guidance"><i class="fa fa-check"></i><b>28.3.5</b> Practical Guidance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="sec-synthetic-difference-in-differences.html"><a href="sec-synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>29</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="29.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>29.1</b> Understanding</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="understanding.html"><a href="understanding.html#steps-in-sdid-estimation"><i class="fa fa-check"></i><b>29.1.1</b> Steps in SDID Estimation</a></li>
<li class="chapter" data-level="29.1.2" data-path="understanding.html"><a href="understanding.html#comparison-of-methods-1"><i class="fa fa-check"></i><b>29.1.2</b> Comparison of Methods</a></li>
<li class="chapter" data-level="29.1.3" data-path="understanding.html"><a href="understanding.html#why-use-weights"><i class="fa fa-check"></i><b>29.1.3</b> <strong>Why Use Weights?</strong></a></li>
<li class="chapter" data-level="29.1.4" data-path="understanding.html"><a href="understanding.html#benefits-of-localization-in-sdid"><i class="fa fa-check"></i><b>29.1.4</b> <strong>Benefits of Localization in SDID</strong></a></li>
<li class="chapter" data-level="29.1.5" data-path="understanding.html"><a href="understanding.html#designing-sdid-weights"><i class="fa fa-check"></i><b>29.1.5</b> <strong>Designing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.6" data-path="understanding.html"><a href="understanding.html#how-sdid-enhances-dids-plausibility"><i class="fa fa-check"></i><b>29.1.6</b> <strong>How SDID Enhances DID’s Plausibility</strong></a></li>
<li class="chapter" data-level="29.1.7" data-path="understanding.html"><a href="understanding.html#choosing-sdid-weights"><i class="fa fa-check"></i><b>29.1.7</b> <strong>Choosing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.8" data-path="understanding.html"><a href="understanding.html#accounting-for-time-varying-covariates-in-weight-estimation"><i class="fa fa-check"></i><b>29.1.8</b> <strong>Accounting for Time-Varying Covariates in Weight Estimation</strong></a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="application-3.html"><a href="application-3.html"><i class="fa fa-check"></i><b>29.2</b> Application</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="application-3.html"><a href="application-3.html#block-treatment"><i class="fa fa-check"></i><b>29.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="29.2.2" data-path="application-3.html"><a href="application-3.html#staggered-adoption"><i class="fa fa-check"></i><b>29.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="sec-difference-in-differences.html"><a href="sec-difference-in-differences.html"><i class="fa fa-check"></i><b>30</b> Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.1" data-path="empirical-studies.html"><a href="empirical-studies.html"><i class="fa fa-check"></i><b>30.1</b> Empirical Studies</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-marketing"><i class="fa fa-check"></i><b>30.1.1</b> Applications of DID in Marketing</a></li>
<li class="chapter" data-level="30.1.2" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-economics"><i class="fa fa-check"></i><b>30.1.2</b> Applications of DID in Economics</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>30.2</b> Visualization</a></li>
<li class="chapter" data-level="30.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html"><i class="fa fa-check"></i><b>30.3</b> Simple Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#basic-setup-of-did"><i class="fa fa-check"></i><b>30.3.1</b> Basic Setup of DID</a></li>
<li class="chapter" data-level="30.3.2" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#extensions-of-did"><i class="fa fa-check"></i><b>30.3.2</b> Extensions of DID</a></li>
<li class="chapter" data-level="30.3.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#goals-of-did"><i class="fa fa-check"></i><b>30.3.3</b> Goals of DID</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="empirical-studies-1.html"><a href="empirical-studies-1.html"><i class="fa fa-check"></i><b>30.4</b> Empirical Studies</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="empirical-studies-1.html"><a href="empirical-studies-1.html#example-the-unintended-consequences-of-ban-the-box-policies"><i class="fa fa-check"></i><b>30.4.1</b> Example: The Unintended Consequences of “Ban the Box” Policies</a></li>
<li class="chapter" data-level="30.4.2" data-path="empirical-studies-1.html"><a href="empirical-studies-1.html#example-minimum-wage-and-employment"><i class="fa fa-check"></i><b>30.4.2</b> Example: Minimum Wage and Employment</a></li>
<li class="chapter" data-level="30.4.3" data-path="empirical-studies-1.html"><a href="empirical-studies-1.html#example-the-effects-of-grade-policies-on-major-choice"><i class="fa fa-check"></i><b>30.4.3</b> Example: The Effects of Grade Policies on Major Choice</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>30.5</b> One Difference</a></li>
<li class="chapter" data-level="30.6" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html"><i class="fa fa-check"></i><b>30.6</b> Two-Way Fixed Effects</a>
<ul>
<li class="chapter" data-level="30.6.1" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#remedies-for-twfes-shortcomings"><i class="fa fa-check"></i><b>30.6.1</b> Remedies for TWFE’s Shortcomings</a></li>
<li class="chapter" data-level="30.6.2" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#sec-reshaped-inverse-probability-weighting-twfe-estimator"><i class="fa fa-check"></i><b>30.6.2</b> Reshaped Inverse Probability Weighting - TWFE Estimator</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>30.7</b> Multiple Periods and Variation in Treatment Timing</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html#group-time-average-treatment-effects-callaway2021difference"><i class="fa fa-check"></i><b>30.7.1</b> Group-Time Average Treatment Effects <span class="citation">(Callaway and Sant’Anna 2021)</span></a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="staggered-difference-in-differences.html"><a href="staggered-difference-in-differences.html"><i class="fa fa-check"></i><b>30.8</b> Staggered Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.8.1" data-path="staggered-difference-in-differences.html"><a href="staggered-difference-in-differences.html#general-twfe-event-study-model-sun2021estimating"><i class="fa fa-check"></i><b>30.8.1</b> General TWFE Event-Study Model <span class="citation">(L. Sun and Abraham 2021)</span></a></li>
</ul></li>
<li class="chapter" data-level="30.9" data-path="critiques-of-twfe-in-staggered-did.html"><a href="critiques-of-twfe-in-staggered-did.html"><i class="fa fa-check"></i><b>30.9</b> Critiques of TWFE in Staggered DiD</a></li>
<li class="chapter" data-level="30.10" data-path="key-assumptions-of-staggered-did-designs.html"><a href="key-assumptions-of-staggered-did-designs.html"><i class="fa fa-check"></i><b>30.10</b> Key Assumptions of Staggered DiD Designs</a></li>
<li class="chapter" data-level="30.11" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html"><i class="fa fa-check"></i><b>30.11</b> Remedies for Staggered DiD Biases</a>
<ul>
<li class="chapter" data-level="30.11.1" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#sec-stacked-difference-in-differences"><i class="fa fa-check"></i><b>30.11.1</b> Stacked Difference-in-Differences</a></li>
<li class="chapter" data-level="30.11.2" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#sec-goodman-bacon-decomposition"><i class="fa fa-check"></i><b>30.11.2</b> Goodman-Bacon Decomposition</a></li>
<li class="chapter" data-level="30.11.3" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#did-with-in-and-out-treatment-condition"><i class="fa fa-check"></i><b>30.11.3</b> DID with in and out treatment condition</a></li>
<li class="chapter" data-level="30.11.4" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#gardner2022two-and-borusyak2024revisiting"><i class="fa fa-check"></i><b>30.11.4</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2024)</span></a></li>
<li class="chapter" data-level="30.11.5" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#de2020two"><i class="fa fa-check"></i><b>30.11.5</b> <span class="citation">Clément De Chaisemartin and d’Haultfoeuille (2020)</span></a></li>
<li class="chapter" data-level="30.11.6" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#callaway2021difference"><i class="fa fa-check"></i><b>30.11.6</b> <span class="citation">Callaway and Sant’Anna (2021)</span></a></li>
<li class="chapter" data-level="30.11.7" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#sun2021estimating"><i class="fa fa-check"></i><b>30.11.7</b> <span class="citation">L. Sun and Abraham (2021)</span></a></li>
<li class="chapter" data-level="30.11.8" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#wooldridge2023simple"><i class="fa fa-check"></i><b>30.11.8</b> <span class="citation">Wooldridge (2023)</span></a></li>
<li class="chapter" data-level="30.11.9" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#doubly-robust-did"><i class="fa fa-check"></i><b>30.11.9</b> Doubly Robust DiD</a></li>
<li class="chapter" data-level="30.11.10" data-path="remedies-for-staggered-did-biases.html"><a href="remedies-for-staggered-did-biases.html#augmentedforward-did"><i class="fa fa-check"></i><b>30.11.10</b> Augmented/Forward DID</a></li>
</ul></li>
<li class="chapter" data-level="30.12" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>30.12</b> Multiple Treatments</a>
<ul>
<li class="chapter" data-level="30.12.1" data-path="multiple-treatments.html"><a href="multiple-treatments.html#multiple-treatment-groups-model-specification"><i class="fa fa-check"></i><b>30.12.1</b> Multiple Treatment Groups: Model Specification</a></li>
<li class="chapter" data-level="30.12.2" data-path="multiple-treatments.html"><a href="multiple-treatments.html#understanding-the-control-group-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.12.2</b> Understanding the Control Group in Multiple Treatment DiD</a></li>
<li class="chapter" data-level="30.12.3" data-path="multiple-treatments.html"><a href="multiple-treatments.html#alternative-approaches-separate-regressions-vs.-one-model"><i class="fa fa-check"></i><b>30.12.3</b> Alternative Approaches: Separate Regressions vs. One Model</a></li>
<li class="chapter" data-level="30.12.4" data-path="multiple-treatments.html"><a href="multiple-treatments.html#handling-treatment-intensity"><i class="fa fa-check"></i><b>30.12.4</b> Handling Treatment Intensity</a></li>
<li class="chapter" data-level="30.12.5" data-path="multiple-treatments.html"><a href="multiple-treatments.html#considerations-when-individuals-can-move-between-treatment-groups"><i class="fa fa-check"></i><b>30.12.5</b> Considerations When Individuals Can Move Between Treatment Groups</a></li>
<li class="chapter" data-level="30.12.6" data-path="multiple-treatments.html"><a href="multiple-treatments.html#parallel-trends-assumption-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.12.6</b> Parallel Trends Assumption in Multiple-Treatment DiD</a></li>
</ul></li>
<li class="chapter" data-level="30.13" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>30.13</b> Mediation Under DiD</a>
<ul>
<li class="chapter" data-level="30.13.1" data-path="mediation-under-did.html"><a href="mediation-under-did.html#mediation-model-in-did"><i class="fa fa-check"></i><b>30.13.1</b> Mediation Model in DiD</a></li>
<li class="chapter" data-level="30.13.2" data-path="mediation-under-did.html"><a href="mediation-under-did.html#interpreting-the-results"><i class="fa fa-check"></i><b>30.13.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="30.13.3" data-path="mediation-under-did.html"><a href="mediation-under-did.html#challenges-in-mediation-analysis-for-did"><i class="fa fa-check"></i><b>30.13.3</b> Challenges in Mediation Analysis for DiD</a></li>
<li class="chapter" data-level="30.13.4" data-path="mediation-under-did.html"><a href="mediation-under-did.html#alternative-approach-instrumental-variables-for-mediation"><i class="fa fa-check"></i><b>30.13.4</b> Alternative Approach: Instrumental Variables for Mediation</a></li>
</ul></li>
<li class="chapter" data-level="30.14" data-path="assumptions-1.html"><a href="assumptions-1.html"><i class="fa fa-check"></i><b>30.14</b> Assumptions</a>
<ul>
<li class="chapter" data-level="30.14.1" data-path="assumptions-1.html"><a href="assumptions-1.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>30.14.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="30.14.2" data-path="assumptions-1.html"><a href="assumptions-1.html#sec-placebo-test-did"><i class="fa fa-check"></i><b>30.14.2</b> Placebo Test</a></li>
</ul></li>
<li class="chapter" data-level="30.15" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html"><i class="fa fa-check"></i><b>30.15</b> Robustness Checks</a>
<ul>
<li class="chapter" data-level="30.15.1" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#robustness-checks-to-strengthen-causal-interpretation"><i class="fa fa-check"></i><b>30.15.1</b> Robustness Checks to Strengthen Causal Interpretation</a></li>
<li class="chapter" data-level="30.15.2" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#best-practices-for-reliable-did-implementation"><i class="fa fa-check"></i><b>30.15.2</b> Best Practices for Reliable DiD Implementation</a></li>
</ul></li>
<li class="chapter" data-level="30.16" data-path="concerns-in-did.html"><a href="concerns-in-did.html"><i class="fa fa-check"></i><b>30.16</b> Concerns in DID</a>
<ul>
<li class="chapter" data-level="30.16.1" data-path="concerns-in-did.html"><a href="concerns-in-did.html#matching-methods-in-did"><i class="fa fa-check"></i><b>30.16.1</b> Matching Methods in DID</a></li>
<li class="chapter" data-level="30.16.2" data-path="concerns-in-did.html"><a href="concerns-in-did.html#control-variables-in-did"><i class="fa fa-check"></i><b>30.16.2</b> Control Variables in DID</a></li>
<li class="chapter" data-level="30.16.3" data-path="concerns-in-did.html"><a href="concerns-in-did.html#did-for-count-data-fixed-effects-poisson-model"><i class="fa fa-check"></i><b>30.16.3</b> DID for Count Data: Fixed-Effects Poisson Model</a></li>
<li class="chapter" data-level="30.16.4" data-path="concerns-in-did.html"><a href="concerns-in-did.html#handling-zero-valued-outcomes-in-did"><i class="fa fa-check"></i><b>30.16.4</b> Handling Zero-Valued Outcomes in DID</a></li>
<li class="chapter" data-level="30.16.5" data-path="concerns-in-did.html"><a href="concerns-in-did.html#standard-errors-1"><i class="fa fa-check"></i><b>30.16.5</b> Standard Errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="sec-changes-in-changes.html"><a href="sec-changes-in-changes.html"><i class="fa fa-check"></i><b>31</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="31.1" data-path="key-concepts.html"><a href="key-concepts.html"><i class="fa fa-check"></i><b>31.1</b> Key Concepts</a></li>
<li class="chapter" data-level="31.2" data-path="estimating-qtt-with-cic.html"><a href="estimating-qtt-with-cic.html"><i class="fa fa-check"></i><b>31.2</b> Estimating QTT with CiC</a></li>
<li class="chapter" data-level="31.3" data-path="application-4.html"><a href="application-4.html"><i class="fa fa-check"></i><b>31.3</b> Application</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="application-4.html"><a href="application-4.html#ecic-package"><i class="fa fa-check"></i><b>31.3.1</b> ECIC package</a></li>
<li class="chapter" data-level="31.3.2" data-path="application-4.html"><a href="application-4.html#qte-package"><i class="fa fa-check"></i><b>31.3.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="sec-synthetic-control.html"><a href="sec-synthetic-control.html"><i class="fa fa-check"></i><b>32</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.1" data-path="marketing-applications.html"><a href="marketing-applications.html"><i class="fa fa-check"></i><b>32.1</b> Marketing Applications</a></li>
<li class="chapter" data-level="32.2" data-path="key-features-of-scm.html"><a href="key-features-of-scm.html"><i class="fa fa-check"></i><b>32.2</b> Key Features of SCM</a></li>
<li class="chapter" data-level="32.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html"><i class="fa fa-check"></i><b>32.3</b> Advantages of SCM</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-did"><i class="fa fa-check"></i><b>32.3.1</b> Compared to DiD</a></li>
<li class="chapter" data-level="32.3.2" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-linear-regression"><i class="fa fa-check"></i><b>32.3.2</b> Compared to Linear Regression</a></li>
<li class="chapter" data-level="32.3.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#additional-advantages"><i class="fa fa-check"></i><b>32.3.3</b> Additional Advantages</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="disadvantages-of-scm.html"><a href="disadvantages-of-scm.html"><i class="fa fa-check"></i><b>32.4</b> Disadvantages of SCM</a></li>
<li class="chapter" data-level="32.5" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>32.5</b> Assumptions</a></li>
<li class="chapter" data-level="32.6" data-path="estimation-2.html"><a href="estimation-2.html"><i class="fa fa-check"></i><b>32.6</b> Estimation</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="estimation-2.html"><a href="estimation-2.html#constructing-the-synthetic-control"><i class="fa fa-check"></i><b>32.6.1</b> Constructing the Synthetic Control</a></li>
<li class="chapter" data-level="32.6.2" data-path="estimation-2.html"><a href="estimation-2.html#penalized-synthetic-control"><i class="fa fa-check"></i><b>32.6.2</b> Penalized Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="theoretical-considerations.html"><a href="theoretical-considerations.html"><i class="fa fa-check"></i><b>32.7</b> Theoretical Considerations</a></li>
<li class="chapter" data-level="32.8" data-path="inference-in-scm.html"><a href="inference-in-scm.html"><i class="fa fa-check"></i><b>32.8</b> Inference in SCM</a>
<ul>
<li class="chapter" data-level="32.8.1" data-path="inference-in-scm.html"><a href="inference-in-scm.html#permutation-placebo-inference"><i class="fa fa-check"></i><b>32.8.1</b> Permutation (Placebo) Inference</a></li>
<li class="chapter" data-level="32.8.2" data-path="inference-in-scm.html"><a href="inference-in-scm.html#one-sided-inference"><i class="fa fa-check"></i><b>32.8.2</b> One-Sided Inference</a></li>
</ul></li>
<li class="chapter" data-level="32.9" data-path="sec-augmented-synthetic-control.html"><a href="sec-augmented-synthetic-control.html"><i class="fa fa-check"></i><b>32.9</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="32.10" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>32.10</b> Synthetic Control with Staggered Adoption</a>
<ul>
<li class="chapter" data-level="32.10.1" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html#partially-pooled-synthetic-control"><i class="fa fa-check"></i><b>32.10.1</b> Partially Pooled Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.11" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>32.11</b> Generalized Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.11.1" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#the-problem-with-traditional-methods"><i class="fa fa-check"></i><b>32.11.1</b> The Problem with Traditional Methods</a></li>
<li class="chapter" data-level="32.11.2" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#generalized-synthetic-control-model"><i class="fa fa-check"></i><b>32.11.2</b> Generalized Synthetic Control Model</a></li>
<li class="chapter" data-level="32.11.3" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#identification-and-estimation"><i class="fa fa-check"></i><b>32.11.3</b> Identification and Estimation</a></li>
<li class="chapter" data-level="32.11.4" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#bootstrap-procedure-for-standard-errors"><i class="fa fa-check"></i><b>32.11.4</b> Bootstrap Procedure for Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="32.12" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>32.12</b> Bayesian Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.12.1" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-causal-inference-framework"><i class="fa fa-check"></i><b>32.12.1</b> Bayesian Causal Inference Framework</a></li>
<li class="chapter" data-level="32.12.2" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-dynamic-multilevel-factor-model"><i class="fa fa-check"></i><b>32.12.2</b> Bayesian Dynamic Multilevel Factor Model</a></li>
<li class="chapter" data-level="32.12.3" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-sparse-synthetic-control"><i class="fa fa-check"></i><b>32.12.3</b> Bayesian Sparse Synthetic Control</a></li>
<li class="chapter" data-level="32.12.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-inference-and-mcmc-estimation"><i class="fa fa-check"></i><b>32.12.4</b> Bayesian Inference and MCMC Estimation</a></li>
</ul></li>
<li class="chapter" data-level="32.13" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><i class="fa fa-check"></i><b>32.13</b> Using Multiple Outcomes to Improve the Synthetic Control Method</a>
<ul>
<li class="chapter" data-level="32.13.1" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#standard-synthetic-control-method"><i class="fa fa-check"></i><b>32.13.1</b> Standard Synthetic Control Method</a></li>
<li class="chapter" data-level="32.13.2" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#using-multiple-outcomes-for-bias-reduction"><i class="fa fa-check"></i><b>32.13.2</b> Using Multiple Outcomes for Bias Reduction</a></li>
<li class="chapter" data-level="32.13.3" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#estimation-methods-1"><i class="fa fa-check"></i><b>32.13.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="32.13.4" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#empirical-application-flint-water-crisis"><i class="fa fa-check"></i><b>32.13.4</b> Empirical Application: Flint Water Crisis</a></li>
</ul></li>
<li class="chapter" data-level="32.14" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>32.14</b> Applications</a>
<ul>
<li class="chapter" data-level="32.14.1" data-path="applications.html"><a href="applications.html#synthetic-control-estimation"><i class="fa fa-check"></i><b>32.14.1</b> Synthetic Control Estimation</a></li>
<li class="chapter" data-level="32.14.2" data-path="applications.html"><a href="applications.html#the-basque-country-policy-change"><i class="fa fa-check"></i><b>32.14.2</b> The Basque Country Policy Change</a></li>
<li class="chapter" data-level="32.14.3" data-path="applications.html"><a href="applications.html#micro-synthetic-control-with-microsynth"><i class="fa fa-check"></i><b>32.14.3</b> Micro-Synthetic Control with <code>microsynth</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="sec-event-studies.html"><a href="sec-event-studies.html"><i class="fa fa-check"></i><b>33</b> Event Studies</a>
<ul>
<li class="chapter" data-level="33.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html"><i class="fa fa-check"></i><b>33.1</b> Review of Event Studies Across Disciplines</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#finance-applications"><i class="fa fa-check"></i><b>33.1.1</b> Finance Applications</a></li>
<li class="chapter" data-level="33.1.2" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#management-applications"><i class="fa fa-check"></i><b>33.1.2</b> Management Applications</a></li>
<li class="chapter" data-level="33.1.3" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#marketing-applications-1"><i class="fa fa-check"></i><b>33.1.3</b> Marketing Applications</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="key-assumptions-3.html"><a href="key-assumptions-3.html"><i class="fa fa-check"></i><b>33.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="33.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html"><i class="fa fa-check"></i><b>33.3</b> Steps for Conducting an Event Study</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-1-event-identification"><i class="fa fa-check"></i><b>33.3.1</b> Step 1: Event Identification</a></li>
<li class="chapter" data-level="33.3.2" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-2-define-the-event-and-estimation-windows"><i class="fa fa-check"></i><b>33.3.2</b> Step 2: Define the Event and Estimation Windows</a></li>
<li class="chapter" data-level="33.3.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-3-compute-normal-vs.-abnormal-returns"><i class="fa fa-check"></i><b>33.3.3</b> Step 3: Compute Normal vs. Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.4" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-4-compute-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.3.4</b> Step 4: Compute Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.5" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-5-statistical-tests-for-significance"><i class="fa fa-check"></i><b>33.3.5</b> Step 5: Statistical Tests for Significance</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html"><i class="fa fa-check"></i><b>33.4</b> Event Studies in Marketing</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#definition"><i class="fa fa-check"></i><b>33.4.1</b> Definition</a></li>
<li class="chapter" data-level="33.4.2" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#when-can-marketing-events-affect-non-operating-assets-or-debt"><i class="fa fa-check"></i><b>33.4.2</b> When Can Marketing Events Affect Non-Operating Assets or Debt?</a></li>
<li class="chapter" data-level="33.4.3" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#calculating-the-leverage-effect"><i class="fa fa-check"></i><b>33.4.3</b> Calculating the Leverage Effect</a></li>
<li class="chapter" data-level="33.4.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#computing-leverage-effect-from-compustat-data"><i class="fa fa-check"></i><b>33.4.4</b> Computing Leverage Effect from Compustat Data</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="economic-significance.html"><a href="economic-significance.html"><i class="fa fa-check"></i><b>33.5</b> Economic Significance</a></li>
<li class="chapter" data-level="33.6" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html"><i class="fa fa-check"></i><b>33.6</b> Testing in Event Studies</a>
<ul>
<li class="chapter" data-level="33.6.1" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#statistical-power-in-event-studies"><i class="fa fa-check"></i><b>33.6.1</b> Statistical Power in Event Studies</a></li>
<li class="chapter" data-level="33.6.2" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#parametric-tests"><i class="fa fa-check"></i><b>33.6.2</b> Parametric Tests</a></li>
<li class="chapter" data-level="33.6.3" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#non-parametric-tests-1"><i class="fa fa-check"></i><b>33.6.3</b> Non-Parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.7" data-path="sample-in-event-studies.html"><a href="sample-in-event-studies.html"><i class="fa fa-check"></i><b>33.7</b> Sample in Event Studies</a></li>
<li class="chapter" data-level="33.8" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html"><i class="fa fa-check"></i><b>33.8</b> Confounders in Event Studies</a>
<ul>
<li class="chapter" data-level="33.8.1" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#types-of-confounding-events"><i class="fa fa-check"></i><b>33.8.1</b> Types of Confounding Events</a></li>
<li class="chapter" data-level="33.8.2" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#should-we-exclude-confounded-observations"><i class="fa fa-check"></i><b>33.8.2</b> Should We Exclude Confounded Observations?</a></li>
<li class="chapter" data-level="33.8.3" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#simulation-study-should-we-exclude-correlated-and-uncorrelated-events"><i class="fa fa-check"></i><b>33.8.3</b> Simulation Study: Should We Exclude Correlated and Uncorrelated Events?</a></li>
</ul></li>
<li class="chapter" data-level="33.9" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html"><i class="fa fa-check"></i><b>33.9</b> Biases in Event Studies</a>
<ul>
<li class="chapter" data-level="33.9.1" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#timing-bias-different-market-closing-times"><i class="fa fa-check"></i><b>33.9.1</b> Timing Bias: Different Market Closing Times</a></li>
<li class="chapter" data-level="33.9.2" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#upward-bias-in-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.9.2</b> Upward Bias in Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.9.3" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#cross-sectional-dependence-bias"><i class="fa fa-check"></i><b>33.9.3</b> Cross-Sectional Dependence Bias</a></li>
<li class="chapter" data-level="33.9.4" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#sample-selection-bias"><i class="fa fa-check"></i><b>33.9.4</b> Sample Selection Bias</a></li>
<li class="chapter" data-level="33.9.5" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#corrections-for-sample-selection-bias"><i class="fa fa-check"></i><b>33.9.5</b> Corrections for Sample Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="33.10" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>33.10</b> Long-run Event Studies</a>
<ul>
<li class="chapter" data-level="33.10.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#sec-buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>33.10.1</b> Buy-and-Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="33.10.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>33.10.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="33.10.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>33.10.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="33.11" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>33.11</b> Aggregation</a>
<ul>
<li class="chapter" data-level="33.11.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>33.11.1</b> Over Time</a></li>
<li class="chapter" data-level="33.11.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-and-over-time"><i class="fa fa-check"></i><b>33.11.2</b> Across Firms and Over Time</a></li>
<li class="chapter" data-level="33.11.3" data-path="aggregation.html"><a href="aggregation.html#statistical-tests-1"><i class="fa fa-check"></i><b>33.11.3</b> Statistical Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.12" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>33.12</b> Heterogeneity in the Event Effect</a>
<ul>
<li class="chapter" data-level="33.12.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-affecting-car-in-marketing-and-finance"><i class="fa fa-check"></i><b>33.12.1</b> Common Variables Affecting CAR in Marketing and Finance</a></li>
</ul></li>
<li class="chapter" data-level="33.13" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>33.13</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="33.13.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.1</b> <strong>Statistical Models for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.13.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.2</b> <strong>Economic Models for Expected Returns</strong></a></li>
</ul></li>
<li class="chapter" data-level="33.14" data-path="application-of-event-study.html"><a href="application-of-event-study.html"><i class="fa fa-check"></i><b>33.14</b> Application of Event Study</a>
<ul>
<li class="chapter" data-level="33.14.1" data-path="application-of-event-study.html"><a href="application-of-event-study.html#sorting-portfolios-for-expected-returns"><i class="fa fa-check"></i><b>33.14.1</b> <strong>Sorting Portfolios for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.14.2" data-path="application-of-event-study.html"><a href="application-of-event-study.html#erer-package"><i class="fa fa-check"></i><b>33.14.2</b> <strong><code>erer</code> Package</strong></a></li>
<li class="chapter" data-level="33.14.3" data-path="application-of-event-study.html"><a href="application-of-event-study.html#eventus"><i class="fa fa-check"></i><b>33.14.3</b> Eventus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="sec-instrumental-variables.html"><a href="sec-instrumental-variables.html"><i class="fa fa-check"></i><b>34</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.1" data-path="challenges-with-instrumental-variables.html"><a href="challenges-with-instrumental-variables.html"><i class="fa fa-check"></i><b>34.1</b> Challenges with Instrumental Variables</a></li>
<li class="chapter" data-level="34.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html"><i class="fa fa-check"></i><b>34.2</b> Framework for Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#constant-treatment-effect-model"><i class="fa fa-check"></i><b>34.2.1</b> Constant-Treatment-Effect Model</a></li>
<li class="chapter" data-level="34.2.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#instrumental-variable-solution"><i class="fa fa-check"></i><b>34.2.2</b> Instrumental Variable Solution</a></li>
<li class="chapter" data-level="34.2.3" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#heterogeneous-treatment-effects-and-the-late-framework"><i class="fa fa-check"></i><b>34.2.3</b> Heterogeneous Treatment Effects and the LATE Framework</a></li>
<li class="chapter" data-level="34.2.4" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#assumptions-for-late-identification"><i class="fa fa-check"></i><b>34.2.4</b> Assumptions for LATE Identification</a></li>
<li class="chapter" data-level="34.2.5" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#local-average-treatment-effect-theorem"><i class="fa fa-check"></i><b>34.2.5</b> Local Average Treatment Effect Theorem</a></li>
<li class="chapter" data-level="34.2.6" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#iv-in-randomized-trials-noncompliance"><i class="fa fa-check"></i><b>34.2.6</b> IV in Randomized Trials (Noncompliance)</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="sec-estimation.html"><a href="sec-estimation.html"><i class="fa fa-check"></i><b>34.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-two-stage-least-squares-estimation"><i class="fa fa-check"></i><b>34.3.1</b> Two-Stage Least Squares Estimation</a></li>
<li class="chapter" data-level="34.3.2" data-path="sec-estimation.html"><a href="sec-estimation.html#iv-gmm"><i class="fa fa-check"></i><b>34.3.2</b> IV-GMM</a></li>
<li class="chapter" data-level="34.3.3" data-path="sec-estimation.html"><a href="sec-estimation.html#limited-information-maximum-likelihood"><i class="fa fa-check"></i><b>34.3.3</b> Limited Information Maximum Likelihood</a></li>
<li class="chapter" data-level="34.3.4" data-path="sec-estimation.html"><a href="sec-estimation.html#jackknife-iv"><i class="fa fa-check"></i><b>34.3.4</b> Jackknife IV</a></li>
<li class="chapter" data-level="34.3.5" data-path="sec-estimation.html"><a href="sec-estimation.html#control-function-approach"><i class="fa fa-check"></i><b>34.3.5</b> Control Function Approach</a></li>
<li class="chapter" data-level="34.3.6" data-path="sec-estimation.html"><a href="sec-estimation.html#fuller-and-bias-reduced-iv"><i class="fa fa-check"></i><b>34.3.6</b> Fuller and Bias-Reduced IV</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html"><i class="fa fa-check"></i><b>34.4</b> Asymptotic Properties of the IV Estimator</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#sec-consistency-iv"><i class="fa fa-check"></i><b>34.4.1</b> Consistency</a></li>
<li class="chapter" data-level="34.4.2" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-normality-1"><i class="fa fa-check"></i><b>34.4.2</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="34.4.3" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-efficiency-1"><i class="fa fa-check"></i><b>34.4.3</b> Asymptotic Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html"><i class="fa fa-check"></i><b>34.5</b> Inference</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#weak-instruments-problem"><i class="fa fa-check"></i><b>34.5.1</b> Weak Instruments Problem</a></li>
<li class="chapter" data-level="34.5.2" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#solutions-and-approaches-for-valid-inference"><i class="fa fa-check"></i><b>34.5.2</b> Solutions and Approaches for Valid Inference</a></li>
<li class="chapter" data-level="34.5.3" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-anderson-rubin-approach"><i class="fa fa-check"></i><b>34.5.3</b> Anderson-Rubin Approach</a></li>
<li class="chapter" data-level="34.5.4" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-tf-procedure"><i class="fa fa-check"></i><b>34.5.4</b> tF Procedure</a></li>
<li class="chapter" data-level="34.5.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-ak-approach"><i class="fa fa-check"></i><b>34.5.5</b> AK Approach</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>34.6</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="34.6.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-relevance-assumption"><i class="fa fa-check"></i><b>34.6.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="34.6.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#independence-unconfoundedness"><i class="fa fa-check"></i><b>34.6.2</b> Independence (Unconfoundedness)</a></li>
<li class="chapter" data-level="34.6.3" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-monotonicity-assumption"><i class="fa fa-check"></i><b>34.6.3</b> Monotonicity Assumption</a></li>
<li class="chapter" data-level="34.6.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html#homogeneous-treatment-effects-optional"><i class="fa fa-check"></i><b>34.6.4</b> Homogeneous Treatment Effects (Optional)</a></li>
<li class="chapter" data-level="34.6.5" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-linearity-and-additivity"><i class="fa fa-check"></i><b>34.6.5</b> Linearity and Additivity</a></li>
<li class="chapter" data-level="34.6.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html#instrument-exogeneity-exclusion-restriction"><i class="fa fa-check"></i><b>34.6.6</b> Instrument Exogeneity (Exclusion Restriction)</a></li>
<li class="chapter" data-level="34.6.7" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-exogeneity-assumption"><i class="fa fa-check"></i><b>34.6.7</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html"><i class="fa fa-check"></i><b>34.7</b> Negative <span class="math inline">\(R^2\)</span> in IV</a>
<ul>
<li class="chapter" data-level="34.7.1" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-does-r2-lose-its-meaning-in-iv-regression"><i class="fa fa-check"></i><b>34.7.1</b> Why Does <span class="math inline">\(R^2\)</span> Lose Its Meaning in IV Regression?</a></li>
<li class="chapter" data-level="34.7.2" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-r2-can-be-negative"><i class="fa fa-check"></i><b>34.7.2</b> Why <span class="math inline">\(R^2\)</span> Can Be Negative:</a></li>
<li class="chapter" data-level="34.7.3" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#why-we-dont-care-about-r2-in-iv"><i class="fa fa-check"></i><b>34.7.3</b> Why We Don’t Care About <span class="math inline">\(R^2\)</span> in IV</a></li>
<li class="chapter" data-level="34.7.4" data-path="negative-r2-in-iv.html"><a href="negative-r2-in-iv.html#technical-details-on-r2"><i class="fa fa-check"></i><b>34.7.4</b> Technical Details on <span class="math inline">\(R^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="34.8" data-path="treatment-intensity.html"><a href="treatment-intensity.html"><i class="fa fa-check"></i><b>34.8</b> Treatment Intensity</a>
<ul>
<li class="chapter" data-level="34.8.1" data-path="treatment-intensity.html"><a href="treatment-intensity.html#example-schooling-and-earnings"><i class="fa fa-check"></i><b>34.8.1</b> Example: Schooling and Earnings</a></li>
<li class="chapter" data-level="34.8.2" data-path="treatment-intensity.html"><a href="treatment-intensity.html#causal-interpretation-of-rho"><i class="fa fa-check"></i><b>34.8.2</b> Causal Interpretation of <span class="math inline">\(\rho\)</span></a></li>
</ul></li>
<li class="chapter" data-level="34.9" data-path="emerging-research-1.html"><a href="emerging-research-1.html"><i class="fa fa-check"></i><b>34.9</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="34.9.1" data-path="emerging-research-1.html"><a href="emerging-research-1.html#heterogeneous-effects-in-iv-estimation"><i class="fa fa-check"></i><b>34.9.1</b> Heterogeneous Effects in IV Estimation</a></li>
<li class="chapter" data-level="34.9.2" data-path="emerging-research-1.html"><a href="emerging-research-1.html#zero-valued-outcomes"><i class="fa fa-check"></i><b>34.9.2</b> Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="sec-matching-methods.html"><a href="sec-matching-methods.html"><i class="fa fa-check"></i><b>35</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="35.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html"><i class="fa fa-check"></i><b>35.1</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchit"><i class="fa fa-check"></i><b>35.1.1</b> MatchIt</a></li>
<li class="chapter" data-level="35.1.2" data-path="selection-on-observables.html"><a href="selection-on-observables.html#designmatch"><i class="fa fa-check"></i><b>35.1.2</b> designmatch</a></li>
<li class="chapter" data-level="35.1.3" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>35.1.3</b> MatchingFrontier</a></li>
<li class="chapter" data-level="35.1.4" data-path="selection-on-observables.html"><a href="selection-on-observables.html#sec-propensity-scores"><i class="fa fa-check"></i><b>35.1.4</b> Propensity Scores</a></li>
<li class="chapter" data-level="35.1.5" data-path="selection-on-observables.html"><a href="selection-on-observables.html#mahalanobis-distance"><i class="fa fa-check"></i><b>35.1.5</b> Mahalanobis Distance</a></li>
<li class="chapter" data-level="35.1.6" data-path="selection-on-observables.html"><a href="selection-on-observables.html#coarsened-exact-matching"><i class="fa fa-check"></i><b>35.1.6</b> Coarsened Exact Matching</a></li>
<li class="chapter" data-level="35.1.7" data-path="selection-on-observables.html"><a href="selection-on-observables.html#genetic-matching"><i class="fa fa-check"></i><b>35.1.7</b> Genetic Matching</a></li>
<li class="chapter" data-level="35.1.8" data-path="selection-on-observables.html"><a href="selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>35.1.8</b> Entropy Balancing</a></li>
<li class="chapter" data-level="35.1.9" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>35.1.9</b> Matching for high-dimensional data</a></li>
<li class="chapter" data-level="35.1.10" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-time-series-cross-section-data"><i class="fa fa-check"></i><b>35.1.10</b> Matching for time series-cross-section data</a></li>
<li class="chapter" data-level="35.1.11" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>35.1.11</b> Matching for multiple treatments</a></li>
<li class="chapter" data-level="35.1.12" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>35.1.12</b> Matching for multi-level treatments</a></li>
<li class="chapter" data-level="35.1.13" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-repeated-treatments"><i class="fa fa-check"></i><b>35.1.13</b> Matching for repeated treatments</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html"><i class="fa fa-check"></i><b>35.2</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#sec-rosenbaum-bounds"><i class="fa fa-check"></i><b>35.2.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="35.2.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#relative-correlation-restrictions"><i class="fa fa-check"></i><b>35.2.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="35.2.3" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#coefficient-stability-bounds"><i class="fa fa-check"></i><b>35.2.3</b> Coefficient-stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="36" data-path="endogeneity.html"><a href="endogeneity.html"><i class="fa fa-check"></i><b>36</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="36.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html"><i class="fa fa-check"></i><b>36.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#measurement-error"><i class="fa fa-check"></i><b>36.1.1</b> Measurement Error</a></li>
<li class="chapter" data-level="36.1.2" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#simultaneity"><i class="fa fa-check"></i><b>36.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="36.1.3" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#endogenous-treatment-solutions"><i class="fa fa-check"></i><b>36.1.3</b> Endogenous Treatment Solutions</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html"><i class="fa fa-check"></i><b>36.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#unifying-model-frameworks"><i class="fa fa-check"></i><b>36.2.1</b> Unifying Model Frameworks</a></li>
<li class="chapter" data-level="36.2.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#estimation-methods-2"><i class="fa fa-check"></i><b>36.2.2</b> Estimation Methods</a></li>
<li class="chapter" data-level="36.2.3" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#theoretical-connections"><i class="fa fa-check"></i><b>36.2.3</b> Theoretical Connections</a></li>
<li class="chapter" data-level="36.2.4" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-2-heckmans-sample-selection-model"><i class="fa fa-check"></i><b>36.2.4</b> Tobit-2: Heckman’s Sample Selection Model</a></li>
<li class="chapter" data-level="36.2.5" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-5-switching-regression-model"><i class="fa fa-check"></i><b>36.2.5</b> Tobit-5: Switching Regression Model</a></li>
<li class="chapter" data-level="36.2.6" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#pattern-mixture-models"><i class="fa fa-check"></i><b>36.2.6</b> Pattern-Mixture Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>37</b> Other Biases</a>
<ul>
<li class="chapter" data-level="37.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html"><i class="fa fa-check"></i><b>37.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html#simpsons-paradox-1"><i class="fa fa-check"></i><b>37.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="contamination-bias.html"><a href="contamination-bias.html"><i class="fa fa-check"></i><b>37.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="37.3" data-path="survivorship-bias.html"><a href="survivorship-bias.html"><i class="fa fa-check"></i><b>37.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="37.4" data-path="publication-bias.html"><a href="publication-bias.html"><i class="fa fa-check"></i><b>37.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="controls.html"><a href="controls.html"><i class="fa fa-check"></i><b>38</b> Controls</a>
<ul>
<li class="chapter" data-level="38.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>38.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="38.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>38.1.1</b> M-bias</a></li>
<li class="chapter" data-level="38.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification-1"><i class="fa fa-check"></i><b>38.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="38.1.3" data-path="bad-controls.html"><a href="bad-controls.html#overcontrol-bias"><i class="fa fa-check"></i><b>38.1.3</b> Overcontrol bias</a></li>
<li class="chapter" data-level="38.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>38.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="38.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>38.1.5</b> Case-control Bias</a></li>
</ul></li>
<li class="chapter" data-level="38.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>38.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>38.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="38.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>38.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>38.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="38.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>38.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="38.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>38.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="38.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>38.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="38.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>38.3.4</b> Bad Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="38.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>38.4</b> Choosing Controls</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="directed-acyclic-graph.html"><a href="directed-acyclic-graph.html"><i class="fa fa-check"></i><b>39</b> Directed Acyclic Graph</a>
<ul>
<li class="chapter" data-level="39.1" data-path="basic-notations.html"><a href="basic-notations.html"><i class="fa fa-check"></i><b>39.1</b> Basic Notations</a></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="40" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>40</b> Report</a>
<ul>
<li class="chapter" data-level="40.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>40.1</b> One summary table</a></li>
<li class="chapter" data-level="40.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>40.2</b> Model Comparison</a></li>
<li class="chapter" data-level="40.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>40.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="40.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>40.4</b> Standard Errors</a></li>
<li class="chapter" data-level="40.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>40.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="40.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>40.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="40.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>40.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>41</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="42" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>42</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="42.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>42.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="42.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>42.1.1</b> starbility</a></li>
<li class="chapter" data-level="42.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>42.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="42.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>42.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="42.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>42.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>43</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>43.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>43.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="43.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>43.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="43.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>43.1.3</b> Exceptions to Replication</a></li>
<li class="chapter" data-level="43.1.4" data-path="the-replication-standard.html"><a href="the-replication-standard.html#replication-landscape"><i class="fa fa-check"></i><b>43.1.4</b> Replication Landscape</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="synthetic-data.html"><a href="synthetic-data.html"><i class="fa fa-check"></i><b>43.2</b> Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="synthetic-data.html"><a href="synthetic-data.html#benefits-of-synthetic-data"><i class="fa fa-check"></i><b>43.2.1</b> Benefits of Synthetic Data</a></li>
<li class="chapter" data-level="43.2.2" data-path="synthetic-data.html"><a href="synthetic-data.html#concerns-and-limitations"><i class="fa fa-check"></i><b>43.2.2</b> Concerns and Limitations</a></li>
<li class="chapter" data-level="43.2.3" data-path="synthetic-data.html"><a href="synthetic-data.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>43.2.3</b> Further Insights on Synthetic Data</a></li>
<li class="chapter" data-level="43.2.4" data-path="synthetic-data.html"><a href="synthetic-data.html#generating-synthetic-data"><i class="fa fa-check"></i><b>43.2.4</b> Generating Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>43.3</b> Application</a>
<ul>
<li class="chapter" data-level="43.3.1" data-path="application-5.html"><a href="application-5.html#original-dataset"><i class="fa fa-check"></i><b>43.3.1</b> Original Dataset</a></li>
<li class="chapter" data-level="43.3.2" data-path="application-5.html"><a href="application-5.html#restricted-dataset"><i class="fa fa-check"></i><b>43.3.2</b> Restricted Dataset</a></li>
<li class="chapter" data-level="43.3.3" data-path="application-5.html"><a href="application-5.html#synthpop"><i class="fa fa-check"></i><b>43.3.3</b> Synthpop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>44</b> High-Performance Computing</a>
<ul>
<li class="chapter" data-level="44.1" data-path="best-practices-for-hpc-in-data-analysis.html"><a href="best-practices-for-hpc-in-data-analysis.html"><i class="fa fa-check"></i><b>44.1</b> Best Practices for HPC in Data Analysis</a></li>
<li class="chapter" data-level="44.2" data-path="example-workflow-in-r.html"><a href="example-workflow-in-r.html"><i class="fa fa-check"></i><b>44.2</b> Example Workflow in R</a></li>
<li class="chapter" data-level="44.3" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>44.3</b> Recommendations</a></li>
<li class="chapter" data-level="44.4" data-path="demonstration.html"><a href="demonstration.html"><i class="fa fa-check"></i><b>44.4</b> Demonstration</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packageslibaries-on-your-local-machine.html"><a href="install-all-necessary-packageslibaries-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="remedies-for-staggered-did-biases" class="section level2 hasAnchor" number="30.11">
<h2><span class="header-section-number">30.11</span> Remedies for Staggered DiD Biases<a href="remedies-for-staggered-did-biases.html#remedies-for-staggered-did-biases" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">(<a href="#ref-baker2022much">Baker, Larcker, and Wang 2022</a>)</span></p>
<ol style="list-style-type: decimal">
<li><strong>Cohort-Specific Comparisons</strong></li>
</ol>
<ul>
<li>Compare <strong>each treated cohort</strong> to appropriate controls:
<ul>
<li><strong>Not-yet-treated</strong> units.</li>
<li><strong>Never-treated</strong> units.</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Alternative Estimators</strong></li>
</ol>
<ul>
<li><span class="citation">(<a href="#ref-goodman2021difference">Goodman-Bacon 2021</a>)</span>: Decomposition methods for TWFE DiD.</li>
<li><span class="citation">(<a href="#ref-callaway2021difference">Callaway and Sant’Anna 2021</a>)</span>: ATT estimators, allowing for heterogeneity and flexible design.</li>
<li><span class="citation">(<a href="#ref-sun2021estimating">L. Sun and Abraham 2021</a>)</span>: Event-study estimation with “clean” controls (a special case of <span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span>)</li>
<li><span class="citation">(<a href="#ref-de2020two">Clément De Chaisemartin and d’Haultfoeuille 2020</a>)</span>: Two-stage DiD approaches.</li>
<li><span class="citation">(<a href="#ref-borusyak2021revisiting">Borusyak, Jaravel, and Spiess 2021</a>)</span>: Simple DiD estimators with automatic inference.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><a href="remedies-for-staggered-did-biases.html#sec-stacked-difference-in-differences">Stacked DID</a> (Simpler but Biased)</li>
</ol>
<ul>
<li>Construct stacked datasets for each treatment cohort.</li>
<li>Run separate regressions for each event.</li>
<li>Examples:
<ul>
<li><span class="citation">(<a href="#ref-gormley2011growing">Gormley and Matsa 2011</a>)</span></li>
<li><span class="citation">(<a href="#ref-cengiz2019effect">Cengiz et al. 2019</a>)</span></li>
<li><span class="citation">(<a href="#ref-deshpande2019screened">Deshpande and Li 2019</a>)</span></li>
</ul></li>
</ul>
<hr />
<div id="sec-stacked-difference-in-differences" class="section level3 hasAnchor" number="30.11.1">
<h3><span class="header-section-number">30.11.1</span> Stacked Difference-in-Differences<a href="remedies-for-staggered-did-biases.html#sec-stacked-difference-in-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Stacked DiD</strong> approach addresses key limitations of standard TWFE models in <strong>staggered adoption designs</strong>, particularly <strong>treatment effect heterogeneity</strong> and <strong>timing variations</strong>. By constructing <strong>sub-experiments</strong> around each treatment event, researchers can isolate cleaner comparisons and reduce contamination from improperly specified control groups.</p>
<p>Basic TWFE Specification</p>
<p><span class="math display">\[
Y_{it} = \beta_{FE} D_{it} + A_i + B_t + \epsilon_{it}
\]</span></p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span>: Outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(D_{it}\)</span>: Treatment indicator (1 if treated, 0 otherwise).</li>
<li><span class="math inline">\(A_i\)</span>: Unit (group) fixed effects.</li>
<li><span class="math inline">\(B_t\)</span>: Time period fixed effects.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span>: Idiosyncratic error term.</li>
</ul>
<hr />
<p>Steps in the Stacked DiD Procedure</p>
<div id="choose-an-event-window" class="section level4 hasAnchor" number="30.11.1.1">
<h4><span class="header-section-number">30.11.1.1</span> Choose an Event Window<a href="remedies-for-staggered-did-biases.html#choose-an-event-window" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define:</p>
<ul>
<li><span class="math inline">\(\kappa_a\)</span>: Number of <strong>pre-treatment</strong> periods to include in the event window (lead periods).</li>
<li><span class="math inline">\(\kappa_b\)</span>: Number of <strong>post-treatment</strong> periods to include in the event window (lag periods).</li>
</ul>
<p><strong>Implication</strong>:<br />
Only events where sufficient <strong>pre- and post-treatment periods</strong> exist will be included (i.e., excluding those events that do not meet this criteria).</p>
<hr />
</div>
<div id="enumerate-sub-experiments" class="section level4 hasAnchor" number="30.11.1.2">
<h4><span class="header-section-number">30.11.1.2</span> Enumerate Sub-Experiments<a href="remedies-for-staggered-did-biases.html#enumerate-sub-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define:</p>
<ul>
<li><span class="math inline">\(T_1\)</span>: First period in the panel.</li>
<li><span class="math inline">\(T_T\)</span>: Last period in the panel.</li>
<li><span class="math inline">\(\Omega_A\)</span>: The set of <strong>treatment adoption periods</strong> that fit within the event window:</li>
</ul>
<p><span class="math display">\[
\Omega_A = \left\{ A_i \;\middle|\; T_1 + \kappa_a \le A_i \le T_T - \kappa_b \right\}
\]</span></p>
<ul>
<li>Each <span class="math inline">\(A_i\)</span> represents an <strong>adoption period</strong> for unit <span class="math inline">\(i\)</span> that has enough time on both sides of the event.</li>
</ul>
<p>Let <span class="math inline">\(d = 1, \dots, D\)</span> index the <strong>sub-experiments</strong> in <span class="math inline">\(\Omega_A\)</span>.</p>
<ul>
<li><span class="math inline">\(\omega_d\)</span>: The event (adoption) date of the <span class="math inline">\(d\)</span>-th sub-experiment.</li>
</ul>
<hr />
</div>
<div id="define-inclusion-criteria" class="section level4 hasAnchor" number="30.11.1.3">
<h4><span class="header-section-number">30.11.1.3</span> Define Inclusion Criteria<a href="remedies-for-staggered-did-biases.html#define-inclusion-criteria" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Valid Treated Units</strong></p>
<ul>
<li>In sub-experiment <span class="math inline">\(d\)</span>, treated units have adoption date exactly equal to <span class="math inline">\(\omega_d\)</span>.</li>
<li>A unit may only be treated in one sub-experiment to avoid duplication.</li>
</ul>
<p><strong>Clean Control Units</strong></p>
<ul>
<li>Controls are units where <span class="math inline">\(A_i &gt; \omega_d + \kappa_b\)</span>, i.e.,
<ul>
<li>They are <strong>never treated</strong>, or</li>
<li>They are <strong>treated in the far future</strong> (beyond the post-event window).</li>
</ul></li>
<li>A control unit can appear in multiple sub-experiments, but this requires correcting standard errors (see below).</li>
</ul>
<p><strong>Valid Time Periods</strong></p>
<ul>
<li>Only observations where<br />
<span class="math display">\[
\omega_d - \kappa_a \le t \le \omega_d + \kappa_b
\]</span><br />
are included.</li>
<li>This ensures the analysis is centered on the event window.</li>
</ul>
</div>
<div id="specify-estimating-equation" class="section level4 hasAnchor" number="30.11.1.4">
<h4><span class="header-section-number">30.11.1.4</span> Specify Estimating Equation<a href="remedies-for-staggered-did-biases.html#specify-estimating-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Basic DiD Specification in the Stacked Dataset</p>
<p><span class="math display">\[
Y_{itd} = \beta_0 + \beta_1 T_{id}  + \beta_2 P_{td} + \beta_3 (T_{id} \times P_{td}) + \epsilon_{itd}
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(i\)</span>: Unit index</p></li>
<li><p><span class="math inline">\(t\)</span>: Time index</p></li>
<li><p><span class="math inline">\(d\)</span>: Sub-experiment index</p></li>
<li><p><span class="math inline">\(T_{id}\)</span>: Indicator for <strong>treated units</strong> in sub-experiment <span class="math inline">\(d\)</span></p></li>
<li><p><span class="math inline">\(P_{td}\)</span>: Indicator for <strong>post-treatment periods</strong> in sub-experiment <span class="math inline">\(d\)</span></p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: Captures the <strong>DiD estimate</strong> of the treatment effect.</p></li>
</ul>
<p>Equivalent Form with Fixed Effects</p>
<p><span class="math display">\[
Y_{itd} = \beta_3 (T_{id} \times P_{td}) + \theta_{id} + \gamma_{td} + \epsilon_{itd}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\theta_{id}\)</span>: Unit-by-sub-experiment fixed effect.</p></li>
<li><p><span class="math inline">\(\gamma_{td}\)</span>: Time-by-sub-experiment fixed effect.</p></li>
</ul>
<p>Note:</p>
<ul>
<li><span class="math inline">\(\beta_3\)</span> summarizes the average treatment effect across all sub-experiments but does not allow for dynamic effects by time since treatment.</li>
</ul>
</div>
<div id="stacked-event-study-specification" class="section level4 hasAnchor" number="30.11.1.5">
<h4><span class="header-section-number">30.11.1.5</span> Stacked Event Study Specification<a href="remedies-for-staggered-did-biases.html#stacked-event-study-specification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define Time Since Event (<span class="math inline">\(YSE_{td}\)</span>):</p>
<p><span class="math display">\[
YSE_{td} = t- \omega_d
\]</span></p>
<p>where</p>
<ul>
<li><p>Measures time since the event (relative time) in sub-experiment <span class="math inline">\(d\)</span>.</p></li>
<li><p><span class="math inline">\(YSE_{td} \in [-\kappa_a, \dots, 0, \dots, \kappa_b]\)</span> in every sub-experiment.</p></li>
</ul>
<p><strong>Event-Study Regression (Sub-Experiment Level)</strong></p>
<p><span class="math display">\[
Y_{it}^d = \sum_{j = -\kappa_a}^{\kappa_b} \beta_j^d . 1 (YSE_{td} = j) + \sum_{j = -\kappa_a}^{\kappa_b} \delta_j^d (T_{id} . 1 (YSE_{td} = j)) + \theta_i^d + \epsilon_{it}^d
\]</span></p>
<p>where</p>
<ul>
<li><p>Separate coefficients for each sub-experiment <span class="math inline">\(d\)</span>.</p></li>
<li><p><span class="math inline">\(\delta_j^d\)</span>: Captures treatment effects at relative time <span class="math inline">\(j\)</span> within sub-experiment <span class="math inline">\(d\)</span>.</p></li>
</ul>
<p><strong>Pooled Stacked Event-Study Regression</strong></p>
<p><span class="math display">\[
Y_{itd} = \sum_{j = -\kappa_a}^{\kappa_b} \beta_j \cdot \mathbb{1}(YSE_{td} = j) + \sum_{j = -\kappa_a}^{\kappa_b} \delta_j \left( T_{id} \cdot \mathbb{1}(YSE_{td} = j) \right) + \theta_{id} + \epsilon_{itd}
\]</span></p>
<ul>
<li>Pooled coefficients <span class="math inline">\(\delta_j\)</span> reflect average treatment effects by event time <span class="math inline">\(j\)</span> across sub-experiments.</li>
</ul>
</div>
<div id="clustering-in-stacked-did" class="section level4 hasAnchor" number="30.11.1.6">
<h4><span class="header-section-number">30.11.1.6</span> Clustering in Stacked DID<a href="remedies-for-staggered-did-biases.html#clustering-in-stacked-did" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><strong>Cluster at Unit × Sub-Experiment Level</strong> <span class="citation">(<a href="#ref-cengiz2019effect">Cengiz et al. 2019</a>)</span>: Accounts for units appearing multiple times across sub-experiments.</p></li>
<li><p><strong>Cluster at Unit Level</strong> <span class="citation">(<a href="#ref-deshpande2019screened">Deshpande and Li 2019</a>)</span>: Appropriate when units are uniquely identified and do not appear in multiple sub-experiments.</p></li>
</ul>
<hr />
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="remedies-for-staggered-did-biases.html#cb760-1" tabindex="-1"></a><span class="fu">library</span>(did)</span>
<span id="cb760-2"><a href="remedies-for-staggered-did-biases.html#cb760-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb760-3"><a href="remedies-for-staggered-did-biases.html#cb760-3" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb760-4"><a href="remedies-for-staggered-did-biases.html#cb760-4" tabindex="-1"></a></span>
<span id="cb760-5"><a href="remedies-for-staggered-did-biases.html#cb760-5" tabindex="-1"></a><span class="co"># Load example data</span></span>
<span id="cb760-6"><a href="remedies-for-staggered-did-biases.html#cb760-6" tabindex="-1"></a><span class="fu">data</span>(base_stagg)</span>
<span id="cb760-7"><a href="remedies-for-staggered-did-biases.html#cb760-7" tabindex="-1"></a></span>
<span id="cb760-8"><a href="remedies-for-staggered-did-biases.html#cb760-8" tabindex="-1"></a><span class="co"># Get treated cohorts (exclude never-treated units coded as 10000)</span></span>
<span id="cb760-9"><a href="remedies-for-staggered-did-biases.html#cb760-9" tabindex="-1"></a>cohorts <span class="ot">&lt;-</span> base_stagg <span class="sc">%&gt;%</span></span>
<span id="cb760-10"><a href="remedies-for-staggered-did-biases.html#cb760-10" tabindex="-1"></a>    <span class="fu">filter</span>(year_treated <span class="sc">!=</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb760-11"><a href="remedies-for-staggered-did-biases.html#cb760-11" tabindex="-1"></a>    <span class="fu">distinct</span>(year_treated) <span class="sc">%&gt;%</span></span>
<span id="cb760-12"><a href="remedies-for-staggered-did-biases.html#cb760-12" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb760-13"><a href="remedies-for-staggered-did-biases.html#cb760-13" tabindex="-1"></a></span>
<span id="cb760-14"><a href="remedies-for-staggered-did-biases.html#cb760-14" tabindex="-1"></a><span class="co"># Function to generate data for each sub-experiment</span></span>
<span id="cb760-15"><a href="remedies-for-staggered-did-biases.html#cb760-15" tabindex="-1"></a>getdata <span class="ot">&lt;-</span> <span class="cf">function</span>(j, window) {</span>
<span id="cb760-16"><a href="remedies-for-staggered-did-biases.html#cb760-16" tabindex="-1"></a>    base_stagg <span class="sc">%&gt;%</span></span>
<span id="cb760-17"><a href="remedies-for-staggered-did-biases.html#cb760-17" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb760-18"><a href="remedies-for-staggered-did-biases.html#cb760-18" tabindex="-1"></a>            year_treated <span class="sc">==</span> j <span class="sc">|</span>               <span class="co"># treated units in cohort j</span></span>
<span id="cb760-19"><a href="remedies-for-staggered-did-biases.html#cb760-19" tabindex="-1"></a>            year_treated <span class="sc">&gt;</span> j <span class="sc">+</span> window         <span class="co"># controls not treated soon after</span></span>
<span id="cb760-20"><a href="remedies-for-staggered-did-biases.html#cb760-20" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb760-21"><a href="remedies-for-staggered-did-biases.html#cb760-21" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb760-22"><a href="remedies-for-staggered-did-biases.html#cb760-22" tabindex="-1"></a>            year <span class="sc">&gt;=</span> j <span class="sc">-</span> window <span class="sc">&amp;</span></span>
<span id="cb760-23"><a href="remedies-for-staggered-did-biases.html#cb760-23" tabindex="-1"></a>            year <span class="sc">&lt;=</span> j <span class="sc">+</span> window                <span class="co"># event window bounds</span></span>
<span id="cb760-24"><a href="remedies-for-staggered-did-biases.html#cb760-24" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb760-25"><a href="remedies-for-staggered-did-biases.html#cb760-25" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">df =</span> j)                        <span class="co"># sub-experiment indicator</span></span>
<span id="cb760-26"><a href="remedies-for-staggered-did-biases.html#cb760-26" tabindex="-1"></a>}</span>
<span id="cb760-27"><a href="remedies-for-staggered-did-biases.html#cb760-27" tabindex="-1"></a></span>
<span id="cb760-28"><a href="remedies-for-staggered-did-biases.html#cb760-28" tabindex="-1"></a><span class="co"># Generate the stacked dataset</span></span>
<span id="cb760-29"><a href="remedies-for-staggered-did-biases.html#cb760-29" tabindex="-1"></a>stacked_data <span class="ot">&lt;-</span> <span class="fu">map_df</span>(cohorts, <span class="sc">~</span> <span class="fu">getdata</span>(., <span class="at">window =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb760-30"><a href="remedies-for-staggered-did-biases.html#cb760-30" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb760-31"><a href="remedies-for-staggered-did-biases.html#cb760-31" tabindex="-1"></a>        <span class="at">rel_year =</span> <span class="fu">if_else</span>(df <span class="sc">==</span> year_treated, time_to_treatment, <span class="cn">NA_real_</span>)</span>
<span id="cb760-32"><a href="remedies-for-staggered-did-biases.html#cb760-32" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb760-33"><a href="remedies-for-staggered-did-biases.html#cb760-33" tabindex="-1"></a>    fastDummies<span class="sc">::</span><span class="fu">dummy_cols</span>(<span class="st">&quot;rel_year&quot;</span>, <span class="at">ignore_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb760-34"><a href="remedies-for-staggered-did-biases.html#cb760-34" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;rel_year_&quot;</span>), <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)))</span>
<span id="cb760-35"><a href="remedies-for-staggered-did-biases.html#cb760-35" tabindex="-1"></a></span>
<span id="cb760-36"><a href="remedies-for-staggered-did-biases.html#cb760-36" tabindex="-1"></a><span class="co"># Estimate fixed effects regression on the stacked data</span></span>
<span id="cb760-37"><a href="remedies-for-staggered-did-biases.html#cb760-37" tabindex="-1"></a>stacked_result <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb760-38"><a href="remedies-for-staggered-did-biases.html#cb760-38" tabindex="-1"></a>    y <span class="sc">~</span> <span class="st">`</span><span class="at">rel_year_-5</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-4</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-3</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-2</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb760-39"><a href="remedies-for-staggered-did-biases.html#cb760-39" tabindex="-1"></a>        rel_year_0 <span class="sc">+</span> rel_year_1 <span class="sc">+</span> rel_year_2 <span class="sc">+</span> rel_year_3 <span class="sc">+</span></span>
<span id="cb760-40"><a href="remedies-for-staggered-did-biases.html#cb760-40" tabindex="-1"></a>        rel_year_4 <span class="sc">+</span> rel_year_5 <span class="sc">|</span></span>
<span id="cb760-41"><a href="remedies-for-staggered-did-biases.html#cb760-41" tabindex="-1"></a>        id <span class="sc">^</span> df <span class="sc">+</span> year <span class="sc">^</span> df,</span>
<span id="cb760-42"><a href="remedies-for-staggered-did-biases.html#cb760-42" tabindex="-1"></a>    <span class="at">data =</span> stacked_data</span>
<span id="cb760-43"><a href="remedies-for-staggered-did-biases.html#cb760-43" tabindex="-1"></a>)</span>
<span id="cb760-44"><a href="remedies-for-staggered-did-biases.html#cb760-44" tabindex="-1"></a></span>
<span id="cb760-45"><a href="remedies-for-staggered-did-biases.html#cb760-45" tabindex="-1"></a><span class="co"># Extract coefficients and standard errors</span></span>
<span id="cb760-46"><a href="remedies-for-staggered-did-biases.html#cb760-46" tabindex="-1"></a>stacked_coeffs <span class="ot">&lt;-</span> stacked_result<span class="sc">$</span>coefficients</span>
<span id="cb760-47"><a href="remedies-for-staggered-did-biases.html#cb760-47" tabindex="-1"></a>stacked_se <span class="ot">&lt;-</span> stacked_result<span class="sc">$</span>se</span>
<span id="cb760-48"><a href="remedies-for-staggered-did-biases.html#cb760-48" tabindex="-1"></a></span>
<span id="cb760-49"><a href="remedies-for-staggered-did-biases.html#cb760-49" tabindex="-1"></a><span class="co"># Insert zero for the omitted period (usually -1)</span></span>
<span id="cb760-50"><a href="remedies-for-staggered-did-biases.html#cb760-50" tabindex="-1"></a>stacked_coeffs <span class="ot">&lt;-</span> <span class="fu">c</span>(stacked_coeffs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, stacked_coeffs[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb760-51"><a href="remedies-for-staggered-did-biases.html#cb760-51" tabindex="-1"></a>stacked_se <span class="ot">&lt;-</span> <span class="fu">c</span>(stacked_se[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, stacked_se[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span></code></pre></div>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="remedies-for-staggered-did-biases.html#cb761-1" tabindex="-1"></a><span class="co"># Plotting estimates from three methods: Callaway &amp; Sant&#39;Anna, Sun &amp; Abraham, and Stacked DiD</span></span>
<span id="cb761-2"><a href="remedies-for-staggered-did-biases.html#cb761-2" tabindex="-1"></a></span>
<span id="cb761-3"><a href="remedies-for-staggered-did-biases.html#cb761-3" tabindex="-1"></a>cs_out <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(</span>
<span id="cb761-4"><a href="remedies-for-staggered-did-biases.html#cb761-4" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb761-5"><a href="remedies-for-staggered-did-biases.html#cb761-5" tabindex="-1"></a>    <span class="at">data =</span> base_stagg,</span>
<span id="cb761-6"><a href="remedies-for-staggered-did-biases.html#cb761-6" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb761-7"><a href="remedies-for-staggered-did-biases.html#cb761-7" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb761-8"><a href="remedies-for-staggered-did-biases.html#cb761-8" tabindex="-1"></a>    <span class="co"># xformla = &quot;~x1&quot;,</span></span>
<span id="cb761-9"><a href="remedies-for-staggered-did-biases.html#cb761-9" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span></span>
<span id="cb761-10"><a href="remedies-for-staggered-did-biases.html#cb761-10" tabindex="-1"></a>)</span>
<span id="cb761-11"><a href="remedies-for-staggered-did-biases.html#cb761-11" tabindex="-1"></a>cs <span class="ot">&lt;-</span></span>
<span id="cb761-12"><a href="remedies-for-staggered-did-biases.html#cb761-12" tabindex="-1"></a>    <span class="fu">aggte</span>(</span>
<span id="cb761-13"><a href="remedies-for-staggered-did-biases.html#cb761-13" tabindex="-1"></a>        cs_out,</span>
<span id="cb761-14"><a href="remedies-for-staggered-did-biases.html#cb761-14" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;dynamic&quot;</span>,</span>
<span id="cb761-15"><a href="remedies-for-staggered-did-biases.html#cb761-15" tabindex="-1"></a>        <span class="at">min_e =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb761-16"><a href="remedies-for-staggered-did-biases.html#cb761-16" tabindex="-1"></a>        <span class="at">max_e =</span> <span class="dv">5</span>,</span>
<span id="cb761-17"><a href="remedies-for-staggered-did-biases.html#cb761-17" tabindex="-1"></a>        <span class="at">bstrap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb761-18"><a href="remedies-for-staggered-did-biases.html#cb761-18" tabindex="-1"></a>        <span class="at">cband =</span> <span class="cn">FALSE</span></span>
<span id="cb761-19"><a href="remedies-for-staggered-did-biases.html#cb761-19" tabindex="-1"></a>    )</span>
<span id="cb761-20"><a href="remedies-for-staggered-did-biases.html#cb761-20" tabindex="-1"></a></span>
<span id="cb761-21"><a href="remedies-for-staggered-did-biases.html#cb761-21" tabindex="-1"></a></span>
<span id="cb761-22"><a href="remedies-for-staggered-did-biases.html#cb761-22" tabindex="-1"></a></span>
<span id="cb761-23"><a href="remedies-for-staggered-did-biases.html#cb761-23" tabindex="-1"></a>res_sa20 <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">sunab</span>(year_treated, year) <span class="sc">|</span></span>
<span id="cb761-24"><a href="remedies-for-staggered-did-biases.html#cb761-24" tabindex="-1"></a>                     id <span class="sc">+</span> year, base_stagg)</span>
<span id="cb761-25"><a href="remedies-for-staggered-did-biases.html#cb761-25" tabindex="-1"></a>sa <span class="ot">=</span> <span class="fu">tidy</span>(res_sa20)[<span class="dv">5</span><span class="sc">:</span><span class="dv">14</span>, ] <span class="sc">%&gt;%</span> <span class="fu">pull</span>(estimate)</span>
<span id="cb761-26"><a href="remedies-for-staggered-did-biases.html#cb761-26" tabindex="-1"></a>sa <span class="ot">=</span> <span class="fu">c</span>(sa[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, sa[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb761-27"><a href="remedies-for-staggered-did-biases.html#cb761-27" tabindex="-1"></a></span>
<span id="cb761-28"><a href="remedies-for-staggered-did-biases.html#cb761-28" tabindex="-1"></a>sa_se <span class="ot">=</span> <span class="fu">tidy</span>(res_sa20)[<span class="dv">6</span><span class="sc">:</span><span class="dv">15</span>, ] <span class="sc">%&gt;%</span> <span class="fu">pull</span>(std.error)</span>
<span id="cb761-29"><a href="remedies-for-staggered-did-biases.html#cb761-29" tabindex="-1"></a>sa_se <span class="ot">=</span> <span class="fu">c</span>(sa_se[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, sa_se[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb761-30"><a href="remedies-for-staggered-did-biases.html#cb761-30" tabindex="-1"></a></span>
<span id="cb761-31"><a href="remedies-for-staggered-did-biases.html#cb761-31" tabindex="-1"></a>compare_df_est <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb761-32"><a href="remedies-for-staggered-did-biases.html#cb761-32" tabindex="-1"></a>    <span class="at">period =</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb761-33"><a href="remedies-for-staggered-did-biases.html#cb761-33" tabindex="-1"></a>    <span class="at">cs =</span> cs<span class="sc">$</span>att.egt,</span>
<span id="cb761-34"><a href="remedies-for-staggered-did-biases.html#cb761-34" tabindex="-1"></a>    <span class="at">sa =</span> sa,</span>
<span id="cb761-35"><a href="remedies-for-staggered-did-biases.html#cb761-35" tabindex="-1"></a>    <span class="at">stacked =</span> stacked_coeffs</span>
<span id="cb761-36"><a href="remedies-for-staggered-did-biases.html#cb761-36" tabindex="-1"></a>)</span>
<span id="cb761-37"><a href="remedies-for-staggered-did-biases.html#cb761-37" tabindex="-1"></a></span>
<span id="cb761-38"><a href="remedies-for-staggered-did-biases.html#cb761-38" tabindex="-1"></a>compare_df_se <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb761-39"><a href="remedies-for-staggered-did-biases.html#cb761-39" tabindex="-1"></a>    <span class="at">period =</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb761-40"><a href="remedies-for-staggered-did-biases.html#cb761-40" tabindex="-1"></a>    <span class="at">cs =</span> cs<span class="sc">$</span>se.egt,</span>
<span id="cb761-41"><a href="remedies-for-staggered-did-biases.html#cb761-41" tabindex="-1"></a>    <span class="at">sa =</span> sa_se,</span>
<span id="cb761-42"><a href="remedies-for-staggered-did-biases.html#cb761-42" tabindex="-1"></a>    <span class="at">stacked =</span> stacked_se</span>
<span id="cb761-43"><a href="remedies-for-staggered-did-biases.html#cb761-43" tabindex="-1"></a>)</span>
<span id="cb761-44"><a href="remedies-for-staggered-did-biases.html#cb761-44" tabindex="-1"></a></span>
<span id="cb761-45"><a href="remedies-for-staggered-did-biases.html#cb761-45" tabindex="-1"></a>compare_df_longer <span class="ot">&lt;-</span> compare_df_est <span class="sc">%&gt;%</span></span>
<span id="cb761-46"><a href="remedies-for-staggered-did-biases.html#cb761-46" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span>period, <span class="at">names_to =</span> <span class="st">&quot;estimator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;est&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb761-47"><a href="remedies-for-staggered-did-biases.html#cb761-47" tabindex="-1"></a>    <span class="fu">full_join</span>(compare_df_se <span class="sc">%&gt;%</span></span>
<span id="cb761-48"><a href="remedies-for-staggered-did-biases.html#cb761-48" tabindex="-1"></a>                  <span class="fu">pivot_longer</span>(<span class="sc">!</span>period, <span class="at">names_to =</span> <span class="st">&quot;estimator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;se&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb761-49"><a href="remedies-for-staggered-did-biases.html#cb761-49" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">upper =</span> est <span class="sc">+</span>  <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb761-50"><a href="remedies-for-staggered-did-biases.html#cb761-50" tabindex="-1"></a>           <span class="at">lower =</span> est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb761-51"><a href="remedies-for-staggered-did-biases.html#cb761-51" tabindex="-1"></a></span>
<span id="cb761-52"><a href="remedies-for-staggered-did-biases.html#cb761-52" tabindex="-1"></a><span class="fu">ggplot</span>(compare_df_longer) <span class="sc">+</span></span>
<span id="cb761-53"><a href="remedies-for-staggered-did-biases.html#cb761-53" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(</span>
<span id="cb761-54"><a href="remedies-for-staggered-did-biases.html#cb761-54" tabindex="-1"></a>        <span class="at">x =</span> period,</span>
<span id="cb761-55"><a href="remedies-for-staggered-did-biases.html#cb761-55" tabindex="-1"></a>        <span class="at">ymin =</span> lower,</span>
<span id="cb761-56"><a href="remedies-for-staggered-did-biases.html#cb761-56" tabindex="-1"></a>        <span class="at">ymax =</span> upper,</span>
<span id="cb761-57"><a href="remedies-for-staggered-did-biases.html#cb761-57" tabindex="-1"></a>        <span class="at">group =</span> estimator</span>
<span id="cb761-58"><a href="remedies-for-staggered-did-biases.html#cb761-58" tabindex="-1"></a>    ), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb761-59"><a href="remedies-for-staggered-did-biases.html#cb761-59" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(</span>
<span id="cb761-60"><a href="remedies-for-staggered-did-biases.html#cb761-60" tabindex="-1"></a>        <span class="at">x =</span> period,</span>
<span id="cb761-61"><a href="remedies-for-staggered-did-biases.html#cb761-61" tabindex="-1"></a>        <span class="at">y =</span> est,</span>
<span id="cb761-62"><a href="remedies-for-staggered-did-biases.html#cb761-62" tabindex="-1"></a>        <span class="at">group =</span> estimator,</span>
<span id="cb761-63"><a href="remedies-for-staggered-did-biases.html#cb761-63" tabindex="-1"></a>        <span class="at">color =</span> estimator</span>
<span id="cb761-64"><a href="remedies-for-staggered-did-biases.html#cb761-64" tabindex="-1"></a>    ),</span>
<span id="cb761-65"><a href="remedies-for-staggered-did-biases.html#cb761-65" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb761-66"><a href="remedies-for-staggered-did-biases.html#cb761-66" tabindex="-1"></a>    </span>
<span id="cb761-67"><a href="remedies-for-staggered-did-biases.html#cb761-67" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb761-68"><a href="remedies-for-staggered-did-biases.html#cb761-68" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Comparison of Dynamic Treatment Effects&quot;</span>,</span>
<span id="cb761-69"><a href="remedies-for-staggered-did-biases.html#cb761-69" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Event Time (Periods since Treatment)&quot;</span>,</span>
<span id="cb761-70"><a href="remedies-for-staggered-did-biases.html#cb761-70" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Estimated ATT&quot;</span>,</span>
<span id="cb761-71"><a href="remedies-for-staggered-did-biases.html#cb761-71" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;Estimator&quot;</span></span>
<span id="cb761-72"><a href="remedies-for-staggered-did-biases.html#cb761-72" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb761-73"><a href="remedies-for-staggered-did-biases.html#cb761-73" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="sec-goodman-bacon-decomposition" class="section level3 hasAnchor" number="30.11.2">
<h3><span class="header-section-number">30.11.2</span> Goodman-Bacon Decomposition<a href="remedies-for-staggered-did-biases.html#sec-goodman-bacon-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Paper: <span class="citation">(<a href="#ref-goodman2021difference">Goodman-Bacon 2021</a>)</span></p>
<p>For an excellent explanation slides by the author, <a href="https://www.stata.com/meeting/chicago19/slides/chicago19_Goodman-Bacon.pdf">see</a></p>
<p>Takeaways:</p>
<ul>
<li><p>A pairwise DID (<span class="math inline">\(\tau\)</span>) gets more weight if the change is close to the middle of the study window</p></li>
<li><p>A pairwise DID (<span class="math inline">\(\tau\)</span>) gets more weight if it includes more observations.</p></li>
</ul>
<p>Code from <code>bacondecomp</code> vignette</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="remedies-for-staggered-did-biases.html#cb762-1" tabindex="-1"></a><span class="fu">library</span>(bacondecomp)</span>
<span id="cb762-2"><a href="remedies-for-staggered-did-biases.html#cb762-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb762-3"><a href="remedies-for-staggered-did-biases.html#cb762-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;castle&quot;</span>)</span>
<span id="cb762-4"><a href="remedies-for-staggered-did-biases.html#cb762-4" tabindex="-1"></a>castle <span class="ot">&lt;-</span> bacondecomp<span class="sc">::</span>castle <span class="sc">%&gt;%</span> </span>
<span id="cb762-5"><a href="remedies-for-staggered-did-biases.html#cb762-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;l_homicide&quot;</span>, <span class="st">&quot;post&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;year&quot;</span>)</span>
<span id="cb762-6"><a href="remedies-for-staggered-did-biases.html#cb762-6" tabindex="-1"></a><span class="fu">head</span>(castle)</span>
<span id="cb762-7"><a href="remedies-for-staggered-did-biases.html#cb762-7" tabindex="-1"></a><span class="co">#&gt;   l_homicide post   state year</span></span>
<span id="cb762-8"><a href="remedies-for-staggered-did-biases.html#cb762-8" tabindex="-1"></a><span class="co">#&gt; 1   2.027356    0 Alabama 2000</span></span>
<span id="cb762-9"><a href="remedies-for-staggered-did-biases.html#cb762-9" tabindex="-1"></a><span class="co">#&gt; 2   2.164867    0 Alabama 2001</span></span>
<span id="cb762-10"><a href="remedies-for-staggered-did-biases.html#cb762-10" tabindex="-1"></a><span class="co">#&gt; 3   1.936334    0 Alabama 2002</span></span>
<span id="cb762-11"><a href="remedies-for-staggered-did-biases.html#cb762-11" tabindex="-1"></a><span class="co">#&gt; 4   1.919567    0 Alabama 2003</span></span>
<span id="cb762-12"><a href="remedies-for-staggered-did-biases.html#cb762-12" tabindex="-1"></a><span class="co">#&gt; 5   1.749841    0 Alabama 2004</span></span>
<span id="cb762-13"><a href="remedies-for-staggered-did-biases.html#cb762-13" tabindex="-1"></a><span class="co">#&gt; 6   2.130440    0 Alabama 2005</span></span>
<span id="cb762-14"><a href="remedies-for-staggered-did-biases.html#cb762-14" tabindex="-1"></a></span>
<span id="cb762-15"><a href="remedies-for-staggered-did-biases.html#cb762-15" tabindex="-1"></a></span>
<span id="cb762-16"><a href="remedies-for-staggered-did-biases.html#cb762-16" tabindex="-1"></a>df_bacon <span class="ot">&lt;-</span> <span class="fu">bacon</span>(</span>
<span id="cb762-17"><a href="remedies-for-staggered-did-biases.html#cb762-17" tabindex="-1"></a>    l_homicide <span class="sc">~</span> post,</span>
<span id="cb762-18"><a href="remedies-for-staggered-did-biases.html#cb762-18" tabindex="-1"></a>    <span class="at">data =</span> castle,</span>
<span id="cb762-19"><a href="remedies-for-staggered-did-biases.html#cb762-19" tabindex="-1"></a>    <span class="at">id_var =</span> <span class="st">&quot;state&quot;</span>,</span>
<span id="cb762-20"><a href="remedies-for-staggered-did-biases.html#cb762-20" tabindex="-1"></a>    <span class="at">time_var =</span> <span class="st">&quot;year&quot;</span></span>
<span id="cb762-21"><a href="remedies-for-staggered-did-biases.html#cb762-21" tabindex="-1"></a>)</span>
<span id="cb762-22"><a href="remedies-for-staggered-did-biases.html#cb762-22" tabindex="-1"></a><span class="co">#&gt;                       type  weight  avg_est</span></span>
<span id="cb762-23"><a href="remedies-for-staggered-did-biases.html#cb762-23" tabindex="-1"></a><span class="co">#&gt; 1 Earlier vs Later Treated 0.05976 -0.00554</span></span>
<span id="cb762-24"><a href="remedies-for-staggered-did-biases.html#cb762-24" tabindex="-1"></a><span class="co">#&gt; 2 Later vs Earlier Treated 0.03190  0.07032</span></span>
<span id="cb762-25"><a href="remedies-for-staggered-did-biases.html#cb762-25" tabindex="-1"></a><span class="co">#&gt; 3     Treated vs Untreated 0.90834  0.08796</span></span>
<span id="cb762-26"><a href="remedies-for-staggered-did-biases.html#cb762-26" tabindex="-1"></a></span>
<span id="cb762-27"><a href="remedies-for-staggered-did-biases.html#cb762-27" tabindex="-1"></a><span class="co"># weighted average of the decomposition</span></span>
<span id="cb762-28"><a href="remedies-for-staggered-did-biases.html#cb762-28" tabindex="-1"></a><span class="fu">sum</span>(df_bacon<span class="sc">$</span>estimate <span class="sc">*</span> df_bacon<span class="sc">$</span>weight)</span>
<span id="cb762-29"><a href="remedies-for-staggered-did-biases.html#cb762-29" tabindex="-1"></a><span class="co">#&gt; [1] 0.08181162</span></span></code></pre></div>
<p>Two-way Fixed effect estimate</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="remedies-for-staggered-did-biases.html#cb763-1" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb763-2"><a href="remedies-for-staggered-did-biases.html#cb763-2" tabindex="-1"></a>fit_tw <span class="ot">&lt;-</span> <span class="fu">lm</span>(l_homicide <span class="sc">~</span> post <span class="sc">+</span> <span class="fu">factor</span>(state) <span class="sc">+</span> <span class="fu">factor</span>(year),</span>
<span id="cb763-3"><a href="remedies-for-staggered-did-biases.html#cb763-3" tabindex="-1"></a>             <span class="at">data =</span> bacondecomp<span class="sc">::</span>castle)</span>
<span id="cb763-4"><a href="remedies-for-staggered-did-biases.html#cb763-4" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">tidy</span>(fit_tw))</span>
<span id="cb763-5"><a href="remedies-for-staggered-did-biases.html#cb763-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span id="cb763-6"><a href="remedies-for-staggered-did-biases.html#cb763-6" tabindex="-1"></a><span class="co">#&gt;   term                    estimate std.error statistic   p.value</span></span>
<span id="cb763-7"><a href="remedies-for-staggered-did-biases.html#cb763-7" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;                      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb763-8"><a href="remedies-for-staggered-did-biases.html#cb763-8" tabindex="-1"></a><span class="co">#&gt; 1 (Intercept)               1.95      0.0624    31.2   2.84e-118</span></span>
<span id="cb763-9"><a href="remedies-for-staggered-did-biases.html#cb763-9" tabindex="-1"></a><span class="co">#&gt; 2 post                      0.0818    0.0317     2.58  1.02e-  2</span></span>
<span id="cb763-10"><a href="remedies-for-staggered-did-biases.html#cb763-10" tabindex="-1"></a><span class="co">#&gt; 3 factor(state)Alaska      -0.373     0.0797    -4.68  3.77e-  6</span></span>
<span id="cb763-11"><a href="remedies-for-staggered-did-biases.html#cb763-11" tabindex="-1"></a><span class="co">#&gt; 4 factor(state)Arizona      0.0158    0.0797     0.198 8.43e-  1</span></span>
<span id="cb763-12"><a href="remedies-for-staggered-did-biases.html#cb763-12" tabindex="-1"></a><span class="co">#&gt; 5 factor(state)Arkansas    -0.118     0.0810    -1.46  1.44e-  1</span></span>
<span id="cb763-13"><a href="remedies-for-staggered-did-biases.html#cb763-13" tabindex="-1"></a><span class="co">#&gt; 6 factor(state)California  -0.108     0.0810    -1.34  1.82e-  1</span></span></code></pre></div>
<p>Hence, naive TWFE fixed effect equals the weighted average of the Bacon decomposition (= 0.08).</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="remedies-for-staggered-did-biases.html#cb764-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb764-2"><a href="remedies-for-staggered-did-biases.html#cb764-2" tabindex="-1"></a></span>
<span id="cb764-3"><a href="remedies-for-staggered-did-biases.html#cb764-3" tabindex="-1"></a><span class="fu">ggplot</span>(df_bacon) <span class="sc">+</span></span>
<span id="cb764-4"><a href="remedies-for-staggered-did-biases.html#cb764-4" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb764-5"><a href="remedies-for-staggered-did-biases.html#cb764-5" tabindex="-1"></a>        <span class="at">x =</span> weight,</span>
<span id="cb764-6"><a href="remedies-for-staggered-did-biases.html#cb764-6" tabindex="-1"></a>        <span class="at">y =</span> estimate,</span>
<span id="cb764-7"><a href="remedies-for-staggered-did-biases.html#cb764-7" tabindex="-1"></a>        <span class="co"># shape = factor(type),</span></span>
<span id="cb764-8"><a href="remedies-for-staggered-did-biases.html#cb764-8" tabindex="-1"></a>        <span class="at">color =</span> type</span>
<span id="cb764-9"><a href="remedies-for-staggered-did-biases.html#cb764-9" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb764-10"><a href="remedies-for-staggered-did-biases.html#cb764-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Weight&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Estimate&quot;</span>, <span class="at">shape =</span> <span class="st">&quot;Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb764-11"><a href="remedies-for-staggered-did-biases.html#cb764-11" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb764-12"><a href="remedies-for-staggered-did-biases.html#cb764-12" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>With time-varying controls that can identify variation within-treatment timing group, the”early vs. late” and “late vs. early” estimates collapse to just one estimate (i.e., both treated).</p>
</div>
<div id="did-with-in-and-out-treatment-condition" class="section level3 hasAnchor" number="30.11.3">
<h3><span class="header-section-number">30.11.3</span> DID with in and out treatment condition<a href="remedies-for-staggered-did-biases.html#did-with-in-and-out-treatment-condition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="panel-match" class="section level4 hasAnchor" number="30.11.3.1">
<h4><span class="header-section-number">30.11.3.1</span> Panel Match<a href="remedies-for-staggered-did-biases.html#panel-match" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As noted in <span class="citation">(<a href="#ref-imai2021use">Imai and Kim 2021</a>)</span>, the TWFE estimator is not a fully nonparametric approach and is sensitive to incorrect model specifications (i.e., model dependence).</p>
<ul>
<li>To mitigate model dependence, they propose matching methods for panel data.</li>
<li>Implementations are available via the <code>wfe</code> (Weighted Fixed Effects) and <code>PanelMatch</code> R packages.</li>
</ul>
<p><span class="citation">Imai and Kim (<a href="#ref-imai2021use">2021</a>)</span></p>
<p>This case generalizes the staggered adoption setting, allowing units to vary in treatment over time. For <span class="math inline">\(N\)</span> units across <span class="math inline">\(T\)</span> time periods (with potentially unbalanced panels), let <span class="math inline">\(X_{it}\)</span> represent treatment and <span class="math inline">\(Y_{it}\)</span> the outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>. We use the two-way linear fixed effects model:</p>
<p><span class="math display">\[
Y_{it} = \alpha_i + \gamma_t + \beta X_{it} + \epsilon_{it}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, N\)</span> and <span class="math inline">\(t = 1, \dots, T\)</span>. Here, <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\gamma_t\)</span> are unit and time fixed effects. They capture time-invariant unit-specific and unit-invariant time-specific unobserved confounders, respectively. We can express these as <span class="math inline">\(\alpha_i = h(\mathbf{U}_i)\)</span> and <span class="math inline">\(\gamma_t = f(\mathbf{V}_t)\)</span>, with <span class="math inline">\(\mathbf{U}_i\)</span> and <span class="math inline">\(\mathbf{V}_t\)</span> being the confounders. The model doesn’t assume a specific form for <span class="math inline">\(h(.)\)</span> and <span class="math inline">\(f(.)\)</span>, but that they’re additive and separable given binary treatment.</p>
<p>The least squares estimate of <span class="math inline">\(\beta\)</span> leverages the covariance in outcome and treatment <span class="citation">(<a href="#ref-imai2021use">Imai and Kim 2021, 406</a>)</span>. Specifically, it uses the within-unit and within-time variations. Many researchers prefer the two fixed effects (2FE) estimator because it adjusts for both types of unobserved confounders without specific functional-form assumptions, but this is wrong <span class="citation">(<a href="#ref-imai2019should">Imai and Kim 2019</a>)</span>. We do need functional-form assumption (i.e., linearity assumption) for the 2FE to work <span class="citation">(<a href="#ref-imai2021use">Imai and Kim 2021, 406</a>)</span></p>
<ul>
<li><p><strong>Two-Way Matching Estimator</strong>:</p>
<ul>
<li><p>It can lead to mismatches; units with the same treatment status get matched when estimating counterfactual outcomes.</p></li>
<li><p>Observations need to be matched with opposite treatment status for correct causal effects estimation.</p></li>
<li><p>Mismatches can cause attenuation bias.</p></li>
<li><p>The 2FE estimator adjusts for this bias using the factor <span class="math inline">\(K\)</span>, which represents the net proportion of proper matches between observations with opposite treatment status.</p></li>
</ul></li>
<li><p><strong>Weighting in 2FE</strong>:</p>
<ul>
<li><p>Observation <span class="math inline">\((i,t)\)</span> is weighted based on how often it acts as a control unit.</p></li>
<li><p>The weighted 2FE estimator still has mismatches, but fewer than the standard 2FE estimator.</p></li>
<li><p>Adjustments are made based on observations that neither belong to the same unit nor the same time period as the matched observation.</p></li>
<li><p>This means there are challenges in adjusting for unit-specific and time-specific unobserved confounders under the two-way fixed effect framework.</p></li>
</ul></li>
<li><p><strong>Equivalence &amp; Assumptions</strong>:</p>
<ul>
<li><p>Equivalence between the 2FE estimator and the DID estimator is dependent on the linearity assumption.</p></li>
<li><p>The multi-period DiD estimator is described as an average of two-time-period, two-group DiD estimators applied during changes from control to treatment.</p></li>
</ul></li>
<li><p><strong>Comparison with DiD</strong>:</p>
<ul>
<li><p>In simple settings (two time periods, treatment given to one group in the second period), the standard nonparametric DiD estimator equals the 2FE estimator.</p></li>
<li><p>This doesn’t hold in multi-period DiD designs where units change treatment status multiple times at different intervals.</p></li>
<li><p>Contrary to popular belief, the unweighted 2FE estimator isn’t generally equivalent to the multi-period DiD estimator.</p></li>
<li><p>While the multi-period DiD can be equivalent to the weighted 2FE, some control observations may have negative regression weights.</p></li>
</ul></li>
<li><p><strong>Conclusion</strong>:</p>
<ul>
<li>Justifying the 2FE estimator as the DID estimator isn’t warranted without imposing the linearity assumption.</li>
</ul></li>
</ul>
<p><strong>Application <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span></strong></p>
<ul>
<li><p><strong>Matching Methods</strong>:</p>
<ul>
<li><p>Enhance the validity of causal inference.</p></li>
<li><p>Reduce model dependence and provide intuitive diagnostics <span class="citation">(<a href="#ref-ho2007matching">Ho et al. 2007</a>)</span></p></li>
<li><p>Rarely utilized in analyzing time series cross-sectional data.</p></li>
<li><p>The proposed matching estimators are more robust than the standard two-way fixed effects estimator, which can be biased if mis-specified</p></li>
<li><p>Better than synthetic controls (e.g., <span class="citation">(<a href="#ref-xu2017generalized">Xu 2017</a>)</span>) because it needs less data to achieve good performance and and adapt the the context of unit switching treatment status multiple times.</p></li>
</ul></li>
<li><p>Notes:</p>
<ul>
<li>Potential carryover effects (treatment may have a long-term effect), leading to post-treatment bias.</li>
</ul></li>
<li><p><strong>Proposed Approach</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Treated observations are matched with control observations from other units in the same time period with the same treatment history up to a specified number of lags.</p></li>
<li><p>Standard matching and weighting techniques are employed to further refine the matched set.</p></li>
<li><p>Apply a DiD estimator to adjust for time trend.</p></li>
<li><p>The goal is to have treated and matched control observations with similar covariate values.</p></li>
</ol></li>
<li><p><strong>Assessment</strong>:</p>
<ul>
<li>The quality of matches is evaluated through covariate balancing.</li>
</ul></li>
<li><p><strong>Estimation</strong>:</p>
<ul>
<li>Both short-term and long-term average treatment effects on the treated (ATT) are estimated.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="remedies-for-staggered-did-biases.html#cb765-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span></code></pre></div>
<p><strong>Treatment Variation plot</strong></p>
<ul>
<li><p>Visualize the variation of the treatment across space and time</p></li>
<li><p>Aids in discerning whether the treatment fluctuates adequately over time and units or if the variation is primarily clustered in a subset of data.</p></li>
</ul>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="remedies-for-staggered-did-biases.html#cb766-1" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb766-2"><a href="remedies-for-staggered-did-biases.html#cb766-2" tabindex="-1"></a>    <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb766-3"><a href="remedies-for-staggered-did-biases.html#cb766-3" tabindex="-1"></a>    <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb766-4"><a href="remedies-for-staggered-did-biases.html#cb766-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb766-5"><a href="remedies-for-staggered-did-biases.html#cb766-5" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb766-6"><a href="remedies-for-staggered-did-biases.html#cb766-6" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span>,</span>
<span id="cb766-7"><a href="remedies-for-staggered-did-biases.html#cb766-7" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb766-8"><a href="remedies-for-staggered-did-biases.html#cb766-8" tabindex="-1"></a>    </span>
<span id="cb766-9"><a href="remedies-for-staggered-did-biases.html#cb766-9" tabindex="-1"></a>    <span class="at">hide.x.tick.label =</span> <span class="cn">TRUE</span>, <span class="at">hide.y.tick.label =</span> <span class="cn">TRUE</span>, </span>
<span id="cb766-10"><a href="remedies-for-staggered-did-biases.html#cb766-10" tabindex="-1"></a>    <span class="co"># dense.plot = TRUE,</span></span>
<span id="cb766-11"><a href="remedies-for-staggered-did-biases.html#cb766-11" tabindex="-1"></a>    <span class="at">data =</span> dem</span>
<span id="cb766-12"><a href="remedies-for-staggered-did-biases.html#cb766-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: decimal">
<li>Select <span class="math inline">\(F\)</span> (i.e., the number of leads - time periods after treatment). Driven by what authors are interested in estimating:</li>
</ol>
<ul>
<li><p><span class="math inline">\(F = 0\)</span> is the contemporaneous effect (short-term effect)</p></li>
<li><p><span class="math inline">\(F = n\)</span> is the the treatment effect on the outcome two time periods after the treatment. (cumulative or long-term effect)</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Select <span class="math inline">\(L\)</span> (number of lags to adjust).</li>
</ol>
<ul>
<li><p>Driven by the identification assumption.</p></li>
<li><p>Balances bias-variance tradeoff.</p></li>
<li><p>Higher <span class="math inline">\(L\)</span> values increase credibility but reduce efficiency by limiting potential matches.</p></li>
</ul>
<p><strong>Model assumption</strong>:</p>
<ul>
<li><p>No spillover effect assumed.</p></li>
<li><p>Carryover effect allowed up to <span class="math inline">\(L\)</span> periods.</p></li>
<li><p>Potential outcome for a unit depends neither on others’ treatment status nor on its past treatment after <span class="math inline">\(L\)</span> periods.</p></li>
</ul>
<p>After defining causal quantity with parameters <span class="math inline">\(L\)</span> and <span class="math inline">\(F\)</span>.</p>
<ul>
<li>Focus on the average treatment effect of treatment status change.</li>
<li><span class="math inline">\(\delta(F,L)\)</span> is the average causal effect of treatment change (ATT), <span class="math inline">\(F\)</span> periods post-treatment, considering treatment history up to <span class="math inline">\(L\)</span> periods.</li>
<li>Causal quantity considers potential future treatment reversals, meaning treatment could revert to control before outcome measurement.</li>
</ul>
<p>Also possible to estimate the average treatment effect of treatment reversal on the reversed (ART).</p>
<p>Choose <span class="math inline">\(L,F\)</span> based on specific needs.</p>
<ul>
<li><p>A large <span class="math inline">\(L\)</span> value:</p>
<ul>
<li><p>Increases the credibility of the limited carryover effect assumption.</p></li>
<li><p>Allows more past treatments (up to <span class="math inline">\(t−L\)</span>) to influence the outcome <span class="math inline">\(Y_{i,t+F}\)</span>.</p></li>
<li><p>Might reduce the number of matches and lead to less precise estimates.</p></li>
</ul></li>
<li><p>Selecting an appropriate number of lags</p>
<ul>
<li><p>Researchers should base this choice on substantive knowledge.</p></li>
<li><p>Sensitivity of empirical results to this choice should be examined.</p></li>
</ul></li>
<li><p>The choice of <span class="math inline">\(F\)</span> should be:</p>
<ul>
<li><p>Substantively motivated.</p></li>
<li><p>Decides whether the interest lies in short-term or long-term causal effects.</p></li>
<li><p>A large <span class="math inline">\(F\)</span> value can complicate causal effect interpretation, especially if many units switch treatment status during the <span class="math inline">\(F\)</span> lead time period.</p></li>
</ul></li>
</ul>
<p><strong>Identification Assumption</strong></p>
<ul>
<li><p>Parallel trend assumption conditioned on treatment, outcome (excluding immediate lag), and covariate histories.</p></li>
<li><p>Doesn’t require strong unconfoundedness assumption.</p></li>
<li><p>Cannot account for unobserved time-varying confounders.</p></li>
<li><p>Essential to examine outcome time trends.</p>
<ul>
<li>Check if they’re parallel between treated and matched control units using pre-treatment data</li>
</ul></li>
<li><p><strong>Constructing the Matched Sets</strong>:</p>
<ul>
<li><p>For each treated observation, create matched control units with identical treatment history from <span class="math inline">\(t−L\)</span> to <span class="math inline">\(t−1\)</span>.</p></li>
<li><p>Matching based on treatment history helps control for carryover effects.</p></li>
<li><p>Past treatments often act as major confounders, but this method can correct for it.</p></li>
<li><p>Exact matching on time period adjusts for time-specific unobserved confounders.</p></li>
<li><p>Unlike staggered adoption methods, units can change treatment status multiple times.</p></li>
<li><p>Matched set allows treatment switching in and out of treatment</p></li>
</ul></li>
<li><p><strong>Refining the Matched Sets</strong>:</p>
<ul>
<li><p>Initially, matched sets adjust only for treatment history.</p></li>
<li><p>Parallel trend assumption requires adjustments for other confounders like past outcomes and covariates.</p></li>
<li><p>Matching methods:</p>
<ul>
<li><p>Match each treated observation with up to <span class="math inline">\(J\)</span> control units.</p></li>
<li><p>Distance measures like Mahalanobis distance or propensity score can be used.</p></li>
<li><p>Match based on estimated propensity score, considering pretreatment covariates.</p></li>
<li><p>Refined matched set selects most similar control units based on observed confounders.</p></li>
</ul></li>
<li><p>Weighting methods:</p>
<ul>
<li><p>Assign weight to each control unit in a matched set.</p></li>
<li><p>Weights prioritize more similar units.</p></li>
<li><p>Inverse propensity score weighting method can be applied.</p></li>
<li><p>Weighting is a more generalized method than matching.</p></li>
</ul></li>
</ul></li>
</ul>
<p><strong>The Difference-in-Differences Estimator</strong>:</p>
<ul>
<li><p>Using refined matched sets, the ATT (Average Treatment Effect on the Treated) of policy change is estimated.</p></li>
<li><p>For each treated observation, estimate the counterfactual outcome using the weighted average of control units in the refined set.</p></li>
<li><p>The DiD estimate of the ATT is computed for each treated observation, then averaged across all such observations.</p></li>
<li><p>For noncontemporaneous treatment effects where <span class="math inline">\(F &gt; 0\)</span>:</p>
<ul>
<li><p>The ATT doesn’t specify future treatment sequence.</p></li>
<li><p>Matched control units might have units receiving treatment between time <span class="math inline">\(t\)</span> and <span class="math inline">\(t + F\)</span>.</p></li>
<li><p>Some treated units could return to control conditions between these times.</p></li>
</ul></li>
</ul>
<p><strong>Checking Covariate Balance</strong>:</p>
<ul>
<li><p>The proposed methodology offers the advantage of checking covariate balance between treated and matched control observations.</p></li>
<li><p>This check helps to see if treated and matched control observations are comparable with respect to observed confounders.</p></li>
<li><p>Once matched sets are refined, covariate balance examination becomes straightforward.</p></li>
<li><p>Examine the mean difference of each covariate between a treated observation and its matched controls for each pretreatment time period.</p></li>
<li><p>Standardize this difference using the standard deviation of each covariate across all treated observations in the dataset.</p></li>
<li><p>Aggregate this covariate balance measure across all treated observations for each covariate and pretreatment time period.</p></li>
<li><p>Examine balance for lagged outcome variables over multiple pretreatment periods and time-varying covariates.</p>
<ul>
<li>This helps evaluate the validity of the parallel trend assumption underlying the proposed DiD estimator.</li>
</ul></li>
</ul>
<p><strong>Relations with Linear Fixed Effects Regression Estimators</strong>:</p>
<ul>
<li><p>The standard DiD estimator is equivalent to the linear two-way fixed effects regression estimator when:</p>
<ul>
<li><p>Only two time periods exist.</p></li>
<li><p>Treatment is given to some units exclusively in the second period.</p></li>
</ul></li>
<li><p>This equivalence doesn’t extend to multiperiod DiD designs, where:</p>
<ul>
<li><p>More than two time periods are considered.</p></li>
<li><p>Units might receive treatment multiple times.</p></li>
</ul></li>
<li><p>Despite this, many researchers relate the use of the two-way fixed effects estimator to the DiD design.</p></li>
</ul>
<p><strong>Standard Error Calculation</strong>:</p>
<ul>
<li><p>Approach:</p>
<ul>
<li><p>Condition on the weights implied by the matching process.</p></li>
<li><p>These weights denote how often an observation is utilized in matching <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span></p></li>
</ul></li>
<li><p>Context:</p>
<ul>
<li><p>Analogous to the conditional variance seen in regression models.</p></li>
<li><p>Resulting standard errors don’t factor in uncertainties around the matching procedure.</p></li>
<li><p>They can be viewed as a measure of uncertainty conditional upon the matching process <span class="citation">(<a href="#ref-ho2007matching">Ho et al. 2007</a>)</span>.</p></li>
</ul></li>
</ul>
<p><strong>Key Findings</strong>:</p>
<ul>
<li><p>Even in conditions favoring OLS, the proposed matching estimator displayed higher robustness to omitted relevant lags than the linear regression model with fixed effects.</p></li>
<li><p>The robustness offered by matching came at a cost - reduced statistical power.</p></li>
<li><p>This emphasizes the classic statistical tradeoff between bias (where matching has an advantage) and variance (where regression models might be more efficient).</p></li>
</ul>
<p><strong>Data Requirements</strong></p>
<ul>
<li><p>The treatment variable is binary:</p>
<ul>
<li><p>0 signifies “assignment” to control.</p></li>
<li><p>1 signifies assignment to treatment.</p></li>
</ul></li>
<li><p>Variables identifying units in the data must be: Numeric or integer.</p></li>
<li><p>Variables identifying time periods should be: Consecutive numeric/integer data.</p></li>
<li><p>Data format requirement: Must be provided as a standard <code>data.frame</code> object.</p></li>
</ul>
<p>Basic functions:</p>
<ol style="list-style-type: decimal">
<li><p>Utilize treatment histories to create matching sets of treated and control units.</p></li>
<li><p>Refine these matched sets by determining weights for each control unit in the set.</p>
<ul>
<li>Units with higher weights have a larger influence during estimations.</li>
</ul></li>
</ol>
<p><strong>Matching on Treatment History</strong>:</p>
<ul>
<li><p>Goal is to match units transitioning from untreated to treated status with control units that have similar past treatment histories.</p></li>
<li><p>Setting the Quantity of Interest (<code>qoi =</code>)</p>
<ul>
<li><p><code>att</code> average treatment effect on treated units</p></li>
<li><p><code>atc</code> average treatment effect of treatment on the control units</p></li>
<li><p><code>art</code> average effect of treatment reversal for units that experience treatment reversal</p></li>
<li><p><code>ate</code> average treatment effect</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="remedies-for-staggered-did-biases.html#cb767-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span>
<span id="cb767-2"><a href="remedies-for-staggered-did-biases.html#cb767-2" tabindex="-1"></a><span class="co"># All examples follow the package&#39;s vignette</span></span>
<span id="cb767-3"><a href="remedies-for-staggered-did-biases.html#cb767-3" tabindex="-1"></a><span class="co"># Create the matched sets</span></span>
<span id="cb767-4"><a href="remedies-for-staggered-did-biases.html#cb767-4" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb767-5"><a href="remedies-for-staggered-did-biases.html#cb767-5" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb767-6"><a href="remedies-for-staggered-did-biases.html#cb767-6" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb767-7"><a href="remedies-for-staggered-did-biases.html#cb767-7" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb767-8"><a href="remedies-for-staggered-did-biases.html#cb767-8" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb767-9"><a href="remedies-for-staggered-did-biases.html#cb767-9" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb767-10"><a href="remedies-for-staggered-did-biases.html#cb767-10" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb767-11"><a href="remedies-for-staggered-did-biases.html#cb767-11" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb767-12"><a href="remedies-for-staggered-did-biases.html#cb767-12" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb767-13"><a href="remedies-for-staggered-did-biases.html#cb767-13" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb767-14"><a href="remedies-for-staggered-did-biases.html#cb767-14" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb767-15"><a href="remedies-for-staggered-did-biases.html#cb767-15" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb767-16"><a href="remedies-for-staggered-did-biases.html#cb767-16" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb767-17"><a href="remedies-for-staggered-did-biases.html#cb767-17" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb767-18"><a href="remedies-for-staggered-did-biases.html#cb767-18" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb767-19"><a href="remedies-for-staggered-did-biases.html#cb767-19" tabindex="-1"></a>    )</span>
<span id="cb767-20"><a href="remedies-for-staggered-did-biases.html#cb767-20" tabindex="-1"></a></span>
<span id="cb767-21"><a href="remedies-for-staggered-did-biases.html#cb767-21" tabindex="-1"></a><span class="co"># visualize the treated unit and matched controls</span></span>
<span id="cb767-22"><a href="remedies-for-staggered-did-biases.html#cb767-22" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb767-23"><a href="remedies-for-staggered-did-biases.html#cb767-23" tabindex="-1"></a>    <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb767-24"><a href="remedies-for-staggered-did-biases.html#cb767-24" tabindex="-1"></a>    <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb767-25"><a href="remedies-for-staggered-did-biases.html#cb767-25" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb767-26"><a href="remedies-for-staggered-did-biases.html#cb767-26" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb767-27"><a href="remedies-for-staggered-did-biases.html#cb767-27" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span>,</span>
<span id="cb767-28"><a href="remedies-for-staggered-did-biases.html#cb767-28" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb767-29"><a href="remedies-for-staggered-did-biases.html#cb767-29" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb767-30"><a href="remedies-for-staggered-did-biases.html#cb767-30" tabindex="-1"></a>    <span class="at">matched.set =</span> PM.results.none<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb767-31"><a href="remedies-for-staggered-did-biases.html#cb767-31" tabindex="-1"></a>    <span class="co"># highlight the particular set</span></span>
<span id="cb767-32"><a href="remedies-for-staggered-did-biases.html#cb767-32" tabindex="-1"></a>    <span class="at">show.set.only =</span> <span class="cn">TRUE</span></span>
<span id="cb767-33"><a href="remedies-for-staggered-did-biases.html#cb767-33" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Control units and the treated unit have identical treatment histories over the lag window (1988-1991)</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="remedies-for-staggered-did-biases.html#cb768-1" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb768-2"><a href="remedies-for-staggered-did-biases.html#cb768-2" tabindex="-1"></a>    <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb768-3"><a href="remedies-for-staggered-did-biases.html#cb768-3" tabindex="-1"></a>    <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb768-4"><a href="remedies-for-staggered-did-biases.html#cb768-4" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb768-5"><a href="remedies-for-staggered-did-biases.html#cb768-5" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb768-6"><a href="remedies-for-staggered-did-biases.html#cb768-6" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span>,</span>
<span id="cb768-7"><a href="remedies-for-staggered-did-biases.html#cb768-7" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb768-8"><a href="remedies-for-staggered-did-biases.html#cb768-8" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb768-9"><a href="remedies-for-staggered-did-biases.html#cb768-9" tabindex="-1"></a>    <span class="at">matched.set =</span> PM.results.none<span class="sc">$</span>att[<span class="dv">2</span>],</span>
<span id="cb768-10"><a href="remedies-for-staggered-did-biases.html#cb768-10" tabindex="-1"></a>    <span class="co"># highlight the particular set</span></span>
<span id="cb768-11"><a href="remedies-for-staggered-did-biases.html#cb768-11" tabindex="-1"></a>    <span class="at">show.set.only =</span> <span class="cn">TRUE</span></span>
<span id="cb768-12"><a href="remedies-for-staggered-did-biases.html#cb768-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This set is more limited than the first one, but we can still see that we have exact past histories.</p>
<ul>
<li><p><strong>Refining Matched Sets</strong></p>
<ul>
<li><p>Refinement involves assigning weights to control units.</p></li>
<li><p>Users must:</p>
<ol style="list-style-type: decimal">
<li><p>Specify a method for calculating unit similarity/distance.</p></li>
<li><p>Choose variables for similarity/distance calculations.</p></li>
</ol></li>
</ul></li>
<li><p><strong>Select a Refinement Method</strong></p>
<ul>
<li><p>Users determine the refinement method via the <strong><code>refinement.method</code></strong> argument.</p></li>
<li><p>Options include:</p>
<ul>
<li><p><code>mahalanobis</code></p></li>
<li><p><code>ps.match</code></p></li>
<li><p><code>CBPS.match</code></p></li>
<li><p><code>ps.weight</code></p></li>
<li><p><code>CBPS.weight</code></p></li>
<li><p><code>ps.msm.weight</code></p></li>
<li><p><code>CBPS.msm.weight</code></p></li>
<li><p><code>none</code></p></li>
</ul></li>
<li><p>Methods with “match” in the name and Mahalanobis will assign equal weights to similar control units.</p></li>
<li><p>“Weighting” methods give higher weights to control units more similar to treated units.</p></li>
</ul></li>
<li><p><strong>Variable Selection</strong></p>
<ul>
<li><p>Users need to define which covariates will be used through the <strong><code>covs.formula</code></strong> argument, a one-sided formula object.</p></li>
<li><p>Variables on the right side of the formula are used for calculations.</p></li>
<li><p>“Lagged” versions of variables can be included using the format: <strong><code>I(lag(name.of.var, 0:n))</code></strong>.</p></li>
</ul></li>
<li><p><strong>Understanding <code>PanelMatch</code> and <code>matched.set</code> objects</strong></p>
<ul>
<li><p>The <strong><code>PanelMatch</code> function</strong> returns a <strong><code>PanelMatch</code> object</strong>.</p></li>
<li><p>The most crucial element within the <code>PanelMatch</code> object is the <strong>matched.set object</strong>.</p></li>
<li><p>Within the <code>PanelMatch</code> object, the matched.set object will have names like att, art, or atc.</p></li>
<li><p>If <strong><code>qoi = ate</code></strong>, there will be two matched.set objects: att and atc.</p></li>
</ul></li>
<li><p><strong>Matched.set Object Details</strong></p>
<ul>
<li><p>matched.set is a named list with added attributes.</p></li>
<li><p>Attributes include:</p>
<ul>
<li><p>Lag</p></li>
<li><p>Names of treatment</p></li>
<li><p>Unit and time variables</p></li>
</ul></li>
<li><p>Each list entry represents a matched set of treated and control units.</p></li>
<li><p>Naming follows a structure: <strong><code>[id variable].[time variable]</code></strong>.</p></li>
<li><p>Each list element is a vector of control unit ids that match the treated unit mentioned in the element name.</p></li>
<li><p>Since it’s a matching method, weights are only given to the <strong><code>size.match</code></strong> most similar control units based on distance calculations.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="remedies-for-staggered-did-biases.html#cb769-1" tabindex="-1"></a><span class="co"># PanelMatch without any refinement</span></span>
<span id="cb769-2"><a href="remedies-for-staggered-did-biases.html#cb769-2" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb769-3"><a href="remedies-for-staggered-did-biases.html#cb769-3" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb769-4"><a href="remedies-for-staggered-did-biases.html#cb769-4" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb769-5"><a href="remedies-for-staggered-did-biases.html#cb769-5" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb769-6"><a href="remedies-for-staggered-did-biases.html#cb769-6" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb769-7"><a href="remedies-for-staggered-did-biases.html#cb769-7" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb769-8"><a href="remedies-for-staggered-did-biases.html#cb769-8" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb769-9"><a href="remedies-for-staggered-did-biases.html#cb769-9" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb769-10"><a href="remedies-for-staggered-did-biases.html#cb769-10" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb769-11"><a href="remedies-for-staggered-did-biases.html#cb769-11" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb769-12"><a href="remedies-for-staggered-did-biases.html#cb769-12" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb769-13"><a href="remedies-for-staggered-did-biases.html#cb769-13" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb769-14"><a href="remedies-for-staggered-did-biases.html#cb769-14" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb769-15"><a href="remedies-for-staggered-did-biases.html#cb769-15" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb769-16"><a href="remedies-for-staggered-did-biases.html#cb769-16" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb769-17"><a href="remedies-for-staggered-did-biases.html#cb769-17" tabindex="-1"></a>    )</span>
<span id="cb769-18"><a href="remedies-for-staggered-did-biases.html#cb769-18" tabindex="-1"></a></span>
<span id="cb769-19"><a href="remedies-for-staggered-did-biases.html#cb769-19" tabindex="-1"></a><span class="co"># Extract the matched.set object</span></span>
<span id="cb769-20"><a href="remedies-for-staggered-did-biases.html#cb769-20" tabindex="-1"></a>msets.none <span class="ot">&lt;-</span> PM.results.none<span class="sc">$</span>att</span>
<span id="cb769-21"><a href="remedies-for-staggered-did-biases.html#cb769-21" tabindex="-1"></a></span>
<span id="cb769-22"><a href="remedies-for-staggered-did-biases.html#cb769-22" tabindex="-1"></a><span class="co"># PanelMatch with refinement</span></span>
<span id="cb769-23"><a href="remedies-for-staggered-did-biases.html#cb769-23" tabindex="-1"></a>PM.results.maha <span class="ot">&lt;-</span></span>
<span id="cb769-24"><a href="remedies-for-staggered-did-biases.html#cb769-24" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb769-25"><a href="remedies-for-staggered-did-biases.html#cb769-25" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb769-26"><a href="remedies-for-staggered-did-biases.html#cb769-26" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb769-27"><a href="remedies-for-staggered-did-biases.html#cb769-27" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb769-28"><a href="remedies-for-staggered-did-biases.html#cb769-28" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb769-29"><a href="remedies-for-staggered-did-biases.html#cb769-29" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="co"># use Mahalanobis distance</span></span>
<span id="cb769-30"><a href="remedies-for-staggered-did-biases.html#cb769-30" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb769-31"><a href="remedies-for-staggered-did-biases.html#cb769-31" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb769-32"><a href="remedies-for-staggered-did-biases.html#cb769-32" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> tradewb,</span>
<span id="cb769-33"><a href="remedies-for-staggered-did-biases.html#cb769-33" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb769-34"><a href="remedies-for-staggered-did-biases.html#cb769-34" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span> ,</span>
<span id="cb769-35"><a href="remedies-for-staggered-did-biases.html#cb769-35" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb769-36"><a href="remedies-for-staggered-did-biases.html#cb769-36" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb769-37"><a href="remedies-for-staggered-did-biases.html#cb769-37" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb769-38"><a href="remedies-for-staggered-did-biases.html#cb769-38" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb769-39"><a href="remedies-for-staggered-did-biases.html#cb769-39" tabindex="-1"></a>    )</span>
<span id="cb769-40"><a href="remedies-for-staggered-did-biases.html#cb769-40" tabindex="-1"></a>msets.maha <span class="ot">&lt;-</span> PM.results.maha<span class="sc">$</span>att</span></code></pre></div>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="remedies-for-staggered-did-biases.html#cb770-1" tabindex="-1"></a><span class="co"># these 2 should be identical because weights are not shown</span></span>
<span id="cb770-2"><a href="remedies-for-staggered-did-biases.html#cb770-2" tabindex="-1"></a>msets.none <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb770-3"><a href="remedies-for-staggered-did-biases.html#cb770-3" tabindex="-1"></a><span class="co">#&gt;   wbcode2 year matched.set.size</span></span>
<span id="cb770-4"><a href="remedies-for-staggered-did-biases.html#cb770-4" tabindex="-1"></a><span class="co">#&gt; 1       4 1992               74</span></span>
<span id="cb770-5"><a href="remedies-for-staggered-did-biases.html#cb770-5" tabindex="-1"></a><span class="co">#&gt; 2       4 1997                2</span></span>
<span id="cb770-6"><a href="remedies-for-staggered-did-biases.html#cb770-6" tabindex="-1"></a><span class="co">#&gt; 3       6 1973               63</span></span>
<span id="cb770-7"><a href="remedies-for-staggered-did-biases.html#cb770-7" tabindex="-1"></a><span class="co">#&gt; 4       6 1983               73</span></span>
<span id="cb770-8"><a href="remedies-for-staggered-did-biases.html#cb770-8" tabindex="-1"></a><span class="co">#&gt; 5       7 1991               81</span></span>
<span id="cb770-9"><a href="remedies-for-staggered-did-biases.html#cb770-9" tabindex="-1"></a><span class="co">#&gt; 6       7 1998                1</span></span>
<span id="cb770-10"><a href="remedies-for-staggered-did-biases.html#cb770-10" tabindex="-1"></a>msets.maha <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb770-11"><a href="remedies-for-staggered-did-biases.html#cb770-11" tabindex="-1"></a><span class="co">#&gt;   wbcode2 year matched.set.size</span></span>
<span id="cb770-12"><a href="remedies-for-staggered-did-biases.html#cb770-12" tabindex="-1"></a><span class="co">#&gt; 1       4 1992               74</span></span>
<span id="cb770-13"><a href="remedies-for-staggered-did-biases.html#cb770-13" tabindex="-1"></a><span class="co">#&gt; 2       4 1997                2</span></span>
<span id="cb770-14"><a href="remedies-for-staggered-did-biases.html#cb770-14" tabindex="-1"></a><span class="co">#&gt; 3       6 1973               63</span></span>
<span id="cb770-15"><a href="remedies-for-staggered-did-biases.html#cb770-15" tabindex="-1"></a><span class="co">#&gt; 4       6 1983               73</span></span>
<span id="cb770-16"><a href="remedies-for-staggered-did-biases.html#cb770-16" tabindex="-1"></a><span class="co">#&gt; 5       7 1991               81</span></span>
<span id="cb770-17"><a href="remedies-for-staggered-did-biases.html#cb770-17" tabindex="-1"></a><span class="co">#&gt; 6       7 1998                1</span></span>
<span id="cb770-18"><a href="remedies-for-staggered-did-biases.html#cb770-18" tabindex="-1"></a><span class="co"># summary(msets.none)</span></span>
<span id="cb770-19"><a href="remedies-for-staggered-did-biases.html#cb770-19" tabindex="-1"></a><span class="co"># summary(msets.maha)</span></span></code></pre></div>
<p><strong>Visualizing Matched Sets with the plot method</strong></p>
<ul>
<li><p>Users can visualize the distribution of the matched set sizes.</p></li>
<li><p>A red line, by default, indicates the count of matched sets where treated units had no matching control units (i.e., empty matched sets).</p></li>
<li><p>Plot adjustments can be made using <strong><code>graphics::plot</code></strong>.</p></li>
</ul>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="remedies-for-staggered-did-biases.html#cb771-1" tabindex="-1"></a><span class="fu">plot</span>(msets.none)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-14-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Comparing Methods of Refinement</strong></p>
<ul>
<li><p>Users are encouraged to:</p>
<ul>
<li><p>Use substantive knowledge for experimentation and evaluation.</p></li>
<li><p>Consider the following when configuring <code>PanelMatch</code>:</p>
<ol style="list-style-type: decimal">
<li><p>The number of matched sets.</p></li>
<li><p>The number of controls matched to each treated unit.</p></li>
<li><p>Achieving covariate balance.</p></li>
</ol></li>
<li><p><strong>Note</strong>: Large numbers of small matched sets can lead to larger standard errors during the estimation stage.</p></li>
<li><p>Covariates that aren’t well balanced can lead to undesirable comparisons between treated and control units.</p></li>
<li><p>Aspects to consider include:</p>
<ul>
<li><p>Refinement method.</p></li>
<li><p>Variables for weight calculation.</p></li>
<li><p>Size of the lag window.</p></li>
<li><p>Procedures for addressing missing data (refer to <strong><code>match.missing</code></strong> and <strong><code>listwise.delete</code></strong> arguments).</p></li>
<li><p>Maximum size of matched sets (for matching methods).</p></li>
</ul></li>
</ul></li>
<li><p><strong>Supportive Features:</strong></p>
<ul>
<li><p><strong><code>print</code></strong>, <strong><code>plot</code></strong>, and <strong><code>summary</code></strong> methods assist in understanding matched sets and their sizes.</p></li>
<li><p><strong><code>get_covariate_balance</code></strong> helps evaluate covariate balance:</p>
<ul>
<li>Lower values in the covariate balance calculations are preferred.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="remedies-for-staggered-did-biases.html#cb772-1" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb772-2"><a href="remedies-for-staggered-did-biases.html#cb772-2" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb772-3"><a href="remedies-for-staggered-did-biases.html#cb772-3" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb772-4"><a href="remedies-for-staggered-did-biases.html#cb772-4" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb772-5"><a href="remedies-for-staggered-did-biases.html#cb772-5" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb772-6"><a href="remedies-for-staggered-did-biases.html#cb772-6" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb772-7"><a href="remedies-for-staggered-did-biases.html#cb772-7" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb772-8"><a href="remedies-for-staggered-did-biases.html#cb772-8" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb772-9"><a href="remedies-for-staggered-did-biases.html#cb772-9" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb772-10"><a href="remedies-for-staggered-did-biases.html#cb772-10" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb772-11"><a href="remedies-for-staggered-did-biases.html#cb772-11" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb772-12"><a href="remedies-for-staggered-did-biases.html#cb772-12" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb772-13"><a href="remedies-for-staggered-did-biases.html#cb772-13" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb772-14"><a href="remedies-for-staggered-did-biases.html#cb772-14" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb772-15"><a href="remedies-for-staggered-did-biases.html#cb772-15" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb772-16"><a href="remedies-for-staggered-did-biases.html#cb772-16" tabindex="-1"></a>    )</span>
<span id="cb772-17"><a href="remedies-for-staggered-did-biases.html#cb772-17" tabindex="-1"></a>PM.results.maha <span class="ot">&lt;-</span></span>
<span id="cb772-18"><a href="remedies-for-staggered-did-biases.html#cb772-18" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb772-19"><a href="remedies-for-staggered-did-biases.html#cb772-19" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb772-20"><a href="remedies-for-staggered-did-biases.html#cb772-20" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb772-21"><a href="remedies-for-staggered-did-biases.html#cb772-21" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb772-22"><a href="remedies-for-staggered-did-biases.html#cb772-22" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb772-23"><a href="remedies-for-staggered-did-biases.html#cb772-23" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb772-24"><a href="remedies-for-staggered-did-biases.html#cb772-24" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb772-25"><a href="remedies-for-staggered-did-biases.html#cb772-25" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb772-26"><a href="remedies-for-staggered-did-biases.html#cb772-26" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb772-27"><a href="remedies-for-staggered-did-biases.html#cb772-27" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb772-28"><a href="remedies-for-staggered-did-biases.html#cb772-28" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb772-29"><a href="remedies-for-staggered-did-biases.html#cb772-29" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb772-30"><a href="remedies-for-staggered-did-biases.html#cb772-30" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb772-31"><a href="remedies-for-staggered-did-biases.html#cb772-31" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb772-32"><a href="remedies-for-staggered-did-biases.html#cb772-32" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb772-33"><a href="remedies-for-staggered-did-biases.html#cb772-33" tabindex="-1"></a>    )</span>
<span id="cb772-34"><a href="remedies-for-staggered-did-biases.html#cb772-34" tabindex="-1"></a></span>
<span id="cb772-35"><a href="remedies-for-staggered-did-biases.html#cb772-35" tabindex="-1"></a><span class="co"># listwise deletion used for missing data</span></span>
<span id="cb772-36"><a href="remedies-for-staggered-did-biases.html#cb772-36" tabindex="-1"></a>PM.results.listwise <span class="ot">&lt;-</span></span>
<span id="cb772-37"><a href="remedies-for-staggered-did-biases.html#cb772-37" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb772-38"><a href="remedies-for-staggered-did-biases.html#cb772-38" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb772-39"><a href="remedies-for-staggered-did-biases.html#cb772-39" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb772-40"><a href="remedies-for-staggered-did-biases.html#cb772-40" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb772-41"><a href="remedies-for-staggered-did-biases.html#cb772-41" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb772-42"><a href="remedies-for-staggered-did-biases.html#cb772-42" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb772-43"><a href="remedies-for-staggered-did-biases.html#cb772-43" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb772-44"><a href="remedies-for-staggered-did-biases.html#cb772-44" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb772-45"><a href="remedies-for-staggered-did-biases.html#cb772-45" tabindex="-1"></a>        <span class="at">listwise.delete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb772-46"><a href="remedies-for-staggered-did-biases.html#cb772-46" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb772-47"><a href="remedies-for-staggered-did-biases.html#cb772-47" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb772-48"><a href="remedies-for-staggered-did-biases.html#cb772-48" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb772-49"><a href="remedies-for-staggered-did-biases.html#cb772-49" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb772-50"><a href="remedies-for-staggered-did-biases.html#cb772-50" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb772-51"><a href="remedies-for-staggered-did-biases.html#cb772-51" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb772-52"><a href="remedies-for-staggered-did-biases.html#cb772-52" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb772-53"><a href="remedies-for-staggered-did-biases.html#cb772-53" tabindex="-1"></a>    )</span>
<span id="cb772-54"><a href="remedies-for-staggered-did-biases.html#cb772-54" tabindex="-1"></a></span>
<span id="cb772-55"><a href="remedies-for-staggered-did-biases.html#cb772-55" tabindex="-1"></a><span class="co"># propensity score based weighting method</span></span>
<span id="cb772-56"><a href="remedies-for-staggered-did-biases.html#cb772-56" tabindex="-1"></a>PM.results.ps.weight <span class="ot">&lt;-</span></span>
<span id="cb772-57"><a href="remedies-for-staggered-did-biases.html#cb772-57" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb772-58"><a href="remedies-for-staggered-did-biases.html#cb772-58" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb772-59"><a href="remedies-for-staggered-did-biases.html#cb772-59" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb772-60"><a href="remedies-for-staggered-did-biases.html#cb772-60" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb772-61"><a href="remedies-for-staggered-did-biases.html#cb772-61" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb772-62"><a href="remedies-for-staggered-did-biases.html#cb772-62" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>,</span>
<span id="cb772-63"><a href="remedies-for-staggered-did-biases.html#cb772-63" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb772-64"><a href="remedies-for-staggered-did-biases.html#cb772-64" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb772-65"><a href="remedies-for-staggered-did-biases.html#cb772-65" tabindex="-1"></a>        <span class="at">listwise.delete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb772-66"><a href="remedies-for-staggered-did-biases.html#cb772-66" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb772-67"><a href="remedies-for-staggered-did-biases.html#cb772-67" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb772-68"><a href="remedies-for-staggered-did-biases.html#cb772-68" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb772-69"><a href="remedies-for-staggered-did-biases.html#cb772-69" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb772-70"><a href="remedies-for-staggered-did-biases.html#cb772-70" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb772-71"><a href="remedies-for-staggered-did-biases.html#cb772-71" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span></span>
<span id="cb772-72"><a href="remedies-for-staggered-did-biases.html#cb772-72" tabindex="-1"></a>    )</span>
<span id="cb772-73"><a href="remedies-for-staggered-did-biases.html#cb772-73" tabindex="-1"></a></span>
<span id="cb772-74"><a href="remedies-for-staggered-did-biases.html#cb772-74" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb772-75"><a href="remedies-for-staggered-did-biases.html#cb772-75" tabindex="-1"></a>    PM.results.none<span class="sc">$</span>att,</span>
<span id="cb772-76"><a href="remedies-for-staggered-did-biases.html#cb772-76" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb772-77"><a href="remedies-for-staggered-did-biases.html#cb772-77" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb772-78"><a href="remedies-for-staggered-did-biases.html#cb772-78" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb772-79"><a href="remedies-for-staggered-did-biases.html#cb772-79" tabindex="-1"></a>)</span>
<span id="cb772-80"><a href="remedies-for-staggered-did-biases.html#cb772-80" tabindex="-1"></a><span class="co">#&gt;         tradewb            y</span></span>
<span id="cb772-81"><a href="remedies-for-staggered-did-biases.html#cb772-81" tabindex="-1"></a><span class="co">#&gt; t_4 -0.07245466  0.291871990</span></span>
<span id="cb772-82"><a href="remedies-for-staggered-did-biases.html#cb772-82" tabindex="-1"></a><span class="co">#&gt; t_3 -0.20930129  0.208654876</span></span>
<span id="cb772-83"><a href="remedies-for-staggered-did-biases.html#cb772-83" tabindex="-1"></a><span class="co">#&gt; t_2 -0.24425207  0.107736647</span></span>
<span id="cb772-84"><a href="remedies-for-staggered-did-biases.html#cb772-84" tabindex="-1"></a><span class="co">#&gt; t_1 -0.10806125 -0.004950238</span></span>
<span id="cb772-85"><a href="remedies-for-staggered-did-biases.html#cb772-85" tabindex="-1"></a><span class="co">#&gt; t_0 -0.09493854 -0.015198483</span></span>
<span id="cb772-86"><a href="remedies-for-staggered-did-biases.html#cb772-86" tabindex="-1"></a></span>
<span id="cb772-87"><a href="remedies-for-staggered-did-biases.html#cb772-87" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb772-88"><a href="remedies-for-staggered-did-biases.html#cb772-88" tabindex="-1"></a>    PM.results.maha<span class="sc">$</span>att,</span>
<span id="cb772-89"><a href="remedies-for-staggered-did-biases.html#cb772-89" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb772-90"><a href="remedies-for-staggered-did-biases.html#cb772-90" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb772-91"><a href="remedies-for-staggered-did-biases.html#cb772-91" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb772-92"><a href="remedies-for-staggered-did-biases.html#cb772-92" tabindex="-1"></a>)</span>
<span id="cb772-93"><a href="remedies-for-staggered-did-biases.html#cb772-93" tabindex="-1"></a><span class="co">#&gt;         tradewb          y</span></span>
<span id="cb772-94"><a href="remedies-for-staggered-did-biases.html#cb772-94" tabindex="-1"></a><span class="co">#&gt; t_4  0.04558637 0.09701606</span></span>
<span id="cb772-95"><a href="remedies-for-staggered-did-biases.html#cb772-95" tabindex="-1"></a><span class="co">#&gt; t_3 -0.03312750 0.10844046</span></span>
<span id="cb772-96"><a href="remedies-for-staggered-did-biases.html#cb772-96" tabindex="-1"></a><span class="co">#&gt; t_2 -0.01396793 0.08890753</span></span>
<span id="cb772-97"><a href="remedies-for-staggered-did-biases.html#cb772-97" tabindex="-1"></a><span class="co">#&gt; t_1  0.10474894 0.06618865</span></span>
<span id="cb772-98"><a href="remedies-for-staggered-did-biases.html#cb772-98" tabindex="-1"></a><span class="co">#&gt; t_0  0.15885415 0.05691437</span></span>
<span id="cb772-99"><a href="remedies-for-staggered-did-biases.html#cb772-99" tabindex="-1"></a></span>
<span id="cb772-100"><a href="remedies-for-staggered-did-biases.html#cb772-100" tabindex="-1"></a></span>
<span id="cb772-101"><a href="remedies-for-staggered-did-biases.html#cb772-101" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb772-102"><a href="remedies-for-staggered-did-biases.html#cb772-102" tabindex="-1"></a>    PM.results.listwise<span class="sc">$</span>att,</span>
<span id="cb772-103"><a href="remedies-for-staggered-did-biases.html#cb772-103" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb772-104"><a href="remedies-for-staggered-did-biases.html#cb772-104" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb772-105"><a href="remedies-for-staggered-did-biases.html#cb772-105" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb772-106"><a href="remedies-for-staggered-did-biases.html#cb772-106" tabindex="-1"></a>)</span>
<span id="cb772-107"><a href="remedies-for-staggered-did-biases.html#cb772-107" tabindex="-1"></a><span class="co">#&gt;         tradewb          y</span></span>
<span id="cb772-108"><a href="remedies-for-staggered-did-biases.html#cb772-108" tabindex="-1"></a><span class="co">#&gt; t_4  0.05634922 0.05223623</span></span>
<span id="cb772-109"><a href="remedies-for-staggered-did-biases.html#cb772-109" tabindex="-1"></a><span class="co">#&gt; t_3 -0.01104797 0.05217896</span></span>
<span id="cb772-110"><a href="remedies-for-staggered-did-biases.html#cb772-110" tabindex="-1"></a><span class="co">#&gt; t_2  0.01411473 0.03094133</span></span>
<span id="cb772-111"><a href="remedies-for-staggered-did-biases.html#cb772-111" tabindex="-1"></a><span class="co">#&gt; t_1  0.06850180 0.02092209</span></span>
<span id="cb772-112"><a href="remedies-for-staggered-did-biases.html#cb772-112" tabindex="-1"></a><span class="co">#&gt; t_0  0.05044958 0.01943728</span></span>
<span id="cb772-113"><a href="remedies-for-staggered-did-biases.html#cb772-113" tabindex="-1"></a></span>
<span id="cb772-114"><a href="remedies-for-staggered-did-biases.html#cb772-114" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb772-115"><a href="remedies-for-staggered-did-biases.html#cb772-115" tabindex="-1"></a>    PM.results.ps.weight<span class="sc">$</span>att,</span>
<span id="cb772-116"><a href="remedies-for-staggered-did-biases.html#cb772-116" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb772-117"><a href="remedies-for-staggered-did-biases.html#cb772-117" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb772-118"><a href="remedies-for-staggered-did-biases.html#cb772-118" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb772-119"><a href="remedies-for-staggered-did-biases.html#cb772-119" tabindex="-1"></a>)</span>
<span id="cb772-120"><a href="remedies-for-staggered-did-biases.html#cb772-120" tabindex="-1"></a><span class="co">#&gt;         tradewb          y</span></span>
<span id="cb772-121"><a href="remedies-for-staggered-did-biases.html#cb772-121" tabindex="-1"></a><span class="co">#&gt; t_4 0.014362590 0.04035905</span></span>
<span id="cb772-122"><a href="remedies-for-staggered-did-biases.html#cb772-122" tabindex="-1"></a><span class="co">#&gt; t_3 0.005529734 0.04188731</span></span>
<span id="cb772-123"><a href="remedies-for-staggered-did-biases.html#cb772-123" tabindex="-1"></a><span class="co">#&gt; t_2 0.009410044 0.04195008</span></span>
<span id="cb772-124"><a href="remedies-for-staggered-did-biases.html#cb772-124" tabindex="-1"></a><span class="co">#&gt; t_1 0.027907540 0.03975173</span></span>
<span id="cb772-125"><a href="remedies-for-staggered-did-biases.html#cb772-125" tabindex="-1"></a><span class="co">#&gt; t_0 0.040272235 0.04167921</span></span></code></pre></div>
<p><strong>get_covariate_balance Function Options:</strong></p>
<ul>
<li><p>Allows for the generation of plots displaying covariate balance using <strong><code>plot = TRUE</code></strong>.</p></li>
<li><p>Plots can be customized using arguments typically used with the base R <strong><code>plot</code></strong> method.</p></li>
<li><p>Option to set <strong><code>use.equal.weights = TRUE</code></strong> for:</p>
<ul>
<li><p>Obtaining the balance of unrefined sets.</p></li>
<li><p>Facilitating understanding of the refinement’s impact.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="remedies-for-staggered-did-biases.html#cb773-1" tabindex="-1"></a><span class="co"># Use equal weights</span></span>
<span id="cb773-2"><a href="remedies-for-staggered-did-biases.html#cb773-2" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb773-3"><a href="remedies-for-staggered-did-biases.html#cb773-3" tabindex="-1"></a>    PM.results.ps.weight<span class="sc">$</span>att,</span>
<span id="cb773-4"><a href="remedies-for-staggered-did-biases.html#cb773-4" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb773-5"><a href="remedies-for-staggered-did-biases.html#cb773-5" tabindex="-1"></a>    <span class="at">use.equal.weights =</span> <span class="cn">TRUE</span>,</span>
<span id="cb773-6"><a href="remedies-for-staggered-did-biases.html#cb773-6" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb773-7"><a href="remedies-for-staggered-did-biases.html#cb773-7" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb773-8"><a href="remedies-for-staggered-did-biases.html#cb773-8" tabindex="-1"></a>    <span class="co"># visualize by setting plot to TRUE</span></span>
<span id="cb773-9"><a href="remedies-for-staggered-did-biases.html#cb773-9" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb773-10"><a href="remedies-for-staggered-did-biases.html#cb773-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-16-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="remedies-for-staggered-did-biases.html#cb774-1" tabindex="-1"></a></span>
<span id="cb774-2"><a href="remedies-for-staggered-did-biases.html#cb774-2" tabindex="-1"></a><span class="co"># Compare covariate balance to refined sets</span></span>
<span id="cb774-3"><a href="remedies-for-staggered-did-biases.html#cb774-3" tabindex="-1"></a><span class="co"># See large improvement in balance</span></span>
<span id="cb774-4"><a href="remedies-for-staggered-did-biases.html#cb774-4" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb774-5"><a href="remedies-for-staggered-did-biases.html#cb774-5" tabindex="-1"></a>    PM.results.ps.weight<span class="sc">$</span>att,</span>
<span id="cb774-6"><a href="remedies-for-staggered-did-biases.html#cb774-6" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb774-7"><a href="remedies-for-staggered-did-biases.html#cb774-7" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb774-8"><a href="remedies-for-staggered-did-biases.html#cb774-8" tabindex="-1"></a>    <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb774-9"><a href="remedies-for-staggered-did-biases.html#cb774-9" tabindex="-1"></a>    <span class="co"># visualize by setting plot to TRUE</span></span>
<span id="cb774-10"><a href="remedies-for-staggered-did-biases.html#cb774-10" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb774-11"><a href="remedies-for-staggered-did-biases.html#cb774-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-16-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="remedies-for-staggered-did-biases.html#cb775-1" tabindex="-1"></a></span>
<span id="cb775-2"><a href="remedies-for-staggered-did-biases.html#cb775-2" tabindex="-1"></a></span>
<span id="cb775-3"><a href="remedies-for-staggered-did-biases.html#cb775-3" tabindex="-1"></a><span class="fu">balance_scatter</span>(</span>
<span id="cb775-4"><a href="remedies-for-staggered-did-biases.html#cb775-4" tabindex="-1"></a>    <span class="at">matched_set_list =</span> <span class="fu">list</span>(PM.results.maha<span class="sc">$</span>att,</span>
<span id="cb775-5"><a href="remedies-for-staggered-did-biases.html#cb775-5" tabindex="-1"></a>                            PM.results.ps.weight<span class="sc">$</span>att),</span>
<span id="cb775-6"><a href="remedies-for-staggered-did-biases.html#cb775-6" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb775-7"><a href="remedies-for-staggered-did-biases.html#cb775-7" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;tradewb&quot;</span>)</span>
<span id="cb775-8"><a href="remedies-for-staggered-did-biases.html#cb775-8" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-16-3.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong><code>PanelEstimate</code></strong></p>
<ul>
<li><p><strong>Standard Error Calculation Methods</strong></p>
<ul>
<li><p>There are different methods available:</p>
<ul>
<li><p><strong>Bootstrap</strong> (default method with 1000 iterations).</p></li>
<li><p><strong>Conditional</strong>: Assumes independence across units, but not time.</p></li>
<li><p><strong>Unconditional</strong>: Doesn’t make assumptions of independence across units or time.</p></li>
</ul></li>
<li><p>For <strong><code>qoi</code></strong> values set to <code>att</code>, <code>art</code>, or <code>atc</code> <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span>:</p>
<ul>
<li>You can use analytical methods for calculating standard errors, which include both “conditional” and “unconditional” methods.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="remedies-for-staggered-did-biases.html#cb776-1" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb776-2"><a href="remedies-for-staggered-did-biases.html#cb776-2" tabindex="-1"></a>    <span class="at">sets              =</span> PM.results.ps.weight,</span>
<span id="cb776-3"><a href="remedies-for-staggered-did-biases.html#cb776-3" tabindex="-1"></a>    <span class="at">data              =</span> dem,</span>
<span id="cb776-4"><a href="remedies-for-staggered-did-biases.html#cb776-4" tabindex="-1"></a>    <span class="at">se.method         =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb776-5"><a href="remedies-for-staggered-did-biases.html#cb776-5" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb776-6"><a href="remedies-for-staggered-did-biases.html#cb776-6" tabindex="-1"></a>    <span class="at">confidence.level  =</span> .<span class="dv">95</span></span>
<span id="cb776-7"><a href="remedies-for-staggered-did-biases.html#cb776-7" tabindex="-1"></a>)</span>
<span id="cb776-8"><a href="remedies-for-staggered-did-biases.html#cb776-8" tabindex="-1"></a></span>
<span id="cb776-9"><a href="remedies-for-staggered-did-biases.html#cb776-9" tabindex="-1"></a><span class="co"># point estimates</span></span>
<span id="cb776-10"><a href="remedies-for-staggered-did-biases.html#cb776-10" tabindex="-1"></a>PE.results[[<span class="st">&quot;estimates&quot;</span>]]</span>
<span id="cb776-11"><a href="remedies-for-staggered-did-biases.html#cb776-11" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb776-12"><a href="remedies-for-staggered-did-biases.html#cb776-12" tabindex="-1"></a><span class="co">#&gt; 0.2609565 0.9630847 1.2851017 1.7370930 1.4871846</span></span>
<span id="cb776-13"><a href="remedies-for-staggered-did-biases.html#cb776-13" tabindex="-1"></a></span>
<span id="cb776-14"><a href="remedies-for-staggered-did-biases.html#cb776-14" tabindex="-1"></a><span class="co"># standard errors</span></span>
<span id="cb776-15"><a href="remedies-for-staggered-did-biases.html#cb776-15" tabindex="-1"></a>PE.results[[<span class="st">&quot;standard.error&quot;</span>]]</span>
<span id="cb776-16"><a href="remedies-for-staggered-did-biases.html#cb776-16" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb776-17"><a href="remedies-for-staggered-did-biases.html#cb776-17" tabindex="-1"></a><span class="co">#&gt; 0.6387986 1.0548882 1.4282656 1.7870905 2.2085197</span></span>
<span id="cb776-18"><a href="remedies-for-staggered-did-biases.html#cb776-18" tabindex="-1"></a></span>
<span id="cb776-19"><a href="remedies-for-staggered-did-biases.html#cb776-19" tabindex="-1"></a></span>
<span id="cb776-20"><a href="remedies-for-staggered-did-biases.html#cb776-20" tabindex="-1"></a><span class="co"># use conditional method</span></span>
<span id="cb776-21"><a href="remedies-for-staggered-did-biases.html#cb776-21" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb776-22"><a href="remedies-for-staggered-did-biases.html#cb776-22" tabindex="-1"></a>    <span class="at">sets             =</span> PM.results.ps.weight,</span>
<span id="cb776-23"><a href="remedies-for-staggered-did-biases.html#cb776-23" tabindex="-1"></a>    <span class="at">data             =</span> dem,</span>
<span id="cb776-24"><a href="remedies-for-staggered-did-biases.html#cb776-24" tabindex="-1"></a>    <span class="at">se.method        =</span> <span class="st">&quot;conditional&quot;</span>,</span>
<span id="cb776-25"><a href="remedies-for-staggered-did-biases.html#cb776-25" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb776-26"><a href="remedies-for-staggered-did-biases.html#cb776-26" tabindex="-1"></a>)</span>
<span id="cb776-27"><a href="remedies-for-staggered-did-biases.html#cb776-27" tabindex="-1"></a></span>
<span id="cb776-28"><a href="remedies-for-staggered-did-biases.html#cb776-28" tabindex="-1"></a><span class="co"># point estimates</span></span>
<span id="cb776-29"><a href="remedies-for-staggered-did-biases.html#cb776-29" tabindex="-1"></a>PE.results[[<span class="st">&quot;estimates&quot;</span>]]</span>
<span id="cb776-30"><a href="remedies-for-staggered-did-biases.html#cb776-30" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb776-31"><a href="remedies-for-staggered-did-biases.html#cb776-31" tabindex="-1"></a><span class="co">#&gt; 0.2609565 0.9630847 1.2851017 1.7370930 1.4871846</span></span>
<span id="cb776-32"><a href="remedies-for-staggered-did-biases.html#cb776-32" tabindex="-1"></a></span>
<span id="cb776-33"><a href="remedies-for-staggered-did-biases.html#cb776-33" tabindex="-1"></a><span class="co"># standard errors</span></span>
<span id="cb776-34"><a href="remedies-for-staggered-did-biases.html#cb776-34" tabindex="-1"></a>PE.results[[<span class="st">&quot;standard.error&quot;</span>]]</span>
<span id="cb776-35"><a href="remedies-for-staggered-did-biases.html#cb776-35" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb776-36"><a href="remedies-for-staggered-did-biases.html#cb776-36" tabindex="-1"></a><span class="co">#&gt; 0.4844805 0.8170604 1.1171942 1.4116879 1.7172143</span></span>
<span id="cb776-37"><a href="remedies-for-staggered-did-biases.html#cb776-37" tabindex="-1"></a></span>
<span id="cb776-38"><a href="remedies-for-staggered-did-biases.html#cb776-38" tabindex="-1"></a><span class="fu">summary</span>(PE.results)</span>
<span id="cb776-39"><a href="remedies-for-staggered-did-biases.html#cb776-39" tabindex="-1"></a><span class="co">#&gt; Weighted Difference-in-Differences with Propensity Score</span></span>
<span id="cb776-40"><a href="remedies-for-staggered-did-biases.html#cb776-40" tabindex="-1"></a><span class="co">#&gt; Matches created with 4 lags</span></span>
<span id="cb776-41"><a href="remedies-for-staggered-did-biases.html#cb776-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb776-42"><a href="remedies-for-staggered-did-biases.html#cb776-42" tabindex="-1"></a><span class="co">#&gt; Standard errors computed with conditional method</span></span>
<span id="cb776-43"><a href="remedies-for-staggered-did-biases.html#cb776-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb776-44"><a href="remedies-for-staggered-did-biases.html#cb776-44" tabindex="-1"></a><span class="co">#&gt; Estimate of Average Treatment Effect on the Treated (ATT) by Period:</span></span>
<span id="cb776-45"><a href="remedies-for-staggered-did-biases.html#cb776-45" tabindex="-1"></a><span class="co">#&gt; $summary</span></span>
<span id="cb776-46"><a href="remedies-for-staggered-did-biases.html#cb776-46" tabindex="-1"></a><span class="co">#&gt;      estimate std.error       2.5%    97.5%</span></span>
<span id="cb776-47"><a href="remedies-for-staggered-did-biases.html#cb776-47" tabindex="-1"></a><span class="co">#&gt; t+0 0.2609565 0.4844805 -0.6886078 1.210521</span></span>
<span id="cb776-48"><a href="remedies-for-staggered-did-biases.html#cb776-48" tabindex="-1"></a><span class="co">#&gt; t+1 0.9630847 0.8170604 -0.6383243 2.564494</span></span>
<span id="cb776-49"><a href="remedies-for-staggered-did-biases.html#cb776-49" tabindex="-1"></a><span class="co">#&gt; t+2 1.2851017 1.1171942 -0.9045586 3.474762</span></span>
<span id="cb776-50"><a href="remedies-for-staggered-did-biases.html#cb776-50" tabindex="-1"></a><span class="co">#&gt; t+3 1.7370930 1.4116879 -1.0297644 4.503950</span></span>
<span id="cb776-51"><a href="remedies-for-staggered-did-biases.html#cb776-51" tabindex="-1"></a><span class="co">#&gt; t+4 1.4871846 1.7172143 -1.8784937 4.852863</span></span>
<span id="cb776-52"><a href="remedies-for-staggered-did-biases.html#cb776-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb776-53"><a href="remedies-for-staggered-did-biases.html#cb776-53" tabindex="-1"></a><span class="co">#&gt; $lag</span></span>
<span id="cb776-54"><a href="remedies-for-staggered-did-biases.html#cb776-54" tabindex="-1"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb776-55"><a href="remedies-for-staggered-did-biases.html#cb776-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb776-56"><a href="remedies-for-staggered-did-biases.html#cb776-56" tabindex="-1"></a><span class="co">#&gt; $qoi</span></span>
<span id="cb776-57"><a href="remedies-for-staggered-did-biases.html#cb776-57" tabindex="-1"></a><span class="co">#&gt; [1] &quot;att&quot;</span></span>
<span id="cb776-58"><a href="remedies-for-staggered-did-biases.html#cb776-58" tabindex="-1"></a></span>
<span id="cb776-59"><a href="remedies-for-staggered-did-biases.html#cb776-59" tabindex="-1"></a><span class="fu">plot</span>(PE.results)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-17-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Moderating Variables</strong></p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="remedies-for-staggered-did-biases.html#cb777-1" tabindex="-1"></a><span class="co"># moderating variable</span></span>
<span id="cb777-2"><a href="remedies-for-staggered-did-biases.html#cb777-2" tabindex="-1"></a>dem<span class="sc">$</span>moderator <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb777-3"><a href="remedies-for-staggered-did-biases.html#cb777-3" tabindex="-1"></a>dem<span class="sc">$</span>moderator <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dem<span class="sc">$</span>wbcode2 <span class="sc">&gt;</span> <span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb777-4"><a href="remedies-for-staggered-did-biases.html#cb777-4" tabindex="-1"></a></span>
<span id="cb777-5"><a href="remedies-for-staggered-did-biases.html#cb777-5" tabindex="-1"></a>PM.results <span class="ot">&lt;-</span></span>
<span id="cb777-6"><a href="remedies-for-staggered-did-biases.html#cb777-6" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb777-7"><a href="remedies-for-staggered-did-biases.html#cb777-7" tabindex="-1"></a>        <span class="at">lag                          =</span> <span class="dv">4</span>,</span>
<span id="cb777-8"><a href="remedies-for-staggered-did-biases.html#cb777-8" tabindex="-1"></a>        <span class="at">time.id                      =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb777-9"><a href="remedies-for-staggered-did-biases.html#cb777-9" tabindex="-1"></a>        <span class="at">unit.id                      =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb777-10"><a href="remedies-for-staggered-did-biases.html#cb777-10" tabindex="-1"></a>        <span class="at">treatment                    =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb777-11"><a href="remedies-for-staggered-did-biases.html#cb777-11" tabindex="-1"></a>        <span class="at">refinement.method            =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb777-12"><a href="remedies-for-staggered-did-biases.html#cb777-12" tabindex="-1"></a>        <span class="at">data                         =</span> dem,</span>
<span id="cb777-13"><a href="remedies-for-staggered-did-biases.html#cb777-13" tabindex="-1"></a>        <span class="at">match.missing                =</span> <span class="cn">TRUE</span>,</span>
<span id="cb777-14"><a href="remedies-for-staggered-did-biases.html#cb777-14" tabindex="-1"></a>        <span class="at">covs.formula                 =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb777-15"><a href="remedies-for-staggered-did-biases.html#cb777-15" tabindex="-1"></a>        <span class="at">size.match                   =</span> <span class="dv">5</span>,</span>
<span id="cb777-16"><a href="remedies-for-staggered-did-biases.html#cb777-16" tabindex="-1"></a>        <span class="at">qoi                          =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb777-17"><a href="remedies-for-staggered-did-biases.html#cb777-17" tabindex="-1"></a>        <span class="at">outcome.var                  =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb777-18"><a href="remedies-for-staggered-did-biases.html#cb777-18" tabindex="-1"></a>        <span class="at">lead                         =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb777-19"><a href="remedies-for-staggered-did-biases.html#cb777-19" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal    =</span> <span class="cn">FALSE</span>,</span>
<span id="cb777-20"><a href="remedies-for-staggered-did-biases.html#cb777-20" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb777-21"><a href="remedies-for-staggered-did-biases.html#cb777-21" tabindex="-1"></a>    )</span>
<span id="cb777-22"><a href="remedies-for-staggered-did-biases.html#cb777-22" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span></span>
<span id="cb777-23"><a href="remedies-for-staggered-did-biases.html#cb777-23" tabindex="-1"></a>    <span class="fu">PanelEstimate</span>(<span class="at">sets      =</span> PM.results,</span>
<span id="cb777-24"><a href="remedies-for-staggered-did-biases.html#cb777-24" tabindex="-1"></a>                  <span class="at">data      =</span> dem,</span>
<span id="cb777-25"><a href="remedies-for-staggered-did-biases.html#cb777-25" tabindex="-1"></a>                  <span class="at">moderator =</span> <span class="st">&quot;moderator&quot;</span>)</span>
<span id="cb777-26"><a href="remedies-for-staggered-did-biases.html#cb777-26" tabindex="-1"></a></span>
<span id="cb777-27"><a href="remedies-for-staggered-did-biases.html#cb777-27" tabindex="-1"></a><span class="co"># Each element in the list corresponds to a level in the moderator</span></span>
<span id="cb777-28"><a href="remedies-for-staggered-did-biases.html#cb777-28" tabindex="-1"></a><span class="fu">plot</span>(PE.results[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-18-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="remedies-for-staggered-did-biases.html#cb778-1" tabindex="-1"></a></span>
<span id="cb778-2"><a href="remedies-for-staggered-did-biases.html#cb778-2" tabindex="-1"></a><span class="fu">plot</span>(PE.results[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-18-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>To write up for journal submission, you can follow the following report:</p>
<p>In this study, closely aligned with the research by <span class="citation">(<a href="#ref-acemoglu2019democracy">Acemoglu et al. 2019</a>)</span>, two key effects of democracy on economic growth are estimated: the impact of democratization and that of authoritarian reversal. The treatment variable, <span class="math inline">\(X_{it}\)</span>, is defined to be one if country <span class="math inline">\(i\)</span> is democratic in year <span class="math inline">\(t\)</span>, and zero otherwise.</p>
<p>The Average Treatment Effect for the Treated (ATT) under democratization is formulated as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\delta(F, L) &amp;= \mathbb{E} \left\{ Y_{i, t + F} (X_{it} = 1, X_{i, t - 1} = 0, \{X_{i,t-l}\}_{l=2}^L) \right. \\
&amp;\left. - Y_{i, t + F} (X_{it} = 0, X_{i, t - 1} = 0, \{X_{i,t-l}\}_{l=2}^L) | X_{it} = 1, X_{i, t - 1} = 0 \right\}
\end{aligned}
\]</span></p>
<p>In this framework, the treated observations are countries that transition from an authoritarian regime <span class="math inline">\(X_{it-1} = 0\)</span> to a democratic one <span class="math inline">\(X_{it} = 1\)</span>. The variable <span class="math inline">\(F\)</span> represents the number of leads, denoting the time periods following the treatment, and <span class="math inline">\(L\)</span> signifies the number of lags, indicating the time periods preceding the treatment.</p>
<p>The ATT under authoritarian reversal is given by:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathbb{E} \left[ Y_{i, t + F} (X_{it} = 0, X_{i, t - 1} = 1, \{ X_{i, t - l}\}_{l=2}^L ) \right. \\
&amp;\left. - Y_{i, t + F} (X_{it} = 1, X_{it-1} = 1, \{X_{i, t - l} \}_{l=2}^L ) | X_{it} = 0, X_{i, t - 1} = 1 \right]
\end{aligned}
\]</span></p>
<p>The ATT is calculated conditioning on 4 years of lags (<span class="math inline">\(L = 4\)</span>) and up to 4 years following the policy change <span class="math inline">\(F = 1, 2, 3, 4\)</span>. Matched sets for each treated observation are constructed based on its treatment history, with the number of matched control units generally decreasing when considering a 4-year treatment history as compared to a 1-year history.</p>
<p>To enhance the quality of matched sets, methods such as Mahalanobis distance matching, propensity score matching, and propensity score weighting are utilized. These approaches enable us to evaluate the effectiveness of each refinement method. In the process of matching, we employ both up-to-five and up-to-ten matching to investigate how sensitive our empirical results are to the maximum number of allowed matches. For more information on the refinement process, please see the Web Appendix</p>
<blockquote>
<p>The Mahalanobis distance is expressed through a specific formula. We aim to pair each treated unit with a maximum of <span class="math inline">\(J\)</span> control units, permitting replacement, denoted as <span class="math inline">\(| \mathcal{M}_{it} \le J|\)</span>. The average Mahalanobis distance between a treated and each control unit over time is computed as:</p>
<p><span class="math display">\[ S_{it} (i&#39;) = \frac{1}{L} \sum_{l = 1}^L \sqrt{(\mathbf{V}_{i, t - l} - \mathbf{V}_{i&#39;, t -l})^T \mathbf{\Sigma}_{i, t - l}^{-1} (\mathbf{V}_{i, t - l} - \mathbf{V}_{i&#39;, t -l})} \]</span></p>
<p>For a matched control unit <span class="math inline">\(i&#39; \in \mathcal{M}_{it}\)</span>, <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span> represents the time-varying covariates to adjust for, and <span class="math inline">\(\mathbf{\Sigma}_{it&#39;}\)</span> is the sample covariance matrix for <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span>. Essentially, we calculate a standardized distance using time-varying covariates and average this across different time intervals.</p>
<p>In the context of propensity score matching, we employ a logistic regression model with balanced covariates to derive the propensity score. Defined as the conditional likelihood of treatment given pre-treatment covariates <span class="citation">(<a href="#ref-rosenbaum1983central">Rosenbaum and Rubin 1983</a>)</span>, the propensity score is estimated by first creating a data subset comprised of all treated and their matched control units from the same year. This logistic regression model is then fitted as follows:</p>
<p><span class="math display">\[ \begin{aligned} &amp; e_{it} (\{\mathbf{U}_{i, t - l} \}^L_{l = 1}) \\ &amp;= Pr(X_{it} = 1| \mathbf{U}_{i, t -1}, \ldots, \mathbf{U}_{i, t - L}) \\ &amp;= \frac{1}{1 = \exp(- \sum_{l = 1}^L \beta_l^T \mathbf{U}_{i, t - l})} \end{aligned} \]</span></p>
<p>where <span class="math inline">\(\mathbf{U}_{it&#39;} = (X_{it&#39;}, \mathbf{V}_{it&#39;}^T)^T\)</span>. Given this model, the estimated propensity score for all treated and matched control units is then computed. This enables the adjustment for lagged covariates via matching on the calculated propensity score, resulting in the following distance measure:</p>
<p><span class="math display">\[ S_{it} (i&#39;) = | \text{logit} \{ \hat{e}_{it} (\{ \mathbf{U}_{i, t - l}\}^L_{l = 1})\} - \text{logit} \{ \hat{e}_{i&#39;t}( \{ \mathbf{U}_{i&#39;, t - l} \}^L_{l = 1})\} | \]</span></p>
<p>Here, <span class="math inline">\(\hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t - l}\}^L_{l = 1})\)</span> represents the estimated propensity score for each matched control unit <span class="math inline">\(i&#39; \in \mathcal{M}_{it}\)</span>.</p>
<p>Once the distance measure <span class="math inline">\(S_{it} (i&#39;)\)</span> has been determined for all control units in the original matched set, we fine-tune this set by selecting up to <span class="math inline">\(J\)</span> closest control units, which meet a researcher-defined caliper constraint <span class="math inline">\(C\)</span>. All other control units receive zero weight. This results in a refined matched set for each treated unit <span class="math inline">\((i, t)\)</span>:</p>
<p><span class="math display">\[ \mathcal{M}_{it}^* = \{i&#39; : i&#39; \in \mathcal{M}_{it}, S_{it} (i&#39;) &lt; C, S_{it} \le S_{it}^{(J)}\} \]</span></p>
<p><span class="math inline">\(S_{it}^{(J)}\)</span> is the <span class="math inline">\(J\)</span>th smallest distance among the control units in the original set <span class="math inline">\(\mathcal{M}_{it}\)</span>.</p>
<p>For further refinement using weighting, a weight is assigned to each control unit <span class="math inline">\(i&#39;\)</span> in a matched set corresponding to a treated unit <span class="math inline">\((i, t)\)</span>, with greater weight accorded to more similar units. We utilize inverse propensity score weighting, based on the propensity score model mentioned earlier:</p>
<p><span class="math display">\[ w_{it}^{i&#39;} \propto \frac{\hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t-l} \}^L_{l = 1} )}{1 - \hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t-l} \}^L_{l = 1} )} \]</span></p>
<p>In this model, <span class="math inline">\(\sum_{i&#39; \in \mathcal{M}_{it}} w_{it}^{i&#39;} = 1\)</span> and <span class="math inline">\(w_{it}^{i&#39;} = 0\)</span> for <span class="math inline">\(i&#39; \notin \mathcal{M}_{it}\)</span>. The model is fitted to the complete sample of treated and matched control units.</p>
</blockquote>
<blockquote>
<p>Checking Covariate Balance A distinct advantage of the proposed methodology over regression methods is the ability it offers researchers to inspect the covariate balance between treated and matched control observations. This facilitates the evaluation of whether treated and matched control observations are comparable regarding observed confounders. To investigate the mean difference of each covariate (e.g., <span class="math inline">\(V_{it&#39;j}\)</span>, representing the <span class="math inline">\(j\)</span>-th variable in <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span>) between the treated observation and its matched control observation at each pre-treatment time period (i.e., <span class="math inline">\(t&#39; &lt; t\)</span>), we further standardize this difference. For any given pretreatment time period, we adjust by the standard deviation of each covariate across all treated observations in the dataset. Thus, the mean difference is quantified in terms of standard deviation units. Formally, for each treated observation <span class="math inline">\((i,t)\)</span> where <span class="math inline">\(D_{it} = 1\)</span>, we define the covariate balance for variable <span class="math inline">\(j\)</span> at the pretreatment time period <span class="math inline">\(t - l\)</span> as: <span class="math display">\[\begin{equation}
B_{it}(j, l) = \frac{V_{i, t- l,j}- \sum_{i&#39; \in \mathcal{M}_{it}}w_{it}^{i&#39;}V_{i&#39;, t-l,j}}{\sqrt{\frac{1}{N_1 - 1} \sum_{i&#39;=1}^N \sum_{t&#39; = L+1}^{T-F}D_{i&#39;t&#39;}(V_{i&#39;, t&#39;-l, j} - \bar{V}_{t&#39; - l, j})^2}}
\label{eq:covbalance}
\end{equation}\]</span> where <span class="math inline">\(N_1 = \sum_{i&#39;= 1}^N \sum_{t&#39; = L+1}^{T-F} D_{i&#39;t&#39;}\)</span> denotes the total number of treated observations and <span class="math inline">\(\bar{V}_{t-l,j} = \sum_{i=1}^N D_{i,t-l,j}/N\)</span>. We then aggregate this covariate balance measure across all treated observations for each covariate and pre-treatment time period:</p>
</blockquote>
<span class="math display">\[\begin{equation}
\bar{B}(j, l) = \frac{1}{N_1} \sum_{i=1}^N \sum_{t = L+ 1}^{T-F}D_{it} B_{it}(j,l)
\label{eq:aggbalance}
\end{equation}\]</span>
<blockquote>
<p>Lastly, we evaluate the balance of lagged outcome variables over several pre-treatment periods and that of time-varying covariates. This examination aids in assessing the validity of the parallel trend assumption integral to the DiD estimator justification.</p>
</blockquote>
<p>In Figure for balance scatter, we demonstrate the enhancement of covariate balance thank to the refinement of matched sets. Each scatter plot contrasts the absolute standardized mean difference, as detailed in Equation <a href="#eq:aggbalance">(<strong>??</strong>)</a>, before (horizontal axis) and after (vertical axis) this refinement. Points below the 45-degree line indicate an improved standardized mean balance for certain time-varying covariates post-refinement. The majority of variables benefit from this refinement process. Notably, the propensity score weighting (bottom panel) shows the most significant improvement, whereas Mahalanobis matching (top panel) yields a more modest improvement.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="remedies-for-staggered-did-biases.html#cb779-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span>
<span id="cb779-2"><a href="remedies-for-staggered-did-biases.html#cb779-2" tabindex="-1"></a><span class="fu">library</span>(causalverse)</span>
<span id="cb779-3"><a href="remedies-for-staggered-did-biases.html#cb779-3" tabindex="-1"></a></span>
<span id="cb779-4"><a href="remedies-for-staggered-did-biases.html#cb779-4" tabindex="-1"></a>runPanelMatch <span class="ot">&lt;-</span> <span class="cf">function</span>(method, lag, <span class="at">size.match=</span><span class="cn">NULL</span>, <span class="at">qoi=</span><span class="st">&quot;att&quot;</span>) {</span>
<span id="cb779-5"><a href="remedies-for-staggered-did-biases.html#cb779-5" tabindex="-1"></a>    </span>
<span id="cb779-6"><a href="remedies-for-staggered-did-biases.html#cb779-6" tabindex="-1"></a>    <span class="co"># Default parameters for PanelMatch</span></span>
<span id="cb779-7"><a href="remedies-for-staggered-did-biases.html#cb779-7" tabindex="-1"></a>    common.args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb779-8"><a href="remedies-for-staggered-did-biases.html#cb779-8" tabindex="-1"></a>        <span class="at">lag =</span> lag,</span>
<span id="cb779-9"><a href="remedies-for-staggered-did-biases.html#cb779-9" tabindex="-1"></a>        <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb779-10"><a href="remedies-for-staggered-did-biases.html#cb779-10" tabindex="-1"></a>        <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb779-11"><a href="remedies-for-staggered-did-biases.html#cb779-11" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb779-12"><a href="remedies-for-staggered-did-biases.html#cb779-12" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb779-13"><a href="remedies-for-staggered-did-biases.html#cb779-13" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb779-14"><a href="remedies-for-staggered-did-biases.html#cb779-14" tabindex="-1"></a>        <span class="at">qoi =</span> qoi,</span>
<span id="cb779-15"><a href="remedies-for-staggered-did-biases.html#cb779-15" tabindex="-1"></a>        <span class="at">outcome.var =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb779-16"><a href="remedies-for-staggered-did-biases.html#cb779-16" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb779-17"><a href="remedies-for-staggered-did-biases.html#cb779-17" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb779-18"><a href="remedies-for-staggered-did-biases.html#cb779-18" tabindex="-1"></a>        <span class="at">size.match =</span> size.match  <span class="co"># setting size.match here for all methods</span></span>
<span id="cb779-19"><a href="remedies-for-staggered-did-biases.html#cb779-19" tabindex="-1"></a>    )</span>
<span id="cb779-20"><a href="remedies-for-staggered-did-biases.html#cb779-20" tabindex="-1"></a>    </span>
<span id="cb779-21"><a href="remedies-for-staggered-did-biases.html#cb779-21" tabindex="-1"></a>    <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;mahalanobis&quot;</span>) {</span>
<span id="cb779-22"><a href="remedies-for-staggered-did-biases.html#cb779-22" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;mahalanobis&quot;</span></span>
<span id="cb779-23"><a href="remedies-for-staggered-did-biases.html#cb779-23" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb779-24"><a href="remedies-for-staggered-did-biases.html#cb779-24" tabindex="-1"></a>        common.args<span class="sc">$</span>use.diagonal.variance.matrix <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb779-25"><a href="remedies-for-staggered-did-biases.html#cb779-25" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;ps.match&quot;</span>) {</span>
<span id="cb779-26"><a href="remedies-for-staggered-did-biases.html#cb779-26" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;ps.match&quot;</span></span>
<span id="cb779-27"><a href="remedies-for-staggered-did-biases.html#cb779-27" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb779-28"><a href="remedies-for-staggered-did-biases.html#cb779-28" tabindex="-1"></a>        common.args<span class="sc">$</span>listwise.delete <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb779-29"><a href="remedies-for-staggered-did-biases.html#cb779-29" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;ps.weight&quot;</span>) {</span>
<span id="cb779-30"><a href="remedies-for-staggered-did-biases.html#cb779-30" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;ps.weight&quot;</span></span>
<span id="cb779-31"><a href="remedies-for-staggered-did-biases.html#cb779-31" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb779-32"><a href="remedies-for-staggered-did-biases.html#cb779-32" tabindex="-1"></a>        common.args<span class="sc">$</span>listwise.delete <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb779-33"><a href="remedies-for-staggered-did-biases.html#cb779-33" tabindex="-1"></a>    }</span>
<span id="cb779-34"><a href="remedies-for-staggered-did-biases.html#cb779-34" tabindex="-1"></a>    </span>
<span id="cb779-35"><a href="remedies-for-staggered-did-biases.html#cb779-35" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">do.call</span>(PanelMatch, common.args))</span>
<span id="cb779-36"><a href="remedies-for-staggered-did-biases.html#cb779-36" tabindex="-1"></a>}</span>
<span id="cb779-37"><a href="remedies-for-staggered-did-biases.html#cb779-37" tabindex="-1"></a></span>
<span id="cb779-38"><a href="remedies-for-staggered-did-biases.html#cb779-38" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mahalanobis&quot;</span>, <span class="st">&quot;ps.match&quot;</span>, <span class="st">&quot;ps.weight&quot;</span>)</span>
<span id="cb779-39"><a href="remedies-for-staggered-did-biases.html#cb779-39" tabindex="-1"></a>lags <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb779-40"><a href="remedies-for-staggered-did-biases.html#cb779-40" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p>You can either do it sequentailly</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="remedies-for-staggered-did-biases.html#cb780-1" tabindex="-1"></a>res_pm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb780-2"><a href="remedies-for-staggered-did-biases.html#cb780-2" tabindex="-1"></a></span>
<span id="cb780-3"><a href="remedies-for-staggered-did-biases.html#cb780-3" tabindex="-1"></a><span class="cf">for</span>(method <span class="cf">in</span> methods) {</span>
<span id="cb780-4"><a href="remedies-for-staggered-did-biases.html#cb780-4" tabindex="-1"></a>    <span class="cf">for</span>(lag <span class="cf">in</span> lags) {</span>
<span id="cb780-5"><a href="remedies-for-staggered-did-biases.html#cb780-5" tabindex="-1"></a>        <span class="cf">for</span>(size <span class="cf">in</span> sizes) {</span>
<span id="cb780-6"><a href="remedies-for-staggered-did-biases.html#cb780-6" tabindex="-1"></a>            name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb780-7"><a href="remedies-for-staggered-did-biases.html#cb780-7" tabindex="-1"></a>            res_pm[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size)</span>
<span id="cb780-8"><a href="remedies-for-staggered-did-biases.html#cb780-8" tabindex="-1"></a>        }</span>
<span id="cb780-9"><a href="remedies-for-staggered-did-biases.html#cb780-9" tabindex="-1"></a>    }</span>
<span id="cb780-10"><a href="remedies-for-staggered-did-biases.html#cb780-10" tabindex="-1"></a>}</span>
<span id="cb780-11"><a href="remedies-for-staggered-did-biases.html#cb780-11" tabindex="-1"></a></span>
<span id="cb780-12"><a href="remedies-for-staggered-did-biases.html#cb780-12" tabindex="-1"></a><span class="co"># Now, you can access res_pm using res_pm[[&quot;mahalanobis.1lag.5m&quot;]] etc.</span></span>
<span id="cb780-13"><a href="remedies-for-staggered-did-biases.html#cb780-13" tabindex="-1"></a></span>
<span id="cb780-14"><a href="remedies-for-staggered-did-biases.html#cb780-14" tabindex="-1"></a><span class="co"># for treatment reversal</span></span>
<span id="cb780-15"><a href="remedies-for-staggered-did-biases.html#cb780-15" tabindex="-1"></a>res_pm_rev <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb780-16"><a href="remedies-for-staggered-did-biases.html#cb780-16" tabindex="-1"></a></span>
<span id="cb780-17"><a href="remedies-for-staggered-did-biases.html#cb780-17" tabindex="-1"></a><span class="cf">for</span>(method <span class="cf">in</span> methods) {</span>
<span id="cb780-18"><a href="remedies-for-staggered-did-biases.html#cb780-18" tabindex="-1"></a>    <span class="cf">for</span>(lag <span class="cf">in</span> lags) {</span>
<span id="cb780-19"><a href="remedies-for-staggered-did-biases.html#cb780-19" tabindex="-1"></a>        <span class="cf">for</span>(size <span class="cf">in</span> sizes) {</span>
<span id="cb780-20"><a href="remedies-for-staggered-did-biases.html#cb780-20" tabindex="-1"></a>            name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb780-21"><a href="remedies-for-staggered-did-biases.html#cb780-21" tabindex="-1"></a>            res_pm_rev[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb780-22"><a href="remedies-for-staggered-did-biases.html#cb780-22" tabindex="-1"></a>        }</span>
<span id="cb780-23"><a href="remedies-for-staggered-did-biases.html#cb780-23" tabindex="-1"></a>    }</span>
<span id="cb780-24"><a href="remedies-for-staggered-did-biases.html#cb780-24" tabindex="-1"></a>}</span></code></pre></div>
<p>or in parallel</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="remedies-for-staggered-did-biases.html#cb781-1" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb781-2"><a href="remedies-for-staggered-did-biases.html#cb781-2" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb781-3"><a href="remedies-for-staggered-did-biases.html#cb781-3" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb781-4"><a href="remedies-for-staggered-did-biases.html#cb781-4" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb781-5"><a href="remedies-for-staggered-did-biases.html#cb781-5" tabindex="-1"></a>res_pm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb781-6"><a href="remedies-for-staggered-did-biases.html#cb781-6" tabindex="-1"></a></span>
<span id="cb781-7"><a href="remedies-for-staggered-did-biases.html#cb781-7" tabindex="-1"></a><span class="co"># Replace nested for-loops with foreach</span></span>
<span id="cb781-8"><a href="remedies-for-staggered-did-biases.html#cb781-8" tabindex="-1"></a>results <span class="ot">&lt;-</span></span>
<span id="cb781-9"><a href="remedies-for-staggered-did-biases.html#cb781-9" tabindex="-1"></a>  <span class="fu">foreach</span>(</span>
<span id="cb781-10"><a href="remedies-for-staggered-did-biases.html#cb781-10" tabindex="-1"></a>    <span class="at">method =</span> methods,</span>
<span id="cb781-11"><a href="remedies-for-staggered-did-biases.html#cb781-11" tabindex="-1"></a>    <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span>,</span>
<span id="cb781-12"><a href="remedies-for-staggered-did-biases.html#cb781-12" tabindex="-1"></a>    <span class="at">.multicombine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb781-13"><a href="remedies-for-staggered-did-biases.html#cb781-13" tabindex="-1"></a>    <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>)</span>
<span id="cb781-14"><a href="remedies-for-staggered-did-biases.html#cb781-14" tabindex="-1"></a>  ) <span class="sc">%dopar%</span> {</span>
<span id="cb781-15"><a href="remedies-for-staggered-did-biases.html#cb781-15" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb781-16"><a href="remedies-for-staggered-did-biases.html#cb781-16" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb781-17"><a href="remedies-for-staggered-did-biases.html#cb781-17" tabindex="-1"></a>      <span class="cf">for</span> (size <span class="cf">in</span> sizes) {</span>
<span id="cb781-18"><a href="remedies-for-staggered-did-biases.html#cb781-18" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb781-19"><a href="remedies-for-staggered-did-biases.html#cb781-19" tabindex="-1"></a>        tmp[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size)</span>
<span id="cb781-20"><a href="remedies-for-staggered-did-biases.html#cb781-20" tabindex="-1"></a>      }</span>
<span id="cb781-21"><a href="remedies-for-staggered-did-biases.html#cb781-21" tabindex="-1"></a>    }</span>
<span id="cb781-22"><a href="remedies-for-staggered-did-biases.html#cb781-22" tabindex="-1"></a>    tmp</span>
<span id="cb781-23"><a href="remedies-for-staggered-did-biases.html#cb781-23" tabindex="-1"></a>  }</span>
<span id="cb781-24"><a href="remedies-for-staggered-did-biases.html#cb781-24" tabindex="-1"></a></span>
<span id="cb781-25"><a href="remedies-for-staggered-did-biases.html#cb781-25" tabindex="-1"></a><span class="co"># Collate results</span></span>
<span id="cb781-26"><a href="remedies-for-staggered-did-biases.html#cb781-26" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(results)) {</span>
<span id="cb781-27"><a href="remedies-for-staggered-did-biases.html#cb781-27" tabindex="-1"></a>  res_pm[[name]] <span class="ot">&lt;-</span> results[[name]]</span>
<span id="cb781-28"><a href="remedies-for-staggered-did-biases.html#cb781-28" tabindex="-1"></a>}</span>
<span id="cb781-29"><a href="remedies-for-staggered-did-biases.html#cb781-29" tabindex="-1"></a></span>
<span id="cb781-30"><a href="remedies-for-staggered-did-biases.html#cb781-30" tabindex="-1"></a><span class="co"># Treatment reversal</span></span>
<span id="cb781-31"><a href="remedies-for-staggered-did-biases.html#cb781-31" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb781-32"><a href="remedies-for-staggered-did-biases.html#cb781-32" tabindex="-1"></a>res_pm_rev <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb781-33"><a href="remedies-for-staggered-did-biases.html#cb781-33" tabindex="-1"></a></span>
<span id="cb781-34"><a href="remedies-for-staggered-did-biases.html#cb781-34" tabindex="-1"></a><span class="co"># Replace nested for-loops with foreach</span></span>
<span id="cb781-35"><a href="remedies-for-staggered-did-biases.html#cb781-35" tabindex="-1"></a>results_rev <span class="ot">&lt;-</span></span>
<span id="cb781-36"><a href="remedies-for-staggered-did-biases.html#cb781-36" tabindex="-1"></a>  <span class="fu">foreach</span>(</span>
<span id="cb781-37"><a href="remedies-for-staggered-did-biases.html#cb781-37" tabindex="-1"></a>    <span class="at">method =</span> methods,</span>
<span id="cb781-38"><a href="remedies-for-staggered-did-biases.html#cb781-38" tabindex="-1"></a>    <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span>,</span>
<span id="cb781-39"><a href="remedies-for-staggered-did-biases.html#cb781-39" tabindex="-1"></a>    <span class="at">.multicombine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb781-40"><a href="remedies-for-staggered-did-biases.html#cb781-40" tabindex="-1"></a>    <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>)</span>
<span id="cb781-41"><a href="remedies-for-staggered-did-biases.html#cb781-41" tabindex="-1"></a>  ) <span class="sc">%dopar%</span> {</span>
<span id="cb781-42"><a href="remedies-for-staggered-did-biases.html#cb781-42" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb781-43"><a href="remedies-for-staggered-did-biases.html#cb781-43" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb781-44"><a href="remedies-for-staggered-did-biases.html#cb781-44" tabindex="-1"></a>      <span class="cf">for</span> (size <span class="cf">in</span> sizes) {</span>
<span id="cb781-45"><a href="remedies-for-staggered-did-biases.html#cb781-45" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb781-46"><a href="remedies-for-staggered-did-biases.html#cb781-46" tabindex="-1"></a>        tmp[[name]] <span class="ot">&lt;-</span></span>
<span id="cb781-47"><a href="remedies-for-staggered-did-biases.html#cb781-47" tabindex="-1"></a>          <span class="fu">runPanelMatch</span>(method, lag, size, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb781-48"><a href="remedies-for-staggered-did-biases.html#cb781-48" tabindex="-1"></a>      }</span>
<span id="cb781-49"><a href="remedies-for-staggered-did-biases.html#cb781-49" tabindex="-1"></a>    }</span>
<span id="cb781-50"><a href="remedies-for-staggered-did-biases.html#cb781-50" tabindex="-1"></a>    tmp</span>
<span id="cb781-51"><a href="remedies-for-staggered-did-biases.html#cb781-51" tabindex="-1"></a>  }</span>
<span id="cb781-52"><a href="remedies-for-staggered-did-biases.html#cb781-52" tabindex="-1"></a></span>
<span id="cb781-53"><a href="remedies-for-staggered-did-biases.html#cb781-53" tabindex="-1"></a><span class="co"># Collate results</span></span>
<span id="cb781-54"><a href="remedies-for-staggered-did-biases.html#cb781-54" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(results_rev)) {</span>
<span id="cb781-55"><a href="remedies-for-staggered-did-biases.html#cb781-55" tabindex="-1"></a>  res_pm_rev[[name]] <span class="ot">&lt;-</span> results_rev[[name]]</span>
<span id="cb781-56"><a href="remedies-for-staggered-did-biases.html#cb781-56" tabindex="-1"></a>}</span>
<span id="cb781-57"><a href="remedies-for-staggered-did-biases.html#cb781-57" tabindex="-1"></a></span>
<span id="cb781-58"><a href="remedies-for-staggered-did-biases.html#cb781-58" tabindex="-1"></a></span>
<span id="cb781-59"><a href="remedies-for-staggered-did-biases.html#cb781-59" tabindex="-1"></a><span class="fu">stopImplicitCluster</span>()</span></code></pre></div>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="remedies-for-staggered-did-biases.html#cb782-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb782-2"><a href="remedies-for-staggered-did-biases.html#cb782-2" tabindex="-1"></a></span>
<span id="cb782-3"><a href="remedies-for-staggered-did-biases.html#cb782-3" tabindex="-1"></a><span class="co"># Updated plotting function</span></span>
<span id="cb782-4"><a href="remedies-for-staggered-did-biases.html#cb782-4" tabindex="-1"></a>create_balance_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(method, lag, sizes, res_pm, dem) {</span>
<span id="cb782-5"><a href="remedies-for-staggered-did-biases.html#cb782-5" tabindex="-1"></a>    matched_set_lists <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sizes, <span class="cf">function</span>(size) {</span>
<span id="cb782-6"><a href="remedies-for-staggered-did-biases.html#cb782-6" tabindex="-1"></a>        res_pm[[<span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)]]<span class="sc">$</span>att</span>
<span id="cb782-7"><a href="remedies-for-staggered-did-biases.html#cb782-7" tabindex="-1"></a>    })</span>
<span id="cb782-8"><a href="remedies-for-staggered-did-biases.html#cb782-8" tabindex="-1"></a>    </span>
<span id="cb782-9"><a href="remedies-for-staggered-did-biases.html#cb782-9" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb782-10"><a href="remedies-for-staggered-did-biases.html#cb782-10" tabindex="-1"></a>        <span class="fu">balance_scatter_custom</span>(</span>
<span id="cb782-11"><a href="remedies-for-staggered-did-biases.html#cb782-11" tabindex="-1"></a>            <span class="at">matched_set_list =</span> matched_set_lists,</span>
<span id="cb782-12"><a href="remedies-for-staggered-did-biases.html#cb782-12" tabindex="-1"></a>            <span class="at">legend.title =</span> <span class="st">&quot;Possible Matches&quot;</span>,</span>
<span id="cb782-13"><a href="remedies-for-staggered-did-biases.html#cb782-13" tabindex="-1"></a>            <span class="at">set.names =</span> <span class="fu">as.character</span>(sizes),</span>
<span id="cb782-14"><a href="remedies-for-staggered-did-biases.html#cb782-14" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>),</span>
<span id="cb782-15"><a href="remedies-for-staggered-did-biases.html#cb782-15" tabindex="-1"></a>            </span>
<span id="cb782-16"><a href="remedies-for-staggered-did-biases.html#cb782-16" tabindex="-1"></a>            <span class="co"># for compiled plot, you don&#39;t need x,y, or main labs</span></span>
<span id="cb782-17"><a href="remedies-for-staggered-did-biases.html#cb782-17" tabindex="-1"></a>            <span class="at">x.axis.label =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb782-18"><a href="remedies-for-staggered-did-biases.html#cb782-18" tabindex="-1"></a>            <span class="at">y.axis.label =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb782-19"><a href="remedies-for-staggered-did-biases.html#cb782-19" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb782-20"><a href="remedies-for-staggered-did-biases.html#cb782-20" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb782-21"><a href="remedies-for-staggered-did-biases.html#cb782-21" tabindex="-1"></a>            <span class="at">dot.size =</span> <span class="dv">5</span>,</span>
<span id="cb782-22"><a href="remedies-for-staggered-did-biases.html#cb782-22" tabindex="-1"></a>            <span class="co"># show.legend = F,</span></span>
<span id="cb782-23"><a href="remedies-for-staggered-did-biases.html#cb782-23" tabindex="-1"></a>            <span class="at">them_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">32</span>),</span>
<span id="cb782-24"><a href="remedies-for-staggered-did-biases.html#cb782-24" tabindex="-1"></a>            <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;tradewb&quot;</span>)</span>
<span id="cb782-25"><a href="remedies-for-staggered-did-biases.html#cb782-25" tabindex="-1"></a>        )</span>
<span id="cb782-26"><a href="remedies-for-staggered-did-biases.html#cb782-26" tabindex="-1"></a>    )</span>
<span id="cb782-27"><a href="remedies-for-staggered-did-biases.html#cb782-27" tabindex="-1"></a>}</span>
<span id="cb782-28"><a href="remedies-for-staggered-did-biases.html#cb782-28" tabindex="-1"></a></span>
<span id="cb782-29"><a href="remedies-for-staggered-did-biases.html#cb782-29" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb782-30"><a href="remedies-for-staggered-did-biases.html#cb782-30" tabindex="-1"></a></span>
<span id="cb782-31"><a href="remedies-for-staggered-did-biases.html#cb782-31" tabindex="-1"></a><span class="cf">for</span> (method <span class="cf">in</span> methods) {</span>
<span id="cb782-32"><a href="remedies-for-staggered-did-biases.html#cb782-32" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb782-33"><a href="remedies-for-staggered-did-biases.html#cb782-33" tabindex="-1"></a>        plots[[<span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag&quot;</span>)]] <span class="ot">&lt;-</span></span>
<span id="cb782-34"><a href="remedies-for-staggered-did-biases.html#cb782-34" tabindex="-1"></a>            <span class="fu">create_balance_plot</span>(method, lag, sizes, res_pm, dem)</span>
<span id="cb782-35"><a href="remedies-for-staggered-did-biases.html#cb782-35" tabindex="-1"></a>    }</span>
<span id="cb782-36"><a href="remedies-for-staggered-did-biases.html#cb782-36" tabindex="-1"></a>}</span>
<span id="cb782-37"><a href="remedies-for-staggered-did-biases.html#cb782-37" tabindex="-1"></a></span>
<span id="cb782-38"><a href="remedies-for-staggered-did-biases.html#cb782-38" tabindex="-1"></a><span class="co"># # Arranging plots in a 3x2 grid</span></span>
<span id="cb782-39"><a href="remedies-for-staggered-did-biases.html#cb782-39" tabindex="-1"></a><span class="co"># grid.arrange(plots[[&quot;mahalanobis.1lag&quot;]],</span></span>
<span id="cb782-40"><a href="remedies-for-staggered-did-biases.html#cb782-40" tabindex="-1"></a><span class="co">#              plots[[&quot;mahalanobis.4lag&quot;]],</span></span>
<span id="cb782-41"><a href="remedies-for-staggered-did-biases.html#cb782-41" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.match.1lag&quot;]],</span></span>
<span id="cb782-42"><a href="remedies-for-staggered-did-biases.html#cb782-42" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.match.4lag&quot;]],</span></span>
<span id="cb782-43"><a href="remedies-for-staggered-did-biases.html#cb782-43" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.weight.1lag&quot;]],</span></span>
<span id="cb782-44"><a href="remedies-for-staggered-did-biases.html#cb782-44" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.weight.4lag&quot;]],</span></span>
<span id="cb782-45"><a href="remedies-for-staggered-did-biases.html#cb782-45" tabindex="-1"></a><span class="co">#              ncol=2, nrow=3)</span></span>
<span id="cb782-46"><a href="remedies-for-staggered-did-biases.html#cb782-46" tabindex="-1"></a></span>
<span id="cb782-47"><a href="remedies-for-staggered-did-biases.html#cb782-47" tabindex="-1"></a></span>
<span id="cb782-48"><a href="remedies-for-staggered-did-biases.html#cb782-48" tabindex="-1"></a><span class="co"># Standardized Mean Difference of Covariates</span></span>
<span id="cb782-49"><a href="remedies-for-staggered-did-biases.html#cb782-49" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb782-50"><a href="remedies-for-staggered-did-biases.html#cb782-50" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb782-51"><a href="remedies-for-staggered-did-biases.html#cb782-51" tabindex="-1"></a></span>
<span id="cb782-52"><a href="remedies-for-staggered-did-biases.html#cb782-52" tabindex="-1"></a><span class="co"># Create column and row labels using textGrob</span></span>
<span id="cb782-53"><a href="remedies-for-staggered-did-biases.html#cb782-53" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1-year Lag&quot;</span>, <span class="st">&quot;4-year Lag&quot;</span>)</span>
<span id="cb782-54"><a href="remedies-for-staggered-did-biases.html#cb782-54" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maha Matching&quot;</span>, <span class="st">&quot;PS Matching&quot;</span>, <span class="st">&quot;PS Weigthing&quot;</span>)</span>
<span id="cb782-55"><a href="remedies-for-staggered-did-biases.html#cb782-55" tabindex="-1"></a></span>
<span id="cb782-56"><a href="remedies-for-staggered-did-biases.html#cb782-56" tabindex="-1"></a>major.axes.fontsize <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb782-57"><a href="remedies-for-staggered-did-biases.html#cb782-57" tabindex="-1"></a>minor.axes.fontsize <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb782-58"><a href="remedies-for-staggered-did-biases.html#cb782-58" tabindex="-1"></a></span>
<span id="cb782-59"><a href="remedies-for-staggered-did-biases.html#cb782-59" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb782-60"><a href="remedies-for-staggered-did-biases.html#cb782-60" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;did_balance_scatter.png&quot;</span>),</span>
<span id="cb782-61"><a href="remedies-for-staggered-did-biases.html#cb782-61" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1200</span>,</span>
<span id="cb782-62"><a href="remedies-for-staggered-did-biases.html#cb782-62" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">1000</span></span>
<span id="cb782-63"><a href="remedies-for-staggered-did-biases.html#cb782-63" tabindex="-1"></a>)</span>
<span id="cb782-64"><a href="remedies-for-staggered-did-biases.html#cb782-64" tabindex="-1"></a></span>
<span id="cb782-65"><a href="remedies-for-staggered-did-biases.html#cb782-65" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb782-66"><a href="remedies-for-staggered-did-biases.html#cb782-66" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb782-67"><a href="remedies-for-staggered-did-biases.html#cb782-67" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb782-68"><a href="remedies-for-staggered-did-biases.html#cb782-68" tabindex="-1"></a>        <span class="fu">nullGrob</span>(),</span>
<span id="cb782-69"><a href="remedies-for-staggered-did-biases.html#cb782-69" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb782-70"><a href="remedies-for-staggered-did-biases.html#cb782-70" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb782-71"><a href="remedies-for-staggered-did-biases.html#cb782-71" tabindex="-1"></a>    ),</span>
<span id="cb782-72"><a href="remedies-for-staggered-did-biases.html#cb782-72" tabindex="-1"></a>    </span>
<span id="cb782-73"><a href="remedies-for-staggered-did-biases.html#cb782-73" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb782-74"><a href="remedies-for-staggered-did-biases.html#cb782-74" tabindex="-1"></a>        row_labels[<span class="dv">1</span>],</span>
<span id="cb782-75"><a href="remedies-for-staggered-did-biases.html#cb782-75" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb782-76"><a href="remedies-for-staggered-did-biases.html#cb782-76" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb782-77"><a href="remedies-for-staggered-did-biases.html#cb782-77" tabindex="-1"></a>    ), plots[[<span class="st">&quot;mahalanobis.1lag&quot;</span>]], plots[[<span class="st">&quot;mahalanobis.4lag&quot;</span>]]),</span>
<span id="cb782-78"><a href="remedies-for-staggered-did-biases.html#cb782-78" tabindex="-1"></a>    </span>
<span id="cb782-79"><a href="remedies-for-staggered-did-biases.html#cb782-79" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb782-80"><a href="remedies-for-staggered-did-biases.html#cb782-80" tabindex="-1"></a>        row_labels[<span class="dv">2</span>],</span>
<span id="cb782-81"><a href="remedies-for-staggered-did-biases.html#cb782-81" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb782-82"><a href="remedies-for-staggered-did-biases.html#cb782-82" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb782-83"><a href="remedies-for-staggered-did-biases.html#cb782-83" tabindex="-1"></a>    ), plots[[<span class="st">&quot;ps.match.1lag&quot;</span>]], plots[[<span class="st">&quot;ps.match.4lag&quot;</span>]]),</span>
<span id="cb782-84"><a href="remedies-for-staggered-did-biases.html#cb782-84" tabindex="-1"></a>    </span>
<span id="cb782-85"><a href="remedies-for-staggered-did-biases.html#cb782-85" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb782-86"><a href="remedies-for-staggered-did-biases.html#cb782-86" tabindex="-1"></a>        row_labels[<span class="dv">3</span>],</span>
<span id="cb782-87"><a href="remedies-for-staggered-did-biases.html#cb782-87" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb782-88"><a href="remedies-for-staggered-did-biases.html#cb782-88" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb782-89"><a href="remedies-for-staggered-did-biases.html#cb782-89" tabindex="-1"></a>    ), plots[[<span class="st">&quot;ps.weight.1lag&quot;</span>]], plots[[<span class="st">&quot;ps.weight.4lag&quot;</span>]])</span>
<span id="cb782-90"><a href="remedies-for-staggered-did-biases.html#cb782-90" tabindex="-1"></a>)</span>
<span id="cb782-91"><a href="remedies-for-staggered-did-biases.html#cb782-91" tabindex="-1"></a></span>
<span id="cb782-92"><a href="remedies-for-staggered-did-biases.html#cb782-92" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb782-93"><a href="remedies-for-staggered-did-biases.html#cb782-93" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb782-94"><a href="remedies-for-staggered-did-biases.html#cb782-94" tabindex="-1"></a></span>
<span id="cb782-95"><a href="remedies-for-staggered-did-biases.html#cb782-95" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb782-96"><a href="remedies-for-staggered-did-biases.html#cb782-96" tabindex="-1"></a>    <span class="at">grobs =</span> grobs,</span>
<span id="cb782-97"><a href="remedies-for-staggered-did-biases.html#cb782-97" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb782-98"><a href="remedies-for-staggered-did-biases.html#cb782-98" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb782-99"><a href="remedies-for-staggered-did-biases.html#cb782-99" tabindex="-1"></a>    <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.42</span>, <span class="fl">0.42</span>),</span>
<span id="cb782-100"><a href="remedies-for-staggered-did-biases.html#cb782-100" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.28</span>, <span class="fl">0.28</span>, <span class="fl">0.28</span>)</span>
<span id="cb782-101"><a href="remedies-for-staggered-did-biases.html#cb782-101" tabindex="-1"></a>)</span>
<span id="cb782-102"><a href="remedies-for-staggered-did-biases.html#cb782-102" tabindex="-1"></a></span>
<span id="cb782-103"><a href="remedies-for-staggered-did-biases.html#cb782-103" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb782-104"><a href="remedies-for-staggered-did-biases.html#cb782-104" tabindex="-1"></a>    <span class="st">&quot;Before Refinement&quot;</span>,</span>
<span id="cb782-105"><a href="remedies-for-staggered-did-biases.html#cb782-105" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb782-106"><a href="remedies-for-staggered-did-biases.html#cb782-106" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.03</span>,</span>
<span id="cb782-107"><a href="remedies-for-staggered-did-biases.html#cb782-107" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb782-108"><a href="remedies-for-staggered-did-biases.html#cb782-108" tabindex="-1"></a>)</span>
<span id="cb782-109"><a href="remedies-for-staggered-did-biases.html#cb782-109" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb782-110"><a href="remedies-for-staggered-did-biases.html#cb782-110" tabindex="-1"></a>    <span class="st">&quot;After Refinement&quot;</span>,</span>
<span id="cb782-111"><a href="remedies-for-staggered-did-biases.html#cb782-111" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.03</span>,</span>
<span id="cb782-112"><a href="remedies-for-staggered-did-biases.html#cb782-112" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb782-113"><a href="remedies-for-staggered-did-biases.html#cb782-113" tabindex="-1"></a>    <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb782-114"><a href="remedies-for-staggered-did-biases.html#cb782-114" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb782-115"><a href="remedies-for-staggered-did-biases.html#cb782-115" tabindex="-1"></a>)</span>
<span id="cb782-116"><a href="remedies-for-staggered-did-biases.html#cb782-116" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb782-117"><a href="remedies-for-staggered-did-biases.html#cb782-117" tabindex="-1"></a><span class="co">#&gt; png </span></span>
<span id="cb782-118"><a href="remedies-for-staggered-did-biases.html#cb782-118" tabindex="-1"></a><span class="co">#&gt;   2</span></span></code></pre></div>
<p>Note: Scatter plots display the standardized mean difference of each covariate <span class="math inline">\(j\)</span> and lag year <span class="math inline">\(l\)</span> as defined in Equation <a href="#eq:aggbalance">(<strong>??</strong>)</a> before (x-axis) and after (y-axis) matched set refinement. Each plot includes varying numbers of possible matches for each matching method. Rows represent different matching/weighting methods, while columns indicate adjustments for various lag lengths.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="remedies-for-staggered-did-biases.html#cb783-1" tabindex="-1"></a><span class="co"># Step 1: Define configurations</span></span>
<span id="cb783-2"><a href="remedies-for-staggered-did-biases.html#cb783-2" tabindex="-1"></a>configurations <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb783-3"><a href="remedies-for-staggered-did-biases.html#cb783-3" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb783-4"><a href="remedies-for-staggered-did-biases.html#cb783-4" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb783-5"><a href="remedies-for-staggered-did-biases.html#cb783-5" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb783-6"><a href="remedies-for-staggered-did-biases.html#cb783-6" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb783-7"><a href="remedies-for-staggered-did-biases.html#cb783-7" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.match&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb783-8"><a href="remedies-for-staggered-did-biases.html#cb783-8" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.match&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb783-9"><a href="remedies-for-staggered-did-biases.html#cb783-9" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb783-10"><a href="remedies-for-staggered-did-biases.html#cb783-10" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb783-11"><a href="remedies-for-staggered-did-biases.html#cb783-11" tabindex="-1"></a>)</span>
<span id="cb783-12"><a href="remedies-for-staggered-did-biases.html#cb783-12" tabindex="-1"></a></span>
<span id="cb783-13"><a href="remedies-for-staggered-did-biases.html#cb783-13" tabindex="-1"></a><span class="co"># Step 2: Use lapply or loop to generate results</span></span>
<span id="cb783-14"><a href="remedies-for-staggered-did-biases.html#cb783-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(configurations, <span class="cf">function</span>(config) {</span>
<span id="cb783-15"><a href="remedies-for-staggered-did-biases.html#cb783-15" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb783-16"><a href="remedies-for-staggered-did-biases.html#cb783-16" tabindex="-1"></a>        <span class="at">lag                       =</span> <span class="dv">4</span>,</span>
<span id="cb783-17"><a href="remedies-for-staggered-did-biases.html#cb783-17" tabindex="-1"></a>        <span class="at">time.id                   =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb783-18"><a href="remedies-for-staggered-did-biases.html#cb783-18" tabindex="-1"></a>        <span class="at">unit.id                   =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb783-19"><a href="remedies-for-staggered-did-biases.html#cb783-19" tabindex="-1"></a>        <span class="at">treatment                 =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb783-20"><a href="remedies-for-staggered-did-biases.html#cb783-20" tabindex="-1"></a>        <span class="at">data                      =</span> dem,</span>
<span id="cb783-21"><a href="remedies-for-staggered-did-biases.html#cb783-21" tabindex="-1"></a>        <span class="at">match.missing             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb783-22"><a href="remedies-for-staggered-did-biases.html#cb783-22" tabindex="-1"></a>        <span class="at">listwise.delete           =</span> <span class="cn">TRUE</span>,</span>
<span id="cb783-23"><a href="remedies-for-staggered-did-biases.html#cb783-23" tabindex="-1"></a>        <span class="at">size.match                =</span> <span class="dv">5</span>,</span>
<span id="cb783-24"><a href="remedies-for-staggered-did-biases.html#cb783-24" tabindex="-1"></a>        <span class="at">outcome.var               =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb783-25"><a href="remedies-for-staggered-did-biases.html#cb783-25" tabindex="-1"></a>        <span class="at">lead                      =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb783-26"><a href="remedies-for-staggered-did-biases.html#cb783-26" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb783-27"><a href="remedies-for-staggered-did-biases.html#cb783-27" tabindex="-1"></a>        <span class="at">refinement.method         =</span> config<span class="sc">$</span>refinement.method,</span>
<span id="cb783-28"><a href="remedies-for-staggered-did-biases.html#cb783-28" tabindex="-1"></a>        <span class="at">covs.formula              =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb783-29"><a href="remedies-for-staggered-did-biases.html#cb783-29" tabindex="-1"></a>        <span class="at">qoi                       =</span> config<span class="sc">$</span>qoi</span>
<span id="cb783-30"><a href="remedies-for-staggered-did-biases.html#cb783-30" tabindex="-1"></a>    )</span>
<span id="cb783-31"><a href="remedies-for-staggered-did-biases.html#cb783-31" tabindex="-1"></a>})</span>
<span id="cb783-32"><a href="remedies-for-staggered-did-biases.html#cb783-32" tabindex="-1"></a></span>
<span id="cb783-33"><a href="remedies-for-staggered-did-biases.html#cb783-33" tabindex="-1"></a><span class="co"># Step 3: Get covariate balance and plot</span></span>
<span id="cb783-34"><a href="remedies-for-staggered-did-biases.html#cb783-34" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(result, config) {</span>
<span id="cb783-35"><a href="remedies-for-staggered-did-biases.html#cb783-35" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">get_covariate_balance</span>(</span>
<span id="cb783-36"><a href="remedies-for-staggered-did-biases.html#cb783-36" tabindex="-1"></a>        <span class="cf">if</span> (config<span class="sc">$</span>qoi <span class="sc">==</span> <span class="st">&quot;att&quot;</span>)</span>
<span id="cb783-37"><a href="remedies-for-staggered-did-biases.html#cb783-37" tabindex="-1"></a>            result<span class="sc">$</span>att</span>
<span id="cb783-38"><a href="remedies-for-staggered-did-biases.html#cb783-38" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb783-39"><a href="remedies-for-staggered-did-biases.html#cb783-39" tabindex="-1"></a>            result<span class="sc">$</span>art,</span>
<span id="cb783-40"><a href="remedies-for-staggered-did-biases.html#cb783-40" tabindex="-1"></a>        <span class="at">data =</span> dem,</span>
<span id="cb783-41"><a href="remedies-for-staggered-did-biases.html#cb783-41" tabindex="-1"></a>        <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb783-42"><a href="remedies-for-staggered-did-biases.html#cb783-42" tabindex="-1"></a>        <span class="at">plot =</span> F</span>
<span id="cb783-43"><a href="remedies-for-staggered-did-biases.html#cb783-43" tabindex="-1"></a>    )</span>
<span id="cb783-44"><a href="remedies-for-staggered-did-biases.html#cb783-44" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">plot_covariate_balance_pretrend</span>(df, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_legend =</span> F)</span>
<span id="cb783-45"><a href="remedies-for-staggered-did-biases.html#cb783-45" tabindex="-1"></a>}, results, configurations, <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb783-46"><a href="remedies-for-staggered-did-biases.html#cb783-46" tabindex="-1"></a></span>
<span id="cb783-47"><a href="remedies-for-staggered-did-biases.html#cb783-47" tabindex="-1"></a><span class="co"># Set names for plots</span></span>
<span id="cb783-48"><a href="remedies-for-staggered-did-biases.html#cb783-48" tabindex="-1"></a><span class="fu">names</span>(plots) <span class="ot">&lt;-</span> <span class="fu">sapply</span>(configurations, <span class="cf">function</span>(config) {</span>
<span id="cb783-49"><a href="remedies-for-staggered-did-biases.html#cb783-49" tabindex="-1"></a>    <span class="fu">paste</span>(config<span class="sc">$</span>qoi, config<span class="sc">$</span>refinement.method, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb783-50"><a href="remedies-for-staggered-did-biases.html#cb783-50" tabindex="-1"></a>})</span></code></pre></div>
<p>To export</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="remedies-for-staggered-did-biases.html#cb784-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb784-2"><a href="remedies-for-staggered-did-biases.html#cb784-2" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb784-3"><a href="remedies-for-staggered-did-biases.html#cb784-3" tabindex="-1"></a></span>
<span id="cb784-4"><a href="remedies-for-staggered-did-biases.html#cb784-4" tabindex="-1"></a><span class="co"># Column and row labels</span></span>
<span id="cb784-5"><a href="remedies-for-staggered-did-biases.html#cb784-5" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span></span>
<span id="cb784-6"><a href="remedies-for-staggered-did-biases.html#cb784-6" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;None&quot;</span>,</span>
<span id="cb784-7"><a href="remedies-for-staggered-did-biases.html#cb784-7" tabindex="-1"></a>      <span class="st">&quot;Mahalanobis&quot;</span>,</span>
<span id="cb784-8"><a href="remedies-for-staggered-did-biases.html#cb784-8" tabindex="-1"></a>      <span class="st">&quot;Propensity Score Matching&quot;</span>,</span>
<span id="cb784-9"><a href="remedies-for-staggered-did-biases.html#cb784-9" tabindex="-1"></a>      <span class="st">&quot;Propensity Score Weighting&quot;</span>)</span>
<span id="cb784-10"><a href="remedies-for-staggered-did-biases.html#cb784-10" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ATT&quot;</span>, <span class="st">&quot;ART&quot;</span>)</span>
<span id="cb784-11"><a href="remedies-for-staggered-did-biases.html#cb784-11" tabindex="-1"></a></span>
<span id="cb784-12"><a href="remedies-for-staggered-did-biases.html#cb784-12" tabindex="-1"></a><span class="co"># Specify your desired fontsize for labels</span></span>
<span id="cb784-13"><a href="remedies-for-staggered-did-biases.html#cb784-13" tabindex="-1"></a>minor.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb784-14"><a href="remedies-for-staggered-did-biases.html#cb784-14" tabindex="-1"></a>major.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb784-15"><a href="remedies-for-staggered-did-biases.html#cb784-15" tabindex="-1"></a></span>
<span id="cb784-16"><a href="remedies-for-staggered-did-biases.html#cb784-16" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_covariate_balance.png&quot;</span>), <span class="at">width=</span><span class="dv">1200</span>, <span class="at">height=</span><span class="dv">1000</span>)</span>
<span id="cb784-17"><a href="remedies-for-staggered-did-biases.html#cb784-17" tabindex="-1"></a></span>
<span id="cb784-18"><a href="remedies-for-staggered-did-biases.html#cb784-18" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb784-19"><a href="remedies-for-staggered-did-biases.html#cb784-19" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb784-20"><a href="remedies-for-staggered-did-biases.html#cb784-20" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb784-21"><a href="remedies-for-staggered-did-biases.html#cb784-21" tabindex="-1"></a>        <span class="fu">nullGrob</span>(),</span>
<span id="cb784-22"><a href="remedies-for-staggered-did-biases.html#cb784-22" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb784-23"><a href="remedies-for-staggered-did-biases.html#cb784-23" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb784-24"><a href="remedies-for-staggered-did-biases.html#cb784-24" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">3</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb784-25"><a href="remedies-for-staggered-did-biases.html#cb784-25" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">4</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb784-26"><a href="remedies-for-staggered-did-biases.html#cb784-26" tabindex="-1"></a>    ),</span>
<span id="cb784-27"><a href="remedies-for-staggered-did-biases.html#cb784-27" tabindex="-1"></a>    </span>
<span id="cb784-28"><a href="remedies-for-staggered-did-biases.html#cb784-28" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb784-29"><a href="remedies-for-staggered-did-biases.html#cb784-29" tabindex="-1"></a>        <span class="fu">textGrob</span>(</span>
<span id="cb784-30"><a href="remedies-for-staggered-did-biases.html#cb784-30" tabindex="-1"></a>            row_labels[<span class="dv">1</span>],</span>
<span id="cb784-31"><a href="remedies-for-staggered-did-biases.html#cb784-31" tabindex="-1"></a>            <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb784-32"><a href="remedies-for-staggered-did-biases.html#cb784-32" tabindex="-1"></a>            <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb784-33"><a href="remedies-for-staggered-did-biases.html#cb784-33" tabindex="-1"></a>        ),</span>
<span id="cb784-34"><a href="remedies-for-staggered-did-biases.html#cb784-34" tabindex="-1"></a>        plots<span class="sc">$</span>att.none,</span>
<span id="cb784-35"><a href="remedies-for-staggered-did-biases.html#cb784-35" tabindex="-1"></a>        plots<span class="sc">$</span>att.mahalanobis,</span>
<span id="cb784-36"><a href="remedies-for-staggered-did-biases.html#cb784-36" tabindex="-1"></a>        plots<span class="sc">$</span>att.ps.match,</span>
<span id="cb784-37"><a href="remedies-for-staggered-did-biases.html#cb784-37" tabindex="-1"></a>        plots<span class="sc">$</span>att.ps.weight</span>
<span id="cb784-38"><a href="remedies-for-staggered-did-biases.html#cb784-38" tabindex="-1"></a>    ),</span>
<span id="cb784-39"><a href="remedies-for-staggered-did-biases.html#cb784-39" tabindex="-1"></a>    </span>
<span id="cb784-40"><a href="remedies-for-staggered-did-biases.html#cb784-40" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb784-41"><a href="remedies-for-staggered-did-biases.html#cb784-41" tabindex="-1"></a>        <span class="fu">textGrob</span>(</span>
<span id="cb784-42"><a href="remedies-for-staggered-did-biases.html#cb784-42" tabindex="-1"></a>            row_labels[<span class="dv">2</span>],</span>
<span id="cb784-43"><a href="remedies-for-staggered-did-biases.html#cb784-43" tabindex="-1"></a>            <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb784-44"><a href="remedies-for-staggered-did-biases.html#cb784-44" tabindex="-1"></a>            <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb784-45"><a href="remedies-for-staggered-did-biases.html#cb784-45" tabindex="-1"></a>        ),</span>
<span id="cb784-46"><a href="remedies-for-staggered-did-biases.html#cb784-46" tabindex="-1"></a>        plots<span class="sc">$</span>art.none,</span>
<span id="cb784-47"><a href="remedies-for-staggered-did-biases.html#cb784-47" tabindex="-1"></a>        plots<span class="sc">$</span>art.mahalanobis,</span>
<span id="cb784-48"><a href="remedies-for-staggered-did-biases.html#cb784-48" tabindex="-1"></a>        plots<span class="sc">$</span>art.ps.match,</span>
<span id="cb784-49"><a href="remedies-for-staggered-did-biases.html#cb784-49" tabindex="-1"></a>        plots<span class="sc">$</span>art.ps.weight</span>
<span id="cb784-50"><a href="remedies-for-staggered-did-biases.html#cb784-50" tabindex="-1"></a>    )</span>
<span id="cb784-51"><a href="remedies-for-staggered-did-biases.html#cb784-51" tabindex="-1"></a>)</span>
<span id="cb784-52"><a href="remedies-for-staggered-did-biases.html#cb784-52" tabindex="-1"></a></span>
<span id="cb784-53"><a href="remedies-for-staggered-did-biases.html#cb784-53" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb784-54"><a href="remedies-for-staggered-did-biases.html#cb784-54" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb784-55"><a href="remedies-for-staggered-did-biases.html#cb784-55" tabindex="-1"></a></span>
<span id="cb784-56"><a href="remedies-for-staggered-did-biases.html#cb784-56" tabindex="-1"></a><span class="co"># Arrange your plots with text labels</span></span>
<span id="cb784-57"><a href="remedies-for-staggered-did-biases.html#cb784-57" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb784-58"><a href="remedies-for-staggered-did-biases.html#cb784-58" tabindex="-1"></a>    <span class="at">grobs   =</span> grobs,</span>
<span id="cb784-59"><a href="remedies-for-staggered-did-biases.html#cb784-59" tabindex="-1"></a>    <span class="at">ncol    =</span> <span class="dv">5</span>,</span>
<span id="cb784-60"><a href="remedies-for-staggered-did-biases.html#cb784-60" tabindex="-1"></a>    <span class="at">nrow    =</span> <span class="dv">3</span>,</span>
<span id="cb784-61"><a href="remedies-for-staggered-did-biases.html#cb784-61" tabindex="-1"></a>    <span class="at">widths  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>),</span>
<span id="cb784-62"><a href="remedies-for-staggered-did-biases.html#cb784-62" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>)</span>
<span id="cb784-63"><a href="remedies-for-staggered-did-biases.html#cb784-63" tabindex="-1"></a>)</span>
<span id="cb784-64"><a href="remedies-for-staggered-did-biases.html#cb784-64" tabindex="-1"></a></span>
<span id="cb784-65"><a href="remedies-for-staggered-did-biases.html#cb784-65" tabindex="-1"></a><span class="co"># Add main x and y axis titles</span></span>
<span id="cb784-66"><a href="remedies-for-staggered-did-biases.html#cb784-66" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb784-67"><a href="remedies-for-staggered-did-biases.html#cb784-67" tabindex="-1"></a>    <span class="st">&quot;Refinement Methods&quot;</span>,</span>
<span id="cb784-68"><a href="remedies-for-staggered-did-biases.html#cb784-68" tabindex="-1"></a>    <span class="at">x  =</span> <span class="fl">0.5</span>,</span>
<span id="cb784-69"><a href="remedies-for-staggered-did-biases.html#cb784-69" tabindex="-1"></a>    <span class="at">y  =</span> <span class="fl">0.01</span>,</span>
<span id="cb784-70"><a href="remedies-for-staggered-did-biases.html#cb784-70" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb784-71"><a href="remedies-for-staggered-did-biases.html#cb784-71" tabindex="-1"></a>)</span>
<span id="cb784-72"><a href="remedies-for-staggered-did-biases.html#cb784-72" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb784-73"><a href="remedies-for-staggered-did-biases.html#cb784-73" tabindex="-1"></a>    <span class="st">&quot;Quantities of Interest&quot;</span>,</span>
<span id="cb784-74"><a href="remedies-for-staggered-did-biases.html#cb784-74" tabindex="-1"></a>    <span class="at">x   =</span> <span class="fl">0.02</span>,</span>
<span id="cb784-75"><a href="remedies-for-staggered-did-biases.html#cb784-75" tabindex="-1"></a>    <span class="at">y   =</span> <span class="fl">0.5</span>,</span>
<span id="cb784-76"><a href="remedies-for-staggered-did-biases.html#cb784-76" tabindex="-1"></a>    <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb784-77"><a href="remedies-for-staggered-did-biases.html#cb784-77" tabindex="-1"></a>    <span class="at">gp  =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb784-78"><a href="remedies-for-staggered-did-biases.html#cb784-78" tabindex="-1"></a>)</span>
<span id="cb784-79"><a href="remedies-for-staggered-did-biases.html#cb784-79" tabindex="-1"></a></span>
<span id="cb784-80"><a href="remedies-for-staggered-did-biases.html#cb784-80" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="remedies-for-staggered-did-biases.html#cb785-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb785-2"><a href="remedies-for-staggered-did-biases.html#cb785-2" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_covariate_balance.png&quot;</span>))</span></code></pre></div>
<p>Note: Each graph displays the standardized mean difference, as outlined in Equation <a href="#eq:aggbalance">(<strong>??</strong>)</a>, plotted on the vertical axis across a pre-treatment duration of four years represented on the horizontal axis. The leftmost column illustrates the balance prior to refinement, while the subsequent three columns depict the covariate balance post the application of distinct refinement techniques. Each individual line signifies the balance of a specific variable during the pre-treatment phase.The red line is tradewb and blue line is the lagged outcome variable.</p>
<p>In Figure <a href="#fig:balancepretreat"><strong>??</strong></a>, we observe a marked improvement in covariate balance due to the implemented matching procedures during the pre-treatment period. Our analysis prioritizes methods that adjust for time-varying covariates over a span of four years preceding the treatment initiation. The two rows delineate the standardized mean balance for both treatment modalities, with individual lines representing the balance for each covariate.</p>
<p>Across all scenarios, the refinement attributed to matched sets significantly enhances balance. Notably, using propensity score weighting considerably mitigates imbalances in confounders. While some degree of imbalance remains evident in the Mahalanobis distance and propensity score matching techniques, the standardized mean difference for the lagged outcome remains stable throughout the pre-treatment phase. This consistency lends credence to the validity of the proposed DiD estimator.</p>
<p><strong>Estimation Results</strong></p>
<p>We now detail the estimated ATTs derived from the matching techniques. Figure below offers visual representations of the impacts of treatment initiation (upper panel) and treatment reversal (lower panel) on the outcome variable for a duration of 5 years post-transition, specifically, (<span class="math inline">\(F = 0, 1, …, 4\)</span>). Across the five methods (columns), it becomes evident that the point estimates of effects associated with treatment initiation consistently approximate zero over the 5-year window. In contrast, the estimated outcomes of treatment reversal are notably negative and maintain statistical significance through all refinement techniques during the initial year of transition and the 1 to 4 years that follow, provided treatment reversal is permissible. These effects are notably pronounced, pointing to an estimated reduction of roughly X% in the outcome variable.</p>
<p>Collectively, these findings indicate that the transition into the treated state from its absence doesn’t invariably lead to a heightened outcome. Instead, the transition from the treated state back to its absence exerts a considerable negative effect on the outcome variable in both the short and intermediate terms. Hence, the positive effect of the treatment (if we were to use traditional DiD) is actually driven by the negative effect of treatment reversal.</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="remedies-for-staggered-did-biases.html#cb786-1" tabindex="-1"></a><span class="co"># sequential</span></span>
<span id="cb786-2"><a href="remedies-for-staggered-did-biases.html#cb786-2" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function</span></span>
<span id="cb786-3"><a href="remedies-for-staggered-did-biases.html#cb786-3" tabindex="-1"></a></span>
<span id="cb786-4"><a href="remedies-for-staggered-did-biases.html#cb786-4" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb786-5"><a href="remedies-for-staggered-did-biases.html#cb786-5" tabindex="-1"></a>res_est <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_pm))</span>
<span id="cb786-6"><a href="remedies-for-staggered-did-biases.html#cb786-6" tabindex="-1"></a></span>
<span id="cb786-7"><a href="remedies-for-staggered-did-biases.html#cb786-7" tabindex="-1"></a><span class="co"># Iterate over each element in res_pm</span></span>
<span id="cb786-8"><a href="remedies-for-staggered-did-biases.html#cb786-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm)) {</span>
<span id="cb786-9"><a href="remedies-for-staggered-did-biases.html#cb786-9" tabindex="-1"></a>  res_est[[i]] <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb786-10"><a href="remedies-for-staggered-did-biases.html#cb786-10" tabindex="-1"></a>    res_pm[[i]],</span>
<span id="cb786-11"><a href="remedies-for-staggered-did-biases.html#cb786-11" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb786-12"><a href="remedies-for-staggered-did-biases.html#cb786-12" tabindex="-1"></a>    <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb786-13"><a href="remedies-for-staggered-did-biases.html#cb786-13" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb786-14"><a href="remedies-for-staggered-did-biases.html#cb786-14" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb786-15"><a href="remedies-for-staggered-did-biases.html#cb786-15" tabindex="-1"></a>  )</span>
<span id="cb786-16"><a href="remedies-for-staggered-did-biases.html#cb786-16" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est list</span></span>
<span id="cb786-17"><a href="remedies-for-staggered-did-biases.html#cb786-17" tabindex="-1"></a>  <span class="fu">names</span>(res_est)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm)[i]</span>
<span id="cb786-18"><a href="remedies-for-staggered-did-biases.html#cb786-18" tabindex="-1"></a>}</span>
<span id="cb786-19"><a href="remedies-for-staggered-did-biases.html#cb786-19" tabindex="-1"></a></span>
<span id="cb786-20"><a href="remedies-for-staggered-did-biases.html#cb786-20" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function</span></span>
<span id="cb786-21"><a href="remedies-for-staggered-did-biases.html#cb786-21" tabindex="-1"></a></span>
<span id="cb786-22"><a href="remedies-for-staggered-did-biases.html#cb786-22" tabindex="-1"></a><span class="co"># Initialize an empty list to store plot results</span></span>
<span id="cb786-23"><a href="remedies-for-staggered-did-biases.html#cb786-23" tabindex="-1"></a>res_est_plot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_est))</span>
<span id="cb786-24"><a href="remedies-for-staggered-did-biases.html#cb786-24" tabindex="-1"></a></span>
<span id="cb786-25"><a href="remedies-for-staggered-did-biases.html#cb786-25" tabindex="-1"></a><span class="co"># Iterate over each element in res_est</span></span>
<span id="cb786-26"><a href="remedies-for-staggered-did-biases.html#cb786-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est)) {</span>
<span id="cb786-27"><a href="remedies-for-staggered-did-biases.html#cb786-27" tabindex="-1"></a>    res_est_plot[[i]] <span class="ot">&lt;-</span></span>
<span id="cb786-28"><a href="remedies-for-staggered-did-biases.html#cb786-28" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est[[i]],</span>
<span id="cb786-29"><a href="remedies-for-staggered-did-biases.html#cb786-29" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb786-30"><a href="remedies-for-staggered-did-biases.html#cb786-30" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb786-31"><a href="remedies-for-staggered-did-biases.html#cb786-31" tabindex="-1"></a>    <span class="co"># Transfer the name of the current element to the res_est_plot list</span></span>
<span id="cb786-32"><a href="remedies-for-staggered-did-biases.html#cb786-32" tabindex="-1"></a>    <span class="fu">names</span>(res_est_plot)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est)[i]</span>
<span id="cb786-33"><a href="remedies-for-staggered-did-biases.html#cb786-33" tabindex="-1"></a>}</span>
<span id="cb786-34"><a href="remedies-for-staggered-did-biases.html#cb786-34" tabindex="-1"></a></span>
<span id="cb786-35"><a href="remedies-for-staggered-did-biases.html#cb786-35" tabindex="-1"></a><span class="co"># check results</span></span>
<span id="cb786-36"><a href="remedies-for-staggered-did-biases.html#cb786-36" tabindex="-1"></a><span class="co"># res_est_plot$mahalanobis.1lag.5m</span></span>
<span id="cb786-37"><a href="remedies-for-staggered-did-biases.html#cb786-37" tabindex="-1"></a></span>
<span id="cb786-38"><a href="remedies-for-staggered-did-biases.html#cb786-38" tabindex="-1"></a></span>
<span id="cb786-39"><a href="remedies-for-staggered-did-biases.html#cb786-39" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function for res_pm_rev</span></span>
<span id="cb786-40"><a href="remedies-for-staggered-did-biases.html#cb786-40" tabindex="-1"></a></span>
<span id="cb786-41"><a href="remedies-for-staggered-did-biases.html#cb786-41" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb786-42"><a href="remedies-for-staggered-did-biases.html#cb786-42" tabindex="-1"></a>res_est_rev <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_pm_rev))</span>
<span id="cb786-43"><a href="remedies-for-staggered-did-biases.html#cb786-43" tabindex="-1"></a></span>
<span id="cb786-44"><a href="remedies-for-staggered-did-biases.html#cb786-44" tabindex="-1"></a><span class="co"># Iterate over each element in res_pm_rev</span></span>
<span id="cb786-45"><a href="remedies-for-staggered-did-biases.html#cb786-45" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm_rev)) {</span>
<span id="cb786-46"><a href="remedies-for-staggered-did-biases.html#cb786-46" tabindex="-1"></a>  res_est_rev[[i]] <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb786-47"><a href="remedies-for-staggered-did-biases.html#cb786-47" tabindex="-1"></a>    res_pm_rev[[i]],</span>
<span id="cb786-48"><a href="remedies-for-staggered-did-biases.html#cb786-48" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb786-49"><a href="remedies-for-staggered-did-biases.html#cb786-49" tabindex="-1"></a>    <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb786-50"><a href="remedies-for-staggered-did-biases.html#cb786-50" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb786-51"><a href="remedies-for-staggered-did-biases.html#cb786-51" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb786-52"><a href="remedies-for-staggered-did-biases.html#cb786-52" tabindex="-1"></a>  )</span>
<span id="cb786-53"><a href="remedies-for-staggered-did-biases.html#cb786-53" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est_rev list</span></span>
<span id="cb786-54"><a href="remedies-for-staggered-did-biases.html#cb786-54" tabindex="-1"></a>  <span class="fu">names</span>(res_est_rev)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm_rev)[i]</span>
<span id="cb786-55"><a href="remedies-for-staggered-did-biases.html#cb786-55" tabindex="-1"></a>}</span>
<span id="cb786-56"><a href="remedies-for-staggered-did-biases.html#cb786-56" tabindex="-1"></a></span>
<span id="cb786-57"><a href="remedies-for-staggered-did-biases.html#cb786-57" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function for res_est_rev</span></span>
<span id="cb786-58"><a href="remedies-for-staggered-did-biases.html#cb786-58" tabindex="-1"></a></span>
<span id="cb786-59"><a href="remedies-for-staggered-did-biases.html#cb786-59" tabindex="-1"></a><span class="co"># Initialize an empty list to store plot results</span></span>
<span id="cb786-60"><a href="remedies-for-staggered-did-biases.html#cb786-60" tabindex="-1"></a>res_est_plot_rev <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_est_rev))</span>
<span id="cb786-61"><a href="remedies-for-staggered-did-biases.html#cb786-61" tabindex="-1"></a></span>
<span id="cb786-62"><a href="remedies-for-staggered-did-biases.html#cb786-62" tabindex="-1"></a><span class="co"># Iterate over each element in res_est_rev</span></span>
<span id="cb786-63"><a href="remedies-for-staggered-did-biases.html#cb786-63" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est_rev)) {</span>
<span id="cb786-64"><a href="remedies-for-staggered-did-biases.html#cb786-64" tabindex="-1"></a>    res_est_plot_rev[[i]] <span class="ot">&lt;-</span></span>
<span id="cb786-65"><a href="remedies-for-staggered-did-biases.html#cb786-65" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est_rev[[i]],</span>
<span id="cb786-66"><a href="remedies-for-staggered-did-biases.html#cb786-66" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb786-67"><a href="remedies-for-staggered-did-biases.html#cb786-67" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb786-68"><a href="remedies-for-staggered-did-biases.html#cb786-68" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est_plot_rev list</span></span>
<span id="cb786-69"><a href="remedies-for-staggered-did-biases.html#cb786-69" tabindex="-1"></a>  <span class="fu">names</span>(res_est_plot_rev)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est_rev)[i]</span>
<span id="cb786-70"><a href="remedies-for-staggered-did-biases.html#cb786-70" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="remedies-for-staggered-did-biases.html#cb787-1" tabindex="-1"></a><span class="co"># parallel</span></span>
<span id="cb787-2"><a href="remedies-for-staggered-did-biases.html#cb787-2" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb787-3"><a href="remedies-for-staggered-did-biases.html#cb787-3" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb787-4"><a href="remedies-for-staggered-did-biases.html#cb787-4" tabindex="-1"></a></span>
<span id="cb787-5"><a href="remedies-for-staggered-did-biases.html#cb787-5" tabindex="-1"></a><span class="co"># Detect the number of cores to use for parallel processing</span></span>
<span id="cb787-6"><a href="remedies-for-staggered-did-biases.html#cb787-6" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb787-7"><a href="remedies-for-staggered-did-biases.html#cb787-7" tabindex="-1"></a></span>
<span id="cb787-8"><a href="remedies-for-staggered-did-biases.html#cb787-8" tabindex="-1"></a><span class="co"># Register the parallel backend</span></span>
<span id="cb787-9"><a href="remedies-for-staggered-did-biases.html#cb787-9" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores)</span>
<span id="cb787-10"><a href="remedies-for-staggered-did-biases.html#cb787-10" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb787-11"><a href="remedies-for-staggered-did-biases.html#cb787-11" tabindex="-1"></a></span>
<span id="cb787-12"><a href="remedies-for-staggered-did-biases.html#cb787-12" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function in parallel</span></span>
<span id="cb787-13"><a href="remedies-for-staggered-did-biases.html#cb787-13" tabindex="-1"></a>res_est <span class="ot">&lt;-</span></span>
<span id="cb787-14"><a href="remedies-for-staggered-did-biases.html#cb787-14" tabindex="-1"></a>    <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm), <span class="at">.packages =</span> <span class="st">&quot;PanelMatch&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb787-15"><a href="remedies-for-staggered-did-biases.html#cb787-15" tabindex="-1"></a>        <span class="fu">PanelEstimate</span>(</span>
<span id="cb787-16"><a href="remedies-for-staggered-did-biases.html#cb787-16" tabindex="-1"></a>            res_pm[[i]],</span>
<span id="cb787-17"><a href="remedies-for-staggered-did-biases.html#cb787-17" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb787-18"><a href="remedies-for-staggered-did-biases.html#cb787-18" tabindex="-1"></a>            <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb787-19"><a href="remedies-for-staggered-did-biases.html#cb787-19" tabindex="-1"></a>            <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb787-20"><a href="remedies-for-staggered-did-biases.html#cb787-20" tabindex="-1"></a>            <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb787-21"><a href="remedies-for-staggered-did-biases.html#cb787-21" tabindex="-1"></a>        )</span>
<span id="cb787-22"><a href="remedies-for-staggered-did-biases.html#cb787-22" tabindex="-1"></a>    }</span>
<span id="cb787-23"><a href="remedies-for-staggered-did-biases.html#cb787-23" tabindex="-1"></a></span>
<span id="cb787-24"><a href="remedies-for-staggered-did-biases.html#cb787-24" tabindex="-1"></a><span class="co"># Transfer names from res_pm to res_est</span></span>
<span id="cb787-25"><a href="remedies-for-staggered-did-biases.html#cb787-25" tabindex="-1"></a><span class="fu">names</span>(res_est) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm)</span>
<span id="cb787-26"><a href="remedies-for-staggered-did-biases.html#cb787-26" tabindex="-1"></a></span>
<span id="cb787-27"><a href="remedies-for-staggered-did-biases.html#cb787-27" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function in parallel</span></span>
<span id="cb787-28"><a href="remedies-for-staggered-did-biases.html#cb787-28" tabindex="-1"></a>res_est_plot <span class="ot">&lt;-</span></span>
<span id="cb787-29"><a href="remedies-for-staggered-did-biases.html#cb787-29" tabindex="-1"></a>    <span class="fu">foreach</span>(</span>
<span id="cb787-30"><a href="remedies-for-staggered-did-biases.html#cb787-30" tabindex="-1"></a>        <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est),</span>
<span id="cb787-31"><a href="remedies-for-staggered-did-biases.html#cb787-31" tabindex="-1"></a>        <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb787-32"><a href="remedies-for-staggered-did-biases.html#cb787-32" tabindex="-1"></a>    ) <span class="sc">%dopar%</span> {</span>
<span id="cb787-33"><a href="remedies-for-staggered-did-biases.html#cb787-33" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est[[i]],</span>
<span id="cb787-34"><a href="remedies-for-staggered-did-biases.html#cb787-34" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb787-35"><a href="remedies-for-staggered-did-biases.html#cb787-35" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">10</span>))</span>
<span id="cb787-36"><a href="remedies-for-staggered-did-biases.html#cb787-36" tabindex="-1"></a>    }</span>
<span id="cb787-37"><a href="remedies-for-staggered-did-biases.html#cb787-37" tabindex="-1"></a></span>
<span id="cb787-38"><a href="remedies-for-staggered-did-biases.html#cb787-38" tabindex="-1"></a><span class="co"># Transfer names from res_est to res_est_plot</span></span>
<span id="cb787-39"><a href="remedies-for-staggered-did-biases.html#cb787-39" tabindex="-1"></a><span class="fu">names</span>(res_est_plot) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est)</span>
<span id="cb787-40"><a href="remedies-for-staggered-did-biases.html#cb787-40" tabindex="-1"></a></span>
<span id="cb787-41"><a href="remedies-for-staggered-did-biases.html#cb787-41" tabindex="-1"></a></span>
<span id="cb787-42"><a href="remedies-for-staggered-did-biases.html#cb787-42" tabindex="-1"></a></span>
<span id="cb787-43"><a href="remedies-for-staggered-did-biases.html#cb787-43" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function for res_pm_rev in parallel</span></span>
<span id="cb787-44"><a href="remedies-for-staggered-did-biases.html#cb787-44" tabindex="-1"></a>res_est_rev <span class="ot">&lt;-</span></span>
<span id="cb787-45"><a href="remedies-for-staggered-did-biases.html#cb787-45" tabindex="-1"></a>    <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm_rev), <span class="at">.packages =</span> <span class="st">&quot;PanelMatch&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb787-46"><a href="remedies-for-staggered-did-biases.html#cb787-46" tabindex="-1"></a>        <span class="fu">PanelEstimate</span>(</span>
<span id="cb787-47"><a href="remedies-for-staggered-did-biases.html#cb787-47" tabindex="-1"></a>            res_pm_rev[[i]],</span>
<span id="cb787-48"><a href="remedies-for-staggered-did-biases.html#cb787-48" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb787-49"><a href="remedies-for-staggered-did-biases.html#cb787-49" tabindex="-1"></a>            <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb787-50"><a href="remedies-for-staggered-did-biases.html#cb787-50" tabindex="-1"></a>            <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb787-51"><a href="remedies-for-staggered-did-biases.html#cb787-51" tabindex="-1"></a>            <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb787-52"><a href="remedies-for-staggered-did-biases.html#cb787-52" tabindex="-1"></a>        )</span>
<span id="cb787-53"><a href="remedies-for-staggered-did-biases.html#cb787-53" tabindex="-1"></a>    }</span>
<span id="cb787-54"><a href="remedies-for-staggered-did-biases.html#cb787-54" tabindex="-1"></a></span>
<span id="cb787-55"><a href="remedies-for-staggered-did-biases.html#cb787-55" tabindex="-1"></a><span class="co"># Transfer names from res_pm_rev to res_est_rev</span></span>
<span id="cb787-56"><a href="remedies-for-staggered-did-biases.html#cb787-56" tabindex="-1"></a><span class="fu">names</span>(res_est_rev) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm_rev)</span>
<span id="cb787-57"><a href="remedies-for-staggered-did-biases.html#cb787-57" tabindex="-1"></a></span>
<span id="cb787-58"><a href="remedies-for-staggered-did-biases.html#cb787-58" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function for res_est_rev in parallel</span></span>
<span id="cb787-59"><a href="remedies-for-staggered-did-biases.html#cb787-59" tabindex="-1"></a>res_est_plot_rev <span class="ot">&lt;-</span></span>
<span id="cb787-60"><a href="remedies-for-staggered-did-biases.html#cb787-60" tabindex="-1"></a>    <span class="fu">foreach</span>(</span>
<span id="cb787-61"><a href="remedies-for-staggered-did-biases.html#cb787-61" tabindex="-1"></a>        <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est_rev),</span>
<span id="cb787-62"><a href="remedies-for-staggered-did-biases.html#cb787-62" tabindex="-1"></a>        <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb787-63"><a href="remedies-for-staggered-did-biases.html#cb787-63" tabindex="-1"></a>    ) <span class="sc">%dopar%</span> {</span>
<span id="cb787-64"><a href="remedies-for-staggered-did-biases.html#cb787-64" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est_rev[[i]],</span>
<span id="cb787-65"><a href="remedies-for-staggered-did-biases.html#cb787-65" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb787-66"><a href="remedies-for-staggered-did-biases.html#cb787-66" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">10</span>))</span>
<span id="cb787-67"><a href="remedies-for-staggered-did-biases.html#cb787-67" tabindex="-1"></a>    }</span>
<span id="cb787-68"><a href="remedies-for-staggered-did-biases.html#cb787-68" tabindex="-1"></a></span>
<span id="cb787-69"><a href="remedies-for-staggered-did-biases.html#cb787-69" tabindex="-1"></a><span class="co"># Transfer names from res_est_rev to res_est_plot_rev</span></span>
<span id="cb787-70"><a href="remedies-for-staggered-did-biases.html#cb787-70" tabindex="-1"></a><span class="fu">names</span>(res_est_plot_rev) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est_rev)</span>
<span id="cb787-71"><a href="remedies-for-staggered-did-biases.html#cb787-71" tabindex="-1"></a></span>
<span id="cb787-72"><a href="remedies-for-staggered-did-biases.html#cb787-72" tabindex="-1"></a><span class="co"># Stop the cluster</span></span>
<span id="cb787-73"><a href="remedies-for-staggered-did-biases.html#cb787-73" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>To export</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="remedies-for-staggered-did-biases.html#cb788-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb788-2"><a href="remedies-for-staggered-did-biases.html#cb788-2" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb788-3"><a href="remedies-for-staggered-did-biases.html#cb788-3" tabindex="-1"></a></span>
<span id="cb788-4"><a href="remedies-for-staggered-did-biases.html#cb788-4" tabindex="-1"></a><span class="co"># Column and row labels</span></span>
<span id="cb788-5"><a href="remedies-for-staggered-did-biases.html#cb788-5" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mahalanobis 5m&quot;</span>, </span>
<span id="cb788-6"><a href="remedies-for-staggered-did-biases.html#cb788-6" tabindex="-1"></a>                <span class="st">&quot;Mahalanobis 10m&quot;</span>, </span>
<span id="cb788-7"><a href="remedies-for-staggered-did-biases.html#cb788-7" tabindex="-1"></a>                <span class="st">&quot;PS Matching 5m&quot;</span>, </span>
<span id="cb788-8"><a href="remedies-for-staggered-did-biases.html#cb788-8" tabindex="-1"></a>                <span class="st">&quot;PS Matching 10m&quot;</span>, </span>
<span id="cb788-9"><a href="remedies-for-staggered-did-biases.html#cb788-9" tabindex="-1"></a>                <span class="st">&quot;PS Weighting 5m&quot;</span>)</span>
<span id="cb788-10"><a href="remedies-for-staggered-did-biases.html#cb788-10" tabindex="-1"></a></span>
<span id="cb788-11"><a href="remedies-for-staggered-did-biases.html#cb788-11" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ATT&quot;</span>, <span class="st">&quot;ART&quot;</span>)</span>
<span id="cb788-12"><a href="remedies-for-staggered-did-biases.html#cb788-12" tabindex="-1"></a></span>
<span id="cb788-13"><a href="remedies-for-staggered-did-biases.html#cb788-13" tabindex="-1"></a><span class="co"># Specify your desired fontsize for labels</span></span>
<span id="cb788-14"><a href="remedies-for-staggered-did-biases.html#cb788-14" tabindex="-1"></a>minor.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb788-15"><a href="remedies-for-staggered-did-biases.html#cb788-15" tabindex="-1"></a>major.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb788-16"><a href="remedies-for-staggered-did-biases.html#cb788-16" tabindex="-1"></a></span>
<span id="cb788-17"><a href="remedies-for-staggered-did-biases.html#cb788-17" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_did_est_in_n_out.png&quot;</span>), <span class="at">width=</span><span class="dv">1200</span>, <span class="at">height=</span><span class="dv">1000</span>)</span>
<span id="cb788-18"><a href="remedies-for-staggered-did-biases.html#cb788-18" tabindex="-1"></a></span>
<span id="cb788-19"><a href="remedies-for-staggered-did-biases.html#cb788-19" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb788-20"><a href="remedies-for-staggered-did-biases.html#cb788-20" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb788-21"><a href="remedies-for-staggered-did-biases.html#cb788-21" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb788-22"><a href="remedies-for-staggered-did-biases.html#cb788-22" tabindex="-1"></a>    <span class="fu">nullGrob</span>(),</span>
<span id="cb788-23"><a href="remedies-for-staggered-did-biases.html#cb788-23" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb788-24"><a href="remedies-for-staggered-did-biases.html#cb788-24" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb788-25"><a href="remedies-for-staggered-did-biases.html#cb788-25" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">3</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb788-26"><a href="remedies-for-staggered-did-biases.html#cb788-26" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">4</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb788-27"><a href="remedies-for-staggered-did-biases.html#cb788-27" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">5</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb788-28"><a href="remedies-for-staggered-did-biases.html#cb788-28" tabindex="-1"></a>  ),</span>
<span id="cb788-29"><a href="remedies-for-staggered-did-biases.html#cb788-29" tabindex="-1"></a>  </span>
<span id="cb788-30"><a href="remedies-for-staggered-did-biases.html#cb788-30" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb788-31"><a href="remedies-for-staggered-did-biases.html#cb788-31" tabindex="-1"></a>    <span class="fu">textGrob</span>(row_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize), <span class="at">rot =</span> <span class="dv">90</span>),</span>
<span id="cb788-32"><a href="remedies-for-staggered-did-biases.html#cb788-32" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb788-33"><a href="remedies-for-staggered-did-biases.html#cb788-33" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb788-34"><a href="remedies-for-staggered-did-biases.html#cb788-34" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb788-35"><a href="remedies-for-staggered-did-biases.html#cb788-35" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb788-36"><a href="remedies-for-staggered-did-biases.html#cb788-36" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.weight<span class="fl">.1</span>lag<span class="fl">.5</span>m</span>
<span id="cb788-37"><a href="remedies-for-staggered-did-biases.html#cb788-37" tabindex="-1"></a>  ),</span>
<span id="cb788-38"><a href="remedies-for-staggered-did-biases.html#cb788-38" tabindex="-1"></a>  </span>
<span id="cb788-39"><a href="remedies-for-staggered-did-biases.html#cb788-39" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb788-40"><a href="remedies-for-staggered-did-biases.html#cb788-40" tabindex="-1"></a>    <span class="fu">textGrob</span>(row_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize), <span class="at">rot =</span> <span class="dv">90</span>),</span>
<span id="cb788-41"><a href="remedies-for-staggered-did-biases.html#cb788-41" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb788-42"><a href="remedies-for-staggered-did-biases.html#cb788-42" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb788-43"><a href="remedies-for-staggered-did-biases.html#cb788-43" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb788-44"><a href="remedies-for-staggered-did-biases.html#cb788-44" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb788-45"><a href="remedies-for-staggered-did-biases.html#cb788-45" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.weight<span class="fl">.1</span>lag<span class="fl">.5</span>m</span>
<span id="cb788-46"><a href="remedies-for-staggered-did-biases.html#cb788-46" tabindex="-1"></a>  )</span>
<span id="cb788-47"><a href="remedies-for-staggered-did-biases.html#cb788-47" tabindex="-1"></a>)</span>
<span id="cb788-48"><a href="remedies-for-staggered-did-biases.html#cb788-48" tabindex="-1"></a></span>
<span id="cb788-49"><a href="remedies-for-staggered-did-biases.html#cb788-49" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb788-50"><a href="remedies-for-staggered-did-biases.html#cb788-50" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb788-51"><a href="remedies-for-staggered-did-biases.html#cb788-51" tabindex="-1"></a></span>
<span id="cb788-52"><a href="remedies-for-staggered-did-biases.html#cb788-52" tabindex="-1"></a><span class="co"># Arrange your plots with text labels</span></span>
<span id="cb788-53"><a href="remedies-for-staggered-did-biases.html#cb788-53" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb788-54"><a href="remedies-for-staggered-did-biases.html#cb788-54" tabindex="-1"></a>  <span class="at">grobs   =</span> grobs,</span>
<span id="cb788-55"><a href="remedies-for-staggered-did-biases.html#cb788-55" tabindex="-1"></a>  <span class="at">ncol    =</span> <span class="dv">6</span>,</span>
<span id="cb788-56"><a href="remedies-for-staggered-did-biases.html#cb788-56" tabindex="-1"></a>  <span class="at">nrow    =</span> <span class="dv">3</span>,</span>
<span id="cb788-57"><a href="remedies-for-staggered-did-biases.html#cb788-57" tabindex="-1"></a>  <span class="at">widths  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>),</span>
<span id="cb788-58"><a href="remedies-for-staggered-did-biases.html#cb788-58" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>)</span>
<span id="cb788-59"><a href="remedies-for-staggered-did-biases.html#cb788-59" tabindex="-1"></a>)</span>
<span id="cb788-60"><a href="remedies-for-staggered-did-biases.html#cb788-60" tabindex="-1"></a></span>
<span id="cb788-61"><a href="remedies-for-staggered-did-biases.html#cb788-61" tabindex="-1"></a><span class="co"># Add main x and y axis titles</span></span>
<span id="cb788-62"><a href="remedies-for-staggered-did-biases.html#cb788-62" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb788-63"><a href="remedies-for-staggered-did-biases.html#cb788-63" tabindex="-1"></a>  <span class="st">&quot;Methods&quot;</span>,</span>
<span id="cb788-64"><a href="remedies-for-staggered-did-biases.html#cb788-64" tabindex="-1"></a>  <span class="at">x  =</span> <span class="fl">0.5</span>,</span>
<span id="cb788-65"><a href="remedies-for-staggered-did-biases.html#cb788-65" tabindex="-1"></a>  <span class="at">y  =</span> <span class="fl">0.02</span>,</span>
<span id="cb788-66"><a href="remedies-for-staggered-did-biases.html#cb788-66" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb788-67"><a href="remedies-for-staggered-did-biases.html#cb788-67" tabindex="-1"></a>)</span>
<span id="cb788-68"><a href="remedies-for-staggered-did-biases.html#cb788-68" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb788-69"><a href="remedies-for-staggered-did-biases.html#cb788-69" tabindex="-1"></a>  <span class="st">&quot;&quot;</span>,</span>
<span id="cb788-70"><a href="remedies-for-staggered-did-biases.html#cb788-70" tabindex="-1"></a>  <span class="at">x   =</span> <span class="fl">0.02</span>,</span>
<span id="cb788-71"><a href="remedies-for-staggered-did-biases.html#cb788-71" tabindex="-1"></a>  <span class="at">y   =</span> <span class="fl">0.5</span>,</span>
<span id="cb788-72"><a href="remedies-for-staggered-did-biases.html#cb788-72" tabindex="-1"></a>  <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb788-73"><a href="remedies-for-staggered-did-biases.html#cb788-73" tabindex="-1"></a>  <span class="at">gp  =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb788-74"><a href="remedies-for-staggered-did-biases.html#cb788-74" tabindex="-1"></a>)</span>
<span id="cb788-75"><a href="remedies-for-staggered-did-biases.html#cb788-75" tabindex="-1"></a></span>
<span id="cb788-76"><a href="remedies-for-staggered-did-biases.html#cb788-76" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="remedies-for-staggered-did-biases.html#cb789-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb789-2"><a href="remedies-for-staggered-did-biases.html#cb789-2" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_did_est_in_n_out.png&quot;</span>))</span></code></pre></div>
</div>
<div id="counterfactual-estimators" class="section level4 hasAnchor" number="30.11.3.2">
<h4><span class="header-section-number">30.11.3.2</span> Counterfactual Estimators<a href="remedies-for-staggered-did-biases.html#counterfactual-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Also known as <strong>imputation approach</strong> <span class="citation">(<a href="#ref-liu2022practical">Liu, Wang, and Xu 2022</a>)</span></li>
<li>This class of estimator consider observation treatment as missing data. Models are built using data from the control units to impute conterfactuals for the treated observations.</li>
<li>It’s called counterfactual estimators because they predict outcomes as if the treated observations had not received the treatment.</li>
<li>Advantages:
<ul>
<li>Avoids negative weights and biases by not using treated observations for modeling and applying uniform weights.</li>
<li>Supports various models, including those that may relax strict exogeneity assumptions.</li>
</ul></li>
<li>Methods including
<ul>
<li>Fixed-effects conterfactual estimator (FEct) (DiD is a special case):
<ul>
<li>Based on the [Two-way Fixed-effects], where assumes linear additive functional form of unobservables based on unit and time FEs. But FEct fixes the improper weighting of TWFE by comparing within each matched pair (where each pair is the treated observation and its predicted counterfactual that is the weighted sum of all untreated observations).</li>
</ul></li>
<li>Interactive Fixed Effects conterfactual estimator (IFEct) <span class="citation">Xu (<a href="#ref-xu2017generalized">2017</a>)</span>:
<ul>
<li>When we suspect unobserved time-varying confounder, FEct fails. Instead, IFEct uses the factor-augmented models to relax the strict exogeneity assumption where the effects of unobservables can be decomposed to unit FE + time FE + unit x time FE.</li>
<li>Generalized Synthetic Controls are a subset of IFEct when treatments don’t revert.</li>
</ul></li>
<li><a href="methods-for-handling-missing-data.html#matrix-completion">Matrix completion</a> (MC) <span class="citation">(<a href="#ref-athey2021matrix">Athey et al. 2021</a>)</span>:
<ul>
<li>Generalization of factor-augmented models. Different from IFEct which uses hard impute, MC uses soft impute to regularize the singular values when decomposing the residual matrix.</li>
<li>Only when latent factors (of unobservables) are strong and sparse, IFEct outperforms MC.</li>
</ul></li>
<li>[Synthetic Controls] (case studies)</li>
</ul></li>
</ul>
<p><strong>Identifying Assumptions</strong>:</p>
<ol style="list-style-type: decimal">
<li><strong>Function Form</strong>: Additive separability of observables, unobservables, and idiosyncratic error term.
<ul>
<li>Hence, these models are scale dependent <span class="citation">(<a href="#ref-athey2006identification">Athey and Imbens 2006</a>)</span> (e.g., log-transform outcome can invadiate this assumption).</li>
</ul></li>
<li><strong>Strict Exogeneity</strong>: Conditional on observables and unobservables, potential outcomes are independent of treatment assignment (i.e., baseline quasi-randomization)
<ul>
<li>In DiD, where unobservables = unit + time FEs, this assumption is the parallel trends assumption</li>
</ul></li>
<li><strong>Low-dimensional Decomposition (Feasibility Assumption)</strong>: Unobservable effects can be decomposed in low-dimension.
<ul>
<li>For the case that <span class="math inline">\(U_{it} = f_t \times \lambda_i\)</span> where <span class="math inline">\(f_t\)</span> = common time trend (time FE), and <span class="math inline">\(\lambda_i\)</span> = unit heterogeneity (unit FE). If <span class="math inline">\(U_{it} = f_t \times \lambda_i\)</span> , DiD can satisfy this assumption. But this assumption is weaker than that of DID, and allows us to control for unobservables based on data.</li>
</ul></li>
</ol>
<p><strong>Estimation Procedure</strong>:</p>
<ol style="list-style-type: decimal">
<li>Using all control observations, estimate the functions of both observable and unobservable variables (relying on Assumptions 1 and 3).</li>
<li>Predict the counterfactual outcomes for each treated unit using the obtained functions.</li>
<li>Calculate the difference in treatment effect for each treated individual.</li>
<li>By averaging over all treated individuals, you can obtain the Average Treatment Effect on the Treated (ATT).</li>
</ol>
<p>Notes:</p>
<ul>
<li>Use jackknife when number of treated units is small <span class="citation">(<a href="#ref-liu2022practical">Liu, Wang, and Xu 2022, 166</a>)</span>.</li>
</ul>
<div id="imputation-method" class="section level5 hasAnchor" number="30.11.3.2.1">
<h5><span class="header-section-number">30.11.3.2.1</span> Imputation Method<a href="remedies-for-staggered-did-biases.html#imputation-method" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="citation">Liu, Wang, and Xu (<a href="#ref-liu2022practical">2022</a>)</span> can also account for treatment reversals and heterogeneous treatment effects.</p>
<p>Other imputation estimators include</p>
<ul>
<li><p><span class="citation">(<a href="#ref-gardner2022two">Gardner 2022</a>; <a href="#ref-borusyak2021revisiting">Borusyak, Jaravel, and Spiess 2021</a>)</span></p></li>
<li><p><span class="citation">(<a href="#ref-brown2023simple">N. Brown, Butts, and Westerlund 2023</a>)</span></p></li>
</ul>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="remedies-for-staggered-did-biases.html#cb790-1" tabindex="-1"></a><span class="fu">library</span>(fect)</span>
<span id="cb790-2"><a href="remedies-for-staggered-did-biases.html#cb790-2" tabindex="-1"></a></span>
<span id="cb790-3"><a href="remedies-for-staggered-did-biases.html#cb790-3" tabindex="-1"></a>PanelMatch<span class="sc">::</span>dem</span>
<span id="cb790-4"><a href="remedies-for-staggered-did-biases.html#cb790-4" tabindex="-1"></a></span>
<span id="cb790-5"><a href="remedies-for-staggered-did-biases.html#cb790-5" tabindex="-1"></a>model.fect <span class="ot">&lt;-</span></span>
<span id="cb790-6"><a href="remedies-for-staggered-did-biases.html#cb790-6" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb790-7"><a href="remedies-for-staggered-did-biases.html#cb790-7" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb790-8"><a href="remedies-for-staggered-did-biases.html#cb790-8" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb790-9"><a href="remedies-for-staggered-did-biases.html#cb790-9" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb790-10"><a href="remedies-for-staggered-did-biases.html#cb790-10" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb790-11"><a href="remedies-for-staggered-did-biases.html#cb790-11" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb790-12"><a href="remedies-for-staggered-did-biases.html#cb790-12" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb790-13"><a href="remedies-for-staggered-did-biases.html#cb790-13" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-14"><a href="remedies-for-staggered-did-biases.html#cb790-14" tabindex="-1"></a>        <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-15"><a href="remedies-for-staggered-did-biases.html#cb790-15" tabindex="-1"></a>        <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb790-16"><a href="remedies-for-staggered-did-biases.html#cb790-16" tabindex="-1"></a>        <span class="co"># twfe</span></span>
<span id="cb790-17"><a href="remedies-for-staggered-did-biases.html#cb790-17" tabindex="-1"></a>        <span class="at">force =</span> <span class="st">&quot;two-way&quot;</span></span>
<span id="cb790-18"><a href="remedies-for-staggered-did-biases.html#cb790-18" tabindex="-1"></a>    )</span>
<span id="cb790-19"><a href="remedies-for-staggered-did-biases.html#cb790-19" tabindex="-1"></a><span class="fu">print</span>(model.fect<span class="sc">$</span>est.avg)</span>
<span id="cb790-20"><a href="remedies-for-staggered-did-biases.html#cb790-20" tabindex="-1"></a></span>
<span id="cb790-21"><a href="remedies-for-staggered-did-biases.html#cb790-21" tabindex="-1"></a><span class="fu">plot</span>(model.fect)</span>
<span id="cb790-22"><a href="remedies-for-staggered-did-biases.html#cb790-22" tabindex="-1"></a></span>
<span id="cb790-23"><a href="remedies-for-staggered-did-biases.html#cb790-23" tabindex="-1"></a><span class="fu">plot</span>(model.fect, <span class="at">stats =</span> <span class="st">&quot;F.p&quot;</span>)</span></code></pre></div>
<p>F-test <span class="math inline">\(H_0\)</span>: residual averages in the pre-treatment periods = 0</p>
<p>To see treatment reversal effects</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="remedies-for-staggered-did-biases.html#cb791-1" tabindex="-1"></a><span class="fu">plot</span>(model.fect, <span class="at">stats =</span> <span class="st">&quot;F.p&quot;</span>, <span class="at">type =</span> <span class="st">&#39;exit&#39;</span>)</span></code></pre></div>
</div>
<div id="placebo-test" class="section level5 hasAnchor" number="30.11.3.2.2">
<h5><span class="header-section-number">30.11.3.2.2</span> Placebo Test<a href="remedies-for-staggered-did-biases.html#placebo-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>By selecting a part of the data and excluding observations within a specified range to improve the model fitting, we then evaluate whether the estimated Average Treatment Effect (ATT) within this range significantly differs from zero. This approach helps us analyze the periods before treatment.</p>
<p>If this test fails, either the functional form or strict exogeneity assumption is problematic.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="remedies-for-staggered-did-biases.html#cb792-1" tabindex="-1"></a>out.fect.p <span class="ot">&lt;-</span></span>
<span id="cb792-2"><a href="remedies-for-staggered-did-biases.html#cb792-2" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb792-3"><a href="remedies-for-staggered-did-biases.html#cb792-3" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb792-4"><a href="remedies-for-staggered-did-biases.html#cb792-4" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb792-5"><a href="remedies-for-staggered-did-biases.html#cb792-5" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb792-6"><a href="remedies-for-staggered-did-biases.html#cb792-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb792-7"><a href="remedies-for-staggered-did-biases.html#cb792-7" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb792-8"><a href="remedies-for-staggered-did-biases.html#cb792-8" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb792-9"><a href="remedies-for-staggered-did-biases.html#cb792-9" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb792-10"><a href="remedies-for-staggered-did-biases.html#cb792-10" tabindex="-1"></a>        <span class="at">placeboTest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb792-11"><a href="remedies-for-staggered-did-biases.html#cb792-11" tabindex="-1"></a>        <span class="co"># using 3 periods</span></span>
<span id="cb792-12"><a href="remedies-for-staggered-did-biases.html#cb792-12" tabindex="-1"></a>        <span class="at">placebo.period =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb792-13"><a href="remedies-for-staggered-did-biases.html#cb792-13" tabindex="-1"></a>    )</span>
<span id="cb792-14"><a href="remedies-for-staggered-did-biases.html#cb792-14" tabindex="-1"></a><span class="fu">plot</span>(out.fect.p, <span class="at">proportion =</span> <span class="fl">0.1</span>, <span class="at">stats =</span> <span class="st">&quot;placebo.p&quot;</span>)</span></code></pre></div>
</div>
<div id="no-carryover-effects-test" class="section level5 hasAnchor" number="30.11.3.2.3">
<h5><span class="header-section-number">30.11.3.2.3</span> (No) Carryover Effects Test<a href="remedies-for-staggered-did-biases.html#no-carryover-effects-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The placebo test can be adapted to assess carryover effects by masking several post-treatment periods instead of pre-treatment ones. If no carryover effects are present, the average prediction error should approximate zero. For the carryover test, set <code>carryoverTest = TRUE</code>. Specify a post-treatment period range in carryover.period to exclude observations for model fitting, then evaluate if the estimated ATT significantly deviates from zero.</p>
<p>Even if we have carryover effects, in most cases of the staggered adoption setting, researchers are interested in the cumulative effects, or aggregated treatment effects, so it’s okay.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="remedies-for-staggered-did-biases.html#cb793-1" tabindex="-1"></a>out.fect.c <span class="ot">&lt;-</span></span>
<span id="cb793-2"><a href="remedies-for-staggered-did-biases.html#cb793-2" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb793-3"><a href="remedies-for-staggered-did-biases.html#cb793-3" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb793-4"><a href="remedies-for-staggered-did-biases.html#cb793-4" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb793-5"><a href="remedies-for-staggered-did-biases.html#cb793-5" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb793-6"><a href="remedies-for-staggered-did-biases.html#cb793-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb793-7"><a href="remedies-for-staggered-did-biases.html#cb793-7" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb793-8"><a href="remedies-for-staggered-did-biases.html#cb793-8" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb793-9"><a href="remedies-for-staggered-did-biases.html#cb793-9" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb793-10"><a href="remedies-for-staggered-did-biases.html#cb793-10" tabindex="-1"></a>        <span class="at">carryoverTest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb793-11"><a href="remedies-for-staggered-did-biases.html#cb793-11" tabindex="-1"></a>        <span class="co"># how many periods of carryover</span></span>
<span id="cb793-12"><a href="remedies-for-staggered-did-biases.html#cb793-12" tabindex="-1"></a>        <span class="at">carryover.period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb793-13"><a href="remedies-for-staggered-did-biases.html#cb793-13" tabindex="-1"></a>    )</span>
<span id="cb793-14"><a href="remedies-for-staggered-did-biases.html#cb793-14" tabindex="-1"></a><span class="fu">plot</span>(out.fect.c,  <span class="at">stats =</span> <span class="st">&quot;carryover.p&quot;</span>)</span></code></pre></div>
<p>We have evidence of carryover effects.</p>
</div>
</div>
<div id="matrix-completion-1" class="section level4 hasAnchor" number="30.11.3.3">
<h4><span class="header-section-number">30.11.3.3</span> Matrix Completion<a href="remedies-for-staggered-did-biases.html#matrix-completion-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Applications in marketing:</p>
<ul>
<li><span class="citation">Bronnenberg, Dubé, and Sanders (<a href="#ref-bronnenberg2020consumer">2020</a>)</span></li>
</ul>
<p>To estimate average causal effects in panel data with units exposed to treatment intermittently, two literatures are pivotal:</p>
<ul>
<li><p><strong>Unconfoundedness</strong> <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span>: Imputes missing potential control outcomes for treated units using observed outcomes from similar control units in previous periods.</p></li>
<li><p><strong>Synthetic Control</strong> <span class="citation">(<a href="#ref-abadie2010synthetic">Abadie, Diamond, and Hainmueller 2010</a>)</span>: Imputes missing control outcomes for treated units using weighted averages from control units, matching lagged outcomes between treated and control units.</p></li>
</ul>
<p>Both exploit missing potential outcomes under different assumptions:</p>
<ul>
<li><p>Unconfoundedness assumes time patterns are stable across units.</p></li>
<li><p>Synthetic control assumes unit patterns are stable over time.</p></li>
</ul>
<p>Once regularization is applied, both approaches are applicable in similar settings <span class="citation">(<a href="#ref-athey2021matrix">Athey et al. 2021</a>)</span>.</p>
<p><strong>Matrix Completion</strong> method, nesting both, is based on matrix factorization, focusing on imputing missing matrix elements assuming:</p>
<ol style="list-style-type: decimal">
<li>Complete matrix = low-rank matrix + noise.</li>
<li>Missingness is completely at random.</li>
</ol>
<p>It’s distinguished by not imposing factorization restrictions but utilizing regularization to define the estimator, particularly effective with the nuclear norm as a regularizer for complex missing patterns <span class="citation">(<a href="#ref-athey2021matrix">Athey et al. 2021</a>)</span>.</p>
<p>Contributions of <span class="citation">Athey et al. (<a href="#ref-athey2021matrix">2021</a>)</span> matrix completion include:</p>
<ol style="list-style-type: decimal">
<li>Recognizing structured missing patterns allowing time correlation, enabling staggered adoption.</li>
<li>Modifying estimators for unregularized unit and time fixed effects.</li>
<li>Performing well across various <span class="math inline">\(T\)</span> and <span class="math inline">\(N\)</span> sizes, unlike unconfoundedness and synthetic control, which falter when <span class="math inline">\(T &gt;&gt; N\)</span> or <span class="math inline">\(N &gt;&gt; T\)</span>, respectively.</li>
</ol>
<p>Identifying Assumptions:</p>
<ol style="list-style-type: decimal">
<li>SUTVA: Potential outcomes indexed only by the unit’s contemporaneous treatment.</li>
<li>No dynamic effects (it’s okay under staggered adoption, it gives a different interpretation of estimand).</li>
</ol>
<p>Setup:</p>
<ul>
<li><span class="math inline">\(Y_{it}(0)\)</span> and <span class="math inline">\(Y_{it}(1)\)</span> represent potential outcomes of <span class="math inline">\(Y_{it}\)</span>.</li>
<li><span class="math inline">\(W_{it}\)</span> is a binary treatment indicator.</li>
</ul>
<p>Aim to estimate the average effect for the treated:</p>
<p><span class="math display">\[
\tau = \frac{\sum_{(i,t): W_{it} = 1}[Y_{it}(1) - Y_{it}(0)]}{\sum_{i,t}W_{it}}
\]</span></p>
<p>We observe all relevant values for <span class="math inline">\(Y_{it}(1)\)</span></p>
<p>We want to impute missing entries in the <span class="math inline">\(Y(0)\)</span> matrix for treated units with <span class="math inline">\(W_{it} = 1\)</span>.</p>
<p>Define <span class="math inline">\(\mathcal{M}\)</span> as the set of pairs of indices <span class="math inline">\((i,t)\)</span>, where <span class="math inline">\(i \in N\)</span> and <span class="math inline">\(t \in T\)</span>, corresponding to missing entries with <span class="math inline">\(W_{it} = 1\)</span>; <span class="math inline">\(\mathcal{O}\)</span> as the set of pairs of indices corresponding to observed entries in <span class="math inline">\(Y(0)\)</span> with <span class="math inline">\(W_{it} = 0\)</span>.</p>
<p>Data is conceptualized as two <span class="math inline">\(N \times T\)</span> matrices, one incomplete and one complete:</p>
<p><span class="math display">\[
Y = \begin{pmatrix}
Y_{11} &amp; Y_{12} &amp; ? &amp; \cdots &amp; Y_{1T} \\
? &amp; ? &amp; Y_{23} &amp; \cdots &amp; ? \\
Y_{31} &amp; ? &amp; Y_{33} &amp; \cdots &amp; ? \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
Y_{N1} &amp; ? &amp; Y_{N3} &amp; \cdots &amp; ?
\end{pmatrix},
\]</span></p>
<p>and</p>
<p><span class="math display">\[
W = \begin{pmatrix}
0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; \cdots &amp; 1 \\
0 &amp; 1 &amp; 0 &amp; \cdots &amp; 1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 1 &amp; 0 &amp; \cdots &amp; 1
\end{pmatrix},
\]</span></p>
<p>where</p>
<p><span class="math display">\[
W_{it} =
\begin{cases}
1 &amp; \text{if } (i,t) \in \mathcal{M}, \\
0 &amp; \text{if } (i,t) \in \mathcal{O},
\end{cases}
\]</span></p>
<p>is an indicator for the event that the corresponding component of <span class="math inline">\(Y\)</span>, that is <span class="math inline">\(Y_{it}\)</span>, is missing.</p>
<p>Patterns of missing data in <span class="math inline">\(\mathbf{Y}\)</span>:</p>
<ul>
<li><p>Block (treatment) structure with 2 special cases</p>
<ul>
<li><p>Single-treated-period block structure <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span></p></li>
<li><p>Single-treated-unit block structure <span class="citation">(<a href="#ref-abadie2010synthetic">Abadie, Diamond, and Hainmueller 2010</a>)</span></p></li>
</ul></li>
<li><p>Staggered Adoption</p></li>
</ul>
<p>Shape of matrix <span class="math inline">\(\mathbf{Y}\)</span>:</p>
<ul>
<li><p>Thin (<span class="math inline">\(N &gt;&gt; T\)</span>)</p></li>
<li><p>Fat (<span class="math inline">\(T &gt;&gt; N\)</span>)</p></li>
<li><p>Square (<span class="math inline">\(N \approx T\)</span>)</p></li>
</ul>
<p>Combinations of patterns of missingness and shape create different literatures:</p>
<ul>
<li><p>Horizontal Regression = Thin matrix + single-treated-period block (focusing on cross-section correlation patterns)</p></li>
<li><p>Vertical Regression = Fat matrix + single-treated-unit block (focusing on time-series correlation patterns)</p></li>
<li><p>TWFE = Square matrix</p></li>
</ul>
<p>To combine, we can exploit both stable patterns over time, and across units (e.g., TWFE, interactive FEs or matrix completion).</p>
<p>For the same factor model</p>
<p><span class="math display">\[
\mathbf{Y = UV}^T + \mathbf{\epsilon}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{U}\)</span> is <span class="math inline">\(N \times R\)</span> and <span class="math inline">\(\mathbf{V}\)</span> is <span class="math inline">\(T\times R\)</span></p>
<p>The interactive FE literature focuses on a fixed number of factors <span class="math inline">\(R\)</span> in <span class="math inline">\(\mathbf{U, V}\)</span>, while matrix completion focuses on impute <span class="math inline">\(\mathbf{Y}\)</span> using some forms regularization (e.g., nuclear norm).</p>
<ul>
<li>We can also estimate the number of factors <span class="math inline">\(R\)</span> <span class="citation">Moon and Weidner (<a href="#ref-moon2015linear">2015</a>)</span></li>
</ul>
<p>To use the nuclear norm minimization estimator, we must add a penalty term to regularize the objective function. However, before doing so, we need to explicitly estimate the time (<span class="math inline">\(\lambda_t\)</span>) and unit (<span class="math inline">\(\mu_i\)</span>) fixed effects implicitly embedded in the missing data matrix to reduce the bias of the regularization term.</p>
<p><a href="https://bookdown.org/stanfordgsbsilab/ml-ci-tutorial/matrix-completion-methods.html">Specifically</a>,</p>
<p><span class="math display">\[
Y_{it}  =L_{it} + \sum_{p = 1}^P \sum_{q= 1}^Q X_{ip} H_{pq}Z_{qt} + \mu_i + \lambda_t + V_{it} \beta + \epsilon_{it}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(X_{ip}\)</span> is a matrix of <span class="math inline">\(p\)</span> variables for unit <span class="math inline">\(i\)</span></p></li>
<li><p><span class="math inline">\(Z_{qt}\)</span> is a matrix of <span class="math inline">\(q\)</span> variables for time <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(V_{it}\)</span> is a matrix of time-varying variables.</p></li>
</ul>
<p>Lasso-type <span class="math inline">\(l_1\)</span> norm (<span class="math inline">\(||H|| = \sum_{p = 1}^p \sum_{q = 1}^Q |H_{pq}|\)</span>) is used to shrink <span class="math inline">\(H \to 0\)</span></p>
<p>There are several options to regularize <span class="math inline">\(L\)</span>:</p>
<ol style="list-style-type: decimal">
<li>Frobenius (i.e., Ridge): not informative since it imputes missing values as 0.</li>
<li>Nuclear Norm (i.e., Lasso): computationally feasible (using SOFT-IMPUTE algorithm <span class="citation">(<a href="#ref-mazumder2010spectral">Mazumder, Hastie, and Tibshirani 2010</a>)</span>).</li>
<li>Rank (i.e., Subset selection): not computationally feasible</li>
</ol>
<p>This method allows to</p>
<ul>
<li><p>use more covariates</p></li>
<li><p>leverage data from treated units (can be used when treatment effect is constant and pattern of missing is not complex).</p></li>
<li><p>have autocorrelated errors</p></li>
<li><p>have weighted loss function (i.e., take into account the probability of outcomes for a unit being missing)</p></li>
</ul>
</div>
</div>
<div id="gardner2022two-and-borusyak2024revisiting" class="section level3 hasAnchor" number="30.11.4">
<h3><span class="header-section-number">30.11.4</span> <span class="citation">Gardner (<a href="#ref-gardner2022two">2022</a>)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span><a href="remedies-for-staggered-did-biases.html#gardner2022two-and-borusyak2024revisiting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Estimate the time and unit fixed effects separately</p></li>
<li><p>Known as the imputation method <span class="citation">(<a href="#ref-borusyak2024revisiting">Borusyak, Jaravel, and Spiess 2024</a>)</span> or two-stage DiD <span class="citation">(<a href="#ref-gardner2022two">Gardner 2022</a>)</span></p></li>
</ul>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="remedies-for-staggered-did-biases.html#cb794-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;kylebutts/did2s&quot;)</span></span>
<span id="cb794-2"><a href="remedies-for-staggered-did-biases.html#cb794-2" tabindex="-1"></a><span class="fu">library</span>(did2s)</span>
<span id="cb794-3"><a href="remedies-for-staggered-did-biases.html#cb794-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb794-4"><a href="remedies-for-staggered-did-biases.html#cb794-4" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb794-5"><a href="remedies-for-staggered-did-biases.html#cb794-5" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb794-6"><a href="remedies-for-staggered-did-biases.html#cb794-6" tabindex="-1"></a><span class="fu">data</span>(base_stagg)</span>
<span id="cb794-7"><a href="remedies-for-staggered-did-biases.html#cb794-7" tabindex="-1"></a></span>
<span id="cb794-8"><a href="remedies-for-staggered-did-biases.html#cb794-8" tabindex="-1"></a></span>
<span id="cb794-9"><a href="remedies-for-staggered-did-biases.html#cb794-9" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">did2s</span>(</span>
<span id="cb794-10"><a href="remedies-for-staggered-did-biases.html#cb794-10" tabindex="-1"></a>    <span class="at">data =</span> base_stagg <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">if_else</span>(time_to_treatment <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb794-11"><a href="remedies-for-staggered-did-biases.html#cb794-11" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb794-12"><a href="remedies-for-staggered-did-biases.html#cb794-12" tabindex="-1"></a>    <span class="at">first_stage =</span> <span class="sc">~</span> x1 <span class="sc">|</span> id <span class="sc">+</span> year,</span>
<span id="cb794-13"><a href="remedies-for-staggered-did-biases.html#cb794-13" tabindex="-1"></a>    <span class="at">second_stage =</span> <span class="sc">~</span> <span class="fu">i</span>(time_to_treatment, <span class="at">ref =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1000</span>)),</span>
<span id="cb794-14"><a href="remedies-for-staggered-did-biases.html#cb794-14" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;treat&quot;</span> ,</span>
<span id="cb794-15"><a href="remedies-for-staggered-did-biases.html#cb794-15" tabindex="-1"></a>    <span class="at">cluster_var =</span> <span class="st">&quot;id&quot;</span></span>
<span id="cb794-16"><a href="remedies-for-staggered-did-biases.html#cb794-16" tabindex="-1"></a>)</span>
<span id="cb794-17"><a href="remedies-for-staggered-did-biases.html#cb794-17" tabindex="-1"></a></span>
<span id="cb794-18"><a href="remedies-for-staggered-did-biases.html#cb794-18" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">esttable</span>(est)</span>
<span id="cb794-19"><a href="remedies-for-staggered-did-biases.html#cb794-19" tabindex="-1"></a><span class="co">#&gt;                                       est</span></span>
<span id="cb794-20"><a href="remedies-for-staggered-did-biases.html#cb794-20" tabindex="-1"></a><span class="co">#&gt; Dependent Var.:                         y</span></span>
<span id="cb794-21"><a href="remedies-for-staggered-did-biases.html#cb794-21" tabindex="-1"></a><span class="co">#&gt;                                          </span></span>
<span id="cb794-22"><a href="remedies-for-staggered-did-biases.html#cb794-22" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -9  0.3518** (0.1332)</span></span>
<span id="cb794-23"><a href="remedies-for-staggered-did-biases.html#cb794-23" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -8  -0.3130* (0.1213)</span></span>
<span id="cb794-24"><a href="remedies-for-staggered-did-biases.html#cb794-24" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -7    0.0894 (0.2367)</span></span>
<span id="cb794-25"><a href="remedies-for-staggered-did-biases.html#cb794-25" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -6    0.0312 (0.2176)</span></span>
<span id="cb794-26"><a href="remedies-for-staggered-did-biases.html#cb794-26" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -5   -0.2079 (0.1519)</span></span>
<span id="cb794-27"><a href="remedies-for-staggered-did-biases.html#cb794-27" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -4   -0.1152 (0.1438)</span></span>
<span id="cb794-28"><a href="remedies-for-staggered-did-biases.html#cb794-28" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -3   -0.0127 (0.1483)</span></span>
<span id="cb794-29"><a href="remedies-for-staggered-did-biases.html#cb794-29" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -2    0.1503 (0.1440)</span></span>
<span id="cb794-30"><a href="remedies-for-staggered-did-biases.html#cb794-30" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 0  -5.139*** (0.3680)</span></span>
<span id="cb794-31"><a href="remedies-for-staggered-did-biases.html#cb794-31" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 1  -3.480*** (0.3784)</span></span>
<span id="cb794-32"><a href="remedies-for-staggered-did-biases.html#cb794-32" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 2  -2.021*** (0.3055)</span></span>
<span id="cb794-33"><a href="remedies-for-staggered-did-biases.html#cb794-33" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 3   -0.6965. (0.3947)</span></span>
<span id="cb794-34"><a href="remedies-for-staggered-did-biases.html#cb794-34" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 4    1.070** (0.3501)</span></span>
<span id="cb794-35"><a href="remedies-for-staggered-did-biases.html#cb794-35" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 5   2.173*** (0.4456)</span></span>
<span id="cb794-36"><a href="remedies-for-staggered-did-biases.html#cb794-36" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 6   4.449*** (0.3680)</span></span>
<span id="cb794-37"><a href="remedies-for-staggered-did-biases.html#cb794-37" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 7   4.864*** (0.3698)</span></span>
<span id="cb794-38"><a href="remedies-for-staggered-did-biases.html#cb794-38" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 8   6.187*** (0.2702)</span></span>
<span id="cb794-39"><a href="remedies-for-staggered-did-biases.html#cb794-39" tabindex="-1"></a><span class="co">#&gt; ______________________ __________________</span></span>
<span id="cb794-40"><a href="remedies-for-staggered-did-biases.html#cb794-40" tabindex="-1"></a><span class="co">#&gt; S.E. type                          Custom</span></span>
<span id="cb794-41"><a href="remedies-for-staggered-did-biases.html#cb794-41" tabindex="-1"></a><span class="co">#&gt; Observations                          950</span></span>
<span id="cb794-42"><a href="remedies-for-staggered-did-biases.html#cb794-42" tabindex="-1"></a><span class="co">#&gt; R2                                0.62486</span></span>
<span id="cb794-43"><a href="remedies-for-staggered-did-biases.html#cb794-43" tabindex="-1"></a><span class="co">#&gt; Adj. R2                           0.61843</span></span>
<span id="cb794-44"><a href="remedies-for-staggered-did-biases.html#cb794-44" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb794-45"><a href="remedies-for-staggered-did-biases.html#cb794-45" tabindex="-1"></a><span class="co">#&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb794-46"><a href="remedies-for-staggered-did-biases.html#cb794-46" tabindex="-1"></a></span>
<span id="cb794-47"><a href="remedies-for-staggered-did-biases.html#cb794-47" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">iplot</span>(</span>
<span id="cb794-48"><a href="remedies-for-staggered-did-biases.html#cb794-48" tabindex="-1"></a>    est,</span>
<span id="cb794-49"><a href="remedies-for-staggered-did-biases.html#cb794-49" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Event study&quot;</span>,</span>
<span id="cb794-50"><a href="remedies-for-staggered-did-biases.html#cb794-50" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Time to treatment&quot;</span>,</span>
<span id="cb794-51"><a href="remedies-for-staggered-did-biases.html#cb794-51" tabindex="-1"></a>    <span class="at">ref.line =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb794-52"><a href="remedies-for-staggered-did-biases.html#cb794-52" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="remedies-for-staggered-did-biases.html#cb795-1" tabindex="-1"></a></span>
<span id="cb795-2"><a href="remedies-for-staggered-did-biases.html#cb795-2" tabindex="-1"></a><span class="fu">coefplot</span>(est)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-33-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="remedies-for-staggered-did-biases.html#cb796-1" tabindex="-1"></a>mult_est <span class="ot">&lt;-</span> did2s<span class="sc">::</span><span class="fu">event_study</span>(</span>
<span id="cb796-2"><a href="remedies-for-staggered-did-biases.html#cb796-2" tabindex="-1"></a>    <span class="at">data =</span> fixest<span class="sc">::</span>base_stagg <span class="sc">|&gt;</span></span>
<span id="cb796-3"><a href="remedies-for-staggered-did-biases.html#cb796-3" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_treated =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(year_treated <span class="sc">==</span> <span class="dv">10000</span>, <span class="dv">0</span>, year_treated)),</span>
<span id="cb796-4"><a href="remedies-for-staggered-did-biases.html#cb796-4" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb796-5"><a href="remedies-for-staggered-did-biases.html#cb796-5" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb796-6"><a href="remedies-for-staggered-did-biases.html#cb796-6" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb796-7"><a href="remedies-for-staggered-did-biases.html#cb796-7" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb796-8"><a href="remedies-for-staggered-did-biases.html#cb796-8" tabindex="-1"></a>    <span class="at">estimator =</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb796-9"><a href="remedies-for-staggered-did-biases.html#cb796-9" tabindex="-1"></a>)</span>
<span id="cb796-10"><a href="remedies-for-staggered-did-biases.html#cb796-10" tabindex="-1"></a><span class="co">#&gt; Error in purrr::map(., function(y) { : ℹ In index: 1.</span></span>
<span id="cb796-11"><a href="remedies-for-staggered-did-biases.html#cb796-11" tabindex="-1"></a><span class="co">#&gt; ℹ With name: y.</span></span>
<span id="cb796-12"><a href="remedies-for-staggered-did-biases.html#cb796-12" tabindex="-1"></a><span class="co">#&gt; Caused by error in `.subset2()`:</span></span>
<span id="cb796-13"><a href="remedies-for-staggered-did-biases.html#cb796-13" tabindex="-1"></a><span class="co">#&gt; ! no such index at level 1</span></span>
<span id="cb796-14"><a href="remedies-for-staggered-did-biases.html#cb796-14" tabindex="-1"></a>did2s<span class="sc">::</span><span class="fu">plot_event_study</span>(mult_est)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-34-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span> <code>didimputation</code></p>
<p>This version is currently not working</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="remedies-for-staggered-did-biases.html#cb797-1" tabindex="-1"></a><span class="fu">library</span>(didimputation)</span>
<span id="cb797-2"><a href="remedies-for-staggered-did-biases.html#cb797-2" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb797-3"><a href="remedies-for-staggered-did-biases.html#cb797-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb797-4"><a href="remedies-for-staggered-did-biases.html#cb797-4" tabindex="-1"></a></span>
<span id="cb797-5"><a href="remedies-for-staggered-did-biases.html#cb797-5" tabindex="-1"></a><span class="fu">did_imputation</span>(</span>
<span id="cb797-6"><a href="remedies-for-staggered-did-biases.html#cb797-6" tabindex="-1"></a>    <span class="at">data =</span> base_stagg,</span>
<span id="cb797-7"><a href="remedies-for-staggered-did-biases.html#cb797-7" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb797-8"><a href="remedies-for-staggered-did-biases.html#cb797-8" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb797-9"><a href="remedies-for-staggered-did-biases.html#cb797-9" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb797-10"><a href="remedies-for-staggered-did-biases.html#cb797-10" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span></span>
<span id="cb797-11"><a href="remedies-for-staggered-did-biases.html#cb797-11" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="de2020two" class="section level3 hasAnchor" number="30.11.5">
<h3><span class="header-section-number">30.11.5</span> <span class="citation">Clément De Chaisemartin and d’Haultfoeuille (<a href="#ref-de2020two">2020</a>)</span><a href="remedies-for-staggered-did-biases.html#de2020two" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>use <code>twowayfeweights</code> from <a href="https://github.com/shuo-zhang-ucsb/twowayfeweights">GitHub</a> <span class="citation">(<a href="#ref-de2020two">Clément De Chaisemartin and d’Haultfoeuille 2020</a>)</span></p>
<ul>
<li><p>Average instant treatment effect of changes in the treatment</p>
<ul>
<li>This relaxes the no-carryover-effect assumption.</li>
</ul></li>
<li><p>Drawbacks:</p>
<ul>
<li>Cannot observe treatment effects that manifest over time.</li>
</ul></li>
</ul>
<p>There still isn’t a good package for this estimator.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="remedies-for-staggered-did-biases.html#cb798-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;shuo-zhang-ucsb/did_multiplegt&quot;) </span></span>
<span id="cb798-2"><a href="remedies-for-staggered-did-biases.html#cb798-2" tabindex="-1"></a><span class="fu">library</span>(DIDmultiplegt)</span>
<span id="cb798-3"><a href="remedies-for-staggered-did-biases.html#cb798-3" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb798-4"><a href="remedies-for-staggered-did-biases.html#cb798-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb798-5"><a href="remedies-for-staggered-did-biases.html#cb798-5" tabindex="-1"></a></span>
<span id="cb798-6"><a href="remedies-for-staggered-did-biases.html#cb798-6" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb798-7"><a href="remedies-for-staggered-did-biases.html#cb798-7" tabindex="-1"></a></span>
<span id="cb798-8"><a href="remedies-for-staggered-did-biases.html#cb798-8" tabindex="-1"></a>res <span class="ot">&lt;-</span></span>
<span id="cb798-9"><a href="remedies-for-staggered-did-biases.html#cb798-9" tabindex="-1"></a>    <span class="fu">did_multiplegt</span>(</span>
<span id="cb798-10"><a href="remedies-for-staggered-did-biases.html#cb798-10" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;dyn&quot;</span>,</span>
<span id="cb798-11"><a href="remedies-for-staggered-did-biases.html#cb798-11" tabindex="-1"></a>        <span class="at">df =</span> base_stagg <span class="sc">|&gt;</span></span>
<span id="cb798-12"><a href="remedies-for-staggered-did-biases.html#cb798-12" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(time_to_treatment <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb798-13"><a href="remedies-for-staggered-did-biases.html#cb798-13" tabindex="-1"></a>        <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb798-14"><a href="remedies-for-staggered-did-biases.html#cb798-14" tabindex="-1"></a>        <span class="at">group =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb798-15"><a href="remedies-for-staggered-did-biases.html#cb798-15" tabindex="-1"></a>        <span class="at">time =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb798-16"><a href="remedies-for-staggered-did-biases.html#cb798-16" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb798-17"><a href="remedies-for-staggered-did-biases.html#cb798-17" tabindex="-1"></a>        <span class="at">effects =</span> <span class="dv">5</span>,</span>
<span id="cb798-18"><a href="remedies-for-staggered-did-biases.html#cb798-18" tabindex="-1"></a>        <span class="at">controls =</span> <span class="st">&quot;x1&quot;</span>,</span>
<span id="cb798-19"><a href="remedies-for-staggered-did-biases.html#cb798-19" tabindex="-1"></a>        <span class="at">placebo =</span> <span class="dv">2</span></span>
<span id="cb798-20"><a href="remedies-for-staggered-did-biases.html#cb798-20" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-36-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="remedies-for-staggered-did-biases.html#cb799-1" tabindex="-1"></a></span>
<span id="cb799-2"><a href="remedies-for-staggered-did-biases.html#cb799-2" tabindex="-1"></a><span class="fu">head</span>(res)</span>
<span id="cb799-3"><a href="remedies-for-staggered-did-biases.html#cb799-3" tabindex="-1"></a><span class="co">#&gt; $args</span></span>
<span id="cb799-4"><a href="remedies-for-staggered-did-biases.html#cb799-4" tabindex="-1"></a><span class="co">#&gt; $args$df</span></span>
<span id="cb799-5"><a href="remedies-for-staggered-did-biases.html#cb799-5" tabindex="-1"></a><span class="co">#&gt; ..1</span></span>
<span id="cb799-6"><a href="remedies-for-staggered-did-biases.html#cb799-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-7"><a href="remedies-for-staggered-did-biases.html#cb799-7" tabindex="-1"></a><span class="co">#&gt; $args$outcome</span></span>
<span id="cb799-8"><a href="remedies-for-staggered-did-biases.html#cb799-8" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y&quot;</span></span>
<span id="cb799-9"><a href="remedies-for-staggered-did-biases.html#cb799-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-10"><a href="remedies-for-staggered-did-biases.html#cb799-10" tabindex="-1"></a><span class="co">#&gt; $args$group</span></span>
<span id="cb799-11"><a href="remedies-for-staggered-did-biases.html#cb799-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;year_treated&quot;</span></span>
<span id="cb799-12"><a href="remedies-for-staggered-did-biases.html#cb799-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-13"><a href="remedies-for-staggered-did-biases.html#cb799-13" tabindex="-1"></a><span class="co">#&gt; $args$time</span></span>
<span id="cb799-14"><a href="remedies-for-staggered-did-biases.html#cb799-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;year&quot;</span></span>
<span id="cb799-15"><a href="remedies-for-staggered-did-biases.html#cb799-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-16"><a href="remedies-for-staggered-did-biases.html#cb799-16" tabindex="-1"></a><span class="co">#&gt; $args$treatment</span></span>
<span id="cb799-17"><a href="remedies-for-staggered-did-biases.html#cb799-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;treatment&quot;</span></span>
<span id="cb799-18"><a href="remedies-for-staggered-did-biases.html#cb799-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-19"><a href="remedies-for-staggered-did-biases.html#cb799-19" tabindex="-1"></a><span class="co">#&gt; $args$effects</span></span>
<span id="cb799-20"><a href="remedies-for-staggered-did-biases.html#cb799-20" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb799-21"><a href="remedies-for-staggered-did-biases.html#cb799-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-22"><a href="remedies-for-staggered-did-biases.html#cb799-22" tabindex="-1"></a><span class="co">#&gt; $args$normalized</span></span>
<span id="cb799-23"><a href="remedies-for-staggered-did-biases.html#cb799-23" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-24"><a href="remedies-for-staggered-did-biases.html#cb799-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-25"><a href="remedies-for-staggered-did-biases.html#cb799-25" tabindex="-1"></a><span class="co">#&gt; $args$normalized_weights</span></span>
<span id="cb799-26"><a href="remedies-for-staggered-did-biases.html#cb799-26" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-27"><a href="remedies-for-staggered-did-biases.html#cb799-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-28"><a href="remedies-for-staggered-did-biases.html#cb799-28" tabindex="-1"></a><span class="co">#&gt; $args$effects_equal</span></span>
<span id="cb799-29"><a href="remedies-for-staggered-did-biases.html#cb799-29" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-30"><a href="remedies-for-staggered-did-biases.html#cb799-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-31"><a href="remedies-for-staggered-did-biases.html#cb799-31" tabindex="-1"></a><span class="co">#&gt; $args$placebo</span></span>
<span id="cb799-32"><a href="remedies-for-staggered-did-biases.html#cb799-32" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb799-33"><a href="remedies-for-staggered-did-biases.html#cb799-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-34"><a href="remedies-for-staggered-did-biases.html#cb799-34" tabindex="-1"></a><span class="co">#&gt; $args$controls</span></span>
<span id="cb799-35"><a href="remedies-for-staggered-did-biases.html#cb799-35" tabindex="-1"></a><span class="co">#&gt; [1] &quot;x1&quot;</span></span>
<span id="cb799-36"><a href="remedies-for-staggered-did-biases.html#cb799-36" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-37"><a href="remedies-for-staggered-did-biases.html#cb799-37" tabindex="-1"></a><span class="co">#&gt; $args$trends_lin</span></span>
<span id="cb799-38"><a href="remedies-for-staggered-did-biases.html#cb799-38" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-39"><a href="remedies-for-staggered-did-biases.html#cb799-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-40"><a href="remedies-for-staggered-did-biases.html#cb799-40" tabindex="-1"></a><span class="co">#&gt; $args$same_switchers</span></span>
<span id="cb799-41"><a href="remedies-for-staggered-did-biases.html#cb799-41" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-42"><a href="remedies-for-staggered-did-biases.html#cb799-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-43"><a href="remedies-for-staggered-did-biases.html#cb799-43" tabindex="-1"></a><span class="co">#&gt; $args$same_switchers_pl</span></span>
<span id="cb799-44"><a href="remedies-for-staggered-did-biases.html#cb799-44" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-45"><a href="remedies-for-staggered-did-biases.html#cb799-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-46"><a href="remedies-for-staggered-did-biases.html#cb799-46" tabindex="-1"></a><span class="co">#&gt; $args$switchers</span></span>
<span id="cb799-47"><a href="remedies-for-staggered-did-biases.html#cb799-47" tabindex="-1"></a><span class="co">#&gt; [1] &quot;&quot;</span></span>
<span id="cb799-48"><a href="remedies-for-staggered-did-biases.html#cb799-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-49"><a href="remedies-for-staggered-did-biases.html#cb799-49" tabindex="-1"></a><span class="co">#&gt; $args$only_never_switchers</span></span>
<span id="cb799-50"><a href="remedies-for-staggered-did-biases.html#cb799-50" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-51"><a href="remedies-for-staggered-did-biases.html#cb799-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-52"><a href="remedies-for-staggered-did-biases.html#cb799-52" tabindex="-1"></a><span class="co">#&gt; $args$ci_level</span></span>
<span id="cb799-53"><a href="remedies-for-staggered-did-biases.html#cb799-53" tabindex="-1"></a><span class="co">#&gt; [1] 95</span></span>
<span id="cb799-54"><a href="remedies-for-staggered-did-biases.html#cb799-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-55"><a href="remedies-for-staggered-did-biases.html#cb799-55" tabindex="-1"></a><span class="co">#&gt; $args$graph_off</span></span>
<span id="cb799-56"><a href="remedies-for-staggered-did-biases.html#cb799-56" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-57"><a href="remedies-for-staggered-did-biases.html#cb799-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-58"><a href="remedies-for-staggered-did-biases.html#cb799-58" tabindex="-1"></a><span class="co">#&gt; $args$save_sample</span></span>
<span id="cb799-59"><a href="remedies-for-staggered-did-biases.html#cb799-59" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-60"><a href="remedies-for-staggered-did-biases.html#cb799-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-61"><a href="remedies-for-staggered-did-biases.html#cb799-61" tabindex="-1"></a><span class="co">#&gt; $args$less_conservative_se</span></span>
<span id="cb799-62"><a href="remedies-for-staggered-did-biases.html#cb799-62" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-63"><a href="remedies-for-staggered-did-biases.html#cb799-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-64"><a href="remedies-for-staggered-did-biases.html#cb799-64" tabindex="-1"></a><span class="co">#&gt; $args$dont_drop_larger_lower</span></span>
<span id="cb799-65"><a href="remedies-for-staggered-did-biases.html#cb799-65" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-66"><a href="remedies-for-staggered-did-biases.html#cb799-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-67"><a href="remedies-for-staggered-did-biases.html#cb799-67" tabindex="-1"></a><span class="co">#&gt; $args$drop_if_d_miss_before_first_switch</span></span>
<span id="cb799-68"><a href="remedies-for-staggered-did-biases.html#cb799-68" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span>
<span id="cb799-69"><a href="remedies-for-staggered-did-biases.html#cb799-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-70"><a href="remedies-for-staggered-did-biases.html#cb799-70" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-71"><a href="remedies-for-staggered-did-biases.html#cb799-71" tabindex="-1"></a><span class="co">#&gt; $results</span></span>
<span id="cb799-72"><a href="remedies-for-staggered-did-biases.html#cb799-72" tabindex="-1"></a><span class="co">#&gt; $results$N_Effects</span></span>
<span id="cb799-73"><a href="remedies-for-staggered-did-biases.html#cb799-73" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb799-74"><a href="remedies-for-staggered-did-biases.html#cb799-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-75"><a href="remedies-for-staggered-did-biases.html#cb799-75" tabindex="-1"></a><span class="co">#&gt; $results$N_Placebos</span></span>
<span id="cb799-76"><a href="remedies-for-staggered-did-biases.html#cb799-76" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb799-77"><a href="remedies-for-staggered-did-biases.html#cb799-77" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-78"><a href="remedies-for-staggered-did-biases.html#cb799-78" tabindex="-1"></a><span class="co">#&gt; $results$Effects</span></span>
<span id="cb799-79"><a href="remedies-for-staggered-did-biases.html#cb799-79" tabindex="-1"></a><span class="co">#&gt;              Estimate      SE    LB CI    UB CI  N Switchers N.w Switchers.w</span></span>
<span id="cb799-80"><a href="remedies-for-staggered-did-biases.html#cb799-80" tabindex="-1"></a><span class="co">#&gt; Effect_1     -5.21421 0.27175 -5.74682 -4.68160 54         9 675          45</span></span>
<span id="cb799-81"><a href="remedies-for-staggered-did-biases.html#cb799-81" tabindex="-1"></a><span class="co">#&gt; Effect_2     -3.59669 0.47006 -4.51800 -2.67538 44         8 580          40</span></span>
<span id="cb799-82"><a href="remedies-for-staggered-did-biases.html#cb799-82" tabindex="-1"></a><span class="co">#&gt; Effect_3     -2.18743 0.03341 -2.25292 -2.12194 35         7 490          35</span></span>
<span id="cb799-83"><a href="remedies-for-staggered-did-biases.html#cb799-83" tabindex="-1"></a><span class="co">#&gt; Effect_4     -0.90231 0.77905 -2.42922  0.62459 27         6 405          30</span></span>
<span id="cb799-84"><a href="remedies-for-staggered-did-biases.html#cb799-84" tabindex="-1"></a><span class="co">#&gt; Effect_5      0.98492 0.23620  0.52198  1.44786 20         5 325          25</span></span>
<span id="cb799-85"><a href="remedies-for-staggered-did-biases.html#cb799-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-86"><a href="remedies-for-staggered-did-biases.html#cb799-86" tabindex="-1"></a><span class="co">#&gt; $results$ATE</span></span>
<span id="cb799-87"><a href="remedies-for-staggered-did-biases.html#cb799-87" tabindex="-1"></a><span class="co">#&gt;              Estimate      SE LB CI    UB CI  N Switchers N.w Switchers.w</span></span>
<span id="cb799-88"><a href="remedies-for-staggered-did-biases.html#cb799-88" tabindex="-1"></a><span class="co">#&gt; Av_tot_eff   -2.61436 0.34472 -3.29 -1.93872 80        35 805         175</span></span>
<span id="cb799-89"><a href="remedies-for-staggered-did-biases.html#cb799-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-90"><a href="remedies-for-staggered-did-biases.html#cb799-90" tabindex="-1"></a><span class="co">#&gt; $results$delta_D_avg_total</span></span>
<span id="cb799-91"><a href="remedies-for-staggered-did-biases.html#cb799-91" tabindex="-1"></a><span class="co">#&gt; [1] 2.714286</span></span>
<span id="cb799-92"><a href="remedies-for-staggered-did-biases.html#cb799-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-93"><a href="remedies-for-staggered-did-biases.html#cb799-93" tabindex="-1"></a><span class="co">#&gt; $results$max_pl</span></span>
<span id="cb799-94"><a href="remedies-for-staggered-did-biases.html#cb799-94" tabindex="-1"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb799-95"><a href="remedies-for-staggered-did-biases.html#cb799-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-96"><a href="remedies-for-staggered-did-biases.html#cb799-96" tabindex="-1"></a><span class="co">#&gt; $results$max_pl_gap</span></span>
<span id="cb799-97"><a href="remedies-for-staggered-did-biases.html#cb799-97" tabindex="-1"></a><span class="co">#&gt; [1] 7</span></span>
<span id="cb799-98"><a href="remedies-for-staggered-did-biases.html#cb799-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-99"><a href="remedies-for-staggered-did-biases.html#cb799-99" tabindex="-1"></a><span class="co">#&gt; $results$p_jointeffects</span></span>
<span id="cb799-100"><a href="remedies-for-staggered-did-biases.html#cb799-100" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb799-101"><a href="remedies-for-staggered-did-biases.html#cb799-101" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-102"><a href="remedies-for-staggered-did-biases.html#cb799-102" tabindex="-1"></a><span class="co">#&gt; $results$Placebos</span></span>
<span id="cb799-103"><a href="remedies-for-staggered-did-biases.html#cb799-103" tabindex="-1"></a><span class="co">#&gt;              Estimate      SE    LB CI   UB CI  N Switchers N.w Switchers.w</span></span>
<span id="cb799-104"><a href="remedies-for-staggered-did-biases.html#cb799-104" tabindex="-1"></a><span class="co">#&gt; Placebo_1     0.08247 0.25941 -0.42597 0.59091 44         8 580          40</span></span>
<span id="cb799-105"><a href="remedies-for-staggered-did-biases.html#cb799-105" tabindex="-1"></a><span class="co">#&gt; Placebo_2    -0.12395 0.54014 -1.18260 0.93469 27         6 405          30</span></span>
<span id="cb799-106"><a href="remedies-for-staggered-did-biases.html#cb799-106" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-107"><a href="remedies-for-staggered-did-biases.html#cb799-107" tabindex="-1"></a><span class="co">#&gt; $results$p_jointplacebo</span></span>
<span id="cb799-108"><a href="remedies-for-staggered-did-biases.html#cb799-108" tabindex="-1"></a><span class="co">#&gt; [1] 0.9043051</span></span>
<span id="cb799-109"><a href="remedies-for-staggered-did-biases.html#cb799-109" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-110"><a href="remedies-for-staggered-did-biases.html#cb799-110" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-111"><a href="remedies-for-staggered-did-biases.html#cb799-111" tabindex="-1"></a><span class="co">#&gt; $coef</span></span>
<span id="cb799-112"><a href="remedies-for-staggered-did-biases.html#cb799-112" tabindex="-1"></a><span class="co">#&gt; $coef$b</span></span>
<span id="cb799-113"><a href="remedies-for-staggered-did-biases.html#cb799-113" tabindex="-1"></a><span class="co">#&gt; Effect_1     Effect_2     Effect_3     Effect_4     Effect_5     Placebo_1    </span></span>
<span id="cb799-114"><a href="remedies-for-staggered-did-biases.html#cb799-114" tabindex="-1"></a><span class="co">#&gt;     -5.21421     -3.59669     -2.18743     -0.90231      0.98492      0.08247 </span></span>
<span id="cb799-115"><a href="remedies-for-staggered-did-biases.html#cb799-115" tabindex="-1"></a><span class="co">#&gt; Placebo_2    </span></span>
<span id="cb799-116"><a href="remedies-for-staggered-did-biases.html#cb799-116" tabindex="-1"></a><span class="co">#&gt;     -0.12395 </span></span>
<span id="cb799-117"><a href="remedies-for-staggered-did-biases.html#cb799-117" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-118"><a href="remedies-for-staggered-did-biases.html#cb799-118" tabindex="-1"></a><span class="co">#&gt; $coef$vcov</span></span>
<span id="cb799-119"><a href="remedies-for-staggered-did-biases.html#cb799-119" tabindex="-1"></a><span class="co">#&gt;              Effect_1   Effect_2     Effect_3   Effect_4    Effect_5</span></span>
<span id="cb799-120"><a href="remedies-for-staggered-did-biases.html#cb799-120" tabindex="-1"></a><span class="co">#&gt; Effect_1   0.07384592 -0.1474035 -0.037481125 -0.3403796 -0.06481787</span></span>
<span id="cb799-121"><a href="remedies-for-staggered-did-biases.html#cb799-121" tabindex="-1"></a><span class="co">#&gt; Effect_2  -0.14740348  0.2209610 -0.111038691 -0.4139371 -0.13837544</span></span>
<span id="cb799-122"><a href="remedies-for-staggered-did-biases.html#cb799-122" tabindex="-1"></a><span class="co">#&gt; Effect_3  -0.03748112 -0.1110387  0.001116335 -0.3040148 -0.02845308</span></span>
<span id="cb799-123"><a href="remedies-for-staggered-did-biases.html#cb799-123" tabindex="-1"></a><span class="co">#&gt; Effect_4  -0.34037958 -0.4139371 -0.304014789  0.6069132 -0.33135154</span></span>
<span id="cb799-124"><a href="remedies-for-staggered-did-biases.html#cb799-124" tabindex="-1"></a><span class="co">#&gt; Effect_5  -0.06481787 -0.1383754 -0.028453082 -0.3313515  0.05578983</span></span>
<span id="cb799-125"><a href="remedies-for-staggered-did-biases.html#cb799-125" tabindex="-1"></a><span class="co">#&gt; Placebo_1 -0.07056996 -0.1441275 -0.034205168 -0.3371036 -0.06154192</span></span>
<span id="cb799-126"><a href="remedies-for-staggered-did-biases.html#cb799-126" tabindex="-1"></a><span class="co">#&gt; Placebo_2 -0.18279619 -0.2563538 -0.146431403 -0.4493299 -0.17376815</span></span>
<span id="cb799-127"><a href="remedies-for-staggered-did-biases.html#cb799-127" tabindex="-1"></a><span class="co">#&gt;             Placebo_1  Placebo_2</span></span>
<span id="cb799-128"><a href="remedies-for-staggered-did-biases.html#cb799-128" tabindex="-1"></a><span class="co">#&gt; Effect_1  -0.07056996 -0.1827962</span></span>
<span id="cb799-129"><a href="remedies-for-staggered-did-biases.html#cb799-129" tabindex="-1"></a><span class="co">#&gt; Effect_2  -0.14412752 -0.2563538</span></span>
<span id="cb799-130"><a href="remedies-for-staggered-did-biases.html#cb799-130" tabindex="-1"></a><span class="co">#&gt; Effect_3  -0.03420517 -0.1464314</span></span>
<span id="cb799-131"><a href="remedies-for-staggered-did-biases.html#cb799-131" tabindex="-1"></a><span class="co">#&gt; Effect_4  -0.33710362 -0.4493299</span></span>
<span id="cb799-132"><a href="remedies-for-staggered-did-biases.html#cb799-132" tabindex="-1"></a><span class="co">#&gt; Effect_5  -0.06154192 -0.1737681</span></span>
<span id="cb799-133"><a href="remedies-for-staggered-did-biases.html#cb799-133" tabindex="-1"></a><span class="co">#&gt; Placebo_1  0.06729400 -0.1795202</span></span>
<span id="cb799-134"><a href="remedies-for-staggered-did-biases.html#cb799-134" tabindex="-1"></a><span class="co">#&gt; Placebo_2 -0.17952024  0.2917465</span></span>
<span id="cb799-135"><a href="remedies-for-staggered-did-biases.html#cb799-135" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-136"><a href="remedies-for-staggered-did-biases.html#cb799-136" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb799-137"><a href="remedies-for-staggered-did-biases.html#cb799-137" tabindex="-1"></a><span class="co">#&gt; $plot</span></span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-36-2.png" width="90%" style="display: block; margin: auto;" /></p>
<p>I don’t recommend the <code>TwoWayFEWeights</code> since it only gives the aggregated average treatment effect over all post-treatment periods, but not for each period.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="remedies-for-staggered-did-biases.html#cb800-1" tabindex="-1"></a><span class="fu">library</span>(TwoWayFEWeights)</span>
<span id="cb800-2"><a href="remedies-for-staggered-did-biases.html#cb800-2" tabindex="-1"></a></span>
<span id="cb800-3"><a href="remedies-for-staggered-did-biases.html#cb800-3" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">twowayfeweights</span>(</span>
<span id="cb800-4"><a href="remedies-for-staggered-did-biases.html#cb800-4" tabindex="-1"></a>    <span class="at">data =</span> base_stagg <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(time_to_treatment <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb800-5"><a href="remedies-for-staggered-did-biases.html#cb800-5" tabindex="-1"></a>    <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb800-6"><a href="remedies-for-staggered-did-biases.html#cb800-6" tabindex="-1"></a>    <span class="at">G =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb800-7"><a href="remedies-for-staggered-did-biases.html#cb800-7" tabindex="-1"></a>    <span class="at">T =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb800-8"><a href="remedies-for-staggered-did-biases.html#cb800-8" tabindex="-1"></a>    <span class="at">D =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb800-9"><a href="remedies-for-staggered-did-biases.html#cb800-9" tabindex="-1"></a>    <span class="at">summary_measures =</span> T</span>
<span id="cb800-10"><a href="remedies-for-staggered-did-biases.html#cb800-10" tabindex="-1"></a>)</span>
<span id="cb800-11"><a href="remedies-for-staggered-did-biases.html#cb800-11" tabindex="-1"></a></span>
<span id="cb800-12"><a href="remedies-for-staggered-did-biases.html#cb800-12" tabindex="-1"></a><span class="fu">print</span>(res)</span>
<span id="cb800-13"><a href="remedies-for-staggered-did-biases.html#cb800-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb800-14"><a href="remedies-for-staggered-did-biases.html#cb800-14" tabindex="-1"></a><span class="co">#&gt; Under the common trends assumption,</span></span>
<span id="cb800-15"><a href="remedies-for-staggered-did-biases.html#cb800-15" tabindex="-1"></a><span class="co">#&gt; the TWFE coefficient beta, equal to -3.4676, estimates a weighted sum of 45 ATTs.</span></span>
<span id="cb800-16"><a href="remedies-for-staggered-did-biases.html#cb800-16" tabindex="-1"></a><span class="co">#&gt; 41 ATTs receive a positive weight, and 4 receive a negative weight.</span></span>
<span id="cb800-17"><a href="remedies-for-staggered-did-biases.html#cb800-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb800-18"><a href="remedies-for-staggered-did-biases.html#cb800-18" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb800-19"><a href="remedies-for-staggered-did-biases.html#cb800-19" tabindex="-1"></a><span class="co">#&gt; Treat. var: treatment    ATTs    Σ weights </span></span>
<span id="cb800-20"><a href="remedies-for-staggered-did-biases.html#cb800-20" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb800-21"><a href="remedies-for-staggered-did-biases.html#cb800-21" tabindex="-1"></a><span class="co">#&gt; Positive weights           41       1.0238 </span></span>
<span id="cb800-22"><a href="remedies-for-staggered-did-biases.html#cb800-22" tabindex="-1"></a><span class="co">#&gt; Negative weights            4      -0.0238 </span></span>
<span id="cb800-23"><a href="remedies-for-staggered-did-biases.html#cb800-23" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb800-24"><a href="remedies-for-staggered-did-biases.html#cb800-24" tabindex="-1"></a><span class="co">#&gt; Total                      45            1 </span></span>
<span id="cb800-25"><a href="remedies-for-staggered-did-biases.html#cb800-25" tabindex="-1"></a><span class="co">#&gt; ──────────────────────────────────────────</span></span>
<span id="cb800-26"><a href="remedies-for-staggered-did-biases.html#cb800-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb800-27"><a href="remedies-for-staggered-did-biases.html#cb800-27" tabindex="-1"></a><span class="co">#&gt; Summary Measures:</span></span>
<span id="cb800-28"><a href="remedies-for-staggered-did-biases.html#cb800-28" tabindex="-1"></a><span class="co">#&gt;   TWFE Coefficient (β_fe): -3.4676</span></span>
<span id="cb800-29"><a href="remedies-for-staggered-did-biases.html#cb800-29" tabindex="-1"></a><span class="co">#&gt;   min σ(Δ) compatible with β_fe and Δ_TR = 0: 4.8357</span></span>
<span id="cb800-30"><a href="remedies-for-staggered-did-biases.html#cb800-30" tabindex="-1"></a><span class="co">#&gt;   min σ(Δ) compatible with treatment effect of opposite sign than β_fe in all (g,t) cells: 36.1549</span></span>
<span id="cb800-31"><a href="remedies-for-staggered-did-biases.html#cb800-31" tabindex="-1"></a><span class="co">#&gt;   Reference: Corollary 1, de Chaisemartin, C and D&#39;Haultfoeuille, X (2020a)</span></span>
<span id="cb800-32"><a href="remedies-for-staggered-did-biases.html#cb800-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb800-33"><a href="remedies-for-staggered-did-biases.html#cb800-33" tabindex="-1"></a><span class="co">#&gt; The development of this package was funded by the European Union (ERC, REALLYCREDIBLE,GA N. 101043899).</span></span></code></pre></div>
</div>
<div id="callaway2021difference" class="section level3 hasAnchor" number="30.11.6">
<h3><span class="header-section-number">30.11.6</span> <span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span><a href="remedies-for-staggered-did-biases.html#callaway2021difference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><code>staggered</code> <a href="https://github.com/jonathandroth/staggered">package</a></p></li>
<li><p>Group-time average treatment effect</p></li>
</ul>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="remedies-for-staggered-did-biases.html#cb801-1" tabindex="-1"></a><span class="fu">library</span>(staggered) </span>
<span id="cb801-2"><a href="remedies-for-staggered-did-biases.html#cb801-2" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb801-3"><a href="remedies-for-staggered-did-biases.html#cb801-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb801-4"><a href="remedies-for-staggered-did-biases.html#cb801-4" tabindex="-1"></a></span>
<span id="cb801-5"><a href="remedies-for-staggered-did-biases.html#cb801-5" tabindex="-1"></a><span class="co"># simple weighted average</span></span>
<span id="cb801-6"><a href="remedies-for-staggered-did-biases.html#cb801-6" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb801-7"><a href="remedies-for-staggered-did-biases.html#cb801-7" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb801-8"><a href="remedies-for-staggered-did-biases.html#cb801-8" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb801-9"><a href="remedies-for-staggered-did-biases.html#cb801-9" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb801-10"><a href="remedies-for-staggered-did-biases.html#cb801-10" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb801-11"><a href="remedies-for-staggered-did-biases.html#cb801-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb801-12"><a href="remedies-for-staggered-did-biases.html#cb801-12" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb801-13"><a href="remedies-for-staggered-did-biases.html#cb801-13" tabindex="-1"></a>)</span>
<span id="cb801-14"><a href="remedies-for-staggered-did-biases.html#cb801-14" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb801-15"><a href="remedies-for-staggered-did-biases.html#cb801-15" tabindex="-1"></a><span class="co">#&gt; 1 -0.7110941 0.2211943 0.2214245</span></span>
<span id="cb801-16"><a href="remedies-for-staggered-did-biases.html#cb801-16" tabindex="-1"></a></span>
<span id="cb801-17"><a href="remedies-for-staggered-did-biases.html#cb801-17" tabindex="-1"></a><span class="co"># cohort weighted average</span></span>
<span id="cb801-18"><a href="remedies-for-staggered-did-biases.html#cb801-18" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb801-19"><a href="remedies-for-staggered-did-biases.html#cb801-19" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb801-20"><a href="remedies-for-staggered-did-biases.html#cb801-20" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb801-21"><a href="remedies-for-staggered-did-biases.html#cb801-21" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb801-22"><a href="remedies-for-staggered-did-biases.html#cb801-22" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb801-23"><a href="remedies-for-staggered-did-biases.html#cb801-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb801-24"><a href="remedies-for-staggered-did-biases.html#cb801-24" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;cohort&quot;</span></span>
<span id="cb801-25"><a href="remedies-for-staggered-did-biases.html#cb801-25" tabindex="-1"></a>)</span>
<span id="cb801-26"><a href="remedies-for-staggered-did-biases.html#cb801-26" tabindex="-1"></a><span class="co">#&gt;    estimate        se se_neyman</span></span>
<span id="cb801-27"><a href="remedies-for-staggered-did-biases.html#cb801-27" tabindex="-1"></a><span class="co">#&gt; 1 -2.724242 0.2701093 0.2701745</span></span>
<span id="cb801-28"><a href="remedies-for-staggered-did-biases.html#cb801-28" tabindex="-1"></a></span>
<span id="cb801-29"><a href="remedies-for-staggered-did-biases.html#cb801-29" tabindex="-1"></a><span class="co"># calendar weighted average</span></span>
<span id="cb801-30"><a href="remedies-for-staggered-did-biases.html#cb801-30" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb801-31"><a href="remedies-for-staggered-did-biases.html#cb801-31" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb801-32"><a href="remedies-for-staggered-did-biases.html#cb801-32" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb801-33"><a href="remedies-for-staggered-did-biases.html#cb801-33" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb801-34"><a href="remedies-for-staggered-did-biases.html#cb801-34" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb801-35"><a href="remedies-for-staggered-did-biases.html#cb801-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb801-36"><a href="remedies-for-staggered-did-biases.html#cb801-36" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;calendar&quot;</span></span>
<span id="cb801-37"><a href="remedies-for-staggered-did-biases.html#cb801-37" tabindex="-1"></a>)</span>
<span id="cb801-38"><a href="remedies-for-staggered-did-biases.html#cb801-38" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb801-39"><a href="remedies-for-staggered-did-biases.html#cb801-39" tabindex="-1"></a><span class="co">#&gt; 1 -0.5861831 0.1768297 0.1770729</span></span>
<span id="cb801-40"><a href="remedies-for-staggered-did-biases.html#cb801-40" tabindex="-1"></a></span>
<span id="cb801-41"><a href="remedies-for-staggered-did-biases.html#cb801-41" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">staggered</span>(</span>
<span id="cb801-42"><a href="remedies-for-staggered-did-biases.html#cb801-42" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb801-43"><a href="remedies-for-staggered-did-biases.html#cb801-43" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb801-44"><a href="remedies-for-staggered-did-biases.html#cb801-44" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb801-45"><a href="remedies-for-staggered-did-biases.html#cb801-45" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb801-46"><a href="remedies-for-staggered-did-biases.html#cb801-46" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb801-47"><a href="remedies-for-staggered-did-biases.html#cb801-47" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;eventstudy&quot;</span>, </span>
<span id="cb801-48"><a href="remedies-for-staggered-did-biases.html#cb801-48" tabindex="-1"></a>    <span class="at">eventTime =</span> <span class="sc">-</span><span class="dv">9</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb801-49"><a href="remedies-for-staggered-did-biases.html#cb801-49" tabindex="-1"></a>)</span>
<span id="cb801-50"><a href="remedies-for-staggered-did-biases.html#cb801-50" tabindex="-1"></a><span class="fu">head</span>(res)</span>
<span id="cb801-51"><a href="remedies-for-staggered-did-biases.html#cb801-51" tabindex="-1"></a><span class="co">#&gt;       estimate        se se_neyman eventTime</span></span>
<span id="cb801-52"><a href="remedies-for-staggered-did-biases.html#cb801-52" tabindex="-1"></a><span class="co">#&gt; 1  0.211213653 0.1132266 0.1136513        -9</span></span>
<span id="cb801-53"><a href="remedies-for-staggered-did-biases.html#cb801-53" tabindex="-1"></a><span class="co">#&gt; 2 -0.104342678 0.1792772 0.1800337        -8</span></span>
<span id="cb801-54"><a href="remedies-for-staggered-did-biases.html#cb801-54" tabindex="-1"></a><span class="co">#&gt; 3 -0.006515977 0.1518244 0.1536703        -7</span></span>
<span id="cb801-55"><a href="remedies-for-staggered-did-biases.html#cb801-55" tabindex="-1"></a><span class="co">#&gt; 4 -0.108274019 0.2375445 0.2381854        -6</span></span>
<span id="cb801-56"><a href="remedies-for-staggered-did-biases.html#cb801-56" tabindex="-1"></a><span class="co">#&gt; 5 -0.353660876 0.2090569 0.2102740        -5</span></span>
<span id="cb801-57"><a href="remedies-for-staggered-did-biases.html#cb801-57" tabindex="-1"></a><span class="co">#&gt; 6  0.066907666 0.2000045 0.2154505        -4</span></span>
<span id="cb801-58"><a href="remedies-for-staggered-did-biases.html#cb801-58" tabindex="-1"></a></span>
<span id="cb801-59"><a href="remedies-for-staggered-did-biases.html#cb801-59" tabindex="-1"></a></span>
<span id="cb801-60"><a href="remedies-for-staggered-did-biases.html#cb801-60" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb801-61"><a href="remedies-for-staggered-did-biases.html#cb801-61" tabindex="-1"></a>    res <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb801-62"><a href="remedies-for-staggered-did-biases.html#cb801-62" tabindex="-1"></a>        <span class="at">ymin_ptwise =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb801-63"><a href="remedies-for-staggered-did-biases.html#cb801-63" tabindex="-1"></a>        <span class="at">ymax_ptwise =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb801-64"><a href="remedies-for-staggered-did-biases.html#cb801-64" tabindex="-1"></a>    ),</span>
<span id="cb801-65"><a href="remedies-for-staggered-did-biases.html#cb801-65" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> eventTime, <span class="at">y =</span> estimate)</span>
<span id="cb801-66"><a href="remedies-for-staggered-did-biases.html#cb801-66" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb801-67"><a href="remedies-for-staggered-did-biases.html#cb801-67" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ymin_ptwise, <span class="at">ymax =</span> ymax_ptwise)) <span class="sc">+</span></span>
<span id="cb801-68"><a href="remedies-for-staggered-did-biases.html#cb801-68" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb801-69"><a href="remedies-for-staggered-did-biases.html#cb801-69" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Event Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb801-70"><a href="remedies-for-staggered-did-biases.html#cb801-70" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb801-71"><a href="remedies-for-staggered-did-biases.html#cb801-71" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-38-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="remedies-for-staggered-did-biases.html#cb802-1" tabindex="-1"></a><span class="co"># Callaway and Sant&#39;Anna estimator for the simple weighted average</span></span>
<span id="cb802-2"><a href="remedies-for-staggered-did-biases.html#cb802-2" tabindex="-1"></a><span class="fu">staggered_cs</span>(</span>
<span id="cb802-3"><a href="remedies-for-staggered-did-biases.html#cb802-3" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb802-4"><a href="remedies-for-staggered-did-biases.html#cb802-4" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb802-5"><a href="remedies-for-staggered-did-biases.html#cb802-5" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb802-6"><a href="remedies-for-staggered-did-biases.html#cb802-6" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb802-7"><a href="remedies-for-staggered-did-biases.html#cb802-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb802-8"><a href="remedies-for-staggered-did-biases.html#cb802-8" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb802-9"><a href="remedies-for-staggered-did-biases.html#cb802-9" tabindex="-1"></a>)</span>
<span id="cb802-10"><a href="remedies-for-staggered-did-biases.html#cb802-10" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb802-11"><a href="remedies-for-staggered-did-biases.html#cb802-11" tabindex="-1"></a><span class="co">#&gt; 1 -0.7994889 0.4484987 0.4486122</span></span>
<span id="cb802-12"><a href="remedies-for-staggered-did-biases.html#cb802-12" tabindex="-1"></a></span>
<span id="cb802-13"><a href="remedies-for-staggered-did-biases.html#cb802-13" tabindex="-1"></a><span class="co"># Sun and Abraham estimator for the simple weighted average</span></span>
<span id="cb802-14"><a href="remedies-for-staggered-did-biases.html#cb802-14" tabindex="-1"></a><span class="fu">staggered_sa</span>(</span>
<span id="cb802-15"><a href="remedies-for-staggered-did-biases.html#cb802-15" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb802-16"><a href="remedies-for-staggered-did-biases.html#cb802-16" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb802-17"><a href="remedies-for-staggered-did-biases.html#cb802-17" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb802-18"><a href="remedies-for-staggered-did-biases.html#cb802-18" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb802-19"><a href="remedies-for-staggered-did-biases.html#cb802-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb802-20"><a href="remedies-for-staggered-did-biases.html#cb802-20" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb802-21"><a href="remedies-for-staggered-did-biases.html#cb802-21" tabindex="-1"></a>)</span>
<span id="cb802-22"><a href="remedies-for-staggered-did-biases.html#cb802-22" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb802-23"><a href="remedies-for-staggered-did-biases.html#cb802-23" tabindex="-1"></a><span class="co">#&gt; 1 -0.7551901 0.4407818 0.4409525</span></span></code></pre></div>
<p>Fisher’s Randomization Test (i.e., permutation test)</p>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(TE = 0\)</span></p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="remedies-for-staggered-did-biases.html#cb803-1" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb803-2"><a href="remedies-for-staggered-did-biases.html#cb803-2" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb803-3"><a href="remedies-for-staggered-did-biases.html#cb803-3" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb803-4"><a href="remedies-for-staggered-did-biases.html#cb803-4" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb803-5"><a href="remedies-for-staggered-did-biases.html#cb803-5" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb803-6"><a href="remedies-for-staggered-did-biases.html#cb803-6" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb803-7"><a href="remedies-for-staggered-did-biases.html#cb803-7" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span>,</span>
<span id="cb803-8"><a href="remedies-for-staggered-did-biases.html#cb803-8" tabindex="-1"></a>    <span class="at">compute_fisher =</span> T,</span>
<span id="cb803-9"><a href="remedies-for-staggered-did-biases.html#cb803-9" tabindex="-1"></a>    <span class="at">num_fisher_permutations =</span> <span class="dv">100</span></span>
<span id="cb803-10"><a href="remedies-for-staggered-did-biases.html#cb803-10" tabindex="-1"></a>)</span>
<span id="cb803-11"><a href="remedies-for-staggered-did-biases.html#cb803-11" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman fisher_pval fisher_pval_se_neyman</span></span>
<span id="cb803-12"><a href="remedies-for-staggered-did-biases.html#cb803-12" tabindex="-1"></a><span class="co">#&gt; 1 -0.7110941 0.2211943 0.2214245           0                     0</span></span>
<span id="cb803-13"><a href="remedies-for-staggered-did-biases.html#cb803-13" tabindex="-1"></a><span class="co">#&gt;   num_fisher_permutations</span></span>
<span id="cb803-14"><a href="remedies-for-staggered-did-biases.html#cb803-14" tabindex="-1"></a><span class="co">#&gt; 1                     100</span></span></code></pre></div>
</div>
<div id="sun2021estimating" class="section level3 hasAnchor" number="30.11.7">
<h3><span class="header-section-number">30.11.7</span> <span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span><a href="remedies-for-staggered-did-biases.html#sun2021estimating" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This paper utilizes the Cohort Average Treatment Effects on the Treated (CATT), which measures the cohort-specific average difference in outcomes relative to those never treated, offering a more detailed analysis than <span class="citation">Goodman-Bacon (<a href="#ref-goodman2021difference">2021</a>)</span>. In scenarios lacking a never-treated group, this method designates the last cohort to be treated as the control group.</p>
<p>Parameter of interest is the cohort-specific ATT <span class="math inline">\(l\)</span> periods from int ital treatment period <span class="math inline">\(e\)</span></p>
<p><span class="math display">\[
CATT = E[Y_{i, e + I} - Y_{i, e + I}^\infty|E_i = e]
\]</span></p>
<p>This paper uses an <strong>interaction-weighted estimator</strong> in a panel data setting, where the original paper <span class="citation">Gibbons, Suárez Serrato, and Urbancic (<a href="#ref-gibbons2018broken">2018</a>)</span> used the same idea in a cross-sectional setting.</p>
<ul>
<li><p><span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span> explores group-time average treatment effects, employing cohorts that have not yet been treated as controls, and permits conditioning on time-varying covariates.</p></li>
<li><p><span class="citation">Athey and Imbens (<a href="#ref-athey2022design">2022</a>)</span> examines the treatment effect in relation to the counterfactual outcome of the always-treated group, diverging from the conventional focus on the never-treated.</p></li>
<li><p><span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span> presumes a uniform treatment effect across cohorts, effectively simplifying CATT to ATT.</p></li>
</ul>
<p>Identifying Assumptions for dynamic TWFE:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Parallel Trends</strong>: Baseline outcomes follow parallel trends across cohorts before treatment.</p>
<ul>
<li>This gives us all CATT (including own, included bins, and excluded bins)</li>
</ul></li>
<li><p><strong>No Anticipatory Behavior</strong>: There is no effect of the treatment during pre-treatment periods, indicating that outcomes are not influenced by the anticipation of treatment.</p></li>
<li><p><strong>Treatment Effect Homogeneity</strong>: The treatment effect is consistent across cohorts for each relative period. Each adoption cohort should have the same path of treatment effects. In other words, the trajectory of each treatment cohort is similar. Compare to other designs:</p>
<ol style="list-style-type: decimal">
<li><p><span class="citation">Athey and Imbens (<a href="#ref-athey2022design">2022</a>)</span> assume heterogeneity of treatment effects vary over adoption cohorts, but not over time.</p></li>
<li><p><span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span> assume heterogeneity of treatment effects vary over time, but not over adoption cohorts.</p></li>
<li><p><span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span> assume heterogeneity of treatment effects vary over time and across cohorts.</p></li>
<li><p><span class="citation">Clement De Chaisemartin and D’haultfœuille (<a href="#ref-de2023two">2023</a>)</span> assume heterogeneity of treatment effects vary across groups and over time.</p></li>
<li><p><span class="citation">Goodman-Bacon (<a href="#ref-goodman2021difference">2021</a>)</span> assume heterogeneity either “vary across units but not over time” or “vary over time but not across units”.</p></li>
<li><p><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> allows for treatment effect heterogeneity across units and time.</p></li>
</ol></li>
</ol>
<p>Sources of Heterogeneous Treatment Effects</p>
<ul>
<li><p>Adoption cohorts can differ based on certain covariates. Similarly, composition of units within each adoption cohort is different.</p></li>
<li><p>The response to treatment varies among cohorts if units self-select their initial treatment timing based on anticipated treatment effects. However, this self-selection is still compatible with the parallel trends assumption. This is true if units choose based on an evaluation of baseline outcomes - that is, if baseline outcomes are similar (following parallel trends), then we might not see selection into treatment based on the evaluation of the baseline outcome.</p></li>
<li><p>Treatment effects can vary across cohorts due to calendar time-varying effects, such as changes in economic conditions.</p></li>
</ul>
<p>Notes:</p>
<ul>
<li><p>If you do TWFE, you actually have to drop 2 terms to avoid multicollinearity:</p>
<ul>
<li><p>Period right before treatment (this one was known before this paper)</p></li>
<li><p>Drop or bin or trim a distant lag period (this one was clarified by the paper). The reason is before of the multicollinearity in the linear relationship between TWFE and the relative period indicators.</p></li>
</ul></li>
<li><p>Contamination of the treatment effect estimates from excluded periods is a type of “normalization”. To avoid this, we have to assume that all pre-treatment periods have the same CATT.</p>
<ul>
<li><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> estimation method gives reasonable weights to CATT (i..e, weights that sum to 1, and are non negative). They estimate the weighted average of CATT where the weights are shares of cohorts that experience at least <span class="math inline">\(l\)</span> periods after to treatment, normalized by the size of total periods <span class="math inline">\(g\)</span>.</li>
</ul></li>
<li><p>Aggregation of CATT is similar to that of <span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span></p></li>
</ul>
<p><strong>Application</strong></p>
<p>can use <code>fixest</code> in r with <code>sunab</code> function</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="remedies-for-staggered-did-biases.html#cb804-1" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb804-2"><a href="remedies-for-staggered-did-biases.html#cb804-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb804-3"><a href="remedies-for-staggered-did-biases.html#cb804-3" tabindex="-1"></a>res_sa20 <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> <span class="fu">sunab</span>(year_treated, year) <span class="sc">|</span> id <span class="sc">+</span> year, base_stagg)</span>
<span id="cb804-4"><a href="remedies-for-staggered-did-biases.html#cb804-4" tabindex="-1"></a><span class="fu">iplot</span>(res_sa20)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="remedies-for-staggered-did-biases.html#cb805-1" tabindex="-1"></a></span>
<span id="cb805-2"><a href="remedies-for-staggered-did-biases.html#cb805-2" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="st">&quot;att&quot;</span>)</span>
<span id="cb805-3"><a href="remedies-for-staggered-did-biases.html#cb805-3" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb805-4"><a href="remedies-for-staggered-did-biases.html#cb805-4" tabindex="-1"></a><span class="co">#&gt; Observations: 950</span></span>
<span id="cb805-5"><a href="remedies-for-staggered-did-biases.html#cb805-5" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 95,  year: 10</span></span>
<span id="cb805-6"><a href="remedies-for-staggered-did-biases.html#cb805-6" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb805-7"><a href="remedies-for-staggered-did-biases.html#cb805-7" tabindex="-1"></a><span class="co">#&gt;      Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb805-8"><a href="remedies-for-staggered-did-biases.html#cb805-8" tabindex="-1"></a><span class="co">#&gt; x1   0.994678   0.018378 54.12293 &lt; 2.2e-16 ***</span></span>
<span id="cb805-9"><a href="remedies-for-staggered-did-biases.html#cb805-9" tabindex="-1"></a><span class="co">#&gt; ATT -1.133749   0.205070 -5.52858 2.882e-07 ***</span></span>
<span id="cb805-10"><a href="remedies-for-staggered-did-biases.html#cb805-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb805-11"><a href="remedies-for-staggered-did-biases.html#cb805-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb805-12"><a href="remedies-for-staggered-did-biases.html#cb805-12" tabindex="-1"></a><span class="co">#&gt; RMSE: 0.921817     Adj. R2: 0.887984</span></span>
<span id="cb805-13"><a href="remedies-for-staggered-did-biases.html#cb805-13" tabindex="-1"></a><span class="co">#&gt;                  Within R2: 0.876406</span></span>
<span id="cb805-14"><a href="remedies-for-staggered-did-biases.html#cb805-14" tabindex="-1"></a></span>
<span id="cb805-15"><a href="remedies-for-staggered-did-biases.html#cb805-15" tabindex="-1"></a></span>
<span id="cb805-16"><a href="remedies-for-staggered-did-biases.html#cb805-16" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="fu">c</span>(<span class="st">&quot;att&quot;</span> <span class="ot">=</span> <span class="st">&quot;year::[^-]&quot;</span>)) </span>
<span id="cb805-17"><a href="remedies-for-staggered-did-biases.html#cb805-17" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb805-18"><a href="remedies-for-staggered-did-biases.html#cb805-18" tabindex="-1"></a><span class="co">#&gt; Observations: 950</span></span>
<span id="cb805-19"><a href="remedies-for-staggered-did-biases.html#cb805-19" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 95,  year: 10</span></span>
<span id="cb805-20"><a href="remedies-for-staggered-did-biases.html#cb805-20" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb805-21"><a href="remedies-for-staggered-did-biases.html#cb805-21" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error   t value   Pr(&gt;|t|)    </span></span>
<span id="cb805-22"><a href="remedies-for-staggered-did-biases.html#cb805-22" tabindex="-1"></a><span class="co">#&gt; x1                   0.994678   0.018378 54.122928  &lt; 2.2e-16 ***</span></span>
<span id="cb805-23"><a href="remedies-for-staggered-did-biases.html#cb805-23" tabindex="-1"></a><span class="co">#&gt; year::-9:cohort::10  0.351766   0.359073  0.979649 3.2977e-01    </span></span>
<span id="cb805-24"><a href="remedies-for-staggered-did-biases.html#cb805-24" tabindex="-1"></a><span class="co">#&gt; year::-8:cohort::9   0.033914   0.471437  0.071937 9.4281e-01    </span></span>
<span id="cb805-25"><a href="remedies-for-staggered-did-biases.html#cb805-25" tabindex="-1"></a><span class="co">#&gt; year::-8:cohort::10 -0.191932   0.352896 -0.543876 5.8781e-01    </span></span>
<span id="cb805-26"><a href="remedies-for-staggered-did-biases.html#cb805-26" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::8  -0.589387   0.736910 -0.799809 4.2584e-01    </span></span>
<span id="cb805-27"><a href="remedies-for-staggered-did-biases.html#cb805-27" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::9   0.872995   0.493427  1.769249 8.0096e-02 .  </span></span>
<span id="cb805-28"><a href="remedies-for-staggered-did-biases.html#cb805-28" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::10  0.019512   0.603411  0.032336 9.7427e-01    </span></span>
<span id="cb805-29"><a href="remedies-for-staggered-did-biases.html#cb805-29" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::7  -0.042147   0.865736 -0.048683 9.6127e-01    </span></span>
<span id="cb805-30"><a href="remedies-for-staggered-did-biases.html#cb805-30" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::8  -0.657571   0.573257 -1.147078 2.5426e-01    </span></span>
<span id="cb805-31"><a href="remedies-for-staggered-did-biases.html#cb805-31" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::9   0.877743   0.533331  1.645775 1.0315e-01    </span></span>
<span id="cb805-32"><a href="remedies-for-staggered-did-biases.html#cb805-32" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::10 -0.403635   0.347412 -1.161832 2.4825e-01    </span></span>
<span id="cb805-33"><a href="remedies-for-staggered-did-biases.html#cb805-33" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::6  -0.658034   0.913407 -0.720418 4.7306e-01    </span></span>
<span id="cb805-34"><a href="remedies-for-staggered-did-biases.html#cb805-34" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::7  -0.316974   0.697939 -0.454158 6.5076e-01    </span></span>
<span id="cb805-35"><a href="remedies-for-staggered-did-biases.html#cb805-35" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::8  -0.238213   0.469744 -0.507113 6.1326e-01    </span></span>
<span id="cb805-36"><a href="remedies-for-staggered-did-biases.html#cb805-36" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::9   0.301477   0.604201  0.498968 6.1897e-01    </span></span>
<span id="cb805-37"><a href="remedies-for-staggered-did-biases.html#cb805-37" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::10 -0.564801   0.463214 -1.219308 2.2578e-01    </span></span>
<span id="cb805-38"><a href="remedies-for-staggered-did-biases.html#cb805-38" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::5  -0.983453   0.634492 -1.549984 1.2451e-01    </span></span>
<span id="cb805-39"><a href="remedies-for-staggered-did-biases.html#cb805-39" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::6   0.360407   0.858316  0.419900 6.7552e-01    </span></span>
<span id="cb805-40"><a href="remedies-for-staggered-did-biases.html#cb805-40" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::7  -0.430610   0.661356 -0.651102 5.1657e-01    </span></span>
<span id="cb805-41"><a href="remedies-for-staggered-did-biases.html#cb805-41" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::8  -0.895195   0.374901 -2.387816 1.8949e-02 *  </span></span>
<span id="cb805-42"><a href="remedies-for-staggered-did-biases.html#cb805-42" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::9  -0.392478   0.439547 -0.892914 3.7418e-01    </span></span>
<span id="cb805-43"><a href="remedies-for-staggered-did-biases.html#cb805-43" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::10  0.519001   0.597880  0.868069 3.8757e-01    </span></span>
<span id="cb805-44"><a href="remedies-for-staggered-did-biases.html#cb805-44" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::4   0.591288   0.680169  0.869324 3.8688e-01    </span></span>
<span id="cb805-45"><a href="remedies-for-staggered-did-biases.html#cb805-45" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::5  -1.000650   0.971741 -1.029749 3.0577e-01    </span></span>
<span id="cb805-46"><a href="remedies-for-staggered-did-biases.html#cb805-46" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::6   0.072188   0.652641  0.110609 9.1216e-01    </span></span>
<span id="cb805-47"><a href="remedies-for-staggered-did-biases.html#cb805-47" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::7  -0.836820   0.804275 -1.040465 3.0079e-01    </span></span>
<span id="cb805-48"><a href="remedies-for-staggered-did-biases.html#cb805-48" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::8  -0.783148   0.701312 -1.116691 2.6697e-01    </span></span>
<span id="cb805-49"><a href="remedies-for-staggered-did-biases.html#cb805-49" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::9   0.811285   0.564470  1.437251 1.5397e-01    </span></span>
<span id="cb805-50"><a href="remedies-for-staggered-did-biases.html#cb805-50" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::10  0.527203   0.320051  1.647250 1.0285e-01    </span></span>
<span id="cb805-51"><a href="remedies-for-staggered-did-biases.html#cb805-51" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::3   0.036941   0.673771  0.054828 9.5639e-01    </span></span>
<span id="cb805-52"><a href="remedies-for-staggered-did-biases.html#cb805-52" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::4   0.832250   0.859544  0.968246 3.3541e-01    </span></span>
<span id="cb805-53"><a href="remedies-for-staggered-did-biases.html#cb805-53" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::5  -1.574086   0.525563 -2.995051 3.5076e-03 ** </span></span>
<span id="cb805-54"><a href="remedies-for-staggered-did-biases.html#cb805-54" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::6   0.311758   0.832095  0.374666 7.0875e-01    </span></span>
<span id="cb805-55"><a href="remedies-for-staggered-did-biases.html#cb805-55" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::7  -0.558631   0.871993 -0.640638 5.2332e-01    </span></span>
<span id="cb805-56"><a href="remedies-for-staggered-did-biases.html#cb805-56" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::8   0.429591   0.305270  1.407250 1.6265e-01    </span></span>
<span id="cb805-57"><a href="remedies-for-staggered-did-biases.html#cb805-57" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::9   1.201899   0.819186  1.467188 1.4566e-01    </span></span>
<span id="cb805-58"><a href="remedies-for-staggered-did-biases.html#cb805-58" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::10 -0.002429   0.682087 -0.003562 9.9717e-01    </span></span>
<span id="cb805-59"><a href="remedies-for-staggered-did-biases.html#cb805-59" tabindex="-1"></a><span class="co">#&gt; att                 -1.133749   0.205070 -5.528584 2.8820e-07 ***</span></span>
<span id="cb805-60"><a href="remedies-for-staggered-did-biases.html#cb805-60" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb805-61"><a href="remedies-for-staggered-did-biases.html#cb805-61" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb805-62"><a href="remedies-for-staggered-did-biases.html#cb805-62" tabindex="-1"></a><span class="co">#&gt; RMSE: 0.921817     Adj. R2: 0.887984</span></span>
<span id="cb805-63"><a href="remedies-for-staggered-did-biases.html#cb805-63" tabindex="-1"></a><span class="co">#&gt;                  Within R2: 0.876406</span></span>
<span id="cb805-64"><a href="remedies-for-staggered-did-biases.html#cb805-64" tabindex="-1"></a></span>
<span id="cb805-65"><a href="remedies-for-staggered-did-biases.html#cb805-65" tabindex="-1"></a><span class="co"># alternatively</span></span>
<span id="cb805-66"><a href="remedies-for-staggered-did-biases.html#cb805-66" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="fu">c</span>(<span class="st">&quot;att&quot;</span> <span class="ot">=</span> <span class="st">&quot;year::[012345678]&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb805-67"><a href="remedies-for-staggered-did-biases.html#cb805-67" tabindex="-1"></a>    <span class="fu">etable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb805-68"><a href="remedies-for-staggered-did-biases.html#cb805-68" tabindex="-1"></a><span class="co">#&gt;                         summary(res_..</span></span>
<span id="cb805-69"><a href="remedies-for-staggered-did-biases.html#cb805-69" tabindex="-1"></a><span class="co">#&gt; Dependent Var.:                      y</span></span>
<span id="cb805-70"><a href="remedies-for-staggered-did-biases.html#cb805-70" tabindex="-1"></a><span class="co">#&gt;                                       </span></span>
<span id="cb805-71"><a href="remedies-for-staggered-did-biases.html#cb805-71" tabindex="-1"></a><span class="co">#&gt; x1                      0.99*** (0.02)</span></span>
<span id="cb805-72"><a href="remedies-for-staggered-did-biases.html#cb805-72" tabindex="-1"></a><span class="co">#&gt; year = -9 x cohort = 10    0.35 (0.36)</span></span>
<span id="cb805-73"><a href="remedies-for-staggered-did-biases.html#cb805-73" tabindex="-1"></a><span class="co">#&gt; year = -8 x cohort = 9     0.03 (0.47)</span></span>
<span id="cb805-74"><a href="remedies-for-staggered-did-biases.html#cb805-74" tabindex="-1"></a><span class="co">#&gt; year = -8 x cohort = 10   -0.19 (0.35)</span></span>
<span id="cb805-75"><a href="remedies-for-staggered-did-biases.html#cb805-75" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 8    -0.59 (0.74)</span></span>
<span id="cb805-76"><a href="remedies-for-staggered-did-biases.html#cb805-76" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 9    0.87. (0.49)</span></span>
<span id="cb805-77"><a href="remedies-for-staggered-did-biases.html#cb805-77" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 10    0.02 (0.60)</span></span>
<span id="cb805-78"><a href="remedies-for-staggered-did-biases.html#cb805-78" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 7    -0.04 (0.87)</span></span>
<span id="cb805-79"><a href="remedies-for-staggered-did-biases.html#cb805-79" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 8    -0.66 (0.57)</span></span>
<span id="cb805-80"><a href="remedies-for-staggered-did-biases.html#cb805-80" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 9     0.88 (0.53)</span></span>
<span id="cb805-81"><a href="remedies-for-staggered-did-biases.html#cb805-81" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 10   -0.40 (0.35)</span></span>
<span id="cb805-82"><a href="remedies-for-staggered-did-biases.html#cb805-82" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 6    -0.66 (0.91)</span></span>
<span id="cb805-83"><a href="remedies-for-staggered-did-biases.html#cb805-83" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 7    -0.32 (0.70)</span></span>
<span id="cb805-84"><a href="remedies-for-staggered-did-biases.html#cb805-84" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 8    -0.24 (0.47)</span></span>
<span id="cb805-85"><a href="remedies-for-staggered-did-biases.html#cb805-85" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 9     0.30 (0.60)</span></span>
<span id="cb805-86"><a href="remedies-for-staggered-did-biases.html#cb805-86" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 10   -0.56 (0.46)</span></span>
<span id="cb805-87"><a href="remedies-for-staggered-did-biases.html#cb805-87" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 5    -0.98 (0.63)</span></span>
<span id="cb805-88"><a href="remedies-for-staggered-did-biases.html#cb805-88" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 6     0.36 (0.86)</span></span>
<span id="cb805-89"><a href="remedies-for-staggered-did-biases.html#cb805-89" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 7    -0.43 (0.66)</span></span>
<span id="cb805-90"><a href="remedies-for-staggered-did-biases.html#cb805-90" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 8   -0.90* (0.37)</span></span>
<span id="cb805-91"><a href="remedies-for-staggered-did-biases.html#cb805-91" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 9    -0.39 (0.44)</span></span>
<span id="cb805-92"><a href="remedies-for-staggered-did-biases.html#cb805-92" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 10    0.52 (0.60)</span></span>
<span id="cb805-93"><a href="remedies-for-staggered-did-biases.html#cb805-93" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 4     0.59 (0.68)</span></span>
<span id="cb805-94"><a href="remedies-for-staggered-did-biases.html#cb805-94" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 5     -1.0 (0.97)</span></span>
<span id="cb805-95"><a href="remedies-for-staggered-did-biases.html#cb805-95" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 6     0.07 (0.65)</span></span>
<span id="cb805-96"><a href="remedies-for-staggered-did-biases.html#cb805-96" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 7    -0.84 (0.80)</span></span>
<span id="cb805-97"><a href="remedies-for-staggered-did-biases.html#cb805-97" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 8    -0.78 (0.70)</span></span>
<span id="cb805-98"><a href="remedies-for-staggered-did-biases.html#cb805-98" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 9     0.81 (0.56)</span></span>
<span id="cb805-99"><a href="remedies-for-staggered-did-biases.html#cb805-99" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 10    0.53 (0.32)</span></span>
<span id="cb805-100"><a href="remedies-for-staggered-did-biases.html#cb805-100" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 3     0.04 (0.67)</span></span>
<span id="cb805-101"><a href="remedies-for-staggered-did-biases.html#cb805-101" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 4     0.83 (0.86)</span></span>
<span id="cb805-102"><a href="remedies-for-staggered-did-biases.html#cb805-102" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 5   -1.6** (0.53)</span></span>
<span id="cb805-103"><a href="remedies-for-staggered-did-biases.html#cb805-103" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 6     0.31 (0.83)</span></span>
<span id="cb805-104"><a href="remedies-for-staggered-did-biases.html#cb805-104" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 7    -0.56 (0.87)</span></span>
<span id="cb805-105"><a href="remedies-for-staggered-did-biases.html#cb805-105" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 8     0.43 (0.31)</span></span>
<span id="cb805-106"><a href="remedies-for-staggered-did-biases.html#cb805-106" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 9      1.2 (0.82)</span></span>
<span id="cb805-107"><a href="remedies-for-staggered-did-biases.html#cb805-107" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 10  -0.002 (0.68)</span></span>
<span id="cb805-108"><a href="remedies-for-staggered-did-biases.html#cb805-108" tabindex="-1"></a><span class="co">#&gt; att                     -1.1*** (0.21)</span></span>
<span id="cb805-109"><a href="remedies-for-staggered-did-biases.html#cb805-109" tabindex="-1"></a><span class="co">#&gt; Fixed-Effects:          --------------</span></span>
<span id="cb805-110"><a href="remedies-for-staggered-did-biases.html#cb805-110" tabindex="-1"></a><span class="co">#&gt; id                                 Yes</span></span>
<span id="cb805-111"><a href="remedies-for-staggered-did-biases.html#cb805-111" tabindex="-1"></a><span class="co">#&gt; year                               Yes</span></span>
<span id="cb805-112"><a href="remedies-for-staggered-did-biases.html#cb805-112" tabindex="-1"></a><span class="co">#&gt; _______________________ ______________</span></span>
<span id="cb805-113"><a href="remedies-for-staggered-did-biases.html#cb805-113" tabindex="-1"></a><span class="co">#&gt; S.E.: Clustered                 by: id</span></span>
<span id="cb805-114"><a href="remedies-for-staggered-did-biases.html#cb805-114" tabindex="-1"></a><span class="co">#&gt; Observations                       950</span></span>
<span id="cb805-115"><a href="remedies-for-staggered-did-biases.html#cb805-115" tabindex="-1"></a><span class="co">#&gt; R2                             0.90982</span></span>
<span id="cb805-116"><a href="remedies-for-staggered-did-biases.html#cb805-116" tabindex="-1"></a><span class="co">#&gt; Within R2                      0.87641</span></span>
<span id="cb805-117"><a href="remedies-for-staggered-did-biases.html#cb805-117" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb805-118"><a href="remedies-for-staggered-did-biases.html#cb805-118" tabindex="-1"></a><span class="co">#&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Using the same syntax as <code>fixest</code></p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="remedies-for-staggered-did-biases.html#cb806-1" tabindex="-1"></a><span class="co"># devtools::install_github(&quot;kylebutts/fwlplot&quot;)</span></span>
<span id="cb806-2"><a href="remedies-for-staggered-did-biases.html#cb806-2" tabindex="-1"></a><span class="fu">library</span>(fwlplot)</span>
<span id="cb806-3"><a href="remedies-for-staggered-did-biases.html#cb806-3" tabindex="-1"></a><span class="fu">fwl_plot</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> base_stagg)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/plot%20residuals-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="remedies-for-staggered-did-biases.html#cb807-1" tabindex="-1"></a></span>
<span id="cb807-2"><a href="remedies-for-staggered-did-biases.html#cb807-2" tabindex="-1"></a><span class="fu">fwl_plot</span>(y <span class="sc">~</span> x1 <span class="sc">|</span> id <span class="sc">+</span> year, <span class="at">data =</span> base_stagg, <span class="at">n_sample =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/plot%20residuals-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="remedies-for-staggered-did-biases.html#cb808-1" tabindex="-1"></a></span>
<span id="cb808-2"><a href="remedies-for-staggered-did-biases.html#cb808-2" tabindex="-1"></a><span class="fu">fwl_plot</span>(y <span class="sc">~</span> x1 <span class="sc">|</span> id <span class="sc">+</span> year, <span class="at">data =</span> base_stagg, <span class="at">n_sample =</span> <span class="dv">100</span>, <span class="at">fsplit =</span> <span class="sc">~</span> treated)</span></code></pre></div>
<p><img src="30-dif-in-dif_files/figure-html/plot%20residuals-3.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="wooldridge2023simple" class="section level3 hasAnchor" number="30.11.8">
<h3><span class="header-section-number">30.11.8</span> <span class="citation">Wooldridge (<a href="#ref-wooldridge2023simple">2023</a>)</span><a href="remedies-for-staggered-did-biases.html#wooldridge2023simple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>use <a href="https://grantmcdermott.com/etwfe/">etwfe</a>(Extended two-way Fixed Effects) <span class="citation">(<a href="#ref-wooldridge2023simple">Wooldridge 2023</a>)</span></p>
</div>
<div id="doubly-robust-did" class="section level3 hasAnchor" number="30.11.9">
<h3><span class="header-section-number">30.11.9</span> Doubly Robust DiD<a href="remedies-for-staggered-did-biases.html#doubly-robust-did" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Also known as the locally efficient doubly robust DiD <span class="citation">(<a href="#ref-sant2020doubly">Sant’Anna and Zhao 2020</a>)</span></p>
<p><a href="https://psantanna.com/DRDID/index.html">Code example by the authors</a></p>
<p>The package (not method) is rather limited application:</p>
<ul>
<li><p>Use OLS (cannot handle <code>glm</code>)</p></li>
<li><p>Canonical DiD only (cannot handle DDD).</p></li>
</ul>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="remedies-for-staggered-did-biases.html#cb809-1" tabindex="-1"></a><span class="fu">library</span>(DRDID)</span>
<span id="cb809-2"><a href="remedies-for-staggered-did-biases.html#cb809-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;nsw_long&quot;</span>)</span>
<span id="cb809-3"><a href="remedies-for-staggered-did-biases.html#cb809-3" tabindex="-1"></a>eval_lalonde_cps <span class="ot">&lt;-</span></span>
<span id="cb809-4"><a href="remedies-for-staggered-did-biases.html#cb809-4" tabindex="-1"></a>    <span class="fu">subset</span>(nsw_long, nsw_long<span class="sc">$</span>treated <span class="sc">==</span> <span class="dv">0</span> <span class="sc">|</span> nsw_long<span class="sc">$</span>sample <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb809-5"><a href="remedies-for-staggered-did-biases.html#cb809-5" tabindex="-1"></a><span class="fu">head</span>(eval_lalonde_cps)</span>
<span id="cb809-6"><a href="remedies-for-staggered-did-biases.html#cb809-6" tabindex="-1"></a><span class="co">#&gt;   id year treated age educ black married nodegree dwincl      re74 hisp</span></span>
<span id="cb809-7"><a href="remedies-for-staggered-did-biases.html#cb809-7" tabindex="-1"></a><span class="co">#&gt; 1  1 1975      NA  42   16     0       1        0     NA     0.000    0</span></span>
<span id="cb809-8"><a href="remedies-for-staggered-did-biases.html#cb809-8" tabindex="-1"></a><span class="co">#&gt; 2  1 1978      NA  42   16     0       1        0     NA     0.000    0</span></span>
<span id="cb809-9"><a href="remedies-for-staggered-did-biases.html#cb809-9" tabindex="-1"></a><span class="co">#&gt; 3  2 1975      NA  20   13     0       0        0     NA  2366.794    0</span></span>
<span id="cb809-10"><a href="remedies-for-staggered-did-biases.html#cb809-10" tabindex="-1"></a><span class="co">#&gt; 4  2 1978      NA  20   13     0       0        0     NA  2366.794    0</span></span>
<span id="cb809-11"><a href="remedies-for-staggered-did-biases.html#cb809-11" tabindex="-1"></a><span class="co">#&gt; 5  3 1975      NA  37   12     0       1        0     NA 25862.322    0</span></span>
<span id="cb809-12"><a href="remedies-for-staggered-did-biases.html#cb809-12" tabindex="-1"></a><span class="co">#&gt; 6  3 1978      NA  37   12     0       1        0     NA 25862.322    0</span></span>
<span id="cb809-13"><a href="remedies-for-staggered-did-biases.html#cb809-13" tabindex="-1"></a><span class="co">#&gt;   early_ra sample experimental         re</span></span>
<span id="cb809-14"><a href="remedies-for-staggered-did-biases.html#cb809-14" tabindex="-1"></a><span class="co">#&gt; 1       NA      2            0     0.0000</span></span>
<span id="cb809-15"><a href="remedies-for-staggered-did-biases.html#cb809-15" tabindex="-1"></a><span class="co">#&gt; 2       NA      2            0   100.4854</span></span>
<span id="cb809-16"><a href="remedies-for-staggered-did-biases.html#cb809-16" tabindex="-1"></a><span class="co">#&gt; 3       NA      2            0  3317.4678</span></span>
<span id="cb809-17"><a href="remedies-for-staggered-did-biases.html#cb809-17" tabindex="-1"></a><span class="co">#&gt; 4       NA      2            0  4793.7451</span></span>
<span id="cb809-18"><a href="remedies-for-staggered-did-biases.html#cb809-18" tabindex="-1"></a><span class="co">#&gt; 5       NA      2            0 22781.8555</span></span>
<span id="cb809-19"><a href="remedies-for-staggered-did-biases.html#cb809-19" tabindex="-1"></a><span class="co">#&gt; 6       NA      2            0 25564.6699</span></span>
<span id="cb809-20"><a href="remedies-for-staggered-did-biases.html#cb809-20" tabindex="-1"></a></span>
<span id="cb809-21"><a href="remedies-for-staggered-did-biases.html#cb809-21" tabindex="-1"></a></span>
<span id="cb809-22"><a href="remedies-for-staggered-did-biases.html#cb809-22" tabindex="-1"></a><span class="co"># locally efficient doubly robust DiD Estimators for the ATT</span></span>
<span id="cb809-23"><a href="remedies-for-staggered-did-biases.html#cb809-23" tabindex="-1"></a>out <span class="ot">&lt;-</span></span>
<span id="cb809-24"><a href="remedies-for-staggered-did-biases.html#cb809-24" tabindex="-1"></a>    <span class="fu">drdid</span>(</span>
<span id="cb809-25"><a href="remedies-for-staggered-did-biases.html#cb809-25" tabindex="-1"></a>        <span class="at">yname =</span> <span class="st">&quot;re&quot;</span>,</span>
<span id="cb809-26"><a href="remedies-for-staggered-did-biases.html#cb809-26" tabindex="-1"></a>        <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb809-27"><a href="remedies-for-staggered-did-biases.html#cb809-27" tabindex="-1"></a>        <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb809-28"><a href="remedies-for-staggered-did-biases.html#cb809-28" tabindex="-1"></a>        <span class="at">dname =</span> <span class="st">&quot;experimental&quot;</span>,</span>
<span id="cb809-29"><a href="remedies-for-staggered-did-biases.html#cb809-29" tabindex="-1"></a>        <span class="at">xformla =</span> <span class="sc">~</span> age <span class="sc">+</span> educ <span class="sc">+</span> black <span class="sc">+</span> married <span class="sc">+</span> nodegree <span class="sc">+</span> hisp <span class="sc">+</span> re74,</span>
<span id="cb809-30"><a href="remedies-for-staggered-did-biases.html#cb809-30" tabindex="-1"></a>        <span class="at">data =</span> eval_lalonde_cps,</span>
<span id="cb809-31"><a href="remedies-for-staggered-did-biases.html#cb809-31" tabindex="-1"></a>        <span class="at">panel =</span> <span class="cn">TRUE</span></span>
<span id="cb809-32"><a href="remedies-for-staggered-did-biases.html#cb809-32" tabindex="-1"></a>    )</span>
<span id="cb809-33"><a href="remedies-for-staggered-did-biases.html#cb809-33" tabindex="-1"></a><span class="fu">summary</span>(out)</span>
<span id="cb809-34"><a href="remedies-for-staggered-did-biases.html#cb809-34" tabindex="-1"></a><span class="co">#&gt;  Call:</span></span>
<span id="cb809-35"><a href="remedies-for-staggered-did-biases.html#cb809-35" tabindex="-1"></a><span class="co">#&gt; drdid(yname = &quot;re&quot;, tname = &quot;year&quot;, idname = &quot;id&quot;, dname = &quot;experimental&quot;, </span></span>
<span id="cb809-36"><a href="remedies-for-staggered-did-biases.html#cb809-36" tabindex="-1"></a><span class="co">#&gt;     xformla = ~age + educ + black + married + nodegree + hisp + </span></span>
<span id="cb809-37"><a href="remedies-for-staggered-did-biases.html#cb809-37" tabindex="-1"></a><span class="co">#&gt;         re74, data = eval_lalonde_cps, panel = TRUE)</span></span>
<span id="cb809-38"><a href="remedies-for-staggered-did-biases.html#cb809-38" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------</span></span>
<span id="cb809-39"><a href="remedies-for-staggered-did-biases.html#cb809-39" tabindex="-1"></a><span class="co">#&gt;  Further improved locally efficient DR DID estimator for the ATT:</span></span>
<span id="cb809-40"><a href="remedies-for-staggered-did-biases.html#cb809-40" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb809-41"><a href="remedies-for-staggered-did-biases.html#cb809-41" tabindex="-1"></a><span class="co">#&gt;    ATT     Std. Error  t value    Pr(&gt;|t|)  [95% Conf. Interval] </span></span>
<span id="cb809-42"><a href="remedies-for-staggered-did-biases.html#cb809-42" tabindex="-1"></a><span class="co">#&gt; -901.2703   393.6247   -2.2897     0.022    -1672.7747  -129.766 </span></span>
<span id="cb809-43"><a href="remedies-for-staggered-did-biases.html#cb809-43" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------</span></span>
<span id="cb809-44"><a href="remedies-for-staggered-did-biases.html#cb809-44" tabindex="-1"></a><span class="co">#&gt;  Estimator based on panel data.</span></span>
<span id="cb809-45"><a href="remedies-for-staggered-did-biases.html#cb809-45" tabindex="-1"></a><span class="co">#&gt;  Outcome regression est. method: weighted least squares.</span></span>
<span id="cb809-46"><a href="remedies-for-staggered-did-biases.html#cb809-46" tabindex="-1"></a><span class="co">#&gt;  Propensity score est. method: inverse prob. tilting.</span></span>
<span id="cb809-47"><a href="remedies-for-staggered-did-biases.html#cb809-47" tabindex="-1"></a><span class="co">#&gt;  Analytical standard error.</span></span>
<span id="cb809-48"><a href="remedies-for-staggered-did-biases.html#cb809-48" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------------------------</span></span>
<span id="cb809-49"><a href="remedies-for-staggered-did-biases.html#cb809-49" tabindex="-1"></a><span class="co">#&gt;  See Sant&#39;Anna and Zhao (2020) for details.</span></span>
<span id="cb809-50"><a href="remedies-for-staggered-did-biases.html#cb809-50" tabindex="-1"></a></span>
<span id="cb809-51"><a href="remedies-for-staggered-did-biases.html#cb809-51" tabindex="-1"></a></span>
<span id="cb809-52"><a href="remedies-for-staggered-did-biases.html#cb809-52" tabindex="-1"></a></span>
<span id="cb809-53"><a href="remedies-for-staggered-did-biases.html#cb809-53" tabindex="-1"></a><span class="co"># Improved locally efficient doubly robust DiD estimator </span></span>
<span id="cb809-54"><a href="remedies-for-staggered-did-biases.html#cb809-54" tabindex="-1"></a><span class="co"># for the ATT, with panel data</span></span>
<span id="cb809-55"><a href="remedies-for-staggered-did-biases.html#cb809-55" tabindex="-1"></a><span class="co"># drdid_imp_panel()</span></span>
<span id="cb809-56"><a href="remedies-for-staggered-did-biases.html#cb809-56" tabindex="-1"></a></span>
<span id="cb809-57"><a href="remedies-for-staggered-did-biases.html#cb809-57" tabindex="-1"></a><span class="co"># Locally efficient doubly robust DiD estimator for the ATT, </span></span>
<span id="cb809-58"><a href="remedies-for-staggered-did-biases.html#cb809-58" tabindex="-1"></a><span class="co"># with panel data</span></span>
<span id="cb809-59"><a href="remedies-for-staggered-did-biases.html#cb809-59" tabindex="-1"></a><span class="co"># drdid_panel()</span></span>
<span id="cb809-60"><a href="remedies-for-staggered-did-biases.html#cb809-60" tabindex="-1"></a></span>
<span id="cb809-61"><a href="remedies-for-staggered-did-biases.html#cb809-61" tabindex="-1"></a><span class="co"># Locally efficient doubly robust DiD estimator for the ATT, </span></span>
<span id="cb809-62"><a href="remedies-for-staggered-did-biases.html#cb809-62" tabindex="-1"></a><span class="co"># with repeated cross-section data</span></span>
<span id="cb809-63"><a href="remedies-for-staggered-did-biases.html#cb809-63" tabindex="-1"></a><span class="co"># drdid_rc()</span></span>
<span id="cb809-64"><a href="remedies-for-staggered-did-biases.html#cb809-64" tabindex="-1"></a></span>
<span id="cb809-65"><a href="remedies-for-staggered-did-biases.html#cb809-65" tabindex="-1"></a><span class="co"># Improved locally efficient doubly robust DiD estimator for the ATT, </span></span>
<span id="cb809-66"><a href="remedies-for-staggered-did-biases.html#cb809-66" tabindex="-1"></a><span class="co"># with repeated cross-section data</span></span>
<span id="cb809-67"><a href="remedies-for-staggered-did-biases.html#cb809-67" tabindex="-1"></a><span class="co"># drdid_imp_rc()</span></span></code></pre></div>
</div>
<div id="augmentedforward-did" class="section level3 hasAnchor" number="30.11.10">
<h3><span class="header-section-number">30.11.10</span> Augmented/Forward DID<a href="remedies-for-staggered-did-biases.html#augmentedforward-did" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>DID Methods for Limited Pre-Treatment Periods:</li>
</ul>
<table style="width:99%;">
<colgroup>
<col width="12%" />
<col width="34%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Method</strong></th>
<th><strong>Scenario</strong></th>
<th><strong>Approach</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Augmented DID</strong></p>
<p><span class="citation">(<a href="#ref-li2023augmented">K. T. Li and Van den Bulte 2023</a>)</span></p></td>
<td>Treatment outcome is outside the range of control units</td>
<td>Constructs the treatment counterfactual using a scaled average of control units</td>
</tr>
<tr class="even">
<td><p><strong>Forward DID</strong></p>
<p><span class="citation">(<a href="#ref-li2024frontiers">K. T. Li 2024</a>)</span></p></td>
<td>Treatment outcome is within the range of control units</td>
<td>Uses a forward selection algorithm to choose relevant control units before applying DID</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abadie2010synthetic" class="csl-entry">
Abadie, Alberto, Alexis Diamond, and Jens Hainmueller. 2010. <span>“Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco Control Program.”</span> <em>Journal of the American Statistical Association</em> 105 (490): 493–505.
</div>
<div id="ref-acemoglu2019democracy" class="csl-entry">
Acemoglu, Daron, Suresh Naidu, Pascual Restrepo, and James A Robinson. 2019. <span>“Democracy Does Cause Growth.”</span> <em>Journal of Political Economy</em> 127 (1): 47–100.
</div>
<div id="ref-athey2021matrix" class="csl-entry">
Athey, Susan, Mohsen Bayati, Nikolay Doudchenko, Guido Imbens, and Khashayar Khosravi. 2021. <span>“Matrix Completion Methods for Causal Panel Data Models.”</span> <em>Journal of the American Statistical Association</em> 116 (536): 1716–30.
</div>
<div id="ref-athey2006identification" class="csl-entry">
Athey, Susan, and Guido W Imbens. 2006. <span>“Identification and Inference in Nonlinear Difference-in-Differences Models.”</span> <em>Econometrica</em> 74 (2): 431–97.
</div>
<div id="ref-athey2022design" class="csl-entry">
———. 2022. <span>“Design-Based Analysis in Difference-in-Differences Settings with Staggered Adoption.”</span> <em>Journal of Econometrics</em> 226 (1): 62–79.
</div>
<div id="ref-baker2022much" class="csl-entry">
Baker, Andrew C, David F Larcker, and Charles CY Wang. 2022. <span>“How Much Should We Trust Staggered Difference-in-Differences Estimates?”</span> <em>Journal of Financial Economics</em> 144 (2): 370–95.
</div>
<div id="ref-borusyak2021revisiting" class="csl-entry">
Borusyak, Kirill, Xavier Jaravel, and Jann Spiess. 2021. <span>“Revisiting Event Study Designs: Robust and Efficient Estimation.”</span> <em>arXiv Preprint arXiv:2108.12419</em>.
</div>
<div id="ref-borusyak2024revisiting" class="csl-entry">
———. 2024. <span>“Revisiting Event-Study Designs: Robust and Efficient Estimation.”</span> <em>Review of Economic Studies</em> 91 (6): 3253–85.
</div>
<div id="ref-bronnenberg2020consumer" class="csl-entry">
Bronnenberg, Bart J, Jean-Pierre Dubé, and Robert E Sanders. 2020. <span>“Consumer Misinformation and the Brand Premium: A Private Label Blind Taste Test.”</span> <em>Marketing Science</em> 39 (2): 382–406.
</div>
<div id="ref-brown2023simple" class="csl-entry">
Brown, Nicholas, Kyle Butts, and Joakim Westerlund. 2023. <span>“Simple Difference-in-Differences Estimation in Fixed-t Panels.”</span> <em>arXiv Preprint arXiv:2301.11358</em>.
</div>
<div id="ref-callaway2021difference" class="csl-entry">
Callaway, Brantly, and Pedro HC Sant’Anna. 2021. <span>“Difference-in-Differences with Multiple Time Periods.”</span> <em>Journal of Econometrics</em> 225 (2): 200–230.
</div>
<div id="ref-cengiz2019effect" class="csl-entry">
Cengiz, Doruk, Arindrajit Dube, Attila Lindner, and Ben Zipperer. 2019. <span>“The Effect of Minimum Wages on Low-Wage Jobs.”</span> <em>The Quarterly Journal of Economics</em> 134 (3): 1405–54.
</div>
<div id="ref-de2023two" class="csl-entry">
De Chaisemartin, Clement, and Xavier D’haultfœuille. 2023. <span>“Two-Way Fixed Effects and Differences-in-Differences Estimators with Several Treatments.”</span> <em>Journal of Econometrics</em> 236 (2): 105480.
</div>
<div id="ref-de2020two" class="csl-entry">
De Chaisemartin, Clément, and Xavier d’Haultfoeuille. 2020. <span>“Two-Way Fixed Effects Estimators with Heterogeneous Treatment Effects.”</span> <em>American Economic Review</em> 110 (9): 2964–96.
</div>
<div id="ref-deshpande2019screened" class="csl-entry">
Deshpande, Manasi, and Yue Li. 2019. <span>“Who Is Screened Out? Application Costs and the Targeting of Disability Programs.”</span> <em>American Economic Journal: Economic Policy</em> 11 (4): 213–48.
</div>
<div id="ref-gardner2022two" class="csl-entry">
Gardner, John. 2022. <span>“Two-Stage Differences in Differences.”</span> <em>arXiv Preprint arXiv:2207.05943</em>.
</div>
<div id="ref-gibbons2018broken" class="csl-entry">
Gibbons, Charles E, Juan Carlos Suárez Serrato, and Michael B Urbancic. 2018. <span>“Broken or Fixed Effects?”</span> <em>Journal of Econometric Methods</em> 8 (1): 20170002.
</div>
<div id="ref-goodman2021difference" class="csl-entry">
Goodman-Bacon, Andrew. 2021. <span>“Difference-in-Differences with Variation in Treatment Timing.”</span> <em>Journal of Econometrics</em> 225 (2): 254–77.
</div>
<div id="ref-gormley2011growing" class="csl-entry">
Gormley, Todd A, and David A Matsa. 2011. <span>“Growing Out of Trouble? Corporate Responses to Liability Risk.”</span> <em>The Review of Financial Studies</em> 24 (8): 2781–821.
</div>
<div id="ref-ho2007matching" class="csl-entry">
Ho, Daniel E, Kosuke Imai, Gary King, and Elizabeth A Stuart. 2007. <span>“Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference.”</span> <em>Political Analysis</em> 15 (3): 199–236.
</div>
<div id="ref-imai2019should" class="csl-entry">
Imai, Kosuke, and In Song Kim. 2019. <span>“When Should We Use Unit Fixed Effects Regression Models for Causal Inference with Longitudinal Data?”</span> <em>American Journal of Political Science</em> 63 (2): 467–90.
</div>
<div id="ref-imai2021use" class="csl-entry">
———. 2021. <span>“On the Use of Two-Way Fixed Effects Regression Models for Causal Inference with Panel Data.”</span> <em>Political Analysis</em> 29 (3): 405–15.
</div>
<div id="ref-imai2021matching" class="csl-entry">
Imai, Kosuke, In Song Kim, and Erik H Wang. 2021. <span>“Matching Methods for Causal Inference with Time-Series Cross-Sectional Data.”</span> <em>American Journal of Political Science</em>.
</div>
<div id="ref-imbens2015causal" class="csl-entry">
Imbens, Guido W, and Donald B Rubin. 2015. <em>Causal Inference in Statistics, Social, and Biomedical Sciences</em>. Cambridge University Press.
</div>
<div id="ref-li2024frontiers" class="csl-entry">
Li, Kathleen T. 2024. <span>“Frontiers: A Simple Forward Difference-in-Differences Method.”</span> <em>Marketing Science</em> 43 (2): 267–79.
</div>
<div id="ref-li2023augmented" class="csl-entry">
Li, Kathleen T, and Christophe Van den Bulte. 2023. <span>“Augmented Difference-in-Differences.”</span> <em>Marketing Science</em> 42 (4): 746–67.
</div>
<div id="ref-liu2022practical" class="csl-entry">
Liu, Licheng, Ye Wang, and Yiqing Xu. 2022. <span>“A Practical Guide to Counterfactual Estimators for Causal Inference with Time-Series Cross-Sectional Data.”</span> <em>American Journal of Political Science</em>.
</div>
<div id="ref-mazumder2010spectral" class="csl-entry">
Mazumder, Rahul, Trevor Hastie, and Robert Tibshirani. 2010. <span>“Spectral Regularization Algorithms for Learning Large Incomplete Matrices.”</span> <em>The Journal of Machine Learning Research</em> 11: 2287–2322.
</div>
<div id="ref-moon2015linear" class="csl-entry">
Moon, Hyungsik Roger, and Martin Weidner. 2015. <span>“Linear Regression for Panel with Unknown Number of Factors as Interactive Fixed Effects.”</span> <em>Econometrica</em> 83 (4): 1543–79. https://doi.org/<a href="https://doi.org/10.3982/ECTA9382">https://doi.org/10.3982/ECTA9382</a>.
</div>
<div id="ref-rosenbaum1983central" class="csl-entry">
Rosenbaum, Paul R, and Donald B Rubin. 1983. <span>“The Central Role of the Propensity Score in Observational Studies for Causal Effects.”</span> <em>Biometrika</em> 70 (1): 41–55.
</div>
<div id="ref-sant2020doubly" class="csl-entry">
Sant’Anna, Pedro HC, and Jun Zhao. 2020. <span>“Doubly Robust Difference-in-Differences Estimators.”</span> <em>Journal of Econometrics</em> 219 (1): 101–22.
</div>
<div id="ref-sun2021estimating" class="csl-entry">
Sun, Liyang, and Sarah Abraham. 2021. <span>“Estimating Dynamic Treatment Effects in Event Studies with Heterogeneous Treatment Effects.”</span> <em>Journal of Econometrics</em> 225 (2): 175–99.
</div>
<div id="ref-wooldridge2023simple" class="csl-entry">
———. 2023. <span>“Simple Approaches to Nonlinear Difference-in-Differences with Panel Data.”</span> <em>The Econometrics Journal</em> 26 (3): C31–66.
</div>
<div id="ref-xu2017generalized" class="csl-entry">
Xu, Yiqing. 2017. <span>“Generalized Synthetic Control Method: Causal Inference with Interactive Fixed Effects Models.”</span> <em>Political Analysis</em> 25 (1): 57–76.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="key-assumptions-of-staggered-did-designs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-treatments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mikenguyen13/data_analysis/edit/main/30-dif-in-dif.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mikenguyen13/data_analysis/blob/main/30-dif-in-dif.Rmd",
    "text": null
  },
  "download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true,
    "sharing": {
      "facebook": true,
      "github": true,
      "twitter": true,
      "linkedin": true
    },
    "info": true,
    "edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
