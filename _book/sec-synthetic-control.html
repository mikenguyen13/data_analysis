<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 32 Synthetic Control | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="The Synthetic Control Method (SCM) is a powerful causal inference tool used when only one treated unit exists, and researchers must construct a synthetic comparison group from a donor pool of...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 32 Synthetic Control | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/sec-synthetic-control.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="The Synthetic Control Method (SCM) is a powerful causal inference tool used when only one treated unit exists, and researchers must construct a synthetic comparison group from a donor pool of...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 32 Synthetic Control | A Guide on Data Analysis">
<meta name="twitter:description" content="The Synthetic Control Method (SCM) is a powerful causal inference tool used when only one treated unit exists, and researchers must construct a synthetic comparison group from a donor pool of...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="active" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="sec-endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="sec-directed-acyclic-graphs.html"><span class="header-section-number">38</span> Directed Acyclic Graphs</a></li>
<li><a class="" href="sec-controls.html"><span class="header-section-number">39</span> Controls</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li><a class="" href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
<li><a class="" href="chapter-cluster-randomization-and-interference-bias.html"><span class="header-section-number">C</span> Chapter: Cluster Randomization and Interference Bias</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="sec-synthetic-control" class="section level1" number="32">
<h1>
<span class="header-section-number">32</span> Synthetic Control<a class="anchor" aria-label="anchor" href="#sec-synthetic-control"><i class="fas fa-link"></i></a>
</h1>
<p>The Synthetic Control Method (SCM) is a powerful causal inference tool used when only one treated unit exists, and researchers must construct a synthetic comparison group from a donor pool of untreated units. Introduced by <span class="citation">Abadie and Gardeazabal (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-abadie2003economic">2003</a>)</span> and later extended by <span class="citation">Abadie, Diamond, and Hainmueller (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-abadie2010synthetic">2010</a>)</span>, SCM has become a widely used method in policy evaluation and business analytics. See <span class="citation">Abadie (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-abadie2021using">2021</a>)</span> for a review of the method.</p>
<p>Why Use SCM?</p>
<ul>
<li>A data-driven method for constructing a comparable control group (i.e., “black box” approach).</li>
<li>Avoids large bias when covariate distributions do not match between treated and control groups.</li>
<li>Natural alternative to <a href="sec-difference-in-differences.html#sec-difference-in-differences">Difference-in-Differences</a> when:
<ul>
<li>No perfect untreated comparison group exists.</li>
<li>Treatment is applied to a single unit or a small number of units.</li>
</ul>
</li>
</ul>
<p>SCM is recommended in settings where:</p>
<ol style="list-style-type: decimal">
<li>A major policy or social event is being evaluated (e.g., minimum wage laws, tax reforms, advertising campaigns).</li>
<li>Only one treated case exists, with several potential controls (e.g., a state enacts a new law, while others do not).</li>
</ol>
<div id="marketing-applications" class="section level2" number="32.1">
<h2>
<span class="header-section-number">32.1</span> Marketing Applications<a class="anchor" aria-label="anchor" href="#marketing-applications"><i class="fas fa-link"></i></a>
</h2>
<p>SCM has been applied in various marketing and business contexts:</p>
<ul>
<li>Impact of Offline TV Advertising on Online Chatter <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-tirunillai2017">Tirunillai and Tellis 2017</a>)</span>
</li>
<li>Effect of Mobile Hailing Technology Adoption on Drivers’ Hourly Earnings <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-wang2019mobile">Wang, Wu, and Zhu 2019</a>)</span>
</li>
<li>Impact of Payment Disclosure Laws on Physician Prescription Behavior (Massachusetts Open Payment Law) <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-guo2020let">Guo, Sriram, and Manchanda 2020</a>)</span>
</li>
<li>Effect of Mandatory GMO Labels on Consumer Demand (Vermont as a case study) <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-adalja2023gmo">Adalja et al. 2023</a>)</span>
</li>
</ul>
</div>
<div id="key-features-of-scm" class="section level2" number="32.2">
<h2>
<span class="header-section-number">32.2</span> Key Features of SCM<a class="anchor" aria-label="anchor" href="#key-features-of-scm"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>SCM estimates asymptotically normal parameters in linear panel models when the pre-treatment period is sufficiently long, making it a natural alternative to the <a href="sec-difference-in-differences.html#sec-difference-in-differences">Difference-in-Differences</a> model <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-arkhangelsky2023large">Arkhangelsky and Hirshberg 2023</a>)</span>.</li>
<li>SCM is superior to <a href="sec-matching-methods.html#sec-matching-methods">Matching Methods</a>, as it matches not only on pre-treatment covariates but also on pre-treatment outcomes. SCM differs from <a href="sec-matching-methods.html#sec-matching-methods">Matching Methods</a> because:
<ul>
<li>Matching methods focus on covariates.</li>
<li>SCM constructs a synthetic unit by matching on pre-treatment outcomes.</li>
</ul>
</li>
<li>SCM can be implemented under a Bayesian framework (<a href="sec-synthetic-control.html#bayesian-synthetic-control">Bayesian Synthetic Control</a>) to avoid restrictive priors <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-kim2020bayesian">S. Kim, Lee, and Gupta 2020</a>)</span>.</li>
</ul>
</div>
<div id="advantages-of-scm" class="section level2" number="32.3">
<h2>
<span class="header-section-number">32.3</span> Advantages of SCM<a class="anchor" aria-label="anchor" href="#advantages-of-scm"><i class="fas fa-link"></i></a>
</h2>
<div id="compared-to-did" class="section level3" number="32.3.1">
<h3>
<span class="header-section-number">32.3.1</span> Compared to DiD<a class="anchor" aria-label="anchor" href="#compared-to-did"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Maximizes similarity between control and treated units (including unobservables).</li>
<li>Useful when no untreated unit closely matches the treated unit.</li>
<li>Objective selection of control units, reducing researcher bias.</li>
</ol>
</div>
<div id="compared-to-linear-regression" class="section level3" number="32.3.2">
<h3>
<span class="header-section-number">32.3.2</span> Compared to Linear Regression<a class="anchor" aria-label="anchor" href="#compared-to-linear-regression"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Avoids extrapolation (no regression weights outside of [0,1]).</li>
<li>Provides transparent weights, explicitly showing control unit contributions.</li>
<li>Does not require post-treatment outcomes of the control group (reducing risk of p-hacking).</li>
</ol>
</div>
<div id="additional-advantages" class="section level3" number="32.3.3">
<h3>
<span class="header-section-number">32.3.3</span> Additional Advantages<a class="anchor" aria-label="anchor" href="#additional-advantages"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Selection criteria provide insights into the relative importance of each donor unit.</li>
<li>Prevents overfitting, since post-intervention outcomes are not used when constructing the synthetic control.</li>
<li>Enhances interpretability, since the synthetic unit is constructed using observable pre-treatment characteristics.</li>
</ol>
</div>
</div>
<div id="disadvantages-of-scm" class="section level2" number="32.4">
<h2>
<span class="header-section-number">32.4</span> Disadvantages of SCM<a class="anchor" aria-label="anchor" href="#disadvantages-of-scm"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Interpretability of Weights: It can be difficult to justify the exact weights assigned to control units.</li>
<li>Strong Assumptions: Assumes the counterfactual outcome of the treated unit can be expressed as a linear combination of control units.</li>
<li>Limited in Small Samples: Requires a large set of pre-treatment periods and a sufficiently large donor pool.</li>
</ol>
<hr>
</div>
<div id="assumptions-4" class="section level2" number="32.5">
<h2>
<span class="header-section-number">32.5</span> Assumptions<a class="anchor" aria-label="anchor" href="#assumptions-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Good Donor Pool Matching
<ul>
<li>The synthetic control should closely resemble the treated unit in pre-treatment periods.</li>
<li>The gap between pre-treatment outcomes of the treated unit and synthetic control should be zero (or very small).</li>
</ul>
</li>
<li>No Contamination
<ul>
<li>Only the treated unit experiences the intervention.</li>
<li>Control units in the donor pool do not receive treatment.</li>
</ul>
</li>
<li>No Other Major Changes
<ul>
<li>The treatment is the only significant event affecting the treated unit.</li>
</ul>
</li>
<li>Linearity Assumption
<ul>
<li>The counterfactual outcome of the treated unit can be constructed as a weighted sum of the control units.</li>
</ul>
</li>
<li>Exlusion Restriction (Identification Assumption):
<ul>
<li>The exclusion restriction holds conditional on pre-treatment outcomes.</li>
</ul>
</li>
</ol>
<p>The <code>Synth</code> package provides an algorithm to determine the optimal weight for each control unit such that the synthetic control best resembles the treated unit before treatment.</p>
<hr>
</div>
<div id="estimation-3" class="section level2" number="32.6">
<h2>
<span class="header-section-number">32.6</span> Estimation<a class="anchor" aria-label="anchor" href="#estimation-3"><i class="fas fa-link"></i></a>
</h2>
<p>We observe <span class="math inline">\(J + 1\)</span> units over <span class="math inline">\(T\)</span> time periods.</p>
<ul>
<li>The first unit (<span class="math inline">\(i = 1\)</span>) is treated starting from time <span class="math inline">\(T_0 + 1\)</span>.</li>
<li>The remaining <span class="math inline">\(J\)</span> units serve as the donor pool (potential controls).</li>
<li>Define:
<ul>
<li>
<span class="math inline">\(Y_{it}^I\)</span>: Outcome for unit <span class="math inline">\(i\)</span> under treatment (<span class="math inline">\(i=1\)</span>, for <span class="math inline">\(t \geq T_0 + 1\)</span>).</li>
<li>
<span class="math inline">\(Y_{it}^N\)</span>: Outcome for unit <span class="math inline">\(i\)</span> in the absence of treatment (counterfactual).</li>
</ul>
</li>
</ul>
<p>The goal is to estimate the treatment effect:</p>
<p><span class="math display">\[
\tau_{1t} = Y_{1t}^I - Y_{1t}^N
\]</span></p>
<p>where we observe:</p>
<p><span class="math display">\[
Y_{1t}^I = Y_{1t}
\]</span></p>
<p>but <span class="math inline">\(Y_{1t}^N\)</span> is unobserved and must be estimated using a synthetic control.</p>
<div id="constructing-the-synthetic-control" class="section level3" number="32.6.1">
<h3>
<span class="header-section-number">32.6.1</span> Constructing the Synthetic Control<a class="anchor" aria-label="anchor" href="#constructing-the-synthetic-control"><i class="fas fa-link"></i></a>
</h3>
<p>To estimate the counterfactual outcome, we create a synthetic control unit, a weighted combination of the untreated donor units. We assign weights <span class="math inline">\(\mathbf{W} = (w_2, \dots, w_{J+1})'\)</span> that satisfy:</p>
<ul>
<li>Non-negativity constraint:<br><span class="math display">\[ w_j \geq 0, \quad \forall j = 2, \dots, J+1 \]</span>
</li>
<li>Sum-to-one constraint:<br><span class="math display">\[ w_2 + w_3 + \dots + w_{J+1} = 1 \]</span>
</li>
</ul>
<p>The optimal weights are found by solving:</p>
<p><span class="math display">\[
\min_{\mathbf{W}} ||\mathbf{X}_1 - \mathbf{X}_0 \mathbf{W}||
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\mathbf{X}_1\)</span> is a <span class="math inline">\(k \times 1\)</span> vector of pre-treatment characteristics for the treated unit.</li>
<li>
<span class="math inline">\(\mathbf{X}_0\)</span> is a <span class="math inline">\(k \times J\)</span> matrix of pre-treatment characteristics for the donor units.</li>
</ul>
<p>A common approach is to minimize the weighted sum:</p>
<p><span class="math display">\[
\min_{\mathbf{W}} \sum_{h=1}^{k} v_h (X_{h1} - w_2 X_{h2} - \dots - w_{J+1} X_{hJ+1})^2
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(v_h\)</span> represents the predictive power of each <span class="math inline">\(k\)</span>-dimensional pre-treatment characteristic on <span class="math inline">\(Y_{1t}^N\)</span>.</li>
<li>The weights <span class="math inline">\(v_h\)</span> can be chosen either:
<ul>
<li>Explicitly by the researcher, or</li>
<li>Data-driven via optimization.</li>
</ul>
</li>
</ul>
<hr>
</div>
<div id="penalized-synthetic-control" class="section level3" number="32.6.2">
<h3>
<span class="header-section-number">32.6.2</span> Penalized Synthetic Control<a class="anchor" aria-label="anchor" href="#penalized-synthetic-control"><i class="fas fa-link"></i></a>
</h3>
<p>To reduce interpolation bias, the penalized synthetic control method <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-abadie2021penalized">Abadie and L’hour 2021</a>)</span> modifies the optimization problem:</p>
<p><span class="math display">\[
\min_{\mathbf{W}} ||\mathbf{X}_1 - \sum_{j=2}^{J+1}W_j \mathbf{X}_j ||^2 + \lambda \sum_{j=2}^{J+1} W_j ||\mathbf{X}_1 - \mathbf{X}_j||^2
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\lambda &gt; 0\)</span> controls the trade-off between fit and regularization:
<ul>
<li>
<span class="math inline">\(\lambda \to 0\)</span>: Standard synthetic control (unpenalized).</li>
<li>
<span class="math inline">\(\lambda \to \infty\)</span>: Nearest-neighbor matching (strong penalization).</li>
</ul>
</li>
<li>This method ensures:
<ul>
<li>Sparse and unique solutions for weights.</li>
<li>Exclusion of dissimilar control units (reducing interpolation bias).</li>
</ul>
</li>
</ul>
<p>The final synthetic control estimator is:</p>
<p><span class="math display">\[
\hat{\tau}_{1t} = Y_{1t} - \sum_{j=2}^{J+1} w_j^* Y_{jt}
\]</span></p>
<p>where <span class="math inline">\(Y_{jt}\)</span> is the outcome for unit <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span>.</p>
<hr>
</div>
</div>
<div id="theoretical-considerations" class="section level2" number="32.7">
<h2>
<span class="header-section-number">32.7</span> Theoretical Considerations<a class="anchor" aria-label="anchor" href="#theoretical-considerations"><i class="fas fa-link"></i></a>
</h2>
<p>SCM assumes that the counterfactual outcome follows a factor model <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-abadie2010synthetic">Abadie, Diamond, and Hainmueller 2010</a>)</span>:</p>
<p><span class="math display">\[
Y_{it}^N = \mathbf{\theta}_t \mathbf{Z}_i + \mathbf{\lambda}_t \mathbf{\mu}_i + \epsilon_{it}
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\mathbf{Z}_i\)</span> = Observed characteristics.</li>
<li>
<span class="math inline">\(\mathbf{\mu}_i\)</span> = Unobserved factors.</li>
<li>
<span class="math inline">\(\epsilon_{it}\)</span> = Transitory shocks (random noise).</li>
</ul>
<p>To ensure a valid synthetic control, the weights <span class="math inline">\(\mathbf{W}^*\)</span> must satisfy:</p>
<p><span class="math display">\[
\sum_{j=2}^{J+1} w_j^* \mathbf{Z}_j  = \mathbf{Z}_1
\]</span></p>
<p><span class="math display">\[
\sum_{j=2}^{J+1} w_j^* Y_{j1} = Y_{11}, \quad \dots, \quad \sum_{j=2}^{J+1} w_j^* Y_{jT_0} = Y_{1T_0}
\]</span></p>
<p>This guarantees that the synthetic control closely matches the treated unit in pre-treatment periods.</p>
<p>Bias Considerations:</p>
<ul>
<li>The accuracy of SCM depends on the ratio of transitory shocks (<span class="math inline">\(\epsilon_{it}\)</span>) to pre-treatment periods (<span class="math inline">\(T_0\)</span>). In other words, you should have good fit for <span class="math inline">\(Y_{1t}\)</span> for pre-treatment period (i.e., <span class="math inline">\(T_0\)</span> should be large while small variance in <span class="math inline">\(\epsilon_{it}\)</span>)</li>
<li>Good fit in pre-treatment periods (large <span class="math inline">\(T_0\)</span>) is crucial.</li>
<li>If the pre-treatment fit is poor, bias correction methods are required <span class="citation">Ben-Michael, Feller, and Rothstein (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-ben2020varying">2020</a>)</span>.</li>
</ul>
<hr>
</div>
<div id="inference-in-scm" class="section level2" number="32.8">
<h2>
<span class="header-section-number">32.8</span> Inference in SCM<a class="anchor" aria-label="anchor" href="#inference-in-scm"><i class="fas fa-link"></i></a>
</h2>
<p>Unlike traditional methods, SCM does not rely on standard statistical inference due to:</p>
<ol style="list-style-type: decimal">
<li>Undefined sampling mechanism (e.g., only one treated unit).</li>
<li>SCM is deterministic, making p-values difficult to interpret.</li>
</ol>
<div id="permutation-placebo-inference" class="section level3" number="32.8.1">
<h3>
<span class="header-section-number">32.8.1</span> Permutation (Placebo) Inference<a class="anchor" aria-label="anchor" href="#permutation-placebo-inference"><i class="fas fa-link"></i></a>
</h3>
<p>To perform inference:</p>
<ol style="list-style-type: decimal">
<li>Iteratively reassign the treatment to units in the donor pool.</li>
<li>Estimate placebo treatment effects for each synthetic control.</li>
<li>Compare the actual treatment effect to the placebo distribution.</li>
</ol>
<p>The treatment effect is considered statistically significant if it is extreme relative to the placebo distribution.</p>
</div>
<div id="one-sided-inference" class="section level3" number="32.8.2">
<h3>
<span class="header-section-number">32.8.2</span> One-Sided Inference<a class="anchor" aria-label="anchor" href="#one-sided-inference"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Recommended due to the limited number of treated cases.</li>
<li>The permutation test is more robust than standard p-values.</li>
</ul>
<p>For benchmark distributions (e.g., uniform permutation distributions), see <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-firpo2018synthetic">Firpo and Possebom 2018</a>)</span>.</p>
<hr>
</div>
</div>
<div id="sec-augmented-synthetic-control" class="section level2" number="32.9">
<h2>
<span class="header-section-number">32.9</span> Augmented Synthetic Control Method<a class="anchor" aria-label="anchor" href="#sec-augmented-synthetic-control"><i class="fas fa-link"></i></a>
</h2>
<p>The Augmented Synthetic Control Method (ASCM), introduced by <span class="citation">Ben-Michael, Feller, and Rothstein (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-ben2021augmented">2021</a>)</span>, extends the Synthetic Control Method to cases where perfect pre-treatment fit is infeasible. ASCM combines SCM weighting with bias correction through an outcome model, improving estimates when SCM alone fails to match pre-treatment outcomes precisely.</p>
<p>Key Idea:</p>
<ul>
<li>Standard SCM requires that the synthetic control closely matches the treated unit in pre-treatment periods.</li>
<li>When this is not possible, ASCM adjusts for bias using outcome modeling, similar to bias correction in matching estimators.</li>
<li>ASCM can be seen as a trade-off between SCM and regression-based approaches, incorporating both synthetic control weighting and outcome modeling.</li>
</ul>
<p>ASCM builds on SCM but relaxes its strong convex hull assumption. Key assumptions:</p>
<ul>
<li><p>No Interference: Treatment affects only the treated unit.</p></li>
<li><p>No Unobserved Time-Varying Confounders: Changes over time should not be correlated with treatment assignment.</p></li>
<li><p>Regularization Controls Extrapolation Bias: Ridge penalty prevents overfitting.</p></li>
</ul>
<p>ASCM is recommended when:</p>
<ol style="list-style-type: decimal">
<li><p>SCM alone does not provide a good pre-treatment fit.</p></li>
<li><p>Only one treated unit is available.</p></li>
<li><p>Auxiliary covariates need to be incorporated.</p></li>
</ol>
<p>Advantages of ASCM</p>
<ol style="list-style-type: decimal">
<li>Handles Poor Pre-Treatment Fit
<ul>
<li>Standard SCM fails when the treated unit lies outside the convex hull of donor units.</li>
<li>ASCM allows negative weights (via ridge regression) to improve fit.</li>
</ul>
</li>
<li>Balances Bias and Variance
<ul>
<li>Ridge penalty controls extrapolation, reducing overfitting.</li>
</ul>
</li>
<li>Flexible Estimation Framework
<ul>
<li>Works with auxiliary covariates, extending beyond pure pre-treatment matching.</li>
</ul>
</li>
</ol>
<hr>
<p>Let:</p>
<ul>
<li><p><span class="math inline">\(J + 1\)</span> units be observed over <span class="math inline">\(T\)</span> time periods.</p></li>
<li><p>The first unit (<span class="math inline">\(i=1\)</span>) is treated in periods <span class="math inline">\(T_0 + 1, \dots, T\)</span>. - The remaining <span class="math inline">\(J\)</span> units are the donor pool (potential controls).</p></li>
<li>
<p>Define:</p>
<ul>
<li><p><span class="math inline">\(Y_{it}^I\)</span>: Outcome for unit <span class="math inline">\(i\)</span> under treatment.</p></li>
<li><p><span class="math inline">\(Y_{it}^N\)</span>: Outcome for unit <span class="math inline">\(i\)</span> in the absence of treatment (counterfactual).</p></li>
</ul>
</li>
</ul>
<p>The treatment effect of interest:</p>
<p><span class="math display">\[
\tau_{1t} = Y_{1t}^I - Y_{1t}^N
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
Y_{1t}^I = Y_{1t}
\]</span></p>
<p>but <span class="math inline">\(Y_{1t}^N\)</span> is unobserved and must be estimated.</p>
<p>ASCM improves SCM by incorporating an outcome model to correct for poor pre-treatment fit. The counterfactual outcome is estimated as:</p>
<p><span class="math display">\[
\hat{Y}^{\text{aug}}_{1T}(0) = \sum_{i=2}^{J+1} w_i Y_{iT} + \left( m_1 - \sum_{i=2}^{J+1} w_i m_i \right)
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(w_i\)</span> are SCM weights chosen to best match pre-treatment outcomes.</p></li>
<li><p><span class="math inline">\(m_i\)</span> is an outcome model prediction for unit <span class="math inline">\(i\)</span>.</p></li>
<li><p>If SCM achieves perfect pre-treatment fit, <span class="math inline">\(m_1 - \sum w_i m_i \approx 0\)</span>, and ASCM reduces to standard SCM.</p></li>
</ul>
<p>The most common implementation, Ridge ASCM, uses ridge regression to estimate <span class="math inline">\(m_i\)</span>, leading to:</p>
<p><span class="math display">\[
\hat{Y}^{\text{aug}}_{1T}(0) = \sum_{i=2}^{J+1} w_i Y_{iT} + \left( X_1 - \sum w_i X_i \right) \beta
\]</span></p>
<p>where <span class="math inline">\(\beta\)</span> is estimated using ridge regression of post-treatment outcomes on pre-treatment outcomes.</p>
<hr>
</div>
<div id="synthetic-control-with-staggered-adoption" class="section level2" number="32.10">
<h2>
<span class="header-section-number">32.10</span> Synthetic Control with Staggered Adoption<a class="anchor" aria-label="anchor" href="#synthetic-control-with-staggered-adoption"><i class="fas fa-link"></i></a>
</h2>
<p>While traditional SCM focuses on cases with a single treated unit, many real-world policies exhibit staggered adoption, where different units receive treatment at different times.</p>
<p>In staggered adoption designs, policy implementation occurs over multiple time periods across different units (e.g., states, companies, or regions). This presents challenges:</p>
<ul>
<li>Traditional SCM limitations: SCM was designed for a single treated unit and does not naturally accommodate multiple adoption times.</li>
<li>Heterogeneous treatment effects: The impact of the intervention may vary over time or across units.</li>
<li>Estimation bias: Common approaches such as <a href="sec-difference-in-differences.html#sec-two-way-fixed-effects">Two-Way Fixed Effects</a> can yield biased results when treatment effects are heterogeneous.</li>
</ul>
<div id="partially-pooled-synthetic-control" class="section level3" number="32.10.1">
<h3>
<span class="header-section-number">32.10.1</span> Partially Pooled Synthetic Control<a class="anchor" aria-label="anchor" href="#partially-pooled-synthetic-control"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Ben-Michael, Feller, and Rothstein (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-ben2022synthetic">2022</a>)</span> propose a partially pooled SCM approach, balancing trade-offs between separate SCM for each unit and a fully pooled approach that estimates a single synthetic control for all treated units. The key ideas include:</p>
<ol style="list-style-type: decimal">
<li>Two imbalance measures:
<ul>
<li>Individual unit-level imbalance.</li>
<li>Aggregate imbalance for the average treated unit.</li>
</ul>
</li>
<li>Optimization framework:
<ul>
<li>Weights are chosen to minimize a weighted sum of these two imbalance measures.</li>
<li>This method reduces bias compared to estimating separate SCM models for each unit​.</li>
</ul>
</li>
</ol>
<p>Mathematically, let:</p>
<ul>
<li><p><span class="math inline">\(Y_{it}\)</span> be the outcome of interest for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</p></li>
<li><p><span class="math inline">\(T_i\)</span> be the treatment adoption time for unit <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(W_i\)</span> be the synthetic control weight assigned to unit <span class="math inline">\(i\)</span>.</p></li>
</ul>
<p>Then, for treated unit <span class="math inline">\(j\)</span>, the estimated counterfactual is:</p>
<p><span class="math display">\[ \hat{Y}_{jT_j+k} = \sum_{i=1}^{N} \hat{W}_{ij} Y_{iT_j+k} \]</span></p>
<p>The objective function combines both individual and aggregate balance constraints:</p>
<p><span class="math display">\[ \min_W \lambda \sum_{j} ||Y_{j,\text{pre}} - \sum_i W_{ij} Y_{i,\text{pre}}||^2 + (1-\lambda) ||Y_{\text{treated, pre}} - \sum_i W_i Y_{i,\text{pre}}||^2 \]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is a tuning parameter that controls the trade-off between individual and pooled balance​.</p>
<div class="sourceCode" id="cb849"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">augsynth</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div id="generalized-synthetic-control" class="section level2" number="32.11">
<h2>
<span class="header-section-number">32.11</span> Generalized Synthetic Control<a class="anchor" aria-label="anchor" href="#generalized-synthetic-control"><i class="fas fa-link"></i></a>
</h2>
<p>The Generalized Synthetic Control (GSC) Method extends the synthetic control approach to accommodate multiple treated units and heterogeneous treatment effects while relaxing the <a href="sec-difference-in-differences.html#prior-parallel-trends-test">parallel trends assumption</a> required in <a href="sec-difference-in-differences.html#sec-difference-in-differences">difference-in-differences</a>. Originally developed by <span class="citation">Xu (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-xu2017generalized">2017</a>)</span>, the GSC method integrates interactive fixed effects models, improving efficiency and robustness in time-series cross-sectional (TSCS) data.</p>
<div id="the-problem-with-traditional-methods" class="section level3" number="32.11.1">
<h3>
<span class="header-section-number">32.11.1</span> The Problem with Traditional Methods<a class="anchor" aria-label="anchor" href="#the-problem-with-traditional-methods"><i class="fas fa-link"></i></a>
</h3>
<p>Traditional causal inference methods such as <a href="sec-difference-in-differences.html#sec-difference-in-differences">DID</a> require the <a href="sec-difference-in-differences.html#prior-parallel-trends-test">parallel trends assumption</a>: <span class="math display">\[
E[Y_{it}(0) | D_i = 1] - E[Y_{it}(0) | D_i = 0] = \text{constant}
\]</span> which states that in the absence of treatment, the difference in outcomes between treated and control units would have remained constant over time. However, this assumption often fails due to:</p>
<ul>
<li>Time-varying unobserved confounders affecting both treatment assignment and outcomes.</li>
<li>Heterogeneous treatment effects across units and over time.</li>
<li>Multiple treatment periods where different units adopt the treatment at different times.</li>
</ul>
<p>To address these limitations, GSC builds on the interactive fixed effects model, which allows for unit-specific and time-specific latent factors that can capture unobserved confounding trends.</p>
</div>
<div id="generalized-synthetic-control-model" class="section level3" number="32.11.2">
<h3>
<span class="header-section-number">32.11.2</span> Generalized Synthetic Control Model<a class="anchor" aria-label="anchor" href="#generalized-synthetic-control-model"><i class="fas fa-link"></i></a>
</h3>
<p>Let <span class="math inline">\(Y_{it}\)</span> represent the observed outcome of unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>, and define the potential outcomes framework: <span class="math display">\[
Y_{it}(d) = \mu_{it} + \delta_{it} d + \varepsilon_{it}, \quad d \in \{0,1\}
\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(\mu_{it}\)</span> represents the latent factor structure of untreated outcomes.</p></li>
<li><p><span class="math inline">\(\delta_{it}\)</span> is the treatment effect.</p></li>
<li><p><span class="math inline">\(\varepsilon_{it}\)</span> is the idiosyncratic error term.</p></li>
</ul>
<p>Under the interactive fixed effects model, we assume that the untreated outcome follows: <span class="math display">\[
\mu_{it} = X_{it} \beta + \lambda_i' f_t
\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(X_{it}\)</span> is a vector of observed covariates.</p></li>
<li><p><span class="math inline">\(\beta\)</span> is a vector of unknown coefficients.</p></li>
<li><p><span class="math inline">\(\lambda_i\)</span> represents unit-specific factor loadings.</p></li>
<li><p><span class="math inline">\(f_t\)</span> represents time-specific factors.</p></li>
</ul>
<p>The presence of <span class="math inline">\(\lambda_i' f_t\)</span> allows GSC to control for unobserved confounders that vary across time and units, a key advantage over <a href="sec-difference-in-differences.html#sec-difference-in-differences">DID</a> and traditional <a href="sec-synthetic-control.html#sec-synthetic-control">SCM</a>.</p>
</div>
<div id="identification-and-estimation" class="section level3" number="32.11.3">
<h3>
<span class="header-section-number">32.11.3</span> Identification and Estimation<a class="anchor" aria-label="anchor" href="#identification-and-estimation"><i class="fas fa-link"></i></a>
</h3>
<p>To estimate the <a href="sec-causal-inference.html#sec-average-treatment-effect-on-the-treated">Average Treatment Effect on the Treated</a>, we define: <span class="math display">\[
\text{ATT}_t = \frac{1}{N_T} \sum_{i \in T} \left[ Y_{it}(1) - Y_{it}(0) \right]
\]</span> where <span class="math inline">\(N_T\)</span> is the number of treated units. The challenge is that <span class="math inline">\(Y_{it}(0)\)</span> for treated units is counterfactual and must be estimated.</p>
<p>Step 1: Estimating Factor Loadings and Latent Factors</p>
<p>Using only control units, we estimate the latent factors and factor loadings: <span class="math display">\[
Y_{it} = X_{it} \beta + \lambda_i' f_t + \varepsilon_{it}, \quad i \in C
\]</span> which can be rewritten in matrix form: <span class="math display">\[
Y_C = X_C \beta + \Lambda_C F' + E_C.
\]</span> The key assumption is that factor loadings and latent factors apply to both treated and control units, ensuring valid counterfactual estimation.</p>
<p>Step 2: Imputing Counterfactual Outcomes</p>
<p>For treated units, we estimate: <span class="math display">\[
\hat{\lambda}_i = (F_0'F_0)^{-1} F_0' (Y_{i,0} - X_{i,0} \beta)
\]</span> where <span class="math inline">\(F_0\)</span> and <span class="math inline">\(Y_{i,0}\)</span> denote pre-treatment data. The imputed counterfactuals are then:</p>
<p><span class="math display">\[
\hat{Y}_{it}(0) = X_{it} \beta + \hat{\lambda}_i' \hat{f}_t.
\]</span></p>
</div>
<div id="bootstrap-procedure-for-standard-errors" class="section level3" number="32.11.4">
<h3>
<span class="header-section-number">32.11.4</span> Bootstrap Procedure for Standard Errors<a class="anchor" aria-label="anchor" href="#bootstrap-procedure-for-standard-errors"><i class="fas fa-link"></i></a>
</h3>
<p>A key issue in statistical inference with GSC is the estimation of uncertainty. The standard nonparametric bootstrap is biased due to dependent structures in panel data we adopt the parametric bootstrap from <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-li2023statistical">K. T. Li and Sonnier 2023</a>)</span> to correct for bias.</p>
<p>Corrected Bootstrap Algorithm:</p>
<ol style="list-style-type: decimal">
<li>Estimate the IFE Model using control units.</li>
<li>Resample residuals <span class="math inline">\(\hat{\varepsilon}_{it}\)</span> from the fitted model.</li>
<li>Generate new synthetic datasets using: <span class="math display">\[
Y_{it}^* = X_{it} \hat{\beta} + \hat{\lambda}_i' \hat{f}_t + \varepsilon_{it}^*
\]</span>
</li>
<li>Re-estimate the model on resampled data and compute bootstrap confidence intervals.</li>
</ol>
<p>This approach ensures correct coverage probabilities and avoids bias in standard error estimation.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="sec-synthetic-control.html#cb850-1" tabindex="-1"></a><span class="co"># Load required package</span></span>
<span id="cb850-2"><a href="sec-synthetic-control.html#cb850-2" tabindex="-1"></a><span class="fu">library</span>(gsynth)</span>
<span id="cb850-3"><a href="sec-synthetic-control.html#cb850-3" tabindex="-1"></a></span>
<span id="cb850-4"><a href="sec-synthetic-control.html#cb850-4" tabindex="-1"></a><span class="co"># Example data</span></span>
<span id="cb850-5"><a href="sec-synthetic-control.html#cb850-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"gsynth"</span>)</span>
<span id="cb850-6"><a href="sec-synthetic-control.html#cb850-6" tabindex="-1"></a></span>
<span id="cb850-7"><a href="sec-synthetic-control.html#cb850-7" tabindex="-1"></a><span class="co"># Fit Generalized Synthetic Control Model</span></span>
<span id="cb850-8"><a href="sec-synthetic-control.html#cb850-8" tabindex="-1"></a>gsc_model <span class="ot">&lt;-</span></span>
<span id="cb850-9"><a href="sec-synthetic-control.html#cb850-9" tabindex="-1"></a>    <span class="fu">gsynth</span>(</span>
<span id="cb850-10"><a href="sec-synthetic-control.html#cb850-10" tabindex="-1"></a>        Y <span class="sc">~</span> D <span class="sc">+</span> X1 <span class="sc">+</span> X2,</span>
<span id="cb850-11"><a href="sec-synthetic-control.html#cb850-11" tabindex="-1"></a>        <span class="at">data =</span> simdata,</span>
<span id="cb850-12"><a href="sec-synthetic-control.html#cb850-12" tabindex="-1"></a>        <span class="at">parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb850-13"><a href="sec-synthetic-control.html#cb850-13" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"time"</span>),</span>
<span id="cb850-14"><a href="sec-synthetic-control.html#cb850-14" tabindex="-1"></a>        <span class="at">force =</span> <span class="st">"two-way"</span>,</span>
<span id="cb850-15"><a href="sec-synthetic-control.html#cb850-15" tabindex="-1"></a>        <span class="at">CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb850-16"><a href="sec-synthetic-control.html#cb850-16" tabindex="-1"></a>        <span class="at">r =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb850-17"><a href="sec-synthetic-control.html#cb850-17" tabindex="-1"></a>        <span class="at">se =</span> T</span>
<span id="cb850-18"><a href="sec-synthetic-control.html#cb850-18" tabindex="-1"></a>    )</span>
<span id="cb850-19"><a href="sec-synthetic-control.html#cb850-19" tabindex="-1"></a><span class="co">#&gt; Cross-validating ... </span></span>
<span id="cb850-20"><a href="sec-synthetic-control.html#cb850-20" tabindex="-1"></a><span class="co">#&gt;  r = 0; sigma2 = 1.84865; IC = 1.02023; PC = 1.74458; MSPE = 2.37280</span></span>
<span id="cb850-21"><a href="sec-synthetic-control.html#cb850-21" tabindex="-1"></a><span class="co">#&gt;  r = 1; sigma2 = 1.51541; IC = 1.20588; PC = 1.99818; MSPE = 1.71743</span></span>
<span id="cb850-22"><a href="sec-synthetic-control.html#cb850-22" tabindex="-1"></a><span class="co">#&gt;  r = 2; sigma2 = 0.99737; IC = 1.16130; PC = 1.69046; MSPE = 1.14540*</span></span>
<span id="cb850-23"><a href="sec-synthetic-control.html#cb850-23" tabindex="-1"></a><span class="co">#&gt;  r = 3; sigma2 = 0.94664; IC = 1.47216; PC = 1.96215; MSPE = 1.15032</span></span>
<span id="cb850-24"><a href="sec-synthetic-control.html#cb850-24" tabindex="-1"></a><span class="co">#&gt;  r = 4; sigma2 = 0.89411; IC = 1.76745; PC = 2.19241; MSPE = 1.21397</span></span>
<span id="cb850-25"><a href="sec-synthetic-control.html#cb850-25" tabindex="-1"></a><span class="co">#&gt;  r = 5; sigma2 = 0.85060; IC = 2.05928; PC = 2.40964; MSPE = 1.23876</span></span>
<span id="cb850-26"><a href="sec-synthetic-control.html#cb850-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb850-27"><a href="sec-synthetic-control.html#cb850-27" tabindex="-1"></a><span class="co">#&gt;  r* = 2</span></span>
<span id="cb850-28"><a href="sec-synthetic-control.html#cb850-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb850-29"><a href="sec-synthetic-control.html#cb850-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb850-30"><a href="sec-synthetic-control.html#cb850-30" tabindex="-1"></a>Bootstrapping ...</span>
<span id="cb850-31"><a href="sec-synthetic-control.html#cb850-31" tabindex="-1"></a><span class="co">#&gt; ..</span></span>
<span id="cb850-32"><a href="sec-synthetic-control.html#cb850-32" tabindex="-1"></a></span>
<span id="cb850-33"><a href="sec-synthetic-control.html#cb850-33" tabindex="-1"></a><span class="co"># Summary of results</span></span>
<span id="cb850-34"><a href="sec-synthetic-control.html#cb850-34" tabindex="-1"></a><span class="fu">summary</span>(gsc_model)</span>
<span id="cb850-35"><a href="sec-synthetic-control.html#cb850-35" tabindex="-1"></a><span class="co">#&gt;              Length Class   Mode     </span></span>
<span id="cb850-36"><a href="sec-synthetic-control.html#cb850-36" tabindex="-1"></a><span class="co">#&gt; Y.dat         1500  -none-  numeric  </span></span>
<span id="cb850-37"><a href="sec-synthetic-control.html#cb850-37" tabindex="-1"></a><span class="co">#&gt; Y                1  -none-  character</span></span>
<span id="cb850-38"><a href="sec-synthetic-control.html#cb850-38" tabindex="-1"></a><span class="co">#&gt; D                1  -none-  character</span></span>
<span id="cb850-39"><a href="sec-synthetic-control.html#cb850-39" tabindex="-1"></a><span class="co">#&gt; X                2  -none-  character</span></span>
<span id="cb850-40"><a href="sec-synthetic-control.html#cb850-40" tabindex="-1"></a><span class="co">#&gt; W                0  -none-  NULL     </span></span>
<span id="cb850-41"><a href="sec-synthetic-control.html#cb850-41" tabindex="-1"></a><span class="co">#&gt; index            2  -none-  character</span></span>
<span id="cb850-42"><a href="sec-synthetic-control.html#cb850-42" tabindex="-1"></a><span class="co">#&gt; id              50  -none-  numeric  </span></span>
<span id="cb850-43"><a href="sec-synthetic-control.html#cb850-43" tabindex="-1"></a><span class="co">#&gt; time            30  -none-  numeric  </span></span>
<span id="cb850-44"><a href="sec-synthetic-control.html#cb850-44" tabindex="-1"></a><span class="co">#&gt; obs.missing   1500  -none-  numeric  </span></span>
<span id="cb850-45"><a href="sec-synthetic-control.html#cb850-45" tabindex="-1"></a><span class="co">#&gt; id.tr            5  -none-  numeric  </span></span>
<span id="cb850-46"><a href="sec-synthetic-control.html#cb850-46" tabindex="-1"></a><span class="co">#&gt; id.co           45  -none-  numeric  </span></span>
<span id="cb850-47"><a href="sec-synthetic-control.html#cb850-47" tabindex="-1"></a><span class="co">#&gt; D.tr           150  -none-  numeric  </span></span>
<span id="cb850-48"><a href="sec-synthetic-control.html#cb850-48" tabindex="-1"></a><span class="co">#&gt; I.tr           150  -none-  numeric  </span></span>
<span id="cb850-49"><a href="sec-synthetic-control.html#cb850-49" tabindex="-1"></a><span class="co">#&gt; Y.tr           150  -none-  numeric  </span></span>
<span id="cb850-50"><a href="sec-synthetic-control.html#cb850-50" tabindex="-1"></a><span class="co">#&gt; Y.ct           150  -none-  numeric  </span></span>
<span id="cb850-51"><a href="sec-synthetic-control.html#cb850-51" tabindex="-1"></a><span class="co">#&gt; Y.co          1350  -none-  numeric  </span></span>
<span id="cb850-52"><a href="sec-synthetic-control.html#cb850-52" tabindex="-1"></a><span class="co">#&gt; eff            150  -none-  numeric  </span></span>
<span id="cb850-53"><a href="sec-synthetic-control.html#cb850-53" tabindex="-1"></a><span class="co">#&gt; Y.bar           90  -none-  numeric  </span></span>
<span id="cb850-54"><a href="sec-synthetic-control.html#cb850-54" tabindex="-1"></a><span class="co">#&gt; att             30  -none-  numeric  </span></span>
<span id="cb850-55"><a href="sec-synthetic-control.html#cb850-55" tabindex="-1"></a><span class="co">#&gt; att.avg          1  -none-  numeric  </span></span>
<span id="cb850-56"><a href="sec-synthetic-control.html#cb850-56" tabindex="-1"></a><span class="co">#&gt; force            1  -none-  numeric  </span></span>
<span id="cb850-57"><a href="sec-synthetic-control.html#cb850-57" tabindex="-1"></a><span class="co">#&gt; sameT0           1  -none-  logical  </span></span>
<span id="cb850-58"><a href="sec-synthetic-control.html#cb850-58" tabindex="-1"></a><span class="co">#&gt; T                1  -none-  numeric  </span></span>
<span id="cb850-59"><a href="sec-synthetic-control.html#cb850-59" tabindex="-1"></a><span class="co">#&gt; N                1  -none-  numeric  </span></span>
<span id="cb850-60"><a href="sec-synthetic-control.html#cb850-60" tabindex="-1"></a><span class="co">#&gt; p                1  -none-  numeric  </span></span>
<span id="cb850-61"><a href="sec-synthetic-control.html#cb850-61" tabindex="-1"></a><span class="co">#&gt; Ntr              1  -none-  numeric  </span></span>
<span id="cb850-62"><a href="sec-synthetic-control.html#cb850-62" tabindex="-1"></a><span class="co">#&gt; Nco              1  -none-  numeric  </span></span>
<span id="cb850-63"><a href="sec-synthetic-control.html#cb850-63" tabindex="-1"></a><span class="co">#&gt; T0               5  -none-  numeric  </span></span>
<span id="cb850-64"><a href="sec-synthetic-control.html#cb850-64" tabindex="-1"></a><span class="co">#&gt; tr              50  -none-  logical  </span></span>
<span id="cb850-65"><a href="sec-synthetic-control.html#cb850-65" tabindex="-1"></a><span class="co">#&gt; pre            150  -none-  logical  </span></span>
<span id="cb850-66"><a href="sec-synthetic-control.html#cb850-66" tabindex="-1"></a><span class="co">#&gt; post           150  -none-  logical  </span></span>
<span id="cb850-67"><a href="sec-synthetic-control.html#cb850-67" tabindex="-1"></a><span class="co">#&gt; r.cv             1  -none-  numeric  </span></span>
<span id="cb850-68"><a href="sec-synthetic-control.html#cb850-68" tabindex="-1"></a><span class="co">#&gt; IC               1  -none-  numeric  </span></span>
<span id="cb850-69"><a href="sec-synthetic-control.html#cb850-69" tabindex="-1"></a><span class="co">#&gt; PC               1  -none-  numeric  </span></span>
<span id="cb850-70"><a href="sec-synthetic-control.html#cb850-70" tabindex="-1"></a><span class="co">#&gt; beta             2  -none-  numeric  </span></span>
<span id="cb850-71"><a href="sec-synthetic-control.html#cb850-71" tabindex="-1"></a><span class="co">#&gt; est.co          13  -none-  list     </span></span>
<span id="cb850-72"><a href="sec-synthetic-control.html#cb850-72" tabindex="-1"></a><span class="co">#&gt; mu               1  -none-  numeric  </span></span>
<span id="cb850-73"><a href="sec-synthetic-control.html#cb850-73" tabindex="-1"></a><span class="co">#&gt; validX           1  -none-  numeric  </span></span>
<span id="cb850-74"><a href="sec-synthetic-control.html#cb850-74" tabindex="-1"></a><span class="co">#&gt; sigma2           1  -none-  numeric  </span></span>
<span id="cb850-75"><a href="sec-synthetic-control.html#cb850-75" tabindex="-1"></a><span class="co">#&gt; res.co        1350  -none-  numeric  </span></span>
<span id="cb850-76"><a href="sec-synthetic-control.html#cb850-76" tabindex="-1"></a><span class="co">#&gt; MSPE             1  -none-  numeric  </span></span>
<span id="cb850-77"><a href="sec-synthetic-control.html#cb850-77" tabindex="-1"></a><span class="co">#&gt; CV.out          30  -none-  numeric  </span></span>
<span id="cb850-78"><a href="sec-synthetic-control.html#cb850-78" tabindex="-1"></a><span class="co">#&gt; niter            1  -none-  numeric  </span></span>
<span id="cb850-79"><a href="sec-synthetic-control.html#cb850-79" tabindex="-1"></a><span class="co">#&gt; factor          60  -none-  numeric  </span></span>
<span id="cb850-80"><a href="sec-synthetic-control.html#cb850-80" tabindex="-1"></a><span class="co">#&gt; lambda.co       90  -none-  numeric  </span></span>
<span id="cb850-81"><a href="sec-synthetic-control.html#cb850-81" tabindex="-1"></a><span class="co">#&gt; lambda.tr       10  -none-  numeric  </span></span>
<span id="cb850-82"><a href="sec-synthetic-control.html#cb850-82" tabindex="-1"></a><span class="co">#&gt; wgt.implied    225  -none-  numeric  </span></span>
<span id="cb850-83"><a href="sec-synthetic-control.html#cb850-83" tabindex="-1"></a><span class="co">#&gt; alpha.tr         5  -none-  numeric  </span></span>
<span id="cb850-84"><a href="sec-synthetic-control.html#cb850-84" tabindex="-1"></a><span class="co">#&gt; alpha.co        45  -none-  numeric  </span></span>
<span id="cb850-85"><a href="sec-synthetic-control.html#cb850-85" tabindex="-1"></a><span class="co">#&gt; xi              30  -none-  numeric  </span></span>
<span id="cb850-86"><a href="sec-synthetic-control.html#cb850-86" tabindex="-1"></a><span class="co">#&gt; inference        1  -none-  character</span></span>
<span id="cb850-87"><a href="sec-synthetic-control.html#cb850-87" tabindex="-1"></a><span class="co">#&gt; est.att        180  -none-  numeric  </span></span>
<span id="cb850-88"><a href="sec-synthetic-control.html#cb850-88" tabindex="-1"></a><span class="co">#&gt; est.avg          5  -none-  numeric  </span></span>
<span id="cb850-89"><a href="sec-synthetic-control.html#cb850-89" tabindex="-1"></a><span class="co">#&gt; att.avg.boot   200  -none-  numeric  </span></span>
<span id="cb850-90"><a href="sec-synthetic-control.html#cb850-90" tabindex="-1"></a><span class="co">#&gt; att.boot      6000  -none-  numeric  </span></span>
<span id="cb850-91"><a href="sec-synthetic-control.html#cb850-91" tabindex="-1"></a><span class="co">#&gt; eff.boot     30000  -none-  numeric  </span></span>
<span id="cb850-92"><a href="sec-synthetic-control.html#cb850-92" tabindex="-1"></a><span class="co">#&gt; Dtr.boot     30000  -none-  numeric  </span></span>
<span id="cb850-93"><a href="sec-synthetic-control.html#cb850-93" tabindex="-1"></a><span class="co">#&gt; Itr.boot     30000  -none-  numeric  </span></span>
<span id="cb850-94"><a href="sec-synthetic-control.html#cb850-94" tabindex="-1"></a><span class="co">#&gt; beta.boot      400  -none-  numeric  </span></span>
<span id="cb850-95"><a href="sec-synthetic-control.html#cb850-95" tabindex="-1"></a><span class="co">#&gt; est.beta        10  -none-  numeric  </span></span>
<span id="cb850-96"><a href="sec-synthetic-control.html#cb850-96" tabindex="-1"></a><span class="co">#&gt; call             9  -none-  call     </span></span>
<span id="cb850-97"><a href="sec-synthetic-control.html#cb850-97" tabindex="-1"></a><span class="co">#&gt; formula          3  formula call</span></span>
<span id="cb850-98"><a href="sec-synthetic-control.html#cb850-98" tabindex="-1"></a></span>
<span id="cb850-99"><a href="sec-synthetic-control.html#cb850-99" tabindex="-1"></a><span class="co"># Visualization</span></span>
<span id="cb850-100"><a href="sec-synthetic-control.html#cb850-100" tabindex="-1"></a><span class="fu">plot</span>(gsc_model)</span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></div>
<hr>
</div>
</div>
<div id="bayesian-synthetic-control" class="section level2" number="32.12">
<h2>
<span class="header-section-number">32.12</span> Bayesian Synthetic Control<a class="anchor" aria-label="anchor" href="#bayesian-synthetic-control"><i class="fas fa-link"></i></a>
</h2>
<p>The Bayesian Synthetic Control (BSC) approach introduces a probabilistic alternative to traditional synthetic control methods. Unlike the standard SCM, which estimates a single point estimate of treatment effects using a convex combination of control units, BSC incorporates posterior predictive distributions, allowing for proper uncertainty quantification and probabilistic inference​.</p>
<p>Bayesian methods offer several advantages over frequentist SCM:</p>
<ul>
<li><p>Probabilistic Treatment Effects: Instead of a single deterministic estimate, Bayesian SCM provides a distribution over possible treatment effects.</p></li>
<li><p>Regularization via Priors: Bayesian approaches allow for the incorporation of shrinkage priors to improve estimation stability in high-dimensional settings.</p></li>
<li><p>Flexibility: The Bayesian framework can accommodate dynamic latent factor models, addressing issues like time-varying heterogeneity​.</p></li>
</ul>
<p>Two major Bayesian approaches to SCM:</p>
<ol style="list-style-type: decimal">
<li>Dynamic Multilevel Factor Models <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-pang2022bayesian">Pang, Liu, and Xu 2022</a>)</span>
</li>
<li>Bayesian Sparse Synthetic Control <span class="citation">(<a href="chapter-cluster-randomization-and-interference-bias.html#ref-kim2020bayesian">S. Kim, Lee, and Gupta 2020</a>)</span>
</li>
</ol>
<div id="bayesian-causal-inference-framework" class="section level3" number="32.12.1">
<h3>
<span class="header-section-number">32.12.1</span> Bayesian Causal Inference Framework<a class="anchor" aria-label="anchor" href="#bayesian-causal-inference-framework"><i class="fas fa-link"></i></a>
</h3>
<p>In the traditional SCM, we estimate the counterfactual outcome <span class="math inline">\(Y_{it}(0)\)</span> for treated unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> using a weighted sum of control units:</p>
<p><span class="math display">\[
\hat{Y}_{it}(0) = \sum_{j \neq i} w_j Y_{jt}.
\]</span></p>
<p>However, this deterministic approach does not quantify uncertainty in the estimation. The Bayesian SCM instead models the counterfactual outcome as a posterior predictive distribution:</p>
<p><span class="math display">\[
P(Y_{it}(0) | Y_{\text{obs}}, \theta),
\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> represents the parameters of the model (e.g., factor loadings, regression coefficients, latent variables). The Bayesian approach estimates full posterior distributions, allowing us to compute credible intervals instead of relying solely on point estimates.</p>
</div>
<div id="bayesian-dynamic-multilevel-factor-model" class="section level3" number="32.12.2">
<h3>
<span class="header-section-number">32.12.2</span> Bayesian Dynamic Multilevel Factor Model<a class="anchor" aria-label="anchor" href="#bayesian-dynamic-multilevel-factor-model"><i class="fas fa-link"></i></a>
</h3>
<p>The Dynamic Multilevel Factor Model (DM-LFM), proposed by <span class="citation">Pang, Liu, and Xu (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-pang2022bayesian">2022</a>)</span>, extends SCM by incorporating latent factor models to correct for unit-specific time trends.</p>
<div id="model-specification-4" class="section level4" number="32.12.2.1">
<h4>
<span class="header-section-number">32.12.2.1</span> Model Specification<a class="anchor" aria-label="anchor" href="#model-specification-4"><i class="fas fa-link"></i></a>
</h4>
<p>Let <span class="math inline">\(Y_{it}\)</span> be the observed outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>. The potential untreated outcome follows:</p>
<p><span class="math display">\[
Y_{it}(0) = X_{it} \beta + \lambda_i' f_t + \varepsilon_{it},
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(X_{it}\)</span> are observed covariates,</p></li>
<li><p><span class="math inline">\(\beta\)</span> are regression coefficients,</p></li>
<li><p><span class="math inline">\(\lambda_i\)</span> are unit-specific factor loadings,</p></li>
<li><p><span class="math inline">\(f_t\)</span> are common latent time factors,</p></li>
<li><p><span class="math inline">\(\varepsilon_{it} \sim \mathcal{N}(0, \sigma^2)\)</span> is the noise term.</p></li>
</ul>
<p>The treatment effect is defined as:</p>
<p><span class="math display">\[
\tau_{it} = Y_{it}(1) - Y_{it}(0).
\]</span></p>
<p>Under latent ignorability, we assume:</p>
<p><span class="math display">\[
P(T_i | X_i, U_i) = P(T_i | X_i),
\]</span></p>
<p>where <span class="math inline">\(U_i\)</span> are latent variables extracted from the outcome data​.</p>
</div>
<div id="bayesian-inference-procedure" class="section level4" number="32.12.2.2">
<h4>
<span class="header-section-number">32.12.2.2</span> Bayesian Inference Procedure<a class="anchor" aria-label="anchor" href="#bayesian-inference-procedure"><i class="fas fa-link"></i></a>
</h4>
<p>To estimate treatment effects, we follow these steps:</p>
<ol style="list-style-type: decimal">
<li>Estimate <span class="math inline">\(\lambda_i\)</span> and <span class="math inline">\(f_t\)</span> using control units.</li>
<li>Predict counterfactuals for treated units: <span class="math display">\[
\hat{Y}_{it}(0) = X_{it} \hat{\beta} + \hat{\lambda}_i' \hat{f}_t.
\]</span>
</li>
<li>Obtain the posterior predictive distribution of treatment effects.</li>
</ol>
<p>This Bayesian approach enables proper credible intervals for causal effects.</p>
</div>
</div>
<div id="bayesian-sparse-synthetic-control" class="section level3" number="32.12.3">
<h3>
<span class="header-section-number">32.12.3</span> Bayesian Sparse Synthetic Control<a class="anchor" aria-label="anchor" href="#bayesian-sparse-synthetic-control"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">S. Kim, Lee, and Gupta (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-kim2020bayesian">2020</a>)</span> propose an alternative Bayesian framework that removes restrictive constraints imposed by standard SCM​.</p>
<div id="relaxing-scm-constraints" class="section level4" number="32.12.3.1">
<h4>
<span class="header-section-number">32.12.3.1</span> Relaxing SCM Constraints<a class="anchor" aria-label="anchor" href="#relaxing-scm-constraints"><i class="fas fa-link"></i></a>
</h4>
<p>Traditional SCM imposes:</p>
<ol style="list-style-type: decimal">
<li>Nonnegative weights: <span class="math inline">\(w_j \geq 0\)</span>.</li>
<li>Convex combination: <span class="math inline">\(\sum_j w_j = 1\)</span>.</li>
</ol>
<p>BSCM relaxes these by allowing negative weights and regularization priors. It models the control unit weights using Bayesian shrinkage priors:</p>
<p><span class="math display">\[
w_j \sim \mathcal{N}(0, \tau^2),
\]</span></p>
<p>where <span class="math inline">\(\tau^2\)</span> is a regularization parameter. This allows flexible weight selection while preventing overfitting.</p>
</div>
<div id="bayesian-shrinkage-priors" class="section level4" number="32.12.3.2">
<h4>
<span class="header-section-number">32.12.3.2</span> Bayesian Shrinkage Priors<a class="anchor" aria-label="anchor" href="#bayesian-shrinkage-priors"><i class="fas fa-link"></i></a>
</h4>
<p>BSCM incorporates horseshoe priors and spike-and-slab priors to select relevant control units:</p>
<ul>
<li><p>Horseshoe Prior: <span class="math display">\[
  w_j \sim \mathcal{N}(0, \lambda_j^2), \quad \lambda_j \sim C^+(0,1).
  \]</span></p></li>
<li><p>Spike-and-Slab Prior: <span class="math display">\[
  w_j \sim \gamma_j \mathcal{N}(0, \sigma_1^2) + (1-\gamma_j) \mathcal{N}(0, \sigma_0^2),
  \]</span> where <span class="math inline">\(\gamma_j \sim \text{Bernoulli}(\pi)\)</span> determines whether a control unit is included.</p></li>
</ul>
<p>These priors ensure robust weight selection while controlling for overfitting.</p>
</div>
</div>
<div id="bayesian-inference-and-mcmc-estimation" class="section level3" number="32.12.4">
<h3>
<span class="header-section-number">32.12.4</span> Bayesian Inference and MCMC Estimation<a class="anchor" aria-label="anchor" href="#bayesian-inference-and-mcmc-estimation"><i class="fas fa-link"></i></a>
</h3>
<p>Both DM-LFM and BSCM are estimated using Markov Chain Monte Carlo (MCMC). Given observed data <span class="math inline">\(Y_{\text{obs}}\)</span>, we sample from the posterior:</p>
<p><span class="math display">\[
P(\theta | Y_{\text{obs}}) \propto P(Y_{\text{obs}} | \theta) P(\theta),
\]</span></p>
<p>where <span class="math inline">\(P(\theta)\)</span> encodes prior beliefs about the parameters.</p>
<p>Common MCMC techniques used:</p>
<ul>
<li><p>Gibbs Sampling for latent factors and regression coefficients.</p></li>
<li><p>Hamiltonian Monte Carlo (HMC) for high-dimensional posteriors.</p></li>
</ul>
<div class="sourceCode" id="cb851"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstan/">rstan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/">bayesplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Bayesian SCM model in Stan</span></span>
<span><span class="va">scm_model</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=0&gt; N;  // Number of observations</span></span>
<span><span class="st">  int&lt;lower=0&gt; T;  // Time periods</span></span>
<span><span class="st">  matrix[N, T] Y;  // Outcome matrix</span></span>
<span><span class="st">}</span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  vector[T] f;  // Latent factors</span></span>
<span><span class="st">  vector[N] lambda; // Factor loadings</span></span>
<span><span class="st">  real&lt;lower=0&gt; sigma; // Noise variance</span></span>
<span><span class="st">}</span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  // Priors</span></span>
<span><span class="st">  f ~ normal(0, 1);</span></span>
<span><span class="st">  lambda ~ normal(0, 1);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Likelihood</span></span>
<span><span class="st">  for (i in 1:N)</span></span>
<span><span class="st">    Y[i, ] ~ normal(lambda[i] * f, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># Compile and fit the model</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/rstan/reference/stan.html">stan</a></span><span class="op">(</span>model_code <span class="op">=</span> <span class="va">scm_model</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    T <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, <span class="fl">50</span>, <span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize results</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="using-multiple-outcomes-to-improve-the-synthetic-control-method" class="section level2" number="32.13">
<h2>
<span class="header-section-number">32.13</span> Using Multiple Outcomes to Improve the Synthetic Control Method<a class="anchor" aria-label="anchor" href="#using-multiple-outcomes-to-improve-the-synthetic-control-method"><i class="fas fa-link"></i></a>
</h2>
<p>Typically, SCM constructs a weighted combination of untreated control units to approximate the counterfactual outcome of the treated unit. However, standard SCM is limited to a single outcome variable, which can lead to biased estimates when multiple correlated outcomes are available.</p>
<p>In their work, <span class="citation">L. Sun, Ben-Michael, and Feller (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-sun2023using">2023</a>)</span> propose a novel extension of SCM that leverages multiple outcome variables to improve causal inference by:</p>
<ol style="list-style-type: decimal">
<li>Using a common set of synthetic control weights across all outcomes rather than estimating separate weights for each outcome.</li>
<li>Reducing bias using a low-rank factor model, which exploits shared latent structures across outcomes.</li>
</ol>
<div id="standard-synthetic-control-method" class="section level3" number="32.13.1">
<h3>
<span class="header-section-number">32.13.1</span> Standard Synthetic Control Method<a class="anchor" aria-label="anchor" href="#standard-synthetic-control-method"><i class="fas fa-link"></i></a>
</h3>
<p>Let <span class="math inline">\(Y_{itk}\)</span> denote the observed outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> for outcome <span class="math inline">\(k\)</span>, where <span class="math inline">\(i = 1, \dots, N\)</span>, <span class="math inline">\(t = 1, \dots, T\)</span>, and <span class="math inline">\(k = 1, \dots, K\)</span>. The potential outcomes framework assumes:</p>
<p><span class="math display">\[
Y_{itk}(d) = \mu_{itk} + \delta_{itk} d + \varepsilon_{itk}, \quad d \in \{0,1\}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\mu_{itk}\)</span> represents the latent structure of untreated outcomes.</p></li>
<li><p><span class="math inline">\(\delta_{itk}\)</span> is the treatment effect.</p></li>
<li><p><span class="math inline">\(\varepsilon_{itk} \sim \mathcal{N}(0, \sigma^2)\)</span> is random noise.</p></li>
</ul>
<p>For unit <span class="math inline">\(i=1\)</span> (the treated unit), the observed outcome follows:</p>
<p><span class="math display">\[
Y_{1tk} = Y_{1tk}(0) + D_{1t} \delta_{1tk}
\]</span></p>
<p>where <span class="math inline">\(D_{1t}\)</span> is an indicator for treatment at time <span class="math inline">\(t\)</span>. The challenge is to estimate the counterfactual outcome <span class="math inline">\(Y_{1tk}(0)\)</span>, which is unobserved post-treatment.</p>
<p>SCM estimates <span class="math inline">\(Y_{1tk}(0)\)</span> as a weighted combination of control units:</p>
<p><span class="math display">\[
\hat{Y}_{1tk}(0) = \sum_{i=2}^{N} w_i Y_{itk}
\]</span></p>
<p>where weights <span class="math inline">\(w_i\)</span> are chosen to minimize pre-treatment imbalance.</p>
</div>
<div id="using-multiple-outcomes-for-bias-reduction" class="section level3" number="32.13.2">
<h3>
<span class="header-section-number">32.13.2</span> Using Multiple Outcomes for Bias Reduction<a class="anchor" aria-label="anchor" href="#using-multiple-outcomes-for-bias-reduction"><i class="fas fa-link"></i></a>
</h3>
<p>Instead of estimating separate weights <span class="math inline">\(w_k\)</span> for each outcome <span class="math inline">\(k\)</span>, <span class="citation">L. Sun, Ben-Michael, and Feller (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-sun2023using">2023</a>)</span> propose a single set of weights <span class="math inline">\(w\)</span> across all outcomes. This approach is justified under a low-rank factor model, which assumes that multiple outcomes share common latent factors.</p>
<div id="low-rank-factor-model" class="section level4" number="32.13.2.1">
<h4>
<span class="header-section-number">32.13.2.1</span> Low-Rank Factor Model<a class="anchor" aria-label="anchor" href="#low-rank-factor-model"><i class="fas fa-link"></i></a>
</h4>
<p>Assume the untreated potential outcome follows a linear factor structure:</p>
<p><span class="math display">\[
Y_{itk}(0) = X_{it} \beta_k + \lambda_i' f_{tk} + \varepsilon_{itk}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(X_{it}\)</span> are observed covariates.</p></li>
<li><p><span class="math inline">\(\beta_k\)</span> are outcome-specific coefficients.</p></li>
<li><p><span class="math inline">\(\lambda_i\)</span> are unit-specific factor loadings.</p></li>
<li><p><span class="math inline">\(f_{tk}\)</span> are time-and-outcome-specific latent factors.</p></li>
</ul>
<p>If all outcomes share the same latent factor structure, then the bias in synthetic control estimation can be reduced by a factor of <span class="math inline">\(1 / \sqrt{K}\)</span> as the number of outcomes <span class="math inline">\(K\)</span> increases.</p>
</div>
</div>
<div id="estimation-methods-1" class="section level3" number="32.13.3">
<h3>
<span class="header-section-number">32.13.3</span> Estimation Methods<a class="anchor" aria-label="anchor" href="#estimation-methods-1"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">L. Sun, Ben-Michael, and Feller (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-sun2023using">2023</a>)</span> propose two methods for constructing a common synthetic control:</p>
<ol style="list-style-type: decimal">
<li>
<p>Concatenated Outcome Weights: Estimate weights by minimizing imbalance across all outcomes simultaneously:</p>
<p><span class="math display">\[
\hat{w} = \arg\min_w \sum_{k=1}^{K} || Y_{1,\text{pre},k} - \sum_{i=2}^{N} w_i Y_{i,\text{pre},k} ||^2
\]</span></p>
</li>
<li>
<p>Averaged Outcome Weights: Estimate weights based on a linear combination (e.g., average) of outcomes:</p>
<p><span class="math display">\[
\hat{w} = \arg\min_w || \frac{1}{K} \sum_{k=1}^{K} Y_{1,\text{pre},k} - \sum_{i=2}^{N} w_i \frac{1}{K} \sum_{k=1}^{K} Y_{i,\text{pre},k} ||^2
\]</span></p>
</li>
</ol>
<p>These methods improve SCM performance by reducing variance and overfitting to noise.</p>
</div>
<div id="empirical-application-flint-water-crisis" class="section level3" number="32.13.4">
<h3>
<span class="header-section-number">32.13.4</span> Empirical Application: Flint Water Crisis<a class="anchor" aria-label="anchor" href="#empirical-application-flint-water-crisis"><i class="fas fa-link"></i></a>
</h3>
<p>To illustrate the benefits of multiple outcome SCM, <span class="citation">L. Sun, Ben-Michael, and Feller (<a href="chapter-cluster-randomization-and-interference-bias.html#ref-sun2023using">2023</a>)</span> re-analyze the Flint water crisis, which led to lead contamination in drinking water, potentially affecting student performance.</p>
<p>Four key educational outcomes were studied:</p>
<ol style="list-style-type: decimal">
<li>Math Achievement</li>
<li>Reading Achievement</li>
<li>Special Needs Status</li>
<li>Daily Attendance</li>
</ol>
<p>By applying common weights across these outcomes, their SCM results showed:</p>
<ul>
<li><p>Reduced bias and improved robustness compared to separate SCM fits.</p></li>
<li><p>Better pre-treatment fit for educational outcomes.</p></li>
<li><p>Stronger evidence of educational impacts following the crisis.</p></li>
</ul>
<div class="sourceCode" id="cb852"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">augsynth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit SCM using a common set of weights across multiple outcomes</span></span>
<span><span class="va">synth_model</span> <span class="op">&lt;-</span> <span class="fu">augsynth_multiout</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div id="applications" class="section level2" number="32.14">
<h2>
<span class="header-section-number">32.14</span> Applications<a class="anchor" aria-label="anchor" href="#applications"><i class="fas fa-link"></i></a>
</h2>
<div id="synthetic-control-estimation" class="section level3" number="32.14.1">
<h3>
<span class="header-section-number">32.14.1</span> Synthetic Control Estimation<a class="anchor" aria-label="anchor" href="#synthetic-control-estimation"><i class="fas fa-link"></i></a>
</h3>
<p>This example simulates data for 10 states over 30 years, where State A receives treatment after year 15. We implement two approaches:</p>
<ol style="list-style-type: decimal">
<li>Standard Synthetic Control using <code>Synth</code>.</li>
<li>
<a href="sec-synthetic-control.html#generalized-synthetic-control">Generalized Synthetic Control</a> using <code>gsynth</code>, which incorporates iterative fixed effects and multiple treated units.</li>
</ol>
<p>Load Required Libraries</p>
<div class="sourceCode" id="cb853"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("Synth")</span></span>
<span><span class="co"># install.packages("gsynth")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://web.stanford.edu/~jhain/">"Synth"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://yiqingxu.org/packages/gsynth/gsynth_examples.html">"gsynth"</a></span><span class="op">)</span></span></code></pre></div>
<p>We construct a panel dataset where the outcome variable <span class="math inline">\(Y\)</span> is influenced by two covariates (<span class="math inline">\(X_1, X_2\)</span>). Treatment (<span class="math inline">\(T\)</span>) is applied to State A from year 15 onwards, with an artificial treatment effect of +20.</p>
<div class="sourceCode" id="cb854"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate panel data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  year      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,          <span class="co"># 30 years for 10 states</span></span>
<span>  state     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,  <span class="co"># States A to J</span></span>
<span>  X1        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,     <span class="co"># Continuous covariate</span></span>
<span>  X2        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,  <span class="co"># Binary + noise</span></span>
<span>  state.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>    <span class="co"># Numeric identifier for states</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Outcome variable: Y = 1 + 2 * X1 + noise</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">X1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign treatment: Only State A (state == "A") from year 15 onward</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">state</span> <span class="op">==</span> <span class="st">"A"</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply treatment effect: Increase Y by 20 where treatment is applied</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="cn">T</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="cn">T</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># View data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    300 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;  $ year     : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ state    : chr  "A" "A" "A" "A" ...</span></span>
<span><span class="co">#&gt;  $ X1       : num  1.37 2.18 1.16 3.6 2.33 1.18 2.49 2.74 2.58 1.69 ...</span></span>
<span><span class="co">#&gt;  $ X2       : num  1.96 0.4 -0.75 -0.56 -0.45 1.06 0.51 -2.1 0 0.54 ...</span></span>
<span><span class="co">#&gt;  $ state.num: int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Y        : num  2.29 4.51 2.07 8.87 4.37 1.32 8 7.49 6.98 3.72 ...</span></span>
<span><span class="co">#&gt;  $ T        : int  0 0 0 0 0 0 0 0 0 0 ...</span></span></code></pre></div>
<p>Step 1: Estimating Synthetic Control with <code>Synth</code></p>
<p>The <code>Synth</code> package creates a synthetic control by matching pre-treatment trends of the treated unit (<code>State A</code>) with a weighted combination of donor states.</p>
<p>We specify predictors, dependent variable, and donor pool.</p>
<div class="sourceCode" id="cb855"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataprep.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">dataprep</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span><span class="op">)</span>,</span>
<span>  dependent <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  unit.variable <span class="op">=</span> <span class="st">"state.num"</span>,</span>
<span>  time.variable <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  unit.names.variable <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>  treatment.identifier <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  controls.identifier <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  time.predictors.prior <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">14</span>,</span>
<span>  time.optimize.ssr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">14</span>,</span>
<span>  time.plot <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Fit Synthetic Control Model</p>
<div class="sourceCode" id="cb856"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.html">synth</a></span><span class="op">(</span><span class="va">dataprep.out</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt;  searching for synthetic control unit  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MSPE (LOSS V): 9.831789 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; solution.v:</span></span>
<span><span class="co">#&gt;  0.3888387 0.6111613 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; solution.w:</span></span>
<span><span class="co">#&gt;  0.1115941 0.1832781 0.1027237 0.312091 0.06096758 0.03509706 0.05893735 0.05746256 0.07784853</span></span>
<span></span>
<span><span class="co"># Display synthetic control weights and balance table</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab</a></span><span class="op">(</span>dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>, synth.res <span class="op">=</span> <span class="va">synth.out</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $tab.pred</span></span>
<span><span class="co">#&gt;    Treated Synthetic Sample Mean</span></span>
<span><span class="co">#&gt; X1   2.028     2.028       2.017</span></span>
<span><span class="co">#&gt; X2   0.513     0.513       0.394</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tab.v</span></span>
<span><span class="co">#&gt;    v.weights</span></span>
<span><span class="co">#&gt; X1 0.389    </span></span>
<span><span class="co">#&gt; X2 0.611    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tab.w</span></span>
<span><span class="co">#&gt;    w.weights unit.names unit.numbers</span></span>
<span><span class="co">#&gt; 2      0.112          B            2</span></span>
<span><span class="co">#&gt; 3      0.183          C            3</span></span>
<span><span class="co">#&gt; 4      0.103          D            4</span></span>
<span><span class="co">#&gt; 5      0.312          E            5</span></span>
<span><span class="co">#&gt; 6      0.061          F            6</span></span>
<span><span class="co">#&gt; 7      0.035          G            7</span></span>
<span><span class="co">#&gt; 8      0.059          H            8</span></span>
<span><span class="co">#&gt; 9      0.057          I            9</span></span>
<span><span class="co">#&gt; 10     0.078          J           10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tab.loss</span></span>
<span><span class="co">#&gt;            Loss W   Loss V</span></span>
<span><span class="co">#&gt; [1,] 9.761708e-12 9.831789</span></span></code></pre></div>
<p>Plot: Observed vs. Synthetic State A</p>
<div class="sourceCode" id="cb857"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/path.plot.html">path.plot</a></span><span class="op">(</span></span>
<span>  <span class="va">synth.out</span>,</span>
<span>  <span class="va">dataprep.out</span>,</span>
<span>  Ylab <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  Xlab <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>  Legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"State A"</span>, <span class="st">"Synthetic State A"</span><span class="op">)</span>,</span>
<span>  Legend.position <span class="op">=</span> <span class="st">"topleft"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mark the treatment start year</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">15</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Plot: Treatment Effect (Gaps Plot)</p>
<p>The gaps plot shows the difference between <code>State A</code> and its synthetic control over time.</p>
<div class="sourceCode" id="cb858"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/gaps.plot.html">gaps.plot</a></span><span class="op">(</span>synth.res    <span class="op">=</span> <span class="va">synth.out</span>,</span>
<span>          dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>,</span>
<span>          Ylab         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gap"</span><span class="op">)</span>,</span>
<span>          Xlab         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span>,</span>
<span>          Ylim         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>          Main         <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v   <span class="op">=</span> <span class="fl">15</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Step 2: Estimating Generalized Synthetic Control with <code>gsynth</code></p>
<p>Unlike <code>Synth</code>, the <code>gsynth</code> package supports:</p>
<ul>
<li><p>Iterative Fixed Effects (IFE) for unobserved heterogeneity.</p></li>
<li><p>Multiple Treated Units and Staggered Adoption.</p></li>
<li><p>Bootstrapped Standard Errors for inference.</p></li>
</ul>
<p>Fit Generalized Synthetic Control Model</p>
<p>We use two-way fixed effects, cross-validation (<code>CV = TRUE</code>), and bootstrapped standard errors.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="sec-synthetic-control.html#cb859-1" tabindex="-1"></a>gsynth.out <span class="ot">&lt;-</span> <span class="fu">gsynth</span>(</span>
<span id="cb859-2"><a href="sec-synthetic-control.html#cb859-2" tabindex="-1"></a>  Y <span class="sc">~</span> T <span class="sc">+</span> X1 <span class="sc">+</span> X2,</span>
<span id="cb859-3"><a href="sec-synthetic-control.html#cb859-3" tabindex="-1"></a>  <span class="at">data =</span> df,</span>
<span id="cb859-4"><a href="sec-synthetic-control.html#cb859-4" tabindex="-1"></a>  <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"state"</span>, <span class="st">"year"</span>),</span>
<span id="cb859-5"><a href="sec-synthetic-control.html#cb859-5" tabindex="-1"></a>  <span class="at">force =</span> <span class="st">"two-way"</span>,</span>
<span id="cb859-6"><a href="sec-synthetic-control.html#cb859-6" tabindex="-1"></a>  <span class="at">CV =</span> <span class="cn">TRUE</span>,</span>
<span id="cb859-7"><a href="sec-synthetic-control.html#cb859-7" tabindex="-1"></a>  <span class="at">r =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb859-8"><a href="sec-synthetic-control.html#cb859-8" tabindex="-1"></a>  <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb859-9"><a href="sec-synthetic-control.html#cb859-9" tabindex="-1"></a>  <span class="at">inference =</span> <span class="st">"parametric"</span>,</span>
<span id="cb859-10"><a href="sec-synthetic-control.html#cb859-10" tabindex="-1"></a>  <span class="at">nboots =</span> <span class="dv">100</span></span>
<span id="cb859-11"><a href="sec-synthetic-control.html#cb859-11" tabindex="-1"></a>)</span>
<span id="cb859-12"><a href="sec-synthetic-control.html#cb859-12" tabindex="-1"></a><span class="co">#&gt; Parallel computing ...</span></span>
<span id="cb859-13"><a href="sec-synthetic-control.html#cb859-13" tabindex="-1"></a><span class="co">#&gt; Cross-validating ... </span></span>
<span id="cb859-14"><a href="sec-synthetic-control.html#cb859-14" tabindex="-1"></a><span class="co">#&gt;  r = 0; sigma2 = 1.13533; IC = 0.95632; PC = 0.96713; MSPE = 1.65502</span></span>
<span id="cb859-15"><a href="sec-synthetic-control.html#cb859-15" tabindex="-1"></a><span class="co">#&gt;  r = 1; sigma2 = 0.96885; IC = 1.54420; PC = 4.30644; MSPE = 1.33375</span></span>
<span id="cb859-16"><a href="sec-synthetic-control.html#cb859-16" tabindex="-1"></a><span class="co">#&gt;  r = 2; sigma2 = 0.81855; IC = 2.08062; PC = 6.58556; MSPE = 1.27341*</span></span>
<span id="cb859-17"><a href="sec-synthetic-control.html#cb859-17" tabindex="-1"></a><span class="co">#&gt;  r = 3; sigma2 = 0.71670; IC = 2.61125; PC = 8.35187; MSPE = 1.79319</span></span>
<span id="cb859-18"><a href="sec-synthetic-control.html#cb859-18" tabindex="-1"></a><span class="co">#&gt;  r = 4; sigma2 = 0.62823; IC = 3.10156; PC = 9.59221; MSPE = 2.02301</span></span>
<span id="cb859-19"><a href="sec-synthetic-control.html#cb859-19" tabindex="-1"></a><span class="co">#&gt;  r = 5; sigma2 = 0.55497; IC = 3.55814; PC = 10.48406; MSPE = 2.79596</span></span>
<span id="cb859-20"><a href="sec-synthetic-control.html#cb859-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb859-21"><a href="sec-synthetic-control.html#cb859-21" tabindex="-1"></a><span class="co">#&gt;  r* = 2</span></span>
<span id="cb859-22"><a href="sec-synthetic-control.html#cb859-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb859-23"><a href="sec-synthetic-control.html#cb859-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb859-24"><a href="sec-synthetic-control.html#cb859-24" tabindex="-1"></a>Simulating errors ...</span>
<span id="cb859-25"><a href="sec-synthetic-control.html#cb859-25" tabindex="-1"></a>Bootstrapping ...</span>
<span id="cb859-26"><a href="sec-synthetic-control.html#cb859-26" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<div class="sourceCode" id="cb860"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Estimated Treatment Effects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">gsynth.out</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb861"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Plot Counterfactual Trends</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">gsynth.out</span>, type <span class="op">=</span> <span class="st">"counterfactual"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-12-2.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb862"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Show Estimations for Control Cases</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">gsynth.out</span>, type <span class="op">=</span> <span class="st">"counterfactual"</span>, raw <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-12-3.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="the-basque-country-policy-change" class="section level3" number="32.14.2">
<h3>
<span class="header-section-number">32.14.2</span> The Basque Country Policy Change<a class="anchor" aria-label="anchor" href="#the-basque-country-policy-change"><i class="fas fa-link"></i></a>
</h3>
<p>The Basque Country in Spain implemented a major policy change in 1975, impacting its GDP per capita growth. This example uses SCM to estimate the counterfactual economic performance had the policy not been implemented.</p>
<p>We will:</p>
<ol style="list-style-type: decimal">
<li>Construct a synthetic control using economic predictors. 2</li>
<li>Evaluate the policy’s impact by comparing the real and synthetic Basque GDP.</li>
</ol>
<div class="sourceCode" id="cb863"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://web.stanford.edu/~jhain/">Synth</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>basque</code> dataset from <code>Synth</code> contains economic indicators for Spain’s regions from 1955 to 1997.</p>
<div class="sourceCode" id="cb864"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"basque"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">basque</span><span class="op">)</span>  <span class="co"># 774 observations, 17 variables</span></span>
<span><span class="co">#&gt; [1] 774  17</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">basque</span><span class="op">)</span></span>
<span><span class="co">#&gt;   regionno     regionname year   gdpcap sec.agriculture sec.energy sec.industry</span></span>
<span><span class="co">#&gt; 1        1 Spain (Espana) 1955 2.354542              NA         NA           NA</span></span>
<span><span class="co">#&gt; 2        1 Spain (Espana) 1956 2.480149              NA         NA           NA</span></span>
<span><span class="co">#&gt; 3        1 Spain (Espana) 1957 2.603613              NA         NA           NA</span></span>
<span><span class="co">#&gt; 4        1 Spain (Espana) 1958 2.637104              NA         NA           NA</span></span>
<span><span class="co">#&gt; 5        1 Spain (Espana) 1959 2.669880              NA         NA           NA</span></span>
<span><span class="co">#&gt; 6        1 Spain (Espana) 1960 2.869966              NA         NA           NA</span></span>
<span><span class="co">#&gt;   sec.construction sec.services.venta sec.services.nonventa school.illit</span></span>
<span><span class="co">#&gt; 1               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt; 2               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt; 3               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt; 4               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt; 5               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt; 6               NA                 NA                    NA           NA</span></span>
<span><span class="co">#&gt;   school.prim school.med school.high school.post.high popdens invest</span></span>
<span><span class="co">#&gt; 1          NA         NA          NA               NA      NA     NA</span></span>
<span><span class="co">#&gt; 2          NA         NA          NA               NA      NA     NA</span></span>
<span><span class="co">#&gt; 3          NA         NA          NA               NA      NA     NA</span></span>
<span><span class="co">#&gt; 4          NA         NA          NA               NA      NA     NA</span></span>
<span><span class="co">#&gt; 5          NA         NA          NA               NA      NA     NA</span></span>
<span><span class="co">#&gt; 6          NA         NA          NA               NA      NA     NA</span></span></code></pre></div>
<p>Step 1: Preparing Data for <code>Synth</code></p>
<p>We define predictors and specify pre-treatment (1960–1969) and post-treatment (1975–1997) periods.</p>
<div class="sourceCode" id="cb865"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataprep.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html">dataprep</a></span><span class="op">(</span></span>
<span>    foo <span class="op">=</span> <span class="va">basque</span>,</span>
<span>    predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"school.illit"</span>,</span>
<span>        <span class="st">"school.prim"</span>,</span>
<span>        <span class="st">"school.med"</span>,</span>
<span>        <span class="st">"school.high"</span>,</span>
<span>        <span class="st">"school.post.high"</span>,</span>
<span>        <span class="st">"invest"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    predictors.op <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>    time.predictors.prior <span class="op">=</span> <span class="fl">1964</span><span class="op">:</span><span class="fl">1969</span>,</span>
<span>    <span class="co"># Pre-treatment period</span></span>
<span>    special.predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"gdpcap"</span>, <span class="fl">1960</span><span class="op">:</span><span class="fl">1969</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.agriculture"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.energy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.industry"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.construction"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.services.venta"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"sec.services.nonventa"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1961</span>, <span class="fl">1969</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/gsubfn/man/list.html">list</a></span><span class="op">(</span><span class="st">"popdens"</span>, <span class="fl">1969</span>, <span class="st">"mean"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    dependent <span class="op">=</span> <span class="st">"gdpcap"</span>,</span>
<span>    unit.variable <span class="op">=</span> <span class="st">"regionno"</span>,</span>
<span>    unit.names.variable <span class="op">=</span> <span class="st">"regionname"</span>,</span>
<span>    time.variable <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    treatment.identifier <span class="op">=</span> <span class="fl">17</span>,</span>
<span>    <span class="co"># Basque region</span></span>
<span>    controls.identifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">16</span>, <span class="fl">18</span><span class="op">)</span>,</span>
<span>    <span class="co"># Control regions</span></span>
<span>    time.optimize.ssr <span class="op">=</span> <span class="fl">1960</span><span class="op">:</span><span class="fl">1969</span>,</span>
<span>    time.plot <span class="op">=</span> <span class="fl">1955</span><span class="op">:</span><span class="fl">1997</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Step 2: Estimating the Synthetic Control</p>
<p>We now estimate the synthetic control weights using <code><a href="https://rdrr.io/pkg/Synth/man/synth.html">synth()</a></code>. This solves for weights that best match the pre-treatment economic indicators of the Basque Country.</p>
<div class="sourceCode" id="cb866"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.out</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.html">synth</a></span><span class="op">(</span>data.prep.obj <span class="op">=</span> <span class="va">dataprep.out</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt;  searching for synthetic control unit  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; **************** </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MSPE (LOSS V): 0.008864606 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; solution.v:</span></span>
<span><span class="co">#&gt;  0.02773094 1.194e-07 1.60609e-05 0.0007163836 1.486e-07 0.002423908 0.0587055 0.2651997 0.02851006 0.291276 0.007994382 0.004053188 0.009398579 0.303975 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; solution.w:</span></span>
<span><span class="co">#&gt;  2.53e-08 4.63e-08 6.44e-08 2.81e-08 3.37e-08 4.844e-07 4.2e-08 4.69e-08 0.8508145 9.75e-08 3.2e-08 5.54e-08 0.1491843 4.86e-08 9.89e-08 1.162e-07</span></span></code></pre></div>
<p>Step 3: Evaluating Treatment Effects</p>
<p>Calculate the GDP Gap Between Real and Synthetic Basque Country</p>
<div class="sourceCode" id="cb867"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gaps</span> <span class="op">=</span> <span class="va">dataprep.out</span><span class="op">$</span><span class="va">Y1plot</span> <span class="op">-</span> <span class="op">(</span><span class="va">dataprep.out</span><span class="op">$</span><span class="va">Y0plot</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">synth.out</span><span class="op">$</span><span class="va">solution.w</span><span class="op">)</span></span>
<span><span class="va">gaps</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>  <span class="co"># First three differences</span></span>
<span><span class="co">#&gt;       1955       1956       1957 </span></span>
<span><span class="co">#&gt; 0.15023473 0.09168035 0.03716475</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab()</a></code> function provides pre-treatment fit diagnostics and predictor weights.</p>
<div class="sourceCode" id="cb868"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.tab.html">synth.tab</a></span><span class="op">(</span>dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>, synth.res <span class="op">=</span> <span class="va">synth.out</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">synth.tables</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tab.pred" "tab.v"    "tab.w"    "tab.loss"</span></span>
<span></span>
<span><span class="co"># Predictor Balance Table</span></span>
<span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.pred</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">13</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;                                          Treated Synthetic Sample Mean</span></span>
<span><span class="co">#&gt; school.illit                              39.888   256.337     170.786</span></span>
<span><span class="co">#&gt; school.prim                             1031.742  2730.104    1127.186</span></span>
<span><span class="co">#&gt; school.med                                90.359   223.340      76.260</span></span>
<span><span class="co">#&gt; school.high                               25.728    63.437      24.235</span></span>
<span><span class="co">#&gt; school.post.high                          13.480    36.153      13.478</span></span>
<span><span class="co">#&gt; invest                                    24.647    21.583      21.424</span></span>
<span><span class="co">#&gt; special.gdpcap.1960.1969                   5.285     5.271       3.581</span></span>
<span><span class="co">#&gt; special.sec.agriculture.1961.1969          6.844     6.179      21.353</span></span>
<span><span class="co">#&gt; special.sec.energy.1961.1969               4.106     2.760       5.310</span></span>
<span><span class="co">#&gt; special.sec.industry.1961.1969            45.082    37.636      22.425</span></span>
<span><span class="co">#&gt; special.sec.construction.1961.1969         6.150     6.952       7.276</span></span>
<span><span class="co">#&gt; special.sec.services.venta.1961.1969      33.754    41.104      36.528</span></span>
<span><span class="co">#&gt; special.sec.services.nonventa.1961.1969    4.072     5.371       7.111</span></span></code></pre></div>
<p>Importance of Each Control Region in the Synthetic Basque Country</p>
<div class="sourceCode" id="cb869"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synth.tables</span><span class="op">$</span><span class="va">tab.w</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">14</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;    w.weights            unit.names unit.numbers</span></span>
<span><span class="co">#&gt; 9      0.000    Castilla-La Mancha            9</span></span>
<span><span class="co">#&gt; 10     0.851              Cataluna           10</span></span>
<span><span class="co">#&gt; 11     0.000  Comunidad Valenciana           11</span></span>
<span><span class="co">#&gt; 12     0.000           Extremadura           12</span></span>
<span><span class="co">#&gt; 13     0.000               Galicia           13</span></span>
<span><span class="co">#&gt; 14     0.149 Madrid (Comunidad De)           14</span></span>
<span><span class="co">#&gt; 15     0.000    Murcia (Region de)           15</span></span></code></pre></div>
<p>Step 4: Visualizing Results</p>
<p>Plot Real vs. Synthetic GDP Per Capita</p>
<div class="sourceCode" id="cb870"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/path.plot.html">path.plot</a></span><span class="op">(</span></span>
<span>    synth.res <span class="op">=</span> <span class="va">synth.out</span>,</span>
<span>    dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>,</span>
<span>    Ylab <span class="op">=</span> <span class="st">"Real Per-Capita GDP (1986 USD, thousand)"</span>,</span>
<span>    Xlab <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    Ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>    Legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Basque Country"</span>, <span class="st">"Synthetic Basque Country"</span><span class="op">)</span>,</span>
<span>    Legend.position <span class="op">=</span> <span class="st">"bottomright"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-20-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Plot the Treatment Effect (GDP Gap)</p>
<div class="sourceCode" id="cb871"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/gaps.plot.html">gaps.plot</a></span><span class="op">(</span></span>
<span>    synth.res <span class="op">=</span> <span class="va">synth.out</span>,</span>
<span>    dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>,</span>
<span>    Ylab <span class="op">=</span> <span class="st">"Gap in Real Per-Capita GDP (1986 USD, thousand)"</span>,</span>
<span>    Xlab <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    Ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>    Main <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="32-synthetic-control_files/figure-html/unnamed-chunk-21-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>The gap plot shows the difference between actual Basque GDP and its synthetic control over time. A large post-treatment deviation suggests a policy impact.</p>
</div>
<div id="micro-synthetic-control-with-microsynth" class="section level3" number="32.14.3">
<h3>
<span class="header-section-number">32.14.3</span> Micro-Synthetic Control with <code>microsynth</code><a class="anchor" aria-label="anchor" href="#micro-synthetic-control-with-microsynth"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>microsynth</code> package extends standard SCM by allowing: 1</p>
<ol style="list-style-type: decimal">
<li>Matching on both predictors and time-variant outcomes. 2</li>
<li>Permutation tests and jackknife resampling for placebo tests.</li>
<li>Multiple follow-up periods to track long-term treatment effects.</li>
<li>Omnibus test statistics for multiple outcome variables.</li>
</ol>
<p>This example evaluates the Seattle Drug Market Initiative, a policing intervention aimed at reducing drug-related crime. The dataset <code>seattledmi</code> contains crime statistics across different city zones.</p>
<hr>
<p>Step 1: Load the Required Package and Data</p>
<div class="sourceCode" id="cb872"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">microsynth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"seattledmi"</span><span class="op">)</span></span></code></pre></div>
<p>Step 2: Define Predictors and Outcome Variables</p>
<p>We specify:</p>
<ul>
<li><p>Predictors (time-invariant): Population, race distribution, household data.</p></li>
<li><p>Outcomes (time-variant): Crime rates across different offense categories.</p></li>
</ul>
<div class="sourceCode" id="cb873"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cov.var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"TotalPop"</span>,</span>
<span>    <span class="st">"BLACK"</span>,</span>
<span>    <span class="st">"HISPANIC"</span>,</span>
<span>    <span class="st">"Males_1521"</span>,</span>
<span>    <span class="st">"HOUSEHOLDS"</span>,</span>
<span>    <span class="st">"FAMILYHOUS"</span>,</span>
<span>    <span class="st">"FEMALE_HOU"</span>,</span>
<span>    <span class="st">"RENTER_HOU"</span>,</span>
<span>    <span class="st">"VACANT_HOU"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">match.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"i_felony"</span>, <span class="st">"i_misdemea"</span>, <span class="st">"i_drugs"</span>, <span class="st">"any_crime"</span><span class="op">)</span></span></code></pre></div>
<p>Step 3: Fit the Micro-Synthetic Control Model</p>
<p>We first estimate treatment effects using a single follow-up period.</p>
<div class="sourceCode" id="cb874"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sea1</span> <span class="op">&lt;-</span> <span class="fu">microsynth</span><span class="op">(</span></span>
<span>    <span class="va">seattledmi</span>,</span>
<span>    idvar       <span class="op">=</span> <span class="st">"ID"</span>,          <span class="co"># Unique unit identifier</span></span>
<span>    timevar     <span class="op">=</span> <span class="st">"time"</span>,        <span class="co"># Time variable</span></span>
<span>    intvar      <span class="op">=</span> <span class="st">"Intervention"</span>,<span class="co"># Treatment assignment</span></span>
<span>    start.pre   <span class="op">=</span> <span class="fl">1</span>,             <span class="co"># Start of pre-treatment period</span></span>
<span>    end.pre     <span class="op">=</span> <span class="fl">12</span>,            <span class="co"># End of pre-treatment period</span></span>
<span>    end.post    <span class="op">=</span> <span class="fl">16</span>,            <span class="co"># End of post-treatment period</span></span>
<span>    match.out   <span class="op">=</span> <span class="va">match.out</span>,     <span class="co"># Outcomes to match on</span></span>
<span>    match.covar <span class="op">=</span> <span class="va">cov.var</span>,       <span class="co"># Predictors to match on</span></span>
<span>    result.var  <span class="op">=</span> <span class="va">match.out</span>,     <span class="co"># Variables for treatment effect estimates</span></span>
<span>    omnibus.var <span class="op">=</span> <span class="va">match.out</span>,     <span class="co"># Variables for omnibus p-values</span></span>
<span>    test        <span class="op">=</span> <span class="st">"lower"</span>,       <span class="co"># One-sided test (decrease in crime)</span></span>
<span>    n.cores     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># Parallel processing</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Step 4: Summarize Results</p>
<div class="sourceCode" id="cb875"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sea1</span><span class="op">)</span></span></code></pre></div>
<p>This output provides:</p>
<ul>
<li><p>Weighted unit contributions to the synthetic control.</p></li>
<li><p>Treatment effect estimates and confidence intervals.</p></li>
<li><p>p-values from permutation tests.</p></li>
</ul>
<p>Step 5: Visualize the Treatment Effect</p>
<p>We generate a treatment effect plot comparing actual vs. synthetic trends.</p>
<div class="sourceCode" id="cb876"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_microsynth</span><span class="op">(</span><span class="va">sea1</span><span class="op">)</span></span></code></pre></div>
<p>Step 6: Incorporating Multiple Follow-Up Periods</p>
<p>We extend the analysis by adding multiple post-treatment periods (<code>end.post = c(14, 16)</code>) and permutation-based placebo tests (<code>perm = 250</code>, <code>jack = TRUE</code>).</p>
<div class="sourceCode" id="cb877"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sea2</span> <span class="op">&lt;-</span> <span class="fu">microsynth</span><span class="op">(</span></span>
<span>    <span class="va">seattledmi</span>,</span>
<span>    idvar       <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>    timevar     <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>    intvar      <span class="op">=</span> <span class="st">"Intervention"</span>,</span>
<span>    start.pre   <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    end.pre     <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    end.post    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">16</span><span class="op">)</span>, <span class="co"># Two follow-up periods</span></span>
<span>    match.out   <span class="op">=</span> <span class="va">match.out</span>,</span>
<span>    match.covar <span class="op">=</span> <span class="va">cov.var</span>,</span>
<span>    result.var  <span class="op">=</span> <span class="va">match.out</span>,</span>
<span>    omnibus.var <span class="op">=</span> <span class="va">match.out</span>,</span>
<span>    test        <span class="op">=</span> <span class="st">"lower"</span>,</span>
<span>    perm        <span class="op">=</span> <span class="fl">250</span>, <span class="co"># Permutation placebo tests</span></span>
<span>    jack        <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Jackknife resampling</span></span>
<span>    n.cores     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Step 7: Placebo Testing and Robustness Checks</p>
<p>Permutation and jackknife tests assess whether observed treatment effects are statistically significant or due to random fluctuations.</p>
<p>Key robustness checks:</p>
<ol style="list-style-type: decimal">
<li>Permutation Tests (<code>perm = 250</code>)</li>
</ol>
<pre><code>1.  Reassigns treatment randomly and estimates placebo effects

2.  If true effects exceed placebo effects, they are likely causal.</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Jackknife Resampling (<code>jack = TRUE</code>)</li>
</ol>
<pre><code>1.  Removes one control unit at a time and re-estimates effects.

2.  Ensures no single control dominates the synthetic match.</code></pre>
<div class="sourceCode" id="cb880"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sea2</span><span class="op">)</span>  <span class="co"># Compare estimates with multiple follow-up periods</span></span>
<span><span class="fu">plot_microsynth</span><span class="op">(</span><span class="va">sea2</span><span class="op">)</span>  <span class="co"># Visualize placebo-adjusted treatment effects</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></div>
<div class="next"><a href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-synthetic-control"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="nav-link" href="#marketing-applications"><span class="header-section-number">32.1</span> Marketing Applications</a></li>
<li><a class="nav-link" href="#key-features-of-scm"><span class="header-section-number">32.2</span> Key Features of SCM</a></li>
<li>
<a class="nav-link" href="#advantages-of-scm"><span class="header-section-number">32.3</span> Advantages of SCM</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#compared-to-did"><span class="header-section-number">32.3.1</span> Compared to DiD</a></li>
<li><a class="nav-link" href="#compared-to-linear-regression"><span class="header-section-number">32.3.2</span> Compared to Linear Regression</a></li>
<li><a class="nav-link" href="#additional-advantages"><span class="header-section-number">32.3.3</span> Additional Advantages</a></li>
</ul>
</li>
<li><a class="nav-link" href="#disadvantages-of-scm"><span class="header-section-number">32.4</span> Disadvantages of SCM</a></li>
<li><a class="nav-link" href="#assumptions-4"><span class="header-section-number">32.5</span> Assumptions</a></li>
<li>
<a class="nav-link" href="#estimation-3"><span class="header-section-number">32.6</span> Estimation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#constructing-the-synthetic-control"><span class="header-section-number">32.6.1</span> Constructing the Synthetic Control</a></li>
<li><a class="nav-link" href="#penalized-synthetic-control"><span class="header-section-number">32.6.2</span> Penalized Synthetic Control</a></li>
</ul>
</li>
<li><a class="nav-link" href="#theoretical-considerations"><span class="header-section-number">32.7</span> Theoretical Considerations</a></li>
<li>
<a class="nav-link" href="#inference-in-scm"><span class="header-section-number">32.8</span> Inference in SCM</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#permutation-placebo-inference"><span class="header-section-number">32.8.1</span> Permutation (Placebo) Inference</a></li>
<li><a class="nav-link" href="#one-sided-inference"><span class="header-section-number">32.8.2</span> One-Sided Inference</a></li>
</ul>
</li>
<li><a class="nav-link" href="#sec-augmented-synthetic-control"><span class="header-section-number">32.9</span> Augmented Synthetic Control Method</a></li>
<li>
<a class="nav-link" href="#synthetic-control-with-staggered-adoption"><span class="header-section-number">32.10</span> Synthetic Control with Staggered Adoption</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#partially-pooled-synthetic-control"><span class="header-section-number">32.10.1</span> Partially Pooled Synthetic Control</a></li></ul>
</li>
<li>
<a class="nav-link" href="#generalized-synthetic-control"><span class="header-section-number">32.11</span> Generalized Synthetic Control</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-problem-with-traditional-methods"><span class="header-section-number">32.11.1</span> The Problem with Traditional Methods</a></li>
<li><a class="nav-link" href="#generalized-synthetic-control-model"><span class="header-section-number">32.11.2</span> Generalized Synthetic Control Model</a></li>
<li><a class="nav-link" href="#identification-and-estimation"><span class="header-section-number">32.11.3</span> Identification and Estimation</a></li>
<li><a class="nav-link" href="#bootstrap-procedure-for-standard-errors"><span class="header-section-number">32.11.4</span> Bootstrap Procedure for Standard Errors</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#bayesian-synthetic-control"><span class="header-section-number">32.12</span> Bayesian Synthetic Control</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#bayesian-causal-inference-framework"><span class="header-section-number">32.12.1</span> Bayesian Causal Inference Framework</a></li>
<li><a class="nav-link" href="#bayesian-dynamic-multilevel-factor-model"><span class="header-section-number">32.12.2</span> Bayesian Dynamic Multilevel Factor Model</a></li>
<li><a class="nav-link" href="#bayesian-sparse-synthetic-control"><span class="header-section-number">32.12.3</span> Bayesian Sparse Synthetic Control</a></li>
<li><a class="nav-link" href="#bayesian-inference-and-mcmc-estimation"><span class="header-section-number">32.12.4</span> Bayesian Inference and MCMC Estimation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#using-multiple-outcomes-to-improve-the-synthetic-control-method"><span class="header-section-number">32.13</span> Using Multiple Outcomes to Improve the Synthetic Control Method</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#standard-synthetic-control-method"><span class="header-section-number">32.13.1</span> Standard Synthetic Control Method</a></li>
<li><a class="nav-link" href="#using-multiple-outcomes-for-bias-reduction"><span class="header-section-number">32.13.2</span> Using Multiple Outcomes for Bias Reduction</a></li>
<li><a class="nav-link" href="#estimation-methods-1"><span class="header-section-number">32.13.3</span> Estimation Methods</a></li>
<li><a class="nav-link" href="#empirical-application-flint-water-crisis"><span class="header-section-number">32.13.4</span> Empirical Application: Flint Water Crisis</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#applications"><span class="header-section-number">32.14</span> Applications</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#synthetic-control-estimation"><span class="header-section-number">32.14.1</span> Synthetic Control Estimation</a></li>
<li><a class="nav-link" href="#the-basque-country-policy-change"><span class="header-section-number">32.14.2</span> The Basque Country Policy Change</a></li>
<li><a class="nav-link" href="#micro-synthetic-control-with-microsynth"><span class="header-section-number">32.14.3</span> Micro-Synthetic Control with microsynth</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/32-synthetic-control.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/32-synthetic-control.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-06-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
