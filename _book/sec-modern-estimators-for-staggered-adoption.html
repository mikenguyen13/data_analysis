<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>30.8 Modern Estimators for Staggered Adoption | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="30.8 Modern Estimators for Staggered Adoption | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="30.8 Modern Estimators for Staggered Adoption | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2025-06-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="sec-multiple-periods-and-variation-in-treatment-timing.html"/>
<link rel="next" href="multiple-treatments.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
<li class="chapter" data-level="2.1.6" data-path="matrix-theory.html"><a href="matrix-theory.html#cholesky-decomposition"><i class="fa fa-check"></i><b>2.1.6</b> Cholesky Decomposition</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#skewness"><i class="fa fa-check"></i><b>2.2.6</b> Skewness</a></li>
<li class="chapter" data-level="2.2.7" data-path="probability-theory.html"><a href="probability-theory.html#kurtosis"><i class="fa fa-check"></i><b>2.2.7</b> Kurtosis</a></li>
<li class="chapter" data-level="2.2.8" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.8</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.5</b> Convergence</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.6</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.7</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#key-limitations-of-r"><i class="fa fa-check"></i><b>2.4.1</b> Key Limitations of R</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#solutions-and-workarounds"><i class="fa fa-check"></i><b>2.4.2</b> Solutions and Workarounds</a></li>
<li class="chapter" data-level="2.4.3" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.3</b> Medium size</a></li>
<li class="chapter" data-level="2.4.4" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.4</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
<li class="chapter" data-level="3.4.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#general-approach-to-bivariate-statistics"><i class="fa fa-check"></i><b>3.4.4</b> General Approach to Bivariate Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Testing Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i><b>4.1.1</b> Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> Errors in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-role-of-distributions-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> The Role of Distributions in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-test-statistic"><i class="fa fa-check"></i><b>4.1.4</b> The Test Statistic</a></li>
<li class="chapter" data-level="4.1.5" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#critical-values-and-rejection-regions-1"><i class="fa fa-check"></i><b>4.1.5</b> Critical Values and Rejection Regions</a></li>
<li class="chapter" data-level="4.1.6" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#visualizing-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.6</b> Visualizing Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html"><i class="fa fa-check"></i><b>4.2</b> Key Concepts and Definitions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#random-sample"><i class="fa fa-check"></i><b>4.2.1</b> Random Sample</a></li>
<li class="chapter" data-level="4.2.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#sample-statistics"><i class="fa fa-check"></i><b>4.2.2</b> Sample Statistics</a></li>
<li class="chapter" data-level="4.2.3" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#distribution-of-the-sample-mean"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-mean"><i class="fa fa-check"></i><b>4.3.1</b> For Single Mean</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-independent-samples"><i class="fa fa-check"></i><b>4.3.2</b> For Difference of Means, Independent Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-paired-samples"><i class="fa fa-check"></i><b>4.3.3</b> For Difference of Means, Paired Samples</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-two-proportions"><i class="fa fa-check"></i><b>4.3.4</b> For Difference of Two Proportions</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-proportion"><i class="fa fa-check"></i><b>4.3.5</b> For Single Proportion</a></li>
<li class="chapter" data-level="4.3.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-variance"><i class="fa fa-check"></i><b>4.3.6</b> For Single Variance</a></li>
<li class="chapter" data-level="4.3.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.3.7</b> Non-parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.4</b> Two-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-means"><i class="fa fa-check"></i><b>4.4.1</b> For Means</a></li>
<li class="chapter" data-level="4.4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-variances"><i class="fa fa-check"></i><b>4.4.2</b> For Variances</a></li>
<li class="chapter" data-level="4.4.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power"><i class="fa fa-check"></i><b>4.4.3</b> Power</a></li>
<li class="chapter" data-level="4.4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.4.4</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.4.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.4.5</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.5</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#association-tests"><i class="fa fa-check"></i><b>4.5.1</b> Association Tests</a></li>
<li class="chapter" data-level="4.5.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.5.2</b> Ordinal Association</a></li>
<li class="chapter" data-level="4.5.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-trend"><i class="fa fa-check"></i><b>4.5.3</b> Ordinal Trend</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.6</b> Divergence Metrics and Tests for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>4.6.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-anderson-darling-test"><i class="fa fa-check"></i><b>4.6.2</b> Anderson-Darling Test</a></li>
<li class="chapter" data-level="4.6.3" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.6.3</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.6.4" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-cramer-von-mises-test"><i class="fa fa-check"></i><b>4.6.4</b> Cramér-von Mises Test</a></li>
<li class="chapter" data-level="4.6.5" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.6.5</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.6.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.6.6</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.6.7" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-hellinger-distance"><i class="fa fa-check"></i><b>4.6.7</b> Hellinger Distance</a></li>
<li class="chapter" data-level="4.6.8" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-bhattacharyya-distance"><i class="fa fa-check"></i><b>4.6.8</b> Bhattacharyya Distance</a></li>
<li class="chapter" data-level="4.6.9" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-wasserstein-distance"><i class="fa fa-check"></i><b>4.6.9</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.6.10" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-energy-distance"><i class="fa fa-check"></i><b>4.6.10</b> Energy Distance</a></li>
<li class="chapter" data-level="4.6.11" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#sec-total-variation-distance"><i class="fa fa-check"></i><b>4.6.11</b> Total Variation Distance</a></li>
<li class="chapter" data-level="4.6.12" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#summary"><i class="fa fa-check"></i><b>4.6.12</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic) Model</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#infeasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.1</b> Infeasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.2" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#feasible-generalized-least-squares"><i class="fa fa-check"></i><b>5.2.2</b> Feasible Generalized Least Squares</a></li>
<li class="chapter" data-level="5.2.3" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html#weighted-least-squares"><i class="fa fa-check"></i><b>5.2.3</b> Weighted Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html"><i class="fa fa-check"></i><b>5.3</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.3.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#key-quantities-for-inference"><i class="fa fa-check"></i><b>5.3.2</b> Key Quantities for Inference</a></li>
<li class="chapter" data-level="5.3.3" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#assumptions-of-mle"><i class="fa fa-check"></i><b>5.3.3</b> Assumptions of MLE</a></li>
<li class="chapter" data-level="5.3.4" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#properties-of-mle"><i class="fa fa-check"></i><b>5.3.4</b> Properties of MLE</a></li>
<li class="chapter" data-level="5.3.5" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#practical-considerations"><i class="fa fa-check"></i><b>5.3.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="5.3.6" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#comparison-of-mle-and-ols"><i class="fa fa-check"></i><b>5.3.6</b> Comparison of MLE and OLS</a></li>
<li class="chapter" data-level="5.3.7" data-path="maximum-likelihood-estimator.html"><a href="maximum-likelihood-estimator.html#applications-of-mle"><i class="fa fa-check"></i><b>5.3.7</b> Applications of MLE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html"><i class="fa fa-check"></i><b>5.4</b> Penalized (Regularized) Estimators</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#motivation-for-penalized-estimators"><i class="fa fa-check"></i><b>5.4.1</b> Motivation for Penalized Estimators</a></li>
<li class="chapter" data-level="5.4.2" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#ridge-regression"><i class="fa fa-check"></i><b>5.4.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.4.3" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#lasso-regression"><i class="fa fa-check"></i><b>5.4.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="5.4.4" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#elastic-net"><i class="fa fa-check"></i><b>5.4.4</b> Elastic Net</a></li>
<li class="chapter" data-level="5.4.5" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#tuning-parameter-selection"><i class="fa fa-check"></i><b>5.4.5</b> Tuning Parameter Selection</a></li>
<li class="chapter" data-level="5.4.6" data-path="penalized-regularized-estimators.html"><a href="penalized-regularized-estimators.html#properties-of-penalized-estimators"><i class="fa fa-check"></i><b>5.4.6</b> Properties of Penalized Estimators</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="robust-estimators.html"><a href="robust-estimators.html"><i class="fa fa-check"></i><b>5.5</b> Robust Estimators</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="robust-estimators.html"><a href="robust-estimators.html#motivation-for-robust-estimation"><i class="fa fa-check"></i><b>5.5.1</b> Motivation for Robust Estimation</a></li>
<li class="chapter" data-level="5.5.2" data-path="robust-estimators.html"><a href="robust-estimators.html#m-estimators"><i class="fa fa-check"></i><b>5.5.2</b> <span class="math inline">\(M\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.3" data-path="robust-estimators.html"><a href="robust-estimators.html#r-estimators"><i class="fa fa-check"></i><b>5.5.3</b> <span class="math inline">\(R\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.4" data-path="robust-estimators.html"><a href="robust-estimators.html#l-estimators"><i class="fa fa-check"></i><b>5.5.4</b> <span class="math inline">\(L\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.5" data-path="robust-estimators.html"><a href="robust-estimators.html#least-trimmed-squares-lts"><i class="fa fa-check"></i><b>5.5.5</b> Least Trimmed Squares (LTS)</a></li>
<li class="chapter" data-level="5.5.6" data-path="robust-estimators.html"><a href="robust-estimators.html#s-estimators"><i class="fa fa-check"></i><b>5.5.6</b> <span class="math inline">\(S\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.7" data-path="robust-estimators.html"><a href="robust-estimators.html#mm-estimators"><i class="fa fa-check"></i><b>5.5.7</b> <span class="math inline">\(MM\)</span>-Estimators</a></li>
<li class="chapter" data-level="5.5.8" data-path="robust-estimators.html"><a href="robust-estimators.html#practical-considerations-1"><i class="fa fa-check"></i><b>5.5.8</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="partial-least-squares.html"><a href="partial-least-squares.html"><i class="fa fa-check"></i><b>5.6</b> Partial Least Squares</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="partial-least-squares.html"><a href="partial-least-squares.html#motivation-for-pls"><i class="fa fa-check"></i><b>5.6.1</b> Motivation for PLS</a></li>
<li class="chapter" data-level="5.6.2" data-path="partial-least-squares.html"><a href="partial-least-squares.html#steps-to-construct-pls-components"><i class="fa fa-check"></i><b>5.6.2</b> Steps to Construct PLS Components</a></li>
<li class="chapter" data-level="5.6.3" data-path="partial-least-squares.html"><a href="partial-least-squares.html#properties-of-pls"><i class="fa fa-check"></i><b>5.6.3</b> Properties of PLS</a></li>
<li class="chapter" data-level="5.6.4" data-path="partial-least-squares.html"><a href="partial-least-squares.html#comparison-with-related-methods"><i class="fa fa-check"></i><b>5.6.4</b> Comparison with Related Methods</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference.html"><a href="inference.html#linear-functions-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Functions of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference.html"><a href="inference.html#nonlinear-functions-of-parameters"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear Functions of Parameters</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#iterative-optimization-nonlinear-regression"><i class="fa fa-check"></i><b>6.2.1</b> Iterative Optimization</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#derivative-free"><i class="fa fa-check"></i><b>6.2.2</b> Derivative-Free</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#stochastic-heuristic-nolinear-regression"><i class="fa fa-check"></i><b>6.2.3</b> Stochastic Heuristic</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#linearization-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.4</b> Linearization</a></li>
<li class="chapter" data-level="6.2.5" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#hybrid-nonlinear-regression-optimization"><i class="fa fa-check"></i><b>6.2.5</b> Hybrid</a></li>
<li class="chapter" data-level="6.2.6" data-path="non-linear-least-squares-estimation.html"><a href="non-linear-least-squares-estimation.html#comparison-of-nonlinear-optimizers"><i class="fa fa-check"></i><b>6.2.6</b> Comparison of Nonlinear Optimizers</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html"><i class="fa fa-check"></i><b>6.3</b> Practical Considerations</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#selecting-starting-values"><i class="fa fa-check"></i><b>6.3.1</b> Selecting Starting Values</a></li>
<li class="chapter" data-level="6.3.2" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#handling-constrained-parameters"><i class="fa fa-check"></i><b>6.3.2</b> Handling Constrained Parameters</a></li>
<li class="chapter" data-level="6.3.3" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#failure-to-converge"><i class="fa fa-check"></i><b>6.3.3</b> Failure to Converge</a></li>
<li class="chapter" data-level="6.3.4" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#convergence-to-a-local-minimum"><i class="fa fa-check"></i><b>6.3.4</b> Convergence to a Local Minimum</a></li>
<li class="chapter" data-level="6.3.5" data-path="practical-considerations-2.html"><a href="practical-considerations-2.html#model-adequacy-and-estimation-considerations"><i class="fa fa-check"></i><b>6.3.5</b> Model Adequacy and Estimation Considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="application.html"><a href="application.html"><i class="fa fa-check"></i><b>6.4</b> Application</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="application.html"><a href="application.html#nonlinear-estimation-using-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.4.1</b> Nonlinear Estimation Using Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.4.2" data-path="application.html"><a href="application.html#logistic-growth-model"><i class="fa fa-check"></i><b>6.4.2</b> Logistic Growth Model</a></li>
<li class="chapter" data-level="6.4.3" data-path="application.html"><a href="application.html#nonlinear-plateau-model"><i class="fa fa-check"></i><b>6.4.3</b> Nonlinear Plateau Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#logistic-model"><i class="fa fa-check"></i><b>7.1.1</b> Logistic Model</a></li>
<li class="chapter" data-level="7.1.2" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#sec-likelihood-function-logistic"><i class="fa fa-check"></i><b>7.1.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="7.1.3" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#fisher-information-matrix"><i class="fa fa-check"></i><b>7.1.3</b> Fisher Information Matrix</a></li>
<li class="chapter" data-level="7.1.4" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#inference-in-logistic-regression"><i class="fa fa-check"></i><b>7.1.4</b> Inference in Logistic Regression</a></li>
<li class="chapter" data-level="7.1.5" data-path="sec-logistic-regression.html"><a href="sec-logistic-regression.html#application-logistic-regression"><i class="fa fa-check"></i><b>7.1.5</b> Application: Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#probit-model"><i class="fa fa-check"></i><b>7.2.1</b> Probit Model</a></li>
<li class="chapter" data-level="7.2.2" data-path="sec-probit-regression.html"><a href="sec-probit-regression.html#application-probit-regression"><i class="fa fa-check"></i><b>7.2.2</b> Application: Probit Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#dataset-overview"><i class="fa fa-check"></i><b>7.3.1</b> Dataset Overview</a></li>
<li class="chapter" data-level="7.3.2" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-logistic-model"><i class="fa fa-check"></i><b>7.3.2</b> Apply Logistic Model</a></li>
<li class="chapter" data-level="7.3.3" data-path="sec-binomial-regression.html"><a href="sec-binomial-regression.html#apply-probit-model"><i class="fa fa-check"></i><b>7.3.3</b> Apply Probit Model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#the-poisson-distribution"><i class="fa fa-check"></i><b>7.4.1</b> The Poisson Distribution</a></li>
<li class="chapter" data-level="7.4.2" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#poisson-model"><i class="fa fa-check"></i><b>7.4.2</b> Poisson Model</a></li>
<li class="chapter" data-level="7.4.3" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#link-function-choices"><i class="fa fa-check"></i><b>7.4.3</b> Link Function Choices</a></li>
<li class="chapter" data-level="7.4.4" data-path="sec-poisson-regression.html"><a href="sec-poisson-regression.html#application-poisson-regression"><i class="fa fa-check"></i><b>7.4.4</b> Application: Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#negative-binomial-distribution"><i class="fa fa-check"></i><b>7.5.1</b> Negative Binomial Distribution</a></li>
<li class="chapter" data-level="7.5.2" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#application-negative-binomial-regression"><i class="fa fa-check"></i><b>7.5.2</b> Application: Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.5.3" data-path="sec-negative-binomial-regression.html"><a href="sec-negative-binomial-regression.html#fitting-a-zero-inflated-negative-binomial-model"><i class="fa fa-check"></i><b>7.5.3</b> Fitting a Zero-Inflated Negative Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html"><i class="fa fa-check"></i><b>7.6</b> Quasi-Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#is-quasi-poisson-regression-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.6.1</b> Is Quasi-Poisson Regression a Generalized Linear Model?</a></li>
<li class="chapter" data-level="7.6.2" data-path="sec-quasi-poisson-regression.html"><a href="sec-quasi-poisson-regression.html#application-quasi-poisson-regression"><i class="fa fa-check"></i><b>7.6.2</b> Application: Quasi-Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>7.7</b> Multinomial Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#the-multinomial-distribution"><i class="fa fa-check"></i><b>7.7.1</b> The Multinomial Distribution</a></li>
<li class="chapter" data-level="7.7.2" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#modeling-probabilities-using-log-odds"><i class="fa fa-check"></i><b>7.7.2</b> Modeling Probabilities Using Log-Odds</a></li>
<li class="chapter" data-level="7.7.3" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#softmax-representation"><i class="fa fa-check"></i><b>7.7.3</b> Softmax Representation</a></li>
<li class="chapter" data-level="7.7.4" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#log-odds-ratio-between-two-categories"><i class="fa fa-check"></i><b>7.7.4</b> Log-Odds Ratio Between Two Categories</a></li>
<li class="chapter" data-level="7.7.5" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#estimation"><i class="fa fa-check"></i><b>7.7.5</b> Estimation</a></li>
<li class="chapter" data-level="7.7.6" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#interpretation-of-coefficients"><i class="fa fa-check"></i><b>7.7.6</b> Interpretation of Coefficients</a></li>
<li class="chapter" data-level="7.7.7" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-multinomial-logistic-regression"><i class="fa fa-check"></i><b>7.7.7</b> Application: Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="7.7.8" data-path="sec-multinomial-logistic-regression.html"><a href="sec-multinomial-logistic-regression.html#application-gamma-regression"><i class="fa fa-check"></i><b>7.7.8</b> Application: Gamma Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html"><i class="fa fa-check"></i><b>7.8</b> Generalization of Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#exponential-family"><i class="fa fa-check"></i><b>7.8.1</b> Exponential Family</a></li>
<li class="chapter" data-level="7.8.2" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#properties-of-glm-exponential-families"><i class="fa fa-check"></i><b>7.8.2</b> Properties of GLM Exponential Families</a></li>
<li class="chapter" data-level="7.8.3" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#structure-of-a-generalized-linear-model"><i class="fa fa-check"></i><b>7.8.3</b> Structure of a Generalized Linear Model</a></li>
<li class="chapter" data-level="7.8.4" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#components-of-a-glm"><i class="fa fa-check"></i><b>7.8.4</b> Components of a GLM</a></li>
<li class="chapter" data-level="7.8.5" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#canonical-link"><i class="fa fa-check"></i><b>7.8.5</b> Canonical Link</a></li>
<li class="chapter" data-level="7.8.6" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inverse-link-functions"><i class="fa fa-check"></i><b>7.8.6</b> Inverse Link Functions</a></li>
<li class="chapter" data-level="7.8.7" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#estimation-of-parameters-in-glms"><i class="fa fa-check"></i><b>7.8.7</b> Estimation of Parameters in GLMs</a></li>
<li class="chapter" data-level="7.8.8" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#inference-1"><i class="fa fa-check"></i><b>7.8.8</b> Inference</a></li>
<li class="chapter" data-level="7.8.9" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#deviance"><i class="fa fa-check"></i><b>7.8.9</b> Deviance</a></li>
<li class="chapter" data-level="7.8.10" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.8.10</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.8.11" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.8.11</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.8.12" data-path="sec-generalization-of-generalized-linear-models.html"><a href="sec-generalization-of-generalized-linear-models.html#over-dispersion"><i class="fa fa-check"></i><b>7.8.12</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sec-linear-mixed-models.html"><a href="sec-linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#motivation-a-repeated-measurements-example"><i class="fa fa-check"></i><b>8.1.1</b> Motivation: A Repeated Measurements Example</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#example-linear-mixed-model-for-repeated-measurements"><i class="fa fa-check"></i><b>8.1.2</b> Example: Linear Mixed Model for Repeated Measurements</a></li>
<li class="chapter" data-level="8.1.3" data-path="dependent-data.html"><a href="dependent-data.html#sec-random-intercepts-model-lmm"><i class="fa fa-check"></i><b>8.1.3</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.4" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models-in-linear-mixed-models"><i class="fa fa-check"></i><b>8.1.4</b> Covariance Models in Linear Mixed Models</a></li>
<li class="chapter" data-level="8.1.5" data-path="dependent-data.html"><a href="dependent-data.html#covariance-structures-in-mixed-models"><i class="fa fa-check"></i><b>8.1.5</b> Covariance Structures in Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.2</b> Estimation in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#interpretation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.1</b> Interpretation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.2" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#derivation-of-the-mixed-model-equations"><i class="fa fa-check"></i><b>8.2.2</b> Derivation of the Mixed Model Equations</a></li>
<li class="chapter" data-level="8.2.3" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#bayesian-interpretation-of-linear-mixed-models"><i class="fa fa-check"></i><b>8.2.3</b> Bayesian Interpretation of Linear Mixed Models</a></li>
<li class="chapter" data-level="8.2.4" data-path="estimation-in-linear-mixed-models.html"><a href="estimation-in-linear-mixed-models.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>8.2.4</b> Estimating the Variance-Covariance Matrix</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>8.3</b> Inference in Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-fixed-effects-beta"><i class="fa fa-check"></i><b>8.3.1</b> Inference for Fixed Effects (<span class="math inline">\(\beta\)</span>)</a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-in-linear-mixed-models.html"><a href="inference-in-linear-mixed-models.html#inference-for-variance-components-theta"><i class="fa fa-check"></i><b>8.3.2</b> Inference for Variance Components (<span class="math inline">\(\theta\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria for Model Selection</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-akaike-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.1</b> Akaike Information Criterion</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-corrected-aic-lmm"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#sec-bayesian-information-criterion-lmm"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criterion</a></li>
<li class="chapter" data-level="8.4.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#practical-example-with-linear-mixed-models"><i class="fa fa-check"></i><b>8.4.4</b> Practical Example with Linear Mixed Models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#example-setup"><i class="fa fa-check"></i><b>8.5.1</b> Example Setup</a></li>
<li class="chapter" data-level="8.5.2" data-path="split-plot-designs.html"><a href="split-plot-designs.html#statistical-model-for-split-plot-designs"><i class="fa fa-check"></i><b>8.5.2</b> Statistical Model for Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.3" data-path="split-plot-designs.html"><a href="split-plot-designs.html#approaches-to-analyzing-split-plot-designs"><i class="fa fa-check"></i><b>8.5.3</b> Approaches to Analyzing Split-Plot Designs</a></li>
<li class="chapter" data-level="8.5.4" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-split-plot-design"><i class="fa fa-check"></i><b>8.5.4</b> Application: Split-Plot Design</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html#variance-covariance-structure-power-model"><i class="fa fa-check"></i><b>8.7.1</b> Variance-Covariance Structure: Power Model</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html"><i class="fa fa-check"></i><b>8.8</b> Application: Mixed Models in Practice</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-1-pulp-brightness-analysis"><i class="fa fa-check"></i><b>8.8.1</b> Example 1: Pulp Brightness Analysis</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-2-penicillin-yield-glmm-with-blocking"><i class="fa fa-check"></i><b>8.8.2</b> Example 2: Penicillin Yield (GLMM with Blocking)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-3-growth-in-rats-over-time"><i class="fa fa-check"></i><b>8.8.3</b> Example 3: Growth in Rats Over Time</a></li>
<li class="chapter" data-level="8.8.4" data-path="application-mixed-models-in-practice.html"><a href="application-mixed-models-in-practice.html#example-4-tree-water-use-agridat"><i class="fa fa-check"></i><b>8.8.4</b> Example 4: Tree Water Use (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sec-nonlinear-and-generalized-linear-mixed-models.html"><a href="sec-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sec-nonlinear-mixed-models.html"><a href="sec-nonlinear-mixed-models.html"><i class="fa fa-check"></i><b>9.1</b> Nonlinear Mixed Models</a></li>
<li class="chapter" data-level="9.2" data-path="sec-generalized-linear-mixed-models.html"><a href="sec-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.2</b> Generalized Linear Mixed Models</a></li>
<li class="chapter" data-level="9.3" data-path="relationship-between-nlmms-and-glmms.html"><a href="relationship-between-nlmms-and-glmms.html"><i class="fa fa-check"></i><b>9.3</b> Relationship Between NLMMs and GLMMs</a></li>
<li class="chapter" data-level="9.4" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html"><i class="fa fa-check"></i><b>9.4</b> Marginal Properties of GLMMs</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-mean-of-y_i"><i class="fa fa-check"></i><b>9.4.1</b> Marginal Mean of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-variance-of-y_i"><i class="fa fa-check"></i><b>9.4.2</b> Marginal Variance of <span class="math inline">\(y_i\)</span></a></li>
<li class="chapter" data-level="9.4.3" data-path="marginal-properties-of-glmms.html"><a href="marginal-properties-of-glmms.html#marginal-covariance-of-mathbfy"><i class="fa fa-check"></i><b>9.4.3</b> Marginal Covariance of <span class="math inline">\(\mathbf{y}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.5</b> Estimation in Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.5.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.5.2" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#sec-estimation-by-linearization-glmm"><i class="fa fa-check"></i><b>9.5.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.5.3" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.5.3</b> Estimation by Bayesian Hierarchical Models</a></li>
<li class="chapter" data-level="9.5.4" data-path="estimation-in-nonlinear-and-generalized-linear-mixed-models.html"><a href="estimation-in-nonlinear-and-generalized-linear-mixed-models.html#practical-implementation-in-r"><i class="fa fa-check"></i><b>9.5.4</b> Practical Implementation in R</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9.6</b> Application: Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-data-cbpp-dataset"><i class="fa fa-check"></i><b>9.6.1</b> Binomial Data: CBPP Dataset</a></li>
<li class="chapter" data-level="9.6.2" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#count-data-owl-dataset"><i class="fa fa-check"></i><b>9.6.2</b> Count Data: Owl Dataset</a></li>
<li class="chapter" data-level="9.6.3" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#binomial-example-gotway-hessian-fly-data"><i class="fa fa-check"></i><b>9.6.3</b> Binomial Example: Gotway Hessian Fly Data</a></li>
<li class="chapter" data-level="9.6.4" data-path="application-nonlinear-and-generalized-linear-mixed-models.html"><a href="application-nonlinear-and-generalized-linear-mixed-models.html#nonlinear-mixed-model-yellow-poplar-data"><i class="fa fa-check"></i><b>9.6.4</b> Nonlinear Mixed Model: Yellow Poplar Data</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="sec-nonparametric-regression.html"><a href="sec-nonparametric-regression.html"><i class="fa fa-check"></i><b>10</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html"><i class="fa fa-check"></i><b>10.1</b> Why Nonparametric?</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="why-nonparametric.html"><a href="why-nonparametric.html#flexibility"><i class="fa fa-check"></i><b>10.1.1</b> Flexibility</a></li>
<li class="chapter" data-level="10.1.2" data-path="why-nonparametric.html"><a href="why-nonparametric.html#fewer-assumptions"><i class="fa fa-check"></i><b>10.1.2</b> Fewer Assumptions</a></li>
<li class="chapter" data-level="10.1.3" data-path="why-nonparametric.html"><a href="why-nonparametric.html#interpretability"><i class="fa fa-check"></i><b>10.1.3</b> Interpretability</a></li>
<li class="chapter" data-level="10.1.4" data-path="why-nonparametric.html"><a href="why-nonparametric.html#practical-considerations-3"><i class="fa fa-check"></i><b>10.1.4</b> Practical Considerations</a></li>
<li class="chapter" data-level="10.1.5" data-path="why-nonparametric.html"><a href="why-nonparametric.html#balancing-parametric-and-nonparametric-approaches"><i class="fa fa-check"></i><b>10.1.5</b> Balancing Parametric and Nonparametric Approaches</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html"><i class="fa fa-check"></i><b>10.2</b> Basic Concepts in Nonparametric Estimation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>10.2.1</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="10.2.2" data-path="basic-concepts-in-nonparametric-estimation.html"><a href="basic-concepts-in-nonparametric-estimation.html#kernel-smoothing-and-local-averages"><i class="fa fa-check"></i><b>10.2.2</b> Kernel Smoothing and Local Averages</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html"><i class="fa fa-check"></i><b>10.3</b> Kernel Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#basic-setup"><i class="fa fa-check"></i><b>10.3.1</b> Basic Setup</a></li>
<li class="chapter" data-level="10.3.2" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-nadaraya-watson-kernel-estimator"><i class="fa fa-check"></i><b>10.3.2</b> Nadaraya-Watson Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.3" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-priestley-chao-kernel-estimator"><i class="fa fa-check"></i><b>10.3.3</b> Priestley–Chao Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.4" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#sec-gasser-mueller-kernel-estimator"><i class="fa fa-check"></i><b>10.3.4</b> Gasser–Müller Kernel Estimator</a></li>
<li class="chapter" data-level="10.3.5" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#comparison-of-kernel-based-estimators"><i class="fa fa-check"></i><b>10.3.5</b> Comparison of Kernel-Based Estimators</a></li>
<li class="chapter" data-level="10.3.6" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#bandwidth-selection"><i class="fa fa-check"></i><b>10.3.6</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.3.7" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#asymptotic-properties"><i class="fa fa-check"></i><b>10.3.7</b> Asymptotic Properties</a></li>
<li class="chapter" data-level="10.3.8" data-path="sec-kernel-regression.html"><a href="sec-kernel-regression.html#derivation-of-the-nadaraya-watson-estimator"><i class="fa fa-check"></i><b>10.3.8</b> Derivation of the Nadaraya-Watson Estimator</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html"><i class="fa fa-check"></i><b>10.4</b> Local Polynomial Regression</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#local-polynomial-fitting"><i class="fa fa-check"></i><b>10.4.1</b> Local Polynomial Fitting</a></li>
<li class="chapter" data-level="10.4.2" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#mathematical-form-of-the-solution"><i class="fa fa-check"></i><b>10.4.2</b> Mathematical Form of the Solution</a></li>
<li class="chapter" data-level="10.4.3" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bias-variance-and-asymptotics"><i class="fa fa-check"></i><b>10.4.3</b> Bias, Variance, and Asymptotics</a></li>
<li class="chapter" data-level="10.4.4" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#sec-special-case-local-linear-regression"><i class="fa fa-check"></i><b>10.4.4</b> Special Case: Local Linear Regression</a></li>
<li class="chapter" data-level="10.4.5" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#bandwidth-selection-1"><i class="fa fa-check"></i><b>10.4.5</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="10.4.6" data-path="sec-local-polynomial-regression.html"><a href="sec-local-polynomial-regression.html#asymptotic-properties-summary"><i class="fa fa-check"></i><b>10.4.6</b> Asymptotic Properties Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html"><i class="fa fa-check"></i><b>10.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#properties-and-form-of-the-smoothing-spline"><i class="fa fa-check"></i><b>10.5.1</b> Properties and Form of the Smoothing Spline</a></li>
<li class="chapter" data-level="10.5.2" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#choice-of-lambda"><i class="fa fa-check"></i><b>10.5.2</b> Choice of <span class="math inline">\(\lambda\)</span></a></li>
<li class="chapter" data-level="10.5.3" data-path="sec-smoothing-splines.html"><a href="sec-smoothing-splines.html#connection-to-reproducing-kernel-hilbert-spaces"><i class="fa fa-check"></i><b>10.5.3</b> Connection to Reproducing Kernel Hilbert Spaces</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.6</b> Confidence Intervals in Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#asymptotic-normality"><i class="fa fa-check"></i><b>10.6.1</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="10.6.2" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#bootstrap-methods"><i class="fa fa-check"></i><b>10.6.2</b> Bootstrap Methods</a></li>
<li class="chapter" data-level="10.6.3" data-path="confidence-intervals-in-nonparametric-regression.html"><a href="confidence-intervals-in-nonparametric-regression.html#practical-considerations-4"><i class="fa fa-check"></i><b>10.6.3</b> Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html"><i class="fa fa-check"></i><b>10.7</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#estimation-via-penalized-likelihood"><i class="fa fa-check"></i><b>10.7.1</b> Estimation via Penalized Likelihood</a></li>
<li class="chapter" data-level="10.7.2" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#interpretation-of-gams"><i class="fa fa-check"></i><b>10.7.2</b> Interpretation of GAMs</a></li>
<li class="chapter" data-level="10.7.3" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#model-selection-and-smoothing-parameter-estimation"><i class="fa fa-check"></i><b>10.7.3</b> Model Selection and Smoothing Parameter Estimation</a></li>
<li class="chapter" data-level="10.7.4" data-path="sec-generalized-additive-models.html"><a href="sec-generalized-additive-models.html#extensions-of-gams"><i class="fa fa-check"></i><b>10.7.4</b> Extensions of GAMs</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html"><i class="fa fa-check"></i><b>10.8</b> Regression Trees and Random Forests</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-regression-trees"><i class="fa fa-check"></i><b>10.8.1</b> Regression Trees</a></li>
<li class="chapter" data-level="10.8.2" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#sec-random-forests"><i class="fa fa-check"></i><b>10.8.2</b> Random Forests</a></li>
<li class="chapter" data-level="10.8.3" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#theoretical-insights"><i class="fa fa-check"></i><b>10.8.3</b> Theoretical Insights</a></li>
<li class="chapter" data-level="10.8.4" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#feature-importance-in-random-forests"><i class="fa fa-check"></i><b>10.8.4</b> Feature Importance in Random Forests</a></li>
<li class="chapter" data-level="10.8.5" data-path="regression-trees-and-random-forests.html"><a href="regression-trees-and-random-forests.html#advantages-and-limitations-of-tree-based-methods"><i class="fa fa-check"></i><b>10.8.5</b> Advantages and Limitations of Tree-Based Methods</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html"><i class="fa fa-check"></i><b>10.9</b> Wavelet Regression</a>
<ul>
<li class="chapter" data-level="10.9.1" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-series-expansion"><i class="fa fa-check"></i><b>10.9.1</b> Wavelet Series Expansion</a></li>
<li class="chapter" data-level="10.9.2" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-regression-model"><i class="fa fa-check"></i><b>10.9.2</b> Wavelet Regression Model</a></li>
<li class="chapter" data-level="10.9.3" data-path="sec-wavelet-regression.html"><a href="sec-wavelet-regression.html#wavelet-shrinkage-and-thresholding"><i class="fa fa-check"></i><b>10.9.3</b> Wavelet Shrinkage and Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html"><i class="fa fa-check"></i><b>10.10</b> Multivariate Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#the-curse-of-dimensionality"><i class="fa fa-check"></i><b>10.10.1</b> The Curse of Dimensionality</a></li>
<li class="chapter" data-level="10.10.2" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-kernel-regression"><i class="fa fa-check"></i><b>10.10.2</b> Multivariate Kernel Regression</a></li>
<li class="chapter" data-level="10.10.3" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#multivariate-splines"><i class="fa fa-check"></i><b>10.10.3</b> Multivariate Splines</a></li>
<li class="chapter" data-level="10.10.4" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#additive-models-gams"><i class="fa fa-check"></i><b>10.10.4</b> Additive Models (GAMs)</a></li>
<li class="chapter" data-level="10.10.5" data-path="multivariate-nonparametric-regression.html"><a href="multivariate-nonparametric-regression.html#radial-basis-functions"><i class="fa fa-check"></i><b>10.10.5</b> Radial Basis Functions</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html"><i class="fa fa-check"></i><b>10.11</b> Conclusion: The Evolving Landscape of Regression Analysis</a>
<ul>
<li class="chapter" data-level="10.11.1" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#key-takeaways-1"><i class="fa fa-check"></i><b>10.11.1</b> Key Takeaways</a></li>
<li class="chapter" data-level="10.11.2" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#the-art-and-science-of-regression"><i class="fa fa-check"></i><b>10.11.2</b> The Art and Science of Regression</a></li>
<li class="chapter" data-level="10.11.3" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#looking-forward"><i class="fa fa-check"></i><b>10.11.3</b> Looking Forward</a></li>
<li class="chapter" data-level="10.11.4" data-path="conclusion-the-evolving-landscape-of-regression-analysis.html"><a href="conclusion-the-evolving-landscape-of-regression-analysis.html#final-thoughts"><i class="fa fa-check"></i><b>10.11.4</b> Final Thoughts</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="11" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>11</b> Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>11.1</b> Data Types</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="data-types.html"><a href="data-types.html#qualitative-vs.-quantitative-data"><i class="fa fa-check"></i><b>11.1.1</b> Qualitative vs. Quantitative Data</a></li>
<li class="chapter" data-level="11.1.2" data-path="data-types.html"><a href="data-types.html#other-ways-to-classify-data"><i class="fa fa-check"></i><b>11.1.2</b> Other Ways to Classify Data</a></li>
<li class="chapter" data-level="11.1.3" data-path="data-types.html"><a href="data-types.html#data-by-observational-structure-over-time"><i class="fa fa-check"></i><b>11.1.3</b> Data by Observational Structure Over Time</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sec-cross-sectional-data.html"><a href="sec-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.2</b> Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html"><i class="fa fa-check"></i><b>11.3</b> Time Series Data</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#statistical-properties-of-time-series-models"><i class="fa fa-check"></i><b>11.3.1</b> Statistical Properties of Time Series Models</a></li>
<li class="chapter" data-level="11.3.2" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#common-time-series-processes"><i class="fa fa-check"></i><b>11.3.2</b> Common Time Series Processes</a></li>
<li class="chapter" data-level="11.3.3" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#deterministic-time-trends"><i class="fa fa-check"></i><b>11.3.3</b> Deterministic Time Trends</a></li>
<li class="chapter" data-level="11.3.4" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#violations-of-exogeneity-in-time-series-models"><i class="fa fa-check"></i><b>11.3.4</b> Violations of Exogeneity in Time Series Models</a></li>
<li class="chapter" data-level="11.3.5" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#consequences-of-exogeneity-violations"><i class="fa fa-check"></i><b>11.3.5</b> Consequences of Exogeneity Violations</a></li>
<li class="chapter" data-level="11.3.6" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#highly-persistent-data"><i class="fa fa-check"></i><b>11.3.6</b> Highly Persistent Data</a></li>
<li class="chapter" data-level="11.3.7" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-unit-root-testing"><i class="fa fa-check"></i><b>11.3.7</b> Unit Root Testing</a></li>
<li class="chapter" data-level="11.3.8" data-path="sec-time-series-data.html"><a href="sec-time-series-data.html#sec-newey-west-standard-errors"><i class="fa fa-check"></i><b>11.3.8</b> Newey-West Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html"><i class="fa fa-check"></i><b>11.4</b> Repeated Cross-Sectional Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#key-characteristics"><i class="fa fa-check"></i><b>11.4.1</b> Key Characteristics</a></li>
<li class="chapter" data-level="11.4.2" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#statistical-modeling-for-repeated-cross-sections"><i class="fa fa-check"></i><b>11.4.2</b> Statistical Modeling for Repeated Cross-Sections</a></li>
<li class="chapter" data-level="11.4.3" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#advantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.3</b> Advantages of Repeated Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.4.4" data-path="sec-repeated-cross-sectional-data.html"><a href="sec-repeated-cross-sectional-data.html#disadvantages-of-repeated-cross-sectional-data"><i class="fa fa-check"></i><b>11.4.4</b> Disadvantages of Repeated Cross-Sectional Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html"><i class="fa fa-check"></i><b>11.5</b> Panel Data</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sec-panel-data.html"><a href="sec-panel-data.html#advantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.1</b> Advantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.2" data-path="sec-panel-data.html"><a href="sec-panel-data.html#disadvantages-of-panel-data"><i class="fa fa-check"></i><b>11.5.2</b> Disadvantages of Panel Data</a></li>
<li class="chapter" data-level="11.5.3" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sources-of-variation-in-panel-data"><i class="fa fa-check"></i><b>11.5.3</b> Sources of Variation in Panel Data</a></li>
<li class="chapter" data-level="11.5.4" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-pooled-ols-estimator"><i class="fa fa-check"></i><b>11.5.4</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="11.5.5" data-path="sec-panel-data.html"><a href="sec-panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>11.5.5</b> Individual-Specific Effects Model</a></li>
<li class="chapter" data-level="11.5.6" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-random-effects-estimator"><i class="fa fa-check"></i><b>11.5.6</b> Random Effects Estimator</a></li>
<li class="chapter" data-level="11.5.7" data-path="sec-panel-data.html"><a href="sec-panel-data.html#sec-fixed-effects-estimator"><i class="fa fa-check"></i><b>11.5.7</b> Fixed Effects Estimator</a></li>
<li class="chapter" data-level="11.5.8" data-path="sec-panel-data.html"><a href="sec-panel-data.html#tests-for-assumptions-in-panel-data-analysis"><i class="fa fa-check"></i><b>11.5.8</b> Tests for Assumptions in Panel Data Analysis</a></li>
<li class="chapter" data-level="11.5.9" data-path="sec-panel-data.html"><a href="sec-panel-data.html#model-selection-in-panel-data"><i class="fa fa-check"></i><b>11.5.9</b> Model Selection in Panel Data</a></li>
<li class="chapter" data-level="11.5.10" data-path="sec-panel-data.html"><a href="sec-panel-data.html#alternative-estimators"><i class="fa fa-check"></i><b>11.5.10</b> Alternative Estimators</a></li>
<li class="chapter" data-level="11.5.11" data-path="sec-panel-data.html"><a href="sec-panel-data.html#application-1"><i class="fa fa-check"></i><b>11.5.11</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="choosing-the-right-type-of-data.html"><a href="choosing-the-right-type-of-data.html"><i class="fa fa-check"></i><b>11.6</b> Choosing the Right Type of Data</a></li>
<li class="chapter" data-level="11.7" data-path="data-quality-and-ethical-considerations.html"><a href="data-quality-and-ethical-considerations.html"><i class="fa fa-check"></i><b>11.7</b> Data Quality and Ethical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>12</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>12.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization-z-score-normalization"><i class="fa fa-check"></i><b>12.1.1</b> Standardization (Z-score Normalization)</a></li>
<li class="chapter" data-level="12.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling-normalization"><i class="fa fa-check"></i><b>12.1.2</b> Min-Max Scaling (Normalization)</a></li>
<li class="chapter" data-level="12.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-root-and-cube-root-transformations"><i class="fa fa-check"></i><b>12.1.3</b> Square Root and Cube Root Transformations</a></li>
<li class="chapter" data-level="12.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-logarithmic-transformation"><i class="fa fa-check"></i><b>12.1.4</b> Logarithmic Transformation</a></li>
<li class="chapter" data-level="12.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential-transformation"><i class="fa fa-check"></i><b>12.1.5</b> Exponential Transformation</a></li>
<li class="chapter" data-level="12.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-transformation"><i class="fa fa-check"></i><b>12.1.6</b> Power Transformation</a></li>
<li class="chapter" data-level="12.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-reciprocal-transformation"><i class="fa fa-check"></i><b>12.1.7</b> Inverse (Reciprocal) Transformation</a></li>
<li class="chapter" data-level="12.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine-transformation"><i class="fa fa-check"></i><b>12.1.8</b> Hyperbolic Arcsine Transformation</a></li>
<li class="chapter" data-level="12.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-normalization-rank-based-transformation"><i class="fa fa-check"></i><b>12.1.9</b> Ordered Quantile Normalization (Rank-Based Transformation)</a></li>
<li class="chapter" data-level="12.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>12.1.10</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="12.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-transformation"><i class="fa fa-check"></i><b>12.1.11</b> Inverse Hyperbolic Sine Transformation</a></li>
<li class="chapter" data-level="12.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#sec-box-cox-transformation"><i class="fa fa-check"></i><b>12.1.12</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="12.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>12.1.13</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="12.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss-transformation"><i class="fa fa-check"></i><b>12.1.14</b> RankGauss Transformation</a></li>
<li class="chapter" data-level="12.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#automatically-choosing-the-best-transformation"><i class="fa fa-check"></i><b>12.1.15</b> Automatically Choosing the Best Transformation</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>12.2</b> Categorical Variables</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="categorical-variables.html"><a href="categorical-variables.html#one-hot-encoding-dummy-variables"><i class="fa fa-check"></i><b>12.2.1</b> One-Hot Encoding (Dummy Variables)</a></li>
<li class="chapter" data-level="12.2.2" data-path="categorical-variables.html"><a href="categorical-variables.html#label-encoding"><i class="fa fa-check"></i><b>12.2.2</b> Label Encoding</a></li>
<li class="chapter" data-level="12.2.3" data-path="categorical-variables.html"><a href="categorical-variables.html#feature-hashing-hash-encoding"><i class="fa fa-check"></i><b>12.2.3</b> Feature Hashing (Hash Encoding)</a></li>
<li class="chapter" data-level="12.2.4" data-path="categorical-variables.html"><a href="categorical-variables.html#binary-encoding"><i class="fa fa-check"></i><b>12.2.4</b> Binary Encoding</a></li>
<li class="chapter" data-level="12.2.5" data-path="categorical-variables.html"><a href="categorical-variables.html#base-n-encoding-generalized-binary-encoding"><i class="fa fa-check"></i><b>12.2.5</b> Base-N Encoding (Generalized Binary Encoding)</a></li>
<li class="chapter" data-level="12.2.6" data-path="categorical-variables.html"><a href="categorical-variables.html#frequency-encoding"><i class="fa fa-check"></i><b>12.2.6</b> Frequency Encoding</a></li>
<li class="chapter" data-level="12.2.7" data-path="categorical-variables.html"><a href="categorical-variables.html#target-encoding-mean-encoding"><i class="fa fa-check"></i><b>12.2.7</b> Target Encoding (Mean Encoding)</a></li>
<li class="chapter" data-level="12.2.8" data-path="categorical-variables.html"><a href="categorical-variables.html#ordinal-encoding"><i class="fa fa-check"></i><b>12.2.8</b> Ordinal Encoding</a></li>
<li class="chapter" data-level="12.2.9" data-path="categorical-variables.html"><a href="categorical-variables.html#weight-of-evidence-encoding"><i class="fa fa-check"></i><b>12.2.9</b> Weight of Evidence Encoding</a></li>
<li class="chapter" data-level="12.2.10" data-path="categorical-variables.html"><a href="categorical-variables.html#helmert-encoding"><i class="fa fa-check"></i><b>12.2.10</b> Helmert Encoding</a></li>
<li class="chapter" data-level="12.2.11" data-path="categorical-variables.html"><a href="categorical-variables.html#probability-ratio-encoding"><i class="fa fa-check"></i><b>12.2.11</b> Probability Ratio Encoding</a></li>
<li class="chapter" data-level="12.2.12" data-path="categorical-variables.html"><a href="categorical-variables.html#backward-difference-encoding"><i class="fa fa-check"></i><b>12.2.12</b> Backward Difference Encoding</a></li>
<li class="chapter" data-level="12.2.13" data-path="categorical-variables.html"><a href="categorical-variables.html#leave-one-out-encoding"><i class="fa fa-check"></i><b>12.2.13</b> Leave-One-Out Encoding</a></li>
<li class="chapter" data-level="12.2.14" data-path="categorical-variables.html"><a href="categorical-variables.html#james-stein-encoding"><i class="fa fa-check"></i><b>12.2.14</b> James-Stein Encoding</a></li>
<li class="chapter" data-level="12.2.15" data-path="categorical-variables.html"><a href="categorical-variables.html#m-estimator-encoding"><i class="fa fa-check"></i><b>12.2.15</b> M-Estimator Encoding</a></li>
<li class="chapter" data-level="12.2.16" data-path="categorical-variables.html"><a href="categorical-variables.html#thermometer-encoding"><i class="fa fa-check"></i><b>12.2.16</b> Thermometer Encoding</a></li>
<li class="chapter" data-level="12.2.17" data-path="categorical-variables.html"><a href="categorical-variables.html#choosing-the-right-encoding-method"><i class="fa fa-check"></i><b>12.2.17</b> Choosing the Right Encoding Method</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>13</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html"><i class="fa fa-check"></i><b>13.1</b> Introduction to Missing Data</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#types-of-imputation"><i class="fa fa-check"></i><b>13.1.1</b> Types of Imputation</a></li>
<li class="chapter" data-level="13.1.2" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#when-and-why-to-use-imputation"><i class="fa fa-check"></i><b>13.1.2</b> When and Why to Use Imputation</a></li>
<li class="chapter" data-level="13.1.3" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#importance-of-missing-data-treatment-in-statistical-modeling"><i class="fa fa-check"></i><b>13.1.3</b> Importance of Missing Data Treatment in Statistical Modeling</a></li>
<li class="chapter" data-level="13.1.4" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#prevalence-of-missing-data-across-domains"><i class="fa fa-check"></i><b>13.1.4</b> Prevalence of Missing Data Across Domains</a></li>
<li class="chapter" data-level="13.1.5" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#practical-considerations-for-imputation"><i class="fa fa-check"></i><b>13.1.5</b> Practical Considerations for Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html"><i class="fa fa-check"></i><b>13.2</b> Theoretical Foundations of Missing Data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#definition-and-classification-of-missing-data"><i class="fa fa-check"></i><b>13.2.1</b> Definition and Classification of Missing Data</a></li>
<li class="chapter" data-level="13.2.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>13.2.2</b> Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.2.3" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#relationship-between-mechanisms-and-ignorability"><i class="fa fa-check"></i><b>13.2.3</b> Relationship Between Mechanisms and Ignorability</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html"><i class="fa fa-check"></i><b>13.3</b> Diagnosing the Missing Data Mechanism</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#descriptive-methods"><i class="fa fa-check"></i><b>13.3.1</b> Descriptive Methods</a></li>
<li class="chapter" data-level="13.3.2" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#statistical-tests-for-missing-data-mechanisms"><i class="fa fa-check"></i><b>13.3.2</b> Statistical Tests for Missing Data Mechanisms</a></li>
<li class="chapter" data-level="13.3.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#assessing-mar-and-mnar"><i class="fa fa-check"></i><b>13.3.3</b> Assessing MAR and MNAR</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html"><i class="fa fa-check"></i><b>13.4</b> Methods for Handling Missing Data</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#basic-methods"><i class="fa fa-check"></i><b>13.4.1</b> Basic Methods</a></li>
<li class="chapter" data-level="13.4.2" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#single-imputation-techniques"><i class="fa fa-check"></i><b>13.4.2</b> Single Imputation Techniques</a></li>
<li class="chapter" data-level="13.4.3" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#machine-learning-and-modern-approaches"><i class="fa fa-check"></i><b>13.4.3</b> Machine Learning and Modern Approaches</a></li>
<li class="chapter" data-level="13.4.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>13.4.4</b> Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html"><i class="fa fa-check"></i><b>13.5</b> Evaluation of Imputation Methods</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#statistical-metrics-for-assessing-imputation-quality"><i class="fa fa-check"></i><b>13.5.1</b> Statistical Metrics for Assessing Imputation Quality</a></li>
<li class="chapter" data-level="13.5.2" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#bias-variance-tradeoff-in-imputation"><i class="fa fa-check"></i><b>13.5.2</b> Bias-Variance Tradeoff in Imputation</a></li>
<li class="chapter" data-level="13.5.3" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>13.5.3</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="13.5.4" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#validation-using-simulated-data-and-real-world-case-studies"><i class="fa fa-check"></i><b>13.5.4</b> Validation Using Simulated Data and Real-World Case Studies</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>13.6</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="13.7" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html"><i class="fa fa-check"></i><b>13.7</b> Challenges and Ethical Considerations</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#challenges-in-high-dimensional-data"><i class="fa fa-check"></i><b>13.7.1</b> Challenges in High-Dimensional Data</a></li>
<li class="chapter" data-level="13.7.2" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#missing-data-in-big-data-contexts"><i class="fa fa-check"></i><b>13.7.2</b> Missing Data in Big Data Contexts</a></li>
<li class="chapter" data-level="13.7.3" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#ethical-concerns"><i class="fa fa-check"></i><b>13.7.3</b> Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html"><i class="fa fa-check"></i><b>13.8</b> Emerging Trends in Missing Data Handling</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#advances-in-neural-network-approaches"><i class="fa fa-check"></i><b>13.8.1</b> Advances in Neural Network Approaches</a></li>
<li class="chapter" data-level="13.8.2" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#integration-with-reinforcement-learning"><i class="fa fa-check"></i><b>13.8.2</b> Integration with Reinforcement Learning</a></li>
<li class="chapter" data-level="13.8.3" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#synthetic-data-generation-for-missing-data"><i class="fa fa-check"></i><b>13.8.3</b> Synthetic Data Generation for Missing Data</a></li>
<li class="chapter" data-level="13.8.4" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#federated-learning-and-privacy-preserving-imputation"><i class="fa fa-check"></i><b>13.8.4</b> Federated Learning and Privacy-Preserving Imputation</a></li>
<li class="chapter" data-level="13.8.5" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#imputation-in-streaming-and-online-data-environments"><i class="fa fa-check"></i><b>13.8.5</b> Imputation in Streaming and Online Data Environments</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html"><i class="fa fa-check"></i><b>13.9</b> Application of Imputation</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="application-of-imputation.html"><a href="application-of-imputation.html#visualizing-missing-data"><i class="fa fa-check"></i><b>13.9.1</b> Visualizing Missing Data</a></li>
<li class="chapter" data-level="13.9.2" data-path="application-of-imputation.html"><a href="application-of-imputation.html#how-many-imputations"><i class="fa fa-check"></i><b>13.9.2</b> How Many Imputations?</a></li>
<li class="chapter" data-level="13.9.3" data-path="application-of-imputation.html"><a href="application-of-imputation.html#generating-missing-data-for-demonstration"><i class="fa fa-check"></i><b>13.9.3</b> Generating Missing Data for Demonstration</a></li>
<li class="chapter" data-level="13.9.4" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-mean-median-and-mode"><i class="fa fa-check"></i><b>13.9.4</b> Imputation with Mean, Median, and Mode</a></li>
<li class="chapter" data-level="13.9.5" data-path="application-of-imputation.html"><a href="application-of-imputation.html#k-nearest-neighbors-knn-imputation"><i class="fa fa-check"></i><b>13.9.5</b> K-Nearest Neighbors (KNN) Imputation</a></li>
<li class="chapter" data-level="13.9.6" data-path="application-of-imputation.html"><a href="application-of-imputation.html#imputation-with-decision-trees-rpart"><i class="fa fa-check"></i><b>13.9.6</b> Imputation with Decision Trees (rpart)</a></li>
<li class="chapter" data-level="13.9.7" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>13.9.7</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="13.9.8" data-path="application-of-imputation.html"><a href="application-of-imputation.html#amelia"><i class="fa fa-check"></i><b>13.9.8</b> Amelia</a></li>
<li class="chapter" data-level="13.9.9" data-path="application-of-imputation.html"><a href="application-of-imputation.html#missforest"><i class="fa fa-check"></i><b>13.9.9</b> missForest</a></li>
<li class="chapter" data-level="13.9.10" data-path="application-of-imputation.html"><a href="application-of-imputation.html#hmisc"><i class="fa fa-check"></i><b>13.9.10</b> Hmisc</a></li>
<li class="chapter" data-level="13.9.11" data-path="application-of-imputation.html"><a href="application-of-imputation.html#mi"><i class="fa fa-check"></i><b>13.9.11</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="model-specification-tests.html"><a href="model-specification-tests.html"><i class="fa fa-check"></i><b>14</b> Model Specification Tests</a>
<ul>
<li class="chapter" data-level="14.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html"><i class="fa fa-check"></i><b>14.1</b> Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-wald-test-nested"><i class="fa fa-check"></i><b>14.1.1</b> Wald Test</a></li>
<li class="chapter" data-level="14.1.2" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-likelihood-ratio-test-nested"><i class="fa fa-check"></i><b>14.1.2</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="14.1.3" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-f-test-for-linear-regression-nested"><i class="fa fa-check"></i><b>14.1.3</b> F-Test (for Linear Regression)</a></li>
<li class="chapter" data-level="14.1.4" data-path="nested-model-tests.html"><a href="nested-model-tests.html#sec-chow-test"><i class="fa fa-check"></i><b>14.1.4</b> Chow Test</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html"><i class="fa fa-check"></i><b>14.2</b> Non-Nested Model Tests</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-vuong-test"><i class="fa fa-check"></i><b>14.2.1</b> Vuong Test</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#sec-davidson--mackinnon-j-test"><i class="fa fa-check"></i><b>14.2.2</b> Davidson–MacKinnon J-Test</a></li>
<li class="chapter" data-level="14.2.3" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#adjusted-r2"><i class="fa fa-check"></i><b>14.2.3</b> Adjusted <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="14.2.4" data-path="non-nested-model-tests.html"><a href="non-nested-model-tests.html#comparing-models-with-transformed-dependent-variables"><i class="fa fa-check"></i><b>14.2.4</b> Comparing Models with Transformed Dependent Variables</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html"><i class="fa fa-check"></i><b>14.3</b> Heteroskedasticity Tests</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-breusch--pagan-test"><i class="fa fa-check"></i><b>14.3.1</b> Breusch–Pagan Test</a></li>
<li class="chapter" data-level="14.3.2" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-white-test-hetero"><i class="fa fa-check"></i><b>14.3.2</b> White Test</a></li>
<li class="chapter" data-level="14.3.3" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-goldfeld--quandt-test"><i class="fa fa-check"></i><b>14.3.3</b> Goldfeld–Quandt Test</a></li>
<li class="chapter" data-level="14.3.4" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-park-test"><i class="fa fa-check"></i><b>14.3.4</b> Park Test</a></li>
<li class="chapter" data-level="14.3.5" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#sec-glejser-test"><i class="fa fa-check"></i><b>14.3.5</b> Glejser Test</a></li>
<li class="chapter" data-level="14.3.6" data-path="heteroskedasticity-tests.html"><a href="heteroskedasticity-tests.html#summary-of-heteroskedasticity-tests"><i class="fa fa-check"></i><b>14.3.6</b> Summary of Heteroskedasticity Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html"><i class="fa fa-check"></i><b>14.4</b> Functional Form Tests</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-ramsey-reset-test"><i class="fa fa-check"></i><b>14.4.1</b> Ramsey RESET Test (Regression Equation Specification Error Test)</a></li>
<li class="chapter" data-level="14.4.2" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-harvey--collier-test"><i class="fa fa-check"></i><b>14.4.2</b> Harvey–Collier Test</a></li>
<li class="chapter" data-level="14.4.3" data-path="functional-form-tests.html"><a href="functional-form-tests.html#sec-rainbow-test"><i class="fa fa-check"></i><b>14.4.3</b> Rainbow Test</a></li>
<li class="chapter" data-level="14.4.4" data-path="functional-form-tests.html"><a href="functional-form-tests.html#summary-of-functional-form-tests"><i class="fa fa-check"></i><b>14.4.4</b> Summary of Functional Form Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html"><i class="fa fa-check"></i><b>14.5</b> Autocorrelation Tests</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-durbin--watson-test"><i class="fa fa-check"></i><b>14.5.1</b> Durbin–Watson Test</a></li>
<li class="chapter" data-level="14.5.2" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-breusch--godfrey-test"><i class="fa fa-check"></i><b>14.5.2</b> Breusch–Godfrey Test</a></li>
<li class="chapter" data-level="14.5.3" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-ljung--box-test"><i class="fa fa-check"></i><b>14.5.3</b> Ljung–Box Test (or Box–Pierce Test)</a></li>
<li class="chapter" data-level="14.5.4" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#sec-runs-test"><i class="fa fa-check"></i><b>14.5.4</b> Runs Test</a></li>
<li class="chapter" data-level="14.5.5" data-path="autocorrelation-tests.html"><a href="autocorrelation-tests.html#summary-of-autocorrelation-tests"><i class="fa fa-check"></i><b>14.5.5</b> Summary of Autocorrelation Tests</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html"><i class="fa fa-check"></i><b>14.6</b> Multicollinearity Diagnostics</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-variance-inflation-factor"><i class="fa fa-check"></i><b>14.6.1</b> Variance Inflation Factor</a></li>
<li class="chapter" data-level="14.6.2" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-tolerance-statistic"><i class="fa fa-check"></i><b>14.6.2</b> Tolerance Statistic</a></li>
<li class="chapter" data-level="14.6.3" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-condition-index-and-eigenvalue-decomposition"><i class="fa fa-check"></i><b>14.6.3</b> Condition Index and Eigenvalue Decomposition</a></li>
<li class="chapter" data-level="14.6.4" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-pairwise-correlation-matrix"><i class="fa fa-check"></i><b>14.6.4</b> Pairwise Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.5" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#sec-determinant-of-the-correlation-matrix"><i class="fa fa-check"></i><b>14.6.5</b> Determinant of the Correlation Matrix</a></li>
<li class="chapter" data-level="14.6.6" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#summary-of-multicollinearity-diagnostics"><i class="fa fa-check"></i><b>14.6.6</b> Summary of Multicollinearity Diagnostics</a></li>
<li class="chapter" data-level="14.6.7" data-path="multicollinearity-diagnostics.html"><a href="multicollinearity-diagnostics.html#addressing-multicollinearity"><i class="fa fa-check"></i><b>14.6.7</b> Addressing Multicollinearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i><b>15</b> Variable Selection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html"><i class="fa fa-check"></i><b>15.1</b> Filter Methods (Statistical Criteria, Model-Agnostic)</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#information-criteria-based-selection"><i class="fa fa-check"></i><b>15.1.1</b> Information Criteria-Based Selection</a></li>
<li class="chapter" data-level="15.1.2" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#univariate-selection-methods"><i class="fa fa-check"></i><b>15.1.2</b> Univariate Selection Methods</a></li>
<li class="chapter" data-level="15.1.3" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#correlation-based-feature-selection"><i class="fa fa-check"></i><b>15.1.3</b> Correlation-Based Feature Selection</a></li>
<li class="chapter" data-level="15.1.4" data-path="sec-filter-methods.html"><a href="sec-filter-methods.html#variance-thresholding"><i class="fa fa-check"></i><b>15.1.4</b> Variance Thresholding</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html"><i class="fa fa-check"></i><b>15.2</b> Wrapper Methods (Model-Based Subset Evaluation)</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#best-subsets-algorithm-1"><i class="fa fa-check"></i><b>15.2.1</b> Best Subsets Algorithm</a></li>
<li class="chapter" data-level="15.2.2" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#stepwise-selection-methods-1"><i class="fa fa-check"></i><b>15.2.2</b> Stepwise Selection Methods</a></li>
<li class="chapter" data-level="15.2.3" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#branch-and-bound-algorithm-1"><i class="fa fa-check"></i><b>15.2.3</b> Branch-and-Bound Algorithm</a></li>
<li class="chapter" data-level="15.2.4" data-path="wrapper-methods-model-based-subset-evaluation.html"><a href="wrapper-methods-model-based-subset-evaluation.html#recursive-feature-elimination"><i class="fa fa-check"></i><b>15.2.4</b> Recursive Feature Elimination</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html"><i class="fa fa-check"></i><b>15.3</b> Embedded Methods (Integrated into Model Training)</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#regularization-based-selection"><i class="fa fa-check"></i><b>15.3.1</b> Regularization-Based Selection</a></li>
<li class="chapter" data-level="15.3.2" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#tree-based-feature-importance"><i class="fa fa-check"></i><b>15.3.2</b> Tree-Based Feature Importance</a></li>
<li class="chapter" data-level="15.3.3" data-path="embedded-methods-integrated-into-model-training.html"><a href="embedded-methods-integrated-into-model-training.html#genetic-algorithms-1"><i class="fa fa-check"></i><b>15.3.3</b> Genetic Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="summary-table-1.html"><a href="summary-table-1.html"><i class="fa fa-check"></i><b>15.4</b> Summary Table</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>16</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>16.1</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#error-types-in-hypothesis-testing"><i class="fa fa-check"></i><b>16.1.1</b> Error Types in Hypothesis Testing</a></li>
<li class="chapter" data-level="16.1.2" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#hypothesis-testing-framework-1"><i class="fa fa-check"></i><b>16.1.2</b> Hypothesis Testing Framework</a></li>
<li class="chapter" data-level="16.1.3" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#interpreting-hypothesis-testing-results"><i class="fa fa-check"></i><b>16.1.3</b> Interpreting Hypothesis Testing Results</a></li>
<li class="chapter" data-level="16.1.4" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#understanding-p-values"><i class="fa fa-check"></i><b>16.1.4</b> Understanding p-Values</a></li>
<li class="chapter" data-level="16.1.5" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#the-role-of-sample-size"><i class="fa fa-check"></i><b>16.1.5</b> The Role of Sample Size</a></li>
<li class="chapter" data-level="16.1.6" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#p-value-hacking"><i class="fa fa-check"></i><b>16.1.6</b> p-Value Hacking</a></li>
<li class="chapter" data-level="16.1.7" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#practical-vs.-statistical-significance"><i class="fa fa-check"></i><b>16.1.7</b> Practical vs. Statistical Significance</a></li>
<li class="chapter" data-level="16.1.8" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#mitigating-the-misuse-of-p-values"><i class="fa fa-check"></i><b>16.1.8</b> Mitigating the Misuse of p-Values</a></li>
<li class="chapter" data-level="16.1.9" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-wald-test"><i class="fa fa-check"></i><b>16.1.9</b> Wald Test</a></li>
<li class="chapter" data-level="16.1.10" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#sec-likelihood-ratio-test"><i class="fa fa-check"></i><b>16.1.10</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="16.1.11" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#lagrange-multiplier-score"><i class="fa fa-check"></i><b>16.1.11</b> Lagrange Multiplier (Score) Test</a></li>
<li class="chapter" data-level="16.1.12" data-path="sec-null-hypothesis-significance-testing.html"><a href="sec-null-hypothesis-significance-testing.html#comparing-hypothesis-tests"><i class="fa fa-check"></i><b>16.1.12</b> Comparing Hypothesis Tests</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html"><i class="fa fa-check"></i><b>16.2</b> Two One-Sided Tests Equivalence Testing</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-to-use-tost"><i class="fa fa-check"></i><b>16.2.1</b> When to Use TOST?</a></li>
<li class="chapter" data-level="16.2.2" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#interpretation-of-the-tost-procedure"><i class="fa fa-check"></i><b>16.2.2</b> Interpretation of the TOST Procedure</a></li>
<li class="chapter" data-level="16.2.3" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#relationship-to-confidence-intervals"><i class="fa fa-check"></i><b>16.2.3</b> Relationship to Confidence Intervals</a></li>
<li class="chapter" data-level="16.2.4" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#example-1-testing-the-equivalence-of-two-means"><i class="fa fa-check"></i><b>16.2.4</b> Example 1: Testing the Equivalence of Two Means</a></li>
<li class="chapter" data-level="16.2.5" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#advantages-of-tost-equivalence-testing"><i class="fa fa-check"></i><b>16.2.5</b> Advantages of TOST Equivalence Testing</a></li>
<li class="chapter" data-level="16.2.6" data-path="sec-two-one-sided-tests-equivalence-testing.html"><a href="sec-two-one-sided-tests-equivalence-testing.html#when-not-to-use-tost"><i class="fa fa-check"></i><b>16.2.6</b> When <em>Not</em> to Use TOST</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html"><i class="fa fa-check"></i><b>16.3</b> False Discovery Rate</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-hochberg-procedure"><i class="fa fa-check"></i><b>16.3.1</b> Benjamini-Hochberg Procedure</a></li>
<li class="chapter" data-level="16.3.2" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-benjamini-yekutieli-procedure"><i class="fa fa-check"></i><b>16.3.2</b> Benjamini-Yekutieli Procedure</a></li>
<li class="chapter" data-level="16.3.3" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#sec-storeys-q-value-approach"><i class="fa fa-check"></i><b>16.3.3</b> Storey’s q-value Approach</a></li>
<li class="chapter" data-level="16.3.4" data-path="sec-false-discovery-rate.html"><a href="sec-false-discovery-rate.html#summary-false-discovery-rate-methods"><i class="fa fa-check"></i><b>16.3.4</b> Summary: False Discovery Rate Methods</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="comparison-of-testing-frameworks.html"><a href="comparison-of-testing-frameworks.html"><i class="fa fa-check"></i><b>16.4</b> Comparison of Testing Frameworks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="sec-marginal-effects.html"><a href="sec-marginal-effects.html"><i class="fa fa-check"></i><b>17</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html"><i class="fa fa-check"></i><b>17.1</b> Definition of Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-analytical-derivation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.1</b> Analytical Derivation of Marginal Effects</a></li>
<li class="chapter" data-level="17.1.2" data-path="definition-of-marginal-effects.html"><a href="definition-of-marginal-effects.html#sec-numerical-approximation-of-marginal-effects"><i class="fa fa-check"></i><b>17.1.2</b> Numerical Approximation of Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="marginal-effects-in-different-contexts.html"><a href="marginal-effects-in-different-contexts.html"><i class="fa fa-check"></i><b>17.2</b> Marginal Effects in Different Contexts</a></li>
<li class="chapter" data-level="17.3" data-path="marginal-effects-interpretation.html"><a href="marginal-effects-interpretation.html"><i class="fa fa-check"></i><b>17.3</b> Marginal Effects Interpretation</a></li>
<li class="chapter" data-level="17.4" data-path="sec-delta-method.html"><a href="sec-delta-method.html"><i class="fa fa-check"></i><b>17.4</b> Delta Method</a></li>
<li class="chapter" data-level="17.5" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html"><i class="fa fa-check"></i><b>17.5</b> Comparison: Delta Method vs. Alternative Approaches</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="comparison-delta-method-vs.-alternative-approaches.html"><a href="comparison-delta-method-vs.-alternative-approaches.html#example-applying-the-delta-method-in-a-logistic-regression"><i class="fa fa-check"></i><b>17.5.1</b> Example: Applying the Delta Method in a logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html"><i class="fa fa-check"></i><b>17.6</b> Types of Marginal Effect</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-average-marginal-effect"><i class="fa fa-check"></i><b>17.6.1</b> Average Marginal Effect</a></li>
<li class="chapter" data-level="17.6.2" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-mean"><i class="fa fa-check"></i><b>17.6.2</b> Marginal Effects at the Mean</a></li>
<li class="chapter" data-level="17.6.3" data-path="types-of-marginal-effect.html"><a href="types-of-marginal-effect.html#sec-marginal-effects-at-the-average"><i class="fa fa-check"></i><b>17.6.3</b> Marginal Effects at the Average</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html"><i class="fa fa-check"></i><b>17.7</b> Packages for Marginal Effects</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#marginaleffects-package-recommended"><i class="fa fa-check"></i><b>17.7.1</b> <code>marginaleffects</code> Package (Recommended)</a></li>
<li class="chapter" data-level="17.7.2" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#margins-package"><i class="fa fa-check"></i><b>17.7.2</b> <code>margins</code> Package</a></li>
<li class="chapter" data-level="17.7.3" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#mfx-package"><i class="fa fa-check"></i><b>17.7.3</b> <code>mfx</code> Package</a></li>
<li class="chapter" data-level="17.7.4" data-path="packages-for-marginal-effects.html"><a href="packages-for-marginal-effects.html#comparison-of-packages"><i class="fa fa-check"></i><b>17.7.4</b> Comparison of Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>18</b> Moderation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="types-of-moderation-analyses.html"><a href="types-of-moderation-analyses.html"><i class="fa fa-check"></i><b>18.1</b> Types of Moderation Analyses</a></li>
<li class="chapter" data-level="18.2" data-path="key-terminology.html"><a href="key-terminology.html"><i class="fa fa-check"></i><b>18.2</b> Key Terminology</a></li>
<li class="chapter" data-level="18.3" data-path="moderation-model.html"><a href="moderation-model.html"><i class="fa fa-check"></i><b>18.3</b> Moderation Model</a></li>
<li class="chapter" data-level="18.4" data-path="types-of-interactions.html"><a href="types-of-interactions.html"><i class="fa fa-check"></i><b>18.4</b> Types of Interactions</a></li>
<li class="chapter" data-level="18.5" data-path="three-way-interactions.html"><a href="three-way-interactions.html"><i class="fa fa-check"></i><b>18.5</b> Three-Way Interactions</a></li>
<li class="chapter" data-level="18.6" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>18.6</b> Additional Resources</a></li>
<li class="chapter" data-level="18.7" data-path="application-2.html"><a href="application-2.html"><i class="fa fa-check"></i><b>18.7</b> Application</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="application-2.html"><a href="application-2.html#emmeans-package"><i class="fa fa-check"></i><b>18.7.1</b> <code>emmeans</code> Package</a></li>
<li class="chapter" data-level="18.7.2" data-path="application-2.html"><a href="application-2.html#probemod-package"><i class="fa fa-check"></i><b>18.7.2</b> <code>probemod</code> Package</a></li>
<li class="chapter" data-level="18.7.3" data-path="application-2.html"><a href="application-2.html#interactions-package"><i class="fa fa-check"></i><b>18.7.3</b> <code>interactions</code> Package</a></li>
<li class="chapter" data-level="18.7.4" data-path="application-2.html"><a href="application-2.html#interactionr-package"><i class="fa fa-check"></i><b>18.7.4</b> <code>interactionR</code> Package</a></li>
<li class="chapter" data-level="18.7.5" data-path="application-2.html"><a href="application-2.html#sjplot-package"><i class="fa fa-check"></i><b>18.7.5</b> <code>sjPlot</code> Package</a></li>
<li class="chapter" data-level="18.7.6" data-path="application-2.html"><a href="application-2.html#summary-of-moderation-analysis-packages"><i class="fa fa-check"></i><b>18.7.6</b> Summary of Moderation Analysis Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>19</b> Mediation</a>
<ul>
<li class="chapter" data-level="19.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>19.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#steps-in-the-traditional-mediation-model"><i class="fa fa-check"></i><b>19.1.1</b> Steps in the Traditional Mediation Model</a></li>
<li class="chapter" data-level="19.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#graphical-representation-of-mediation"><i class="fa fa-check"></i><b>19.1.2</b> Graphical Representation of Mediation</a></li>
<li class="chapter" data-level="19.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#measuring-mediation"><i class="fa fa-check"></i><b>19.1.3</b> Measuring Mediation</a></li>
<li class="chapter" data-level="19.1.4" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-linear-mediation-models"><i class="fa fa-check"></i><b>19.1.4</b> Assumptions in Linear Mediation Models</a></li>
<li class="chapter" data-level="19.1.5" data-path="traditional-approach.html"><a href="traditional-approach.html#testing-for-mediation"><i class="fa fa-check"></i><b>19.1.5</b> Testing for Mediation</a></li>
<li class="chapter" data-level="19.1.6" data-path="traditional-approach.html"><a href="traditional-approach.html#additional-considerations"><i class="fa fa-check"></i><b>19.1.6</b> Additional Considerations</a></li>
<li class="chapter" data-level="19.1.7" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-in-mediation-analysis"><i class="fa fa-check"></i><b>19.1.7</b> Assumptions in Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.8" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>19.1.8</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="19.1.9" data-path="traditional-approach.html"><a href="traditional-approach.html#power-analysis-for-mediation"><i class="fa fa-check"></i><b>19.1.9</b> Power Analysis for Mediation</a></li>
<li class="chapter" data-level="19.1.10" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation-analysis"><i class="fa fa-check"></i><b>19.1.10</b> Multiple Mediation Analysis</a></li>
<li class="chapter" data-level="19.1.11" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-treatments-in-mediation"><i class="fa fa-check"></i><b>19.1.11</b> Multiple Treatments in Mediation</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html"><i class="fa fa-check"></i><b>19.2</b> Causal Inference Approach to Mediation</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#sec-example-traditional-mediation-analysis"><i class="fa fa-check"></i><b>19.2.1</b> Example: Traditional Mediation Analysis</a></li>
<li class="chapter" data-level="19.2.2" data-path="causal-inference-approach-to-mediation.html"><a href="causal-inference-approach-to-mediation.html#two-approaches-in-causal-mediation-analysis"><i class="fa fa-check"></i><b>19.2.2</b> Two Approaches in Causal Mediation Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>20</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="20.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html"><i class="fa fa-check"></i><b>20.1</b> Conceptual Framing</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="conceptual-framing.html"><a href="conceptual-framing.html#predictive-modeling"><i class="fa fa-check"></i><b>20.1.1</b> Predictive Modeling</a></li>
<li class="chapter" data-level="20.1.2" data-path="conceptual-framing.html"><a href="conceptual-framing.html#estimation-or-causal-inference"><i class="fa fa-check"></i><b>20.1.2</b> Estimation or Causal Inference</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html"><i class="fa fa-check"></i><b>20.2</b> Mathematical Setup</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="mathematical-setup.html"><a href="mathematical-setup.html#probability-space-and-data"><i class="fa fa-check"></i><b>20.2.1</b> Probability Space and Data</a></li>
<li class="chapter" data-level="20.2.2" data-path="mathematical-setup.html"><a href="mathematical-setup.html#loss-functions-and-risk"><i class="fa fa-check"></i><b>20.2.2</b> Loss Functions and Risk</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html"><i class="fa fa-check"></i><b>20.3</b> Prediction in Detail</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#empirical-risk-minimization-and-generalization"><i class="fa fa-check"></i><b>20.3.1</b> Empirical Risk Minimization and Generalization</a></li>
<li class="chapter" data-level="20.3.2" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#bias-variance-decomposition"><i class="fa fa-check"></i><b>20.3.2</b> Bias-Variance Decomposition</a></li>
<li class="chapter" data-level="20.3.3" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#example-linear-regression-for-prediction"><i class="fa fa-check"></i><b>20.3.3</b> Example: Linear Regression for Prediction</a></li>
<li class="chapter" data-level="20.3.4" data-path="prediction-in-detail.html"><a href="prediction-in-detail.html#applications-in-economics"><i class="fa fa-check"></i><b>20.3.4</b> Applications in Economics</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html"><i class="fa fa-check"></i><b>20.4</b> Parameter Estimation and Causal Inference</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#estimation-in-parametric-models"><i class="fa fa-check"></i><b>20.4.1</b> Estimation in Parametric Models</a></li>
<li class="chapter" data-level="20.4.2" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#causal-inference-fundamentals"><i class="fa fa-check"></i><b>20.4.2</b> Causal Inference Fundamentals</a></li>
<li class="chapter" data-level="20.4.3" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#role-of-identification"><i class="fa fa-check"></i><b>20.4.3</b> Role of Identification</a></li>
<li class="chapter" data-level="20.4.4" data-path="parameter-estimation-and-causal-inference.html"><a href="parameter-estimation-and-causal-inference.html#challenges-1"><i class="fa fa-check"></i><b>20.4.4</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>20.5</b> Causation versus Prediction</a></li>
<li class="chapter" data-level="20.6" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html"><i class="fa fa-check"></i><b>20.6</b> Illustrative Equations and Mathematical Contrasts</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#risk-minimization-vs.-consistency"><i class="fa fa-check"></i><b>20.6.1</b> Risk Minimization vs. Consistency</a></li>
<li class="chapter" data-level="20.6.2" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#partial-derivatives-vs.-predictions"><i class="fa fa-check"></i><b>20.6.2</b> Partial Derivatives vs. Predictions</a></li>
<li class="chapter" data-level="20.6.3" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#example-high-dimensional-regularization"><i class="fa fa-check"></i><b>20.6.3</b> Example: High-Dimensional Regularization</a></li>
<li class="chapter" data-level="20.6.4" data-path="illustrative-equations-and-mathematical-contrasts.html"><a href="illustrative-equations-and-mathematical-contrasts.html#potential-outcomes-notation"><i class="fa fa-check"></i><b>20.6.4</b> Potential Outcomes Notation</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html"><i class="fa fa-check"></i><b>20.7</b> Extended Mathematical Points</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#m-estimation-and-asymptotic-theory"><i class="fa fa-check"></i><b>20.7.1</b> M-Estimation and Asymptotic Theory</a></li>
<li class="chapter" data-level="20.7.2" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#the-danger-of-omitted-variables"><i class="fa fa-check"></i><b>20.7.2</b> The Danger of Omitted Variables</a></li>
<li class="chapter" data-level="20.7.3" data-path="extended-mathematical-points.html"><a href="extended-mathematical-points.html#cross-validation-vs.-statistical-testing"><i class="fa fa-check"></i><b>20.7.3</b> Cross-Validation vs. Statistical Testing</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="putting-it-all-together-comparing-objectives.html"><a href="putting-it-all-together-comparing-objectives.html"><i class="fa fa-check"></i><b>20.8</b> Putting It All Together: Comparing Objectives</a></li>
<li class="chapter" data-level="20.9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>20.9</b> Conclusion</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="21" data-path="sec-causal-inference.html"><a href="sec-causal-inference.html"><i class="fa fa-check"></i><b>21</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="21.1" data-path="sec-the-ladder-of-causation.html"><a href="sec-the-ladder-of-causation.html"><i class="fa fa-check"></i><b>21.1</b> The Ladder of Causation</a></li>
<li class="chapter" data-level="21.2" data-path="the-formal-notation-of-causality.html"><a href="the-formal-notation-of-causality.html"><i class="fa fa-check"></i><b>21.2</b> The Formal Notation of Causality</a></li>
<li class="chapter" data-level="21.3" data-path="the-7-tools-of-structural-causal-models.html"><a href="the-7-tools-of-structural-causal-models.html"><i class="fa fa-check"></i><b>21.3</b> The 7 Tools of Structural Causal Models</a></li>
<li class="chapter" data-level="21.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html"><i class="fa fa-check"></i><b>21.4</b> Simpson’s Paradox</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#what-is-simpsons-paradox"><i class="fa fa-check"></i><b>21.4.1</b> What is Simpson’s Paradox?</a></li>
<li class="chapter" data-level="21.4.2" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-is-this-important"><i class="fa fa-check"></i><b>21.4.2</b> Why is this Important?</a></li>
<li class="chapter" data-level="21.4.3" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#comparison-between-simpsons-paradox-and-omitted-variable-bias"><i class="fa fa-check"></i><b>21.4.3</b> Comparison between Simpson’s Paradox and Omitted Variable Bias</a></li>
<li class="chapter" data-level="21.4.4" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#illustrating-simpsons-paradox-marketing-campaign-success-rates"><i class="fa fa-check"></i><b>21.4.4</b> Illustrating Simpson’s Paradox: Marketing Campaign Success Rates</a></li>
<li class="chapter" data-level="21.4.5" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#why-does-this-happen"><i class="fa fa-check"></i><b>21.4.5</b> Why Does This Happen?</a></li>
<li class="chapter" data-level="21.4.6" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#how-does-causal-inference-solve-this"><i class="fa fa-check"></i><b>21.4.6</b> How Does Causal Inference Solve This?</a></li>
<li class="chapter" data-level="21.4.7" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#correcting-simpsons-paradox-with-regression-adjustment"><i class="fa fa-check"></i><b>21.4.7</b> Correcting Simpson’s Paradox with Regression Adjustment</a></li>
<li class="chapter" data-level="21.4.8" data-path="simpsons-paradox.html"><a href="simpsons-paradox.html#key-takeaways-3"><i class="fa fa-check"></i><b>21.4.8</b> Key Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="additional-resources-1.html"><a href="additional-resources-1.html"><i class="fa fa-check"></i><b>21.5</b> Additional Resources</a></li>
<li class="chapter" data-level="21.6" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html"><i class="fa fa-check"></i><b>21.6</b> Experimental vs. Quasi-Experimental Designs</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="experimental-vs.-quasi-experimental-designs.html"><a href="experimental-vs.-quasi-experimental-designs.html#criticisms-of-quasi-experimental-designs"><i class="fa fa-check"></i><b>21.6.1</b> Criticisms of Quasi-Experimental Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="hierarchical-ordering-of-causal-tools.html"><a href="hierarchical-ordering-of-causal-tools.html"><i class="fa fa-check"></i><b>21.7</b> Hierarchical Ordering of Causal Tools</a></li>
<li class="chapter" data-level="21.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html"><i class="fa fa-check"></i><b>21.8</b> Types of Validity in Research</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-measurement-validity"><i class="fa fa-check"></i><b>21.8.1</b> Measurement Validity</a></li>
<li class="chapter" data-level="21.8.2" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-construct-validity"><i class="fa fa-check"></i><b>21.8.2</b> Construct Validity</a></li>
<li class="chapter" data-level="21.8.3" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-criterion-validity"><i class="fa fa-check"></i><b>21.8.3</b> Criterion Validity</a></li>
<li class="chapter" data-level="21.8.4" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-internal-validity"><i class="fa fa-check"></i><b>21.8.4</b> Internal Validity</a></li>
<li class="chapter" data-level="21.8.5" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-external-validity"><i class="fa fa-check"></i><b>21.8.5</b> External Validity</a></li>
<li class="chapter" data-level="21.8.6" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-ecological-validity"><i class="fa fa-check"></i><b>21.8.6</b> Ecological Validity</a></li>
<li class="chapter" data-level="21.8.7" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#sec-statistical-conclusion-validity"><i class="fa fa-check"></i><b>21.8.7</b> Statistical Conclusion Validity</a></li>
<li class="chapter" data-level="21.8.8" data-path="types-of-validity-in-research.html"><a href="types-of-validity-in-research.html#putting-it-all-together"><i class="fa fa-check"></i><b>21.8.8</b> Putting It All Together</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html"><i class="fa fa-check"></i><b>21.9</b> Types of Subjects in a Treatment Setting</a>
<ul>
<li class="chapter" data-level="21.9.1" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#non-switchers"><i class="fa fa-check"></i><b>21.9.1</b> Non-Switchers</a></li>
<li class="chapter" data-level="21.9.2" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#switchers"><i class="fa fa-check"></i><b>21.9.2</b> Switchers</a></li>
<li class="chapter" data-level="21.9.3" data-path="types-of-subjects-in-a-treatment-setting.html"><a href="types-of-subjects-in-a-treatment-setting.html#classification-of-individuals-based-on-treatment-assignment"><i class="fa fa-check"></i><b>21.9.3</b> Classification of Individuals Based on Treatment Assignment</a></li>
</ul></li>
<li class="chapter" data-level="21.10" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html"><i class="fa fa-check"></i><b>21.10</b> Types of Treatment Effects</a>
<ul>
<li class="chapter" data-level="21.10.1" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-average-treatment-effect"><i class="fa fa-check"></i><b>21.10.1</b> Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.2" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-conditional-average-treatment-effect-"><i class="fa fa-check"></i><b>21.10.2</b> Conditional Average Treatment Effect</a></li>
<li class="chapter" data-level="21.10.3" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-intention-to-treat-effect"><i class="fa fa-check"></i><b>21.10.3</b> Intention-to-Treat Effect</a></li>
<li class="chapter" data-level="21.10.4" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-local-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.5" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.6" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>21.10.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="21.10.7" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-quantile-average-treatment-effects"><i class="fa fa-check"></i><b>21.10.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="21.10.8" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#sec-log-odds-treatment-effects-for-binary-outcomes"><i class="fa fa-check"></i><b>21.10.8</b> Log-Odds Treatment Effects for Binary Outcomes</a></li>
<li class="chapter" data-level="21.10.9" data-path="types-of-treatment-effects.html"><a href="types-of-treatment-effects.html#summary-table-treatment-effect-estimands"><i class="fa fa-check"></i><b>21.10.9</b> Summary Table: Treatment Effect Estimands</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="22" data-path="sec-experimental-design.html"><a href="sec-experimental-design.html"><i class="fa fa-check"></i><b>22</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="22.1" data-path="principles-of-experimental-design.html"><a href="principles-of-experimental-design.html"><i class="fa fa-check"></i><b>22.1</b> Principles of Experimental Design</a></li>
<li class="chapter" data-level="22.2" data-path="sec-the-gold-standard-randomized-controlled-trials.html"><a href="sec-the-gold-standard-randomized-controlled-trials.html"><i class="fa fa-check"></i><b>22.2</b> The Gold Standard: Randomized Controlled Trials</a></li>
<li class="chapter" data-level="22.3" data-path="selection-problem.html"><a href="selection-problem.html"><i class="fa fa-check"></i><b>22.3</b> Selection Problem</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="selection-problem.html"><a href="selection-problem.html#the-observed-difference-in-outcomes"><i class="fa fa-check"></i><b>22.3.1</b> The Observed Difference in Outcomes</a></li>
<li class="chapter" data-level="22.3.2" data-path="selection-problem.html"><a href="selection-problem.html#eliminating-selection-bias-with-random-assignment"><i class="fa fa-check"></i><b>22.3.2</b> Eliminating Selection Bias with Random Assignment</a></li>
<li class="chapter" data-level="22.3.3" data-path="selection-problem.html"><a href="selection-problem.html#another-representation-under-regression"><i class="fa fa-check"></i><b>22.3.3</b> Another Representation Under Regression</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html"><i class="fa fa-check"></i><b>22.4</b> Classical Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.4.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="22.4.2" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#randomized-block-design"><i class="fa fa-check"></i><b>22.4.2</b> Randomized Block Design</a></li>
<li class="chapter" data-level="22.4.3" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#factorial-design"><i class="fa fa-check"></i><b>22.4.3</b> Factorial Design</a></li>
<li class="chapter" data-level="22.4.4" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#crossover-design"><i class="fa fa-check"></i><b>22.4.4</b> Crossover Design</a></li>
<li class="chapter" data-level="22.4.5" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#split-plot-design"><i class="fa fa-check"></i><b>22.4.5</b> Split-Plot Design</a></li>
<li class="chapter" data-level="22.4.6" data-path="classical-experimental-designs.html"><a href="classical-experimental-designs.html#latin-square-design"><i class="fa fa-check"></i><b>22.4.6</b> Latin Square Design</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html"><i class="fa fa-check"></i><b>22.5</b> Advanced Experimental Designs</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#semi-random-experiments"><i class="fa fa-check"></i><b>22.5.1</b> Semi-Random Experiments</a></li>
<li class="chapter" data-level="22.5.2" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#re-randomization"><i class="fa fa-check"></i><b>22.5.2</b> Re-Randomization</a></li>
<li class="chapter" data-level="22.5.3" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments"><i class="fa fa-check"></i><b>22.5.3</b> Two-Stage Randomized Experiments</a></li>
<li class="chapter" data-level="22.5.4" data-path="advanced-experimental-designs.html"><a href="advanced-experimental-designs.html#two-stage-randomized-experiments-with-interference-and-noncompliance"><i class="fa fa-check"></i><b>22.5.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="emerging-research.html"><a href="emerging-research.html"><i class="fa fa-check"></i><b>22.6</b> Emerging Research</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="emerging-research.html"><a href="emerging-research.html#covariate-balancing-in-online-ab-testing-the-pigeonhole-design"><i class="fa fa-check"></i><b>22.6.1</b> Covariate Balancing in Online A/B Testing: The Pigeonhole Design</a></li>
<li class="chapter" data-level="22.6.2" data-path="emerging-research.html"><a href="emerging-research.html#sec-handling-zero-valued-outcomes"><i class="fa fa-check"></i><b>22.6.2</b> Handling Zero-Valued Outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>23</b> Sampling</a>
<ul>
<li class="chapter" data-level="23.1" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>23.1</b> Population and Sample</a></li>
<li class="chapter" data-level="23.2" data-path="probability-sampling.html"><a href="probability-sampling.html"><i class="fa fa-check"></i><b>23.2</b> Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-simple-random-sampling"><i class="fa fa-check"></i><b>23.2.1</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="23.2.2" data-path="probability-sampling.html"><a href="probability-sampling.html#sec-stratified-sampling"><i class="fa fa-check"></i><b>23.2.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="23.2.3" data-path="probability-sampling.html"><a href="probability-sampling.html#systematic-sampling"><i class="fa fa-check"></i><b>23.2.3</b> Systematic Sampling</a></li>
<li class="chapter" data-level="23.2.4" data-path="probability-sampling.html"><a href="probability-sampling.html#cluster-sampling"><i class="fa fa-check"></i><b>23.2.4</b> Cluster Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html"><i class="fa fa-check"></i><b>23.3</b> Non-Probability Sampling</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#convenience-sampling"><i class="fa fa-check"></i><b>23.3.1</b> Convenience Sampling</a></li>
<li class="chapter" data-level="23.3.2" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#quota-sampling"><i class="fa fa-check"></i><b>23.3.2</b> Quota Sampling</a></li>
<li class="chapter" data-level="23.3.3" data-path="non-probability-sampling.html"><a href="non-probability-sampling.html#snowball-sampling"><i class="fa fa-check"></i><b>23.3.3</b> Snowball Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="sec-unequal-probability-sampling.html"><a href="sec-unequal-probability-sampling.html"><i class="fa fa-check"></i><b>23.4</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="23.5" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html"><i class="fa fa-check"></i><b>23.5</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#cube-method-for-balanced-sampling"><i class="fa fa-check"></i><b>23.5.1</b> Cube Method for Balanced Sampling</a></li>
<li class="chapter" data-level="23.5.2" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-with-stratification"><i class="fa fa-check"></i><b>23.5.2</b> Balanced Sampling with Stratification</a></li>
<li class="chapter" data-level="23.5.3" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-cluster-sampling"><i class="fa fa-check"></i><b>23.5.3</b> Balanced Sampling in Cluster Sampling</a></li>
<li class="chapter" data-level="23.5.4" data-path="sec-balanced-sampling.html"><a href="sec-balanced-sampling.html#balanced-sampling-in-two-stage-sampling"><i class="fa fa-check"></i><b>23.5.4</b> Balanced Sampling in Two-Stage Sampling</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="sample-size-determination.html"><a href="sample-size-determination.html"><i class="fa fa-check"></i><b>23.6</b> Sample Size Determination</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="sec-analysis-of-variance-anova.html"><a href="sec-analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>24</b> Analysis of Variance</a>
<ul>
<li class="chapter" data-level="24.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html"><i class="fa fa-check"></i><b>24.1</b> Completely Randomized Design</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>24.1.1</b> Single-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.2" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-single-factor-random-effects-model"><i class="fa fa-check"></i><b>24.1.2</b> Single Factor Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.3" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-factor-fixed-effects-anova"><i class="fa fa-check"></i><b>24.1.3</b> Two-Factor Fixed Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.4" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-random-effects-anova"><i class="fa fa-check"></i><b>24.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="24.1.5" data-path="sec-completely-randomized-design.html"><a href="sec-completely-randomized-design.html#sec-two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>24.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html"><i class="fa fa-check"></i><b>24.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#kruskal-wallis-test-one-way-nonparametric-anova"><i class="fa fa-check"></i><b>24.2.1</b> Kruskal-Wallis Test (One-Way Nonparametric ANOVA)</a></li>
<li class="chapter" data-level="24.2.2" data-path="sec-nonparametric-anova.html"><a href="sec-nonparametric-anova.html#friedman-test-nonparametric-two-way-anova"><i class="fa fa-check"></i><b>24.2.2</b> Friedman Test (Nonparametric Two-Way ANOVA)</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="sec-randomized-block-designs.html"><a href="sec-randomized-block-designs.html"><i class="fa fa-check"></i><b>24.3</b> Randomized Block Designs</a></li>
<li class="chapter" data-level="24.4" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>24.4</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-design"><i class="fa fa-check"></i><b>24.4.1</b> Two-Factor Nested Design</a></li>
<li class="chapter" data-level="24.4.2" data-path="nested-designs.html"><a href="nested-designs.html#unbalanced-nested-two-factor-designs"><i class="fa fa-check"></i><b>24.4.2</b> Unbalanced Nested Two-Factor Designs</a></li>
<li class="chapter" data-level="24.4.3" data-path="nested-designs.html"><a href="nested-designs.html#random-factor-effects"><i class="fa fa-check"></i><b>24.4.3</b> Random Factor Effects</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>24.5</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>24.5.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="24.5.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#single-factor-studies"><i class="fa fa-check"></i><b>24.5.2</b> Single Factor Studies</a></li>
<li class="chapter" data-level="24.5.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#multi-factor-studies"><i class="fa fa-check"></i><b>24.5.3</b> Multi-Factor Studies</a></li>
<li class="chapter" data-level="24.5.4" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#procedure-for-sample-size-selection"><i class="fa fa-check"></i><b>24.5.4</b> Procedure for Sample Size Selection</a></li>
<li class="chapter" data-level="24.5.5" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>24.5.5</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>24.6</b> Single Factor Covariance Model</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#statistical-inference-for-treatment-effects"><i class="fa fa-check"></i><b>24.6.1</b> Statistical Inference for Treatment Effects</a></li>
<li class="chapter" data-level="24.6.2" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#testing-for-parallel-slopes"><i class="fa fa-check"></i><b>24.6.2</b> Testing for Parallel Slopes</a></li>
<li class="chapter" data-level="24.6.3" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html#adjusted-means"><i class="fa fa-check"></i><b>24.6.3</b> Adjusted Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="sec-multivariate-methods.html"><a href="sec-multivariate-methods.html"><i class="fa fa-check"></i><b>25</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="25.1" data-path="basic-understanding.html"><a href="basic-understanding.html"><i class="fa fa-check"></i><b>25.1</b> Basic Understanding</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-random-vectors"><i class="fa fa-check"></i><b>25.1.1</b> Multivariate Random Vectors</a></li>
<li class="chapter" data-level="25.1.2" data-path="basic-understanding.html"><a href="basic-understanding.html#sec-covariance-matrix-multivariate"><i class="fa fa-check"></i><b>25.1.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="25.1.3" data-path="basic-understanding.html"><a href="basic-understanding.html#equalities-in-expectation-and-variance"><i class="fa fa-check"></i><b>25.1.3</b> Equalities in Expectation and Variance</a></li>
<li class="chapter" data-level="25.1.4" data-path="basic-understanding.html"><a href="basic-understanding.html#multivariate-normal-distribution-1"><i class="fa fa-check"></i><b>25.1.4</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="25.1.5" data-path="basic-understanding.html"><a href="basic-understanding.html#test-of-multivariate-normality"><i class="fa fa-check"></i><b>25.1.5</b> Test of Multivariate Normality</a></li>
<li class="chapter" data-level="25.1.6" data-path="basic-understanding.html"><a href="basic-understanding.html#mean-vector-inference"><i class="fa fa-check"></i><b>25.1.6</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="25.1.7" data-path="basic-understanding.html"><a href="basic-understanding.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>25.1.7</b> General Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html"><i class="fa fa-check"></i><b>25.2</b> Multivariate Analysis of Variance</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#one-way-manova"><i class="fa fa-check"></i><b>25.2.1</b> One-Way MANOVA</a></li>
<li class="chapter" data-level="25.2.2" data-path="sec-multivariate-analysis-of-variance.html"><a href="sec-multivariate-analysis-of-variance.html#sec-profile-analysis"><i class="fa fa-check"></i><b>25.2.2</b> Profile Analysis</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="statistical-test-selection-for-comparing-means.html"><a href="statistical-test-selection-for-comparing-means.html"><i class="fa fa-check"></i><b>25.3</b> Statistical Test Selection for Comparing Means</a></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="26" data-path="sec-quasi-experimental.html"><a href="sec-quasi-experimental.html"><i class="fa fa-check"></i><b>26</b> Quasi-Experimental Methods</a>
<ul>
<li class="chapter" data-level="26.1" data-path="identification-strategy-in-quasi-experiments.html"><a href="identification-strategy-in-quasi-experiments.html"><i class="fa fa-check"></i><b>26.1</b> Identification Strategy in Quasi-Experiments</a></li>
<li class="chapter" data-level="26.2" data-path="robustness-checks.html"><a href="robustness-checks.html"><i class="fa fa-check"></i><b>26.2</b> Robustness Checks</a></li>
<li class="chapter" data-level="26.3" data-path="establishing-mechanisms.html"><a href="establishing-mechanisms.html"><i class="fa fa-check"></i><b>26.3</b> Establishing Mechanisms</a></li>
<li class="chapter" data-level="26.4" data-path="limitations-of-quasi-experiments.html"><a href="limitations-of-quasi-experiments.html"><i class="fa fa-check"></i><b>26.4</b> Limitations of Quasi-Experiments</a></li>
<li class="chapter" data-level="26.5" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html"><i class="fa fa-check"></i><b>26.5</b> Assumptions for Identifying Treatment Effects</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-sutva"><i class="fa fa-check"></i><b>26.5.1</b> Stable Unit Treatment Value Assumption</a></li>
<li class="chapter" data-level="26.5.2" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-conditional-ignorability-assumption"><i class="fa fa-check"></i><b>26.5.2</b> Conditional Ignorability Assumption</a></li>
<li class="chapter" data-level="26.5.3" data-path="assumptions-for-identifying-treatment-effects.html"><a href="assumptions-for-identifying-treatment-effects.html#sec-overlap-positivity-assumption"><i class="fa fa-check"></i><b>26.5.3</b> Overlap (Positivity) Assumption</a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html"><i class="fa fa-check"></i><b>26.6</b> Natural Experiments</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#the-problem-of-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.1</b> The Problem of Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.2" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#statistical-challenges-in-reusing-natural-experiments"><i class="fa fa-check"></i><b>26.6.2</b> Statistical Challenges in Reusing Natural Experiments</a></li>
<li class="chapter" data-level="26.6.3" data-path="sec-natural-experiments.html"><a href="sec-natural-experiments.html#solutions-multiple-testing-corrections"><i class="fa fa-check"></i><b>26.6.3</b> Solutions: Multiple Testing Corrections</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html"><i class="fa fa-check"></i><b>26.7</b> Design vs. Model-Based Approaches</a>
<ul>
<li class="chapter" data-level="26.7.1" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-design-based"><i class="fa fa-check"></i><b>26.7.1</b> Design-Based Perspective</a></li>
<li class="chapter" data-level="26.7.2" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#sec-model-based-perspective"><i class="fa fa-check"></i><b>26.7.2</b> Model-Based Perspective</a></li>
<li class="chapter" data-level="26.7.3" data-path="design-vs.-model-based-approaches.html"><a href="design-vs.-model-based-approaches.html#placing-methods-along-a-spectrum"><i class="fa fa-check"></i><b>26.7.3</b> Placing Methods Along a Spectrum</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="sec-regression-discontinuity.html"><a href="sec-regression-discontinuity.html"><i class="fa fa-check"></i><b>27</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="27.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html"><i class="fa fa-check"></i><b>27.1</b> Conceptual Framework</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="conceptual-framework.html"><a href="conceptual-framework.html#types-of-regression-discontinuity-designs"><i class="fa fa-check"></i><b>27.1.1</b> Types of Regression Discontinuity Designs</a></li>
<li class="chapter" data-level="27.1.2" data-path="conceptual-framework.html"><a href="conceptual-framework.html#assumptions-for-rd-validity"><i class="fa fa-check"></i><b>27.1.2</b> Assumptions for RD Validity</a></li>
<li class="chapter" data-level="27.1.3" data-path="conceptual-framework.html"><a href="conceptual-framework.html#threats-to-rd-validity"><i class="fa fa-check"></i><b>27.1.3</b> Threats to RD Validity</a></li>
</ul></li>
<li class="chapter" data-level="27.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html"><i class="fa fa-check"></i><b>27.2</b> Model Estimation Strategies</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#parametric-models-polynomial-regression"><i class="fa fa-check"></i><b>27.2.1</b> Parametric Models: Polynomial Regression</a></li>
<li class="chapter" data-level="27.2.2" data-path="model-estimation-strategies.html"><a href="model-estimation-strategies.html#nonparametric-models-local-regression"><i class="fa fa-check"></i><b>27.2.2</b> Nonparametric Models: Local Regression</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="formal-definition.html"><a href="formal-definition.html"><i class="fa fa-check"></i><b>27.3</b> Formal Definition</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="formal-definition.html"><a href="formal-definition.html#identification-assumptions"><i class="fa fa-check"></i><b>27.3.1</b> Identification Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>27.4</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based-approach"><i class="fa fa-check"></i><b>27.4.1</b> Local Randomization-Based Approach</a></li>
<li class="chapter" data-level="27.4.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#sec-continuity-based-approach"><i class="fa fa-check"></i><b>27.4.2</b> Continuity-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>27.5</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="27.5.1" data-path="specification-checks.html"><a href="specification-checks.html#sec-balance-checks"><i class="fa fa-check"></i><b>27.5.1</b> Balance Checks</a></li>
<li class="chapter" data-level="27.5.2" data-path="specification-checks.html"><a href="specification-checks.html#sec-sorting-bunching-and-manipulation"><i class="fa fa-check"></i><b>27.5.2</b> Sorting, Bunching, and Manipulation</a></li>
<li class="chapter" data-level="27.5.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>27.5.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="27.5.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>27.5.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="27.5.5" data-path="specification-checks.html"><a href="specification-checks.html#assessing-sensitivity"><i class="fa fa-check"></i><b>27.5.5</b> Assessing Sensitivity</a></li>
<li class="chapter" data-level="27.5.6" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>27.5.6</b> Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.6</b> Fuzzy Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.6.1" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#compliance-types"><i class="fa fa-check"></i><b>27.6.1</b> Compliance Types</a></li>
<li class="chapter" data-level="27.6.2" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect"><i class="fa fa-check"></i><b>27.6.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.6.3" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#equivalent-representation-using-expectations"><i class="fa fa-check"></i><b>27.6.3</b> Equivalent Representation Using Expectations</a></li>
<li class="chapter" data-level="27.6.4" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#estimation-strategies"><i class="fa fa-check"></i><b>27.6.4</b> Estimation Strategies</a></li>
<li class="chapter" data-level="27.6.5" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#practical-considerations-6"><i class="fa fa-check"></i><b>27.6.5</b> Practical Considerations</a></li>
<li class="chapter" data-level="27.6.6" data-path="sec-fuzzy-regression-discontinuity-design.html"><a href="sec-fuzzy-regression-discontinuity-design.html#steps-for-fuzzy-rd"><i class="fa fa-check"></i><b>27.6.6</b> Steps for Fuzzy RD</a></li>
</ul></li>
<li class="chapter" data-level="27.7" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.7</b> Sharp Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.7.1" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#assumptions-for-identification"><i class="fa fa-check"></i><b>27.7.1</b> Assumptions for Identification</a></li>
<li class="chapter" data-level="27.7.2" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimating-the-local-average-treatment-effect-1"><i class="fa fa-check"></i><b>27.7.2</b> Estimating the Local Average Treatment Effect</a></li>
<li class="chapter" data-level="27.7.3" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#estimation-methods"><i class="fa fa-check"></i><b>27.7.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="27.7.4" data-path="sec-sharp-regression-discontinuity-design.html"><a href="sec-sharp-regression-discontinuity-design.html#steps-for-sharp-rd"><i class="fa fa-check"></i><b>27.7.4</b> Steps for Sharp RD</a></li>
</ul></li>
<li class="chapter" data-level="27.8" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html"><i class="fa fa-check"></i><b>27.8</b> Regression Kink Design</a>
<ul>
<li class="chapter" data-level="27.8.1" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-sharp-regression-kink-design"><i class="fa fa-check"></i><b>27.8.1</b> Identification in Sharp Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.2" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#sec-identification-in-fuzzy-regression-kink-design"><i class="fa fa-check"></i><b>27.8.2</b> Identification in Fuzzy Regression Kink Design</a></li>
<li class="chapter" data-level="27.8.3" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#estimation-of-rkd-effects"><i class="fa fa-check"></i><b>27.8.3</b> Estimation of RKD Effects</a></li>
<li class="chapter" data-level="27.8.4" data-path="sec-regression-kink-design.html"><a href="sec-regression-kink-design.html#robustness-checks-1"><i class="fa fa-check"></i><b>27.8.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.9" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.9</b> Multi-Cutoff Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.9.1" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#identification"><i class="fa fa-check"></i><b>27.9.1</b> Identification</a></li>
<li class="chapter" data-level="27.9.2" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#key-assumptions-1"><i class="fa fa-check"></i><b>27.9.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.9.3" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#estimation-approaches"><i class="fa fa-check"></i><b>27.9.3</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.9.4" data-path="sec-multi-cutoff-regression-discontinuity-design.html"><a href="sec-multi-cutoff-regression-discontinuity-design.html#robustness-checks-2"><i class="fa fa-check"></i><b>27.9.4</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.10" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.10</b> Multi-Score Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.10.1" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#general-framework"><i class="fa fa-check"></i><b>27.10.1</b> General Framework</a></li>
<li class="chapter" data-level="27.10.2" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#identification-1"><i class="fa fa-check"></i><b>27.10.2</b> Identification</a></li>
<li class="chapter" data-level="27.10.3" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#key-assumptions-2"><i class="fa fa-check"></i><b>27.10.3</b> Key Assumptions</a></li>
<li class="chapter" data-level="27.10.4" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#estimation-approaches-1"><i class="fa fa-check"></i><b>27.10.4</b> Estimation Approaches</a></li>
<li class="chapter" data-level="27.10.5" data-path="sec-multi-score-regression-discontinuity-design.html"><a href="sec-multi-score-regression-discontinuity-design.html#robustness-checks-3"><i class="fa fa-check"></i><b>27.10.5</b> Robustness Checks</a></li>
</ul></li>
<li class="chapter" data-level="27.11" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html"><i class="fa fa-check"></i><b>27.11</b> Evaluation of a Regression Discontinuity Design</a>
<ul>
<li class="chapter" data-level="27.11.1" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#graphical-and-formal-evidence"><i class="fa fa-check"></i><b>27.11.1</b> Graphical and Formal Evidence</a></li>
<li class="chapter" data-level="27.11.2" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#functional-form-of-the-running-variable"><i class="fa fa-check"></i><b>27.11.2</b> Functional Form of the Running Variable</a></li>
<li class="chapter" data-level="27.11.3" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#bandwidth-selection-2"><i class="fa fa-check"></i><b>27.11.3</b> Bandwidth Selection</a></li>
<li class="chapter" data-level="27.11.4" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#addressing-potential-confounders"><i class="fa fa-check"></i><b>27.11.4</b> Addressing Potential Confounders</a></li>
<li class="chapter" data-level="27.11.5" data-path="evaluation-of-a-regression-discontinuity-design.html"><a href="evaluation-of-a-regression-discontinuity-design.html#external-validity-in-rd"><i class="fa fa-check"></i><b>27.11.5</b> External Validity in RD</a></li>
</ul></li>
<li class="chapter" data-level="27.12" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html"><i class="fa fa-check"></i><b>27.12</b> Applications of RD Designs</a>
<ul>
<li class="chapter" data-level="27.12.1" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#applications-in-marketing"><i class="fa fa-check"></i><b>27.12.1</b> Applications in Marketing</a></li>
<li class="chapter" data-level="27.12.2" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#r-packages-for-rd-estimation"><i class="fa fa-check"></i><b>27.12.2</b> R Packages for RD Estimation</a></li>
<li class="chapter" data-level="27.12.3" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-regression-discontinuity-in-education"><i class="fa fa-check"></i><b>27.12.3</b> Example of Regression Discontinuity in Education</a></li>
<li class="chapter" data-level="27.12.4" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#example-of-occupational-licensing-and-market-efficiency"><i class="fa fa-check"></i><b>27.12.4</b> Example of Occupational Licensing and Market Efficiency</a></li>
<li class="chapter" data-level="27.12.5" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#replicating-carpenter2009effect"><i class="fa fa-check"></i><b>27.12.5</b> Replicating <span class="citation">(Carpenter and Dobkin 2009)</span></a></li>
<li class="chapter" data-level="27.12.6" data-path="applications-of-rd-designs.html"><a href="applications-of-rd-designs.html#additional-rd-applications"><i class="fa fa-check"></i><b>27.12.6</b> Additional RD Applications</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="temporal-discontinuity-designs.html"><a href="temporal-discontinuity-designs.html"><i class="fa fa-check"></i><b>28</b> Temporal Discontinuity Designs</a>
<ul>
<li class="chapter" data-level="28.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>28.1</b> Regression Discontinuity in Time</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#estimation-and-model-selection"><i class="fa fa-check"></i><b>28.1.1</b> Estimation and Model Selection</a></li>
<li class="chapter" data-level="28.1.2" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#strengths-of-rdit"><i class="fa fa-check"></i><b>28.1.2</b> Strengths of RDiT</a></li>
<li class="chapter" data-level="28.1.3" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#limitations-and-challenges-of-rdit"><i class="fa fa-check"></i><b>28.1.3</b> Limitations and Challenges of RDiT</a></li>
<li class="chapter" data-level="28.1.4" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#recommendations-for-robustness-checks"><i class="fa fa-check"></i><b>28.1.4</b> Recommendations for Robustness Checks</a></li>
<li class="chapter" data-level="28.1.5" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#applications-of-rdit"><i class="fa fa-check"></i><b>28.1.5</b> Applications of RDiT</a></li>
<li class="chapter" data-level="28.1.6" data-path="sec-regression-discontinuity-in-time.html"><a href="sec-regression-discontinuity-in-time.html#empirical-example"><i class="fa fa-check"></i><b>28.1.6</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html"><i class="fa fa-check"></i><b>28.2</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#advantages-of-its"><i class="fa fa-check"></i><b>28.2.1</b> Advantages of ITS</a></li>
<li class="chapter" data-level="28.2.2" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#limitations-of-its"><i class="fa fa-check"></i><b>28.2.2</b> Limitations of ITS</a></li>
<li class="chapter" data-level="28.2.3" data-path="sec-interrupted-time-series.html"><a href="sec-interrupted-time-series.html#empirical-example-1"><i class="fa fa-check"></i><b>28.2.3</b> Empirical Example</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html"><i class="fa fa-check"></i><b>28.3</b> Combining both RDiT and ITS</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#augment-an-its-model-with-a-local-discontinuity-term"><i class="fa fa-check"></i><b>28.3.1</b> Augment an ITS Model with a Local Discontinuity Term</a></li>
<li class="chapter" data-level="28.3.2" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#two-stage-or-multi-stage-modeling"><i class="fa fa-check"></i><b>28.3.2</b> Two-Stage (or Multi-Stage) Modeling</a></li>
<li class="chapter" data-level="28.3.3" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#hierarchical-or-multi-level-modeling"><i class="fa fa-check"></i><b>28.3.3</b> Hierarchical or Multi-Level Modeling</a></li>
<li class="chapter" data-level="28.3.4" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#empirical-example-2"><i class="fa fa-check"></i><b>28.3.4</b> Empirical Example</a></li>
<li class="chapter" data-level="28.3.5" data-path="combining-both-rdit-and-its.html"><a href="combining-both-rdit-and-its.html#practical-guidance"><i class="fa fa-check"></i><b>28.3.5</b> Practical Guidance</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html"><i class="fa fa-check"></i><b>28.4</b> Case-Crossover Study Design</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#mathematical-foundations"><i class="fa fa-check"></i><b>28.4.1</b> Mathematical Foundations</a></li>
<li class="chapter" data-level="28.4.2" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#selection-of-control-periods"><i class="fa fa-check"></i><b>28.4.2</b> Selection of Control Periods</a></li>
<li class="chapter" data-level="28.4.3" data-path="case-crossover-study-design.html"><a href="case-crossover-study-design.html#assumptions-1"><i class="fa fa-check"></i><b>28.4.3</b> Assumptions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="sec-synthetic-difference-in-differences.html"><a href="sec-synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>29</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="29.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>29.1</b> Understanding</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="understanding.html"><a href="understanding.html#steps-in-sdid-estimation"><i class="fa fa-check"></i><b>29.1.1</b> Steps in SDID Estimation</a></li>
<li class="chapter" data-level="29.1.2" data-path="understanding.html"><a href="understanding.html#comparison-of-methods-1"><i class="fa fa-check"></i><b>29.1.2</b> Comparison of Methods</a></li>
<li class="chapter" data-level="29.1.3" data-path="understanding.html"><a href="understanding.html#why-use-weights"><i class="fa fa-check"></i><b>29.1.3</b> <strong>Why Use Weights?</strong></a></li>
<li class="chapter" data-level="29.1.4" data-path="understanding.html"><a href="understanding.html#benefits-of-localization-in-sdid"><i class="fa fa-check"></i><b>29.1.4</b> <strong>Benefits of Localization in SDID</strong></a></li>
<li class="chapter" data-level="29.1.5" data-path="understanding.html"><a href="understanding.html#designing-sdid-weights"><i class="fa fa-check"></i><b>29.1.5</b> <strong>Designing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.6" data-path="understanding.html"><a href="understanding.html#how-sdid-enhances-dids-plausibility"><i class="fa fa-check"></i><b>29.1.6</b> <strong>How SDID Enhances DID’s Plausibility</strong></a></li>
<li class="chapter" data-level="29.1.7" data-path="understanding.html"><a href="understanding.html#choosing-sdid-weights"><i class="fa fa-check"></i><b>29.1.7</b> <strong>Choosing SDID Weights</strong></a></li>
<li class="chapter" data-level="29.1.8" data-path="understanding.html"><a href="understanding.html#accounting-for-time-varying-covariates-in-weight-estimation"><i class="fa fa-check"></i><b>29.1.8</b> <strong>Accounting for Time-Varying Covariates in Weight Estimation</strong></a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="application-3.html"><a href="application-3.html"><i class="fa fa-check"></i><b>29.2</b> Application</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="application-3.html"><a href="application-3.html#block-treatment"><i class="fa fa-check"></i><b>29.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="29.2.2" data-path="application-3.html"><a href="application-3.html#staggered-adoption"><i class="fa fa-check"></i><b>29.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="sec-difference-in-differences.html"><a href="sec-difference-in-differences.html"><i class="fa fa-check"></i><b>30</b> Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.1" data-path="empirical-studies.html"><a href="empirical-studies.html"><i class="fa fa-check"></i><b>30.1</b> Empirical Studies</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-marketing"><i class="fa fa-check"></i><b>30.1.1</b> Applications of DID in Marketing</a></li>
<li class="chapter" data-level="30.1.2" data-path="empirical-studies.html"><a href="empirical-studies.html#applications-of-did-in-economics"><i class="fa fa-check"></i><b>30.1.2</b> Applications of DID in Economics</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="sec-visualization-did.html"><a href="sec-visualization-did.html"><i class="fa fa-check"></i><b>30.2</b> Visualization</a></li>
<li class="chapter" data-level="30.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html"><i class="fa fa-check"></i><b>30.3</b> Simple Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#basic-setup-of-did"><i class="fa fa-check"></i><b>30.3.1</b> Basic Setup of DID</a></li>
<li class="chapter" data-level="30.3.2" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#extensions-of-did"><i class="fa fa-check"></i><b>30.3.2</b> Extensions of DID</a></li>
<li class="chapter" data-level="30.3.3" data-path="sec-simple-difference-in-differences.html"><a href="sec-simple-difference-in-differences.html#goals-of-did"><i class="fa fa-check"></i><b>30.3.3</b> Goals of DID</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html"><i class="fa fa-check"></i><b>30.4</b> Empirical Research Walkthrough</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-unintended-consequences-of-ban-the-box-policies"><i class="fa fa-check"></i><b>30.4.1</b> Example: The Unintended Consequences of “Ban the Box” Policies</a></li>
<li class="chapter" data-level="30.4.2" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-minimum-wage-and-employment"><i class="fa fa-check"></i><b>30.4.2</b> Example: Minimum Wage and Employment</a></li>
<li class="chapter" data-level="30.4.3" data-path="empirical-research-walkthrough.html"><a href="empirical-research-walkthrough.html#example-the-effects-of-grade-policies-on-major-choice"><i class="fa fa-check"></i><b>30.4.3</b> Example: The Effects of Grade Policies on Major Choice</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>30.5</b> One Difference</a></li>
<li class="chapter" data-level="30.6" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html"><i class="fa fa-check"></i><b>30.6</b> Two-Way Fixed Effects</a>
<ul>
<li class="chapter" data-level="30.6.1" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#canonical-twfe-model"><i class="fa fa-check"></i><b>30.6.1</b> Canonical TWFE Model</a></li>
<li class="chapter" data-level="30.6.2" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#limitations-of-twfe"><i class="fa fa-check"></i><b>30.6.2</b> Limitations of TWFE</a></li>
<li class="chapter" data-level="30.6.3" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#diagnosing-and-addressing-bias-in-twfe"><i class="fa fa-check"></i><b>30.6.3</b> Diagnosing and Addressing Bias in TWFE</a></li>
<li class="chapter" data-level="30.6.4" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#remedies-for-twfes-shortcomings"><i class="fa fa-check"></i><b>30.6.4</b> Remedies for TWFE’s Shortcomings</a></li>
<li class="chapter" data-level="30.6.5" data-path="sec-two-way-fixed-effects.html"><a href="sec-two-way-fixed-effects.html#best-practices-and-recommendations"><i class="fa fa-check"></i><b>30.6.5</b> Best Practices and Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="30.7" data-path="sec-multiple-periods-and-variation-in-treatment-timing.html"><a href="sec-multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>30.7</b> Multiple Periods and Variation in Treatment Timing</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="sec-multiple-periods-and-variation-in-treatment-timing.html"><a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-staggered-difference-in-differences"><i class="fa fa-check"></i><b>30.7.1</b> Staggered Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html"><i class="fa fa-check"></i><b>30.8</b> Modern Estimators for Staggered Adoption</a>
<ul>
<li class="chapter" data-level="30.8.1" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-group-time-average-treatment-effects-callaway2021difference"><i class="fa fa-check"></i><b>30.8.1</b> Group-Time Average Treatment Effects <span class="citation">(Callaway and Sant’Anna 2021)</span></a></li>
<li class="chapter" data-level="30.8.2" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-cohort-average-treatment-effects-sun2021estimating"><i class="fa fa-check"></i><b>30.8.2</b> Cohort Average Treatment Effects <span class="citation">(L. Sun and Abraham 2021)</span></a></li>
<li class="chapter" data-level="30.8.3" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-stacked-difference-in-differences"><i class="fa fa-check"></i><b>30.8.3</b> Stacked Difference-in-Differences</a></li>
<li class="chapter" data-level="30.8.4" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-panel-match-did-estimator-with-in-and-out-treatment-conditions"><i class="fa fa-check"></i><b>30.8.4</b> Panel Match DiD Estimator with In-and-Out Treatment Conditions</a></li>
<li class="chapter" data-level="30.8.5" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#counterfactual-estimators"><i class="fa fa-check"></i><b>30.8.5</b> Counterfactual Estimators</a></li>
<li class="chapter" data-level="30.8.6" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-matrix-completion-estimator"><i class="fa fa-check"></i><b>30.8.6</b> Matrix Completion Estimator</a></li>
<li class="chapter" data-level="30.8.7" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-reshaped-inverse-probability-weighting-twfe-estimator"><i class="fa fa-check"></i><b>30.8.7</b> Reshaped Inverse Probability Weighting - TWFE Estimator</a></li>
<li class="chapter" data-level="30.8.8" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#gardner2022two-and-borusyak2024revisiting"><i class="fa fa-check"></i><b>30.8.8</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2024)</span></a></li>
<li class="chapter" data-level="30.8.9" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#dynamic-treatment-effect-estimation-with-interactive-fixed-effects-and-short-panels"><i class="fa fa-check"></i><b>30.8.9</b> Dynamic Treatment Effect Estimation with Interactive Fixed Effects and Short Panels</a></li>
<li class="chapter" data-level="30.8.10" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#sec-switching-difference-in-differences-estimator-de2020two"><i class="fa fa-check"></i><b>30.8.10</b> Switching Difference-in-Differences Estimator <span class="citation">(Clément De Chaisemartin and d’Haultfoeuille 2020)</span></a></li>
<li class="chapter" data-level="30.8.11" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#augmentedforward-did"><i class="fa fa-check"></i><b>30.8.11</b> Augmented/Forward DID</a></li>
<li class="chapter" data-level="30.8.12" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#doubly-robust-difference-in-differences-estimators"><i class="fa fa-check"></i><b>30.8.12</b> Doubly Robust Difference-in-Differences Estimators</a></li>
<li class="chapter" data-level="30.8.13" data-path="sec-modern-estimators-for-staggered-adoption.html"><a href="sec-modern-estimators-for-staggered-adoption.html#nonlinear-difference-in-differences"><i class="fa fa-check"></i><b>30.8.13</b> Nonlinear Difference-in-Differences</a></li>
</ul></li>
<li class="chapter" data-level="30.9" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>30.9</b> Multiple Treatments</a>
<ul>
<li class="chapter" data-level="30.9.1" data-path="multiple-treatments.html"><a href="multiple-treatments.html#multiple-treatment-groups-model-specification"><i class="fa fa-check"></i><b>30.9.1</b> Multiple Treatment Groups: Model Specification</a></li>
<li class="chapter" data-level="30.9.2" data-path="multiple-treatments.html"><a href="multiple-treatments.html#understanding-the-control-group-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.2</b> Understanding the Control Group in Multiple Treatment DiD</a></li>
<li class="chapter" data-level="30.9.3" data-path="multiple-treatments.html"><a href="multiple-treatments.html#alternative-approaches-separate-regressions-vs.-one-model"><i class="fa fa-check"></i><b>30.9.3</b> Alternative Approaches: Separate Regressions vs. One Model</a></li>
<li class="chapter" data-level="30.9.4" data-path="multiple-treatments.html"><a href="multiple-treatments.html#handling-treatment-intensity"><i class="fa fa-check"></i><b>30.9.4</b> Handling Treatment Intensity</a></li>
<li class="chapter" data-level="30.9.5" data-path="multiple-treatments.html"><a href="multiple-treatments.html#considerations-when-individuals-can-move-between-treatment-groups"><i class="fa fa-check"></i><b>30.9.5</b> Considerations When Individuals Can Move Between Treatment Groups</a></li>
<li class="chapter" data-level="30.9.6" data-path="multiple-treatments.html"><a href="multiple-treatments.html#parallel-trends-assumption-in-multiple-treatment-did"><i class="fa fa-check"></i><b>30.9.6</b> Parallel Trends Assumption in Multiple-Treatment DiD</a></li>
</ul></li>
<li class="chapter" data-level="30.10" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>30.10</b> Mediation Under DiD</a>
<ul>
<li class="chapter" data-level="30.10.1" data-path="mediation-under-did.html"><a href="mediation-under-did.html#mediation-model-in-did"><i class="fa fa-check"></i><b>30.10.1</b> Mediation Model in DiD</a></li>
<li class="chapter" data-level="30.10.2" data-path="mediation-under-did.html"><a href="mediation-under-did.html#interpreting-the-results"><i class="fa fa-check"></i><b>30.10.2</b> Interpreting the Results</a></li>
<li class="chapter" data-level="30.10.3" data-path="mediation-under-did.html"><a href="mediation-under-did.html#challenges-in-mediation-analysis-for-did"><i class="fa fa-check"></i><b>30.10.3</b> Challenges in Mediation Analysis for DiD</a></li>
<li class="chapter" data-level="30.10.4" data-path="mediation-under-did.html"><a href="mediation-under-did.html#alternative-approach-instrumental-variables-for-mediation"><i class="fa fa-check"></i><b>30.10.4</b> Alternative Approach: Instrumental Variables for Mediation</a></li>
</ul></li>
<li class="chapter" data-level="30.11" data-path="assumptions-3.html"><a href="assumptions-3.html"><i class="fa fa-check"></i><b>30.11</b> Assumptions</a>
<ul>
<li class="chapter" data-level="30.11.1" data-path="assumptions-3.html"><a href="assumptions-3.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>30.11.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="30.11.2" data-path="assumptions-3.html"><a href="assumptions-3.html#sec-placebo-test-did"><i class="fa fa-check"></i><b>30.11.2</b> Placebo Test</a></li>
</ul></li>
<li class="chapter" data-level="30.12" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html"><i class="fa fa-check"></i><b>30.12</b> Robustness Checks</a>
<ul>
<li class="chapter" data-level="30.12.1" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#robustness-checks-to-strengthen-causal-interpretation"><i class="fa fa-check"></i><b>30.12.1</b> Robustness Checks to Strengthen Causal Interpretation</a></li>
<li class="chapter" data-level="30.12.2" data-path="robustness-checks-4.html"><a href="robustness-checks-4.html#best-practices-for-reliable-did-implementation"><i class="fa fa-check"></i><b>30.12.2</b> Best Practices for Reliable DiD Implementation</a></li>
</ul></li>
<li class="chapter" data-level="30.13" data-path="concerns-in-did.html"><a href="concerns-in-did.html"><i class="fa fa-check"></i><b>30.13</b> Concerns in DID</a>
<ul>
<li class="chapter" data-level="30.13.1" data-path="concerns-in-did.html"><a href="concerns-in-did.html#matching-methods-in-did"><i class="fa fa-check"></i><b>30.13.1</b> Matching Methods in DID</a></li>
<li class="chapter" data-level="30.13.2" data-path="concerns-in-did.html"><a href="concerns-in-did.html#control-variables-in-did"><i class="fa fa-check"></i><b>30.13.2</b> Control Variables in DID</a></li>
<li class="chapter" data-level="30.13.3" data-path="concerns-in-did.html"><a href="concerns-in-did.html#did-for-count-data-fixed-effects-poisson-model"><i class="fa fa-check"></i><b>30.13.3</b> DID for Count Data: Fixed-Effects Poisson Model</a></li>
<li class="chapter" data-level="30.13.4" data-path="concerns-in-did.html"><a href="concerns-in-did.html#handling-zero-valued-outcomes-in-did"><i class="fa fa-check"></i><b>30.13.4</b> Handling Zero-Valued Outcomes in DID</a></li>
<li class="chapter" data-level="30.13.5" data-path="concerns-in-did.html"><a href="concerns-in-did.html#standard-errors-1"><i class="fa fa-check"></i><b>30.13.5</b> Standard Errors</a></li>
<li class="chapter" data-level="30.13.6" data-path="concerns-in-did.html"><a href="concerns-in-did.html#sec-partial-identification-did"><i class="fa fa-check"></i><b>30.13.6</b> Partial Identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="sec-changes-in-changes.html"><a href="sec-changes-in-changes.html"><i class="fa fa-check"></i><b>31</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="31.1" data-path="key-concepts.html"><a href="key-concepts.html"><i class="fa fa-check"></i><b>31.1</b> Key Concepts</a></li>
<li class="chapter" data-level="31.2" data-path="estimating-qtt-with-cic.html"><a href="estimating-qtt-with-cic.html"><i class="fa fa-check"></i><b>31.2</b> Estimating QTT with CiC</a></li>
<li class="chapter" data-level="31.3" data-path="application-4.html"><a href="application-4.html"><i class="fa fa-check"></i><b>31.3</b> Application</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="application-4.html"><a href="application-4.html#ecic-package"><i class="fa fa-check"></i><b>31.3.1</b> ECIC package</a></li>
<li class="chapter" data-level="31.3.2" data-path="application-4.html"><a href="application-4.html#qte-package"><i class="fa fa-check"></i><b>31.3.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="sec-synthetic-control.html"><a href="sec-synthetic-control.html"><i class="fa fa-check"></i><b>32</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.1" data-path="marketing-applications.html"><a href="marketing-applications.html"><i class="fa fa-check"></i><b>32.1</b> Marketing Applications</a></li>
<li class="chapter" data-level="32.2" data-path="key-features-of-scm.html"><a href="key-features-of-scm.html"><i class="fa fa-check"></i><b>32.2</b> Key Features of SCM</a></li>
<li class="chapter" data-level="32.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html"><i class="fa fa-check"></i><b>32.3</b> Advantages of SCM</a>
<ul>
<li class="chapter" data-level="32.3.1" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-did"><i class="fa fa-check"></i><b>32.3.1</b> Compared to DiD</a></li>
<li class="chapter" data-level="32.3.2" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#compared-to-linear-regression"><i class="fa fa-check"></i><b>32.3.2</b> Compared to Linear Regression</a></li>
<li class="chapter" data-level="32.3.3" data-path="advantages-of-scm.html"><a href="advantages-of-scm.html#additional-advantages"><i class="fa fa-check"></i><b>32.3.3</b> Additional Advantages</a></li>
</ul></li>
<li class="chapter" data-level="32.4" data-path="disadvantages-of-scm.html"><a href="disadvantages-of-scm.html"><i class="fa fa-check"></i><b>32.4</b> Disadvantages of SCM</a></li>
<li class="chapter" data-level="32.5" data-path="assumptions-4.html"><a href="assumptions-4.html"><i class="fa fa-check"></i><b>32.5</b> Assumptions</a></li>
<li class="chapter" data-level="32.6" data-path="estimation-3.html"><a href="estimation-3.html"><i class="fa fa-check"></i><b>32.6</b> Estimation</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="estimation-3.html"><a href="estimation-3.html#constructing-the-synthetic-control"><i class="fa fa-check"></i><b>32.6.1</b> Constructing the Synthetic Control</a></li>
<li class="chapter" data-level="32.6.2" data-path="estimation-3.html"><a href="estimation-3.html#penalized-synthetic-control"><i class="fa fa-check"></i><b>32.6.2</b> Penalized Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="theoretical-considerations.html"><a href="theoretical-considerations.html"><i class="fa fa-check"></i><b>32.7</b> Theoretical Considerations</a></li>
<li class="chapter" data-level="32.8" data-path="inference-in-scm.html"><a href="inference-in-scm.html"><i class="fa fa-check"></i><b>32.8</b> Inference in SCM</a>
<ul>
<li class="chapter" data-level="32.8.1" data-path="inference-in-scm.html"><a href="inference-in-scm.html#permutation-placebo-inference"><i class="fa fa-check"></i><b>32.8.1</b> Permutation (Placebo) Inference</a></li>
<li class="chapter" data-level="32.8.2" data-path="inference-in-scm.html"><a href="inference-in-scm.html#one-sided-inference"><i class="fa fa-check"></i><b>32.8.2</b> One-Sided Inference</a></li>
</ul></li>
<li class="chapter" data-level="32.9" data-path="sec-augmented-synthetic-control.html"><a href="sec-augmented-synthetic-control.html"><i class="fa fa-check"></i><b>32.9</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="32.10" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>32.10</b> Synthetic Control with Staggered Adoption</a>
<ul>
<li class="chapter" data-level="32.10.1" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html#partially-pooled-synthetic-control"><i class="fa fa-check"></i><b>32.10.1</b> Partially Pooled Synthetic Control</a></li>
</ul></li>
<li class="chapter" data-level="32.11" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>32.11</b> Generalized Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.11.1" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#the-problem-with-traditional-methods"><i class="fa fa-check"></i><b>32.11.1</b> The Problem with Traditional Methods</a></li>
<li class="chapter" data-level="32.11.2" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#generalized-synthetic-control-model"><i class="fa fa-check"></i><b>32.11.2</b> Generalized Synthetic Control Model</a></li>
<li class="chapter" data-level="32.11.3" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#identification-and-estimation"><i class="fa fa-check"></i><b>32.11.3</b> Identification and Estimation</a></li>
<li class="chapter" data-level="32.11.4" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html#bootstrap-procedure-for-standard-errors"><i class="fa fa-check"></i><b>32.11.4</b> Bootstrap Procedure for Standard Errors</a></li>
</ul></li>
<li class="chapter" data-level="32.12" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>32.12</b> Bayesian Synthetic Control</a>
<ul>
<li class="chapter" data-level="32.12.1" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-causal-inference-framework"><i class="fa fa-check"></i><b>32.12.1</b> Bayesian Causal Inference Framework</a></li>
<li class="chapter" data-level="32.12.2" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-dynamic-multilevel-factor-model"><i class="fa fa-check"></i><b>32.12.2</b> Bayesian Dynamic Multilevel Factor Model</a></li>
<li class="chapter" data-level="32.12.3" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-sparse-synthetic-control"><i class="fa fa-check"></i><b>32.12.3</b> Bayesian Sparse Synthetic Control</a></li>
<li class="chapter" data-level="32.12.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html#bayesian-inference-and-mcmc-estimation"><i class="fa fa-check"></i><b>32.12.4</b> Bayesian Inference and MCMC Estimation</a></li>
</ul></li>
<li class="chapter" data-level="32.13" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><i class="fa fa-check"></i><b>32.13</b> Using Multiple Outcomes to Improve the Synthetic Control Method</a>
<ul>
<li class="chapter" data-level="32.13.1" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#standard-synthetic-control-method"><i class="fa fa-check"></i><b>32.13.1</b> Standard Synthetic Control Method</a></li>
<li class="chapter" data-level="32.13.2" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#using-multiple-outcomes-for-bias-reduction"><i class="fa fa-check"></i><b>32.13.2</b> Using Multiple Outcomes for Bias Reduction</a></li>
<li class="chapter" data-level="32.13.3" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#estimation-methods-1"><i class="fa fa-check"></i><b>32.13.3</b> Estimation Methods</a></li>
<li class="chapter" data-level="32.13.4" data-path="using-multiple-outcomes-to-improve-the-synthetic-control-method.html"><a href="using-multiple-outcomes-to-improve-the-synthetic-control-method.html#empirical-application-flint-water-crisis"><i class="fa fa-check"></i><b>32.13.4</b> Empirical Application: Flint Water Crisis</a></li>
</ul></li>
<li class="chapter" data-level="32.14" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>32.14</b> Applications</a>
<ul>
<li class="chapter" data-level="32.14.1" data-path="applications.html"><a href="applications.html#synthetic-control-estimation"><i class="fa fa-check"></i><b>32.14.1</b> Synthetic Control Estimation</a></li>
<li class="chapter" data-level="32.14.2" data-path="applications.html"><a href="applications.html#the-basque-country-policy-change"><i class="fa fa-check"></i><b>32.14.2</b> The Basque Country Policy Change</a></li>
<li class="chapter" data-level="32.14.3" data-path="applications.html"><a href="applications.html#micro-synthetic-control-with-microsynth"><i class="fa fa-check"></i><b>32.14.3</b> Micro-Synthetic Control with <code>microsynth</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="sec-event-studies.html"><a href="sec-event-studies.html"><i class="fa fa-check"></i><b>33</b> Event Studies</a>
<ul>
<li class="chapter" data-level="33.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html"><i class="fa fa-check"></i><b>33.1</b> Review of Event Studies Across Disciplines</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#finance-applications"><i class="fa fa-check"></i><b>33.1.1</b> Finance Applications</a></li>
<li class="chapter" data-level="33.1.2" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#management-applications"><i class="fa fa-check"></i><b>33.1.2</b> Management Applications</a></li>
<li class="chapter" data-level="33.1.3" data-path="review-of-event-studies-across-disciplines.html"><a href="review-of-event-studies-across-disciplines.html#marketing-applications-1"><i class="fa fa-check"></i><b>33.1.3</b> Marketing Applications</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="key-assumptions-3.html"><a href="key-assumptions-3.html"><i class="fa fa-check"></i><b>33.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="33.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html"><i class="fa fa-check"></i><b>33.3</b> Steps for Conducting an Event Study</a>
<ul>
<li class="chapter" data-level="33.3.1" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-1-event-identification"><i class="fa fa-check"></i><b>33.3.1</b> Step 1: Event Identification</a></li>
<li class="chapter" data-level="33.3.2" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-2-define-the-event-and-estimation-windows"><i class="fa fa-check"></i><b>33.3.2</b> Step 2: Define the Event and Estimation Windows</a></li>
<li class="chapter" data-level="33.3.3" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-3-compute-normal-vs.-abnormal-returns"><i class="fa fa-check"></i><b>33.3.3</b> Step 3: Compute Normal vs. Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.4" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-4-compute-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.3.4</b> Step 4: Compute Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.3.5" data-path="steps-for-conducting-an-event-study.html"><a href="steps-for-conducting-an-event-study.html#step-5-statistical-tests-for-significance"><i class="fa fa-check"></i><b>33.3.5</b> Step 5: Statistical Tests for Significance</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html"><i class="fa fa-check"></i><b>33.4</b> Event Studies in Marketing</a>
<ul>
<li class="chapter" data-level="33.4.1" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#definition"><i class="fa fa-check"></i><b>33.4.1</b> Definition</a></li>
<li class="chapter" data-level="33.4.2" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#when-can-marketing-events-affect-non-operating-assets-or-debt"><i class="fa fa-check"></i><b>33.4.2</b> When Can Marketing Events Affect Non-Operating Assets or Debt?</a></li>
<li class="chapter" data-level="33.4.3" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#calculating-the-leverage-effect"><i class="fa fa-check"></i><b>33.4.3</b> Calculating the Leverage Effect</a></li>
<li class="chapter" data-level="33.4.4" data-path="event-studies-in-marketing.html"><a href="event-studies-in-marketing.html#computing-leverage-effect-from-compustat-data"><i class="fa fa-check"></i><b>33.4.4</b> Computing Leverage Effect from Compustat Data</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="economic-significance.html"><a href="economic-significance.html"><i class="fa fa-check"></i><b>33.5</b> Economic Significance</a></li>
<li class="chapter" data-level="33.6" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html"><i class="fa fa-check"></i><b>33.6</b> Testing in Event Studies</a>
<ul>
<li class="chapter" data-level="33.6.1" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#statistical-power-in-event-studies"><i class="fa fa-check"></i><b>33.6.1</b> Statistical Power in Event Studies</a></li>
<li class="chapter" data-level="33.6.2" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#parametric-tests"><i class="fa fa-check"></i><b>33.6.2</b> Parametric Tests</a></li>
<li class="chapter" data-level="33.6.3" data-path="testing-in-event-studies.html"><a href="testing-in-event-studies.html#non-parametric-tests-1"><i class="fa fa-check"></i><b>33.6.3</b> Non-Parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.7" data-path="sample-in-event-studies.html"><a href="sample-in-event-studies.html"><i class="fa fa-check"></i><b>33.7</b> Sample in Event Studies</a></li>
<li class="chapter" data-level="33.8" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html"><i class="fa fa-check"></i><b>33.8</b> Confounders in Event Studies</a>
<ul>
<li class="chapter" data-level="33.8.1" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#types-of-confounding-events"><i class="fa fa-check"></i><b>33.8.1</b> Types of Confounding Events</a></li>
<li class="chapter" data-level="33.8.2" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#should-we-exclude-confounded-observations"><i class="fa fa-check"></i><b>33.8.2</b> Should We Exclude Confounded Observations?</a></li>
<li class="chapter" data-level="33.8.3" data-path="confounders-in-event-studies.html"><a href="confounders-in-event-studies.html#simulation-study-should-we-exclude-correlated-and-uncorrelated-events"><i class="fa fa-check"></i><b>33.8.3</b> Simulation Study: Should We Exclude Correlated and Uncorrelated Events?</a></li>
</ul></li>
<li class="chapter" data-level="33.9" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html"><i class="fa fa-check"></i><b>33.9</b> Biases in Event Studies</a>
<ul>
<li class="chapter" data-level="33.9.1" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#timing-bias-different-market-closing-times"><i class="fa fa-check"></i><b>33.9.1</b> Timing Bias: Different Market Closing Times</a></li>
<li class="chapter" data-level="33.9.2" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#upward-bias-in-cumulative-abnormal-returns"><i class="fa fa-check"></i><b>33.9.2</b> Upward Bias in Cumulative Abnormal Returns</a></li>
<li class="chapter" data-level="33.9.3" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#cross-sectional-dependence-bias"><i class="fa fa-check"></i><b>33.9.3</b> Cross-Sectional Dependence Bias</a></li>
<li class="chapter" data-level="33.9.4" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#sample-selection-bias"><i class="fa fa-check"></i><b>33.9.4</b> Sample Selection Bias</a></li>
<li class="chapter" data-level="33.9.5" data-path="biases-in-event-studies.html"><a href="biases-in-event-studies.html#corrections-for-sample-selection-bias"><i class="fa fa-check"></i><b>33.9.5</b> Corrections for Sample Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="33.10" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>33.10</b> Long-run Event Studies</a>
<ul>
<li class="chapter" data-level="33.10.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#sec-buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>33.10.1</b> Buy-and-Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="33.10.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>33.10.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="33.10.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>33.10.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="33.11" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>33.11</b> Aggregation</a>
<ul>
<li class="chapter" data-level="33.11.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>33.11.1</b> Over Time</a></li>
<li class="chapter" data-level="33.11.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-and-over-time"><i class="fa fa-check"></i><b>33.11.2</b> Across Firms and Over Time</a></li>
<li class="chapter" data-level="33.11.3" data-path="aggregation.html"><a href="aggregation.html#statistical-tests-1"><i class="fa fa-check"></i><b>33.11.3</b> Statistical Tests</a></li>
</ul></li>
<li class="chapter" data-level="33.12" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>33.12</b> Heterogeneity in the Event Effect</a>
<ul>
<li class="chapter" data-level="33.12.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-affecting-car-in-marketing-and-finance"><i class="fa fa-check"></i><b>33.12.1</b> Common Variables Affecting CAR in Marketing and Finance</a></li>
</ul></li>
<li class="chapter" data-level="33.13" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>33.13</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="33.13.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.1</b> <strong>Statistical Models for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.13.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-models-for-expected-returns"><i class="fa fa-check"></i><b>33.13.2</b> <strong>Economic Models for Expected Returns</strong></a></li>
</ul></li>
<li class="chapter" data-level="33.14" data-path="application-of-event-study.html"><a href="application-of-event-study.html"><i class="fa fa-check"></i><b>33.14</b> Application of Event Study</a>
<ul>
<li class="chapter" data-level="33.14.1" data-path="application-of-event-study.html"><a href="application-of-event-study.html#sorting-portfolios-for-expected-returns"><i class="fa fa-check"></i><b>33.14.1</b> <strong>Sorting Portfolios for Expected Returns</strong></a></li>
<li class="chapter" data-level="33.14.2" data-path="application-of-event-study.html"><a href="application-of-event-study.html#erer-package"><i class="fa fa-check"></i><b>33.14.2</b> <strong><code>erer</code> Package</strong></a></li>
<li class="chapter" data-level="33.14.3" data-path="application-of-event-study.html"><a href="application-of-event-study.html#eventus"><i class="fa fa-check"></i><b>33.14.3</b> Eventus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="sec-instrumental-variables.html"><a href="sec-instrumental-variables.html"><i class="fa fa-check"></i><b>34</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.1" data-path="challenges-with-instrumental-variables.html"><a href="challenges-with-instrumental-variables.html"><i class="fa fa-check"></i><b>34.1</b> Challenges with Instrumental Variables</a></li>
<li class="chapter" data-level="34.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html"><i class="fa fa-check"></i><b>34.2</b> Framework for Instrumental Variables</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#constant-treatment-effect-model"><i class="fa fa-check"></i><b>34.2.1</b> Constant-Treatment-Effect Model</a></li>
<li class="chapter" data-level="34.2.2" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#instrumental-variable-solution"><i class="fa fa-check"></i><b>34.2.2</b> Instrumental Variable Solution</a></li>
<li class="chapter" data-level="34.2.3" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#heterogeneous-treatment-effects-and-the-late-framework"><i class="fa fa-check"></i><b>34.2.3</b> Heterogeneous Treatment Effects and the LATE Framework</a></li>
<li class="chapter" data-level="34.2.4" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#assumptions-for-late-identification"><i class="fa fa-check"></i><b>34.2.4</b> Assumptions for LATE Identification</a></li>
<li class="chapter" data-level="34.2.5" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#local-average-treatment-effect-theorem"><i class="fa fa-check"></i><b>34.2.5</b> Local Average Treatment Effect Theorem</a></li>
<li class="chapter" data-level="34.2.6" data-path="framework-for-instrumental-variables.html"><a href="framework-for-instrumental-variables.html#iv-in-randomized-trials-noncompliance"><i class="fa fa-check"></i><b>34.2.6</b> IV in Randomized Trials (Noncompliance)</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="sec-estimation.html"><a href="sec-estimation.html"><i class="fa fa-check"></i><b>34.3</b> Estimation</a>
<ul>
<li class="chapter" data-level="34.3.1" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-two-stage-least-squares-estimation"><i class="fa fa-check"></i><b>34.3.1</b> Two-Stage Least Squares Estimation</a></li>
<li class="chapter" data-level="34.3.2" data-path="sec-estimation.html"><a href="sec-estimation.html#iv-gmm"><i class="fa fa-check"></i><b>34.3.2</b> IV-GMM</a></li>
<li class="chapter" data-level="34.3.3" data-path="sec-estimation.html"><a href="sec-estimation.html#limited-information-maximum-likelihood"><i class="fa fa-check"></i><b>34.3.3</b> Limited Information Maximum Likelihood</a></li>
<li class="chapter" data-level="34.3.4" data-path="sec-estimation.html"><a href="sec-estimation.html#jackknife-iv"><i class="fa fa-check"></i><b>34.3.4</b> Jackknife IV</a></li>
<li class="chapter" data-level="34.3.5" data-path="sec-estimation.html"><a href="sec-estimation.html#sec-control-function-approach"><i class="fa fa-check"></i><b>34.3.5</b> Control Function Approach</a></li>
<li class="chapter" data-level="34.3.6" data-path="sec-estimation.html"><a href="sec-estimation.html#fuller-and-bias-reduced-iv"><i class="fa fa-check"></i><b>34.3.6</b> Fuller and Bias-Reduced IV</a></li>
</ul></li>
<li class="chapter" data-level="34.4" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html"><i class="fa fa-check"></i><b>34.4</b> Asymptotic Properties of the IV Estimator</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#sec-consistency-iv"><i class="fa fa-check"></i><b>34.4.1</b> Consistency</a></li>
<li class="chapter" data-level="34.4.2" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-normality-1"><i class="fa fa-check"></i><b>34.4.2</b> Asymptotic Normality</a></li>
<li class="chapter" data-level="34.4.3" data-path="asymptotic-properties-of-the-iv-estimator.html"><a href="asymptotic-properties-of-the-iv-estimator.html#asymptotic-efficiency-1"><i class="fa fa-check"></i><b>34.4.3</b> Asymptotic Efficiency</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html"><i class="fa fa-check"></i><b>34.5</b> Inference</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-weak-instruments-problem"><i class="fa fa-check"></i><b>34.5.1</b> Weak Instruments Problem</a></li>
<li class="chapter" data-level="34.5.2" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#solutions-and-approaches-for-valid-inference"><i class="fa fa-check"></i><b>34.5.2</b> Solutions and Approaches for Valid Inference</a></li>
<li class="chapter" data-level="34.5.3" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-anderson-rubin-approach"><i class="fa fa-check"></i><b>34.5.3</b> Anderson-Rubin Approach</a></li>
<li class="chapter" data-level="34.5.4" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-tf-procedure"><i class="fa fa-check"></i><b>34.5.4</b> tF Procedure</a></li>
<li class="chapter" data-level="34.5.5" data-path="sec-inference-iv.html"><a href="sec-inference-iv.html#sec-ak-approach"><i class="fa fa-check"></i><b>34.5.5</b> AK Approach</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>34.6</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="34.6.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-relevance-assumption"><i class="fa fa-check"></i><b>34.6.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="34.6.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#independence-unconfoundedness"><i class="fa fa-check"></i><b>34.6.2</b> Independence (Unconfoundedness)</a></li>
<li class="chapter" data-level="34.6.3" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-monotonicity-assumption"><i class="fa fa-check"></i><b>34.6.3</b> Monotonicity Assumption</a></li>
<li class="chapter" data-level="34.6.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html#homogeneous-treatment-effects-optional"><i class="fa fa-check"></i><b>34.6.4</b> Homogeneous Treatment Effects (Optional)</a></li>
<li class="chapter" data-level="34.6.5" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-linearity-and-additivity"><i class="fa fa-check"></i><b>34.6.5</b> Linearity and Additivity</a></li>
<li class="chapter" data-level="34.6.6" data-path="testing-assumptions.html"><a href="testing-assumptions.html#instrument-exogeneity-exclusion-restriction"><i class="fa fa-check"></i><b>34.6.6</b> Instrument Exogeneity (Exclusion Restriction)</a></li>
<li class="chapter" data-level="34.6.7" data-path="testing-assumptions.html"><a href="testing-assumptions.html#sec-exogeneity-assumption"><i class="fa fa-check"></i><b>34.6.7</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="34.7" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html"><i class="fa fa-check"></i><b>34.7</b> Cautions in IV</a>
<ul>
<li class="chapter" data-level="34.7.1" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#negative-r2-in-iv"><i class="fa fa-check"></i><b>34.7.1</b> Negative <span class="math inline">\(R^2\)</span> in IV</a></li>
<li class="chapter" data-level="34.7.2" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#sec-many-instruments-bias"><i class="fa fa-check"></i><b>34.7.2</b> Many-Instruments Bias</a></li>
<li class="chapter" data-level="34.7.3" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#heterogeneous-effects-in-iv-estimation"><i class="fa fa-check"></i><b>34.7.3</b> Heterogeneous Effects in IV Estimation</a></li>
<li class="chapter" data-level="34.7.4" data-path="cautions-in-iv.html"><a href="cautions-in-iv.html#zero-valued-outcomes"><i class="fa fa-check"></i><b>34.7.4</b> Zero-Valued Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="34.8" data-path="types-of-iv.html"><a href="types-of-iv.html"><i class="fa fa-check"></i><b>34.8</b> Types of IV</a>
<ul>
<li class="chapter" data-level="34.8.1" data-path="types-of-iv.html"><a href="types-of-iv.html#treatment-intensity"><i class="fa fa-check"></i><b>34.8.1</b> Treatment Intensity</a></li>
<li class="chapter" data-level="34.8.2" data-path="types-of-iv.html"><a href="types-of-iv.html#decision-maker-iv"><i class="fa fa-check"></i><b>34.8.2</b> Decision-Maker IV</a></li>
<li class="chapter" data-level="34.8.3" data-path="types-of-iv.html"><a href="types-of-iv.html#sec-proxy-variables"><i class="fa fa-check"></i><b>34.8.3</b> Proxy Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="sec-matching-methods.html"><a href="sec-matching-methods.html"><i class="fa fa-check"></i><b>35</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="35.1" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html"><i class="fa fa-check"></i><b>35.1</b> Introduction and Motivation</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#why-match"><i class="fa fa-check"></i><b>35.1.1</b> Why Match?</a></li>
<li class="chapter" data-level="35.1.2" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#matching-as-pruning"><i class="fa fa-check"></i><b>35.1.2</b> Matching as “Pruning”</a></li>
<li class="chapter" data-level="35.1.3" data-path="introduction-and-motivation.html"><a href="introduction-and-motivation.html#matching-with-did"><i class="fa fa-check"></i><b>35.1.3</b> Matching with DiD</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="key-assumptions-4.html"><a href="key-assumptions-4.html"><i class="fa fa-check"></i><b>35.2</b> Key Assumptions</a></li>
<li class="chapter" data-level="35.3" data-path="framework-for-generalization.html"><a href="framework-for-generalization.html"><i class="fa fa-check"></i><b>35.3</b> Framework for Generalization</a></li>
<li class="chapter" data-level="35.4" data-path="steps-for-matching.html"><a href="steps-for-matching.html"><i class="fa fa-check"></i><b>35.4</b> Steps for Matching</a>
<ul>
<li class="chapter" data-level="35.4.1" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-1-define-closeness-distance-metrics"><i class="fa fa-check"></i><b>35.4.1</b> Step 1: Define “Closeness” (Distance Metrics)</a></li>
<li class="chapter" data-level="35.4.2" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-2-matching-algorithms"><i class="fa fa-check"></i><b>35.4.2</b> Step 2: Matching Algorithms</a></li>
<li class="chapter" data-level="35.4.3" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-3-diagnosing-match-quality"><i class="fa fa-check"></i><b>35.4.3</b> Step 3: Diagnosing Match Quality</a></li>
<li class="chapter" data-level="35.4.4" data-path="steps-for-matching.html"><a href="steps-for-matching.html#step-4-estimating-treatment-effects"><i class="fa fa-check"></i><b>35.4.4</b> Step 4: Estimating Treatment Effects</a></li>
</ul></li>
<li class="chapter" data-level="35.5" data-path="special-considerations.html"><a href="special-considerations.html"><i class="fa fa-check"></i><b>35.5</b> Special Considerations</a></li>
<li class="chapter" data-level="35.6" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html"><i class="fa fa-check"></i><b>35.6</b> Choosing a Matching Strategy</a>
<ul>
<li class="chapter" data-level="35.6.1" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#based-on-estimand"><i class="fa fa-check"></i><b>35.6.1</b> Based on Estimand</a></li>
<li class="chapter" data-level="35.6.2" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#based-on-diagnostics"><i class="fa fa-check"></i><b>35.6.2</b> Based on Diagnostics</a></li>
<li class="chapter" data-level="35.6.3" data-path="choosing-a-matching-strategy.html"><a href="choosing-a-matching-strategy.html#selection-criteria"><i class="fa fa-check"></i><b>35.6.3</b> Selection Criteria</a></li>
</ul></li>
<li class="chapter" data-level="35.7" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html"><i class="fa fa-check"></i><b>35.7</b> Matching vs. Regression</a>
<ul>
<li class="chapter" data-level="35.7.1" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#matching-estimand"><i class="fa fa-check"></i><b>35.7.1</b> Matching Estimand</a></li>
<li class="chapter" data-level="35.7.2" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#regression-estimand"><i class="fa fa-check"></i><b>35.7.2</b> Regression Estimand</a></li>
<li class="chapter" data-level="35.7.3" data-path="matching-vs.-regression.html"><a href="matching-vs.-regression.html#interpretation-weighting-differences"><i class="fa fa-check"></i><b>35.7.3</b> Interpretation: Weighting Differences</a></li>
</ul></li>
<li class="chapter" data-level="35.8" data-path="software-and-practical-implementation.html"><a href="software-and-practical-implementation.html"><i class="fa fa-check"></i><b>35.8</b> Software and Practical Implementation</a></li>
<li class="chapter" data-level="35.9" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html"><i class="fa fa-check"></i><b>35.9</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="35.9.1" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-with-matchit"><i class="fa fa-check"></i><b>35.9.1</b> Matching with <code>MatchIt</code></a></li>
<li class="chapter" data-level="35.9.2" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#reporting-standards"><i class="fa fa-check"></i><b>35.9.2</b> Reporting Standards</a></li>
<li class="chapter" data-level="35.9.3" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#optimization-based-matching-via-designmatch"><i class="fa fa-check"></i><b>35.9.3</b> Optimization-Based Matching via <code>designmatch</code></a></li>
<li class="chapter" data-level="35.9.4" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>35.9.4</b> MatchingFrontier</a></li>
<li class="chapter" data-level="35.9.5" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-propensity-scores"><i class="fa fa-check"></i><b>35.9.5</b> Propensity Scores</a></li>
<li class="chapter" data-level="35.9.6" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-mahalanobis"><i class="fa fa-check"></i><b>35.9.6</b> Mahalanobis Distance Matching</a></li>
<li class="chapter" data-level="35.9.7" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-cem"><i class="fa fa-check"></i><b>35.9.7</b> Coarsened Exact Matching (CEM)</a></li>
<li class="chapter" data-level="35.9.8" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#sec-genetic-matching"><i class="fa fa-check"></i><b>35.9.8</b> Genetic Matching</a></li>
<li class="chapter" data-level="35.9.9" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>35.9.9</b> Entropy Balancing</a></li>
<li class="chapter" data-level="35.9.10" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>35.9.10</b> Matching for High-Dimensional Data</a></li>
<li class="chapter" data-level="35.9.11" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>35.9.11</b> Matching for Multiple Treatments</a></li>
<li class="chapter" data-level="35.9.12" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>35.9.12</b> Matching for Multi-Level Treatments</a></li>
<li class="chapter" data-level="35.9.13" data-path="sec-selection-on-observables.html"><a href="sec-selection-on-observables.html#matching-for-repeated-treatments-time-varying-treatments"><i class="fa fa-check"></i><b>35.9.13</b> Matching for Repeated Treatments (Time-Varying Treatments)</a></li>
</ul></li>
<li class="chapter" data-level="35.10" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html"><i class="fa fa-check"></i><b>35.10</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="35.10.1" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-rosenbaum-bounds"><i class="fa fa-check"></i><b>35.10.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="35.10.2" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-relative-correlation-restrictions"><i class="fa fa-check"></i><b>35.10.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="35.10.3" data-path="sec-selection-on-unobservables.html"><a href="sec-selection-on-unobservables.html#sec-coefficient-stability-bounds"><i class="fa fa-check"></i><b>35.10.3</b> Coefficient-Stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="36" data-path="sec-endogeneity.html"><a href="sec-endogeneity.html"><i class="fa fa-check"></i><b>36</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="36.1" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html"><i class="fa fa-check"></i><b>36.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-measurement-error"><i class="fa fa-check"></i><b>36.1.1</b> Measurement Errors</a></li>
<li class="chapter" data-level="36.1.2" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-simultaneity"><i class="fa fa-check"></i><b>36.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="36.1.3" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-reverse-causality"><i class="fa fa-check"></i><b>36.1.3</b> Reverse Causality</a></li>
<li class="chapter" data-level="36.1.4" data-path="sec-endogenous-treatment.html"><a href="sec-endogenous-treatment.html#sec-omitted-variable-bias"><i class="fa fa-check"></i><b>36.1.4</b> Omitted Variable Bias</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html"><i class="fa fa-check"></i><b>36.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#unifying-model-frameworks"><i class="fa fa-check"></i><b>36.2.1</b> Unifying Model Frameworks</a></li>
<li class="chapter" data-level="36.2.2" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#estimation-methods-2"><i class="fa fa-check"></i><b>36.2.2</b> Estimation Methods</a></li>
<li class="chapter" data-level="36.2.3" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#theoretical-connections"><i class="fa fa-check"></i><b>36.2.3</b> Theoretical Connections</a></li>
<li class="chapter" data-level="36.2.4" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#tobit-2-heckmans-sample-selection-model"><i class="fa fa-check"></i><b>36.2.4</b> Tobit-2: Heckman’s Sample Selection Model</a></li>
<li class="chapter" data-level="36.2.5" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#tobit-5-switching-regression-model"><i class="fa fa-check"></i><b>36.2.5</b> Tobit-5: Switching Regression Model</a></li>
<li class="chapter" data-level="36.2.6" data-path="sec-endogenous-sample-selection.html"><a href="sec-endogenous-sample-selection.html#sec-pattern-mixture-models"><i class="fa fa-check"></i><b>36.2.6</b> Pattern-Mixture Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>37</b> Other Biases</a>
<ul>
<li class="chapter" data-level="37.1" data-path="sec-aggregation-bias.html"><a href="sec-aggregation-bias.html"><i class="fa fa-check"></i><b>37.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="sec-aggregation-bias.html"><a href="sec-aggregation-bias.html#simpsons-paradox-1"><i class="fa fa-check"></i><b>37.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="sec-contamination-bias.html"><a href="sec-contamination-bias.html"><i class="fa fa-check"></i><b>37.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="37.3" data-path="sec-survivorship-bias.html"><a href="sec-survivorship-bias.html"><i class="fa fa-check"></i><b>37.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="37.4" data-path="sec-publication-bias.html"><a href="sec-publication-bias.html"><i class="fa fa-check"></i><b>37.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="sec-directed-acyclic-graphs.html"><a href="sec-directed-acyclic-graphs.html"><i class="fa fa-check"></i><b>38</b> Directed Acyclic Graphs</a>
<ul>
<li class="chapter" data-level="38.1" data-path="basic-notation-and-graph-structures.html"><a href="basic-notation-and-graph-structures.html"><i class="fa fa-check"></i><b>38.1</b> Basic Notation and Graph Structures</a></li>
<li class="chapter" data-level="38.2" data-path="rule-of-thumb-for-causal-inference.html"><a href="rule-of-thumb-for-causal-inference.html"><i class="fa fa-check"></i><b>38.2</b> Rule of Thumb for Causal Inference</a></li>
<li class="chapter" data-level="38.3" data-path="example-dag.html"><a href="example-dag.html"><i class="fa fa-check"></i><b>38.3</b> Example DAG</a></li>
<li class="chapter" data-level="38.4" data-path="causal-discovery.html"><a href="causal-discovery.html"><i class="fa fa-check"></i><b>38.4</b> Causal Discovery</a></li>
<li class="chapter" data-level="38.5" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>38.5</b> </a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="sec-controls.html"><a href="sec-controls.html"><i class="fa fa-check"></i><b>39</b> Controls</a>
<ul>
<li class="chapter" data-level="39.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>39.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="39.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>39.1.1</b> M-bias</a></li>
<li class="chapter" data-level="39.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification-1"><i class="fa fa-check"></i><b>39.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="39.1.3" data-path="bad-controls.html"><a href="bad-controls.html#sec-overcontrol-bias"><i class="fa fa-check"></i><b>39.1.3</b> Overcontrol Bias</a></li>
<li class="chapter" data-level="39.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>39.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="39.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>39.1.5</b> Case-Control Bias</a></li>
<li class="chapter" data-level="39.1.6" data-path="bad-controls.html"><a href="bad-controls.html#summary-3"><i class="fa fa-check"></i><b>39.1.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="39.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>39.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>39.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="39.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>39.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="39.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>39.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="39.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>39.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="39.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>39.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="39.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>39.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="39.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>39.3.4</b> Bad Selection Bias</a></li>
<li class="chapter" data-level="39.3.5" data-path="neutral-controls.html"><a href="neutral-controls.html#summary-table-predictive-vs.-causal-utility-of-controls"><i class="fa fa-check"></i><b>39.3.5</b> Summary Table: Predictive vs. Causal Utility of Controls</a></li>
</ul></li>
<li class="chapter" data-level="39.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>39.4</b> Choosing Controls</a>
<ul>
<li class="chapter" data-level="39.4.1" data-path="choosing-controls.html"><a href="choosing-controls.html#step-1-use-a-causal-diagram-dag"><i class="fa fa-check"></i><b>39.4.1</b> Step 1: Use a Causal Diagram (DAG)</a></li>
<li class="chapter" data-level="39.4.2" data-path="choosing-controls.html"><a href="choosing-controls.html#step-2-use-algorithmic-tools"><i class="fa fa-check"></i><b>39.4.2</b> Step 2: Use Algorithmic Tools</a></li>
<li class="chapter" data-level="39.4.3" data-path="choosing-controls.html"><a href="choosing-controls.html#step-3-theoretical-principles"><i class="fa fa-check"></i><b>39.4.3</b> Step 3: Theoretical Principles</a></li>
<li class="chapter" data-level="39.4.4" data-path="choosing-controls.html"><a href="choosing-controls.html#step-4-consider-sensitivity-analysis"><i class="fa fa-check"></i><b>39.4.4</b> Step 4: Consider Sensitivity Analysis</a></li>
<li class="chapter" data-level="39.4.5" data-path="choosing-controls.html"><a href="choosing-controls.html#step-5-know-when-not-to-control"><i class="fa fa-check"></i><b>39.4.5</b> Step 5: Know When Not to Control</a></li>
<li class="chapter" data-level="39.4.6" data-path="choosing-controls.html"><a href="choosing-controls.html#summary-control-selection-pipeline"><i class="fa fa-check"></i><b>39.4.6</b> Summary: Control Selection Pipeline</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="40" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>40</b> Report</a>
<ul>
<li class="chapter" data-level="40.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>40.1</b> One summary table</a></li>
<li class="chapter" data-level="40.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>40.2</b> Model Comparison</a></li>
<li class="chapter" data-level="40.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>40.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="40.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>40.4</b> Standard Errors</a></li>
<li class="chapter" data-level="40.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>40.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="40.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>40.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="40.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>40.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>41</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="42" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>42</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="42.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>42.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="42.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>42.1.1</b> starbility</a></li>
<li class="chapter" data-level="42.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>42.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="42.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>42.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="42.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>42.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>43</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>43.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="43.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>43.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="43.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>43.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="43.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>43.1.3</b> Exceptions to Replication</a></li>
<li class="chapter" data-level="43.1.4" data-path="the-replication-standard.html"><a href="the-replication-standard.html#replication-landscape"><i class="fa fa-check"></i><b>43.1.4</b> Replication Landscape</a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="synthetic-data.html"><a href="synthetic-data.html"><i class="fa fa-check"></i><b>43.2</b> Synthetic Data</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="synthetic-data.html"><a href="synthetic-data.html#benefits-of-synthetic-data"><i class="fa fa-check"></i><b>43.2.1</b> Benefits of Synthetic Data</a></li>
<li class="chapter" data-level="43.2.2" data-path="synthetic-data.html"><a href="synthetic-data.html#concerns-and-limitations"><i class="fa fa-check"></i><b>43.2.2</b> Concerns and Limitations</a></li>
<li class="chapter" data-level="43.2.3" data-path="synthetic-data.html"><a href="synthetic-data.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>43.2.3</b> Further Insights on Synthetic Data</a></li>
<li class="chapter" data-level="43.2.4" data-path="synthetic-data.html"><a href="synthetic-data.html#generating-synthetic-data"><i class="fa fa-check"></i><b>43.2.4</b> Generating Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>43.3</b> Application</a>
<ul>
<li class="chapter" data-level="43.3.1" data-path="application-5.html"><a href="application-5.html#original-dataset"><i class="fa fa-check"></i><b>43.3.1</b> Original Dataset</a></li>
<li class="chapter" data-level="43.3.2" data-path="application-5.html"><a href="application-5.html#restricted-dataset"><i class="fa fa-check"></i><b>43.3.2</b> Restricted Dataset</a></li>
<li class="chapter" data-level="43.3.3" data-path="application-5.html"><a href="application-5.html#synthpop"><i class="fa fa-check"></i><b>43.3.3</b> Synthpop</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="high-performance-computing.html"><a href="high-performance-computing.html"><i class="fa fa-check"></i><b>44</b> High-Performance Computing</a>
<ul>
<li class="chapter" data-level="44.1" data-path="best-practices-for-hpc-in-data-analysis.html"><a href="best-practices-for-hpc-in-data-analysis.html"><i class="fa fa-check"></i><b>44.1</b> Best Practices for HPC in Data Analysis</a></li>
<li class="chapter" data-level="44.2" data-path="example-workflow-in-r.html"><a href="example-workflow-in-r.html"><i class="fa fa-check"></i><b>44.2</b> Example Workflow in R</a></li>
<li class="chapter" data-level="44.3" data-path="recommendations.html"><a href="recommendations.html"><i class="fa fa-check"></i><b>44.3</b> Recommendations</a></li>
<li class="chapter" data-level="44.4" data-path="demonstration.html"><a href="demonstration.html"><i class="fa fa-check"></i><b>44.4</b> Demonstration</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="git.html"><a href="git.html#basic-setup-1"><i class="fa fa-check"></i><b>A.1.1</b> Basic Setup</a></li>
<li class="chapter" data-level="A.1.2" data-path="git.html"><a href="git.html#creating-a-repository"><i class="fa fa-check"></i><b>A.1.2</b> Creating a Repository</a></li>
<li class="chapter" data-level="A.1.3" data-path="git.html"><a href="git.html#tracking-changes"><i class="fa fa-check"></i><b>A.1.3</b> Tracking Changes</a></li>
<li class="chapter" data-level="A.1.4" data-path="git.html"><a href="git.html#viewing-history-and-changes"><i class="fa fa-check"></i><b>A.1.4</b> Viewing History and Changes</a></li>
<li class="chapter" data-level="A.1.5" data-path="git.html"><a href="git.html#ignoring-files"><i class="fa fa-check"></i><b>A.1.5</b> Ignoring Files</a></li>
<li class="chapter" data-level="A.1.6" data-path="git.html"><a href="git.html#remote-repositories"><i class="fa fa-check"></i><b>A.1.6</b> Remote Repositories</a></li>
<li class="chapter" data-level="A.1.7" data-path="git.html"><a href="git.html#collaboration"><i class="fa fa-check"></i><b>A.1.7</b> Collaboration</a></li>
<li class="chapter" data-level="A.1.8" data-path="git.html"><a href="git.html#branching-and-merging"><i class="fa fa-check"></i><b>A.1.8</b> Branching and Merging</a></li>
<li class="chapter" data-level="A.1.9" data-path="git.html"><a href="git.html#handling-conflicts"><i class="fa fa-check"></i><b>A.1.9</b> Handling Conflicts</a></li>
<li class="chapter" data-level="A.1.10" data-path="git.html"><a href="git.html#licensing"><i class="fa fa-check"></i><b>A.1.10</b> Licensing</a></li>
<li class="chapter" data-level="A.1.11" data-path="git.html"><a href="git.html#citing-repositories"><i class="fa fa-check"></i><b>A.1.11</b> Citing Repositories</a></li>
<li class="chapter" data-level="A.1.12" data-path="git.html"><a href="git.html#hosting-and-legal-considerations"><i class="fa fa-check"></i><b>A.1.12</b> Hosting and Legal Considerations</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install All Necessary Packages on Your Local Machine</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html#step-1-export-installed-packages-from-your-current-session"><i class="fa fa-check"></i><b>A.5.1</b> Step 1: Export Installed Packages from Your Current Session</a></li>
<li class="chapter" data-level="A.5.2" data-path="install-all-necessary-packages-on-your-local-machine.html"><a href="install-all-necessary-packages-on-your-local-machine.html#step-2-install-packages-on-a-new-machine"><i class="fa fa-check"></i><b>A.5.2</b> Step 2: Install Packages on a New Machine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="references.html"><a href="references.html#cluster-randomization"><i class="fa fa-check"></i><b>B.3.1</b> Cluster Randomization</a></li>
<li class="chapter" data-level="B.4" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html"><i class="fa fa-check"></i><b>B.4</b> 5 Methodological Blueprint for Applied Researchers</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#diagnosing-interference"><i class="fa fa-check"></i><b>B.4.1</b> 5.1 Diagnosing Interference</a></li>
<li class="chapter" data-level="B.4.2" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#cluster-construction-algorithm"><i class="fa fa-check"></i><b>B.4.2</b> 5.2 Cluster Construction Algorithm</a></li>
<li class="chapter" data-level="B.4.3" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#analysis-plan"><i class="fa fa-check"></i><b>B.4.3</b> 5.3 Analysis Plan</a></li>
<li class="chapter" data-level="B.4.4" data-path="methodological-blueprint-for-applied-researchers.html"><a href="methodological-blueprint-for-applied-researchers.html#practical-considerations-9"><i class="fa fa-check"></i><b>B.4.4</b> 5.4 Practical Considerations</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="extensions-and-research-opportunities.html"><a href="extensions-and-research-opportunities.html"><i class="fa fa-check"></i><b>B.5</b> 6 Extensions and Research Opportunities</a></li>
<li class="chapter" data-level="B.6" data-path="pre-experiment-checklist.html"><a href="pre-experiment-checklist.html"><i class="fa fa-check"></i><b>B.6</b> 7 Pre-Experiment Checklist</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="chapter-cluster-randomization-and-interference-bias.html"><a href="chapter-cluster-randomization-and-interference-bias.html"><i class="fa fa-check"></i><b>C</b> Chapter: Cluster Randomization and Interference Bias</a>
<ul>
<li class="chapter" data-level="C.1" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html"><i class="fa fa-check"></i><b>C.1</b> 6. Implementation: Practical Guidelines</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#constructing-clusters"><i class="fa fa-check"></i><b>C.1.1</b> 6.1 Constructing Clusters</a></li>
<li class="chapter" data-level="C.1.2" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#evaluating-cluster-quality"><i class="fa fa-check"></i><b>C.1.2</b> 6.2 Evaluating Cluster Quality</a></li>
<li class="chapter" data-level="C.1.3" data-path="implementation-practical-guidelines.html"><a href="implementation-practical-guidelines.html#trade-offs"><i class="fa fa-check"></i><b>C.1.3</b> 6.3 Trade-offs</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="limitations-and-open-questions.html"><a href="limitations-and-open-questions.html"><i class="fa fa-check"></i><b>C.2</b> 8. Limitations and Open Questions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-modern-estimators-for-staggered-adoption" class="section level2 hasAnchor" number="30.8">
<h2><span class="header-section-number">30.8</span> Modern Estimators for Staggered Adoption<a href="sec-modern-estimators-for-staggered-adoption.html#sec-modern-estimators-for-staggered-adoption" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sec-group-time-average-treatment-effects-callaway2021difference" class="section level3 hasAnchor" number="30.8.1">
<h3><span class="header-section-number">30.8.1</span> Group-Time Average Treatment Effects <span class="citation">(<a href="#ref-callaway2021difference">Callaway and Sant’Anna 2021</a>)</span><a href="sec-modern-estimators-for-staggered-adoption.html#sec-group-time-average-treatment-effects-callaway2021difference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Notation Recap</strong></p>
<ul>
<li><p><span class="math inline">\(Y_{it}(0)\)</span>: Potential outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> in the absence of treatment.</p></li>
<li><p><span class="math inline">\(Y_{it}(g)\)</span>: Potential outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> if first treated in period <span class="math inline">\(g\)</span>.</p></li>
<li><p><span class="math inline">\(Y_{it}\)</span>: Observed outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
Y_{it} =
\begin{cases}
Y_{it}(0), &amp; \text{if unit } i \text{ never treated ( } C_i = 1 \text{)} \\
1\{G_i &gt; t\} Y_{it}(0) + 1\{G_i \le t\} Y_{it}(G_i), &amp; \text{otherwise}
\end{cases}
\]</span></p></li>
<li><p><span class="math inline">\(G_i\)</span>: Group assignment, i.e., the time period when unit <span class="math inline">\(i\)</span> first receives treatment.</p></li>
<li><p><span class="math inline">\(C_i = 1\)</span>: Indicator that unit <span class="math inline">\(i\)</span> never receives treatment (the never-treated group).</p></li>
<li><p><span class="math inline">\(D_{it} = 1\{G_i \le t\}\)</span>: Indicator that unit <span class="math inline">\(i\)</span> has been treated by time <span class="math inline">\(t\)</span>.</p></li>
</ul>
<hr />
<p><strong>Assumptions</strong></p>
<p>The following assumptions are typically imposed to identify treatment effects in staggered adoption settings.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Staggered Treatment Adoption</strong><br />
Once treated, a unit remains treated in all subsequent periods.<br />
Formally, <span class="math inline">\(D_{it}\)</span> is non-decreasing in <span class="math inline">\(t\)</span>.</p></li>
<li><p><strong>Parallel Trends Assumptions</strong> (Conditional or Unconditional on Covariates)</p>
<p>Two common variants:</p>
<ul>
<li><strong>Parallel trends based on never-treated units</strong>: <span class="math display">\[
\mathbb{E}[Y_t(0) - Y_{t-1}(0) | G_i = g] = \mathbb{E}[Y_t(0) - Y_{t-1}(0) | C_i = 1]
\]</span> Interpretation:
<ul>
<li>The average potential outcome trends of the treated group (<span class="math inline">\(G_i = g\)</span>) are the same as the <strong>never-treated</strong> group, absent treatment.</li>
</ul></li>
<li><strong>Parallel trends based on not-yet-treated units</strong>: <span class="math display">\[
\mathbb{E}[Y_t(0) - Y_{t-1}(0) | G_i = g] = \mathbb{E}[Y_t(0) - Y_{t-1}(0) | D_{is} = 0, G_i \ne g]
\]</span> Interpretation:
<ul>
<li>Units <strong>not yet treated</strong> by time <span class="math inline">\(s\)</span> (<span class="math inline">\(D_{is} = 0\)</span>) can serve as controls for units first treated at <span class="math inline">\(g\)</span>.</li>
</ul></li>
</ul>
<p>These assumptions can also be <strong>conditional on covariates</strong> <span class="math inline">\(X\)</span>, as:</p>
<p><span class="math display">\[
\mathbb{E}[Y_t(0) - Y_{t-1}(0) | X_i, G_i = g] = \mathbb{E}[Y_t(0) - Y_{t-1}(0) | X_i, C_i = 1]
\]</span></p></li>
<li><p><strong>Random Sampling</strong><br />
Units are sampled independently and identically from the population.</p></li>
<li><p><strong>Irreversibility of Treatment</strong><br />
Once treated, units do not revert to untreated status.</p></li>
<li><p><strong>Overlap (Positivity)</strong><br />
For each group <span class="math inline">\(g\)</span>, the propensity of receiving treatment at <span class="math inline">\(g\)</span> lies strictly within <span class="math inline">\((0, 1)\)</span>: <span class="math display">\[
0 &lt; \mathbb{P}(G_i = g | X_i) &lt; 1
\]</span></p></li>
</ol>
<hr />
<p>The Group-Time <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">ATT</a>, <span class="math inline">\(ATT(g, t)\)</span>, measures the average treatment effect for units first treated in period <span class="math inline">\(g\)</span>, evaluated at time <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
ATT(g, t) = \mathbb{E}[Y_t(g) - Y_t(0) | G_i = g]
\]</span></p>
<p>Interpretation:</p>
<ul>
<li><p><span class="math inline">\(g\)</span> indexes when the group first receives treatment.</p></li>
<li><p><span class="math inline">\(t\)</span> is the time period when the effect is evaluated.</p></li>
<li><p><span class="math inline">\(ATT(g, t)\)</span> captures how treatment effects evolve over time, following adoption at time <span class="math inline">\(g\)</span>.</p></li>
</ul>
<hr />
<p>Identification of <span class="math inline">\(ATT(g, t)\)</span></p>
<ol style="list-style-type: decimal">
<li><p><strong>Using Never-Treated Units as Controls</strong>: <span class="math display">\[
ATT(g, t) = \mathbb{E}[Y_t - Y_{g-1} | G_i = g] - \mathbb{E}[Y_t - Y_{g-1} | C_i = 1], \quad \forall t \ge g
\]</span></p></li>
<li><p><strong>Using Not-Yet-Treated Units as Controls</strong>: <span class="math display">\[
ATT(g, t) = \mathbb{E}[Y_t - Y_{g-1} | G_i = g] - \mathbb{E}[Y_t - Y_{g-1} | D_{it} = 0, G_i \ne g], \quad \forall t \ge g
\]</span></p></li>
<li><p><strong>Conditional Parallel Trends (with Covariates)</strong>:<br />
If treatment assignment depends on covariates <span class="math inline">\(X_i\)</span>, adjust the parallel trends assumption:</p>
<ul>
<li><strong>Never-treated controls</strong>: <span class="math display">\[
ATT(g, t) = \mathbb{E}[Y_t - Y_{g-1} | X_i, G_i = g] - \mathbb{E}[Y_t - Y_{g-1} | X_i, C_i = 1], \quad \forall t \ge g
\]</span></li>
<li><strong>Not-yet-treated controls</strong>: <span class="math display">\[
ATT(g, t) = \mathbb{E}[Y_t - Y_{g-1} | X_i, G_i = g] - \mathbb{E}[Y_t - Y_{g-1} | X_i, D_{it} = 0, G_i \ne g], \quad \forall t \ge g
\]</span></li>
</ul></li>
</ol>
<hr />
<p>Aggregating <span class="math inline">\(ATT(g, t)\)</span>: Common Parameters of Interest</p>
<ol style="list-style-type: decimal">
<li><p><a href="types-of-treatment-effects.html#sec-average-treatment-effect">Average Treatment Effect</a> per Group (<span class="math inline">\(\theta_S(g)\)</span>):<br />
Average effect over all periods after treatment for group <span class="math inline">\(g\)</span>: <span class="math display">\[
\theta_S(g) = \frac{1}{\tau - g + 1} \sum_{t = g}^{\tau} ATT(g, t)
\]</span></p>
<ul>
<li><span class="math inline">\(\tau\)</span>: Last time period in the panel.</li>
</ul></li>
<li><p>Overall <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">Average Treatment Effect on the Treated</a> (ATT) (<span class="math inline">\(\theta_S^O\)</span>):<br />
Weighted average of <span class="math inline">\(\theta_S(g)\)</span> across groups <span class="math inline">\(g\)</span>, weighted by their group size: <span class="math display">\[
\theta_S^O = \sum_{g=2}^{\tau} \theta_S(g) \cdot \mathbb{P}(G_i = g)
\]</span></p></li>
<li><p><strong>Dynamic Treatment Effects</strong> (<span class="math inline">\(\theta_D(e)\)</span>):<br />
Average effect after <span class="math inline">\(e\)</span> periods of treatment exposure: <span class="math display">\[
\theta_D(e) = \sum_{g=2}^{\tau} \mathbb{1}\{g + e \le \tau\} \cdot ATT(g, g + e) \cdot \mathbb{P}(G_i = g | g + e \le \tau)
\]</span></p></li>
<li><p><strong>Calendar Time Treatment Effects</strong> (<span class="math inline">\(\theta_C(t)\)</span>):<br />
Average treatment effect at time <span class="math inline">\(t\)</span> across all groups treated by <span class="math inline">\(t\)</span>: <span class="math display">\[
\theta_C(t) = \sum_{g=2}^{\tau} \mathbb{1}\{g \le t\} \cdot ATT(g, t) \cdot \mathbb{P}(G_i = g | g \le t)
\]</span></p></li>
<li><p><strong>Average Calendar Time Treatment Effect</strong> (<span class="math inline">\(\theta_C\)</span>):<br />
Average of <span class="math inline">\(\theta_C(t)\)</span> across all post-treatment periods: <span class="math display">\[
\theta_C = \frac{1}{\tau - 1} \sum_{t=2}^{\tau} \theta_C(t)
\]</span></p></li>
</ol>
<p>The <code>staggered()</code> function offers several estimands, each defining a different way of aggregating group-time average treatment effects into a single overall treatment effect:</p>
<ul>
<li><p>Simple: Equally weighted across all groups.</p></li>
<li><p>Cohort: Weighted by group sizes (i.e., treated cohorts).</p></li>
<li><p>Calendar: Weighted by the number of observations in each calendar time.</p></li>
</ul>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-1" tabindex="-1"></a><span class="fu">library</span>(staggered) </span>
<span id="cb771-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-2" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb771-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb771-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-4" tabindex="-1"></a></span>
<span id="cb771-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-5" tabindex="-1"></a><span class="co"># Simple weighted average ATT</span></span>
<span id="cb771-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-6" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb771-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-7" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb771-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-8" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb771-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-9" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb771-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-10" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb771-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb771-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-12" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb771-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-13" tabindex="-1"></a>)</span>
<span id="cb771-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-14" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb771-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-15" tabindex="-1"></a><span class="co">#&gt; 1 -0.7110941 0.2211943 0.2214245</span></span>
<span id="cb771-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-16" tabindex="-1"></a></span>
<span id="cb771-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-17" tabindex="-1"></a><span class="co"># Cohort weighted ATT (i.e., by treatment cohort size)</span></span>
<span id="cb771-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-18" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb771-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-19" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb771-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-20" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb771-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-21" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb771-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-22" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb771-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-23" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb771-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-24" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;cohort&quot;</span></span>
<span id="cb771-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-25" tabindex="-1"></a>)</span>
<span id="cb771-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-26" tabindex="-1"></a><span class="co">#&gt;    estimate        se se_neyman</span></span>
<span id="cb771-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-27" tabindex="-1"></a><span class="co">#&gt; 1 -2.724242 0.2701093 0.2701745</span></span>
<span id="cb771-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-28" tabindex="-1"></a></span>
<span id="cb771-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-29" tabindex="-1"></a><span class="co"># Calendar weighted ATT (i.e., by year)</span></span>
<span id="cb771-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-30" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb771-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-31" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb771-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-32" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb771-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-33" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb771-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-34" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb771-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb771-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-36" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;calendar&quot;</span></span>
<span id="cb771-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-37" tabindex="-1"></a>)</span>
<span id="cb771-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-38" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb771-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb771-39" tabindex="-1"></a><span class="co">#&gt; 1 -0.5861831 0.1768297 0.1770729</span></span></code></pre></div>
<p>To visualize treatment dynamics around the time of adoption, the event study specification estimates dynamic treatment effects relative to the time of treatment.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">staggered</span>(</span>
<span id="cb772-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-2" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb772-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-3" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb772-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-4" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb772-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-5" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb772-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-6" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb772-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-7" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;eventstudy&quot;</span>, </span>
<span id="cb772-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-8" tabindex="-1"></a>    <span class="at">eventTime =</span> <span class="sc">-</span><span class="dv">9</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb772-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-9" tabindex="-1"></a>)</span>
<span id="cb772-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-10" tabindex="-1"></a></span>
<span id="cb772-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-11" tabindex="-1"></a><span class="co"># Plotting the event study with pointwise confidence intervals</span></span>
<span id="cb772-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-12" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb772-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-13" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb772-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-14" tabindex="-1"></a></span>
<span id="cb772-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-15" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb772-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-16" tabindex="-1"></a>    res <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb772-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-17" tabindex="-1"></a>        <span class="at">ymin_ptwise =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb772-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-18" tabindex="-1"></a>        <span class="at">ymax_ptwise =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb772-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-19" tabindex="-1"></a>    ),</span>
<span id="cb772-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-20" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> eventTime, <span class="at">y =</span> estimate)</span>
<span id="cb772-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-21" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb772-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-22" tabindex="-1"></a>    <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ymin_ptwise, <span class="at">ymax =</span> ymax_ptwise)) <span class="sc">+</span></span>
<span id="cb772-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-23" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb772-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-24" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;Event Time&quot;</span>) <span class="sc">+</span></span>
<span id="cb772-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-25" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;ATT Estimate&quot;</span>) <span class="sc">+</span></span>
<span id="cb772-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-26" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Event Study: Dynamic Treatment Effects&quot;</span>) <span class="sc">+</span></span>
<span id="cb772-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb772-27" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>The <code>staggered</code> package also includes direct implementations of alternative estimators:</p>
<ul>
<li><p><code>staggered_cs()</code> implements the <span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span> estimator.</p></li>
<li><p><code>staggered_sa()</code> implements the <span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> estimator, which adjusts for bias from comparisons involving already-treated units.</p></li>
</ul>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-1" tabindex="-1"></a><span class="co"># Callaway and Sant’Anna estimator</span></span>
<span id="cb773-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-2" tabindex="-1"></a><span class="fu">staggered_cs</span>(</span>
<span id="cb773-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-3" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb773-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-4" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb773-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-5" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb773-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-6" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb773-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb773-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-8" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb773-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-9" tabindex="-1"></a>)</span>
<span id="cb773-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-10" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb773-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-11" tabindex="-1"></a><span class="co">#&gt; 1 -0.7994889 0.4484987 0.4486122</span></span>
<span id="cb773-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-12" tabindex="-1"></a></span>
<span id="cb773-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-13" tabindex="-1"></a><span class="co"># Sun and Abraham estimator</span></span>
<span id="cb773-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-14" tabindex="-1"></a><span class="fu">staggered_sa</span>(</span>
<span id="cb773-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-15" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb773-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-16" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb773-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-17" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb773-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-18" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb773-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-19" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb773-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-20" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span></span>
<span id="cb773-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-21" tabindex="-1"></a>)</span>
<span id="cb773-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-22" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman</span></span>
<span id="cb773-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb773-23" tabindex="-1"></a><span class="co">#&gt; 1 -0.7551901 0.4407818 0.4409525</span></span></code></pre></div>
<p>To assess statistical significance under the sharp null hypothesis <span class="math inline">\(H_0: \text{TE} = 0\)</span>, the <code>staggered</code> package includes an option for Fisher’s randomization (permutation) test. This approach tests whether the observed estimate could plausibly occur under a random reallocation of treatment timings.</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-1" tabindex="-1"></a><span class="co"># Fisher Randomization Test</span></span>
<span id="cb774-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-2" tabindex="-1"></a><span class="fu">staggered</span>(</span>
<span id="cb774-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-3" tabindex="-1"></a>    <span class="at">df =</span> base_stagg,</span>
<span id="cb774-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-4" tabindex="-1"></a>    <span class="at">i =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb774-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-5" tabindex="-1"></a>    <span class="at">t =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb774-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-6" tabindex="-1"></a>    <span class="at">g =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb774-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb774-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-8" tabindex="-1"></a>    <span class="at">estimand =</span> <span class="st">&quot;simple&quot;</span>,</span>
<span id="cb774-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-9" tabindex="-1"></a>    <span class="at">compute_fisher =</span> <span class="cn">TRUE</span>,</span>
<span id="cb774-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-10" tabindex="-1"></a>    <span class="at">num_fisher_permutations =</span> <span class="dv">100</span></span>
<span id="cb774-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-11" tabindex="-1"></a>)</span>
<span id="cb774-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-12" tabindex="-1"></a><span class="co">#&gt;     estimate        se se_neyman fisher_pval fisher_pval_se_neyman</span></span>
<span id="cb774-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-13" tabindex="-1"></a><span class="co">#&gt; 1 -0.7110941 0.2211943 0.2214245           0                     0</span></span>
<span id="cb774-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-14" tabindex="-1"></a><span class="co">#&gt;   num_fisher_permutations</span></span>
<span id="cb774-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb774-15" tabindex="-1"></a><span class="co">#&gt; 1                     100</span></span></code></pre></div>
<p>This test provides a non-parametric method for inference and is particularly useful when the number of groups is small or standard errors are unreliable due to clustering or heteroskedasticity.</p>
<hr />
</div>
<div id="sec-cohort-average-treatment-effects-sun2021estimating" class="section level3 hasAnchor" number="30.8.2">
<h3><span class="header-section-number">30.8.2</span> Cohort Average Treatment Effects <span class="citation">(<a href="#ref-sun2021estimating">L. Sun and Abraham 2021</a>)</span><a href="sec-modern-estimators-for-staggered-adoption.html#sec-cohort-average-treatment-effects-sun2021estimating" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> propose a solution to the TWFE problem in staggered adoption settings by introducing an interaction-weighted estimator for dynamic treatment effects. This estimator is based on the concept of <strong>Cohort Average Treatment Effects on the Treated (CATT)</strong>, which accounts for variation in treatment timing and dynamic treatment responses.</p>
<p>Traditional TWFE estimators implicitly assume <strong>homogeneous treatment effects</strong> and often rely on treated units serving as controls for later-treated units. When treatment effects vary over time or across groups, this leads to <strong>contaminated comparisons</strong>, especially in event-study specifications.</p>
<p><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> address this issue by:</p>
<ul>
<li><p>Estimating cohort-specific treatment effects relative to time since treatment.</p></li>
<li><p>Using never-treated units as controls, or in their absence, the last-treated cohort.</p></li>
</ul>
<div id="defining-the-parameter-of-interest-catt" class="section level4 hasAnchor" number="30.8.2.1">
<h4><span class="header-section-number">30.8.2.1</span> Defining the Parameter of Interest: CATT<a href="sec-modern-estimators-for-staggered-adoption.html#defining-the-parameter-of-interest-catt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(E_i = e\)</span> denote the period when unit <span class="math inline">\(i\)</span> first receives treatment. The <strong>cohort-specific average treatment effect on the treated</strong> (CATT) is defined as: <span class="math display">\[
CATT_{e, l} = \mathbb{E}[Y_{i, e + l} - Y_{i, e + l}^\infty \mid E_i = e]
\]</span> Where:</p>
<ul>
<li><p><span class="math inline">\(l\)</span> is the relative period (e.g., <span class="math inline">\(l = -1\)</span> is one year before treatment, <span class="math inline">\(l = 0\)</span> is the treatment year).</p></li>
<li><p><span class="math inline">\(Y_{i, e + l}^\infty\)</span> is the potential outcome without treatment.</p></li>
<li><p><span class="math inline">\(Y_{i, e + l}\)</span> is the observed outcome.</p></li>
</ul>
<p>This formulation allows one to trace out the dynamic effect of treatment for each cohort, relative to their treatment start time.</p>
<p><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> extend the interaction-weighted idea to panel settings, originally introduced by <span class="citation">Gibbons, Suárez Serrato, and Urbancic (<a href="#ref-gibbons2018broken">2018</a>)</span> in a cross-sectional context.</p>
<p>They propose regressing the outcome on:</p>
<ul>
<li><p>Relative time indicators constructed by interacting treatment cohort (<span class="math inline">\(E_i\)</span>) with time (<span class="math inline">\(t\)</span>).</p></li>
<li><p>Unit and time fixed effects.</p></li>
</ul>
<p>This method explicitly estimates <span class="math inline">\(CATT_{e, l}\)</span> terms, avoiding the contaminating influence of already-treated units that TWFE models often suffer from.</p>
<p><strong>Relative Period Bin Indicator</strong></p>
<p><span class="math display">\[ D_{it}^l = \mathbb{1}(t - E_i = l) \]</span></p>
<ul>
<li><span class="math inline">\(E_i\)</span>: The time period when unit <span class="math inline">\(i\)</span> first receives treatment.</li>
<li><span class="math inline">\(l\)</span>: The <strong>relative time period</strong>—how many periods have passed since treatment began.</li>
</ul>
<ol style="list-style-type: decimal">
<li><strong>Static Specification</strong></li>
</ol>
<p><span class="math display">\[ Y_{it} = \alpha_i + \lambda_t + \mu_g \sum_{l \ge 0} D_{it}^l + \epsilon_{it} \]</span></p>
<ul>
<li><span class="math inline">\(\alpha_i\)</span>: Unit fixed effects.</li>
<li><span class="math inline">\(\lambda_t\)</span>: Time fixed effects.</li>
<li><span class="math inline">\(\mu_g\)</span>: Effect for group <span class="math inline">\(g\)</span>.</li>
<li>Excludes periods <strong>prior to treatment</strong>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Dynamic Specification</strong></li>
</ol>
<p><span class="math display">\[ Y_{it} = \alpha_i + \lambda_t + \sum_{\substack{l = -K \\ l \neq -1}}^{L} \mu_l D_{it}^l + \epsilon_{it} \]</span></p>
<ul>
<li>Includes leads and lags of treatment indicators <span class="math inline">\(D_{it}^l\)</span>.</li>
<li>Excludes one period (typically <span class="math inline">\(l = -1\)</span>) to avoid perfect collinearity.</li>
<li>Tests for pre-treatment parallel trends rely on the leads (<span class="math inline">\(l &lt; 0\)</span>).</li>
</ul>
<hr />
</div>
<div id="identifying-assumptions" class="section level4 hasAnchor" number="30.8.2.2">
<h4><span class="header-section-number">30.8.2.2</span> Identifying Assumptions<a href="sec-modern-estimators-for-staggered-adoption.html#identifying-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><strong>Parallel Trends</strong></li>
</ol>
<p>For identification, it is assumed that untreated potential outcomes follow parallel trends across cohorts in the absence of treatment: <span class="math display">\[
\mathbb{E}[Y_{it}^\infty - Y_{i, t-1}^\infty \mid E_i = e] = \text{constant across } e
\]</span> This allows us to use <strong>never-treated</strong> or <strong>not-yet-treated</strong> units as valid counterfactuals.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>No Anticipatory Effects</strong></li>
</ol>
<p>Treatment should not influence outcomes before it is implemented. That is: <span class="math display">\[
CATT_{e, l} = 0 \quad \text{for all } l &lt; 0
\]</span> This ensures that any pre-trends are not driven by behavioral changes in anticipation of treatment.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Treatment Effect Homogeneity (Optional)</strong></li>
</ol>
<p>The treatment effect is consistent across cohorts for each relative period. Each adoption cohort should have the same path of treatment effects. In other words, the trajectory of each treatment cohort is similar.</p>
<p>Although <span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> allow treatment effect heterogeneity, some settings may assume homogeneous effects within cohorts and periods:</p>
<ul>
<li><p>Each cohort has the same pattern of response over time.</p></li>
<li><p>This is relaxed in their design but assumed in simpler TWFE settings.</p></li>
</ul>
</div>
<div id="comparison-to-other-designs" class="section level4 hasAnchor" number="30.8.2.3">
<h4><span class="header-section-number">30.8.2.3</span> Comparison to Other Designs<a href="sec-modern-estimators-for-staggered-adoption.html#comparison-to-other-designs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Different DiD designs make distinct assumptions about how treatment effects vary:</p>
<table style="width:99%;">
<colgroup>
<col width="15%" />
<col width="10%" />
<col width="12%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>Study</th>
<th>Vary Over Time</th>
<th>Vary Across Cohorts</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span></td>
<td>✓</td>
<td>✓</td>
<td>Allows full heterogeneity</td>
</tr>
<tr class="even">
<td><span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span></td>
<td>✓</td>
<td>✓</td>
<td>Estimates group × time ATTs</td>
</tr>
<tr class="odd">
<td><span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span></td>
<td>✓</td>
<td>✗</td>
<td><p>Homogeneous across cohorts</p>
<p>Heterogeneity over time</p></td>
</tr>
<tr class="even">
<td><span class="citation">Athey and Imbens (<a href="#ref-athey2022design">2022</a>)</span></td>
<td>✗</td>
<td>✓</td>
<td>Heterogeneity only across adoption cohorts</td>
</tr>
<tr class="odd">
<td><span class="citation">Clement De Chaisemartin and D’haultfœuille (<a href="#ref-de2023two">2023</a>)</span></td>
<td>✓</td>
<td>✓</td>
<td>Complete heterogeneity</td>
</tr>
<tr class="even">
<td><span class="citation">Goodman-Bacon (<a href="#ref-goodman2021difference">2021</a>)</span></td>
<td>✓ or ✗</td>
<td>✗ or ✓</td>
<td><p>Restricts one dimension</p>
<p>Heterogeneity either “vary across units but not over time” or “vary over time but not across units”.</p></td>
</tr>
</tbody>
</table>
</div>
<div id="sources-of-treatment-effect-heterogeneity" class="section level4 hasAnchor" number="30.8.2.4">
<h4><span class="header-section-number">30.8.2.4</span> Sources of Treatment Effect Heterogeneity<a href="sec-modern-estimators-for-staggered-adoption.html#sources-of-treatment-effect-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Several forces can generate heterogeneous treatment effects:</p>
<ul>
<li><p><strong>Calendar Time Effects</strong>: Macro events (e.g., recessions, policy changes) affect cohorts differently.</p></li>
<li><p><strong>Selection into Timing</strong>: Units self-select into early/late treatment based on anticipated effects.</p></li>
<li><p><strong>Composition Differences</strong>: Adoption cohorts may differ in observed or unobserved ways.</p></li>
</ul>
<p>Such heterogeneity can bias TWFE estimates, which often average effects across incomparable groups.</p>
<hr />
</div>
<div id="technical-issues" class="section level4 hasAnchor" number="30.8.2.5">
<h4><span class="header-section-number">30.8.2.5</span> Technical Issues<a href="sec-modern-estimators-for-staggered-adoption.html#technical-issues" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When using an event-study TWFE regression to estimate dynamic treatment effects in staggered adoption settings, one must exclude certain relative time indicators to avoid perfect multicollinearity. This arises because relative period indicators are linearly dependent due to the presence of unit and time fixed effects.</p>
<p>Specifically, the following two terms must be addressed:</p>
<ul>
<li><p><strong>The period immediately before treatment</strong> (<span class="math inline">\(l = -1\)</span>): This period is typically omitted and serves as the baseline for comparison. This normalization has been standard practice in event study regressions prior to <span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> .</p></li>
<li><p><strong>A distant post-treatment period</strong> (e.g., <span class="math inline">\(l = +5\)</span> or <span class="math inline">\(l = +10\)</span>): <span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> clarified that in addition to the baseline period, at least one other relative time indicator—typically from the far tail of the post-treatment distribution—must be dropped, binned, or trimmed to avoid multicollinearity among the relative time dummies. This issue emerges because fixed effects absorb much of the within-unit and within-time variation, reducing the effective rank of the design matrix.</p></li>
</ul>
<p>Dropping certain relative periods (especially pre-treatment periods) introduces an implicit normalization: the estimates for included periods are now interpreted relative to the omitted periods. If treatment effects are present in these omitted periods—say, due to anticipation or early effects—this will contaminate the estimates of included relative periods.</p>
<p>To avoid this contamination, researchers often assume that all pre-treatment periods have zero treatment effect, i.e.,</p>
<p><span class="math display">\[
CATT_{e, l} = 0 \quad \text{for all } l &lt; 0
\]</span></p>
<p>This assumption ensures that excluded pre-treatment periods form a valid counterfactual, and estimates for <span class="math inline">\(l \geq 0\)</span> are not biased due to normalization.</p>
<hr />
<p><span class="citation">L. Sun and Abraham (<a href="#ref-sun2021estimating">2021</a>)</span> resolve the issues of weighting and aggregation by using a clean weighting scheme that avoids contamination from excluded periods. Their method produces a weighted average of cohort- and time-specific treatment effects (<span class="math inline">\(CATT_{e, l}\)</span>), where the weights are:</p>
<ul>
<li><strong>Non-negative</strong></li>
<li><strong>Sum to one</strong></li>
<li><strong>Interpretable as the fraction of treated units who are observed</strong> <span class="math inline">\(l\)</span> periods after treatment, normalized over the number of available periods <span class="math inline">\(g\)</span></li>
</ul>
<p>This interaction-weighted estimator ensures that the estimated average treatment effect reflects a convex combination of dynamic treatment effects from different cohorts and times.</p>
<p>In this way, their aggregation logic closely mirrors that of <span class="citation">Callaway and Sant’Anna (<a href="#ref-callaway2021difference">2021</a>)</span>, who also construct average treatment effects from group-time ATTs using interpretable weights that align with the sampling structure.</p>
<hr />
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-1" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb775-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb775-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-3" tabindex="-1"></a></span>
<span id="cb775-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-4" tabindex="-1"></a><span class="co"># Estimate Sun &amp; Abraham interaction-weighted model</span></span>
<span id="cb775-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-5" tabindex="-1"></a>res_sa20 <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb775-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-6" tabindex="-1"></a>  y <span class="sc">~</span> x1 <span class="sc">+</span> <span class="fu">sunab</span>(year_treated, year) <span class="sc">|</span> id <span class="sc">+</span> year,</span>
<span id="cb775-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-7" tabindex="-1"></a>  <span class="at">data =</span> base_stagg</span>
<span id="cb775-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb775-8" tabindex="-1"></a>)</span></code></pre></div>
<p>Use <code>iplot()</code> to visualize the estimated dynamic treatment effects across relative time:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb776-1" tabindex="-1"></a><span class="fu">iplot</span>(res_sa20)</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>You can summarize the results using different aggregation options:</p>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-1" tabindex="-1"></a><span class="co"># Overall average ATT</span></span>
<span id="cb777-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-2" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="st">&quot;att&quot;</span>)</span>
<span id="cb777-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-3" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb777-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-4" tabindex="-1"></a><span class="co">#&gt; Observations: 950</span></span>
<span id="cb777-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-5" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 95,  year: 10</span></span>
<span id="cb777-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-6" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb777-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-7" tabindex="-1"></a><span class="co">#&gt;      Estimate Std. Error  t value  Pr(&gt;|t|)    </span></span>
<span id="cb777-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-8" tabindex="-1"></a><span class="co">#&gt; x1   0.994678   0.018378 54.12293 &lt; 2.2e-16 ***</span></span>
<span id="cb777-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-9" tabindex="-1"></a><span class="co">#&gt; ATT -1.133749   0.205070 -5.52858 2.882e-07 ***</span></span>
<span id="cb777-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-10" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb777-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-11" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb777-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-12" tabindex="-1"></a><span class="co">#&gt; RMSE: 0.921817     Adj. R2: 0.887984</span></span>
<span id="cb777-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-13" tabindex="-1"></a><span class="co">#&gt;                  Within R2: 0.876406</span></span>
<span id="cb777-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-14" tabindex="-1"></a></span>
<span id="cb777-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-15" tabindex="-1"></a><span class="co"># Aggregation across post-treatment periods (excluding leads)</span></span>
<span id="cb777-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-16" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="fu">c</span>(<span class="st">&quot;att&quot;</span> <span class="ot">=</span> <span class="st">&quot;year::[^-]&quot;</span>))</span>
<span id="cb777-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-17" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb777-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-18" tabindex="-1"></a><span class="co">#&gt; Observations: 950</span></span>
<span id="cb777-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-19" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 95,  year: 10</span></span>
<span id="cb777-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-20" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb777-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-21" tabindex="-1"></a><span class="co">#&gt;                      Estimate Std. Error   t value   Pr(&gt;|t|)    </span></span>
<span id="cb777-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-22" tabindex="-1"></a><span class="co">#&gt; x1                   0.994678   0.018378 54.122928  &lt; 2.2e-16 ***</span></span>
<span id="cb777-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-23" tabindex="-1"></a><span class="co">#&gt; year::-9:cohort::10  0.351766   0.359073  0.979649 3.2977e-01    </span></span>
<span id="cb777-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-24" tabindex="-1"></a><span class="co">#&gt; year::-8:cohort::9   0.033914   0.471437  0.071937 9.4281e-01    </span></span>
<span id="cb777-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-25" tabindex="-1"></a><span class="co">#&gt; year::-8:cohort::10 -0.191932   0.352896 -0.543876 5.8781e-01    </span></span>
<span id="cb777-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-26" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::8  -0.589387   0.736910 -0.799809 4.2584e-01    </span></span>
<span id="cb777-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-27" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::9   0.872995   0.493427  1.769249 8.0096e-02 .  </span></span>
<span id="cb777-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-28" tabindex="-1"></a><span class="co">#&gt; year::-7:cohort::10  0.019512   0.603411  0.032336 9.7427e-01    </span></span>
<span id="cb777-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-29" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::7  -0.042147   0.865736 -0.048683 9.6127e-01    </span></span>
<span id="cb777-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-30" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::8  -0.657571   0.573257 -1.147078 2.5426e-01    </span></span>
<span id="cb777-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-31" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::9   0.877743   0.533331  1.645775 1.0315e-01    </span></span>
<span id="cb777-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-32" tabindex="-1"></a><span class="co">#&gt; year::-6:cohort::10 -0.403635   0.347412 -1.161832 2.4825e-01    </span></span>
<span id="cb777-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-33" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::6  -0.658034   0.913407 -0.720418 4.7306e-01    </span></span>
<span id="cb777-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-34" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::7  -0.316974   0.697939 -0.454158 6.5076e-01    </span></span>
<span id="cb777-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-35" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::8  -0.238213   0.469744 -0.507113 6.1326e-01    </span></span>
<span id="cb777-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-36" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::9   0.301477   0.604201  0.498968 6.1897e-01    </span></span>
<span id="cb777-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-37" tabindex="-1"></a><span class="co">#&gt; year::-5:cohort::10 -0.564801   0.463214 -1.219308 2.2578e-01    </span></span>
<span id="cb777-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-38" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::5  -0.983453   0.634492 -1.549984 1.2451e-01    </span></span>
<span id="cb777-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-39" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::6   0.360407   0.858316  0.419900 6.7552e-01    </span></span>
<span id="cb777-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-40" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::7  -0.430610   0.661356 -0.651102 5.1657e-01    </span></span>
<span id="cb777-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-41" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::8  -0.895195   0.374901 -2.387816 1.8949e-02 *  </span></span>
<span id="cb777-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-42" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::9  -0.392478   0.439547 -0.892914 3.7418e-01    </span></span>
<span id="cb777-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-43" tabindex="-1"></a><span class="co">#&gt; year::-4:cohort::10  0.519001   0.597880  0.868069 3.8757e-01    </span></span>
<span id="cb777-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-44" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::4   0.591288   0.680169  0.869324 3.8688e-01    </span></span>
<span id="cb777-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-45" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::5  -1.000650   0.971741 -1.029749 3.0577e-01    </span></span>
<span id="cb777-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-46" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::6   0.072188   0.652641  0.110609 9.1216e-01    </span></span>
<span id="cb777-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-47" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::7  -0.836820   0.804275 -1.040465 3.0079e-01    </span></span>
<span id="cb777-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-48" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::8  -0.783148   0.701312 -1.116691 2.6697e-01    </span></span>
<span id="cb777-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-49" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::9   0.811285   0.564470  1.437251 1.5397e-01    </span></span>
<span id="cb777-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-50" tabindex="-1"></a><span class="co">#&gt; year::-3:cohort::10  0.527203   0.320051  1.647250 1.0285e-01    </span></span>
<span id="cb777-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-51" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::3   0.036941   0.673771  0.054828 9.5639e-01    </span></span>
<span id="cb777-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-52" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::4   0.832250   0.859544  0.968246 3.3541e-01    </span></span>
<span id="cb777-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-53" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::5  -1.574086   0.525563 -2.995051 3.5076e-03 ** </span></span>
<span id="cb777-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-54" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::6   0.311758   0.832095  0.374666 7.0875e-01    </span></span>
<span id="cb777-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-55" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::7  -0.558631   0.871993 -0.640638 5.2332e-01    </span></span>
<span id="cb777-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-56" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::8   0.429591   0.305270  1.407250 1.6265e-01    </span></span>
<span id="cb777-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-57" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::9   1.201899   0.819186  1.467188 1.4566e-01    </span></span>
<span id="cb777-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-58" tabindex="-1"></a><span class="co">#&gt; year::-2:cohort::10 -0.002429   0.682087 -0.003562 9.9717e-01    </span></span>
<span id="cb777-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-59" tabindex="-1"></a><span class="co">#&gt; att                 -1.133749   0.205070 -5.528584 2.8820e-07 ***</span></span>
<span id="cb777-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-60" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb777-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-61" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb777-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-62" tabindex="-1"></a><span class="co">#&gt; RMSE: 0.921817     Adj. R2: 0.887984</span></span>
<span id="cb777-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-63" tabindex="-1"></a><span class="co">#&gt;                  Within R2: 0.876406</span></span>
<span id="cb777-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-64" tabindex="-1"></a></span>
<span id="cb777-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-65" tabindex="-1"></a><span class="co"># Aggregate post-treatment effects from l = 0 to 8</span></span>
<span id="cb777-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-66" tabindex="-1"></a><span class="fu">summary</span>(res_sa20, <span class="at">agg =</span> <span class="fu">c</span>(<span class="st">&quot;att&quot;</span> <span class="ot">=</span> <span class="st">&quot;year::[012345678]&quot;</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb777-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-67" tabindex="-1"></a>  <span class="fu">etable</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb777-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-68" tabindex="-1"></a><span class="co">#&gt;                         summary(res_..</span></span>
<span id="cb777-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-69" tabindex="-1"></a><span class="co">#&gt; Dependent Var.:                      y</span></span>
<span id="cb777-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-70" tabindex="-1"></a><span class="co">#&gt;                                       </span></span>
<span id="cb777-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-71" tabindex="-1"></a><span class="co">#&gt; x1                      0.99*** (0.02)</span></span>
<span id="cb777-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-72" tabindex="-1"></a><span class="co">#&gt; year = -9 x cohort = 10    0.35 (0.36)</span></span>
<span id="cb777-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-73" tabindex="-1"></a><span class="co">#&gt; year = -8 x cohort = 9     0.03 (0.47)</span></span>
<span id="cb777-74"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-74" tabindex="-1"></a><span class="co">#&gt; year = -8 x cohort = 10   -0.19 (0.35)</span></span>
<span id="cb777-75"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-75" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 8    -0.59 (0.74)</span></span>
<span id="cb777-76"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-76" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 9    0.87. (0.49)</span></span>
<span id="cb777-77"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-77" tabindex="-1"></a><span class="co">#&gt; year = -7 x cohort = 10    0.02 (0.60)</span></span>
<span id="cb777-78"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-78" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 7    -0.04 (0.87)</span></span>
<span id="cb777-79"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-79" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 8    -0.66 (0.57)</span></span>
<span id="cb777-80"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-80" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 9     0.88 (0.53)</span></span>
<span id="cb777-81"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-81" tabindex="-1"></a><span class="co">#&gt; year = -6 x cohort = 10   -0.40 (0.35)</span></span>
<span id="cb777-82"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-82" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 6    -0.66 (0.91)</span></span>
<span id="cb777-83"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-83" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 7    -0.32 (0.70)</span></span>
<span id="cb777-84"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-84" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 8    -0.24 (0.47)</span></span>
<span id="cb777-85"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-85" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 9     0.30 (0.60)</span></span>
<span id="cb777-86"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-86" tabindex="-1"></a><span class="co">#&gt; year = -5 x cohort = 10   -0.56 (0.46)</span></span>
<span id="cb777-87"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-87" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 5    -0.98 (0.63)</span></span>
<span id="cb777-88"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-88" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 6     0.36 (0.86)</span></span>
<span id="cb777-89"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-89" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 7    -0.43 (0.66)</span></span>
<span id="cb777-90"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-90" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 8   -0.90* (0.37)</span></span>
<span id="cb777-91"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-91" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 9    -0.39 (0.44)</span></span>
<span id="cb777-92"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-92" tabindex="-1"></a><span class="co">#&gt; year = -4 x cohort = 10    0.52 (0.60)</span></span>
<span id="cb777-93"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-93" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 4     0.59 (0.68)</span></span>
<span id="cb777-94"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-94" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 5     -1.0 (0.97)</span></span>
<span id="cb777-95"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-95" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 6     0.07 (0.65)</span></span>
<span id="cb777-96"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-96" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 7    -0.84 (0.80)</span></span>
<span id="cb777-97"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-97" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 8    -0.78 (0.70)</span></span>
<span id="cb777-98"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-98" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 9     0.81 (0.56)</span></span>
<span id="cb777-99"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-99" tabindex="-1"></a><span class="co">#&gt; year = -3 x cohort = 10    0.53 (0.32)</span></span>
<span id="cb777-100"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-100" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 3     0.04 (0.67)</span></span>
<span id="cb777-101"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-101" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 4     0.83 (0.86)</span></span>
<span id="cb777-102"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-102" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 5   -1.6** (0.53)</span></span>
<span id="cb777-103"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-103" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 6     0.31 (0.83)</span></span>
<span id="cb777-104"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-104" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 7    -0.56 (0.87)</span></span>
<span id="cb777-105"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-105" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 8     0.43 (0.31)</span></span>
<span id="cb777-106"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-106" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 9      1.2 (0.82)</span></span>
<span id="cb777-107"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-107" tabindex="-1"></a><span class="co">#&gt; year = -2 x cohort = 10  -0.002 (0.68)</span></span>
<span id="cb777-108"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-108" tabindex="-1"></a><span class="co">#&gt; att                     -1.1*** (0.21)</span></span>
<span id="cb777-109"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-109" tabindex="-1"></a><span class="co">#&gt; Fixed-Effects:          --------------</span></span>
<span id="cb777-110"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-110" tabindex="-1"></a><span class="co">#&gt; id                                 Yes</span></span>
<span id="cb777-111"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-111" tabindex="-1"></a><span class="co">#&gt; year                               Yes</span></span>
<span id="cb777-112"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-112" tabindex="-1"></a><span class="co">#&gt; _______________________ ______________</span></span>
<span id="cb777-113"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-113" tabindex="-1"></a><span class="co">#&gt; S.E.: Clustered                 by: id</span></span>
<span id="cb777-114"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-114" tabindex="-1"></a><span class="co">#&gt; Observations                       950</span></span>
<span id="cb777-115"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-115" tabindex="-1"></a><span class="co">#&gt; R2                             0.90982</span></span>
<span id="cb777-116"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-116" tabindex="-1"></a><span class="co">#&gt; Within R2                      0.87641</span></span>
<span id="cb777-117"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-117" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb777-118"><a href="sec-modern-estimators-for-staggered-adoption.html#cb777-118" tabindex="-1"></a><span class="co">#&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>The <code>fwlplot</code> package provides diagnostics for how much variation is explained by fixed effects or covariates:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb778-1" tabindex="-1"></a><span class="fu">library</span>(fwlplot)</span>
<span id="cb778-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb778-2" tabindex="-1"></a></span>
<span id="cb778-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb778-3" tabindex="-1"></a><span class="co"># Simple FWL plot</span></span>
<span id="cb778-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb778-4" tabindex="-1"></a><span class="fu">fwl_plot</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> base_stagg)</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-1" tabindex="-1"></a></span>
<span id="cb779-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-2" tabindex="-1"></a></span>
<span id="cb779-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-3" tabindex="-1"></a><span class="co"># With fixed effects</span></span>
<span id="cb779-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-4" tabindex="-1"></a><span class="fu">fwl_plot</span>(y <span class="sc">~</span> x1 <span class="sc">|</span> id <span class="sc">+</span> year,</span>
<span id="cb779-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-5" tabindex="-1"></a>         <span class="at">data =</span> base_stagg,</span>
<span id="cb779-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb779-6" tabindex="-1"></a>         <span class="at">n_sample =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-8-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-1" tabindex="-1"></a></span>
<span id="cb780-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-2" tabindex="-1"></a><span class="co"># Splitting by treatment status</span></span>
<span id="cb780-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-3" tabindex="-1"></a><span class="fu">fwl_plot</span>(</span>
<span id="cb780-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-4" tabindex="-1"></a>    y <span class="sc">~</span> x1 <span class="sc">|</span></span>
<span id="cb780-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-5" tabindex="-1"></a>        id <span class="sc">+</span> year,</span>
<span id="cb780-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-6" tabindex="-1"></a>    <span class="at">data =</span> base_stagg,</span>
<span id="cb780-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-7" tabindex="-1"></a>    <span class="at">n_sample =</span> <span class="dv">100</span>,</span>
<span id="cb780-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-8" tabindex="-1"></a>    <span class="at">fsplit =</span> <span class="sc">~</span> treated</span>
<span id="cb780-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb780-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-8-3.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="sec-stacked-difference-in-differences" class="section level3 hasAnchor" number="30.8.3">
<h3><span class="header-section-number">30.8.3</span> Stacked Difference-in-Differences<a href="sec-modern-estimators-for-staggered-adoption.html#sec-stacked-difference-in-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Stacked DiD</strong> approach addresses key limitations of standard TWFE models in <strong>staggered adoption designs</strong>, particularly <strong>treatment effect heterogeneity</strong> and <strong>timing variations</strong>. By constructing <strong>sub-experiments</strong> around each treatment event, researchers can isolate cleaner comparisons and reduce contamination from improperly specified control groups.</p>
<p>Basic TWFE Specification</p>
<p><span class="math display">\[
Y_{it} = \beta_{FE} D_{it} + A_i + B_t + \epsilon_{it}
\]</span></p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span>: Outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(D_{it}\)</span>: Treatment indicator (1 if treated, 0 otherwise).</li>
<li><span class="math inline">\(A_i\)</span>: Unit (group) fixed effects.</li>
<li><span class="math inline">\(B_t\)</span>: Time period fixed effects.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span>: Idiosyncratic error term.</li>
</ul>
<hr />
<p>Steps in the Stacked DiD Procedure</p>
<div id="choose-an-event-window" class="section level4 hasAnchor" number="30.8.3.1">
<h4><span class="header-section-number">30.8.3.1</span> Choose an Event Window<a href="sec-modern-estimators-for-staggered-adoption.html#choose-an-event-window" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define:</p>
<ul>
<li><span class="math inline">\(\kappa_a\)</span>: Number of <strong>pre-treatment</strong> periods to include in the event window (lead periods).</li>
<li><span class="math inline">\(\kappa_b\)</span>: Number of <strong>post-treatment</strong> periods to include in the event window (lag periods).</li>
</ul>
<p><strong>Implication</strong>:<br />
Only events where sufficient <strong>pre- and post-treatment periods</strong> exist will be included (i.e., excluding those events that do not meet this criteria).</p>
<hr />
</div>
<div id="enumerate-sub-experiments" class="section level4 hasAnchor" number="30.8.3.2">
<h4><span class="header-section-number">30.8.3.2</span> Enumerate Sub-Experiments<a href="sec-modern-estimators-for-staggered-adoption.html#enumerate-sub-experiments" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define:</p>
<ul>
<li><span class="math inline">\(T_1\)</span>: First period in the panel.</li>
<li><span class="math inline">\(T_T\)</span>: Last period in the panel.</li>
<li><span class="math inline">\(\Omega_A\)</span>: The set of <strong>treatment adoption periods</strong> that fit within the event window:</li>
</ul>
<p><span class="math display">\[
\Omega_A = \left\{ A_i \;\middle|\; T_1 + \kappa_a \le A_i \le T_T - \kappa_b \right\}
\]</span></p>
<ul>
<li>Each <span class="math inline">\(A_i\)</span> represents an <strong>adoption period</strong> for unit <span class="math inline">\(i\)</span> that has enough time on both sides of the event.</li>
</ul>
<p>Let <span class="math inline">\(d = 1, \dots, D\)</span> index the <strong>sub-experiments</strong> in <span class="math inline">\(\Omega_A\)</span>.</p>
<ul>
<li><span class="math inline">\(\omega_d\)</span>: The event (adoption) date of the <span class="math inline">\(d\)</span>-th sub-experiment.</li>
</ul>
<hr />
</div>
<div id="define-inclusion-criteria" class="section level4 hasAnchor" number="30.8.3.3">
<h4><span class="header-section-number">30.8.3.3</span> Define Inclusion Criteria<a href="sec-modern-estimators-for-staggered-adoption.html#define-inclusion-criteria" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Valid Treated Units</strong></p>
<ul>
<li>In sub-experiment <span class="math inline">\(d\)</span>, treated units have adoption date exactly equal to <span class="math inline">\(\omega_d\)</span>.</li>
<li>A unit may only be treated in one sub-experiment to avoid duplication.</li>
</ul>
<p><strong>Clean Control Units</strong></p>
<ul>
<li>Controls are units where <span class="math inline">\(A_i &gt; \omega_d + \kappa_b\)</span>, i.e.,
<ul>
<li>They are <strong>never treated</strong>, or</li>
<li>They are <strong>treated in the far future</strong> (beyond the post-event window).</li>
</ul></li>
<li>A control unit can appear in multiple sub-experiments, but this requires correcting standard errors (see below).</li>
</ul>
<p><strong>Valid Time Periods</strong></p>
<ul>
<li>Only observations where<br />
<span class="math display">\[
\omega_d - \kappa_a \le t \le \omega_d + \kappa_b
\]</span><br />
are included.</li>
<li>This ensures the analysis is centered on the event window.</li>
</ul>
</div>
<div id="specify-estimating-equation" class="section level4 hasAnchor" number="30.8.3.4">
<h4><span class="header-section-number">30.8.3.4</span> Specify Estimating Equation<a href="sec-modern-estimators-for-staggered-adoption.html#specify-estimating-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Basic DiD Specification in the Stacked Dataset</p>
<p><span class="math display">\[
Y_{itd} = \beta_0 + \beta_1 T_{id}  + \beta_2 P_{td} + \beta_3 (T_{id} \times P_{td}) + \epsilon_{itd}
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(i\)</span>: Unit index</p></li>
<li><p><span class="math inline">\(t\)</span>: Time index</p></li>
<li><p><span class="math inline">\(d\)</span>: Sub-experiment index</p></li>
<li><p><span class="math inline">\(T_{id}\)</span>: Indicator for <strong>treated units</strong> in sub-experiment <span class="math inline">\(d\)</span></p></li>
<li><p><span class="math inline">\(P_{td}\)</span>: Indicator for <strong>post-treatment periods</strong> in sub-experiment <span class="math inline">\(d\)</span></p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: Captures the <strong>DiD estimate</strong> of the treatment effect.</p></li>
</ul>
<p>Equivalent Form with Fixed Effects</p>
<p><span class="math display">\[
Y_{itd} = \beta_3 (T_{id} \times P_{td}) + \theta_{id} + \gamma_{td} + \epsilon_{itd}
\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\theta_{id}\)</span>: Unit-by-sub-experiment fixed effect.</p></li>
<li><p><span class="math inline">\(\gamma_{td}\)</span>: Time-by-sub-experiment fixed effect.</p></li>
</ul>
<p>Note:</p>
<ul>
<li><span class="math inline">\(\beta_3\)</span> summarizes the average treatment effect across all sub-experiments but does not allow for dynamic effects by time since treatment.</li>
</ul>
</div>
<div id="stacked-event-study-specification" class="section level4 hasAnchor" number="30.8.3.5">
<h4><span class="header-section-number">30.8.3.5</span> Stacked Event Study Specification<a href="sec-modern-estimators-for-staggered-adoption.html#stacked-event-study-specification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define Time Since Event (<span class="math inline">\(YSE_{td}\)</span>):</p>
<p><span class="math display">\[
YSE_{td} = t- \omega_d
\]</span></p>
<p>where</p>
<ul>
<li><p>Measures time since the event (relative time) in sub-experiment <span class="math inline">\(d\)</span>.</p></li>
<li><p><span class="math inline">\(YSE_{td} \in [-\kappa_a, \dots, 0, \dots, \kappa_b]\)</span> in every sub-experiment.</p></li>
</ul>
<p><strong>Event-Study Regression (Sub-Experiment Level)</strong></p>
<p><span class="math display">\[
Y_{it}^d = \sum_{j = -\kappa_a}^{\kappa_b} \beta_j^d . 1 (YSE_{td} = j) + \sum_{j = -\kappa_a}^{\kappa_b} \delta_j^d (T_{id} . 1 (YSE_{td} = j)) + \theta_i^d + \epsilon_{it}^d
\]</span></p>
<p>where</p>
<ul>
<li><p>Separate coefficients for each sub-experiment <span class="math inline">\(d\)</span>.</p></li>
<li><p><span class="math inline">\(\delta_j^d\)</span>: Captures treatment effects at relative time <span class="math inline">\(j\)</span> within sub-experiment <span class="math inline">\(d\)</span>.</p></li>
</ul>
<p><strong>Pooled Stacked Event-Study Regression</strong></p>
<p><span class="math display">\[
Y_{itd} = \sum_{j = -\kappa_a}^{\kappa_b} \beta_j \cdot \mathbb{1}(YSE_{td} = j) + \sum_{j = -\kappa_a}^{\kappa_b} \delta_j \left( T_{id} \cdot \mathbb{1}(YSE_{td} = j) \right) + \theta_{id} + \epsilon_{itd}
\]</span></p>
<ul>
<li>Pooled coefficients <span class="math inline">\(\delta_j\)</span> reflect average treatment effects by event time <span class="math inline">\(j\)</span> across sub-experiments.</li>
</ul>
</div>
<div id="clustering-in-stacked-did" class="section level4 hasAnchor" number="30.8.3.6">
<h4><span class="header-section-number">30.8.3.6</span> Clustering in Stacked DID<a href="sec-modern-estimators-for-staggered-adoption.html#clustering-in-stacked-did" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><strong>Cluster at Unit × Sub-Experiment Level</strong> <span class="citation">(<a href="#ref-cengiz2019effect">Cengiz et al. 2019</a>)</span>: Accounts for units appearing multiple times across sub-experiments.</p></li>
<li><p><strong>Cluster at Unit Level</strong> <span class="citation">(<a href="#ref-deshpande2019screened">Deshpande and Li 2019</a>)</span>: Appropriate when units are uniquely identified and do not appear in multiple sub-experiments.</p></li>
</ul>
<hr />
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-1" tabindex="-1"></a><span class="fu">library</span>(did)</span>
<span id="cb781-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb781-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-3" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb781-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-4" tabindex="-1"></a></span>
<span id="cb781-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-5" tabindex="-1"></a><span class="co"># Load example data</span></span>
<span id="cb781-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-6" tabindex="-1"></a><span class="fu">data</span>(base_stagg)</span>
<span id="cb781-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-7" tabindex="-1"></a></span>
<span id="cb781-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-8" tabindex="-1"></a><span class="co"># Get treated cohorts (exclude never-treated units coded as 10000)</span></span>
<span id="cb781-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-9" tabindex="-1"></a>cohorts <span class="ot">&lt;-</span> base_stagg <span class="sc">%&gt;%</span></span>
<span id="cb781-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-10" tabindex="-1"></a>    <span class="fu">filter</span>(year_treated <span class="sc">!=</span> <span class="dv">10000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb781-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-11" tabindex="-1"></a>    <span class="fu">distinct</span>(year_treated) <span class="sc">%&gt;%</span></span>
<span id="cb781-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-12" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb781-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-13" tabindex="-1"></a></span>
<span id="cb781-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-14" tabindex="-1"></a><span class="co"># Function to generate data for each sub-experiment</span></span>
<span id="cb781-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-15" tabindex="-1"></a>getdata <span class="ot">&lt;-</span> <span class="cf">function</span>(j, window) {</span>
<span id="cb781-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-16" tabindex="-1"></a>    base_stagg <span class="sc">%&gt;%</span></span>
<span id="cb781-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-17" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb781-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-18" tabindex="-1"></a>            year_treated <span class="sc">==</span> j <span class="sc">|</span>               <span class="co"># treated units in cohort j</span></span>
<span id="cb781-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-19" tabindex="-1"></a>            year_treated <span class="sc">&gt;</span> j <span class="sc">+</span> window         <span class="co"># controls not treated soon after</span></span>
<span id="cb781-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-20" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb781-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-21" tabindex="-1"></a>        <span class="fu">filter</span>(</span>
<span id="cb781-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-22" tabindex="-1"></a>            year <span class="sc">&gt;=</span> j <span class="sc">-</span> window <span class="sc">&amp;</span></span>
<span id="cb781-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-23" tabindex="-1"></a>            year <span class="sc">&lt;=</span> j <span class="sc">+</span> window                <span class="co"># event window bounds</span></span>
<span id="cb781-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-24" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb781-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-25" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">df =</span> j)                        <span class="co"># sub-experiment indicator</span></span>
<span id="cb781-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-26" tabindex="-1"></a>}</span>
<span id="cb781-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-27" tabindex="-1"></a></span>
<span id="cb781-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-28" tabindex="-1"></a><span class="co"># Generate the stacked dataset</span></span>
<span id="cb781-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-29" tabindex="-1"></a>stacked_data <span class="ot">&lt;-</span> <span class="fu">map_df</span>(cohorts, <span class="sc">~</span> <span class="fu">getdata</span>(., <span class="at">window =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb781-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-30" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb781-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-31" tabindex="-1"></a>        <span class="at">rel_year =</span> <span class="fu">if_else</span>(df <span class="sc">==</span> year_treated, time_to_treatment, <span class="cn">NA_real_</span>)</span>
<span id="cb781-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-32" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb781-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-33" tabindex="-1"></a>    fastDummies<span class="sc">::</span><span class="fu">dummy_cols</span>(<span class="st">&quot;rel_year&quot;</span>, <span class="at">ignore_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb781-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-34" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;rel_year_&quot;</span>), <span class="sc">~</span> <span class="fu">replace_na</span>(., <span class="dv">0</span>)))</span>
<span id="cb781-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-35" tabindex="-1"></a></span>
<span id="cb781-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-36" tabindex="-1"></a><span class="co"># Estimate fixed effects regression on the stacked data</span></span>
<span id="cb781-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-37" tabindex="-1"></a>stacked_result <span class="ot">&lt;-</span> <span class="fu">feols</span>(</span>
<span id="cb781-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-38" tabindex="-1"></a>    y <span class="sc">~</span> <span class="st">`</span><span class="at">rel_year_-5</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-4</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-3</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">rel_year_-2</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb781-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-39" tabindex="-1"></a>        rel_year_0 <span class="sc">+</span> rel_year_1 <span class="sc">+</span> rel_year_2 <span class="sc">+</span> rel_year_3 <span class="sc">+</span></span>
<span id="cb781-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-40" tabindex="-1"></a>        rel_year_4 <span class="sc">+</span> rel_year_5 <span class="sc">|</span></span>
<span id="cb781-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-41" tabindex="-1"></a>        id <span class="sc">^</span> df <span class="sc">+</span> year <span class="sc">^</span> df,</span>
<span id="cb781-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-42" tabindex="-1"></a>    <span class="at">data =</span> stacked_data</span>
<span id="cb781-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-43" tabindex="-1"></a>)</span>
<span id="cb781-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-44" tabindex="-1"></a></span>
<span id="cb781-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-45" tabindex="-1"></a><span class="co"># Extract coefficients and standard errors</span></span>
<span id="cb781-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-46" tabindex="-1"></a>stacked_coeffs <span class="ot">&lt;-</span> stacked_result<span class="sc">$</span>coefficients</span>
<span id="cb781-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-47" tabindex="-1"></a>stacked_se <span class="ot">&lt;-</span> stacked_result<span class="sc">$</span>se</span>
<span id="cb781-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-48" tabindex="-1"></a></span>
<span id="cb781-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-49" tabindex="-1"></a><span class="co"># Insert zero for the omitted period (usually -1)</span></span>
<span id="cb781-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-50" tabindex="-1"></a>stacked_coeffs <span class="ot">&lt;-</span> <span class="fu">c</span>(stacked_coeffs[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, stacked_coeffs[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb781-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb781-51" tabindex="-1"></a>stacked_se <span class="ot">&lt;-</span> <span class="fu">c</span>(stacked_se[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, stacked_se[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span></code></pre></div>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-1" tabindex="-1"></a><span class="co"># Plotting estimates from three methods: Callaway &amp; Sant&#39;Anna, Sun &amp; Abraham, and Stacked DiD</span></span>
<span id="cb782-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-2" tabindex="-1"></a></span>
<span id="cb782-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-3" tabindex="-1"></a>cs_out <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(</span>
<span id="cb782-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-4" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb782-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-5" tabindex="-1"></a>    <span class="at">data =</span> base_stagg,</span>
<span id="cb782-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-6" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb782-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-7" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb782-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-8" tabindex="-1"></a>    <span class="co"># xformla = &quot;~x1&quot;,</span></span>
<span id="cb782-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-9" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span></span>
<span id="cb782-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-10" tabindex="-1"></a>)</span>
<span id="cb782-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-11" tabindex="-1"></a>cs <span class="ot">&lt;-</span></span>
<span id="cb782-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-12" tabindex="-1"></a>    <span class="fu">aggte</span>(</span>
<span id="cb782-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-13" tabindex="-1"></a>        cs_out,</span>
<span id="cb782-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-14" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;dynamic&quot;</span>,</span>
<span id="cb782-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-15" tabindex="-1"></a>        <span class="at">min_e =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb782-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-16" tabindex="-1"></a>        <span class="at">max_e =</span> <span class="dv">5</span>,</span>
<span id="cb782-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-17" tabindex="-1"></a>        <span class="at">bstrap =</span> <span class="cn">FALSE</span>,</span>
<span id="cb782-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-18" tabindex="-1"></a>        <span class="at">cband =</span> <span class="cn">FALSE</span></span>
<span id="cb782-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-19" tabindex="-1"></a>    )</span>
<span id="cb782-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-20" tabindex="-1"></a></span>
<span id="cb782-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-21" tabindex="-1"></a></span>
<span id="cb782-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-22" tabindex="-1"></a></span>
<span id="cb782-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-23" tabindex="-1"></a>res_sa20 <span class="ot">=</span> <span class="fu">feols</span>(y <span class="sc">~</span> <span class="fu">sunab</span>(year_treated, year) <span class="sc">|</span></span>
<span id="cb782-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-24" tabindex="-1"></a>                     id <span class="sc">+</span> year, base_stagg)</span>
<span id="cb782-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-25" tabindex="-1"></a>sa <span class="ot">=</span> <span class="fu">tidy</span>(res_sa20)[<span class="dv">5</span><span class="sc">:</span><span class="dv">14</span>, ] <span class="sc">%&gt;%</span> <span class="fu">pull</span>(estimate)</span>
<span id="cb782-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-26" tabindex="-1"></a>sa <span class="ot">=</span> <span class="fu">c</span>(sa[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, sa[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb782-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-27" tabindex="-1"></a></span>
<span id="cb782-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-28" tabindex="-1"></a>sa_se <span class="ot">=</span> <span class="fu">tidy</span>(res_sa20)[<span class="dv">6</span><span class="sc">:</span><span class="dv">15</span>, ] <span class="sc">%&gt;%</span> <span class="fu">pull</span>(std.error)</span>
<span id="cb782-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-29" tabindex="-1"></a>sa_se <span class="ot">=</span> <span class="fu">c</span>(sa_se[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">0</span>, sa_se[<span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb782-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-30" tabindex="-1"></a></span>
<span id="cb782-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-31" tabindex="-1"></a>compare_df_est <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb782-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-32" tabindex="-1"></a>    <span class="at">period =</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb782-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-33" tabindex="-1"></a>    <span class="at">cs =</span> cs<span class="sc">$</span>att.egt,</span>
<span id="cb782-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-34" tabindex="-1"></a>    <span class="at">sa =</span> sa,</span>
<span id="cb782-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-35" tabindex="-1"></a>    <span class="at">stacked =</span> stacked_coeffs</span>
<span id="cb782-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-36" tabindex="-1"></a>)</span>
<span id="cb782-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-37" tabindex="-1"></a></span>
<span id="cb782-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-38" tabindex="-1"></a>compare_df_se <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb782-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-39" tabindex="-1"></a>    <span class="at">period =</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb782-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-40" tabindex="-1"></a>    <span class="at">cs =</span> cs<span class="sc">$</span>se.egt,</span>
<span id="cb782-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-41" tabindex="-1"></a>    <span class="at">sa =</span> sa_se,</span>
<span id="cb782-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-42" tabindex="-1"></a>    <span class="at">stacked =</span> stacked_se</span>
<span id="cb782-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-43" tabindex="-1"></a>)</span>
<span id="cb782-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-44" tabindex="-1"></a></span>
<span id="cb782-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-45" tabindex="-1"></a>compare_df_longer <span class="ot">&lt;-</span> compare_df_est <span class="sc">%&gt;%</span></span>
<span id="cb782-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-46" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">!</span>period, <span class="at">names_to =</span> <span class="st">&quot;estimator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;est&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb782-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-47" tabindex="-1"></a>    <span class="fu">full_join</span>(compare_df_se <span class="sc">%&gt;%</span></span>
<span id="cb782-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-48" tabindex="-1"></a>                  <span class="fu">pivot_longer</span>(<span class="sc">!</span>period, <span class="at">names_to =</span> <span class="st">&quot;estimator&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;se&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb782-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-49" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">upper =</span> est <span class="sc">+</span>  <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb782-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-50" tabindex="-1"></a>           <span class="at">lower =</span> est <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb782-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-51" tabindex="-1"></a></span>
<span id="cb782-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-52" tabindex="-1"></a><span class="fu">ggplot</span>(compare_df_longer) <span class="sc">+</span></span>
<span id="cb782-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-53" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(</span>
<span id="cb782-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-54" tabindex="-1"></a>        <span class="at">x =</span> period,</span>
<span id="cb782-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-55" tabindex="-1"></a>        <span class="at">ymin =</span> lower,</span>
<span id="cb782-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-56" tabindex="-1"></a>        <span class="at">ymax =</span> upper,</span>
<span id="cb782-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-57" tabindex="-1"></a>        <span class="at">group =</span> estimator</span>
<span id="cb782-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-58" tabindex="-1"></a>    ), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb782-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-59" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(</span>
<span id="cb782-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-60" tabindex="-1"></a>        <span class="at">x =</span> period,</span>
<span id="cb782-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-61" tabindex="-1"></a>        <span class="at">y =</span> est,</span>
<span id="cb782-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-62" tabindex="-1"></a>        <span class="at">group =</span> estimator,</span>
<span id="cb782-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-63" tabindex="-1"></a>        <span class="at">color =</span> estimator</span>
<span id="cb782-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-64" tabindex="-1"></a>    ),</span>
<span id="cb782-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-65" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb782-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-66" tabindex="-1"></a>    </span>
<span id="cb782-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-67" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb782-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-68" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Comparison of Dynamic Treatment Effects&quot;</span>,</span>
<span id="cb782-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-69" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Event Time (Periods since Treatment)&quot;</span>,</span>
<span id="cb782-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-70" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Estimated ATT&quot;</span>,</span>
<span id="cb782-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-71" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;Estimator&quot;</span></span>
<span id="cb782-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-72" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb782-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb782-73" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30.1-stagger_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />

</div>
</div>
<div id="sec-panel-match-did-estimator-with-in-and-out-treatment-conditions" class="section level3 hasAnchor" number="30.8.4">
<h3><span class="header-section-number">30.8.4</span> Panel Match DiD Estimator with In-and-Out Treatment Conditions<a href="sec-modern-estimators-for-staggered-adoption.html#sec-panel-match-did-estimator-with-in-and-out-treatment-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As noted in <span class="citation">Imai and Kim (<a href="#ref-imai2021use">2021</a>)</span>, the <a href="sec-two-way-fixed-effects.html#sec-two-way-fixed-effects">TWFE</a> regression model is widely used but fundamentally relies on strong modeling assumptions, particularly <strong>linearity</strong> and <strong>additivity</strong>. It does not constitute a fully nonparametric estimation method and may yield biased results under model misspecification.</p>
<div id="limitations-of-twfe-1" class="section level4 hasAnchor" number="30.8.4.1">
<h4><span class="header-section-number">30.8.4.1</span> Limitations of TWFE<a href="sec-modern-estimators-for-staggered-adoption.html#limitations-of-twfe-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Researchers often prefer TWFE due to its ability to control for both unit- and time-specific unobserved confounders:</p>
<ul>
<li><span class="math inline">\(\alpha_i = h(\mathbf{U}_i)\)</span> accounts for unit-level confounders.</li>
<li><span class="math inline">\(\gamma_t = f(\mathbf{V}_t)\)</span> adjusts for time-level confounders.</li>
</ul>
<p>The functional forms <span class="math inline">\(h(\cdot)\)</span> and <span class="math inline">\(f(\cdot)\)</span> are left unspecified, but <strong>additivity and separability</strong> are assumed. TWFE is based on the model:</p>
<p><span class="math display">\[
Y_{it} = \alpha_i + \gamma_t + \beta X_{it} + \epsilon_{it}
\]</span></p>
<p>for <span class="math inline">\(i = 1, \dots, N\)</span>, and <span class="math inline">\(t = 1, \dots, T\)</span>. However, this formulation requires a linear specification for the treatment effect <span class="math inline">\(\beta\)</span>. Contrary to popular belief, the model does require functional form assumptions for validity <span class="citation">(<a href="#ref-imai2021use">Imai and Kim 2021, 406</a>; <a href="#ref-imai2019should">2019</a>)</span>.</p>
<hr />
</div>
<div id="matching-and-the-panel-match-did-estimator" class="section level4 hasAnchor" number="30.8.4.2">
<h4><span class="header-section-number">30.8.4.2</span> Matching and the Panel Match DiD Estimator<a href="sec-modern-estimators-for-staggered-adoption.html#matching-and-the-panel-match-did-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To mitigate model dependence and improve causal inference validity, <span class="citation">Imai and Kim (<a href="#ref-imai2021use">2021</a>)</span> propose a matching-based framework for panel data. This method is implemented via the <code>wfe</code> and <code>PanelMatch</code> R packages and offers <strong>design-based identification</strong> under relaxed assumptions.</p>
<p>This setting generalizes <a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-staggered-difference-in-differences">staggered adoption</a>, allowing units to transition in and out of treatment. The core idea is to construct matched control groups that share the same <strong>treatment history</strong> as treated units and then apply a <a href="sec-simple-difference-in-differences.html#sec-simple-difference-in-differences">Difference-in-Differences</a> logic. This is better than <a href="(#sec-synthetic-control)">synthetic controls</a> (e.g., <span class="citation">Xu (<a href="#ref-xu2017generalized">2017</a>)</span>) because it requires less data to achieve good performance and can adapt to contexts where units switch treatment status multiple times.</p>
<p><strong>Key Properties</strong> of PM-DiD <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span></p>
<ul>
<li>Designed for <strong>multiple treatment switches</strong> over time.</li>
<li>Addresses issues of <strong>carryover</strong>, <strong>reversal</strong>, and <strong>attenuation bias</strong>.</li>
<li>Allows estimation of <strong>short-term and long-term</strong> causal effects, accounting for time dynamics.</li>
</ul>
<p><strong>Key Findings</strong> <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span></p>
<ul>
<li><p>Even under favorable conditions for OLS, PM-DiD is more robust to model misspecification and omitted lags.</p></li>
<li><p>This robustness comes with a cost: reduced efficiency (larger variance).</p></li>
<li><p>Reflects the classic bias-variance tradeoff between flexible and parametric estimators.</p></li>
</ul>
<p><strong>Data and Software Requirements</strong></p>
<ul>
<li><p>Treatment variable: binary (0 = control, 1 = treated).</p></li>
<li><p>Unit and time variables: integer/numeric and ordered.</p></li>
<li><p>Input data must be in <code>data.frame</code> format.</p></li>
</ul>
<p>Examples:</p>
<ul>
<li><p><span class="citation">Scheve and Stasavage (<a href="#ref-scheve2012democracy">2012</a>)</span></p></li>
<li><p><span class="citation">Acemoglu et al. (<a href="#ref-acemoglu2019democracy">2019</a>)</span></p></li>
</ul>
<hr />
</div>
<div id="two-way-matching-interpretation-of-twfe" class="section level4 hasAnchor" number="30.8.4.3">
<h4><span class="header-section-number">30.8.4.3</span> Two-Way Matching Interpretation of TWFE<a href="sec-modern-estimators-for-staggered-adoption.html#two-way-matching-interpretation-of-twfe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The least squares estimate of <span class="math inline">\(\beta\)</span> in the TWFE model can be re-expressed as a <strong>matching estimator</strong> that compares each treated unit to observations within:</p>
<ul>
<li>The <strong>same unit</strong> (within-unit match),</li>
<li>The <strong>same time period</strong> (within-time match),</li>
<li>Adjusted by a third set of observations in neither group.</li>
</ul>
<p>This leads to mismatches—treated observations compared to units with the same treatment status, which causes <strong>attenuation bias</strong>.</p>
<p>The adjustment factor <span class="math inline">\(K\)</span> corrects for this by weighting matches appropriately. However, even the <strong>weighted TWFE estimator</strong> contains some mismatches and relies on comparisons across units that differ in key characteristics.</p>
<p>In the simple two-period, two-group DiD setting, the TWFE and DiD estimators coincide. However, in <a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-multiple-periods-and-variation-in-treatment-timing">multi-period DiD</a> with <strong>treatment reversals</strong>, this equivalence breaks down <span class="citation">(<a href="#ref-imai2021use">Imai and Kim 2021</a>)</span>.</p>
<ul>
<li>The <strong>unweighted TWFE</strong> is not equivalent to multi-period DiD.</li>
<li>The <a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-multiple-periods-and-variation-in-treatment-timing">multi-period DiD</a> is equivalent to a <strong>weighted TWFE</strong>, but some weights are <strong>negative</strong>—a problematic feature from a design-based perspective.</li>
</ul>
<p>This means that justifying TWFE via DiD logic is incorrect unless the linearity assumption is satisfied.</p>
<hr />
</div>
<div id="estimation-using-panel-match-did" class="section level4 hasAnchor" number="30.8.4.4">
<h4><span class="header-section-number">30.8.4.4</span> Estimation Using Panel Match DiD<a href="sec-modern-estimators-for-staggered-adoption.html#estimation-using-panel-match-did" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Core Estimation Steps</strong> <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Match treated observations with control observations from the same time period and with identical treatment histories over the past <span class="math inline">\(L\)</span> periods.</li>
<li>Use standard matching or weighting methods to refine control sets (e.g., Mahalanobis distance, propensity score).</li>
<li>Apply a DiD estimator to compute treatment effects at time <span class="math inline">\(t + F\)</span>.</li>
<li>Evaluate match quality using covariate balance diagnostics <span class="citation">(<a href="#ref-ho2007matching">Ho et al. 2007</a>)</span>.</li>
</ol>
<p><strong>Causal Estimand</strong></p>
<p>Let <span class="math inline">\(F\)</span> be the number of <strong>leads</strong> (future periods) and <span class="math inline">\(L\)</span> be the number of <strong>lags</strong> (past treatment periods). Define the average treatment effect as:</p>
<p><span class="math display">\[
\delta(F, L) = \mathbb{E}\left[Y_{i, t+F}(1) - Y_{i, t+F}(0) \mid \text{treatment history from } t-L \text{ to } t\right]
\]</span></p>
<ul>
<li><span class="math inline">\(F = 0\)</span>: contemporaneous effect (short-run ATT)</li>
<li><span class="math inline">\(F &gt; 0\)</span>: future outcomes (long-run ATT)</li>
<li><span class="math inline">\(L\)</span>: adjusts for potential <strong>carryover effects</strong></li>
</ul>
<p>The estimator also allows for estimation of the <strong>Average Reversal Treatment Effect (ART)</strong> when treatment status switches from 1 to 0.</p>
<hr />
</div>
<div id="model-assumptions" class="section level4 hasAnchor" number="30.8.4.5">
<h4><span class="header-section-number">30.8.4.5</span> Model Assumptions<a href="sec-modern-estimators-for-staggered-adoption.html#model-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><strong>No spillover effects</strong> across units (i.e., SUTVA holds)</p></li>
<li><p><strong>Carryover effects</strong> allowed up to <span class="math inline">\(L\)</span> periods.</p></li>
<li><p>After <span class="math inline">\(L\)</span> lags, prior treatments are assumed to have no effect on <span class="math inline">\(Y_{i,t+F}\)</span>.</p></li>
<li><p>The potential outcome at <span class="math inline">\(t + F\)</span> is independent of treatment assignments beyond <span class="math inline">\(t - L\)</span>.</p></li>
<li><p>The key identifying assumption is a conditional parallel trends assumption. Outcome trends are assumed parallel across treated and matched control units, conditional on:</p>
<ul>
<li><p>Past treatment,</p></li>
<li><p>Covariate histories,</p></li>
<li><p>Lagged outcomes (excluding the most recent).</p></li>
</ul>
<p>Unlike standard <a href="sec-simple-difference-in-differences.html#sec-simple-difference-in-differences">TWFE</a>, strong ignorability is not required.</p></li>
</ul>
<hr />
</div>
<div id="covariate-balance-assessment" class="section level4 hasAnchor" number="30.8.4.6">
<h4><span class="header-section-number">30.8.4.6</span> Covariate Balance Assessment<a href="sec-modern-estimators-for-staggered-adoption.html#covariate-balance-assessment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Assessing balance before estimating ATT is critical:</p>
<ul>
<li>Compute the mean standardized difference between treated and matched control units.</li>
<li>Check balance across covariates and lagged outcomes for all <span class="math inline">\(L\)</span> pretreatment periods.</li>
<li>Imbalanced covariates may indicate violations of the parallel trends assumption.</li>
</ul>
<hr />
</div>
<div id="implementing-the-panel-match-did-estimator" class="section level4 hasAnchor" number="30.8.4.7">
<h4><span class="header-section-number">30.8.4.7</span> Implementing the Panel Match DiD Estimator<a href="sec-modern-estimators-for-staggered-adoption.html#implementing-the-panel-match-did-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb783-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span></code></pre></div>
<p><strong>Treatment Variation Plot</strong></p>
<p>Visualizing the variation of treatment across space and time is essential to assess whether the treatment has sufficient heterogeneity to support credible causal identification.</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-1" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb784-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-2" tabindex="-1"></a>  <span class="at">panel.data =</span> <span class="fu">PanelData</span>(</span>
<span id="cb784-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-3" tabindex="-1"></a>    <span class="at">panel.data =</span> dem,</span>
<span id="cb784-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-4" tabindex="-1"></a>    <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb784-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-5" tabindex="-1"></a>    <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb784-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-6" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb784-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-7" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb784-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-8" tabindex="-1"></a>  ),</span>
<span id="cb784-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-9" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb784-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-10" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb784-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-11" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span></span>
<span id="cb784-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb784-12" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li><p>This plot aids in identifying whether the treatment is broadly distributed or concentrated among a few units or time periods.</p></li>
<li><p>Insufficient treatment variation may weaken identification or reduce the precision of estimated effects.</p></li>
</ul>
<div id="setting-parameters-f-and-l" class="section level5 hasAnchor" number="30.8.4.7.1">
<h5><span class="header-section-number">30.8.4.7.1</span> Setting Parameters <span class="math inline">\(F\)</span> and <span class="math inline">\(L\)</span><a href="sec-modern-estimators-for-staggered-adoption.html#setting-parameters-f-and-l" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ol style="list-style-type: decimal">
<li>Select <span class="math inline">\(F\)</span>: the number of leads, or time periods after treatment, for which the effect is measured.</li>
</ol>
<ul>
<li><p><span class="math inline">\(F = 0\)</span>: contemporaneous (short-term) treatment effect.</p></li>
<li><p><span class="math inline">\(F &gt; 0\)</span>: long-term or cumulative effects.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Select <span class="math inline">\(L\)</span>: the number of lags (prior treatment periods) used in matching to adjust for carryover effects.</li>
</ol>
<ul>
<li><p>Increasing <span class="math inline">\(L\)</span> enhances credibility but reduces match quality and sample size.</p></li>
<li><p>This selection reflects the bias-variance tradeoff.</p></li>
</ul>
<hr />
</div>
<div id="causal-quantity-of-interest" class="section level5 hasAnchor" number="30.8.4.7.2">
<h5><span class="header-section-number">30.8.4.7.2</span> Causal Quantity of Interest<a href="sec-modern-estimators-for-staggered-adoption.html#causal-quantity-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">ATT</a> is defined as:</p>
<p><span class="math display">\[
\delta(F, L) = \mathbb{E} \left[ Y_{i,t+F}(1) - Y_{i,t+F}(0) \mid X_{i,t} = 1, \text{History}_{i,t-L:t-1} \right]
\]</span></p>
<ul>
<li><p>This estimator accounts for carryover history (via <span class="math inline">\(L\)</span>) and post-treatment dynamics (via <span class="math inline">\(F\)</span>).</p></li>
<li><p>It is also robust to treatment reversals, i.e., treatment switching back to control.</p></li>
</ul>
<p>A related estimand, the <strong>Average Reversal Treatment Effect (ART)</strong>, measures the causal effect of switching from treatment to control.</p>
</div>
<div id="choosing-f-and-l" class="section level5 hasAnchor" number="30.8.4.7.3">
<h5><span class="header-section-number">30.8.4.7.3</span> Choosing <span class="math inline">\(F\)</span> and <span class="math inline">\(L\)</span><a href="sec-modern-estimators-for-staggered-adoption.html#choosing-f-and-l" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li><p><strong>Large</strong> <span class="math inline">\(L\)</span>:</p>
<ul>
<li><p>Improves identification of causal effect by accounting for long-term treatment confounding.</p></li>
<li><p>Reduces sample size due to stricter matching requirements.</p></li>
</ul></li>
<li><p><strong>Large</strong> <span class="math inline">\(F\)</span>:</p>
<ul>
<li><p>Enables analysis of delayed effects.</p></li>
<li><p>Complicates interpretation if units switch treatment again before <span class="math inline">\(t + F\)</span>.</p></li>
</ul></li>
</ul>
<p>Researchers should select <span class="math inline">\(F\)</span> and <span class="math inline">\(L\)</span> based on substantive context, theoretical considerations, and sensitivity analysis.</p>
<hr />
</div>
<div id="constructing-and-refining-matched-sets" class="section level5 hasAnchor" number="30.8.4.7.4">
<h5><span class="header-section-number">30.8.4.7.4</span> Constructing and Refining Matched Sets<a href="sec-modern-estimators-for-staggered-adoption.html#constructing-and-refining-matched-sets" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ol style="list-style-type: decimal">
<li><strong>Initial Matching</strong></li>
</ol>
<ul>
<li><p>Each treated observation is matched to control units from other units in the same time period.</p></li>
<li><p>Matching is based on exact treatment histories from <span class="math inline">\(t - L\)</span> to <span class="math inline">\(t - 1\)</span>.</p></li>
</ul>
<p>Purpose</p>
<ul>
<li><p>Controls for carryover effects.</p></li>
<li><p>Ensures matched units have similar latent propensities for treatment.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Refinement Process</strong></li>
</ol>
<ul>
<li><p>Refined matched sets additionally adjust for pre-treatment covariates and lagged outcomes.</p></li>
<li><p>Matching strategies:</p>
<ul>
<li><p>Mahalanobis distance.</p></li>
<li><p>Propensity score.</p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li>Up to <span class="math inline">\(J\)</span> best matches per treated unit may be used.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Weighting</strong></li>
</ol>
<ul>
<li><p>Assigns weights to matched controls to emphasize similarity.</p></li>
<li><p>Weighting is often done via inverse propensity scores, or other balance-enhancing metrics.</p></li>
<li><p>Can be considered a generalization of traditional matching.</p></li>
</ul>
<hr />
</div>
<div id="difference-in-differences-estimation" class="section level5 hasAnchor" number="30.8.4.7.5">
<h5><span class="header-section-number">30.8.4.7.5</span> Difference-in-Differences Estimation<a href="sec-modern-estimators-for-staggered-adoption.html#difference-in-differences-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Once matched sets are constructed:</p>
<ul>
<li><p>The counterfactual for each treated unit is a weighted average of outcomes from its matched control set.</p></li>
<li><p>The DiD estimate of ATT is:</p></li>
</ul>
<p><span class="math display">\[
\widehat{\delta}_{\text{ATT}} = \frac{1}{|T_1|} \sum_{(i,t) \in T_1} \left[ Y_{i,t+F} - \sum_{j \in \mathcal{C}_{it}} w_{ijt} Y_{j,t+F} \right]
\]</span></p>
<p>where <span class="math inline">\(T_1\)</span> is the set of treated observations, <span class="math inline">\(\mathcal{C}_{it}\)</span> is the matched control set, and <span class="math inline">\(w_{ijt}\)</span> are normalized weights.</p>
<p>Considerations when <span class="math inline">\(F &gt; 0\)</span>:</p>
<ul>
<li><p>Matched controls may themselves switch into treatment before <span class="math inline">\(t + F\)</span>.</p></li>
<li><p>Some treated units may revert to control.</p></li>
</ul>
<hr />
</div>
<div id="checking-covariate-balance" class="section level5 hasAnchor" number="30.8.4.7.6">
<h5><span class="header-section-number">30.8.4.7.6</span> Checking Covariate Balance<a href="sec-modern-estimators-for-staggered-adoption.html#checking-covariate-balance" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>One of the main advantages of matching-based estimators is the ability to diagnose balance:</p>
<ul>
<li>For each covariate and each lag, compute:</li>
</ul>
<p><span class="math display">\[
\text{Standardized Difference} = \frac{\bar{X}_{\text{treated}} - \bar{X}_{\text{control}}}{\text{SD}_{\text{treated}}}
\]</span></p>
<ul>
<li><p>Aggregate these over all treated observations and time periods.</p></li>
<li><p>Examine balance on:</p>
<ul>
<li><p>Time-varying covariates,</p></li>
<li><p>Lagged outcomes,</p></li>
<li><p>Baseline covariates</p></li>
</ul></li>
</ul>
<p>Balance checks provide indirect validation of the <a href="assumptions-3.html#prior-parallel-trends-test">parallel trends assumption</a>.</p>
<hr />
</div>
<div id="standard-error-estimation" class="section level5 hasAnchor" number="30.8.4.7.7">
<h5><span class="header-section-number">30.8.4.7.7</span> Standard Error Estimation<a href="sec-modern-estimators-for-staggered-adoption.html#standard-error-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li><p>Analogous to the conditional variance seen in regression models.</p></li>
<li><p>Standard errors are calculated conditional on the matching weights <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span>.</p></li>
<li><p>SE here is a measure of sampling uncertainty given the matched design.</p></li>
</ul>
<p><strong>Note</strong>: They do not incorporate uncertainty from the matching procedure itself <span class="citation">(<a href="#ref-ho2007matching">Ho et al. 2007</a>)</span>.</p>
<hr />
</div>
<div id="matching-on-treatment-history" class="section level5 hasAnchor" number="30.8.4.7.8">
<h5><span class="header-section-number">30.8.4.7.8</span> Matching on Treatment History<a href="sec-modern-estimators-for-staggered-adoption.html#matching-on-treatment-history" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li><p>The goal is to compare treated units transitioning into treatment to control units with comparable treatment histories.</p></li>
<li><p>Set <code>qoi =</code>:</p>
<ul>
<li><p><code>"att"</code>: Average Treatment on the Treated,</p></li>
<li><p><code>"atc"</code>: Average Treatment on the Controls,</p></li>
<li><p><code>"art"</code>: Average Reversal Treatment Effect,</p></li>
<li><p><code>"ate"</code>: Average Treatment Effect.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span>
<span id="cb785-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-2" tabindex="-1"></a><span class="co"># All examples follow the package&#39;s vignette</span></span>
<span id="cb785-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-3" tabindex="-1"></a><span class="co"># Create the matched sets</span></span>
<span id="cb785-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-4" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb785-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-5" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb785-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-6" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb785-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-7" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb785-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-8" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb785-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-9" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb785-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-10" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb785-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-11" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb785-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-12" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb785-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-13" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb785-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-14" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb785-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-15" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb785-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-16" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb785-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-17" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb785-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-18" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb785-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-19" tabindex="-1"></a>    )</span>
<span id="cb785-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-20" tabindex="-1"></a></span>
<span id="cb785-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-21" tabindex="-1"></a><span class="co"># visualize the treated unit and matched controls</span></span>
<span id="cb785-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-22" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb785-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-23" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb785-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-24" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb785-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-25" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span>,</span>
<span id="cb785-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-26" tabindex="-1"></a>    <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb785-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-27" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb785-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-28" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb785-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-29" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb785-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-30" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb785-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-31" tabindex="-1"></a>    <span class="at">matched.set =</span> PM.results.none<span class="sc">$</span>att[<span class="dv">1</span>],</span>
<span id="cb785-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-32" tabindex="-1"></a>    <span class="co"># highlight the particular set</span></span>
<span id="cb785-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-33" tabindex="-1"></a>    <span class="at">show.set.only =</span> <span class="cn">TRUE</span></span>
<span id="cb785-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb785-34" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-3-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Control units and the treated unit have identical treatment histories over the lag window (1988-1991)</p>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-1" tabindex="-1"></a><span class="fu">DisplayTreatment</span>(</span>
<span id="cb786-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-2" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb786-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-3" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb786-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-4" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Country Code&quot;</span>,</span>
<span id="cb786-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-5" tabindex="-1"></a>    <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb786-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-6" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb786-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-7" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb786-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-8" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb786-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-9" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb786-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-10" tabindex="-1"></a>    <span class="at">matched.set =</span> PM.results.none<span class="sc">$</span>att[<span class="dv">2</span>],</span>
<span id="cb786-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-11" tabindex="-1"></a>    <span class="co"># highlight the particular set</span></span>
<span id="cb786-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-12" tabindex="-1"></a>    <span class="at">show.set.only =</span> <span class="cn">TRUE</span></span>
<span id="cb786-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb786-13" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-4-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>This set is more limited than the first one, but we can still see that we have exact past histories.</p>
<ul>
<li><p><strong>Refining Matched Sets</strong></p>
<ul>
<li><p>Refinement involves assigning weights to control units.</p></li>
<li><p>Users must:</p>
<ol style="list-style-type: decimal">
<li><p>Specify a method for calculating unit similarity/distance.</p></li>
<li><p>Choose variables for similarity/distance calculations.</p></li>
</ol></li>
</ul></li>
<li><p><strong>Select a Refinement Method</strong></p>
<ul>
<li><p>Users determine the refinement method via the <strong><code>refinement.method</code></strong> argument.</p></li>
<li><p>Options include:</p>
<ul>
<li><p><code>mahalanobis</code></p></li>
<li><p><code>ps.match</code></p></li>
<li><p><code>CBPS.match</code></p></li>
<li><p><code>ps.weight</code></p></li>
<li><p><code>CBPS.weight</code></p></li>
<li><p><code>ps.msm.weight</code></p></li>
<li><p><code>CBPS.msm.weight</code></p></li>
<li><p><code>none</code></p></li>
</ul></li>
<li><p>Methods with “match” in the name and Mahalanobis will assign equal weights to similar control units.</p></li>
<li><p>“Weighting” methods give higher weights to control units more similar to treated units.</p></li>
</ul></li>
<li><p><strong>Variable Selection</strong></p>
<ul>
<li><p>Users need to define which covariates will be used through the <strong><code>covs.formula</code></strong> argument, a one-sided formula object.</p></li>
<li><p>Variables on the right side of the formula are used for calculations.</p></li>
<li><p>“Lagged” versions of variables can be included using the format: <strong><code>I(lag(name.of.var, 0:n))</code></strong>.</p></li>
</ul></li>
<li><p><strong>Understanding <code>PanelMatch</code> and <code>matched.set</code> objects</strong></p>
<ul>
<li><p>The <strong><code>PanelMatch</code> function</strong> returns a <strong><code>PanelMatch</code> object</strong>.</p></li>
<li><p>The most crucial element within the <code>PanelMatch</code> object is the <strong>matched.set object</strong>.</p></li>
<li><p>Within the <code>PanelMatch</code> object, the matched.set object will have names like att, art, or atc.</p></li>
<li><p>If <strong><code>qoi = ate</code></strong>, there will be two matched.set objects: att and atc.</p></li>
</ul></li>
<li><p><strong>Matched.set Object Details</strong></p>
<ul>
<li><p>matched.set is a named list with added attributes.</p></li>
<li><p>Attributes include:</p>
<ul>
<li><p>Lag</p></li>
<li><p>Names of treatment</p></li>
<li><p>Unit and time variables</p></li>
</ul></li>
<li><p>Each list entry represents a matched set of treated and control units.</p></li>
<li><p>Naming follows a structure: <strong><code>[id variable].[time variable]</code></strong>.</p></li>
<li><p>Each list element is a vector of control unit ids that match the treated unit mentioned in the element name.</p></li>
<li><p>Since it’s a matching method, weights are only given to the <strong><code>size.match</code></strong> most similar control units based on distance calculations.</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-1" tabindex="-1"></a><span class="co"># PanelMatch without any refinement</span></span>
<span id="cb787-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-2" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb787-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-3" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb787-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-4" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb787-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-5" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb787-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-6" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb787-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-7" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb787-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-8" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb787-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-9" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb787-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-10" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb787-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-11" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb787-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-12" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb787-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-13" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb787-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-14" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb787-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-15" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb787-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-16" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb787-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-17" tabindex="-1"></a>    )</span>
<span id="cb787-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-18" tabindex="-1"></a></span>
<span id="cb787-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-19" tabindex="-1"></a><span class="co"># Extract the matched.set object</span></span>
<span id="cb787-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-20" tabindex="-1"></a>msets.none <span class="ot">&lt;-</span> PM.results.none<span class="sc">$</span>att</span>
<span id="cb787-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-21" tabindex="-1"></a></span>
<span id="cb787-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-22" tabindex="-1"></a><span class="co"># PanelMatch with refinement</span></span>
<span id="cb787-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-23" tabindex="-1"></a>PM.results.maha <span class="ot">&lt;-</span></span>
<span id="cb787-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-24" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb787-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-25" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb787-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-26" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="co"># use Mahalanobis distance</span></span>
<span id="cb787-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-27" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb787-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-28" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb787-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-29" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb787-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-30" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb787-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-31" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb787-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-32" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb787-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-33" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> tradewb,</span>
<span id="cb787-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-34" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb787-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-35" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span> ,</span>
<span id="cb787-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-36" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb787-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-37" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb787-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-38" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb787-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-39" tabindex="-1"></a>    )</span>
<span id="cb787-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb787-40" tabindex="-1"></a>msets.maha <span class="ot">&lt;-</span> PM.results.maha<span class="sc">$</span>att</span></code></pre></div>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-1" tabindex="-1"></a><span class="co"># these 2 should be identical because weights are not shown</span></span>
<span id="cb788-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-2" tabindex="-1"></a>msets.none <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb788-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-3" tabindex="-1"></a><span class="co">#&gt;   wbcode2 year matched.set.size</span></span>
<span id="cb788-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-4" tabindex="-1"></a><span class="co">#&gt; 1       4 1992               74</span></span>
<span id="cb788-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-5" tabindex="-1"></a><span class="co">#&gt; 2       4 1997                2</span></span>
<span id="cb788-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-6" tabindex="-1"></a><span class="co">#&gt; 3       6 1973               63</span></span>
<span id="cb788-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-7" tabindex="-1"></a><span class="co">#&gt; 4       6 1983               73</span></span>
<span id="cb788-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-8" tabindex="-1"></a><span class="co">#&gt; 5       7 1991               81</span></span>
<span id="cb788-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-9" tabindex="-1"></a><span class="co">#&gt; 6       7 1998                1</span></span>
<span id="cb788-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-10" tabindex="-1"></a>msets.maha <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb788-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-11" tabindex="-1"></a><span class="co">#&gt;   wbcode2 year matched.set.size</span></span>
<span id="cb788-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-12" tabindex="-1"></a><span class="co">#&gt; 1       4 1992               74</span></span>
<span id="cb788-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-13" tabindex="-1"></a><span class="co">#&gt; 2       4 1997                2</span></span>
<span id="cb788-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-14" tabindex="-1"></a><span class="co">#&gt; 3       6 1973               63</span></span>
<span id="cb788-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-15" tabindex="-1"></a><span class="co">#&gt; 4       6 1983               73</span></span>
<span id="cb788-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-16" tabindex="-1"></a><span class="co">#&gt; 5       7 1991               81</span></span>
<span id="cb788-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-17" tabindex="-1"></a><span class="co">#&gt; 6       7 1998                1</span></span>
<span id="cb788-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-18" tabindex="-1"></a><span class="co"># summary(msets.none)</span></span>
<span id="cb788-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb788-19" tabindex="-1"></a><span class="co"># summary(msets.maha)</span></span></code></pre></div>
<p><strong>Visualizing Matched Sets with the plot method</strong></p>
<ul>
<li><p>Users can visualize the distribution of the matched set sizes.</p></li>
<li><p>A red line, by default, indicates the count of matched sets where treated units had no matching control units (i.e., empty matched sets).</p></li>
<li><p>Plot adjustments can be made using <strong><code>graphics::plot</code></strong>.</p></li>
</ul>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb789-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-2" tabindex="-1"></a>  msets.none,</span>
<span id="cb789-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-3" tabindex="-1"></a>  <span class="at">panel.data =</span> <span class="fu">PanelData</span>(</span>
<span id="cb789-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-4" tabindex="-1"></a>    <span class="at">panel.data =</span> dem,</span>
<span id="cb789-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-5" tabindex="-1"></a>    <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>,</span>
<span id="cb789-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-6" tabindex="-1"></a>    <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb789-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-7" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb789-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-8" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span></span>
<span id="cb789-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-9" tabindex="-1"></a>  )</span>
<span id="cb789-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb789-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Comparing Methods of Refinement</strong></p>
<ul>
<li><p>Users are encouraged to:</p>
<ul>
<li><p>Use substantive knowledge for experimentation and evaluation.</p></li>
<li><p>Consider the following when configuring <code>PanelMatch</code>:</p>
<ol style="list-style-type: decimal">
<li><p>The number of matched sets.</p></li>
<li><p>The number of controls matched to each treated unit.</p></li>
<li><p>Achieving covariate balance.</p></li>
</ol></li>
<li><p><strong>Note</strong>: Large numbers of small matched sets can lead to larger standard errors during the estimation stage.</p></li>
<li><p>Covariates that aren’t well balanced can lead to undesirable comparisons between treated and control units.</p></li>
<li><p>Aspects to consider include:</p>
<ul>
<li><p>Refinement method.</p></li>
<li><p>Variables for weight calculation.</p></li>
<li><p>Size of the lag window.</p></li>
<li><p>Procedures for addressing missing data (refer to <strong><code>match.missing</code></strong> and <strong><code>listwise.delete</code></strong> arguments).</p></li>
<li><p>Maximum size of matched sets (for matching methods).</p></li>
</ul></li>
</ul></li>
<li><p><strong>Supportive Features:</strong></p>
<ul>
<li><p><strong><code>print</code></strong>, <strong><code>plot</code></strong>, and <strong><code>summary</code></strong> methods assist in understanding matched sets and their sizes.</p></li>
<li><p><strong><code>get_covariate_balance</code></strong> helps evaluate covariate balance:</p>
<ul>
<li>Lower values in the covariate balance calculations are preferred.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-1" tabindex="-1"></a>PM.results.none <span class="ot">&lt;-</span></span>
<span id="cb790-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-2" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb790-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-3" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb790-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-4" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb790-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-5" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb790-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-6" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb790-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-7" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb790-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-8" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb790-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-9" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb790-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-10" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-11" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb790-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-12" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb790-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-13" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb790-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-14" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb790-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-15" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb790-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-16" tabindex="-1"></a>    )</span>
<span id="cb790-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-17" tabindex="-1"></a>PM.results.maha <span class="ot">&lt;-</span></span>
<span id="cb790-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-18" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb790-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-19" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb790-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-20" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb790-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-21" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb790-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-22" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb790-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-23" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb790-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-24" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb790-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-25" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb790-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-26" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-27" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb790-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-28" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb790-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-29" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb790-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-30" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb790-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-31" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb790-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-32" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb790-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-33" tabindex="-1"></a>    )</span>
<span id="cb790-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-34" tabindex="-1"></a></span>
<span id="cb790-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-35" tabindex="-1"></a><span class="co"># listwise deletion used for missing data</span></span>
<span id="cb790-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-36" tabindex="-1"></a>PM.results.listwise <span class="ot">&lt;-</span></span>
<span id="cb790-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-37" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb790-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-38" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb790-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-39" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb790-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-40" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb790-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-41" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb790-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-42" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb790-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-43" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb790-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-44" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb790-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-45" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb790-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-46" tabindex="-1"></a>        <span class="at">listwise.delete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-47" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb790-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-48" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb790-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-49" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb790-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-50" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb790-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-51" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb790-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-52" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb790-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-53" tabindex="-1"></a>    )</span>
<span id="cb790-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-54" tabindex="-1"></a></span>
<span id="cb790-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-55" tabindex="-1"></a><span class="co"># propensity score based weighting method</span></span>
<span id="cb790-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-56" tabindex="-1"></a>PM.results.ps.weight <span class="ot">&lt;-</span></span>
<span id="cb790-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-57" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb790-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-58" tabindex="-1"></a>        <span class="at">lag =</span> <span class="dv">4</span>,</span>
<span id="cb790-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-59" tabindex="-1"></a>        <span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>,</span>
<span id="cb790-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-60" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb790-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-61" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb790-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-62" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb790-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-63" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb790-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-64" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb790-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-65" tabindex="-1"></a>        <span class="at">match.missing =</span> <span class="cn">FALSE</span>,</span>
<span id="cb790-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-66" tabindex="-1"></a>        <span class="at">listwise.delete =</span> <span class="cn">TRUE</span>,</span>
<span id="cb790-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-67" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb790-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-68" tabindex="-1"></a>        <span class="at">size.match =</span> <span class="dv">5</span>,</span>
<span id="cb790-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-69" tabindex="-1"></a>        <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb790-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-70" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb790-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-71" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span></span>
<span id="cb790-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-72" tabindex="-1"></a>    )</span>
<span id="cb790-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-73" tabindex="-1"></a></span>
<span id="cb790-74"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-74" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb790-75"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-75" tabindex="-1"></a>    PM.results.none,</span>
<span id="cb790-76"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-76" tabindex="-1"></a>    <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb790-77"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-77" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb790-78"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-78" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb790-79"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-79" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb790-80"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-80" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb790-81"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-81" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb790-82"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-82" tabindex="-1"></a>)</span>
<span id="cb790-83"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-83" tabindex="-1"></a><span class="co">#&gt; $att</span></span>
<span id="cb790-84"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-84" tabindex="-1"></a><span class="co">#&gt;         tradewb            y</span></span>
<span id="cb790-85"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-85" tabindex="-1"></a><span class="co">#&gt; t_4 -0.07245466  0.291871990</span></span>
<span id="cb790-86"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-86" tabindex="-1"></a><span class="co">#&gt; t_3 -0.20930129  0.208654876</span></span>
<span id="cb790-87"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-87" tabindex="-1"></a><span class="co">#&gt; t_2 -0.24425207  0.107736647</span></span>
<span id="cb790-88"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-88" tabindex="-1"></a><span class="co">#&gt; t_1 -0.10806125 -0.004950238</span></span>
<span id="cb790-89"><a href="sec-modern-estimators-for-staggered-adoption.html#cb790-89" tabindex="-1"></a><span class="co">#&gt; t_0 -0.09493854 -0.015198483</span></span></code></pre></div>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-1" tabindex="-1"></a><span class="co"># Compare covariate balance to refined sets</span></span>
<span id="cb791-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-2" tabindex="-1"></a><span class="co"># See large improvement in balance</span></span>
<span id="cb791-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-3" tabindex="-1"></a><span class="fu">get_covariate_balance</span>(</span>
<span id="cb791-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-4" tabindex="-1"></a>    PM.results.ps.weight,</span>
<span id="cb791-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-5" tabindex="-1"></a>     <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb791-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-6" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb791-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-7" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb791-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-8" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb791-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-9" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb791-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-10" tabindex="-1"></a>    <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb791-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-11" tabindex="-1"></a>)</span>
<span id="cb791-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-12" tabindex="-1"></a><span class="co">#&gt; $att</span></span>
<span id="cb791-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-13" tabindex="-1"></a><span class="co">#&gt;         tradewb          y</span></span>
<span id="cb791-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-14" tabindex="-1"></a><span class="co">#&gt; t_4 0.014362590 0.04035905</span></span>
<span id="cb791-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-15" tabindex="-1"></a><span class="co">#&gt; t_3 0.005529734 0.04188731</span></span>
<span id="cb791-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-16" tabindex="-1"></a><span class="co">#&gt; t_2 0.009410044 0.04195008</span></span>
<span id="cb791-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-17" tabindex="-1"></a><span class="co">#&gt; t_1 0.027907540 0.03975173</span></span>
<span id="cb791-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb791-18" tabindex="-1"></a><span class="co">#&gt; t_0 0.040272235 0.04167921</span></span></code></pre></div>
<p><strong><code>PanelEstimate</code></strong></p>
<ul>
<li><p><strong>Standard Error Calculation Methods</strong></p>
<ul>
<li><p>There are different methods available:</p>
<ul>
<li><p><strong>Bootstrap</strong> (default method with 1000 iterations).</p></li>
<li><p><strong>Conditional</strong>: Assumes independence across units, but not time.</p></li>
<li><p><strong>Unconditional</strong>: Doesn’t make assumptions of independence across units or time.</p></li>
</ul></li>
<li><p>For <strong><code>qoi</code></strong> values set to <code>att</code>, <code>art</code>, or <code>atc</code> <span class="citation">(<a href="#ref-imai2021matching">Imai, Kim, and Wang 2021</a>)</span>:</p>
<ul>
<li>You can use analytical methods for calculating standard errors, which include both “conditional” and “unconditional” methods.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-1" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb792-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-2" tabindex="-1"></a>    <span class="at">sets              =</span> PM.results.ps.weight,</span>
<span id="cb792-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-3" tabindex="-1"></a>    <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb792-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-4" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb792-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-5" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb792-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-6" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb792-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-7" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb792-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-8" tabindex="-1"></a>    <span class="at">se.method         =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb792-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-9" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb792-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-10" tabindex="-1"></a>    <span class="at">confidence.level  =</span> .<span class="dv">95</span></span>
<span id="cb792-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-11" tabindex="-1"></a>)</span>
<span id="cb792-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-12" tabindex="-1"></a></span>
<span id="cb792-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-13" tabindex="-1"></a><span class="co"># point estimates</span></span>
<span id="cb792-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-14" tabindex="-1"></a>PE.results[[<span class="st">&quot;estimates&quot;</span>]]</span>
<span id="cb792-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-15" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb792-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-16" tabindex="-1"></a></span>
<span id="cb792-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-17" tabindex="-1"></a><span class="co"># standard errors</span></span>
<span id="cb792-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-18" tabindex="-1"></a>PE.results[[<span class="st">&quot;standard.error&quot;</span>]]</span>
<span id="cb792-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-19" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb792-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-20" tabindex="-1"></a><span class="co">#&gt; 0.6126167 1.0374472 1.4424743 1.8057148 2.1835808</span></span>
<span id="cb792-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-21" tabindex="-1"></a></span>
<span id="cb792-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-22" tabindex="-1"></a></span>
<span id="cb792-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-23" tabindex="-1"></a><span class="co"># use conditional method</span></span>
<span id="cb792-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-24" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb792-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-25" tabindex="-1"></a>    <span class="at">sets             =</span> PM.results.ps.weight,</span>
<span id="cb792-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-26" tabindex="-1"></a>    <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb792-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-27" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb792-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-28" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb792-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-29" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb792-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-30" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb792-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-31" tabindex="-1"></a>    <span class="at">se.method        =</span> <span class="st">&quot;conditional&quot;</span>,</span>
<span id="cb792-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-32" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb792-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-33" tabindex="-1"></a>)</span>
<span id="cb792-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-34" tabindex="-1"></a></span>
<span id="cb792-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-35" tabindex="-1"></a><span class="co"># point estimates</span></span>
<span id="cb792-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-36" tabindex="-1"></a>PE.results[[<span class="st">&quot;estimates&quot;</span>]]</span>
<span id="cb792-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-37" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb792-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-38" tabindex="-1"></a></span>
<span id="cb792-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-39" tabindex="-1"></a><span class="co"># standard errors</span></span>
<span id="cb792-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-40" tabindex="-1"></a>PE.results[[<span class="st">&quot;standard.error&quot;</span>]]</span>
<span id="cb792-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-41" tabindex="-1"></a><span class="co">#&gt;       t+0       t+1       t+2       t+3       t+4 </span></span>
<span id="cb792-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-42" tabindex="-1"></a><span class="co">#&gt; 0.4844805 0.8170604 1.1171942 1.4116879 1.7172143</span></span>
<span id="cb792-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-43" tabindex="-1"></a></span>
<span id="cb792-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-44" tabindex="-1"></a><span class="fu">summary</span>(PE.results)</span>
<span id="cb792-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-45" tabindex="-1"></a><span class="co">#&gt;      estimate std.error       2.5%    97.5%</span></span>
<span id="cb792-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-46" tabindex="-1"></a><span class="co">#&gt; t+0 0.2609565 0.4844805 -0.6886078 1.210521</span></span>
<span id="cb792-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-47" tabindex="-1"></a><span class="co">#&gt; t+1 0.9630847 0.8170604 -0.6383243 2.564494</span></span>
<span id="cb792-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-48" tabindex="-1"></a><span class="co">#&gt; t+2 1.2851017 1.1171942 -0.9045586 3.474762</span></span>
<span id="cb792-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-49" tabindex="-1"></a><span class="co">#&gt; t+3 1.7370930 1.4116879 -1.0297644 4.503950</span></span>
<span id="cb792-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-50" tabindex="-1"></a><span class="co">#&gt; t+4 1.4871846 1.7172143 -1.8784937 4.852863</span></span>
<span id="cb792-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-51" tabindex="-1"></a></span>
<span id="cb792-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb792-52" tabindex="-1"></a><span class="fu">plot</span>(PE.results)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Moderating Variables</strong></p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-1" tabindex="-1"></a><span class="co"># moderating variable</span></span>
<span id="cb793-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-2" tabindex="-1"></a>dem<span class="sc">$</span>moderator <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb793-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-3" tabindex="-1"></a>dem<span class="sc">$</span>moderator <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dem<span class="sc">$</span>wbcode2 <span class="sc">&gt;</span> <span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb793-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-4" tabindex="-1"></a></span>
<span id="cb793-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-5" tabindex="-1"></a>PM.results <span class="ot">&lt;-</span></span>
<span id="cb793-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-6" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb793-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-7" tabindex="-1"></a>        <span class="at">lag                          =</span> <span class="dv">4</span>,</span>
<span id="cb793-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-8" tabindex="-1"></a>        <span class="co"># time.id                      = &quot;year&quot;,</span></span>
<span id="cb793-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-9" tabindex="-1"></a>        <span class="co"># unit.id                      = &quot;wbcode2&quot;,</span></span>
<span id="cb793-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-10" tabindex="-1"></a>        <span class="co"># treatment                    = &quot;dem&quot;,</span></span>
<span id="cb793-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-11" tabindex="-1"></a>        <span class="at">refinement.method            =</span> <span class="st">&quot;mahalanobis&quot;</span>,</span>
<span id="cb793-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-12" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb793-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-13" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb793-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-14" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb793-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-15" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb793-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-16" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb793-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-17" tabindex="-1"></a>        <span class="at">match.missing                =</span> <span class="cn">TRUE</span>,</span>
<span id="cb793-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-18" tabindex="-1"></a>        <span class="at">covs.formula                 =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb793-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-19" tabindex="-1"></a>        <span class="at">size.match                   =</span> <span class="dv">5</span>,</span>
<span id="cb793-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-20" tabindex="-1"></a>        <span class="at">qoi                          =</span> <span class="st">&quot;att&quot;</span>,</span>
<span id="cb793-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-21" tabindex="-1"></a>        <span class="co"># outcome.var                  = &quot;y&quot;,</span></span>
<span id="cb793-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-22" tabindex="-1"></a>        <span class="at">lead                         =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb793-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-23" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal    =</span> <span class="cn">FALSE</span>,</span>
<span id="cb793-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-24" tabindex="-1"></a>        <span class="at">use.diagonal.variance.matrix =</span> <span class="cn">TRUE</span></span>
<span id="cb793-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-25" tabindex="-1"></a>    )</span>
<span id="cb793-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-26" tabindex="-1"></a>PE.results <span class="ot">&lt;-</span></span>
<span id="cb793-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-27" tabindex="-1"></a>    <span class="fu">PanelEstimate</span>(<span class="at">sets      =</span> PM.results,</span>
<span id="cb793-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-28" tabindex="-1"></a>                  <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb793-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-29" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb793-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-30" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb793-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-31" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb793-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-32" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb793-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-33" tabindex="-1"></a>                  <span class="at">moderator =</span> <span class="st">&quot;moderator&quot;</span>)</span>
<span id="cb793-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-34" tabindex="-1"></a></span>
<span id="cb793-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-35" tabindex="-1"></a><span class="co"># Each element in the list corresponds to a level in the moderator</span></span>
<span id="cb793-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb793-36" tabindex="-1"></a><span class="fu">plot</span>(PE.results[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb794-1" tabindex="-1"></a></span>
<span id="cb794-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb794-2" tabindex="-1"></a><span class="fu">plot</span>(PE.results[[<span class="dv">2</span>]])</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-11-2.png" width="90%" style="display: block; margin: auto;" /></p>
<!--#To write up for journal submission, you can follow the following report:  -->
<p>In this study, closely aligned with the research by <span class="citation">Acemoglu et al. (<a href="#ref-acemoglu2019democracy">2019</a>)</span>, two key effects of democracy on economic growth are estimated: the impact of democratization and that of authoritarian reversal. The treatment variable, <span class="math inline">\(X_{it}\)</span>, is defined to be one if country <span class="math inline">\(i\)</span> is democratic in year <span class="math inline">\(t\)</span>, and zero otherwise.</p>
<p>The Average Treatment Effect for the Treated (ATT) under democratization is formulated as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\delta(F, L) &amp;= \mathbb{E} \left\{ Y_{i, t + F} (X_{it} = 1, X_{i, t - 1} = 0, \{X_{i,t-l}\}_{l=2}^L) \right. \\
&amp;\left. - Y_{i, t + F} (X_{it} = 0, X_{i, t - 1} = 0, \{X_{i,t-l}\}_{l=2}^L) | X_{it} = 1, X_{i, t - 1} = 0 \right\}
\end{aligned}
\]</span></p>
<p>In this framework, the treated observations are countries that transition from an authoritarian regime <span class="math inline">\(X_{it-1} = 0\)</span> to a democratic one <span class="math inline">\(X_{it} = 1\)</span>. The variable <span class="math inline">\(F\)</span> represents the number of leads, denoting the time periods following the treatment, and <span class="math inline">\(L\)</span> signifies the number of lags, indicating the time periods preceding the treatment.</p>
<p>The ATT under authoritarian reversal is given by:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathbb{E} \left[ Y_{i, t + F} (X_{it} = 0, X_{i, t - 1} = 1, \{ X_{i, t - l}\}_{l=2}^L ) \right. \\
&amp;\left. - Y_{i, t + F} (X_{it} = 1, X_{it-1} = 1, \{X_{i, t - l} \}_{l=2}^L ) | X_{it} = 0, X_{i, t - 1} = 1 \right]
\end{aligned}
\]</span></p>
<p>The ATT is calculated conditioning on 4 years of lags (<span class="math inline">\(L = 4\)</span>) and up to 4 years following the policy change <span class="math inline">\(F = 1, 2, 3, 4\)</span>. Matched sets for each treated observation are constructed based on its treatment history, with the number of matched control units generally decreasing when considering a 4-year treatment history as compared to a 1-year history.</p>
<p>To enhance the quality of matched sets, methods such as Mahalanobis distance matching, propensity score matching, and propensity score weighting are utilized. These approaches enable us to evaluate the effectiveness of each refinement method. In the process of matching, we employ both up-to-five and up-to-ten matching to investigate how sensitive our empirical results are to the maximum number of allowed matches. For more information on the refinement process, please see the Web Appendix</p>
<blockquote>
<p>The Mahalanobis distance is expressed through a specific formula. We aim to pair each treated unit with a maximum of <span class="math inline">\(J\)</span> control units, permitting replacement, denoted as <span class="math inline">\(| \mathcal{M}_{it} \le J|\)</span>. The average Mahalanobis distance between a treated and each control unit over time is computed as:</p>
<p><span class="math display">\[ S_{it} (i&#39;) = \frac{1}{L} \sum_{l = 1}^L \sqrt{(\mathbf{V}_{i, t - l} - \mathbf{V}_{i&#39;, t -l})^T \mathbf{\Sigma}_{i, t - l}^{-1} (\mathbf{V}_{i, t - l} - \mathbf{V}_{i&#39;, t -l})} \]</span></p>
<p>For a matched control unit <span class="math inline">\(i&#39; \in \mathcal{M}_{it}\)</span>, <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span> represents the time-varying covariates to adjust for, and <span class="math inline">\(\mathbf{\Sigma}_{it&#39;}\)</span> is the sample covariance matrix for <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span>. Essentially, we calculate a standardized distance using time-varying covariates and average this across different time intervals.</p>
<p>In the context of propensity score matching, we employ a logistic regression model with balanced covariates to derive the propensity score. Defined as the conditional likelihood of treatment given pre-treatment covariates <span class="citation">(<a href="#ref-rosenbaum1983central">Rosenbaum and Rubin 1983</a>)</span>, the propensity score is estimated by first creating a data subset comprised of all treated and their matched control units from the same year. This logistic regression model is then fitted as follows:</p>
<p><span class="math display">\[ \begin{aligned} &amp; e_{it} (\{\mathbf{U}_{i, t - l} \}^L_{l = 1}) \\ &amp;= Pr(X_{it} = 1| \mathbf{U}_{i, t -1}, \ldots, \mathbf{U}_{i, t - L}) \\ &amp;= \frac{1}{1 = \exp(- \sum_{l = 1}^L \beta_l^T \mathbf{U}_{i, t - l})} \end{aligned} \]</span></p>
<p>where <span class="math inline">\(\mathbf{U}_{it&#39;} = (X_{it&#39;}, \mathbf{V}_{it&#39;}^T)^T\)</span>. Given this model, the estimated propensity score for all treated and matched control units is then computed. This enables the adjustment for lagged covariates via matching on the calculated propensity score, resulting in the following distance measure:</p>
<p><span class="math display">\[ S_{it} (i&#39;) = | \text{logit} \{ \hat{e}_{it} (\{ \mathbf{U}_{i, t - l}\}^L_{l = 1})\} - \text{logit} \{ \hat{e}_{i&#39;t}( \{ \mathbf{U}_{i&#39;, t - l} \}^L_{l = 1})\} | \]</span></p>
<p>Here, <span class="math inline">\(\hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t - l}\}^L_{l = 1})\)</span> represents the estimated propensity score for each matched control unit <span class="math inline">\(i&#39; \in \mathcal{M}_{it}\)</span>.</p>
<p>Once the distance measure <span class="math inline">\(S_{it} (i&#39;)\)</span> has been determined for all control units in the original matched set, we fine-tune this set by selecting up to <span class="math inline">\(J\)</span> closest control units, which meet a researcher-defined caliper constraint <span class="math inline">\(C\)</span>. All other control units receive zero weight. This results in a refined matched set for each treated unit <span class="math inline">\((i, t)\)</span>:</p>
<p><span class="math display">\[ \mathcal{M}_{it}^* = \{i&#39; : i&#39; \in \mathcal{M}_{it}, S_{it} (i&#39;) &lt; C, S_{it} \le S_{it}^{(J)}\} \]</span></p>
<p><span class="math inline">\(S_{it}^{(J)}\)</span> is the <span class="math inline">\(J\)</span>th smallest distance among the control units in the original set <span class="math inline">\(\mathcal{M}_{it}\)</span>.</p>
<p>For further refinement using weighting, a weight is assigned to each control unit <span class="math inline">\(i&#39;\)</span> in a matched set corresponding to a treated unit <span class="math inline">\((i, t)\)</span>, with greater weight accorded to more similar units. We utilize inverse propensity score weighting, based on the propensity score model mentioned earlier:</p>
<p><span class="math display">\[ w_{it}^{i&#39;} \propto \frac{\hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t-l} \}^L_{l = 1} )}{1 - \hat{e}_{i&#39;t} (\{ \mathbf{U}_{i, t-l} \}^L_{l = 1} )} \]</span></p>
<p>In this model, <span class="math inline">\(\sum_{i&#39; \in \mathcal{M}_{it}} w_{it}^{i&#39;} = 1\)</span> and <span class="math inline">\(w_{it}^{i&#39;} = 0\)</span> for <span class="math inline">\(i&#39; \notin \mathcal{M}_{it}\)</span>. The model is fitted to the complete sample of treated and matched control units.</p>
</blockquote>
<blockquote>
<p>Checking Covariate Balance A distinct advantage of the proposed methodology over regression methods is the ability it offers researchers to inspect the covariate balance between treated and matched control observations. This facilitates the evaluation of whether treated and matched control observations are comparable regarding observed confounders. To investigate the mean difference of each covariate (e.g., <span class="math inline">\(V_{it&#39;j}\)</span>, representing the <span class="math inline">\(j\)</span>-th variable in <span class="math inline">\(\mathbf{V}_{it&#39;}\)</span>) between the treated observation and its matched control observation at each pre-treatment time period (i.e., <span class="math inline">\(t&#39; &lt; t\)</span>), we further standardize this difference. For any given pretreatment time period, we adjust by the standard deviation of each covariate across all treated observations in the dataset. Thus, the mean difference is quantified in terms of standard deviation units. Formally, for each treated observation <span class="math inline">\((i,t)\)</span> where <span class="math inline">\(D_{it} = 1\)</span>, we define the covariate balance for variable <span class="math inline">\(j\)</span> at the pretreatment time period <span class="math inline">\(t - l\)</span> as: <span class="math display">\[\begin{equation}
B_{it}(j, l) = \frac{V_{i, t- l,j}- \sum_{i&#39; \in \mathcal{M}_{it}}w_{it}^{i&#39;}V_{i&#39;, t-l,j}}{\sqrt{\frac{1}{N_1 - 1} \sum_{i&#39;=1}^N \sum_{t&#39; = L+1}^{T-F}D_{i&#39;t&#39;}(V_{i&#39;, t&#39;-l, j} - \bar{V}_{t&#39; - l, j})^2}}
\label{eq:covbalance}
\end{equation}\]</span> where <span class="math inline">\(N_1 = \sum_{i&#39;= 1}^N \sum_{t&#39; = L+1}^{T-F} D_{i&#39;t&#39;}\)</span> denotes the total number of treated observations and <span class="math inline">\(\bar{V}_{t-l,j} = \sum_{i=1}^N D_{i,t-l,j}/N\)</span>. We then aggregate this covariate balance measure across all treated observations for each covariate and pre-treatment time period:</p>
</blockquote>
<span class="math display">\[\begin{equation}
\bar{B}(j, l) = \frac{1}{N_1} \sum_{i=1}^N \sum_{t = L+ 1}^{T-F}D_{it} B_{it}(j,l)
\label{eq:aggbalance}
\end{equation}\]</span>
<blockquote>
<p>Lastly, we evaluate the balance of lagged outcome variables over several pre-treatment periods and that of time-varying covariates. This examination aids in assessing the validity of the parallel trend assumption integral to the DiD estimator justification.</p>
</blockquote>
<p>In Figure for balance scatter, we demonstrate the enhancement of covariate balance thank to the refinement of matched sets. Each scatter plot contrasts the absolute standardized mean difference, as detailed in Equation @ref(eq: ), before (horizontal axis) and after (vertical axis) this refinement. Points below the 45-degree line indicate an improved standardized mean balance for certain time-varying covariates post-refinement. The majority of variables benefit from this refinement process. Notably, the propensity score weighting (bottom panel) shows the most significant improvement, whereas Mahalanobis matching (top panel) yields a more modest improvement.</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-1" tabindex="-1"></a><span class="fu">library</span>(PanelMatch)</span>
<span id="cb795-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-2" tabindex="-1"></a><span class="fu">library</span>(causalverse)</span>
<span id="cb795-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-3" tabindex="-1"></a></span>
<span id="cb795-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-4" tabindex="-1"></a>runPanelMatch <span class="ot">&lt;-</span> <span class="cf">function</span>(method, lag, <span class="at">size.match=</span><span class="cn">NULL</span>, <span class="at">qoi=</span><span class="st">&quot;att&quot;</span>) {</span>
<span id="cb795-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-5" tabindex="-1"></a>    </span>
<span id="cb795-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-6" tabindex="-1"></a>    <span class="co"># Default parameters for PanelMatch</span></span>
<span id="cb795-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-7" tabindex="-1"></a>    common.args <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb795-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-8" tabindex="-1"></a>        <span class="at">lag =</span> lag,</span>
<span id="cb795-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-9" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb795-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-10" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb795-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-11" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb795-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-12" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb795-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-13" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb795-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-14" tabindex="-1"></a>        <span class="at">covs.formula =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb795-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-15" tabindex="-1"></a>        <span class="at">qoi =</span> qoi,</span>
<span id="cb795-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-16" tabindex="-1"></a>        <span class="at">lead =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb795-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-17" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb795-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-18" tabindex="-1"></a>        <span class="at">size.match =</span> size.match  <span class="co"># setting size.match here for all methods</span></span>
<span id="cb795-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-19" tabindex="-1"></a>    )</span>
<span id="cb795-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-20" tabindex="-1"></a>    </span>
<span id="cb795-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-21" tabindex="-1"></a>    <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;mahalanobis&quot;</span>) {</span>
<span id="cb795-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-22" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;mahalanobis&quot;</span></span>
<span id="cb795-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-23" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb795-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-24" tabindex="-1"></a>        common.args<span class="sc">$</span>use.diagonal.variance.matrix <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb795-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-25" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;ps.match&quot;</span>) {</span>
<span id="cb795-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-26" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;ps.match&quot;</span></span>
<span id="cb795-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-27" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb795-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-28" tabindex="-1"></a>        common.args<span class="sc">$</span>listwise.delete <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb795-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-29" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;ps.weight&quot;</span>) {</span>
<span id="cb795-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-30" tabindex="-1"></a>        common.args<span class="sc">$</span>refinement.method <span class="ot">&lt;-</span> <span class="st">&quot;ps.weight&quot;</span></span>
<span id="cb795-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-31" tabindex="-1"></a>        common.args<span class="sc">$</span>match.missing <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb795-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-32" tabindex="-1"></a>        common.args<span class="sc">$</span>listwise.delete <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb795-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-33" tabindex="-1"></a>    }</span>
<span id="cb795-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-34" tabindex="-1"></a>    </span>
<span id="cb795-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-35" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">do.call</span>(PanelMatch, common.args))</span>
<span id="cb795-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-36" tabindex="-1"></a>}</span>
<span id="cb795-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-37" tabindex="-1"></a></span>
<span id="cb795-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-38" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;mahalanobis&quot;</span>, <span class="st">&quot;ps.match&quot;</span>, <span class="st">&quot;ps.weight&quot;</span>)</span>
<span id="cb795-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-39" tabindex="-1"></a>lags <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb795-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb795-40" tabindex="-1"></a>sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)</span></code></pre></div>
<p>You can either do it sequentially</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-1" tabindex="-1"></a>res_pm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb796-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-2" tabindex="-1"></a></span>
<span id="cb796-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-3" tabindex="-1"></a><span class="cf">for</span>(method <span class="cf">in</span> methods) {</span>
<span id="cb796-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-4" tabindex="-1"></a>    <span class="cf">for</span>(lag <span class="cf">in</span> lags) {</span>
<span id="cb796-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-5" tabindex="-1"></a>        <span class="cf">for</span>(size <span class="cf">in</span> sizes) {</span>
<span id="cb796-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-6" tabindex="-1"></a>            name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb796-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-7" tabindex="-1"></a>            res_pm[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size)</span>
<span id="cb796-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-8" tabindex="-1"></a>        }</span>
<span id="cb796-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-9" tabindex="-1"></a>    }</span>
<span id="cb796-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-10" tabindex="-1"></a>}</span>
<span id="cb796-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-11" tabindex="-1"></a></span>
<span id="cb796-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-12" tabindex="-1"></a><span class="co"># Now, you can access res_pm using res_pm[[&quot;mahalanobis.1lag.5m&quot;]] etc.</span></span>
<span id="cb796-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-13" tabindex="-1"></a></span>
<span id="cb796-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-14" tabindex="-1"></a><span class="co"># for treatment reversal</span></span>
<span id="cb796-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-15" tabindex="-1"></a>res_pm_rev <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb796-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-16" tabindex="-1"></a></span>
<span id="cb796-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-17" tabindex="-1"></a><span class="cf">for</span>(method <span class="cf">in</span> methods) {</span>
<span id="cb796-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-18" tabindex="-1"></a>    <span class="cf">for</span>(lag <span class="cf">in</span> lags) {</span>
<span id="cb796-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-19" tabindex="-1"></a>        <span class="cf">for</span>(size <span class="cf">in</span> sizes) {</span>
<span id="cb796-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-20" tabindex="-1"></a>            name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb796-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-21" tabindex="-1"></a>            res_pm_rev[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb796-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-22" tabindex="-1"></a>        }</span>
<span id="cb796-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-23" tabindex="-1"></a>    }</span>
<span id="cb796-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb796-24" tabindex="-1"></a>}</span></code></pre></div>
<p>or in parallel</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-1" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb797-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-2" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb797-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-3" tabindex="-1"></a><span class="fu">registerDoParallel</span>(<span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb797-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-4" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb797-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-5" tabindex="-1"></a>res_pm <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb797-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-6" tabindex="-1"></a></span>
<span id="cb797-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-7" tabindex="-1"></a><span class="co"># Replace nested for-loops with foreach</span></span>
<span id="cb797-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-8" tabindex="-1"></a>results <span class="ot">&lt;-</span></span>
<span id="cb797-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-9" tabindex="-1"></a>  <span class="fu">foreach</span>(</span>
<span id="cb797-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-10" tabindex="-1"></a>    <span class="at">method =</span> methods,</span>
<span id="cb797-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-11" tabindex="-1"></a>    <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span>,</span>
<span id="cb797-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-12" tabindex="-1"></a>    <span class="at">.multicombine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb797-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-13" tabindex="-1"></a>    <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>)</span>
<span id="cb797-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-14" tabindex="-1"></a>  ) <span class="sc">%dopar%</span> {</span>
<span id="cb797-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-15" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb797-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-16" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb797-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-17" tabindex="-1"></a>      <span class="cf">for</span> (size <span class="cf">in</span> sizes) {</span>
<span id="cb797-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-18" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb797-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-19" tabindex="-1"></a>        tmp[[name]] <span class="ot">&lt;-</span> <span class="fu">runPanelMatch</span>(method, lag, size)</span>
<span id="cb797-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-20" tabindex="-1"></a>      }</span>
<span id="cb797-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-21" tabindex="-1"></a>    }</span>
<span id="cb797-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-22" tabindex="-1"></a>    tmp</span>
<span id="cb797-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-23" tabindex="-1"></a>  }</span>
<span id="cb797-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-24" tabindex="-1"></a></span>
<span id="cb797-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-25" tabindex="-1"></a><span class="co"># Collate results</span></span>
<span id="cb797-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-26" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(results)) {</span>
<span id="cb797-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-27" tabindex="-1"></a>  res_pm[[name]] <span class="ot">&lt;-</span> results[[name]]</span>
<span id="cb797-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-28" tabindex="-1"></a>}</span>
<span id="cb797-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-29" tabindex="-1"></a></span>
<span id="cb797-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-30" tabindex="-1"></a><span class="co"># Treatment reversal</span></span>
<span id="cb797-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-31" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb797-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-32" tabindex="-1"></a>res_pm_rev <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb797-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-33" tabindex="-1"></a></span>
<span id="cb797-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-34" tabindex="-1"></a><span class="co"># Replace nested for-loops with foreach</span></span>
<span id="cb797-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-35" tabindex="-1"></a>results_rev <span class="ot">&lt;-</span></span>
<span id="cb797-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-36" tabindex="-1"></a>  <span class="fu">foreach</span>(</span>
<span id="cb797-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-37" tabindex="-1"></a>    <span class="at">method =</span> methods,</span>
<span id="cb797-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-38" tabindex="-1"></a>    <span class="at">.combine =</span> <span class="st">&#39;c&#39;</span>,</span>
<span id="cb797-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-39" tabindex="-1"></a>    <span class="at">.multicombine =</span> <span class="cn">TRUE</span>,</span>
<span id="cb797-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-40" tabindex="-1"></a>    <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>)</span>
<span id="cb797-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-41" tabindex="-1"></a>  ) <span class="sc">%dopar%</span> {</span>
<span id="cb797-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-42" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb797-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-43" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb797-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-44" tabindex="-1"></a>      <span class="cf">for</span> (size <span class="cf">in</span> sizes) {</span>
<span id="cb797-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-45" tabindex="-1"></a>        name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb797-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-46" tabindex="-1"></a>        tmp[[name]] <span class="ot">&lt;-</span></span>
<span id="cb797-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-47" tabindex="-1"></a>          <span class="fu">runPanelMatch</span>(method, lag, size, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb797-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-48" tabindex="-1"></a>      }</span>
<span id="cb797-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-49" tabindex="-1"></a>    }</span>
<span id="cb797-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-50" tabindex="-1"></a>    tmp</span>
<span id="cb797-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-51" tabindex="-1"></a>  }</span>
<span id="cb797-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-52" tabindex="-1"></a></span>
<span id="cb797-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-53" tabindex="-1"></a><span class="co"># Collate results</span></span>
<span id="cb797-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-54" tabindex="-1"></a><span class="cf">for</span> (name <span class="cf">in</span> <span class="fu">names</span>(results_rev)) {</span>
<span id="cb797-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-55" tabindex="-1"></a>  res_pm_rev[[name]] <span class="ot">&lt;-</span> results_rev[[name]]</span>
<span id="cb797-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-56" tabindex="-1"></a>}</span>
<span id="cb797-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-57" tabindex="-1"></a></span>
<span id="cb797-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-58" tabindex="-1"></a></span>
<span id="cb797-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb797-59" tabindex="-1"></a><span class="fu">stopImplicitCluster</span>()</span></code></pre></div>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb798-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-2" tabindex="-1"></a></span>
<span id="cb798-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-3" tabindex="-1"></a><span class="co"># Updated plotting function</span></span>
<span id="cb798-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-4" tabindex="-1"></a>create_balance_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(method, lag, sizes, res_pm, dem) {</span>
<span id="cb798-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-5" tabindex="-1"></a>    matched_set_lists <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sizes, <span class="cf">function</span>(size) {</span>
<span id="cb798-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-6" tabindex="-1"></a>        res_pm[[<span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag.&quot;</span>, size, <span class="st">&quot;m&quot;</span>)]]<span class="sc">$</span>att</span>
<span id="cb798-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-7" tabindex="-1"></a>    })</span>
<span id="cb798-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-8" tabindex="-1"></a>    </span>
<span id="cb798-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-9" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb798-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-10" tabindex="-1"></a>        <span class="fu">balance_scatter_custom</span>(</span>
<span id="cb798-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-11" tabindex="-1"></a>            <span class="at">matched_set_list =</span> matched_set_lists,</span>
<span id="cb798-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-12" tabindex="-1"></a>            <span class="at">legend.title =</span> <span class="st">&quot;Possible Matches&quot;</span>,</span>
<span id="cb798-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-13" tabindex="-1"></a>            <span class="at">set.names =</span> <span class="fu">as.character</span>(sizes),</span>
<span id="cb798-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-14" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>),</span>
<span id="cb798-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-15" tabindex="-1"></a>            </span>
<span id="cb798-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-16" tabindex="-1"></a>            <span class="co"># for compiled plot, you don&#39;t need x,y, or main labs</span></span>
<span id="cb798-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-17" tabindex="-1"></a>            <span class="at">x.axis.label =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb798-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-18" tabindex="-1"></a>            <span class="at">y.axis.label =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb798-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-19" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb798-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-20" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb798-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-21" tabindex="-1"></a>            <span class="at">dot.size =</span> <span class="dv">5</span>,</span>
<span id="cb798-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-22" tabindex="-1"></a>            <span class="co"># show.legend = F,</span></span>
<span id="cb798-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-23" tabindex="-1"></a>            <span class="at">them_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">32</span>),</span>
<span id="cb798-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-24" tabindex="-1"></a>            <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;tradewb&quot;</span>)</span>
<span id="cb798-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-25" tabindex="-1"></a>        )</span>
<span id="cb798-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-26" tabindex="-1"></a>    )</span>
<span id="cb798-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-27" tabindex="-1"></a>}</span>
<span id="cb798-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-28" tabindex="-1"></a></span>
<span id="cb798-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-29" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb798-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-30" tabindex="-1"></a></span>
<span id="cb798-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-31" tabindex="-1"></a><span class="cf">for</span> (method <span class="cf">in</span> methods) {</span>
<span id="cb798-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-32" tabindex="-1"></a>    <span class="cf">for</span> (lag <span class="cf">in</span> lags) {</span>
<span id="cb798-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-33" tabindex="-1"></a>        plots[[<span class="fu">paste0</span>(method, <span class="st">&quot;.&quot;</span>, lag, <span class="st">&quot;lag&quot;</span>)]] <span class="ot">&lt;-</span></span>
<span id="cb798-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-34" tabindex="-1"></a>            <span class="fu">create_balance_plot</span>(method, lag, sizes, res_pm, dem)</span>
<span id="cb798-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-35" tabindex="-1"></a>    }</span>
<span id="cb798-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-36" tabindex="-1"></a>}</span>
<span id="cb798-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-37" tabindex="-1"></a></span>
<span id="cb798-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-38" tabindex="-1"></a><span class="co"># # Arranging plots in a 3x2 grid</span></span>
<span id="cb798-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-39" tabindex="-1"></a><span class="co"># grid.arrange(plots[[&quot;mahalanobis.1lag&quot;]],</span></span>
<span id="cb798-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-40" tabindex="-1"></a><span class="co">#              plots[[&quot;mahalanobis.4lag&quot;]],</span></span>
<span id="cb798-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-41" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.match.1lag&quot;]],</span></span>
<span id="cb798-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-42" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.match.4lag&quot;]],</span></span>
<span id="cb798-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-43" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.weight.1lag&quot;]],</span></span>
<span id="cb798-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-44" tabindex="-1"></a><span class="co">#              plots[[&quot;ps.weight.4lag&quot;]],</span></span>
<span id="cb798-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-45" tabindex="-1"></a><span class="co">#              ncol=2, nrow=3)</span></span>
<span id="cb798-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-46" tabindex="-1"></a></span>
<span id="cb798-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-47" tabindex="-1"></a></span>
<span id="cb798-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-48" tabindex="-1"></a><span class="co"># Standardized Mean Difference of Covariates</span></span>
<span id="cb798-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-49" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb798-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-50" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb798-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-51" tabindex="-1"></a></span>
<span id="cb798-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-52" tabindex="-1"></a><span class="co"># Create column and row labels using textGrob</span></span>
<span id="cb798-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-53" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1-year Lag&quot;</span>, <span class="st">&quot;4-year Lag&quot;</span>)</span>
<span id="cb798-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-54" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Maha Matching&quot;</span>, <span class="st">&quot;PS Matching&quot;</span>, <span class="st">&quot;PS Weigthing&quot;</span>)</span>
<span id="cb798-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-55" tabindex="-1"></a></span>
<span id="cb798-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-56" tabindex="-1"></a>major.axes.fontsize <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb798-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-57" tabindex="-1"></a>minor.axes.fontsize <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb798-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-58" tabindex="-1"></a></span>
<span id="cb798-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-59" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb798-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-60" tabindex="-1"></a>    <span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;did_balance_scatter.png&quot;</span>),</span>
<span id="cb798-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-61" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">1200</span>,</span>
<span id="cb798-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-62" tabindex="-1"></a>    <span class="at">height =</span> <span class="dv">1000</span></span>
<span id="cb798-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-63" tabindex="-1"></a>)</span>
<span id="cb798-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-64" tabindex="-1"></a></span>
<span id="cb798-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-65" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb798-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-66" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb798-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-67" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb798-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-68" tabindex="-1"></a>        <span class="fu">nullGrob</span>(),</span>
<span id="cb798-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-69" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb798-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-70" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb798-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-71" tabindex="-1"></a>    ),</span>
<span id="cb798-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-72" tabindex="-1"></a>    </span>
<span id="cb798-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-73" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb798-74"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-74" tabindex="-1"></a>        row_labels[<span class="dv">1</span>],</span>
<span id="cb798-75"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-75" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb798-76"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-76" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb798-77"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-77" tabindex="-1"></a>    ), plots[[<span class="st">&quot;mahalanobis.1lag&quot;</span>]], plots[[<span class="st">&quot;mahalanobis.4lag&quot;</span>]]),</span>
<span id="cb798-78"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-78" tabindex="-1"></a>    </span>
<span id="cb798-79"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-79" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb798-80"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-80" tabindex="-1"></a>        row_labels[<span class="dv">2</span>],</span>
<span id="cb798-81"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-81" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb798-82"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-82" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb798-83"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-83" tabindex="-1"></a>    ), plots[[<span class="st">&quot;ps.match.1lag&quot;</span>]], plots[[<span class="st">&quot;ps.match.4lag&quot;</span>]]),</span>
<span id="cb798-84"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-84" tabindex="-1"></a>    </span>
<span id="cb798-85"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-85" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">textGrob</span>(</span>
<span id="cb798-86"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-86" tabindex="-1"></a>        row_labels[<span class="dv">3</span>],</span>
<span id="cb798-87"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-87" tabindex="-1"></a>        <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb798-88"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-88" tabindex="-1"></a>        <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb798-89"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-89" tabindex="-1"></a>    ), plots[[<span class="st">&quot;ps.weight.1lag&quot;</span>]], plots[[<span class="st">&quot;ps.weight.4lag&quot;</span>]])</span>
<span id="cb798-90"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-90" tabindex="-1"></a>)</span>
<span id="cb798-91"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-91" tabindex="-1"></a></span>
<span id="cb798-92"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-92" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb798-93"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-93" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb798-94"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-94" tabindex="-1"></a></span>
<span id="cb798-95"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-95" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb798-96"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-96" tabindex="-1"></a>    <span class="at">grobs =</span> grobs,</span>
<span id="cb798-97"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-97" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb798-98"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-98" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">4</span>,</span>
<span id="cb798-99"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-99" tabindex="-1"></a>    <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.42</span>, <span class="fl">0.42</span>),</span>
<span id="cb798-100"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-100" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.28</span>, <span class="fl">0.28</span>, <span class="fl">0.28</span>)</span>
<span id="cb798-101"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-101" tabindex="-1"></a>)</span>
<span id="cb798-102"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-102" tabindex="-1"></a></span>
<span id="cb798-103"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-103" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb798-104"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-104" tabindex="-1"></a>    <span class="st">&quot;Before Refinement&quot;</span>,</span>
<span id="cb798-105"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-105" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.5</span>,</span>
<span id="cb798-106"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-106" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.03</span>,</span>
<span id="cb798-107"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-107" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb798-108"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-108" tabindex="-1"></a>)</span>
<span id="cb798-109"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-109" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb798-110"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-110" tabindex="-1"></a>    <span class="st">&quot;After Refinement&quot;</span>,</span>
<span id="cb798-111"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-111" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.03</span>,</span>
<span id="cb798-112"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-112" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb798-113"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-113" tabindex="-1"></a>    <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb798-114"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-114" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb798-115"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-115" tabindex="-1"></a>)</span>
<span id="cb798-116"><a href="sec-modern-estimators-for-staggered-adoption.html#cb798-116" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>Note: Scatter plots display the standardized mean difference of each covariate <span class="math inline">\(j\)</span> and lag year <span class="math inline">\(l\)</span> as defined in Equation <a href="#eq:aggbalance">(<strong>??</strong>)</a> before (x-axis) and after (y-axis) matched set refinement. Each plot includes varying numbers of possible matches for each matching method. Rows represent different matching/weighting methods, while columns indicate adjustments for various lag lengths.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-1" tabindex="-1"></a><span class="co"># Step 1: Define configurations</span></span>
<span id="cb799-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-2" tabindex="-1"></a>configurations <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb799-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-3" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb799-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-4" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;none&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb799-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-5" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb799-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-6" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;mahalanobis&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb799-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-7" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.match&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb799-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-8" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.match&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>),</span>
<span id="cb799-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-9" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;att&quot;</span>),</span>
<span id="cb799-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-10" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">refinement.method =</span> <span class="st">&quot;ps.weight&quot;</span>, <span class="at">qoi =</span> <span class="st">&quot;art&quot;</span>)</span>
<span id="cb799-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-11" tabindex="-1"></a>)</span>
<span id="cb799-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-12" tabindex="-1"></a></span>
<span id="cb799-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-13" tabindex="-1"></a><span class="co"># Step 2: Use lapply or loop to generate results</span></span>
<span id="cb799-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-14" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(configurations, <span class="cf">function</span>(config) {</span>
<span id="cb799-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-15" tabindex="-1"></a>    <span class="fu">PanelMatch</span>(</span>
<span id="cb799-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-16" tabindex="-1"></a>        <span class="at">lag                       =</span> <span class="dv">4</span>,</span>
<span id="cb799-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-17" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb799-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-18" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb799-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-19" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb799-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-20" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb799-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-21" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb799-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-22" tabindex="-1"></a>        <span class="at">match.missing             =</span> <span class="cn">FALSE</span>,</span>
<span id="cb799-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-23" tabindex="-1"></a>        <span class="at">listwise.delete           =</span> <span class="cn">TRUE</span>,</span>
<span id="cb799-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-24" tabindex="-1"></a>        <span class="at">size.match                =</span> <span class="dv">5</span>,</span>
<span id="cb799-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-25" tabindex="-1"></a>        <span class="at">lead                      =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb799-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-26" tabindex="-1"></a>        <span class="at">forbid.treatment.reversal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb799-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-27" tabindex="-1"></a>        <span class="at">refinement.method         =</span> config<span class="sc">$</span>refinement.method,</span>
<span id="cb799-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-28" tabindex="-1"></a>        <span class="at">covs.formula              =</span> <span class="sc">~</span> <span class="fu">I</span>(<span class="fu">lag</span>(tradewb, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">lag</span>(y, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)),</span>
<span id="cb799-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-29" tabindex="-1"></a>        <span class="at">qoi                       =</span> config<span class="sc">$</span>qoi</span>
<span id="cb799-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-30" tabindex="-1"></a>    )</span>
<span id="cb799-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-31" tabindex="-1"></a>})</span>
<span id="cb799-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-32" tabindex="-1"></a></span>
<span id="cb799-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-33" tabindex="-1"></a><span class="co"># Step 3: Get covariate balance and plot</span></span>
<span id="cb799-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-34" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">mapply</span>(<span class="cf">function</span>(result, config) {</span>
<span id="cb799-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-35" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">get_covariate_balance</span>(</span>
<span id="cb799-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-36" tabindex="-1"></a>        <span class="cf">if</span> (config<span class="sc">$</span>qoi <span class="sc">==</span> <span class="st">&quot;att&quot;</span>)</span>
<span id="cb799-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-37" tabindex="-1"></a>            result<span class="sc">$</span>att</span>
<span id="cb799-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-38" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb799-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-39" tabindex="-1"></a>            result<span class="sc">$</span>art,</span>
<span id="cb799-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-40" tabindex="-1"></a>        <span class="at">panel.data =</span> <span class="fu">PanelData</span>(<span class="at">panel.data =</span> dem, </span>
<span id="cb799-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-41" tabindex="-1"></a>              <span class="at">unit.id =</span> <span class="st">&quot;wbcode2&quot;</span>, </span>
<span id="cb799-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-42" tabindex="-1"></a>              <span class="at">time.id =</span> <span class="st">&quot;year&quot;</span>, </span>
<span id="cb799-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-43" tabindex="-1"></a>              <span class="at">treatment =</span> <span class="st">&quot;dem&quot;</span>, </span>
<span id="cb799-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-44" tabindex="-1"></a>              <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>),</span>
<span id="cb799-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-45" tabindex="-1"></a>        <span class="at">covariates =</span> <span class="fu">c</span>(<span class="st">&quot;tradewb&quot;</span>, <span class="st">&quot;y&quot;</span>),</span>
<span id="cb799-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-46" tabindex="-1"></a>        <span class="at">plot =</span> F</span>
<span id="cb799-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-47" tabindex="-1"></a>    )</span>
<span id="cb799-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-48" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">plot_covariate_balance_pretrend</span>(df, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_legend =</span> F)</span>
<span id="cb799-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-49" tabindex="-1"></a>}, results, configurations, <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb799-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-50" tabindex="-1"></a></span>
<span id="cb799-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-51" tabindex="-1"></a><span class="co"># Set names for plots</span></span>
<span id="cb799-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-52" tabindex="-1"></a><span class="fu">names</span>(plots) <span class="ot">&lt;-</span> <span class="fu">sapply</span>(configurations, <span class="cf">function</span>(config) {</span>
<span id="cb799-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-53" tabindex="-1"></a>    <span class="fu">paste</span>(config<span class="sc">$</span>qoi, config<span class="sc">$</span>refinement.method, <span class="at">sep =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb799-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb799-54" tabindex="-1"></a>})</span></code></pre></div>
<p>To export</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb800-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-2" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb800-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-3" tabindex="-1"></a></span>
<span id="cb800-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-4" tabindex="-1"></a><span class="co"># Column and row labels</span></span>
<span id="cb800-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-5" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span></span>
<span id="cb800-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-6" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;None&quot;</span>,</span>
<span id="cb800-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-7" tabindex="-1"></a>      <span class="st">&quot;Mahalanobis&quot;</span>,</span>
<span id="cb800-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-8" tabindex="-1"></a>      <span class="st">&quot;Propensity Score Matching&quot;</span>,</span>
<span id="cb800-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-9" tabindex="-1"></a>      <span class="st">&quot;Propensity Score Weighting&quot;</span>)</span>
<span id="cb800-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-10" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ATT&quot;</span>, <span class="st">&quot;ART&quot;</span>)</span>
<span id="cb800-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-11" tabindex="-1"></a></span>
<span id="cb800-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-12" tabindex="-1"></a><span class="co"># Specify your desired fontsize for labels</span></span>
<span id="cb800-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-13" tabindex="-1"></a>minor.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb800-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-14" tabindex="-1"></a>major.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb800-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-15" tabindex="-1"></a></span>
<span id="cb800-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-16" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_covariate_balance.png&quot;</span>), <span class="at">width=</span><span class="dv">1200</span>, <span class="at">height=</span><span class="dv">1000</span>)</span>
<span id="cb800-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-17" tabindex="-1"></a></span>
<span id="cb800-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-18" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb800-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-19" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb800-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-20" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb800-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-21" tabindex="-1"></a>        <span class="fu">nullGrob</span>(),</span>
<span id="cb800-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-22" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb800-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-23" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb800-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-24" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">3</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb800-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-25" tabindex="-1"></a>        <span class="fu">textGrob</span>(col_labels[<span class="dv">4</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb800-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-26" tabindex="-1"></a>    ),</span>
<span id="cb800-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-27" tabindex="-1"></a>    </span>
<span id="cb800-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-28" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb800-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-29" tabindex="-1"></a>        <span class="fu">textGrob</span>(</span>
<span id="cb800-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-30" tabindex="-1"></a>            row_labels[<span class="dv">1</span>],</span>
<span id="cb800-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-31" tabindex="-1"></a>            <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb800-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-32" tabindex="-1"></a>            <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb800-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-33" tabindex="-1"></a>        ),</span>
<span id="cb800-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-34" tabindex="-1"></a>        plots<span class="sc">$</span>att.none,</span>
<span id="cb800-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-35" tabindex="-1"></a>        plots<span class="sc">$</span>att.mahalanobis,</span>
<span id="cb800-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-36" tabindex="-1"></a>        plots<span class="sc">$</span>att.ps.match,</span>
<span id="cb800-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-37" tabindex="-1"></a>        plots<span class="sc">$</span>att.ps.weight</span>
<span id="cb800-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-38" tabindex="-1"></a>    ),</span>
<span id="cb800-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-39" tabindex="-1"></a>    </span>
<span id="cb800-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-40" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb800-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-41" tabindex="-1"></a>        <span class="fu">textGrob</span>(</span>
<span id="cb800-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-42" tabindex="-1"></a>            row_labels[<span class="dv">2</span>],</span>
<span id="cb800-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-43" tabindex="-1"></a>            <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize),</span>
<span id="cb800-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-44" tabindex="-1"></a>            <span class="at">rot =</span> <span class="dv">90</span></span>
<span id="cb800-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-45" tabindex="-1"></a>        ),</span>
<span id="cb800-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-46" tabindex="-1"></a>        plots<span class="sc">$</span>art.none,</span>
<span id="cb800-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-47" tabindex="-1"></a>        plots<span class="sc">$</span>art.mahalanobis,</span>
<span id="cb800-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-48" tabindex="-1"></a>        plots<span class="sc">$</span>art.ps.match,</span>
<span id="cb800-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-49" tabindex="-1"></a>        plots<span class="sc">$</span>art.ps.weight</span>
<span id="cb800-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-50" tabindex="-1"></a>    )</span>
<span id="cb800-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-51" tabindex="-1"></a>)</span>
<span id="cb800-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-52" tabindex="-1"></a></span>
<span id="cb800-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-53" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb800-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-54" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb800-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-55" tabindex="-1"></a></span>
<span id="cb800-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-56" tabindex="-1"></a><span class="co"># Arrange your plots with text labels</span></span>
<span id="cb800-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-57" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb800-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-58" tabindex="-1"></a>    <span class="at">grobs   =</span> grobs,</span>
<span id="cb800-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-59" tabindex="-1"></a>    <span class="at">ncol    =</span> <span class="dv">5</span>,</span>
<span id="cb800-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-60" tabindex="-1"></a>    <span class="at">nrow    =</span> <span class="dv">3</span>,</span>
<span id="cb800-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-61" tabindex="-1"></a>    <span class="at">widths  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>, <span class="fl">0.225</span>),</span>
<span id="cb800-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-62" tabindex="-1"></a>    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>)</span>
<span id="cb800-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-63" tabindex="-1"></a>)</span>
<span id="cb800-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-64" tabindex="-1"></a></span>
<span id="cb800-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-65" tabindex="-1"></a><span class="co"># Add main x and y axis titles</span></span>
<span id="cb800-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-66" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb800-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-67" tabindex="-1"></a>    <span class="st">&quot;Refinement Methods&quot;</span>,</span>
<span id="cb800-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-68" tabindex="-1"></a>    <span class="at">x  =</span> <span class="fl">0.5</span>,</span>
<span id="cb800-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-69" tabindex="-1"></a>    <span class="at">y  =</span> <span class="fl">0.01</span>,</span>
<span id="cb800-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-70" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb800-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-71" tabindex="-1"></a>)</span>
<span id="cb800-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-72" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb800-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-73" tabindex="-1"></a>    <span class="st">&quot;Quantities of Interest&quot;</span>,</span>
<span id="cb800-74"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-74" tabindex="-1"></a>    <span class="at">x   =</span> <span class="fl">0.02</span>,</span>
<span id="cb800-75"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-75" tabindex="-1"></a>    <span class="at">y   =</span> <span class="fl">0.5</span>,</span>
<span id="cb800-76"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-76" tabindex="-1"></a>    <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb800-77"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-77" tabindex="-1"></a>    <span class="at">gp  =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb800-78"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-78" tabindex="-1"></a>)</span>
<span id="cb800-79"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-79" tabindex="-1"></a></span>
<span id="cb800-80"><a href="sec-modern-estimators-for-staggered-adoption.html#cb800-80" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb801-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb801-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb801-2" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_covariate_balance.png&quot;</span>))</span></code></pre></div>
<p>Note: Each graph displays the standardized mean difference, as outlined in Equation <a href="#eq:aggbalance">(<strong>??</strong>)</a>, plotted on the vertical axis across a pre-treatment duration of four years represented on the horizontal axis. The leftmost column illustrates the balance prior to refinement, while the subsequent three columns depict the covariate balance post the application of distinct refinement techniques. Each individual line signifies the balance of a specific variable during the pre-treatment phase.The red line is tradewb and blue line is the lagged outcome variable.</p>
<p>In Figure <a href="#fig:balancepretreat"><strong>??</strong></a>, we observe a marked improvement in covariate balance due to the implemented matching procedures during the pre-treatment period. Our analysis prioritizes methods that adjust for time-varying covariates over a span of four years preceding the treatment initiation. The two rows delineate the standardized mean balance for both treatment modalities, with individual lines representing the balance for each covariate.</p>
<p>Across all scenarios, the refinement attributed to matched sets significantly enhances balance. Notably, using propensity score weighting considerably mitigates imbalances in confounders. While some degree of imbalance remains evident in the Mahalanobis distance and propensity score matching techniques, the standardized mean difference for the lagged outcome remains stable throughout the pre-treatment phase. This consistency lends credence to the validity of the proposed DiD estimator.</p>
<p><strong>Estimation Results</strong></p>
<p>We now detail the estimated ATTs derived from the matching techniques. Figure below offers visual representations of the impacts of treatment initiation (upper panel) and treatment reversal (lower panel) on the outcome variable for a duration of 5 years post-transition, specifically, (<span class="math inline">\(F = 0, 1, …, 4\)</span>). Across the five methods (columns), it becomes evident that the point estimates of effects associated with treatment initiation consistently approximate zero over the 5-year window. In contrast, the estimated outcomes of treatment reversal are notably negative and maintain statistical significance through all refinement techniques during the initial year of transition and the 1 to 4 years that follow, provided treatment reversal is permissible. These effects are notably pronounced, pointing to an estimated reduction of roughly X% in the outcome variable.</p>
<p>Collectively, these findings indicate that the transition into the treated state from its absence doesn’t invariably lead to a heightened outcome. Instead, the transition from the treated state back to its absence exerts a considerable negative effect on the outcome variable in both the short and intermediate terms. Hence, the positive effect of the treatment (if we were to use traditional DiD) is actually driven by the negative effect of treatment reversal.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-1" tabindex="-1"></a><span class="co"># sequential</span></span>
<span id="cb802-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-2" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function</span></span>
<span id="cb802-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-3" tabindex="-1"></a></span>
<span id="cb802-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-4" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb802-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-5" tabindex="-1"></a>res_est <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_pm))</span>
<span id="cb802-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-6" tabindex="-1"></a></span>
<span id="cb802-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-7" tabindex="-1"></a><span class="co"># Iterate over each element in res_pm</span></span>
<span id="cb802-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm)) {</span>
<span id="cb802-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-9" tabindex="-1"></a>  res_est[[i]] <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb802-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-10" tabindex="-1"></a>    res_pm[[i]],</span>
<span id="cb802-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-11" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb802-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-12" tabindex="-1"></a>    <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb802-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-13" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb802-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-14" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb802-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-15" tabindex="-1"></a>  )</span>
<span id="cb802-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-16" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est list</span></span>
<span id="cb802-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-17" tabindex="-1"></a>  <span class="fu">names</span>(res_est)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm)[i]</span>
<span id="cb802-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-18" tabindex="-1"></a>}</span>
<span id="cb802-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-19" tabindex="-1"></a></span>
<span id="cb802-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-20" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function</span></span>
<span id="cb802-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-21" tabindex="-1"></a></span>
<span id="cb802-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-22" tabindex="-1"></a><span class="co"># Initialize an empty list to store plot results</span></span>
<span id="cb802-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-23" tabindex="-1"></a>res_est_plot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_est))</span>
<span id="cb802-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-24" tabindex="-1"></a></span>
<span id="cb802-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-25" tabindex="-1"></a><span class="co"># Iterate over each element in res_est</span></span>
<span id="cb802-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-26" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est)) {</span>
<span id="cb802-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-27" tabindex="-1"></a>    res_est_plot[[i]] <span class="ot">&lt;-</span></span>
<span id="cb802-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-28" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est[[i]],</span>
<span id="cb802-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-29" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb802-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-30" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb802-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-31" tabindex="-1"></a>    <span class="co"># Transfer the name of the current element to the res_est_plot list</span></span>
<span id="cb802-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-32" tabindex="-1"></a>    <span class="fu">names</span>(res_est_plot)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est)[i]</span>
<span id="cb802-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-33" tabindex="-1"></a>}</span>
<span id="cb802-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-34" tabindex="-1"></a></span>
<span id="cb802-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-35" tabindex="-1"></a><span class="co"># check results</span></span>
<span id="cb802-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-36" tabindex="-1"></a><span class="co"># res_est_plot$mahalanobis.1lag.5m</span></span>
<span id="cb802-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-37" tabindex="-1"></a></span>
<span id="cb802-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-38" tabindex="-1"></a></span>
<span id="cb802-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-39" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function for res_pm_rev</span></span>
<span id="cb802-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-40" tabindex="-1"></a></span>
<span id="cb802-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-41" tabindex="-1"></a><span class="co"># Initialize an empty list to store results</span></span>
<span id="cb802-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-42" tabindex="-1"></a>res_est_rev <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_pm_rev))</span>
<span id="cb802-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-43" tabindex="-1"></a></span>
<span id="cb802-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-44" tabindex="-1"></a><span class="co"># Iterate over each element in res_pm_rev</span></span>
<span id="cb802-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-45" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm_rev)) {</span>
<span id="cb802-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-46" tabindex="-1"></a>  res_est_rev[[i]] <span class="ot">&lt;-</span> <span class="fu">PanelEstimate</span>(</span>
<span id="cb802-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-47" tabindex="-1"></a>    res_pm_rev[[i]],</span>
<span id="cb802-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-48" tabindex="-1"></a>    <span class="at">data =</span> dem,</span>
<span id="cb802-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-49" tabindex="-1"></a>    <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb802-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-50" tabindex="-1"></a>    <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb802-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-51" tabindex="-1"></a>    <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb802-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-52" tabindex="-1"></a>  )</span>
<span id="cb802-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-53" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est_rev list</span></span>
<span id="cb802-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-54" tabindex="-1"></a>  <span class="fu">names</span>(res_est_rev)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm_rev)[i]</span>
<span id="cb802-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-55" tabindex="-1"></a>}</span>
<span id="cb802-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-56" tabindex="-1"></a></span>
<span id="cb802-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-57" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function for res_est_rev</span></span>
<span id="cb802-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-58" tabindex="-1"></a></span>
<span id="cb802-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-59" tabindex="-1"></a><span class="co"># Initialize an empty list to store plot results</span></span>
<span id="cb802-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-60" tabindex="-1"></a>res_est_plot_rev <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(res_est_rev))</span>
<span id="cb802-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-61" tabindex="-1"></a></span>
<span id="cb802-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-62" tabindex="-1"></a><span class="co"># Iterate over each element in res_est_rev</span></span>
<span id="cb802-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-63" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est_rev)) {</span>
<span id="cb802-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-64" tabindex="-1"></a>    res_est_plot_rev[[i]] <span class="ot">&lt;-</span></span>
<span id="cb802-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-65" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est_rev[[i]],</span>
<span id="cb802-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-66" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb802-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-67" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb802-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-68" tabindex="-1"></a>  <span class="co"># Transfer the name of the current element to the res_est_plot_rev list</span></span>
<span id="cb802-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-69" tabindex="-1"></a>  <span class="fu">names</span>(res_est_plot_rev)[i] <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est_rev)[i]</span>
<span id="cb802-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb802-70" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-1" tabindex="-1"></a><span class="co"># parallel</span></span>
<span id="cb803-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-2" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb803-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-3" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb803-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-4" tabindex="-1"></a></span>
<span id="cb803-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-5" tabindex="-1"></a><span class="co"># Detect the number of cores to use for parallel processing</span></span>
<span id="cb803-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-6" tabindex="-1"></a>num_cores <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb803-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-7" tabindex="-1"></a></span>
<span id="cb803-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-8" tabindex="-1"></a><span class="co"># Register the parallel backend</span></span>
<span id="cb803-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-9" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(num_cores)</span>
<span id="cb803-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-10" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb803-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-11" tabindex="-1"></a></span>
<span id="cb803-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-12" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function in parallel</span></span>
<span id="cb803-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-13" tabindex="-1"></a>res_est <span class="ot">&lt;-</span></span>
<span id="cb803-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-14" tabindex="-1"></a>    <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm), <span class="at">.packages =</span> <span class="st">&quot;PanelMatch&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb803-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-15" tabindex="-1"></a>        <span class="fu">PanelEstimate</span>(</span>
<span id="cb803-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-16" tabindex="-1"></a>            res_pm[[i]],</span>
<span id="cb803-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-17" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb803-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-18" tabindex="-1"></a>            <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb803-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-19" tabindex="-1"></a>            <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb803-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-20" tabindex="-1"></a>            <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb803-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-21" tabindex="-1"></a>        )</span>
<span id="cb803-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-22" tabindex="-1"></a>    }</span>
<span id="cb803-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-23" tabindex="-1"></a></span>
<span id="cb803-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-24" tabindex="-1"></a><span class="co"># Transfer names from res_pm to res_est</span></span>
<span id="cb803-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-25" tabindex="-1"></a><span class="fu">names</span>(res_est) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm)</span>
<span id="cb803-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-26" tabindex="-1"></a></span>
<span id="cb803-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-27" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function in parallel</span></span>
<span id="cb803-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-28" tabindex="-1"></a>res_est_plot <span class="ot">&lt;-</span></span>
<span id="cb803-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-29" tabindex="-1"></a>    <span class="fu">foreach</span>(</span>
<span id="cb803-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-30" tabindex="-1"></a>        <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est),</span>
<span id="cb803-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-31" tabindex="-1"></a>        <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb803-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-32" tabindex="-1"></a>    ) <span class="sc">%dopar%</span> {</span>
<span id="cb803-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-33" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est[[i]],</span>
<span id="cb803-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-34" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb803-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-35" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">10</span>))</span>
<span id="cb803-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-36" tabindex="-1"></a>    }</span>
<span id="cb803-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-37" tabindex="-1"></a></span>
<span id="cb803-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-38" tabindex="-1"></a><span class="co"># Transfer names from res_est to res_est_plot</span></span>
<span id="cb803-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-39" tabindex="-1"></a><span class="fu">names</span>(res_est_plot) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est)</span>
<span id="cb803-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-40" tabindex="-1"></a></span>
<span id="cb803-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-41" tabindex="-1"></a></span>
<span id="cb803-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-42" tabindex="-1"></a></span>
<span id="cb803-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-43" tabindex="-1"></a><span class="co"># Step 1: Apply PanelEstimate function for res_pm_rev in parallel</span></span>
<span id="cb803-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-44" tabindex="-1"></a>res_est_rev <span class="ot">&lt;-</span></span>
<span id="cb803-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-45" tabindex="-1"></a>    <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_pm_rev), <span class="at">.packages =</span> <span class="st">&quot;PanelMatch&quot;</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb803-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-46" tabindex="-1"></a>        <span class="fu">PanelEstimate</span>(</span>
<span id="cb803-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-47" tabindex="-1"></a>            res_pm_rev[[i]],</span>
<span id="cb803-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-48" tabindex="-1"></a>            <span class="at">data =</span> dem,</span>
<span id="cb803-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-49" tabindex="-1"></a>            <span class="at">se.method =</span> <span class="st">&quot;bootstrap&quot;</span>,</span>
<span id="cb803-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-50" tabindex="-1"></a>            <span class="at">number.iterations =</span> <span class="dv">1000</span>,</span>
<span id="cb803-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-51" tabindex="-1"></a>            <span class="at">confidence.level =</span> .<span class="dv">95</span></span>
<span id="cb803-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-52" tabindex="-1"></a>        )</span>
<span id="cb803-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-53" tabindex="-1"></a>    }</span>
<span id="cb803-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-54" tabindex="-1"></a></span>
<span id="cb803-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-55" tabindex="-1"></a><span class="co"># Transfer names from res_pm_rev to res_est_rev</span></span>
<span id="cb803-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-56" tabindex="-1"></a><span class="fu">names</span>(res_est_rev) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_pm_rev)</span>
<span id="cb803-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-57" tabindex="-1"></a></span>
<span id="cb803-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-58" tabindex="-1"></a><span class="co"># Step 2: Apply plot_PanelEstimate function for res_est_rev in parallel</span></span>
<span id="cb803-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-59" tabindex="-1"></a>res_est_plot_rev <span class="ot">&lt;-</span></span>
<span id="cb803-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-60" tabindex="-1"></a>    <span class="fu">foreach</span>(</span>
<span id="cb803-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-61" tabindex="-1"></a>        <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(res_est_rev),</span>
<span id="cb803-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-62" tabindex="-1"></a>        <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">&quot;PanelMatch&quot;</span>, <span class="st">&quot;causalverse&quot;</span>, <span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb803-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-63" tabindex="-1"></a>    ) <span class="sc">%dopar%</span> {</span>
<span id="cb803-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-64" tabindex="-1"></a>        <span class="fu">plot_PanelEstimate</span>(res_est_rev[[i]],</span>
<span id="cb803-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-65" tabindex="-1"></a>                           <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb803-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-66" tabindex="-1"></a>                           <span class="at">theme_use =</span> causalverse<span class="sc">::</span><span class="fu">ama_theme</span>(<span class="at">base_size =</span> <span class="dv">10</span>))</span>
<span id="cb803-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-67" tabindex="-1"></a>    }</span>
<span id="cb803-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-68" tabindex="-1"></a></span>
<span id="cb803-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-69" tabindex="-1"></a><span class="co"># Transfer names from res_est_rev to res_est_plot_rev</span></span>
<span id="cb803-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-70" tabindex="-1"></a><span class="fu">names</span>(res_est_plot_rev) <span class="ot">&lt;-</span> <span class="fu">names</span>(res_est_rev)</span>
<span id="cb803-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-71" tabindex="-1"></a></span>
<span id="cb803-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-72" tabindex="-1"></a><span class="co"># Stop the cluster</span></span>
<span id="cb803-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb803-73" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>To export</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-1" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb804-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-2" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb804-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-3" tabindex="-1"></a></span>
<span id="cb804-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-4" tabindex="-1"></a><span class="co"># Column and row labels</span></span>
<span id="cb804-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-5" tabindex="-1"></a>col_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mahalanobis 5m&quot;</span>, </span>
<span id="cb804-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-6" tabindex="-1"></a>                <span class="st">&quot;Mahalanobis 10m&quot;</span>, </span>
<span id="cb804-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-7" tabindex="-1"></a>                <span class="st">&quot;PS Matching 5m&quot;</span>, </span>
<span id="cb804-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-8" tabindex="-1"></a>                <span class="st">&quot;PS Matching 10m&quot;</span>, </span>
<span id="cb804-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-9" tabindex="-1"></a>                <span class="st">&quot;PS Weighting 5m&quot;</span>)</span>
<span id="cb804-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-10" tabindex="-1"></a></span>
<span id="cb804-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-11" tabindex="-1"></a>row_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ATT&quot;</span>, <span class="st">&quot;ART&quot;</span>)</span>
<span id="cb804-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-12" tabindex="-1"></a></span>
<span id="cb804-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-13" tabindex="-1"></a><span class="co"># Specify your desired fontsize for labels</span></span>
<span id="cb804-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-14" tabindex="-1"></a>minor.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb804-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-15" tabindex="-1"></a>major.axes.fontsize <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb804-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-16" tabindex="-1"></a></span>
<span id="cb804-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-17" tabindex="-1"></a><span class="fu">png</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_did_est_in_n_out.png&quot;</span>), <span class="at">width=</span><span class="dv">1200</span>, <span class="at">height=</span><span class="dv">1000</span>)</span>
<span id="cb804-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-18" tabindex="-1"></a></span>
<span id="cb804-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-19" tabindex="-1"></a><span class="co"># Create a list-of-lists, where each inner list represents a row</span></span>
<span id="cb804-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-20" tabindex="-1"></a>grid_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb804-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-21" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb804-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-22" tabindex="-1"></a>    <span class="fu">nullGrob</span>(),</span>
<span id="cb804-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-23" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb804-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-24" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb804-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-25" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">3</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb804-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-26" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">4</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize)),</span>
<span id="cb804-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-27" tabindex="-1"></a>    <span class="fu">textGrob</span>(col_labels[<span class="dv">5</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize))</span>
<span id="cb804-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-28" tabindex="-1"></a>  ),</span>
<span id="cb804-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-29" tabindex="-1"></a>  </span>
<span id="cb804-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-30" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb804-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-31" tabindex="-1"></a>    <span class="fu">textGrob</span>(row_labels[<span class="dv">1</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize), <span class="at">rot =</span> <span class="dv">90</span>),</span>
<span id="cb804-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-32" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb804-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-33" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb804-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-34" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb804-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-35" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb804-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-36" tabindex="-1"></a>    res_est_plot<span class="sc">$</span>ps.weight<span class="fl">.1</span>lag<span class="fl">.5</span>m</span>
<span id="cb804-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-37" tabindex="-1"></a>  ),</span>
<span id="cb804-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-38" tabindex="-1"></a>  </span>
<span id="cb804-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-39" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb804-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-40" tabindex="-1"></a>    <span class="fu">textGrob</span>(row_labels[<span class="dv">2</span>], <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> minor.axes.fontsize), <span class="at">rot =</span> <span class="dv">90</span>),</span>
<span id="cb804-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-41" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb804-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-42" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>mahalanobis<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb804-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-43" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.5</span>m,</span>
<span id="cb804-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-44" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.match<span class="fl">.1</span>lag<span class="fl">.10</span>m,</span>
<span id="cb804-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-45" tabindex="-1"></a>    res_est_plot_rev<span class="sc">$</span>ps.weight<span class="fl">.1</span>lag<span class="fl">.5</span>m</span>
<span id="cb804-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-46" tabindex="-1"></a>  )</span>
<span id="cb804-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-47" tabindex="-1"></a>)</span>
<span id="cb804-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-48" tabindex="-1"></a></span>
<span id="cb804-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-49" tabindex="-1"></a><span class="co"># &quot;Flatten&quot; the list-of-lists into a single list of grobs</span></span>
<span id="cb804-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-50" tabindex="-1"></a>grobs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(c, grid_list)</span>
<span id="cb804-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-51" tabindex="-1"></a></span>
<span id="cb804-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-52" tabindex="-1"></a><span class="co"># Arrange your plots with text labels</span></span>
<span id="cb804-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-53" tabindex="-1"></a><span class="fu">grid.arrange</span>(</span>
<span id="cb804-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-54" tabindex="-1"></a>  <span class="at">grobs   =</span> grobs,</span>
<span id="cb804-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-55" tabindex="-1"></a>  <span class="at">ncol    =</span> <span class="dv">6</span>,</span>
<span id="cb804-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-56" tabindex="-1"></a>  <span class="at">nrow    =</span> <span class="dv">3</span>,</span>
<span id="cb804-57"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-57" tabindex="-1"></a>  <span class="at">widths  =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>, <span class="fl">0.18</span>),</span>
<span id="cb804-58"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-58" tabindex="-1"></a>  <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.45</span>, <span class="fl">0.45</span>)</span>
<span id="cb804-59"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-59" tabindex="-1"></a>)</span>
<span id="cb804-60"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-60" tabindex="-1"></a></span>
<span id="cb804-61"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-61" tabindex="-1"></a><span class="co"># Add main x and y axis titles</span></span>
<span id="cb804-62"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-62" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb804-63"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-63" tabindex="-1"></a>  <span class="st">&quot;Methods&quot;</span>,</span>
<span id="cb804-64"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-64" tabindex="-1"></a>  <span class="at">x  =</span> <span class="fl">0.5</span>,</span>
<span id="cb804-65"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-65" tabindex="-1"></a>  <span class="at">y  =</span> <span class="fl">0.02</span>,</span>
<span id="cb804-66"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-66" tabindex="-1"></a>  <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb804-67"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-67" tabindex="-1"></a>)</span>
<span id="cb804-68"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-68" tabindex="-1"></a><span class="fu">grid.text</span>(</span>
<span id="cb804-69"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-69" tabindex="-1"></a>  <span class="st">&quot;&quot;</span>,</span>
<span id="cb804-70"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-70" tabindex="-1"></a>  <span class="at">x   =</span> <span class="fl">0.02</span>,</span>
<span id="cb804-71"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-71" tabindex="-1"></a>  <span class="at">y   =</span> <span class="fl">0.5</span>,</span>
<span id="cb804-72"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-72" tabindex="-1"></a>  <span class="at">rot =</span> <span class="dv">90</span>,</span>
<span id="cb804-73"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-73" tabindex="-1"></a>  <span class="at">gp  =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> major.axes.fontsize)</span>
<span id="cb804-74"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-74" tabindex="-1"></a>)</span>
<span id="cb804-75"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-75" tabindex="-1"></a></span>
<span id="cb804-76"><a href="sec-modern-estimators-for-staggered-adoption.html#cb804-76" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb805-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb805-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb805-2" tabindex="-1"></a><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;images&quot;</span>, <span class="st">&quot;p_did_est_in_n_out.png&quot;</span>))</span></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="counterfactual-estimators" class="section level3 hasAnchor" number="30.8.5">
<h3><span class="header-section-number">30.8.5</span> Counterfactual Estimators<a href="sec-modern-estimators-for-staggered-adoption.html#counterfactual-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Also known as <strong>imputation approach</strong> <span class="citation">(<a href="#ref-liu2024practical">Liu, Wang, and Xu 2024</a>)</span></li>
<li>This class of estimator consider observation treatment as missing data. Models are built using data from the control units to impute conterfactuals for the treated observations.</li>
<li>It’s called counterfactual estimators because they predict outcomes as if the treated observations had not received the treatment.</li>
<li>Advantages:
<ul>
<li>Avoids negative weights and biases by not using treated observations for modeling and applying uniform weights.</li>
<li>Supports various models, including those that may relax strict exogeneity assumptions.</li>
</ul></li>
<li>Methods including
<ul>
<li>Fixed-effects conterfactual estimator (FEct) (DiD is a special case):
<ul>
<li>Based on the [Two-way Fixed-effects], where assumes linear additive functional form of unobservables based on unit and time FEs. But FEct fixes the improper weighting of TWFE by comparing within each matched pair (where each pair is the treated observation and its predicted counterfactual that is the weighted sum of all untreated observations).</li>
</ul></li>
<li>Interactive Fixed Effects conterfactual estimator (IFEct) <span class="citation">Xu (<a href="#ref-xu2017generalized">2017</a>)</span>:
<ul>
<li>When we suspect unobserved time-varying confounder, FEct fails. Instead, IFEct uses the factor-augmented models to relax the strict exogeneity assumption where the effects of unobservables can be decomposed to unit FE + time FE + unit x time FE.</li>
<li>Generalized Synthetic Controls are a subset of IFEct when treatments don’t revert.</li>
</ul></li>
<li><a href="sec-modern-estimators-for-staggered-adoption.html#sec-matrix-completion-estimator">Matrix Completion Estimator</a> (MC) <span class="citation">(<a href="#ref-athey2021matrix">Athey et al. 2021</a>)</span>:
<ul>
<li>Generalization of factor-augmented models. Different from IFEct which uses hard impute, MC uses soft impute to regularize the singular values when decomposing the residual matrix.</li>
<li>Only when latent factors (of unobservables) are strong and sparse, IFEct outperforms MC.</li>
</ul></li>
<li><a href="sec-synthetic-control.html#sec-synthetic-control">Synthetic Control</a> (case studies)</li>
</ul></li>
</ul>
<p><strong>Identifying Assumptions</strong>:</p>
<ol style="list-style-type: decimal">
<li><strong>Function Form</strong>: Additive separability of observables, unobservables, and idiosyncratic error term.
<ul>
<li>Hence, these models are scale dependent <span class="citation">(<a href="#ref-athey2006identification">Athey and Imbens 2006</a>)</span> (e.g., log-transform outcome can invadiate this assumption).</li>
</ul></li>
<li><strong>Strict Exogeneity</strong>: Conditional on observables and unobservables, potential outcomes are independent of treatment assignment (i.e., baseline quasi-randomization)
<ul>
<li>In DiD, where unobservables = unit + time FEs, this assumption is the parallel trends assumption</li>
</ul></li>
<li><strong>Low-dimensional Decomposition (Feasibility Assumption)</strong>: Unobservable effects can be decomposed in low-dimension.
<ul>
<li>For the case that <span class="math inline">\(U_{it} = f_t \times \lambda_i\)</span> where <span class="math inline">\(f_t\)</span> = common time trend (time FE), and <span class="math inline">\(\lambda_i\)</span> = unit heterogeneity (unit FE). If <span class="math inline">\(U_{it} = f_t \times \lambda_i\)</span> , DiD can satisfy this assumption. But this assumption is weaker than that of DID, and allows us to control for unobservables based on data.</li>
</ul></li>
</ol>
<p><strong>Estimation Procedure</strong>:</p>
<ol style="list-style-type: decimal">
<li>Using all control observations, estimate the functions of both observable and unobservable variables (relying on Assumptions 1 and 3).</li>
<li>Predict the counterfactual outcomes for each treated unit using the obtained functions.</li>
<li>Calculate the difference in treatment effect for each treated individual.</li>
<li>By averaging over all treated individuals, you can obtain the Average Treatment Effect on the Treated (ATT).</li>
</ol>
<p>Notes:</p>
<ul>
<li>Use jackknife when number of treated units is small <span class="citation">(<a href="#ref-liu2024practical">Liu, Wang, and Xu 2024, 166</a>)</span>.</li>
</ul>
<div id="imputation-method" class="section level5 hasAnchor" number="30.8.5.0.1">
<h5><span class="header-section-number">30.8.5.0.1</span> Imputation Method<a href="sec-modern-estimators-for-staggered-adoption.html#imputation-method" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="citation">Liu, Wang, and Xu (<a href="#ref-liu2024practical">2024</a>)</span> can also account for treatment reversals and heterogeneous treatment effects.</p>
<p>Other imputation estimators include</p>
<ul>
<li><p><span class="citation">(<a href="#ref-gardner2022two">Gardner 2022</a>; <a href="#ref-borusyak2021revisiting">Borusyak, Jaravel, and Spiess 2021</a>)</span></p></li>
<li><p><span class="citation">(<a href="#ref-brown2023simple">N. Brown, Butts, and Westerlund 2023</a>)</span></p></li>
</ul>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-1" tabindex="-1"></a><span class="fu">library</span>(fect)</span>
<span id="cb806-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-2" tabindex="-1"></a></span>
<span id="cb806-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-3" tabindex="-1"></a>PanelMatch<span class="sc">::</span>dem</span>
<span id="cb806-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-4" tabindex="-1"></a></span>
<span id="cb806-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-5" tabindex="-1"></a>model.fect <span class="ot">&lt;-</span></span>
<span id="cb806-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-6" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb806-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-7" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb806-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-8" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb806-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-9" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb806-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-10" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb806-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-11" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb806-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-12" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb806-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-13" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb806-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-14" tabindex="-1"></a>        <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb806-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-15" tabindex="-1"></a>        <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb806-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-16" tabindex="-1"></a>        <span class="co"># twfe</span></span>
<span id="cb806-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-17" tabindex="-1"></a>        <span class="at">force =</span> <span class="st">&quot;two-way&quot;</span></span>
<span id="cb806-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-18" tabindex="-1"></a>    )</span>
<span id="cb806-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-19" tabindex="-1"></a><span class="fu">print</span>(model.fect<span class="sc">$</span>est.avg)</span>
<span id="cb806-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-20" tabindex="-1"></a></span>
<span id="cb806-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-21" tabindex="-1"></a><span class="fu">plot</span>(model.fect)</span>
<span id="cb806-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-22" tabindex="-1"></a></span>
<span id="cb806-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb806-23" tabindex="-1"></a><span class="fu">plot</span>(model.fect, <span class="at">stats =</span> <span class="st">&quot;F.p&quot;</span>)</span></code></pre></div>
<p>F-test <span class="math inline">\(H_0\)</span>: residual averages in the pre-treatment periods = 0</p>
<p>To see treatment reversal effects</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb807-1" tabindex="-1"></a><span class="fu">plot</span>(model.fect, <span class="at">stats =</span> <span class="st">&quot;F.p&quot;</span>, <span class="at">type =</span> <span class="st">&#39;exit&#39;</span>)</span></code></pre></div>
</div>
<div id="placebo-test" class="section level5 hasAnchor" number="30.8.5.0.2">
<h5><span class="header-section-number">30.8.5.0.2</span> Placebo Test<a href="sec-modern-estimators-for-staggered-adoption.html#placebo-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>By selecting a part of the data and excluding observations within a specified range to improve the model fitting, we then evaluate whether the estimated Average Treatment Effect (ATT) within this range significantly differs from zero. This approach helps us analyze the periods before treatment.</p>
<p>If this test fails, either the functional form or strict exogeneity assumption is problematic.</p>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-1" tabindex="-1"></a>out.fect.p <span class="ot">&lt;-</span></span>
<span id="cb808-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-2" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb808-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-3" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb808-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-4" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb808-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-5" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb808-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb808-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-7" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb808-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-8" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb808-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-9" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb808-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-10" tabindex="-1"></a>        <span class="at">placeboTest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb808-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-11" tabindex="-1"></a>        <span class="co"># using 3 periods</span></span>
<span id="cb808-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-12" tabindex="-1"></a>        <span class="at">placebo.period =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb808-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-13" tabindex="-1"></a>    )</span>
<span id="cb808-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb808-14" tabindex="-1"></a><span class="fu">plot</span>(out.fect.p, <span class="at">proportion =</span> <span class="fl">0.1</span>, <span class="at">stats =</span> <span class="st">&quot;placebo.p&quot;</span>)</span></code></pre></div>
</div>
<div id="no-carryover-effects-test" class="section level5 hasAnchor" number="30.8.5.0.3">
<h5><span class="header-section-number">30.8.5.0.3</span> (No) Carryover Effects Test<a href="sec-modern-estimators-for-staggered-adoption.html#no-carryover-effects-test" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The placebo test can be adapted to assess carryover effects by masking several post-treatment periods instead of pre-treatment ones. If no carryover effects are present, the average prediction error should approximate zero. For the carryover test, set <code>carryoverTest = TRUE</code>. Specify a post-treatment period range in carryover.period to exclude observations for model fitting, then evaluate if the estimated ATT significantly deviates from zero.</p>
<p>Even if we have carryover effects, in most cases of the staggered adoption setting, researchers are interested in the cumulative effects, or aggregated treatment effects, so it’s okay.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-1" tabindex="-1"></a>out.fect.c <span class="ot">&lt;-</span></span>
<span id="cb809-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-2" tabindex="-1"></a>    <span class="fu">fect</span>(</span>
<span id="cb809-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-3" tabindex="-1"></a>        <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb809-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-4" tabindex="-1"></a>        <span class="at">D =</span> <span class="st">&quot;dem&quot;</span>,</span>
<span id="cb809-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-5" tabindex="-1"></a>        <span class="at">X =</span> <span class="st">&quot;tradewb&quot;</span>,</span>
<span id="cb809-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-6" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">na.omit</span>(PanelMatch<span class="sc">::</span>dem),</span>
<span id="cb809-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-7" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">&quot;fe&quot;</span>,</span>
<span id="cb809-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-8" tabindex="-1"></a>        <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;wbcode2&quot;</span>, <span class="st">&quot;year&quot;</span>),</span>
<span id="cb809-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-9" tabindex="-1"></a>        <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb809-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-10" tabindex="-1"></a>        <span class="at">carryoverTest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb809-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-11" tabindex="-1"></a>        <span class="co"># how many periods of carryover</span></span>
<span id="cb809-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-12" tabindex="-1"></a>        <span class="at">carryover.period =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb809-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-13" tabindex="-1"></a>    )</span>
<span id="cb809-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb809-14" tabindex="-1"></a><span class="fu">plot</span>(out.fect.c,  <span class="at">stats =</span> <span class="st">&quot;carryover.p&quot;</span>)</span></code></pre></div>
<p>We have evidence of carryover effects.</p>
<hr />
</div>
</div>
<div id="sec-matrix-completion-estimator" class="section level3 hasAnchor" number="30.8.6">
<h3><span class="header-section-number">30.8.6</span> Matrix Completion Estimator<a href="sec-modern-estimators-for-staggered-adoption.html#sec-matrix-completion-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Matrix completion methods have become increasingly influential in causal inference for panel data, particularly when estimating <a href="types-of-treatment-effects.html#sec-average-treatment-effect">average treatment effects</a> in business settings such as marketing experiments, customer behavior modeling, and pricing interventions. These settings often feature <a href="sec-multiple-periods-and-variation-in-treatment-timing.html#sec-staggered-difference-in-differences">staggered adoption</a>of treatments across units and time, leading to <strong>structured missing data</strong>. <span class="citation">Athey et al. (<a href="#ref-athey2021matrix">2021</a>)</span> develop a matrix completion framework that subsumes methods based on <strong>unconfoundedness</strong> and <a href="sec-synthetic-control.html#sec-synthetic-control"><strong>synthetic controls</strong></a>, by leveraging the low-rank structure of potential outcomes matrices.</p>
<p>An important empirical context is consumer choice data in marketing, where missing outcomes can arise due to <strong>intermittent treatment</strong>, e.g., promotional campaigns delivered at varying times across different stores or consumer segments. One illustrative application is provided by <span class="citation">Bronnenberg, Dubé, and Sanders (<a href="#ref-bronnenberg2020consumer">2020</a>)</span>, who investigates <strong>consumer response to targeted marketing campaigns</strong> using panel data that naturally contains missing counterfactual outcomes for treated units.</p>
<p>Two key literatures have historically addressed the problem of imputing missing potential outcomes:</p>
<ul>
<li><strong>Unconfoundedness Framework</strong> <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span>:
<ul>
<li>Assumes <a href="sec-selection-on-observables.html#sec-selection-on-observables">selection on observables</a>.</li>
<li>Imputes missing control outcomes by matching or regression using untreated units with similar characteristics or histories.</li>
<li>Assumes time patterns are stable across units.</li>
</ul></li>
<li><a href="sec-synthetic-control.html#sec-synthetic-control"><strong>Synthetic Control</strong></a> <span class="citation">(<a href="#ref-abadie2010synthetic">Abadie, Diamond, and Hainmueller 2010</a>)</span>:
<ul>
<li>Constructs counterfactual outcomes as weighted averages of control units.</li>
<li>Assumes unit patterns are stable over time.</li>
<li>Particularly suited for single treated unit settings.</li>
</ul></li>
</ul>
<p>These methods can be unified under the matrix completion framework, which interprets the panel of outcomes as a low-rank matrix plus noise, allowing for flexible imputation without strong parametric assumptions.</p>
<p>Contributions of <span class="citation">Athey et al. (<a href="#ref-athey2021matrix">2021</a>)</span></p>
<ol style="list-style-type: decimal">
<li>Accommodates structured missingness, including staggered adoption.</li>
<li>Adjusts for unit (<span class="math inline">\(\mu_i\)</span>) and time (<span class="math inline">\(\lambda_t\)</span>) fixed effects prior to low-rank estimation.</li>
<li>Exhibits strong performance across unbalanced panels with varying dimensions:
<ul>
<li><span class="math inline">\(T \gg N\)</span>: Where unconfoundedness struggles.</li>
<li><span class="math inline">\(N \gg T\)</span>: Where synthetic control performs poorly.</li>
</ul></li>
</ol>
<p><strong>Advantages of Matrix Completion</strong></p>
<ul>
<li>Utilizes all units and periods, even treated ones, to learn latent factors.</li>
<li>Handles complex missingness patterns and autocorrelated errors.</li>
<li>Accommodates covariates and heterogeneous treatment effects.</li>
<li>Can apply weighted loss functions to account for non-random assignment or missingness.</li>
</ul>
<hr />
<div id="matrix-completion-core-assumptions" class="section level4 hasAnchor" number="30.8.6.1">
<h4><span class="header-section-number">30.8.6.1</span> Matrix Completion Core Assumptions<a href="sec-modern-estimators-for-staggered-adoption.html#matrix-completion-core-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The matrix completion approach is built on the assumption that the complete outcome matrix <span class="math inline">\(\mathbf{Y}\)</span> satisfies:</p>
<ol style="list-style-type: decimal">
<li><strong>Low-rank structure</strong>: <span class="math display">\[
\mathbf{Y} = \mathbf{U} \mathbf{V}^T + \mathbf{E}
\]</span> where <span class="math inline">\(\mathbf{U} \in \mathbb{R}^{N \times R}\)</span>, <span class="math inline">\(\mathbf{V} \in \mathbb{R}^{T \times R}\)</span>, and <span class="math inline">\(\mathbf{E}\)</span> is a noise matrix.</li>
<li><a href="theoretical-foundations-of-missing-data.html#missing-completely-at-random-mcar">Missing Completely At Random (MCAR)</a>: The pattern of missing data is independent of unobserved outcomes, conditional on observables.</li>
</ol>
<p>Unlike prior approaches, matrix completion does not impose a specific factorization, but rather regularizes the estimator, e.g., via nuclear norm minimization.</p>
<p>To identify the causal estimand, matrix completion relies on:</p>
<ul>
<li><p><a href="assumptions-for-identifying-treatment-effects.html#sec-sutva">SUTVA</a> <strong>(Stable Unit Treatment Value Assumption)</strong>: <span class="math inline">\(Y_{it}(w)\)</span> depends only on <span class="math inline">\(W_{it}\)</span>, not on other units’ treatments.</p></li>
<li><p><strong>No dynamic treatment effects</strong>: The treatment at time <span class="math inline">\(t\)</span> does not influence outcomes in other periods.</p></li>
</ul>
<hr />
</div>
<div id="causal-estimand" class="section level4 hasAnchor" number="30.8.6.2">
<h4><span class="header-section-number">30.8.6.2</span> Causal Estimand<a href="sec-modern-estimators-for-staggered-adoption.html#causal-estimand" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let <span class="math inline">\(Y_{it}(0)\)</span> and <span class="math inline">\(Y_{it}(1)\)</span> denote the potential outcomes under control and treatment. We observe treated outcomes, and aim to impute unobserved control outcomes:</p>
<p><span class="math display">\[
\tau = \frac{\sum_{(i,t): W_{it} = 1} \left[ Y_{it}(1) - Y_{it}(0) \right]}{\sum_{i,t} W_{it}}
\]</span></p>
<p>Let <span class="math inline">\(\mathcal{M}\)</span> be the set of indices <span class="math inline">\((i, t)\)</span> where <span class="math inline">\(W_{it} = 1\)</span> (treated, hence <span class="math inline">\(Y_{it}(0)\)</span> is missing), and <span class="math inline">\(\mathcal{O}\)</span> the set where <span class="math inline">\(W_{it} = 0\)</span> (control, hence <span class="math inline">\(Y_{it}(0)\)</span> is observed).</p>
<p>We conceptualize the data as 2 <span class="math inline">\(N \times T\)</span> matrices:</p>
<p><span class="math display">\[
\mathbf{Y} =
\begin{pmatrix}
Y_{11} &amp; Y_{12} &amp; ? &amp; \cdots &amp; Y_{1T} \\
? &amp; ? &amp; Y_{23} &amp; \cdots &amp; ? \\
Y_{31} &amp; ? &amp; Y_{33} &amp; \cdots &amp; ? \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
Y_{N1} &amp; ? &amp; Y_{N3} &amp; \cdots &amp; ?
\end{pmatrix},
\quad
\mathbf{W} =
\begin{pmatrix}
0 &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; \cdots &amp; 1 \\
0 &amp; 1 &amp; 0 &amp; \cdots &amp; 1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 1 &amp; 0 &amp; \cdots &amp; 1
\end{pmatrix}
\]</span></p>
<p><strong>Matrix Shape</strong></p>
<table>
<colgroup>
<col width="26%" />
<col width="25%" />
<col width="47%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Matrix Shape</td>
<td>Pattern</td>
<td>Literature / Method</td>
</tr>
<tr class="even">
<td>Thin (<span class="math inline">\(N \gg T\)</span>)</td>
<td>Single-treated-period</td>
<td>Horizontal regression (unconfoundedness)</td>
</tr>
<tr class="odd">
<td>Fat (<span class="math inline">\(T \gg N\)</span>)</td>
<td>Single-treated-unit</td>
<td>Vertical regression (synthetic control)</td>
</tr>
<tr class="even">
<td>Square (<span class="math inline">\(N \approx T\)</span>)</td>
<td>Varying patterns</td>
<td>TWFE / Matrix Completion</td>
</tr>
</tbody>
</table>
<p><strong>Special Patterns of Missingness</strong></p>
<ul>
<li><strong>Block structures</strong>:
<ul>
<li><strong>Single-period treatment</strong> (horizontal regression) <span class="citation">(<a href="#ref-imbens2015causal">G. W. Imbens and Rubin 2015</a>)</span></li>
<li><strong>Single-unit treatment</strong> (vertical regression) <span class="citation">(<a href="#ref-abadie2010synthetic">Abadie, Diamond, and Hainmueller 2010</a>)</span></li>
</ul></li>
<li><strong>Staggered adoption</strong>: Treatments occur at different times across units, as in many business interventions.</li>
</ul>
<hr />
</div>
<div id="unified-low-rank-model" class="section level4 hasAnchor" number="30.8.6.3">
<h4><span class="header-section-number">30.8.6.3</span> Unified Low-Rank Model<a href="sec-modern-estimators-for-staggered-adoption.html#unified-low-rank-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Matrix completion generalizes these approaches using a low-rank plus noise model:</p>
<p><span class="math display">\[
\mathbf{Y} = \mathbf{U} \mathbf{V}^T + \mathbf{E}
\]</span></p>
<p>where <span class="math inline">\(R = \text{rank}(\mathbf{Y})\)</span> is typically low relative to <span class="math inline">\(N\)</span> and <span class="math inline">\(T\)</span>.</p>
<ul>
<li><strong>TWFE</strong> assumes additivity: <span class="math inline">\(\mathbf{Y}_{it} = \mu_i + \lambda_t + \epsilon_{it}\)</span>.</li>
<li><strong>Interactive Fixed Effects</strong> use <span class="math inline">\(R\)</span> factors: <span class="math inline">\(\mathbf{Y}_{it} = \sum_{r=1}^R \alpha_{ir} \gamma_{rt} + \epsilon_{it}\)</span>. To estimate the number of factors <span class="math inline">\(R\)</span>, see <span class="citation">Bai and Ng (<a href="#ref-bai2002determining">2002</a>)</span> and <span class="citation">Moon and Weidner (<a href="#ref-moon2015linear">2015</a>)</span>.</li>
<li><strong>Matrix Completion</strong> estimates <span class="math inline">\(\mathbf{Y}\)</span> via regularization, avoiding the need to explicitly choose <span class="math inline">\(R\)</span>.</li>
</ul>
<!-- [Specifically](https://bookdown.org/stanfordgsbsilab/ml-ci-tutorial/matrix-completion-methods.html) -->
<p>In practical settings (e.g., marketing campaigns), it’s beneficial to incorporate unit-level and time-varying covariates:</p>
<p><span class="math display">\[
Y_{it} = L_{it} + \sum_{p=1}^{P} \sum_{q=1}^{Q} X_{ip} H_{pq} Z_{qt} + \mu_i + \lambda_t + V_{it} \beta + \epsilon_{it}
\]</span></p>
<ul>
<li><span class="math inline">\(X_{ip}\)</span>: Unit covariates (a matrix of <span class="math inline">\(p\)</span> variables for unit <span class="math inline">\(i\)</span>)</li>
<li><span class="math inline">\(Z_{qt}\)</span>: Time covariates (a matrix of <span class="math inline">\(q\)</span> variables for time <span class="math inline">\(t\)</span>)</li>
<li><span class="math inline">\(V_{it}\)</span>: Time-varying covariates</li>
<li><span class="math inline">\(H\)</span>: Interaction effects. Lasso-type <span class="math inline">\(l_1\)</span> norm (<span class="math inline">\(||H|| = \sum_{p = 1}^p \sum_{q = 1}^Q |H_{pq}|\)</span>) is used to shrink <span class="math inline">\(H \to 0\)</span>.</li>
</ul>
<p>There are several options to regularize <span class="math inline">\(L\)</span>:</p>
<table style="width:99%;">
<colgroup>
<col width="13%" />
<col width="27%" />
<col width="23%" />
<col width="35%" />
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Regularizer</strong></td>
<td><strong>Penalty</strong></td>
<td><strong>Properties</strong></td>
<td><strong>Feasibility</strong></td>
</tr>
<tr class="even">
<td><p>Frobenius Norm</p>
<p>(i.e., Ridge)</p></td>
<td><span class="math inline">\(\|\mathbf{L}\|_F^2\)</span></td>
<td>Ridge-type; shrinks towards 0</td>
<td>Not informative</td>
</tr>
<tr class="odd">
<td><p>Nuclear Norm</p>
<p>(i.e., Lasso)</p></td>
<td><span class="math inline">\(\|\mathbf{L}\|_* = \sum \sigma_r\)</span></td>
<td>Convex relaxation of rank</td>
<td>Yes (via SOFT-IMPUTE <span class="citation">(<a href="#ref-mazumder2010spectral">Mazumder, Hastie, and Tibshirani 2010</a>)</span>)</td>
</tr>
<tr class="even">
<td>Rank Constraint</td>
<td><span class="math inline">\(\text{rank}(\mathbf{L}) \le R\)</span></td>
<td>Direct low-rank control</td>
<td>No (NP-hard)</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="sec-reshaped-inverse-probability-weighting-twfe-estimator" class="section level3 hasAnchor" number="30.8.7">
<h3><span class="header-section-number">30.8.7</span> Reshaped Inverse Probability Weighting - TWFE Estimator<a href="sec-modern-estimators-for-staggered-adoption.html#sec-reshaped-inverse-probability-weighting-twfe-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>Reshaped Inverse Probability Weighting (RIPW) estimator</strong> extends the classic <strong>TWFE</strong> regression framework to account for arbitrary, time- and unit-varying treatment assignment mechanisms. This approach leverages an explicit model for treatment assignment to achieve <strong>design robustness</strong>, maintaining consistency even when traditional fixed-effects outcome models are misspecified.</p>
<p>The RIPW-TWFE framework is particularly relevant in panel data settings with <strong>general treatment patterns</strong></p>
<ul>
<li><p><strong>staggered adoption</strong></p></li>
<li><p><strong>transient treatments</strong>.</p></li>
</ul>
<hr />
<p>Setting and Notation</p>
<ul>
<li><p>Panel data with <span class="math inline">\(n\)</span> units observed over <span class="math inline">\(T\)</span> time periods.</p></li>
<li><p><strong>Potential outcomes</strong>: For each unit <span class="math inline">\(i \in \{1, \dots, n\}\)</span> and time <span class="math inline">\(t \in \{1, \dots, T\}\)</span>:</p>
<p><span class="math display">\[
Y_{it}(1), \quad Y_{it}(0)
\]</span></p></li>
<li><p><strong>Observed outcomes</strong>:</p>
<p><span class="math display">\[
Y_{it} = W_{it} Y_{it}(1) + (1 - W_{it}) Y_{it}(0)
\]</span></p></li>
<li><p><strong>Treatment assignment path</strong> for unit <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[
\mathbf{W}_i = (W_{i1}, \dots, W_{iT}) \in \{0,1\}^T
\]</span></p></li>
<li><p><strong>Generalized Propensity Score (GPS)</strong>: For unit <span class="math inline">\(i\)</span>, the probability distribution over treatment paths:</p>
<p><span class="math display">\[
\mathbf{W}_i \sim \pi_i(\cdot)
\]</span></p>
<p>where <span class="math inline">\(\pi_i(w)\)</span> is known or estimated.</p></li>
</ul>
<hr />
<p><strong>Assumptions</strong></p>
<ol style="list-style-type: decimal">
<li><p><strong>Binary Treatment</strong>: <span class="math inline">\(W_{it} \in \{0,1\}\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(t\)</span>.</p></li>
<li><p><strong>No Dynamic Effects</strong>: Current outcomes depend only on current treatment, not past treatments.</p></li>
<li><p><strong>Overlap Condition</strong> (Assumption 2.2 from <span class="citation">Arkhangelsky et al. (<a href="#ref-arkhangelsky2024design">2024</a>)</span>):</p>
<p>There exists a subset <span class="math inline">\(S^* \subseteq \{0,1\}^T\)</span>, with <span class="math inline">\(|S^*| \ge 2\)</span> and <span class="math inline">\(S^* \not\subseteq \{0_T, 1_T\}\)</span>, such that:</p>
<p><span class="math display">\[
\pi_i(w) &gt; c &gt; 0, \quad \forall w \in S^*, \forall i \in \{1, \dots, n\}
\]</span></p></li>
<li><p><strong>Maximal Correlation Decay</strong> (Assumption 2.1): Dependence between units decays at rate <span class="math inline">\(n^{-q}\)</span> for some <span class="math inline">\(q \in (0,1]\)</span>.</p></li>
<li><p><strong>Bounded Second Moments</strong> (Assumption 2.3): <span class="math inline">\(\sup_{i,t,w} \mathbb{E}[Y_{it}^2(w)] &lt; M &lt; \infty\)</span>.</p></li>
</ol>
<hr />
<p>Key Quantities of Interest</p>
<ul>
<li><p><strong>Unit-Time Specific Treatment Effect</strong>:</p>
<p><span class="math display">\[
\tau_{it} = Y_{it}(1) - Y_{it}(0)
\]</span></p></li>
<li><p><strong>Time-Specific</strong> <a href="types-of-treatment-effects.html#sec-average-treatment-effect">Average Treatment Effect</a>:</p>
<p><span class="math display">\[
\tau_t = \frac{1}{n} \sum_{i=1}^n \tau_{it}
\]</span></p></li>
<li><p><strong>Doubly Averaged Treatment Effect (DATE)</strong>:</p>
<p><span class="math display">\[
\tau(\xi) = \sum_{t=1}^T \xi_t \tau_t = \sum_{t=1}^T \xi_t \left( \frac{1}{n} \sum_{i=1}^n \tau_{it} \right)
\]</span></p>
<p>where <span class="math inline">\(\xi = (\xi_1, \dots, \xi_T)\)</span> is a vector of non-negative weights such that <span class="math inline">\(\sum_{t=1}^T \xi_t = 1\)</span>.</p></li>
<li><p><strong>Special Case</strong>: Equally weighted DATE:</p>
<p><span class="math display">\[
\tau_{\text{eq}} = \frac{1}{nT} \sum_{t=1}^T \sum_{i=1}^n \tau_{it}
\]</span></p></li>
</ul>
<hr />
<p>Inverse Probability Weighting (IPW) methods are widely used to correct for <strong>selection bias</strong> in treatment assignment by reweighting observations according to their probability of receiving a given treatment. In panel data settings with TWFE regression, the IPW approach can be incorporated to address non-random treatment assignments over time and across units.</p>
<p>We begin with the <strong>classic TWFE regression objective</strong>, then show how IPW modifies it, and finally generalize to the <strong>Reshaped IPW (RIPW)</strong> estimator.</p>
<hr />
<p>The <strong>unweighted</strong> TWFE estimator minimizes the following objective function:</p>
<p><span class="math display">\[
\min_{\tau, \mu, \{\alpha_i\}, \{\lambda_t\}} \sum_{i=1}^{n} \sum_{t=1}^{T} \left( Y_{it} - \mu - \alpha_i - \lambda_t - W_{it} \tau \right)^2
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(n\)</span>: Total number of units (e.g., individuals, firms, regions).</li>
<li><span class="math inline">\(T\)</span>: Total number of time periods.</li>
<li><span class="math inline">\(Y_{it}\)</span>: Observed outcome for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(W_{it}\)</span>: Binary treatment indicator for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.
<ul>
<li><span class="math inline">\(W_{it} = 1\)</span> if unit <span class="math inline">\(i\)</span> is treated at time <span class="math inline">\(t\)</span>; <span class="math inline">\(0\)</span> otherwise.</li>
</ul></li>
<li><span class="math inline">\(\tau\)</span>: Parameter of interest, representing the <a href="types-of-treatment-effects.html#sec-average-treatment-effect">Average Treatment Effect</a> under the TWFE model.</li>
<li><span class="math inline">\(\mu\)</span>: Common intercept, capturing the overall average outcome level across all units and times.</li>
<li><span class="math inline">\(\alpha_i\)</span>: Unit-specific fixed effects, controlling for time-invariant heterogeneity across units.</li>
<li><span class="math inline">\(\lambda_t\)</span>: Time-specific fixed effects, controlling for shocks or common trends that affect all units in time period <span class="math inline">\(t\)</span>.</li>
</ul>
<p>This standard TWFE regression assumes <a href="assumptions-3.html#prior-parallel-trends-test">parallel trends</a> across units in the absence of treatment and <strong>ignores</strong> the treatment assignment mechanism.</p>
<hr />
<p>The <strong>IPW-TWFE estimator</strong> modifies the classic TWFE regression by <strong>reweighting</strong> the contribution of each observation according to the <strong>inverse probability of the entire treatment path</strong> for unit <span class="math inline">\(i\)</span>.</p>
<p>The weighted objective function is:</p>
<p><span class="math display">\[
\min_{\tau, \mu, \{\alpha_i\}, \{\lambda_t\}} \sum_{i=1}^{n} \sum_{t=1}^{T} \left( Y_{it} - \mu - \alpha_i - \lambda_t - W_{it} \tau \right)^2 \cdot \frac{1}{\pi_i(\mathbf{W}_i)}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\pi_i(\mathbf{W}_i)\)</span>: The <strong>generalized propensity score (GPS)</strong> for unit <span class="math inline">\(i\)</span>.
<ul>
<li>This is the joint probability that unit <span class="math inline">\(i\)</span> follows the entire treatment assignment path <span class="math inline">\(\mathbf{W}_i = (W_{i1}, W_{i2}, \dots, W_{iT})\)</span>.</li>
<li>It represents the assignment mechanism, which may be known (in experimental designs) or estimated (in observational studies).</li>
</ul></li>
</ul>
<p>By weighting the squared residual for each unit-time observation by <span class="math inline">\(\frac{1}{\pi_i(\mathbf{W}_i)}\)</span>, the IPW-TWFE estimator <strong>adjusts for non-random treatment assignment</strong>, similar to the role of IPW in cross-sectional data.</p>
<hr />
<p>The <strong>Reshaped IPW (RIPW)</strong> estimator further generalizes the IPW approach by introducing a <strong>user-specified reshaped design distribution</strong>, denoted by <span class="math inline">\(\Pi\)</span>, over the space of treatment assignment paths.</p>
<p>The RIPW-TWFE estimator minimizes the following weighted objective:</p>
<p><span class="math display">\[
\hat{\tau}_{RIPW}(\Pi) = \arg \min_{\tau, \mu, \{\alpha_i\}, \{\lambda_t\}} \sum_{i=1}^{n} \sum_{t=1}^{T} \left( Y_{it} - \mu - \alpha_i - \lambda_t - W_{it} \tau \right)^2 \cdot \frac{\Pi(\mathbf{W}_i)}{\pi_i(\mathbf{W}_i)}
\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\Pi(\mathbf{W}_i)\)</span>: A <strong>user-specified reshaped distribution</strong> over the treatment assignment paths <span class="math inline">\(\mathbf{W}_i\)</span>.
<ul>
<li>It describes an alternative “design” the researcher wants to emulate, possibly reflecting hypothetical or target assignment mechanisms.</li>
</ul></li>
<li>The weight <span class="math inline">\(\frac{\Pi(\mathbf{W}_i)}{\pi_i(\mathbf{W}_i)}\)</span> can be interpreted as a likelihood ratio:
<ul>
<li>If <span class="math inline">\(\pi_i(\cdot)\)</span> is the true assignment distribution, reweighting by <span class="math inline">\(\Pi(\cdot)\)</span> effectively shifts the sampling design from <span class="math inline">\(\pi_i\)</span> to <span class="math inline">\(\Pi\)</span>.</li>
</ul></li>
<li>The ratio <span class="math inline">\(\frac{\Pi(\mathbf{W}_i)}{\pi_i(\mathbf{W}_i)}\)</span> adjusts for differences between the observed assignment mechanism and the target design.</li>
</ul>
<hr />
<p>Support of <span class="math inline">\(\mathbf{W}_i\)</span></p>
<p>The support of the treatment assignment paths is defined as:</p>
<p><span class="math display">\[
\mathbb{S} = \bigcup_{i=1}^{n} \text{Supp}(\mathbf{W}_i)
\]</span></p>
<ul>
<li><span class="math inline">\(\text{Supp}(\mathbf{W}_i)\)</span>: The support of the random variable <span class="math inline">\(\mathbf{W}_i\)</span>, i.e., the set of all treatment paths with positive probability under <span class="math inline">\(\pi_i(\cdot)\)</span>.</li>
<li><span class="math inline">\(\mathbb{S}\)</span> represents the combined support across all units <span class="math inline">\(i = 1, \dots, n\)</span>.</li>
<li><span class="math inline">\(\Pi(\cdot)\)</span> should have support contained within <span class="math inline">\(\mathbb{S}\)</span>, to ensure valid reweighting.</li>
</ul>
<hr />
<p><strong>Special Cases of the RIPW Estimator</strong></p>
<p>The choice of <span class="math inline">\(\Pi(\cdot)\)</span> determines the behavior and interpretation of the RIPW estimator. Several special cases are noteworthy:</p>
<ul>
<li><p><strong>Uniform Reshaped Design</strong>:</p>
<p><span class="math display">\[
\Pi(\cdot) \sim \text{Uniform}(\mathbb{S})
\]</span></p>
<ul>
<li><p>Here, <span class="math inline">\(\Pi\)</span> places equal probability mass on each possible treatment path in <span class="math inline">\(\mathbb{S}\)</span>.</p></li>
<li><p>The weight becomes:</p>
<p><span class="math display">\[
\frac{\Pi(\mathbf{W}_i)}{\pi_i(\mathbf{W}_i)} = \frac{1 / |\mathbb{S}|}{\pi_i(\mathbf{W}_i)}
\]</span></p></li>
<li><p>This reduces RIPW to the standard <strong>IPW-TWFE estimator</strong>, in which the target is a uniform treatment assignment design.</p></li>
</ul></li>
<li><p><strong>Reshaped Design Equals True Assignment</strong>:</p>
<p><span class="math display">\[
\Pi(\cdot) = \pi_i(\cdot)
\]</span></p>
<ul>
<li><p>The weight simplifies to:</p>
<p><span class="math display">\[
\frac{\Pi(\mathbf{W}_i)}{\pi_i(\mathbf{W}_i)} = 1
\]</span></p></li>
<li><p>The RIPW estimator reduces to the <strong>unweighted TWFE regression</strong>, consistent with an experiment where the assignment mechanism <span class="math inline">\(\pi_i\)</span> is known and correctly specified.</p></li>
</ul></li>
</ul>
<hr />
<p>To ensure that <span class="math inline">\(\hat{\tau}_{RIPW}(\Pi)\)</span> consistently estimates the DATE <span class="math inline">\(\tau(\xi)\)</span>, we solve the <strong>DATE Equation</strong>:</p>
<p><span class="math display">\[
\mathbb{E}_{\mathbf{W} \sim \Pi} \left[ \left( \text{diag}(\mathbf{W}) - \xi \mathbf{W}^\top \right) J \left( \mathbf{W} - \mathbb{E}_{\Pi}[\mathbf{W}] \right) \right] = 0
\]</span></p>
<ul>
<li><span class="math inline">\(J = I_T - \frac{1}{T} \mathbf{1}_T \mathbf{1}_T^\top\)</span> is a projection matrix removing the mean.</li>
<li>Solving this equation ensures consistency of the RIPW estimator for <span class="math inline">\(\tau(\xi)\)</span>.</li>
</ul>
<hr />
<p>Choosing the Reshaped Distribution <span class="math inline">\(\Pi\)</span></p>
<ul>
<li>If the support <span class="math inline">\(\mathbb{S}\)</span> and <span class="math inline">\(\pi_i(\cdot)\)</span> are known, <span class="math inline">\(\Pi\)</span> can be specified directly.</li>
<li>Closed-form solutions for <span class="math inline">\(\Pi\)</span> are available in settings such as staggered adoption designs.</li>
<li>When closed-form solutions are unavailable, optimization algorithms (e.g., BFGS) can be employed to solve the DATE equation numerically.</li>
</ul>
<hr />
<p><strong>Properties</strong></p>
<ul>
<li>The RIPW estimator provides design-robustness:
<ul>
<li>It can correct for misspecified outcome models by properly reweighting according to the assignment mechanism.</li>
<li>It accommodates complex treatment assignment processes, such as staggered adoption and non-random assignment.</li>
</ul></li>
<li>The flexibility to choose <span class="math inline">\(\Pi(\cdot)\)</span> allows researchers to target estimands that represent specific policy interventions or hypothetical designs.</li>
</ul>
<p>The RIPW estimator has a <strong>double robustness</strong> property:</p>
<ul>
<li><p><span class="math inline">\(\hat{\tau}_{RIPW}(\Pi)\)</span> is consistent if <strong>either</strong>:</p>
<ul>
<li><p>The assignment model <span class="math inline">\(\pi_i(\cdot)\)</span> is correctly specified <strong>or</strong></p></li>
<li><p>The outcome regression (TWFE) model is correctly specified.</p></li>
</ul></li>
</ul>
<p>This feature is particularly valuable in <a href="sec-quasi-experimental.html#sec-quasi-experimental">quasi-experimental designs</a> where the parallel trends assumption may not hold globally.</p>
<ul>
<li><strong>Design-Robustness</strong>: RIPW corrects for negative weighting issues identified in the TWFE literature (e.g., <span class="citation">Goodman-Bacon (<a href="#ref-goodman2021difference">2021</a>)</span>; <span class="citation">Clement De Chaisemartin and D’haultfœuille (<a href="#ref-de2023two">2023</a>)</span>).</li>
<li>Unlike conventional TWFE regressions, which can yield biased estimands under heterogeneity, RIPW explicitly targets user-specified weighted averages (DATE).</li>
<li>In randomized experiments, RIPW ensures the <strong>effective estimand</strong> is interpretable as a population-level average, determined by the design <span class="math inline">\(\Pi\)</span>.</li>
</ul>
<hr />
</div>
<div id="gardner2022two-and-borusyak2024revisiting" class="section level3 hasAnchor" number="30.8.8">
<h3><span class="header-section-number">30.8.8</span> <span class="citation">Gardner (<a href="#ref-gardner2022two">2022</a>)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span><a href="sec-modern-estimators-for-staggered-adoption.html#gardner2022two-and-borusyak2024revisiting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Estimate the time and unit fixed effects separately</p></li>
<li><p>Known as the imputation method <span class="citation">(<a href="#ref-borusyak2024revisiting">Borusyak, Jaravel, and Spiess 2024</a>)</span> or two-stage DiD <span class="citation">(<a href="#ref-gardner2022two">Gardner 2022</a>)</span></p></li>
</ul>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-1" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;kylebutts/did2s&quot;)</span></span>
<span id="cb810-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-2" tabindex="-1"></a><span class="fu">library</span>(did2s)</span>
<span id="cb810-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb810-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-4" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb810-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-5" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb810-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-6" tabindex="-1"></a><span class="fu">data</span>(base_stagg)</span>
<span id="cb810-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-7" tabindex="-1"></a></span>
<span id="cb810-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-8" tabindex="-1"></a></span>
<span id="cb810-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-9" tabindex="-1"></a>est <span class="ot">&lt;-</span> <span class="fu">did2s</span>(</span>
<span id="cb810-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-10" tabindex="-1"></a>    <span class="at">data =</span> base_stagg <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">treat =</span> <span class="fu">if_else</span>(time_to_treatment <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)),</span>
<span id="cb810-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-11" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb810-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-12" tabindex="-1"></a>    <span class="at">first_stage =</span> <span class="sc">~</span> x1 <span class="sc">|</span> id <span class="sc">+</span> year,</span>
<span id="cb810-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-13" tabindex="-1"></a>    <span class="at">second_stage =</span> <span class="sc">~</span> <span class="fu">i</span>(time_to_treatment, <span class="at">ref =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">1000</span>)),</span>
<span id="cb810-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-14" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="st">&quot;treat&quot;</span> ,</span>
<span id="cb810-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-15" tabindex="-1"></a>    <span class="at">cluster_var =</span> <span class="st">&quot;id&quot;</span></span>
<span id="cb810-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-16" tabindex="-1"></a>)</span>
<span id="cb810-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-17" tabindex="-1"></a></span>
<span id="cb810-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-18" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">esttable</span>(est)</span>
<span id="cb810-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-19" tabindex="-1"></a><span class="co">#&gt;                                       est</span></span>
<span id="cb810-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-20" tabindex="-1"></a><span class="co">#&gt; Dependent Var.:                         y</span></span>
<span id="cb810-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-21" tabindex="-1"></a><span class="co">#&gt;                                          </span></span>
<span id="cb810-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-22" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -9  0.3518** (0.1332)</span></span>
<span id="cb810-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-23" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -8  -0.3130* (0.1213)</span></span>
<span id="cb810-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-24" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -7    0.0894 (0.2367)</span></span>
<span id="cb810-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-25" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -6    0.0312 (0.2176)</span></span>
<span id="cb810-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-26" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -5   -0.2079 (0.1519)</span></span>
<span id="cb810-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-27" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -4   -0.1152 (0.1438)</span></span>
<span id="cb810-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-28" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -3   -0.0127 (0.1483)</span></span>
<span id="cb810-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-29" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = -2    0.1503 (0.1440)</span></span>
<span id="cb810-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-30" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 0  -5.139*** (0.3680)</span></span>
<span id="cb810-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-31" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 1  -3.480*** (0.3784)</span></span>
<span id="cb810-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-32" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 2  -2.021*** (0.3055)</span></span>
<span id="cb810-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-33" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 3   -0.6965. (0.3947)</span></span>
<span id="cb810-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-34" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 4    1.070** (0.3501)</span></span>
<span id="cb810-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-35" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 5   2.173*** (0.4456)</span></span>
<span id="cb810-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-36" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 6   4.449*** (0.3680)</span></span>
<span id="cb810-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-37" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 7   4.864*** (0.3698)</span></span>
<span id="cb810-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-38" tabindex="-1"></a><span class="co">#&gt; time_to_treatment = 8   6.187*** (0.2702)</span></span>
<span id="cb810-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-39" tabindex="-1"></a><span class="co">#&gt; ______________________ __________________</span></span>
<span id="cb810-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-40" tabindex="-1"></a><span class="co">#&gt; S.E. type                          Custom</span></span>
<span id="cb810-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-41" tabindex="-1"></a><span class="co">#&gt; Observations                          950</span></span>
<span id="cb810-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-42" tabindex="-1"></a><span class="co">#&gt; R2                                0.62486</span></span>
<span id="cb810-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-43" tabindex="-1"></a><span class="co">#&gt; Adj. R2                           0.61843</span></span>
<span id="cb810-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-44" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb810-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-45" tabindex="-1"></a><span class="co">#&gt; Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb810-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-46" tabindex="-1"></a></span>
<span id="cb810-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-47" tabindex="-1"></a>fixest<span class="sc">::</span><span class="fu">iplot</span>(</span>
<span id="cb810-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-48" tabindex="-1"></a>    est,</span>
<span id="cb810-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-49" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Event study&quot;</span>,</span>
<span id="cb810-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-50" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Time to treatment&quot;</span>,</span>
<span id="cb810-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-51" tabindex="-1"></a>    <span class="at">ref.line =</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb810-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb810-52" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-26-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb811-1" tabindex="-1"></a></span>
<span id="cb811-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb811-2" tabindex="-1"></a><span class="fu">coefplot</span>(est)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-26-2.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-1" tabindex="-1"></a>mult_est <span class="ot">&lt;-</span> did2s<span class="sc">::</span><span class="fu">event_study</span>(</span>
<span id="cb812-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-2" tabindex="-1"></a>    <span class="at">data =</span> fixest<span class="sc">::</span>base_stagg <span class="sc">|&gt;</span></span>
<span id="cb812-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-3" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_treated =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(year_treated <span class="sc">==</span> <span class="dv">10000</span>, <span class="dv">0</span>, year_treated)),</span>
<span id="cb812-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-4" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb812-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-5" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb812-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-6" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb812-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-7" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb812-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-8" tabindex="-1"></a>    <span class="at">estimator =</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb812-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-9" tabindex="-1"></a>)</span>
<span id="cb812-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-10" tabindex="-1"></a><span class="co">#&gt; Error in purrr::map(., function(y) { : ℹ In index: 1.</span></span>
<span id="cb812-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-11" tabindex="-1"></a><span class="co">#&gt; ℹ With name: y.</span></span>
<span id="cb812-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-12" tabindex="-1"></a><span class="co">#&gt; Caused by error in `.subset2()`:</span></span>
<span id="cb812-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-13" tabindex="-1"></a><span class="co">#&gt; ! no such index at level 1</span></span>
<span id="cb812-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb812-14" tabindex="-1"></a>did2s<span class="sc">::</span><span class="fu">plot_event_study</span>(mult_est)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-27-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><span class="citation">Borusyak, Jaravel, and Spiess (<a href="#ref-borusyak2024revisiting">2024</a>)</span> <code>didimputation</code></p>
<p>This version is currently not working</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-1" tabindex="-1"></a><span class="fu">library</span>(didimputation)</span>
<span id="cb813-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-2" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb813-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb813-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-4" tabindex="-1"></a></span>
<span id="cb813-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-5" tabindex="-1"></a><span class="fu">did_imputation</span>(</span>
<span id="cb813-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-6" tabindex="-1"></a>    <span class="at">data =</span> base_stagg,</span>
<span id="cb813-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-7" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb813-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-8" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb813-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-9" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb813-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-10" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span></span>
<span id="cb813-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb813-11" tabindex="-1"></a>)</span></code></pre></div>
<hr />
</div>
<div id="dynamic-treatment-effect-estimation-with-interactive-fixed-effects-and-short-panels" class="section level3 hasAnchor" number="30.8.9">
<h3><span class="header-section-number">30.8.9</span> Dynamic Treatment Effect Estimation with Interactive Fixed Effects and Short Panels<a href="sec-modern-estimators-for-staggered-adoption.html#dynamic-treatment-effect-estimation-with-interactive-fixed-effects-and-short-panels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!-- https://www.kylebutts.com/files/JMP_slides.pdf -->
<p><span class="citation">N. L. Brown and Butts (<a href="#ref-brown2025dynamic">2025</a>)</span></p>
<hr />
</div>
<div id="sec-switching-difference-in-differences-estimator-de2020two" class="section level3 hasAnchor" number="30.8.10">
<h3><span class="header-section-number">30.8.10</span> Switching Difference-in-Differences Estimator <span class="citation">(<a href="#ref-de2020two">Clément De Chaisemartin and d’Haultfoeuille 2020</a>)</span><a href="sec-modern-estimators-for-staggered-adoption.html#sec-switching-difference-in-differences-estimator-de2020two" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="sec-two-way-fixed-effects.html#sec-two-way-fixed-effects">TWFE</a> hinges on restrictive assumptions — notably, the homogeneity of treatment effects across time and groups. When this assumption is violated, TWFE can yield misleading results, including estimates with signs opposite to all underlying effects.</p>
<p>We consider a standard panel data setup with <span class="math inline">\(G\)</span> groups and <span class="math inline">\(T\)</span> time periods. Each observation belongs to a group-period cell <span class="math inline">\((g, t)\)</span>, and treatment <span class="math inline">\(D_{g,t} \in \{0,1\}\)</span> is assigned at the group-time level.</p>
<p>Let <span class="math inline">\(Y_{i,g,t}\)</span> be the outcome of individual <span class="math inline">\(i\)</span> in group <span class="math inline">\(g\)</span> at time <span class="math inline">\(t\)</span>, with potential outcomes <span class="math inline">\(Y_{i,g,t}(1)\)</span> and <span class="math inline">\(Y_{i,g,t}(0)\)</span>. Observed outcomes satisfy:</p>
<p><span class="math display">\[
Y_{i,g,t} = D_{g,t} \cdot Y_{i,g,t}(1) + (1 - D_{g,t}) \cdot Y_{i,g,t}(0)
\]</span></p>
<p>The canonical TWFE regression is:</p>
<p><span class="math display">\[
Y_{i,g,t} = \alpha_g + \lambda_t + \beta^{fe} D_{g,t} + \varepsilon_{i,g,t}
\]</span></p>
<p>where <span class="math inline">\(\alpha_g\)</span> are group fixed effects, <span class="math inline">\(\lambda_t\)</span> are time fixed effects, and <span class="math inline">\(\beta^{fe}\)</span> is interpreted as the treatment effect <strong>only under homogeneous treatment effects</strong>.</p>
<div id="heterogeneous-treatment-effects-and-weighting-bias" class="section level4 hasAnchor" number="30.8.10.1">
<h4><span class="header-section-number">30.8.10.1</span> Heterogeneous Treatment Effects and Weighting Bias<a href="sec-modern-estimators-for-staggered-adoption.html#heterogeneous-treatment-effects-and-weighting-bias" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When treatment effects vary across <span class="math inline">\((g,t)\)</span> cells, the TWFE estimator <span class="math inline">\(\hat{\beta}^{fe}\)</span> is no longer a simple average. Instead, it can be decomposed into a weighted sum of cell-specific average treatment effects:</p>
<p><span class="math display">\[
\beta^{fe} = \mathbb{E} \left[ \sum_{(g,t): D_{g,t}=1} w_{g,t} \Delta_{g,t} \right]
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\Delta_{g,t} = \mathbb{E}[Y_{g,t}(1) - Y_{g,t}(0)]\)</span> is the average treatment effect in cell <span class="math inline">\((g,t)\)</span></li>
<li><span class="math inline">\(w_{g,t}\)</span> are weights that <strong>can be negative</strong> and sum to one.</li>
</ul>
<p>Some weights are negative because <a href="sec-two-way-fixed-effects.html#sec-two-way-fixed-effects">TWFE</a> implicitly compares outcomes across all treated and untreated groups, even when “controls” are themselves treated. These comparisons can subtract out treatment effects, leading to negative weights.</p>
<hr />
</div>
<div id="illustration-negative-weights-can-flip-signs" class="section level4 hasAnchor" number="30.8.10.2">
<h4><span class="header-section-number">30.8.10.2</span> Illustration: Negative Weights Can Flip Signs<a href="sec-modern-estimators-for-staggered-adoption.html#illustration-negative-weights-can-flip-signs" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For example, suppose:</p>
<ul>
<li>Group 1 is treated only in period 3: <span class="math inline">\(\Delta_{1,3} = 1\)</span></li>
<li>Group 2 is treated in periods 2 and 3:
<ul>
<li><span class="math inline">\(\Delta_{2,2} = 1\)</span></li>
<li><span class="math inline">\(\Delta_{2,3} = 4\)</span></li>
</ul></li>
</ul>
<p>Then TWFE produces:</p>
<p><span class="math display">\[
\beta^{fe} = \frac{1}{2} \Delta_{1,3} + \Delta_{2,2} - \frac{1}{2} \Delta_{2,3} = \frac{1}{2} + 1 - 2 = -0.5
\]</span></p>
<p>All <span class="math inline">\(\Delta_{g,t}\)</span>s are positive, but the TWFE estimate is <strong>negative</strong>.</p>
<hr />
<p>To assess the extent to which TWFE may be misleading, compute the <strong>robustness ratio</strong>:</p>
<p><span class="math display">\[
\sigma^{fe}_\_ = \frac{|\hat{\beta}^{fe}|}{\hat{\sigma}(w)}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\hat{\sigma}(w)\)</span> is the standard deviation of the TWFE weights across treated cells.</li>
<li>A <strong>small</strong> <span class="math inline">\(\sigma^{fe}_\_\)</span> indicates that minor heterogeneity can reverse the sign of the estimate.</li>
</ul>
<p>This can be estimated directly from data and helps determine whether TWFE is reliable in your context.</p>
<hr />
</div>
<div id="did_m-estimator-a-robust-alternative" class="section level4 hasAnchor" number="30.8.10.3">
<h4><span class="header-section-number">30.8.10.3</span> DID_M Estimator: A Robust Alternative<a href="sec-modern-estimators-for-staggered-adoption.html#did_m-estimator-a-robust-alternative" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="citation">Clément De Chaisemartin and d’Haultfoeuille (<a href="#ref-de2020two">2020</a>)</span> propose the <strong>DID_M</strong> estimator, which is valid under heterogeneous treatment effects. It focuses only on <strong>switching groups</strong>, using non-switchers as controls in a local difference-in-differences design.</p>
<p>Let <span class="math inline">\(S\)</span> denote the set of all <span class="math inline">\((g,t)\)</span> cells where treatment status changes between <span class="math inline">\(t-1\)</span> and <span class="math inline">\(t\)</span>. The DID_M estimator is:</p>
<p><span class="math display">\[
\text{DID}_M = \sum_{t=2}^{T} \left( \frac{N_{1,0,t}}{N_S} \cdot \text{DID}^+_t + \frac{N_{0,1,t}}{N_S} \cdot \text{DID}^-_t \right)
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\text{DID}^+_t\)</span> compares joiners to stable untreated groups</li>
<li><span class="math inline">\(\text{DID}^-_t\)</span> compares leavers to stable treated groups</li>
<li><span class="math inline">\(N_S\)</span> is the total number of observations in switching cells</li>
</ul>
<p>DID_M requires:</p>
<ol style="list-style-type: decimal">
<li><strong>Common trends</strong> for both treated and untreated potential outcomes</li>
<li><strong>Existence of stable groups</strong> at every <span class="math inline">\(t\)</span> (i.e., some groups don’t change treatment status)</li>
<li><strong>No Ashenfelter dip</strong> (treatment not triggered by negative shocks)</li>
</ol>
<p>These assumptions are <strong>weaker</strong> than those required for TWFE to be unbiased.</p>
<p><span class="citation">Clément De Chaisemartin and d’Haultfoeuille (<a href="#ref-de2020two">2020</a>)</span> also propose a placebo version of DID_M using pre-treatment periods. If pre-treatment differences exist between switchers and non-switchers, this indicates violation of the parallel trends assumption. This test is analogous to pre-trend checks in event-study designs.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-1" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb814-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-2" tabindex="-1"></a><span class="fu">library</span>(fixest)            <span class="co"># For TWFE model and dataset</span></span>
<span id="cb814-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-3" tabindex="-1"></a><span class="fu">library</span>(TwoWayFEWeights)   <span class="co"># For decomposing TWFE weights</span></span>
<span id="cb814-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-4" tabindex="-1"></a><span class="fu">library</span>(DIDmultiplegt)     <span class="co"># For robust SDID estimator</span></span>
<span id="cb814-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-5" tabindex="-1"></a></span>
<span id="cb814-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-6" tabindex="-1"></a><span class="co"># Load the sample staggered adoption dataset</span></span>
<span id="cb814-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-7" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;base_stagg&quot;</span>)</span>
<span id="cb814-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-8" tabindex="-1"></a></span>
<span id="cb814-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-9" tabindex="-1"></a><span class="co"># Preview the data</span></span>
<span id="cb814-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-10" tabindex="-1"></a><span class="fu">head</span>(base_stagg)</span>
<span id="cb814-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-11" tabindex="-1"></a><span class="co">#&gt;   id year year_treated time_to_treatment treated treatment_effect_true</span></span>
<span id="cb814-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-12" tabindex="-1"></a><span class="co">#&gt; 2 90    1            2                -1       1                     0</span></span>
<span id="cb814-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-13" tabindex="-1"></a><span class="co">#&gt; 3 89    1            3                -2       1                     0</span></span>
<span id="cb814-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-14" tabindex="-1"></a><span class="co">#&gt; 4 88    1            4                -3       1                     0</span></span>
<span id="cb814-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-15" tabindex="-1"></a><span class="co">#&gt; 5 87    1            5                -4       1                     0</span></span>
<span id="cb814-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-16" tabindex="-1"></a><span class="co">#&gt; 6 86    1            6                -5       1                     0</span></span>
<span id="cb814-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-17" tabindex="-1"></a><span class="co">#&gt; 7 85    1            7                -6       1                     0</span></span>
<span id="cb814-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-18" tabindex="-1"></a><span class="co">#&gt;           x1           y</span></span>
<span id="cb814-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-19" tabindex="-1"></a><span class="co">#&gt; 2 -1.0947021  0.01722971</span></span>
<span id="cb814-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-20" tabindex="-1"></a><span class="co">#&gt; 3 -3.7100676 -4.58084528</span></span>
<span id="cb814-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-21" tabindex="-1"></a><span class="co">#&gt; 4  2.5274402  2.73817174</span></span>
<span id="cb814-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-22" tabindex="-1"></a><span class="co">#&gt; 5 -0.7204263 -0.65103066</span></span>
<span id="cb814-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-23" tabindex="-1"></a><span class="co">#&gt; 6 -3.6711678 -5.33381664</span></span>
<span id="cb814-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb814-24" tabindex="-1"></a><span class="co">#&gt; 7 -0.3152137  0.49562631</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Estimate TWFE Model</li>
</ol>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-1" tabindex="-1"></a><span class="co"># Run standard TWFE using fixest</span></span>
<span id="cb815-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-2" tabindex="-1"></a>twfe <span class="ot">&lt;-</span> <span class="fu">feols</span>(y <span class="sc">~</span> treatment <span class="sc">|</span> id <span class="sc">+</span> year,</span>
<span id="cb815-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-3" tabindex="-1"></a>                    <span class="at">data =</span> base_stagg <span class="sc">|&gt;</span></span>
<span id="cb815-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-4" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(time_to_treatment <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb815-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-5" tabindex="-1"></a><span class="fu">summary</span>(twfe)</span>
<span id="cb815-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-6" tabindex="-1"></a><span class="co">#&gt; OLS estimation, Dep. Var.: y</span></span>
<span id="cb815-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-7" tabindex="-1"></a><span class="co">#&gt; Observations: 950</span></span>
<span id="cb815-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-8" tabindex="-1"></a><span class="co">#&gt; Fixed-effects: id: 95,  year: 10</span></span>
<span id="cb815-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-9" tabindex="-1"></a><span class="co">#&gt; Standard-errors: Clustered (id) </span></span>
<span id="cb815-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-10" tabindex="-1"></a><span class="co">#&gt;           Estimate Std. Error t value   Pr(&gt;|t|)    </span></span>
<span id="cb815-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-11" tabindex="-1"></a><span class="co">#&gt; treatment -3.46761    0.47672 -7.2739 1.0326e-10 ***</span></span>
<span id="cb815-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-12" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb815-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-13" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb815-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-14" tabindex="-1"></a><span class="co">#&gt; RMSE: 2.471     Adj. R2: 0.272265</span></span>
<span id="cb815-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb815-15" tabindex="-1"></a><span class="co">#&gt;               Within R2: 0.111912</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Decompose Weights with <code>TwoWayFEWeights</code></li>
</ol>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-1" tabindex="-1"></a>twfe_weights <span class="ot">&lt;-</span> <span class="fu">twowayfeweights</span>(</span>
<span id="cb816-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-2" tabindex="-1"></a>    <span class="at">data =</span> base_stagg <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(time_to_treatment <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb816-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-3" tabindex="-1"></a>    <span class="at">Y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb816-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-4" tabindex="-1"></a>    <span class="at">G =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb816-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-5" tabindex="-1"></a>    <span class="at">T =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb816-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-6" tabindex="-1"></a>    <span class="at">D =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb816-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-7" tabindex="-1"></a>    <span class="at">summary_measures =</span> T</span>
<span id="cb816-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-8" tabindex="-1"></a>)</span>
<span id="cb816-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-9" tabindex="-1"></a></span>
<span id="cb816-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-10" tabindex="-1"></a><span class="co"># Show summary</span></span>
<span id="cb816-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-11" tabindex="-1"></a>twfe_weights</span>
<span id="cb816-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb816-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-13" tabindex="-1"></a><span class="co">#&gt; Under the common trends assumption,</span></span>
<span id="cb816-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-14" tabindex="-1"></a><span class="co">#&gt; the TWFE coefficient beta, equal to -3.4676, estimates a weighted sum of 45 ATTs.</span></span>
<span id="cb816-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-15" tabindex="-1"></a><span class="co">#&gt; 41 ATTs receive a positive weight, and 4 receive a negative weight.</span></span>
<span id="cb816-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb816-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-17" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb816-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-18" tabindex="-1"></a><span class="co">#&gt; Treat. var: treatment    ATTs    Σ weights </span></span>
<span id="cb816-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-19" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb816-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-20" tabindex="-1"></a><span class="co">#&gt; Positive weights           41       1.0238 </span></span>
<span id="cb816-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-21" tabindex="-1"></a><span class="co">#&gt; Negative weights            4      -0.0238 </span></span>
<span id="cb816-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-22" tabindex="-1"></a><span class="co">#&gt; ────────────────────────────────────────── </span></span>
<span id="cb816-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-23" tabindex="-1"></a><span class="co">#&gt; Total                      45            1 </span></span>
<span id="cb816-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-24" tabindex="-1"></a><span class="co">#&gt; ──────────────────────────────────────────</span></span>
<span id="cb816-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb816-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-26" tabindex="-1"></a><span class="co">#&gt; Summary Measures:</span></span>
<span id="cb816-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-27" tabindex="-1"></a><span class="co">#&gt;   TWFE Coefficient (β_fe): -3.4676</span></span>
<span id="cb816-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-28" tabindex="-1"></a><span class="co">#&gt;   min σ(Δ) compatible with β_fe and Δ_TR = 0: 4.8357</span></span>
<span id="cb816-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-29" tabindex="-1"></a><span class="co">#&gt;   min σ(Δ) compatible with treatment effect of opposite sign than β_fe in all (g,t) cells: 36.1549</span></span>
<span id="cb816-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-30" tabindex="-1"></a><span class="co">#&gt;   Reference: Corollary 1, de Chaisemartin, C and D&#39;Haultfoeuille, X (2020a)</span></span>
<span id="cb816-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb816-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb816-32" tabindex="-1"></a><span class="co">#&gt; The development of this package was funded by the European Union (ERC, REALLYCREDIBLE,GA N. 101043899).</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Estimate DID_M (Switching DID Estimator) with <code>DIDmultiplegt</code></li>
</ol>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-1" tabindex="-1"></a><span class="co"># Estimate robust SDID estimator (DID_M)</span></span>
<span id="cb817-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-2" tabindex="-1"></a>did_m <span class="ot">&lt;-</span> <span class="fu">did_multiplegt</span>(</span>
<span id="cb817-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-3" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;dyn&quot;</span>,</span>
<span id="cb817-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-4" tabindex="-1"></a>        <span class="at">df =</span> base_stagg <span class="sc">|&gt;</span></span>
<span id="cb817-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-5" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">treatment =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(time_to_treatment <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb817-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-6" tabindex="-1"></a>        <span class="at">outcome =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb817-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-7" tabindex="-1"></a>        <span class="at">group =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb817-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-8" tabindex="-1"></a>        <span class="at">time =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb817-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-9" tabindex="-1"></a>        <span class="at">treatment =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb817-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-10" tabindex="-1"></a>        <span class="at">effects =</span> <span class="dv">5</span>,</span>
<span id="cb817-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-11" tabindex="-1"></a>        <span class="co"># controls = c(&quot;x1&quot;),</span></span>
<span id="cb817-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-12" tabindex="-1"></a>        <span class="at">placebo =</span> <span class="dv">2</span></span>
<span id="cb817-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb817-13" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-32-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-1" tabindex="-1"></a></span>
<span id="cb818-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-2" tabindex="-1"></a><span class="fu">summary</span>(did_m)</span>
<span id="cb818-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-4" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-5" tabindex="-1"></a><span class="co">#&gt;        Estimation of treatment effects: Event-study effects</span></span>
<span id="cb818-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-6" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-7" tabindex="-1"></a><span class="co">#&gt;              Estimate SE      LB CI    UB CI    N  Switchers</span></span>
<span id="cb818-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-8" tabindex="-1"></a><span class="co">#&gt; Effect_1     -5.04943 0.03256 -5.11324 -4.98562 54 9        </span></span>
<span id="cb818-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-9" tabindex="-1"></a><span class="co">#&gt; Effect_2     -3.25734 0.06712 -3.38889 -3.12579 44 8        </span></span>
<span id="cb818-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-10" tabindex="-1"></a><span class="co">#&gt; Effect_3     -2.17826 0.08866 -2.35204 -2.00449 35 7        </span></span>
<span id="cb818-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-11" tabindex="-1"></a><span class="co">#&gt; Effect_4     -0.03749 0.12841 -0.28916 0.21418  27 6        </span></span>
<span id="cb818-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-12" tabindex="-1"></a><span class="co">#&gt; Effect_5     1.31986  0.12128 1.08216  1.55756  20 5        </span></span>
<span id="cb818-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-14" tabindex="-1"></a><span class="co">#&gt; Test of joint nullity of the effects : p-value = 0.0000</span></span>
<span id="cb818-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-15" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-16" tabindex="-1"></a><span class="co">#&gt;     Average cumulative (total) effect per treatment unit</span></span>
<span id="cb818-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-17" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-18" tabindex="-1"></a><span class="co">#&gt;  Estimate        SE     LB CI     UB CI         N Switchers </span></span>
<span id="cb818-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-19" tabindex="-1"></a><span class="co">#&gt;  -2.29649   0.07360  -2.44074  -2.15223        80        35 </span></span>
<span id="cb818-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-20" tabindex="-1"></a><span class="co">#&gt; Average number of time periods over which a treatment effect is accumulated: 2.7143</span></span>
<span id="cb818-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-22" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-23" tabindex="-1"></a><span class="co">#&gt;      Testing the parallel trends and no anticipation assumptions</span></span>
<span id="cb818-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-24" tabindex="-1"></a><span class="co">#&gt; ----------------------------------------------------------------------</span></span>
<span id="cb818-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-25" tabindex="-1"></a><span class="co">#&gt;              Estimate SE      LB CI    UB CI    N  Switchers</span></span>
<span id="cb818-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-26" tabindex="-1"></a><span class="co">#&gt; Placebo_1    0.27204  0.04917 0.17567  0.36841  44 8        </span></span>
<span id="cb818-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-27" tabindex="-1"></a><span class="co">#&gt; Placebo_2    -0.72910 0.06790 -0.86219 -0.59601 27 6        </span></span>
<span id="cb818-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-29" tabindex="-1"></a><span class="co">#&gt; Test of joint nullity of the placebos : p-value = 0.0000</span></span>
<span id="cb818-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb818-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-32" tabindex="-1"></a><span class="co">#&gt; The development of this package was funded by the European Union.</span></span>
<span id="cb818-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb818-33" tabindex="-1"></a><span class="co">#&gt; ERC REALLYCREDIBLE - GA N. 101043899</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="augmentedforward-did" class="section level3 hasAnchor" number="30.8.11">
<h3><span class="header-section-number">30.8.11</span> Augmented/Forward DID<a href="sec-modern-estimators-for-staggered-adoption.html#augmentedforward-did" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>DID Methods for Limited Pre-Treatment Periods:</li>
</ul>
<table style="width:99%;">
<colgroup>
<col width="12%" />
<col width="34%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Method</strong></th>
<th><strong>Scenario</strong></th>
<th><strong>Approach</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>Augmented DID</strong></p>
<p><span class="citation">(<a href="#ref-li2023augmented">K. T. Li and Van den Bulte 2023</a>)</span></p></td>
<td>Treatment outcome is outside the range of control units</td>
<td>Constructs the treatment counterfactual using a scaled average of control units</td>
</tr>
<tr class="even">
<td><p><strong>Forward DID</strong></p>
<p><span class="citation">(<a href="#ref-li2024frontiers">K. T. Li 2024</a>)</span></p></td>
<td>Treatment outcome is within the range of control units</td>
<td>Uses a forward selection algorithm to choose relevant control units before applying DID</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="doubly-robust-difference-in-differences-estimators" class="section level3 hasAnchor" number="30.8.12">
<h3><span class="header-section-number">30.8.12</span> Doubly Robust Difference-in-Differences Estimators<a href="sec-modern-estimators-for-staggered-adoption.html#doubly-robust-difference-in-differences-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In its simplest “canonical” form, DID compares the before-and-after outcomes of one group that eventually receives a treatment (the “treated” group) with the before-and-after outcomes of another group that never receives the treatment (the “comparison” group). Under the parallel trends assumption, DID can recover the <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">average treatment effect on the treated</a> (ATT).</p>
<p>Practitioners often enrich DID analyses by conditioning on observed covariates to mitigate violations of the unconditional parallel trends assumption. Once conditioning on covariates, the DID framework remains attractive, provided that <em>conditional</em> parallel trends hold.</p>
<p>Historically, two main approaches have emerged for DID estimation in the presence of covariates:</p>
<ol style="list-style-type: decimal">
<li><strong>Outcome Regression (OR)</strong> <span class="citation">(<a href="#ref-heckman1997matching">J. J. Heckman, Ichimura, and Todd 1997</a>)</span>. Model the outcome evolution for the comparison group (and possibly for the treated group), and then plug these fitted outcome equations into the DID formula.</li>
<li><strong>Inverse Probability Weighting (IPW)</strong> <span class="citation">(<a href="#ref-abadie2005semiparametric">Abadie 2005</a>)</span>. Model the probability of treatment conditional on covariates (the “propensity score”) and use inverse-probability reweighting to reconstruct appropriate counterfactuals for the treated group.</li>
</ol>
<p>A key insight in semiparametric causal inference is that one can <em>combine</em> these two approaches—modeling the outcome regression and the propensity score in tandem—to form an estimator that remains consistent if <em>either</em> the outcome-regression equations are correctly specified <em>or</em> the propensity-score equation is correctly specified. Such an estimator is called <strong>doubly robust</strong> <span class="citation">(<a href="#ref-sant2020doubly">Sant’Anna and Zhao 2020</a>)</span>.</p>
<p>This section covers both cases of (i) panel data (where we observe each unit in both pre- and post-treatment periods) and (ii) repeated cross-section data (where, in each period, we observe a new random sample of units).</p>
<p>Under suitable conditions, the proposed doubly robust estimators not only exhibit desirable robustness properties to misspecification but can also attain the semiparametric efficiency bound, making them <em>locally efficient</em> if all working models are correct.</p>
<hr />
<div id="notation-and-set-up" class="section level4 hasAnchor" number="30.8.12.1">
<h4><span class="header-section-number">30.8.12.1</span> Notation and set-up<a href="sec-modern-estimators-for-staggered-adoption.html#notation-and-set-up" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><strong>Two-time-period design.</strong> We consider a setting with two time periods: <span class="math inline">\(t = 0\)</span> (pre-treatment) and <span class="math inline">\(t = 1\)</span> (post-treatment). A subset of units receives the treatment only at <span class="math inline">\(t = 1\)</span>. Hence for a unit <span class="math inline">\(i\)</span>:</p>
<ul>
<li><span class="math inline">\(D_i = D_{i1} \in \{0, 1\}\)</span> is an indicator for receiving treatment by time 1 (so <span class="math inline">\(D_{i0} = 0\)</span> for all <span class="math inline">\(i\)</span>).</li>
<li><span class="math inline">\(Y_{it}\)</span> is the observed outcome at time <span class="math inline">\(t\)</span>.</li>
</ul></li>
<li><p><strong>Potential outcomes.</strong> We adopt the potential outcomes framework. Let <span class="math display">\[
   Y_{it}(1) \;=\; \text{potential outcome of unit }i \text{ at time } t \text{ if treated,}
\]</span> <span class="math display">\[
   Y_{it}(0) \;=\; \text{potential outcome of unit }i \text{ at time } t \text{ if not treated.}
\]</span> Then the observed outcome satisfies <span class="math inline">\(Y_{it} = D_i \, Y_{it}(1) + (1-D_i)\, Y_{it}(0)\)</span>.</p></li>
<li><p><strong>Covariates.</strong> A vector of observed pre-treatment covariates is denoted <span class="math inline">\(X_i\)</span>. Throughout, we assume the first component of <span class="math inline">\(X_i\)</span> is a constant (intercept).</p></li>
<li><p><strong>Data structures.</strong></p>
<ol style="list-style-type: decimal">
<li><strong>Panel data.</strong> We observe <span class="math inline">\(\{(Y_{i0}, Y_{i1}, D_i, X_i)\}_{i=1}^n\)</span>, a sample of size <span class="math inline">\(n\)</span> drawn i.i.d. from an underlying population.</li>
<li><strong>Repeated cross-sections.</strong> In period <span class="math inline">\(t\)</span>, we observe a fresh random sample of units. Let <span class="math inline">\(T_i\in \{0,1\}\)</span> be an indicator for whether an observation is drawn in the post-treatment period <span class="math inline">\((T_i=1)\)</span> or the pre-treatment period <span class="math inline">\((T_i=0)\)</span>. Write <span class="math inline">\(\{(Y_i, D_i, X_i, T_i)\}_{i=1}^n\)</span>. Here, if <span class="math inline">\(T_i=1\)</span>, then <span class="math inline">\(Y_i \equiv Y_{i1}\)</span>; if <span class="math inline">\(T_i=0\)</span>, then <span class="math inline">\(Y_i \equiv Y_{i0}\)</span>. We typically assume a stationarity condition, namely that the distribution of <span class="math inline">\((D, X)\)</span> is stable across the two periods.</li>
</ol></li>
</ul>
<p>Let <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_0\)</span> be the respective sample sizes for the post- and pre-treatment periods, so <span class="math inline">\(n_1 + n_0 = n\)</span>. Often we let <span class="math inline">\(\lambda = P(T=1)\approx n_1/n.\)</span></p>
<p>The focus is on the ATT: <span class="math display">\[
    \tau \;=\; \mathbb{E}\bigl[Y_{i1}(1) - Y_{i1}(0)\,\big|\; D_i=1\bigr].
\]</span> Because we only observe <span class="math inline">\(Y_{i1}(1)\)</span> for the treated group, the central challenge is to recover <span class="math inline">\(\mathbb{E}[Y_{i1}(0)\mid D_i=1]\)</span>. Under standard DID assumptions, we identify <span class="math inline">\(\tau\)</span> by comparing the treated group’s evolution in outcomes to the comparison group’s evolution in outcomes.</p>
<p>We require two key assumptions:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Conditional parallel trends</strong><br />
For <span class="math inline">\(t=0,1\)</span>, let <span class="math display">\[
    \mathbb{E}[\,Y_{1}(0) - Y_{0}(0)\,\mid D=1,\, X]
    \;=\;
    \mathbb{E}[\,Y_{1}(0) - Y_{0}(0)\,\mid D=0,\, X].
\]</span> This means that—conditional on <span class="math inline">\(X\)</span>—in the <em>absence</em> of treatment, the treated and comparison groups would have had <em>parallel outcome evolutions</em>.</p></li>
<li><p><strong>Overlap</strong><br />
There exists <span class="math inline">\(\varepsilon&gt;0\)</span> such that <span class="math display">\[
  P(D=1)\;&gt;\;\varepsilon,
  \quad\text{and}\quad
  P(D=1\,\vert\,X)\;\le\;1-\varepsilon
\]</span> That is, we require that a nontrivial fraction of the population is treated, and for each <span class="math inline">\(X\)</span>, there is a nontrivial probability of being in the untreated group (<span class="math inline">\(D=0\)</span>).</p></li>
</ol>
<p>Under these assumptions, we can identify <span class="math inline">\(\mathbb{E}[\,Y_{1}(0)\mid D=1]\)</span> in a semiparametric fashion, either by modeling the outcome regressions (the OR approach) or by modeling the propensity score (the IPW approach).</p>
<hr />
</div>
<div id="two-traditional-did-approaches" class="section level4 hasAnchor" number="30.8.12.2">
<h4><span class="header-section-number">30.8.12.2</span> Two Traditional DID Approaches<a href="sec-modern-estimators-for-staggered-adoption.html#two-traditional-did-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We briefly outline the classical DID estimators that rely solely on either outcome regressions or inverse probability weighting, to motivate the doubly robust idea.</p>
<div id="outcome-regression-or-approach" class="section level5 hasAnchor" number="30.8.12.2.1">
<h5><span class="header-section-number">30.8.12.2.1</span> Outcome-regression (OR) approach<a href="sec-modern-estimators-for-staggered-adoption.html#outcome-regression-or-approach" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Define <span class="math display">\[
   m_{d,t}(x) \;=\; \mathbb{E}[\,Y_t \,\mid\,D=d,\; X=x\,].
\]</span> Under the conditional parallel trends assumption, <span class="math display">\[
  \mathbb{E}[\,Y_{1}(0)\mid D=1 \,]
  \;=\;
   \mathbb{E}[\,Y_{0}(0)\mid D=1\,]
   \;+\;
   \mathbb{E}[\,m_{0,1}(X) - m_{0,0}(X)\,\big\vert\,D=1\,].
\]</span> Hence an OR-based DID estimator (for panel or repeated cross-section) typically looks like <span class="math display">\[
  \hat{\tau}^{\mathrm{reg}}
  \;=\;
  \Bigl(\overline{Y}_{1,1}\Bigr)
  \;-\;
  \Bigl(\,\overline{Y}_{1,0}
        \;+\;
        \frac{1}{n_{\mathrm{treat}}}
        \sum_{i:D_i=1}
         \bigl[\,
             \hat{m}_{0,1}(X_i) \;-\; \hat{m}_{0,0}(X_i)
         \bigr]
   \Bigr),
\]</span></p>
<p>where <span class="math inline">\(\overline{Y}_{d,t}\)</span> is the sample mean of <span class="math inline">\(Y_t\)</span> among units with <span class="math inline">\(D=d\)</span>, and <span class="math inline">\(\hat{m}_{0,t}\)</span> is some fitted model (e.g., linear or semiparametric) for <span class="math inline">\(\mathbb{E}[\,Y_t \mid D=0,\,X\,]\)</span>.</p>
<p>This OR estimator is consistent if (and only if) we have <em>correctly specified</em> the two outcome-regression functions <span class="math inline">\(m_{0,1}(x)\)</span> and <span class="math inline">\(m_{0,0}(x)\)</span>. If these regressions are misspecified, the estimator will generally be biased.</p>
</div>
<div id="ipw-approach" class="section level5 hasAnchor" number="30.8.12.2.2">
<h5><span class="header-section-number">30.8.12.2.2</span> IPW approach<a href="sec-modern-estimators-for-staggered-adoption.html#ipw-approach" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>An alternative is to model the propensity score <span class="math display">\[
   p(x)\;=\; P(D=1\mid X=x),
\]</span> and use a Horvitz–Thompson-type reweighting <span class="citation">(<a href="#ref-horvitz1952generalization">Horvitz and Thompson 1952</a>)</span> to reconstruct what “would have happened” to the treated group under no treatment. In the panel-data case, <span class="citation">Abadie (<a href="#ref-abadie2005semiparametric">2005</a>)</span> show that the ATT can be identified via <span class="math display">\[
  \tau
  \;=\;
  \frac{1}{\mathbb{E}[D]}
  \,\mathbb{E}\Bigl[\,
    \frac{D - p(X)}{1 - p(X)}
    \Bigl(Y_1 - Y_0\Bigr)
  \Bigr].
\]</span> Hence an IPW estimator for panel data is <span class="math display">\[
  \hat{\tau}^{\mathrm{ipw,p}}
  \;=\;
  \frac{1}{\overline{D}}
  \sum_{i=1}^n
    \Bigl[
       \frac{D_i - \hat{p}(X_i)}{1-\hat{p}(X_i)}
    \Bigr]
    \,\frac{1}{n}\bigl(Y_{i1} - Y_{i0}\bigr),
\]</span> where <span class="math inline">\(\hat{p}(\cdot)\)</span> is a fitted propensity score model. Similar expressions exist for repeated cross-sections, with small modifications to handle the fact that we observe <span class="math inline">\(Y_1\)</span> only if <span class="math inline">\(T=1\)</span>, etc.</p>
<p>This IPW estimator is consistent if (and only if) the propensity score is correctly specified, i.e., <span class="math inline">\(\hat{p}(x)\approx p(x)\)</span>. If the propensity-score model is incorrect, the estimator may be severely biased.</p>
<hr />
</div>
</div>
<div id="doubly-robust-did-main-identification" class="section level4 hasAnchor" number="30.8.12.3">
<h4><span class="header-section-number">30.8.12.3</span> Doubly Robust DID: Main Identification<a href="sec-modern-estimators-for-staggered-adoption.html#doubly-robust-did-main-identification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>doubly robust (DR) idea</strong> is to combine the OR and IPW approaches so that the resulting estimator is consistent if <em>either</em> the OR model is correct <em>or</em> the propensity-score model is correct. Formally, consider two generic “working” models:</p>
<ul>
<li><p><span class="math inline">\(\pi(X)\)</span> for <span class="math inline">\(p(X)\)</span>, i.e., a model for the propensity score,</p></li>
<li><p><span class="math inline">\(\mu_{0,t}(X)\)</span> for the outcome regressions <span class="math inline">\(m_{0,t}(X)=\mathbb{E}[Y_t \mid D=0,X]\)</span>.</p></li>
</ul>
<p>We define two “DR moments” for each data structure.</p>
<div id="dr-estimand-for-panel-data" class="section level5 hasAnchor" number="30.8.12.3.1">
<h5><span class="header-section-number">30.8.12.3.1</span> DR estimand for panel data<a href="sec-modern-estimators-for-staggered-adoption.html#dr-estimand-for-panel-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>When panel data are available, define <span class="math display">\[
   \Delta Y \;=\; Y_1 \,-\, Y_0,
   \quad
   \mu_{0,\Delta}(X)\;=\;\mu_{0,1}(X)\;-\;\mu_{0,0}(X).
\]</span> Then a DR moment for <span class="math inline">\(\tau\)</span> is: <span class="math display">\[
   \tau^{\mathrm{dr,p}}
   \;=\;
   \mathbb{E}\Bigl[
    \Bigl(\,w_{1}^{\mathrm{p}}(D)\,-\,w_{0}^{\mathrm{p}}(D,X;\,\pi)\Bigr)\,
    \Bigl(\,\Delta Y \;-\;\mu_{0,\Delta}(X)\Bigr)
   \Bigr],
\]</span> where <span class="math display">\[
   w_{1}^{\mathrm{p}}(D)\;=\;\frac{D}{\mathbb{E}[D]},
   \quad\quad
   w_{0}^{\mathrm{p}}(D,X;\,\pi)\;=\;\frac{\pi(X)\,(1-D)}{(1-\pi(X))\,\mathbb{E}\bigl[\tfrac{\pi(X)\,(1-D)}{1-\pi(X)}\bigr]}.
\]</span> It can be shown that <span class="math inline">\(\tau^{\mathrm{dr,p}} = \tau\)</span> provided <em>either</em> <span class="math inline">\(\pi(x)=p(x)\)</span> almost surely (a.s.) <em>or</em> <span class="math inline">\(\mu_{0,\Delta}(x)=m_{0,\Delta}(x)\)</span> a.s. (the latter meaning that at least the regression for the comparison group is correct).</p>
</div>
<div id="dr-estimands-for-repeated-cross-sections" class="section level5 hasAnchor" number="30.8.12.3.2">
<h5><span class="header-section-number">30.8.12.3.2</span> DR estimands for repeated cross-sections<a href="sec-modern-estimators-for-staggered-adoption.html#dr-estimands-for-repeated-cross-sections" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>When we only have repeated cross-sections, the DR construction must account for the fact that <span class="math inline">\(Y_0, Y_1\)</span> are not observed jointly on the same individuals. Let <span class="math inline">\(\lambda = P(T=1)\)</span>. Then two valid DR estimands are:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math display">\[
  \tau^{\mathrm{dr,rc}}_{1}
  \;=\;
  \mathbb{E}\Bigl[
   \bigl(\,w_{1}^{\mathrm{rc}}(D,T)\,-\,w_{0}^{\mathrm{rc}}(D,T,X;\,\pi)\bigr)\,
   \bigl(Y \;-\;\mu_{0,Y}(T,X)\bigr)
  \Bigr],
\]</span> where <span class="math display">\[
  w_{1}^{\mathrm{rc}}(D,T)
  \;=\;
  \frac{D\,1\{T=1\}}
       {\mathbb{E}[D\,1\{T=1\}]}
  \;-\;
  \frac{D\,1\{T=0\}}
       {\mathbb{E}[D\,1\{T=0\}]},
\]</span> and <span class="math display">\[
  w_{0}^{\mathrm{rc}}(D,T,X;\,\pi)
  \;=\;
  \frac{\pi(X)\,(1-D)\,1\{T=1\}}{(1-\pi(X))\,\mathbb{E}\bigl[\tfrac{\pi(X)\,(1-D)\,1\{T=1\}}{(1-\pi(X))}\bigr]}
  \;-\;
  \frac{\pi(X)\,(1-D)\,1\{T=0\}}{(1-\pi(X))\,\mathbb{E}\bigl[\tfrac{\pi(X)\,(1-D)\,1\{T=0\}}{(1-\pi(X))}\bigr]},
\]</span> and <span class="math inline">\(\mu_{0,Y}(T,X)=T\cdot\mu_{0,1}(X)+(1-T)\cdot\mu_{0,0}(X)\)</span>.</p></li>
<li><p><span class="math display">\[
\tau^{\mathrm{dr,rc}}_{2} \;=\; \tau^{\mathrm{dr,rc}}_{1}\;+\;\Bigl[    \mathbb{E}\bigl(\mu_{1,1}(X) - \mu_{0,1}(X)\,\big|\,D=1\bigr)    \;-\;    \mathbb{E}\bigl(\mu_{1,1}(X) - \mu_{0,1}(X)\,\big|\,D=1,\,T=1\bigr)    \Bigr]\\\;-\;\Bigl[    \mathbb{E}\bigl(\mu_{1,0}(X) - \mu_{0,0}(X)\,\big|\,D=1\bigr)    \;-\;    \mathbb{E}\bigl(\mu_{1,0}(X) - \mu_{0,0}(X)\,\big|\,D=1,\,T=0\bigr)    \Bigr]
\]</span> where <span class="math inline">\(\mu_{d,t}(x)\)</span> is a model for <span class="math inline">\(m_{d,t}(x)=\mathbb{E}[Y \mid D=d,\,T=t,\,X=x]\)</span>.</p></li>
</ol>
<p>One can show <span class="math inline">\(\tau^{\mathrm{dr,rc}}_1 = \tau^{\mathrm{dr,rc}}_2 = \tau\)</span> as long as the stationarity of <span class="math inline">\((D,X)\)</span> across time holds and <em>either</em> the propensity score model <span class="math inline">\(\pi(x)=p(x)\)</span> is correct <em>or</em> the comparison-group outcome regressions are correct <span class="citation">(<a href="#ref-sant2020doubly">Sant’Anna and Zhao 2020</a>)</span>. Notably, <span class="math inline">\(\tau^{\mathrm{dr,rc}}_2\)</span> also includes explicit modeling of the treated group’s outcomes. However, in terms of identification alone, <span class="math inline">\(\tau^{\mathrm{dr,rc}}_1\)</span> and <span class="math inline">\(\tau^{\mathrm{dr,rc}}_2\)</span> share the same double-robust property.</p>
<hr />
</div>
</div>
<div id="semiparametric-efficiency-bounds-and-local-efficiency" class="section level4 hasAnchor" number="30.8.12.4">
<h4><span class="header-section-number">30.8.12.4</span> Semiparametric Efficiency Bounds and Local Efficiency<a href="sec-modern-estimators-for-staggered-adoption.html#semiparametric-efficiency-bounds-and-local-efficiency" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An important concept in semiparametric inference is the <strong>semiparametric efficiency bound</strong>, which is the infimum of the asymptotic variance across <em>all</em> regular estimators that exploit only the imposed assumptions (parallel trends, overlap, stationarity). Equivalently, one can think of it as the variance of the “efficient influence function” (EIF).</p>
<p>We highlight key results:</p>
<ol style="list-style-type: decimal">
<li><strong>Efficient influence function for panel data</strong></li>
</ol>
<p>Under the above mentioned assumptions (i.i.d. data generating process, overlap, and conditional parallel trends) and <em>without</em> imposing further parametric constraints on <span class="math inline">\((m_{d,t},p)\)</span>, one can derive that the <strong>EIF</strong> for <span class="math inline">\(\tau\)</span> in the panel-data setting is</p>
<p><span class="math display">\[
\eta^{e,\mathrm{p}}(Y_1, Y_0, D, X) \;=\;\frac{D}{\mathbb{E}[D]}\Bigl[m_{1,\Delta}(X) - m_{0,\Delta}(X) - \tau\Bigr]\\\;+\;\frac{D}{\mathbb{E}[D]}\Bigl[\Delta Y - m_{1,\Delta}(X)\Bigr]\\\;-\;\frac{\pi(X)\,(1-D)}{(1 - \pi(X))\,\mathbb{E}\bigl[\tfrac{\pi(X)\,(1-D)}{1 - \pi(X)}\bigr]}\Bigl[\Delta Y - m_{0,\Delta}(X)\Bigr]
\]</span></p>
<p>where <span class="math inline">\(\Delta Y = Y_1 - Y_0\)</span> and <span class="math inline">\(m_{d,\Delta}(X) \equiv m_{d,1}(X) - m_{d,0}(X)\)</span>.</p>
<p>The associated <strong>semiparametric efficiency bound</strong> is <span class="math display">\[
   \mathbb{E}\bigl[\,\eta^{e,\mathrm{p}}(Y_1,Y_0,D,X)^2\bigr].
\]</span> It can be shown that a DR DID estimator can <em>attain</em> this bound if (1) the propensity score is correctly modeled, and (2) the comparison-group outcome regressions are correctly modeled.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Efficient influence function for repeated cross-sections</strong></li>
</ol>
<p>Similarly, when only repeated cross-sections are available, the EIF becomes</p>
<p><span class="math display">\[
\eta^{e,\mathrm{rc}}(Y,D,T,X) \;=\;\frac{D}{\mathbb{E}[D]}\Bigl[m_{1,\Delta}(X) - m_{0,\Delta}(X) - \tau\Bigr]\\\;+\;\Bigl[    w_{1,1}^{\mathrm{rc}}(D,T)\bigl(Y - m_{1,1}(X)\bigr)    \;-\;    w_{1,0}^{\mathrm{rc}}(D,T)\bigl(Y - m_{1,0}(X)\bigr)    \Bigr]\\\;-\;\Bigl[    w_{0,1}^{\mathrm{rc}}(D,T,X;p)\bigl(Y - m_{0,1}(X)\bigr)    \;-\;    w_{0,0}^{\mathrm{rc}}(D,T,X;p)\bigl(Y - m_{0,0}(X)\bigr)    \Bigr]
\]</span></p>
<p>with <span class="math inline">\(\,m_{d,\Delta}(X)=m_{d,1}(X)-m_{d,0}(X)\)</span>. The resulting efficiency bound is <span class="math inline">\(\mathbb{E}\bigl[\eta^{e,\mathrm{rc}}(Y,D,T,X)^2\bigr]\)</span>.</p>
<p>One can further show that having access to <em>panel</em> data can be strictly more informative (i.e., yields a <em>smaller</em> semiparametric variance bound) than repeated cross-sections. This difference can grow if the pre- and post-treatment samples are highly unbalanced.</p>
<hr />
</div>
<div id="construction-of-doubly-robust-did-estimators" class="section level4 hasAnchor" number="30.8.12.5">
<h4><span class="header-section-number">30.8.12.5</span> Construction of Doubly Robust DID Estimators<a href="sec-modern-estimators-for-staggered-adoption.html#construction-of-doubly-robust-did-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><strong>Generic two-step approach</strong></li>
</ol>
<p>Building upon the DR moment expressions, a natural approach to estimation is:</p>
<ol style="list-style-type: decimal">
<li><strong>First-stage modeling (nuisance parameters).</strong>
<ul>
<li>Estimate <span class="math inline">\(\hat{\pi}(X)\)</span> for the propensity score, e.g. via logistic regression or other parametric or semiparametric methods.</li>
<li>Estimate <span class="math inline">\(\hat{m}_{0,t}(X)\)</span> for <span class="math inline">\(t=0,1\)</span>. One might also estimate <span class="math inline">\(\hat{m}_{1,t}(X)\)</span> if using the second DR estimator for repeated cross-sections.</li>
</ul></li>
<li><strong>Plug into the DR moment.</strong><br />
Replace <span class="math inline">\(p\)</span> with <span class="math inline">\(\hat{\pi}\)</span> and <span class="math inline">\(m_{d,t}\)</span> with <span class="math inline">\(\hat{m}_{d,t}\)</span> in the chosen DR formula (panel or repeated cross-sections).</li>
</ol>
<p>Because these estimators are DR, if either the propensity score is well specified or the outcome regressions for the comparison group are well specified, consistency is assured.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Improving efficiency and inference: special parametric choices</strong></li>
</ol>
<p>It is sometimes desirable to construct DR DID estimators that are <em>also</em> “DR for inference,” meaning that the asymptotic variance does not depend on which portion of the model is correct. Achieving that typically requires carefully choosing first-stage estimators so that the extra “estimation effect” vanishes in the influence-function calculations. Concretely:</p>
<ul>
<li><strong>Propensity score:</strong> Use a logistic regression (and a special <em>inverse probability tilting</em> estimator) proposed by <span class="citation">Graham, Xavier Pinto, and Egel (<a href="#ref-graham2012inverse">2012</a>)</span>.</li>
<li><strong>Outcome regressions:</strong> Use linear regressions with specific weights (or with OLS for the treated group).</li>
</ul>
<p>One then obtains:</p>
<ul>
<li><p><strong>For panel data:</strong> <span class="math display">\[
    \hat{\tau}^{\mathrm{dr,p}}_{\mathrm{imp}}
    \;=\;
    \frac1n \sum_{i=1}^n
      \Bigl[
         w_{1}^{\mathrm{p}}(D_i) \;-\; w_{0}^{\mathrm{p}}\bigl(D_i,X_i;\,\hat{\gamma}^{\mathrm{ipt}}\bigr)
      \Bigr]
      \Bigl[
        \bigl(Y_{i1}-Y_{i0}\bigr)
        \;-\;
        \hat{\mu}^{\mathrm{lin,p}}_{0,\Delta}\bigl(X_i;\,\hat{\beta}^{\mathrm{wls,p}}_{0,\Delta}\bigr)
      \Bigr],
  \]</span> where <span class="math inline">\(\hat{\gamma}^{\mathrm{ipt}}\)</span> is the “inverse probability tilting” estimate for the logit propensity score, and <span class="math inline">\(\hat{\beta}^{\mathrm{wls,p}}_{0,\Delta}\)</span> is a weighted least squares estimate for the difference regressions of the comparison group. Under suitable regularity conditions, this estimator:</p>
<ol style="list-style-type: decimal">
<li><p>Remains consistent if either the logit model or the linear outcome model for <span class="math inline">\(\Delta Y\)</span> in the control group is correct.</p></li>
<li><p>Has an asymptotic distribution that does <em>not</em> depend on which model is correct (thus simplifying inference).</p></li>
<li><p>Achieves the semiparametric efficiency bound if both models are correct.</p></li>
</ol></li>
</ul>
<!-- -->
<ul>
<li><strong>For repeated cross-sections</strong>, one can analogously use logistic-based tilting for the propensity score and weighted/ordinary least squares for the control/treated outcome regressions. The <em>second</em> DR estimator <span class="math inline">\(\hat{\tau}^{\mathrm{dr,rc}}_{2}\)</span> that models the treated group’s outcomes as well can, under correct specification of <em>all</em> models, achieve local efficiency.</li>
</ul>
<hr />
</div>
<div id="large-sample-properties-2" class="section level4 hasAnchor" number="30.8.12.6">
<h4><span class="header-section-number">30.8.12.6</span> Large-Sample Properties<a href="sec-modern-estimators-for-staggered-adoption.html#large-sample-properties-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Assume mild regularity conditions for consistency and asymptotic normality (e.g., overlapping support, identifiability of the pseudo-true parameters for the first-step models, and suitable rates of convergence) <span class="citation">(<a href="#ref-sant2020doubly">Sant’Anna and Zhao 2020</a>)</span>.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Double Robust Consistency.</strong><br />
Each proposed DR DID estimator is consistent for <span class="math inline">\(\tau\)</span> if either (a) <span class="math inline">\(\hat{p}(X)\)</span> is consistent for <span class="math inline">\(p(X)\)</span>, or (b) the relevant outcome regressions <span class="math inline">\(\hat{m}_{0,t}(X)\)</span> are consistent for <span class="math inline">\(m_{0,t}(X)\)</span>. Thus, we say the estimator is <em>doubly robust</em> to misspecification.</p></li>
<li><p><strong>Asymptotic Normality.</strong><br />
<span class="math display">\[
    \sqrt{n}\bigl(\,\hat{\tau}^{\mathrm{dr}} \,-\, \tau \bigr)
    \;\;\xrightarrow{d}\;\;
    N\bigl(\,0,\;\mathrm{Var}(\text{IF})\bigr),
\]</span> where <span class="math inline">\(\mathrm{Var}(\text{IF})\)</span> depends on which part(s) of the nuisance models are consistently estimated. In general, one must account for the variance contribution of the first-stage estimation. But under certain special constructions (the “improved DR” approaches with inverse probability tilting and specialized weighting), the first-stage does not contribute additional variance, making inference simpler.</p></li>
<li><p><strong>Local Semiparametric Efficiency.</strong><br />
If <em>both</em> the propensity score model and the outcome-regression models are correct, the estimator’s influence function matches the <em>efficient influence function</em>, hence achieving the semiparametric efficiency bound. In repeated cross-sections, the DR estimator that also models the treated group’s outcomes (namely <span class="math inline">\(\tau^{\mathrm{dr,rc}}_2\)</span>) is the one that can achieve local efficiency.</p></li>
</ol>
<hr />
</div>
<div id="practical-implementation" class="section level4 hasAnchor" number="30.8.12.7">
<h4><span class="header-section-number">30.8.12.7</span> Practical Implementation<a href="sec-modern-estimators-for-staggered-adoption.html#practical-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In practice, the recommended workflow is:</p>
<ol style="list-style-type: decimal">
<li><strong>Specify (and estimate) a flexible working model</strong> for the propensity score. A logistic regression with the inverse-probability-tilting approach is often a good default, as it simplifies subsequent steps if one wants DR inference.</li>
<li><strong>Model the outcome of the comparison group</strong> over time. For panel data, one can directly model <span class="math inline">\(\Delta Y\)</span>. For repeated cross-sections, one typically models <span class="math inline">\(\{m_{0,t}(X)\}_{t=0,1}\)</span>.</li>
<li><strong>(Optional) Model the outcome of the treated group</strong> if seeking the local-efficiency version of DR DID in repeated cross-sections.</li>
<li><strong>Form the DR DID estimator</strong> by plugging the fitted models from steps (1)–(3) into the chosen DR moment expression.</li>
</ol>
<p><strong>Inference</strong> can often be carried out by taking the empirical variance of the estimated influence function: <span class="math display">\[
   \hat{V} \;=\; \frac{1}{n}\sum_{i=1}^n \hat{\eta}_i^2,
\]</span> where <span class="math inline">\(\hat{\eta}_i\)</span> is the evaluator’s best estimate of the influence function for observation <span class="math inline">\(i\)</span>. Under certain “improved DR” constructions, the same <span class="math inline">\(\hat{\eta}_i\)</span> works regardless of which part of the model is correct.</p>
<hr />
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;base_stagg&#39;</span>)</span>
<span id="cb819-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-2" tabindex="-1"></a></span>
<span id="cb819-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-3" tabindex="-1"></a><span class="fu">library</span>(did)</span>
<span id="cb819-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-4" tabindex="-1"></a></span>
<span id="cb819-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-5" tabindex="-1"></a>drdid_result <span class="ot">&lt;-</span> <span class="fu">att_gt</span>(</span>
<span id="cb819-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-6" tabindex="-1"></a>    <span class="at">yname =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb819-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-7" tabindex="-1"></a>    <span class="at">tname =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb819-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-8" tabindex="-1"></a>    <span class="at">idname =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb819-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-9" tabindex="-1"></a>    <span class="at">gname =</span> <span class="st">&quot;year_treated&quot;</span>,</span>
<span id="cb819-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-10" tabindex="-1"></a>    <span class="at">xformla =</span> <span class="sc">~</span> x1,</span>
<span id="cb819-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-11" tabindex="-1"></a>    <span class="at">data =</span> base_stagg</span>
<span id="cb819-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-12" tabindex="-1"></a>)</span>
<span id="cb819-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-13" tabindex="-1"></a></span>
<span id="cb819-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-14" tabindex="-1"></a></span>
<span id="cb819-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-15" tabindex="-1"></a><span class="fu">aggte</span>(drdid_result, <span class="at">type =</span> <span class="st">&quot;simple&quot;</span>)</span>
<span id="cb819-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-17" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb819-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-18" tabindex="-1"></a><span class="co">#&gt; aggte(MP = drdid_result, type = &quot;simple&quot;)</span></span>
<span id="cb819-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-20" tabindex="-1"></a><span class="co">#&gt; Reference: Callaway, Brantly and Pedro H.C. Sant&#39;Anna.  &quot;Difference-in-Differences with Multiple Time Periods.&quot; Journal of Econometrics, Vol. 225, No. 2, pp. 200-230, 2021. &lt;https://doi.org/10.1016/j.jeconom.2020.12.001&gt;, &lt;https://arxiv.org/abs/1803.09015&gt; </span></span>
<span id="cb819-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-23" tabindex="-1"></a><span class="co">#&gt;      ATT    Std. Error     [ 95%  Conf. Int.] </span></span>
<span id="cb819-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-24" tabindex="-1"></a><span class="co">#&gt;  -0.8636        0.5869     -2.014      0.2867 </span></span>
<span id="cb819-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-27" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb819-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-28" tabindex="-1"></a><span class="co">#&gt; Signif. codes: `*&#39; confidence band does not cover 0</span></span>
<span id="cb819-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb819-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-30" tabindex="-1"></a><span class="co">#&gt; Control Group:  Never Treated,  Anticipation Periods:  0</span></span>
<span id="cb819-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-31" tabindex="-1"></a><span class="co">#&gt; Estimation Method:  Doubly Robust</span></span>
<span id="cb819-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-32" tabindex="-1"></a>agg.es <span class="ot">&lt;-</span> <span class="fu">aggte</span>(drdid_result, <span class="at">type =</span> <span class="st">&quot;dynamic&quot;</span>)</span>
<span id="cb819-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-33" tabindex="-1"></a></span>
<span id="cb819-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb819-34" tabindex="-1"></a><span class="fu">ggdid</span>(agg.es)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-33-1.png" width="90%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb820-1" tabindex="-1"></a></span>
<span id="cb820-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb820-2" tabindex="-1"></a>agg.gs <span class="ot">&lt;-</span> <span class="fu">aggte</span>(drdid_result, <span class="at">type =</span> <span class="st">&quot;group&quot;</span>)</span>
<span id="cb820-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb820-3" tabindex="-1"></a></span>
<span id="cb820-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb820-4" tabindex="-1"></a><span class="fu">ggdid</span>(agg.gs)</span></code></pre></div>
<p><img src="30.2-did-other_files/figure-html/unnamed-chunk-33-2.png" width="90%" style="display: block; margin: auto;" /></p>
<hr />

</div>
</div>
<div id="nonlinear-difference-in-differences" class="section level3 hasAnchor" number="30.8.13">
<h3><span class="header-section-number">30.8.13</span> Nonlinear Difference-in-Differences<a href="sec-modern-estimators-for-staggered-adoption.html#nonlinear-difference-in-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Traditional Difference-in-Differences methods typically rely on linear models with strong assumptions like constant treatment effects and homogeneous trends across treatment groups. These assumptions often fail in real-world data — especially when outcomes are <strong>binary</strong>, <strong>fractional</strong>, or <strong>counts</strong>, such as:</p>
<ul>
<li>Employment status (binary),</li>
<li>Proportion of customers who churned (fraction),</li>
<li>Number of crimes in a neighborhood (count).</li>
</ul>
<p>In these cases, the <strong>linear parallel trends</strong> assumption may be inappropriate. This section develops an advanced, flexible framework for nonlinear DiD estimation with staggered interventions <span class="citation">(<a href="#ref-wooldridge2023simple">Wooldridge 2023</a>)</span>.</p>
<hr />
<div id="overview-of-framework" class="section level4 hasAnchor" number="30.8.13.1">
<h4><span class="header-section-number">30.8.13.1</span> Overview of Framework<a href="sec-modern-estimators-for-staggered-adoption.html#overview-of-framework" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We consider a panel dataset where units are observed over <span class="math inline">\(T\)</span> time periods. Units become treated at various times (staggered rollout), and the goal is to estimate <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">Average Treatment Effect on the Treated</a> (ATT) at different times.</p>
<p>Let <span class="math inline">\(Y_{it}(g)\)</span> denote the potential outcome at time <span class="math inline">\(t\)</span> if unit <span class="math inline">\(i\)</span> were first treated in period <span class="math inline">\(g\)</span>, with <span class="math inline">\(g = q, \ldots, T\)</span> or <span class="math inline">\(g = \infty\)</span> (never treated). Define the ATT for cohort <span class="math inline">\(g\)</span> at time <span class="math inline">\(r \geq g\)</span> as:</p>
<p><span class="math display">\[
\tau_{gr} = \mathbb{E}\left[Y_{ir}(g) - Y_{ir}(\infty) \mid D_g = 1\right]
\]</span></p>
<p>Here, <span class="math inline">\(D_g = 1\)</span> indicates that unit <span class="math inline">\(i\)</span> was first treated in period <span class="math inline">\(g\)</span>.</p>
<p>Rather than assuming linear conditional expectations of untreated outcomes, we posit a <strong>nonlinear conditional mean</strong> using a known, strictly increasing function <span class="math inline">\(G(\cdot)\)</span>:</p>
<p><span class="math display">\[
\mathbb{E}[Y_{it}(0) \mid D, X] = G\left( \alpha + \sum_{g=q}^{T} \beta_g D_g + X \kappa + \sum_{g=q}^{T} (D_g \cdot X)\eta_g + \gamma_t + X \pi_t \right)
\]</span></p>
<p>This formulation nests logistic and Poisson mean structures, and allows us to handle various limited dependent variables.</p>
<hr />
</div>
<div id="assumptions-2" class="section level4 hasAnchor" number="30.8.13.2">
<h4><span class="header-section-number">30.8.13.2</span> Assumptions<a href="sec-modern-estimators-for-staggered-adoption.html#assumptions-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We require the following identification assumptions:</p>
<ul>
<li><p><strong>Conditional No Anticipation:</strong> <span class="math display">\[
\mathbb{E}[Y_{it}(g) \mid D_g = 1, X] = \mathbb{E}[Y_{it}(\infty) \mid D_g = 1, X], \quad \forall t &lt; g
\]</span></p></li>
<li><p><strong>Conditional Index Parallel Trends:</strong> The untreated mean trends are parallel in a transformed index space: <span class="math display">\[
\mathbb{E}[Y_{it}(\infty) \mid D, X] = G(\text{linear index in } D, X, t)
\]</span></p>
<ul>
<li><span class="math inline">\(G(\cdot)\)</span> is a <strong>known</strong>, strictly increasing function (e.g., <span class="math inline">\(\exp(\cdot)\)</span> for Poisson)</li>
</ul></li>
</ul>
<p>These assumptions are weaker and more realistic than linear Parallel Trends, especially when outcomes are constrained.</p>
<hr />
</div>
<div id="estimation-2" class="section level4 hasAnchor" number="30.8.13.3">
<h4><span class="header-section-number">30.8.13.3</span> Estimation<a href="sec-modern-estimators-for-staggered-adoption.html#estimation-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Step 1: Imputation Estimator</strong></p>
<ol style="list-style-type: decimal">
<li>Estimate Parameters Using Untreated Observations Only:</li>
</ol>
<p>Use all <span class="math inline">\((i,t)\)</span> such that unit <span class="math inline">\(i\)</span> is untreated at <span class="math inline">\(t\)</span> (i.e., <span class="math inline">\(W_{it} = 0\)</span>). Fit the nonlinear regression model: <span class="math display">\[ Y_{it} = G\left(\alpha + \sum_g \beta_g D_g + X_i \kappa + D_g X_i \eta_g + \gamma_t + X_i \pi_t\right) + \varepsilon_{it} \]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Impute Counterfactual Outcomes for Treated Observations:</li>
</ol>
<p>For treated observations <span class="math inline">\((i,t)\)</span> with <span class="math inline">\(W_{it}=1\)</span>, predict <span class="math inline">\(\widehat{Y}_{it}(0)\)</span> using the model from Step 1.</p>
<ol start="3" style="list-style-type: decimal">
<li>Compute ATT for Each Cohort <span class="math inline">\(g\)</span> and Time <span class="math inline">\(r\)</span>:</li>
</ol>
<p><span class="math display">\[ \hat{\tau}_{gr} = \frac{1}{N_{gr}} \sum_{i: D_g=1} \left( Y_{ir} - \widehat{Y}_{ir}(0) \right) \]</span></p>
<hr />
<p><strong>Step 2: Pooled QMLE Estimator (Equivalent When Using Canonical Link)</strong></p>
<ol style="list-style-type: decimal">
<li>Fit Model Using All Observations:</li>
</ol>
<p>Fit the pooled nonlinear model across all units and time: <span class="math display">\[ Y_{it} = G\left(\alpha + \sum_g \beta_g D_g + X_i \kappa + D_g X_i \eta_g + \gamma_t + X_i \pi_t + \delta_r \cdot W_{it} + W_{it} X_i \xi \right) + \varepsilon_{it} \]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(W_{it} = 1\)</span> if unit <span class="math inline">\(i\)</span> is treated at time <span class="math inline">\(t\)</span></p></li>
<li><p><span class="math inline">\(W_{it} = 0\)</span> otherwise</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Estimate <span class="math inline">\(\delta_r\)</span> as the ATT for cohort <span class="math inline">\(g\)</span> in period <span class="math inline">\(r\)</span>:</li>
</ol>
<ul>
<li><span class="math inline">\(\delta_r\)</span> is interpreted as an event-time ATT</li>
<li>This estimator is consistent when <span class="math inline">\(G^{-1}(\cdot)\)</span> is the canonical link (e.g., log link for Poisson)</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Average Partial Effect (APE) for ATT:</li>
</ol>
<p><span class="math display">\[ \hat{\tau}_{gr} = \frac{1}{N_g} \sum_{i: D_g=1} \left[ G\left( X_i\beta + \delta_r + \ldots \right) - G\left( X_i\beta + \ldots \right) \right] \]</span></p>
<p><strong>Canonical Links in Practice</strong></p>
<table style="width:99%;">
<colgroup>
<col width="34%" />
<col width="16%" />
<col width="48%" />
</colgroup>
<thead>
<tr class="header">
<th>Conditional Mean</th>
<th>LEF Density</th>
<th>Suitable For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(G(z) = z\)</span></td>
<td>Normal</td>
<td>Any response</td>
</tr>
<tr class="even">
<td><span class="math inline">\(G(z) = \exp(z)\)</span></td>
<td>Poisson</td>
<td>Nonnegative/counts, no natural upper bound</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(G(z) = \text{logit}^{-1}(z)\)</span></td>
<td>Binomial</td>
<td>Nonnegative, known upper bound</td>
</tr>
<tr class="even">
<td><span class="math inline">\(G(z) = \text{logit}^{-1}(z)\)</span></td>
<td>Bernoulli</td>
<td>Binary or fractional responses</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="inference-2" class="section level4 hasAnchor" number="30.8.13.4">
<h4><span class="header-section-number">30.8.13.4</span> Inference<a href="sec-modern-estimators-for-staggered-adoption.html#inference-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Standard errors can be obtained via the delta method or bootstrap</li>
<li>Cluster-robust standard errors by unit are preferred</li>
<li>When using QMLE, the estimates are valid under correct mean specification, regardless of higher moments</li>
</ul>
<p>When Do Imputation and Pooled Methods Match?</p>
<ul>
<li>They are numerically identical when:
<ul>
<li>Estimating with the canonical link function</li>
<li>Model is correctly specified</li>
<li>Same data used for both (i.e., <code>W_it = 0</code> and pooled)</li>
</ul></li>
</ul>
<hr />
</div>
<div id="application-using-etwfe" class="section level4 hasAnchor" number="30.8.13.5">
<h4><span class="header-section-number">30.8.13.5</span> Application Using <code>etwfe</code><a href="sec-modern-estimators-for-staggered-adoption.html#application-using-etwfe" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>etwfe</code> package provides a unified, user-friendly interface for estimating staggered treatment effects using <strong>generalized linear models</strong>. It is particularly well-suited for nonlinear outcomes, such as <strong>binary</strong>, <strong>fractional</strong>, or <strong>count</strong> data.</p>
<p>We’ll now demonstrate how to apply <code>etwfe</code> to estimate <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">Average Treatment Effect on the Treated</a> (ATT) under a nonlinear DiD framework using a Poisson model. This aligns with the exponential conditional mean assumption discussed earlier.</p>
<ol style="list-style-type: decimal">
<li>Install and load packages</li>
</ol>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-1" tabindex="-1"></a><span class="co"># --- 1) Load packages ---</span></span>
<span id="cb821-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-2" tabindex="-1"></a><span class="co"># install.packages(&quot;fixest&quot;)</span></span>
<span id="cb821-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-3" tabindex="-1"></a><span class="co"># install.packages(&quot;marginaleffects&quot;)</span></span>
<span id="cb821-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-4" tabindex="-1"></a><span class="co"># install.packages(&quot;etwfe&quot;)</span></span>
<span id="cb821-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-5" tabindex="-1"></a><span class="co"># install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb821-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-6" tabindex="-1"></a><span class="co"># install.packages(&quot;modelsummary&quot;)</span></span>
<span id="cb821-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-7" tabindex="-1"></a></span>
<span id="cb821-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-8" tabindex="-1"></a><span class="fu">library</span>(etwfe)</span>
<span id="cb821-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-9" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb821-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-10" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb821-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb821-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-12" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb821-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb821-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Simulate a known data-generating process</li>
</ol>
<p>Imagine a <strong>multi-period business panel</strong> where each “unit” is a <em>regional store</em> or <em>branch</em> of a large retail chain. Half of these stores eventually receive a new <em>marketing analytics platform</em> at some known time, which in principle changes their performance metric (e.g., weekly log sales). The other half <em>never</em> receive the platform, functioning as a “never-treated” control group.</p>
<ul>
<li><p>We have <span class="math inline">\(N=200\)</span> stores (half eventually treated, half never treated).</p></li>
<li><p>Each store is observed over <span class="math inline">\(T=10\)</span> time periods (e.g., quarters or years).</p></li>
<li><p>The <em>true</em> “treatment effect on the treated” is constant at <span class="math inline">\(\delta = -0.05\)</span> for all <em>post</em>-treatment times. (Interpretation: the new marketing platform <em>reduced</em> log-sales by about 5 percent, though in real life one might expect a positive effect!)</p></li>
<li><p>Some stores are “staggered” in the sense that they adopt in different periods. We’ll randomly draw their adoption date from <span class="math inline">\(\{4,5,6\}\)</span>. Others never adopt at all.</p></li>
<li><p>We include store-level intercepts, time intercepts, and idiosyncratic noise to make it more realistic.</p></li>
</ul>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-1" tabindex="-1"></a><span class="co"># --- 2) Simulate Data ---</span></span>
<span id="cb822-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span>   <span class="co"># number of stores</span></span>
<span id="cb822-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-3" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">10</span>    <span class="co"># number of time periods</span></span>
<span id="cb822-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-4" tabindex="-1"></a>id   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">each =</span> T)</span>
<span id="cb822-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-5" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T, <span class="at">times =</span> N)</span>
<span id="cb822-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-6" tabindex="-1"></a></span>
<span id="cb822-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-7" tabindex="-1"></a><span class="co"># Mark half of them as eventually treated, half never</span></span>
<span id="cb822-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-8" tabindex="-1"></a>treated_ids <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="at">size =</span> N<span class="sc">/</span><span class="dv">2</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb822-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-9" tabindex="-1"></a>is_treated  <span class="ot">&lt;-</span> id <span class="sc">%in%</span> treated_ids</span>
<span id="cb822-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-10" tabindex="-1"></a></span>
<span id="cb822-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-11" tabindex="-1"></a><span class="co"># Among the treated, pick an adoption time 4,5, or 6 at random</span></span>
<span id="cb822-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-12" tabindex="-1"></a>adopt_time_vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">size =</span> <span class="fu">length</span>(treated_ids), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb822-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-13" tabindex="-1"></a>adopt_time     <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N) <span class="co"># 0 means &quot;never&quot;</span></span>
<span id="cb822-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-14" tabindex="-1"></a>adopt_time[treated_ids] <span class="ot">&lt;-</span> adopt_time_vec</span>
<span id="cb822-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-15" tabindex="-1"></a></span>
<span id="cb822-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-16" tabindex="-1"></a><span class="co"># Store effects, time effects, control variable, noise</span></span>
<span id="cb822-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-17" tabindex="-1"></a>alpha_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)[id]</span>
<span id="cb822-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-18" tabindex="-1"></a>gamma_t <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.2</span>)[time]</span>
<span id="cb822-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-19" tabindex="-1"></a>xvar    <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>T, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="fl">0.3</span>)</span>
<span id="cb822-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-20" tabindex="-1"></a>beta    <span class="ot">&lt;-</span> <span class="fl">0.10</span></span>
<span id="cb822-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-21" tabindex="-1"></a>noise   <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N<span class="sc">*</span>T, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb822-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-22" tabindex="-1"></a></span>
<span id="cb822-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-23" tabindex="-1"></a><span class="co"># True treatment effect = -0.05 for time &gt;= adopt_time</span></span>
<span id="cb822-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-24" tabindex="-1"></a>true_ATT <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.05</span></span>
<span id="cb822-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-25" tabindex="-1"></a>D_it     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>((adopt_time[id] <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">&amp;</span> (time <span class="sc">&gt;=</span> adopt_time[id]))</span>
<span id="cb822-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-26" tabindex="-1"></a></span>
<span id="cb822-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-27" tabindex="-1"></a><span class="co"># Final outcome in logs:</span></span>
<span id="cb822-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-28" tabindex="-1"></a>y <span class="ot">&lt;-</span> alpha_i <span class="sc">+</span> gamma_t <span class="sc">+</span> beta<span class="sc">*</span>xvar <span class="sc">+</span> true_ATT<span class="sc">*</span>D_it <span class="sc">+</span> noise</span>
<span id="cb822-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-29" tabindex="-1"></a></span>
<span id="cb822-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-30" tabindex="-1"></a><span class="co"># Put it all in a data frame</span></span>
<span id="cb822-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-31" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb822-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-32" tabindex="-1"></a>    <span class="at">id         =</span> id,</span>
<span id="cb822-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-33" tabindex="-1"></a>    <span class="at">time       =</span> time,</span>
<span id="cb822-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-34" tabindex="-1"></a>    <span class="at">adopt_time =</span> adopt_time[id],</span>
<span id="cb822-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-35" tabindex="-1"></a>    <span class="at">treat      =</span> D_it,</span>
<span id="cb822-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-36" tabindex="-1"></a>    <span class="at">xvar       =</span> xvar,</span>
<span id="cb822-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-37" tabindex="-1"></a>    <span class="at">logY       =</span> y</span>
<span id="cb822-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-38" tabindex="-1"></a>)</span>
<span id="cb822-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-39" tabindex="-1"></a></span>
<span id="cb822-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-40" tabindex="-1"></a><span class="fu">head</span>(simdat)</span>
<span id="cb822-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-41" tabindex="-1"></a><span class="co">#&gt;   id time adopt_time treat      xvar     logY</span></span>
<span id="cb822-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-42" tabindex="-1"></a><span class="co">#&gt; 1  1    1          6     0 1.4024608 1.317343</span></span>
<span id="cb822-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-43" tabindex="-1"></a><span class="co">#&gt; 2  1    2          6     0 0.5226395 2.273805</span></span>
<span id="cb822-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-44" tabindex="-1"></a><span class="co">#&gt; 3  1    3          6     0 1.3357914 1.517705</span></span>
<span id="cb822-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-45" tabindex="-1"></a><span class="co">#&gt; 4  1    4          6     0 1.2101680 1.759481</span></span>
<span id="cb822-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-46" tabindex="-1"></a><span class="co">#&gt; 5  1    5          6     0 0.9953143 1.771928</span></span>
<span id="cb822-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb822-47" tabindex="-1"></a><span class="co">#&gt; 6  1    6          6     1 0.8893066 1.439206</span></span></code></pre></div>
<p>In this business setting, you can imagine that <code>logY</code> is the natural log of revenue, sales, or another KPI, and <code>xvar</code> is a log of local population, number of competitor stores in the region, or similar.</p>
<ol start="3" style="list-style-type: decimal">
<li>Estimate with <code>etwfe</code></li>
</ol>
<p>We want to test whether the new marketing analytics platform has changed the log outcome. We will use <code>etwfe</code>:</p>
<ul>
<li><p><code>fml = logY ~ xvar</code> says that <code>logY</code> is the outcome, <code>xvar</code> is a control.</p></li>
<li><p><code>tvar = time</code> is the time variable.</p></li>
<li><p><code>gvar = adopt_time</code> is the <em>group/cohort</em> variable (the “first treatment time” or 0 if never).</p></li>
<li><p><code>vcov = ~id</code> clusters standard errors at the store level.</p></li>
<li><p><code>cgroup = "never"</code>: We specify that the never-treated units form our comparison group. This ensures we can see <em>pre-treatment</em> and <em>post-treatment</em> dynamic effects in an event-study plot.</p></li>
</ul>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-1" tabindex="-1"></a><span class="co"># --- 3) Estimate with etwfe ---</span></span>
<span id="cb823-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-2" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">etwfe</span>(</span>
<span id="cb823-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-3" tabindex="-1"></a>    <span class="at">fml    =</span> logY <span class="sc">~</span> xvar,</span>
<span id="cb823-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-4" tabindex="-1"></a>    <span class="at">tvar   =</span> time,</span>
<span id="cb823-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-5" tabindex="-1"></a>    <span class="at">gvar   =</span> adopt_time,</span>
<span id="cb823-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-6" tabindex="-1"></a>    <span class="at">data   =</span> simdat,</span>
<span id="cb823-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-7" tabindex="-1"></a>    <span class="co"># xvar   = moderator, # Heterogenous Treatment Effects</span></span>
<span id="cb823-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-8" tabindex="-1"></a>    <span class="at">vcov   =</span> <span class="sc">~</span>id,</span>
<span id="cb823-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-9" tabindex="-1"></a>    <span class="at">cgroup =</span> <span class="st">&quot;never&quot;</span>  <span class="co"># so that never-treated are the baseline</span></span>
<span id="cb823-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb823-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Nothing fancy will appear in the raw coefficient list because it’s fully “saturated” with interactions. The real prize is in the aggregated treatment effects, which we’ll obtain next.</p>
<ol start="4" style="list-style-type: decimal">
<li>Recover the <a href="types-of-treatment-effects.html#sec-average-treatment-effect-on-the-treated">ATT</a></li>
</ol>
<p>Here’s a <em>single-number</em> estimate of the overall average effect on the treated, across all times and cohorts:</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-1" tabindex="-1"></a><span class="co"># --- 4) Single-number ATT ---</span></span>
<span id="cb824-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-2" tabindex="-1"></a>ATT_est <span class="ot">&lt;-</span> <span class="fu">emfx</span>(mod, <span class="at">type =</span> <span class="st">&quot;simple&quot;</span>)</span>
<span id="cb824-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-3" tabindex="-1"></a><span class="fu">print</span>(ATT_est)</span>
<span id="cb824-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb824-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-5" tabindex="-1"></a><span class="co">#&gt;  .Dtreat Estimate Std. Error     z Pr(&gt;|z|)    S  2.5 %  97.5 %</span></span>
<span id="cb824-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-6" tabindex="-1"></a><span class="co">#&gt;     TRUE  -0.0707     0.0178 -3.97   &lt;0.001 13.8 -0.106 -0.0358</span></span>
<span id="cb824-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb824-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-8" tabindex="-1"></a><span class="co">#&gt; Term: .Dtreat</span></span>
<span id="cb824-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-9" tabindex="-1"></a><span class="co">#&gt; Type:  response </span></span>
<span id="cb824-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb824-10" tabindex="-1"></a><span class="co">#&gt; Comparison: TRUE - FALSE</span></span></code></pre></div>
<p>You should see an estimate near the <em>true</em> <span class="math inline">\(-0.05\)</span>.</p>
<ol start="5" style="list-style-type: decimal">
<li>Recover an event-study pattern of dynamic effects</li>
</ol>
<p>To check pre- and post-treatment dynamics, we ask for an <strong>event study</strong> via <code>type = "event"</code>. This shows how the outcome evolves <em>around</em> the adoption time. Negative “event” values correspond to pre-treatment, while nonnegative “event” values are post-treatment.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-1" tabindex="-1"></a><span class="co"># --- 5) Event-study estimates ---</span></span>
<span id="cb825-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-2" tabindex="-1"></a>mod_es <span class="ot">&lt;-</span> <span class="fu">emfx</span>(mod, <span class="at">type =</span> <span class="st">&quot;event&quot;</span>)</span>
<span id="cb825-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-3" tabindex="-1"></a>mod_es</span>
<span id="cb825-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb825-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-5" tabindex="-1"></a><span class="co">#&gt;  event Estimate Std. Error      z Pr(&gt;|z|)    S   2.5 %   97.5 %</span></span>
<span id="cb825-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-6" tabindex="-1"></a><span class="co">#&gt;     -5 -0.04132     0.0467 -0.885  0.37628  1.4 -0.1329  0.05022</span></span>
<span id="cb825-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-7" tabindex="-1"></a><span class="co">#&gt;     -4 -0.01120     0.0282 -0.396  0.69180  0.5 -0.0666  0.04416</span></span>
<span id="cb825-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-8" tabindex="-1"></a><span class="co">#&gt;     -3  0.01747     0.0226  0.772  0.43999  1.2 -0.0269  0.06180</span></span>
<span id="cb825-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-9" tabindex="-1"></a><span class="co">#&gt;     -2 -0.00912     0.0193 -0.472  0.63686  0.7 -0.0470  0.02873</span></span>
<span id="cb825-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-10" tabindex="-1"></a><span class="co">#&gt;     -1  0.00000         NA     NA       NA   NA      NA       NA</span></span>
<span id="cb825-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-11" tabindex="-1"></a><span class="co">#&gt;      0 -0.08223     0.0206 -3.995  &lt; 0.001 13.9 -0.1226 -0.04188</span></span>
<span id="cb825-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-12" tabindex="-1"></a><span class="co">#&gt;      1 -0.06108     0.0209 -2.926  0.00344  8.2 -0.1020 -0.02016</span></span>
<span id="cb825-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-13" tabindex="-1"></a><span class="co">#&gt;      2 -0.07094     0.0225 -3.159  0.00158  9.3 -0.1150 -0.02692</span></span>
<span id="cb825-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-14" tabindex="-1"></a><span class="co">#&gt;      3 -0.07383     0.0189 -3.906  &lt; 0.001 13.4 -0.1109 -0.03679</span></span>
<span id="cb825-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-15" tabindex="-1"></a><span class="co">#&gt;      4 -0.07330     0.0334 -2.196  0.02808  5.2 -0.1387 -0.00788</span></span>
<span id="cb825-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-16" tabindex="-1"></a><span class="co">#&gt;      5 -0.06527     0.0285 -2.294  0.02178  5.5 -0.1210 -0.00951</span></span>
<span id="cb825-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-17" tabindex="-1"></a><span class="co">#&gt;      6 -0.05661     0.0402 -1.407  0.15953  2.6 -0.1355  0.02227</span></span>
<span id="cb825-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb825-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-19" tabindex="-1"></a><span class="co">#&gt; Term: .Dtreat</span></span>
<span id="cb825-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-20" tabindex="-1"></a><span class="co">#&gt; Type:  response </span></span>
<span id="cb825-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-21" tabindex="-1"></a><span class="co">#&gt; Comparison: TRUE - FALSE</span></span>
<span id="cb825-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-22" tabindex="-1"></a></span>
<span id="cb825-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-23" tabindex="-1"></a></span>
<span id="cb825-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-24" tabindex="-1"></a><span class="co"># Renaming function to replace &quot;.Dtreat&quot; with something more meaningful</span></span>
<span id="cb825-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-25" tabindex="-1"></a>rename_fn <span class="ot">=</span> <span class="cf">function</span>(old_names) {</span>
<span id="cb825-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-26" tabindex="-1"></a>  new_names <span class="ot">=</span> <span class="fu">gsub</span>(<span class="st">&quot;.Dtreat&quot;</span>, <span class="st">&quot;Period post treatment =&quot;</span>, old_names)</span>
<span id="cb825-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-27" tabindex="-1"></a>  <span class="fu">setNames</span>(new_names, old_names)</span>
<span id="cb825-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-28" tabindex="-1"></a>}</span>
<span id="cb825-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-29" tabindex="-1"></a></span>
<span id="cb825-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-30" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb825-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-31" tabindex="-1"></a>  <span class="fu">list</span>(mod_es),</span>
<span id="cb825-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-32" tabindex="-1"></a>  <span class="at">shape       =</span> term<span class="sc">:</span>event<span class="sc">:</span>statistic <span class="sc">~</span> model,</span>
<span id="cb825-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-33" tabindex="-1"></a>  <span class="at">coef_rename =</span> rename_fn,</span>
<span id="cb825-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-34" tabindex="-1"></a>  <span class="at">gof_omit    =</span> <span class="st">&quot;Adj|Within|IC|RMSE&quot;</span>,</span>
<span id="cb825-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-35" tabindex="-1"></a>  <span class="at">stars       =</span> <span class="cn">TRUE</span>,</span>
<span id="cb825-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-36" tabindex="-1"></a>  <span class="at">title       =</span> <span class="st">&quot;Event study&quot;</span>,</span>
<span id="cb825-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-37" tabindex="-1"></a>  <span class="at">notes       =</span> <span class="st">&quot;Std. errors are clustered at the id level&quot;</span></span>
<span id="cb825-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb825-38" tabindex="-1"></a>)</span></code></pre></div>
<!-- preamble start -->

    <script>

      function styleCell_80043twey8ariertttmj(i, j, css_id) {
          var table = document.getElementById("tinytable_80043twey8ariertttmj");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_80043twey8ariertttmj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_80043twey8ariertttmj(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_80043twey8ariertttmj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 27, j: 1 },  ], css_id: 'tinytable_css_5t12qi7qz3m3xx62317t',}, 
          { positions: [ { i: 23, j: 1 },  ], css_id: 'tinytable_css_1x9wsbu4y5x2j8n1qvnk',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 10, j: 1 }, { i: 11, j: 1 }, { i: 12, j: 1 }, { i: 13, j: 1 }, { i: 14, j: 1 }, { i: 15, j: 1 }, { i: 16, j: 1 }, { i: 17, j: 1 }, { i: 18, j: 1 }, { i: 19, j: 1 }, { i: 20, j: 1 }, { i: 21, j: 1 }, { i: 22, j: 1 }, { i: 24, j: 1 }, { i: 25, j: 1 }, { i: 26, j: 1 },  ], css_id: 'tinytable_css_x2fc96xpgrl9xynrqt4y',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_q19o1lv0k43caqv9jrwy',}, 
          { positions: [ { i: 27, j: 0 },  ], css_id: 'tinytable_css_d7l1huj5c06j9l4pcs82',}, 
          { positions: [ { i: 23, j: 0 },  ], css_id: 'tinytable_css_si9yxwen8zi5ryfpy76w',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 }, { i: 12, j: 0 }, { i: 13, j: 0 }, { i: 14, j: 0 }, { i: 15, j: 0 }, { i: 16, j: 0 }, { i: 17, j: 0 }, { i: 18, j: 0 }, { i: 19, j: 0 }, { i: 20, j: 0 }, { i: 21, j: 0 }, { i: 22, j: 0 }, { i: 24, j: 0 }, { i: 25, j: 0 }, { i: 26, j: 0 },  ], css_id: 'tinytable_css_q7jtsqc1o5qi594xmgz8',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_n6i215vp9gl7hmx3w4w3',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_80043twey8ariertttmj(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_5t12qi7qz3m3xx62317t, .table th.tinytable_css_5t12qi7qz3m3xx62317t { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_1x9wsbu4y5x2j8n1qvnk, .table th.tinytable_css_1x9wsbu4y5x2j8n1qvnk { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_x2fc96xpgrl9xynrqt4y, .table th.tinytable_css_x2fc96xpgrl9xynrqt4y { text-align: center; }
      .table td.tinytable_css_q19o1lv0k43caqv9jrwy, .table th.tinytable_css_q19o1lv0k43caqv9jrwy { text-align: center; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_d7l1huj5c06j9l4pcs82, .table th.tinytable_css_d7l1huj5c06j9l4pcs82 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_si9yxwen8zi5ryfpy76w, .table th.tinytable_css_si9yxwen8zi5ryfpy76w { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_q7jtsqc1o5qi594xmgz8, .table th.tinytable_css_q7jtsqc1o5qi594xmgz8 { text-align: left; }
      .table td.tinytable_css_n6i215vp9gl7hmx3w4w3, .table th.tinytable_css_n6i215vp9gl7hmx3w4w3 { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_80043twey8ariertttmj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing='true'>
        <thead>
        <caption>Event study</caption>
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan='2'>+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001</td></tr>
<tr><td colspan='2'>Std. errors are clustered at the id level</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>Period post treatment = -5</td>
                  <td>-0.041</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.047)</td>
                </tr>
                <tr>
                  <td>Period post treatment = -4</td>
                  <td>-0.011</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.028)</td>
                </tr>
                <tr>
                  <td>Period post treatment = -3</td>
                  <td>0.017</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.023)</td>
                </tr>
                <tr>
                  <td>Period post treatment = -2</td>
                  <td>-0.009</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.019)</td>
                </tr>
                <tr>
                  <td>Period post treatment = -1</td>
                  <td>0.000</td>
                </tr>
                <tr>
                  <td>Period post treatment = 0</td>
                  <td>-0.082***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.021)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 1</td>
                  <td>-0.061**</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.021)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 2</td>
                  <td>-0.071**</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.022)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 3</td>
                  <td>-0.074***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.019)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 4</td>
                  <td>-0.073*</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.033)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 5</td>
                  <td>-0.065*</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.028)</td>
                </tr>
                <tr>
                  <td>Period post treatment = 6</td>
                  <td>-0.057</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(0.040)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>2000</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.235</td>
                </tr>
                <tr>
                  <td>FE..adopt_time</td>
                  <td>X</td>
                </tr>
                <tr>
                  <td>FE..time</td>
                  <td>X</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
<ul>
<li><p>By default, this will return events from (roughly) the earliest pre-treatment period up to the maximum possible post-treatment period in your data, using <em>never-treated</em> as the comparison group.</p></li>
<li><p>Inspect the estimates and confidence intervals. Ideally, pre-treatment estimates should be near 0, and post-treatment estimates near <span class="math inline">\(-0.05\)</span>.</p></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>Plot the estimated event-study vs. the true effect</li>
</ol>
<p>In a business or marketing study, a useful final step is a chart showing the point estimates (with confidence bands) plus the known <em>true</em> effect as a reference.</p>
<p>Construct the “true” dynamic effect curve</p>
<ul>
<li><p>Pre-treatment periods: effect = 0</p></li>
<li><p>Post-treatment periods: effect = <span class="math inline">\(\delta=-0.05\)</span></p></li>
</ul>
<p>Below we will:</p>
<ol style="list-style-type: decimal">
<li><p>Extract the estimated event effects from <code>mod_es</code>.</p></li>
<li><p>Build a <strong>reference</strong> dataset with the same event times.</p></li>
<li><p>Plot both on the same figure.</p></li>
</ol>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-1" tabindex="-1"></a><span class="co"># --- 6) Plot results vs. known effect ---</span></span>
<span id="cb826-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-2" tabindex="-1"></a>est_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod_es)</span>
<span id="cb826-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-3" tabindex="-1"></a></span>
<span id="cb826-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-4" tabindex="-1"></a>range_of_event <span class="ot">&lt;-</span> <span class="fu">range</span>(est_df<span class="sc">$</span>event)</span>
<span id="cb826-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-5" tabindex="-1"></a>event_breaks   <span class="ot">&lt;-</span> <span class="fu">seq</span>(range_of_event[<span class="dv">1</span>], range_of_event[<span class="dv">2</span>], <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb826-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-6" tabindex="-1"></a>true_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(e) <span class="fu">ifelse</span>(e <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.05</span>)</span>
<span id="cb826-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-7" tabindex="-1"></a>event_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(range_of_event[<span class="dv">1</span>], range_of_event[<span class="dv">2</span>], <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb826-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-8" tabindex="-1"></a>true_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb826-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-9" tabindex="-1"></a>    <span class="at">event       =</span> event_grid,</span>
<span id="cb826-10"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-10" tabindex="-1"></a>    <span class="at">true_effect =</span> <span class="fu">sapply</span>(event_grid, true_fun)</span>
<span id="cb826-11"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-11" tabindex="-1"></a>)</span>
<span id="cb826-12"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-12" tabindex="-1"></a></span>
<span id="cb826-13"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-13" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb826-14"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-14" tabindex="-1"></a>    <span class="co"># Confidence interval ribbon (put it first so it&#39;s behind everything)</span></span>
<span id="cb826-15"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-15" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(</span>
<span id="cb826-16"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-16" tabindex="-1"></a>        <span class="at">data =</span> est_df,</span>
<span id="cb826-17"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-17" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> event, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high),</span>
<span id="cb826-18"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-18" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;grey60&quot;</span>,   <span class="co"># light gray fill</span></span>
<span id="cb826-19"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-19" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.3</span></span>
<span id="cb826-20"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-20" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb826-21"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-21" tabindex="-1"></a>    <span class="co"># Estimated effect line</span></span>
<span id="cb826-22"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-22" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb826-23"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-23" tabindex="-1"></a>        <span class="at">data =</span> est_df,</span>
<span id="cb826-24"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-24" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> event, <span class="at">y =</span> estimate),</span>
<span id="cb826-25"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-25" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb826-26"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-26" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb826-27"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-27" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb826-28"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-28" tabindex="-1"></a>    <span class="co"># Estimated effect points</span></span>
<span id="cb826-29"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-29" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb826-30"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-30" tabindex="-1"></a>        <span class="at">data =</span> est_df,</span>
<span id="cb826-31"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-31" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> event, <span class="at">y =</span> estimate),</span>
<span id="cb826-32"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-32" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb826-33"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-33" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb826-34"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-34" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb826-35"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-35" tabindex="-1"></a>    <span class="co"># Known true effect (dashed red line)</span></span>
<span id="cb826-36"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-36" tabindex="-1"></a>    <span class="fu">geom_line</span>(</span>
<span id="cb826-37"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-37" tabindex="-1"></a>        <span class="at">data =</span> true_df,</span>
<span id="cb826-38"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-38" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> event, <span class="at">y =</span> true_effect),</span>
<span id="cb826-39"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-39" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb826-40"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-40" tabindex="-1"></a>        <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb826-41"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-41" tabindex="-1"></a>        <span class="at">linewidth =</span> <span class="dv">1</span></span>
<span id="cb826-42"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-42" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb826-43"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-43" tabindex="-1"></a>    <span class="co"># Horizontal zero line</span></span>
<span id="cb826-44"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-44" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb826-45"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-45" tabindex="-1"></a>    <span class="co"># Vertical line at event = 0 for clarity</span></span>
<span id="cb826-46"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-46" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;gray40&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb826-47"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-47" tabindex="-1"></a>    <span class="co"># Make sure x-axis breaks are integers</span></span>
<span id="cb826-48"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-48" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> event_breaks) <span class="sc">+</span></span>
<span id="cb826-49"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-49" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb826-50"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-50" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Event-Study Plot vs. Known True Effect&quot;</span>,</span>
<span id="cb826-51"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-51" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">&quot;Business simulation with new marketing platform adoption&quot;</span>,</span>
<span id="cb826-52"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-52" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Event time (periods relative to adoption)&quot;</span>,</span>
<span id="cb826-53"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-53" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Effect on log-outcome (ATT)&quot;</span>,</span>
<span id="cb826-54"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-54" tabindex="-1"></a>        <span class="at">caption =</span> <span class="st">&quot;Dashed red line = known true effect; Shaded area = 95% CI&quot;</span></span>
<span id="cb826-55"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-55" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb826-56"><a href="sec-modern-estimators-for-staggered-adoption.html#cb826-56" tabindex="-1"></a>    causalverse<span class="sc">::</span><span class="fu">ama_theme</span>()</span></code></pre></div>
<p><img src="30.4-nolinear-did_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ul>
<li><p><strong>Solid line</strong> and shaded region: the ETWFE <em>point estimates</em> and their 95% confidence intervals, for each event time relative to adoption.</p></li>
<li><p><strong>Dashed red line</strong>: the <em>true</em> effect that we built into the DGP.</p></li>
</ul>
<p>If the estimation works well (and your sample is big enough), the estimated event-study effects should hover near the dashed red line <em>post</em>-treatment, and near zero <em>pre</em>-treatment.</p>
<p>Alternatively, we could also the <code>plot</code> function to produce a quick plot.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-1" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb827-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-2" tabindex="-1"></a>    mod_es,</span>
<span id="cb827-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-3" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;ribbon&quot;</span>,</span>
<span id="cb827-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-4" tabindex="-1"></a>    <span class="co"># col  = &quot;&quot;,# color</span></span>
<span id="cb827-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-5" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb827-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-6" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb827-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-7" tabindex="-1"></a>    <span class="at">sub  =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb827-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-8" tabindex="-1"></a>    <span class="co"># file = &quot;event-study.png&quot;, width = 8, height = 5. # save file</span></span>
<span id="cb827-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb827-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="30.4-nolinear-did_files/figure-html/unnamed-chunk-7-1.png" width="90%" style="display: block; margin: auto;" /></p>
<ol start="7" style="list-style-type: decimal">
<li>Double-check in a regression table (optional)</li>
</ol>
<p>If you like to see a clean numeric summary of the <em>dynamic</em> estimates by period, you can pipe your event-study object into <code>modelsummary</code>:</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-1" tabindex="-1"></a><span class="co"># --- 7) Optional table for dynamic estimates ---</span></span>
<span id="cb828-2"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-2" tabindex="-1"></a><span class="fu">modelsummary</span>(</span>
<span id="cb828-3"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-3" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">&quot;Event-Study&quot;</span> <span class="ot">=</span> mod_es),</span>
<span id="cb828-4"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-4" tabindex="-1"></a>    <span class="at">shape     =</span> term <span class="sc">+</span> statistic <span class="sc">~</span> model <span class="sc">+</span> event,</span>
<span id="cb828-5"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-5" tabindex="-1"></a>    <span class="at">gof_map   =</span> <span class="cn">NA</span>,</span>
<span id="cb828-6"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-6" tabindex="-1"></a>    <span class="at">coef_map  =</span> <span class="fu">c</span>(<span class="st">&quot;.Dtreat&quot;</span> <span class="ot">=</span> <span class="st">&quot;ATT&quot;</span>),</span>
<span id="cb828-7"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-7" tabindex="-1"></a>    <span class="at">title     =</span> <span class="st">&quot;ETWFE Event-Study by Relative Adoption Period&quot;</span>,</span>
<span id="cb828-8"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-8" tabindex="-1"></a>    <span class="at">notes     =</span> <span class="st">&quot;Std. errors are clustered by store ID&quot;</span></span>
<span id="cb828-9"><a href="sec-modern-estimators-for-staggered-adoption.html#cb828-9" tabindex="-1"></a>)</span></code></pre></div>
<hr />

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abadie2005semiparametric" class="csl-entry">
Abadie, Alberto. 2005. <span>“Semiparametric Difference-in-Differences Estimators.”</span> <em>The Review of Economic Studies</em> 72 (1): 1–19.
</div>
<div id="ref-abadie2010synthetic" class="csl-entry">
Abadie, Alberto, Alexis Diamond, and Jens Hainmueller. 2010. <span>“Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco Control Program.”</span> <em>Journal of the American Statistical Association</em> 105 (490): 493–505.
</div>
<div id="ref-acemoglu2019democracy" class="csl-entry">
Acemoglu, Daron, Suresh Naidu, Pascual Restrepo, and James A Robinson. 2019. <span>“Democracy Does Cause Growth.”</span> <em>Journal of Political Economy</em> 127 (1): 47–100.
</div>
<div id="ref-arkhangelsky2024design" class="csl-entry">
Arkhangelsky, Dmitry, Guido W Imbens, Lihua Lei, and Xiaoman Luo. 2024. <span>“Design-Robust Two-Way-Fixed-Effects Regression for Panel Data.”</span> <em>Quantitative Economics</em> 15 (4): 999–1034.
</div>
<div id="ref-athey2021matrix" class="csl-entry">
Athey, Susan, Mohsen Bayati, Nikolay Doudchenko, Guido Imbens, and Khashayar Khosravi. 2021. <span>“Matrix Completion Methods for Causal Panel Data Models.”</span> <em>Journal of the American Statistical Association</em> 116 (536): 1716–30.
</div>
<div id="ref-athey2006identification" class="csl-entry">
Athey, Susan, and Guido W Imbens. 2006. <span>“Identification and Inference in Nonlinear Difference-in-Differences Models.”</span> <em>Econometrica</em> 74 (2): 431–97.
</div>
<div id="ref-athey2022design" class="csl-entry">
———. 2022. <span>“Design-Based Analysis in Difference-in-Differences Settings with Staggered Adoption.”</span> <em>Journal of Econometrics</em> 226 (1): 62–79.
</div>
<div id="ref-bai2002determining" class="csl-entry">
Bai, Jushan, and Serena Ng. 2002. <span>“Determining the Number of Factors in Approximate Factor Models.”</span> <em>Econometrica</em> 70 (1): 191–221. https://doi.org/<a href="https://doi.org/10.1111/1468-0262.00273">https://doi.org/10.1111/1468-0262.00273</a>.
</div>
<div id="ref-borusyak2021revisiting" class="csl-entry">
Borusyak, Kirill, Xavier Jaravel, and Jann Spiess. 2021. <span>“Revisiting Event Study Designs: Robust and Efficient Estimation.”</span> <em>arXiv Preprint arXiv:2108.12419</em>.
</div>
<div id="ref-borusyak2024revisiting" class="csl-entry">
———. 2024. <span>“Revisiting Event-Study Designs: Robust and Efficient Estimation.”</span> <em>Review of Economic Studies</em> 91 (6): 3253–85.
</div>
<div id="ref-bronnenberg2020consumer" class="csl-entry">
Bronnenberg, Bart J, Jean-Pierre Dubé, and Robert E Sanders. 2020. <span>“Consumer Misinformation and the Brand Premium: A Private Label Blind Taste Test.”</span> <em>Marketing Science</em> 39 (2): 382–406.
</div>
<div id="ref-brown2025dynamic" class="csl-entry">
Brown, Nicholas L., and Kyle Butts. 2025. <span>“Dynamic Treatment Effect Estimation with Interactive Fixed Effects and Short Panels.”</span> <em>Journal of Econometrics</em> 250: 106013. <a href="https://doi.org/10.1016/j.jeconom.2025.106013">https://doi.org/10.1016/j.jeconom.2025.106013</a>.
</div>
<div id="ref-brown2023simple" class="csl-entry">
Brown, Nicholas, Kyle Butts, and Joakim Westerlund. 2023. <span>“Simple Difference-in-Differences Estimation in Fixed-t Panels.”</span> <em>arXiv Preprint arXiv:2301.11358</em>.
</div>
<div id="ref-callaway2021difference" class="csl-entry">
Callaway, Brantly, and Pedro HC Sant’Anna. 2021. <span>“Difference-in-Differences with Multiple Time Periods.”</span> <em>Journal of Econometrics</em> 225 (2): 200–230.
</div>
<div id="ref-cengiz2019effect" class="csl-entry">
Cengiz, Doruk, Arindrajit Dube, Attila Lindner, and Ben Zipperer. 2019. <span>“The Effect of Minimum Wages on Low-Wage Jobs.”</span> <em>The Quarterly Journal of Economics</em> 134 (3): 1405–54.
</div>
<div id="ref-de2023two" class="csl-entry">
De Chaisemartin, Clement, and Xavier D’haultfœuille. 2023. <span>“Two-Way Fixed Effects and Differences-in-Differences Estimators with Several Treatments.”</span> <em>Journal of Econometrics</em> 236 (2): 105480.
</div>
<div id="ref-de2020two" class="csl-entry">
De Chaisemartin, Clément, and Xavier d’Haultfoeuille. 2020. <span>“Two-Way Fixed Effects Estimators with Heterogeneous Treatment Effects.”</span> <em>American Economic Review</em> 110 (9): 2964–96.
</div>
<div id="ref-deshpande2019screened" class="csl-entry">
Deshpande, Manasi, and Yue Li. 2019. <span>“Who Is Screened Out? Application Costs and the Targeting of Disability Programs.”</span> <em>American Economic Journal: Economic Policy</em> 11 (4): 213–48.
</div>
<div id="ref-gardner2022two" class="csl-entry">
Gardner, John. 2022. <span>“Two-Stage Differences in Differences.”</span> <em>arXiv Preprint arXiv:2207.05943</em>.
</div>
<div id="ref-gibbons2018broken" class="csl-entry">
Gibbons, Charles E, Juan Carlos Suárez Serrato, and Michael B Urbancic. 2018. <span>“Broken or Fixed Effects?”</span> <em>Journal of Econometric Methods</em> 8 (1): 20170002.
</div>
<div id="ref-goodman2021difference" class="csl-entry">
Goodman-Bacon, Andrew. 2021. <span>“Difference-in-Differences with Variation in Treatment Timing.”</span> <em>Journal of Econometrics</em> 225 (2): 254–77.
</div>
<div id="ref-graham2012inverse" class="csl-entry">
Graham, Bryan S, Cristine Campos de Xavier Pinto, and Daniel Egel. 2012. <span>“Inverse Probability Tilting for Moment Condition Models with Missing Data.”</span> <em>The Review of Economic Studies</em> 79 (3): 1053–79.
</div>
<div id="ref-heckman1997matching" class="csl-entry">
Heckman, James J, Hidehiko Ichimura, and Petra E Todd. 1997. <span>“Matching as an Econometric Evaluation Estimator: Evidence from Evaluating a Job Training Programme.”</span> <em>The Review of Economic Studies</em> 64 (4): 605–54.
</div>
<div id="ref-ho2007matching" class="csl-entry">
Ho, Daniel E, Kosuke Imai, Gary King, and Elizabeth A Stuart. 2007. <span>“Matching as Nonparametric Preprocessing for Reducing Model Dependence in Parametric Causal Inference.”</span> <em>Political Analysis</em> 15 (3): 199–236.
</div>
<div id="ref-horvitz1952generalization" class="csl-entry">
Horvitz, Daniel G, and Donovan J Thompson. 1952. <span>“A Generalization of Sampling Without Replacement from a Finite Universe.”</span> <em>Journal of the American Statistical Association</em> 47 (260): 663–85.
</div>
<div id="ref-imai2019should" class="csl-entry">
Imai, Kosuke, and In Song Kim. 2019. <span>“When Should We Use Unit Fixed Effects Regression Models for Causal Inference with Longitudinal Data?”</span> <em>American Journal of Political Science</em> 63 (2): 467–90.
</div>
<div id="ref-imai2021use" class="csl-entry">
———. 2021. <span>“On the Use of Two-Way Fixed Effects Regression Models for Causal Inference with Panel Data.”</span> <em>Political Analysis</em> 29 (3): 405–15.
</div>
<div id="ref-imai2021matching" class="csl-entry">
Imai, Kosuke, In Song Kim, and Erik H Wang. 2021. <span>“Matching Methods for Causal Inference with Time-Series Cross-Sectional Data.”</span> <em>American Journal of Political Science</em>.
</div>
<div id="ref-imbens2015causal" class="csl-entry">
Imbens, Guido W, and Donald B Rubin. 2015. <em>Causal Inference in Statistics, Social, and Biomedical Sciences</em>. Cambridge University Press.
</div>
<div id="ref-li2024frontiers" class="csl-entry">
Li, Kathleen T. 2024. <span>“Frontiers: A Simple Forward Difference-in-Differences Method.”</span> <em>Marketing Science</em> 43 (2): 267–79.
</div>
<div id="ref-li2023augmented" class="csl-entry">
Li, Kathleen T, and Christophe Van den Bulte. 2023. <span>“Augmented Difference-in-Differences.”</span> <em>Marketing Science</em> 42 (4): 746–67.
</div>
<div id="ref-liu2024practical" class="csl-entry">
Liu, Licheng, Ye Wang, and Yiqing Xu. 2024. <span>“A Practical Guide to Counterfactual Estimators for Causal Inference with Time-Series Cross-Sectional Data.”</span> <em>American Journal of Political Science</em> 68 (1): 160–76.
</div>
<div id="ref-mazumder2010spectral" class="csl-entry">
Mazumder, Rahul, Trevor Hastie, and Robert Tibshirani. 2010. <span>“Spectral Regularization Algorithms for Learning Large Incomplete Matrices.”</span> <em>The Journal of Machine Learning Research</em> 11: 2287–2322.
</div>
<div id="ref-moon2015linear" class="csl-entry">
Moon, Hyungsik Roger, and Martin Weidner. 2015. <span>“Linear Regression for Panel with Unknown Number of Factors as Interactive Fixed Effects.”</span> <em>Econometrica</em> 83 (4): 1543–79. https://doi.org/<a href="https://doi.org/10.3982/ECTA9382">https://doi.org/10.3982/ECTA9382</a>.
</div>
<div id="ref-rosenbaum1983central" class="csl-entry">
Rosenbaum, Paul R, and Donald B Rubin. 1983. <span>“The Central Role of the Propensity Score in Observational Studies for Causal Effects.”</span> <em>Biometrika</em> 70 (1): 41–55.
</div>
<div id="ref-sant2020doubly" class="csl-entry">
Sant’Anna, Pedro HC, and Jun Zhao. 2020. <span>“Doubly Robust Difference-in-Differences Estimators.”</span> <em>Journal of Econometrics</em> 219 (1): 101–22.
</div>
<div id="ref-scheve2012democracy" class="csl-entry">
Scheve, Kenneth, and David Stasavage. 2012. <span>“Democracy, War, and Wealth: Lessons from Two Centuries of Inheritance Taxation.”</span> <em>American Political Science Review</em> 106 (1): 81–102.
</div>
<div id="ref-sun2021estimating" class="csl-entry">
Sun, Liyang, and Sarah Abraham. 2021. <span>“Estimating Dynamic Treatment Effects in Event Studies with Heterogeneous Treatment Effects.”</span> <em>Journal of Econometrics</em> 225 (2): 175–99.
</div>
<div id="ref-wooldridge2023simple" class="csl-entry">
———. 2023. <span>“Simple Approaches to Nonlinear Difference-in-Differences with Panel Data.”</span> <em>The Econometrics Journal</em> 26 (3): C31–66.
</div>
<div id="ref-xu2017generalized" class="csl-entry">
Xu, Yiqing. 2017. <span>“Generalized Synthetic Control Method: Causal Inference with Interactive Fixed Effects Models.”</span> <em>Political Analysis</em> 25 (1): 57–76.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-multiple-periods-and-variation-in-treatment-timing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-treatments.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/mikenguyen13/data_analysis/edit/main/30.1-stagger.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/mikenguyen13/data_analysis/blob/main/30.1-stagger.Rmd",
    "text": null
  },
  "download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true,
    "sharing": {
      "facebook": true,
      "github": true,
      "twitter": true,
      "linkedin": true
    },
    "info": true,
    "edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
