<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 27 Regression Discontinuity | A Guide on Data Analysis</title>
<meta name="author" content="Mike Nguyen">
<meta name="description" content="Regression Discontinuity (RD) is a quasi-experimental design that exploits a discrete jump in treatment assignment based on a continuous (or approximately continuous) variable, often called the...">
<meta name="generator" content="bookdown 0.42 with bs4_book()">
<meta property="og:title" content="Chapter 27 Regression Discontinuity | A Guide on Data Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/mike/data_analysis/sec-regression-discontinuity.html">
<meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<meta property="og:description" content="Regression Discontinuity (RD) is a quasi-experimental design that exploits a discrete jump in treatment assignment based on a continuous (or approximately continuous) variable, often called the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 27 Regression Discontinuity | A Guide on Data Analysis">
<meta name="twitter:description" content="Regression Discontinuity (RD) is a quasi-experimental design that exploits a discrete jump in treatment assignment based on a continuous (or approximately continuous) variable, often called the...">
<meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DMNX2X65HQ');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">A Guide on Data Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="prerequisites.html"><span class="header-section-number">2</span> Prerequisites</a></li>
<li class="book-part">I. BASIC</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">3</span> Descriptive Statistics</a></li>
<li><a class="" href="basic-statistical-inference.html"><span class="header-section-number">4</span> Basic Statistical Inference</a></li>
<li class="book-part">II. REGRESSION</li>
<li><a class="" href="linear-regression.html"><span class="header-section-number">5</span> Linear Regression</a></li>
<li><a class="" href="non-linear-regression.html"><span class="header-section-number">6</span> Non-Linear Regression</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">7</span> Generalized Linear Models</a></li>
<li><a class="" href="sec-linear-mixed-models.html"><span class="header-section-number">8</span> Linear Mixed Models</a></li>
<li><a class="" href="sec-nonlinear-and-generalized-linear-mixed-models.html"><span class="header-section-number">9</span> Nonlinear and Generalized Linear Mixed Models</a></li>
<li><a class="" href="sec-nonparametric-regression.html"><span class="header-section-number">10</span> Nonparametric Regression</a></li>
<li class="book-part">III. RAMIFICATIONS</li>
<li><a class="" href="data.html"><span class="header-section-number">11</span> Data</a></li>
<li><a class="" href="variable-transformation.html"><span class="header-section-number">12</span> Variable Transformation</a></li>
<li><a class="" href="imputation-missing-data.html"><span class="header-section-number">13</span> Imputation (Missing Data)</a></li>
<li><a class="" href="model-specification-tests.html"><span class="header-section-number">14</span> Model Specification Tests</a></li>
<li><a class="" href="variable-selection.html"><span class="header-section-number">15</span> Variable Selection</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">16</span> Hypothesis Testing</a></li>
<li><a class="" href="sec-marginal-effects.html"><span class="header-section-number">17</span> Marginal Effects</a></li>
<li><a class="" href="moderation.html"><span class="header-section-number">18</span> Moderation</a></li>
<li><a class="" href="mediation.html"><span class="header-section-number">19</span> Mediation</a></li>
<li><a class="" href="prediction-and-estimation.html"><span class="header-section-number">20</span> Prediction and Estimation</a></li>
<li class="book-part">IV. CAUSAL INFERENCE</li>
<li><a class="" href="sec-causal-inference.html"><span class="header-section-number">21</span> Causal Inference</a></li>
<li class="book-part">A. EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-experimental-design.html"><span class="header-section-number">22</span> Experimental Design</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">23</span> Sampling</a></li>
<li><a class="" href="sec-analysis-of-variance-anova.html"><span class="header-section-number">24</span> Analysis of Variance</a></li>
<li><a class="" href="sec-multivariate-methods.html"><span class="header-section-number">25</span> Multivariate Methods</a></li>
<li class="book-part">B. QUASI-EXPERIMENTAL DESIGN</li>
<li><a class="" href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></li>
<li><a class="active" href="sec-regression-discontinuity.html"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li><a class="" href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></li>
<li><a class="" href="sec-synthetic-difference-in-differences.html"><span class="header-section-number">29</span> Synthetic Difference-in-Differences</a></li>
<li><a class="" href="sec-difference-in-differences.html"><span class="header-section-number">30</span> Difference-in-Differences</a></li>
<li><a class="" href="sec-changes-in-changes.html"><span class="header-section-number">31</span> Changes-in-Changes</a></li>
<li><a class="" href="sec-synthetic-control.html"><span class="header-section-number">32</span> Synthetic Control</a></li>
<li><a class="" href="sec-event-studies.html"><span class="header-section-number">33</span> Event Studies</a></li>
<li><a class="" href="sec-instrumental-variables.html"><span class="header-section-number">34</span> Instrumental Variables</a></li>
<li><a class="" href="sec-matching-methods.html"><span class="header-section-number">35</span> Matching Methods</a></li>
<li class="book-part">C. OTHER CONCERNS</li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">36</span> Endogeneity</a></li>
<li><a class="" href="other-biases.html"><span class="header-section-number">37</span> Other Biases</a></li>
<li><a class="" href="controls.html"><span class="header-section-number">38</span> Controls</a></li>
<li><a class="" href="directed-acyclic-graph.html"><span class="header-section-number">39</span> Directed Acyclic Graph</a></li>
<li class="book-part">V. MISCELLANEOUS</li>
<li><a class="" href="report.html"><span class="header-section-number">40</span> Report</a></li>
<li><a class="" href="exploratory-data-analysis.html"><span class="header-section-number">41</span> Exploratory Data Analysis</a></li>
<li><a class="" href="sensitivity-analysis-robustness-check.html"><span class="header-section-number">42</span> Sensitivity Analysis/ Robustness Check</a></li>
<li><a class="" href="replication-and-synthetic-data.html"><span class="header-section-number">43</span> Replication and Synthetic Data</a></li>
<li><a class="" href="high-performance-computing.html"><span class="header-section-number">44</span> High-Performance Computing</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="appendix.html"><span class="header-section-number">A</span> Appendix</a></li>
<li><a class="" href="bookdown-cheat-sheet.html"><span class="header-section-number">B</span> Bookdown cheat sheet</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mikenguyen13/data_analysis">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="sec-regression-discontinuity" class="section level1" number="27">
<h1>
<span class="header-section-number">27</span> Regression Discontinuity<a class="anchor" aria-label="anchor" href="#sec-regression-discontinuity"><i class="fas fa-link"></i></a>
</h1>
<p>Regression Discontinuity (RD) is a quasi-experimental design that exploits a discrete jump in treatment assignment based on a continuous (or approximately continuous) variable, often called the <strong>running variable</strong>, <strong>forcing variable</strong>, or <strong>assignment variable</strong>.</p>
<ul>
<li>A common application occurs when an intervention is assigned based on whether the running variable exceeds a predefined cutoff.</li>
<li>The approach provides <strong>localized causal inference</strong> around the cutoff, akin to a randomized experiment.</li>
<li>
<strong>Historical Background:</strong> First introduced by <span class="citation">(<a href="references.html#ref-thistlethwaite1960">Thistlethwaite and Campbell 1960</a>)</span> in the context of merit awards and their effect on future academic outcomes.</li>
</ul>
<p><strong>Key References:</strong></p>
<p>Foundational papers: <span class="citation">(<a href="references.html#ref-imbens2008regression">G. Imbens and Lemieux 2008</a>; <a href="references.html#ref-lee2010regression">Lee and Lemieux 2010</a>)</span></p>
<ul>
<li>
<p>Practical guidelines:</p>
<ul>
<li><p><a href="https://ies.ed.gov/ncee/wwc/Docs/ReferenceResources/wwc_rd.pdf">WWC RD Guide</a></p></li>
<li><p><a href="https://ies.ed.gov/ncee/wwc/Docs/ReferenceResources/wwc_rdd_standards_122315.pdf">WWC RD Standards</a></p></li>
</ul>
</li>
</ul>
<hr>
<div id="conceptual-framework" class="section level2" number="27.1">
<h2>
<span class="header-section-number">27.1</span> Conceptual Framework<a class="anchor" aria-label="anchor" href="#conceptual-framework"><i class="fas fa-link"></i></a>
</h2>
<p>Regression discontinuity is best understood as a <strong>localized experiment at the threshold</strong>:</p>
<ul>
<li><p><a href="sec-causal-inference.html#sec-internal-validity">Internal Validity</a>: Strong within a narrow bandwidth around the cutoff.</p></li>
<li><p><a href="sec-causal-inference.html#sec-external-validity">External Validity</a>: Limited—results may not generalize beyond the bandwidth.</p></li>
<li><p>Comparison to <a href="sec-experimental-design.html#sec-the-gold-standard-randomized-controlled-trials">Randomized Experiments</a>: Empirical evidence suggests that RD and randomized controlled trials yield similar estimates (<span class="citation">(<a href="references.html#ref-chaplin2018internal">Chaplin et al. 2018</a>)</span>, <a href="https://www.mathematica.org/publications/replicating-experimental-impact-estimates-using-a-regression-discontinuity-approach">Mathematica</a>).</p></li>
</ul>
<p>RD is connected to other causal inference methods:</p>
<ul>
<li><p><a href="sec-experimental-design.html#sec-the-gold-standard-randomized-controlled-trials">Randomized Experiment</a>: It’s local randomization.</p></li>
<li><p><a href="sec-instrumental-variables.html#sec-instrumental-variables">Instrumental Variables</a>: RD can be viewed as a structural IV model <span class="citation">(<a href="references.html#ref-angrist1999using">J. D. Angrist and Lavy 1999</a>)</span>.</p></li>
<li><p><a href="sec-matching-methods.html#sec-matching-methods">Matching Methods</a>: RD is a special case where matching occurs at a single threshold <span class="citation">(<a href="references.html#ref-heckman1999economics">J. J. Heckman, LaLonde, and Smith 1999</a>)</span>.</p></li>
<li><p><a href="temporal-discontinuity-designs.html#sec-interrupted-time-series">Interrupted Time Series</a> (ITS): RD is preferable when the running variable is finely measured. However, with highly discrete time data (e.g., quarterly or annual), ITS may be more appropriate. Hence, RD is always better than ITS if data are infinite (or substantially large).</p></li>
</ul>
<hr>
<div id="types-of-regression-discontinuity-designs" class="section level3" number="27.1.1">
<h3>
<span class="header-section-number">27.1.1</span> Types of Regression Discontinuity Designs<a class="anchor" aria-label="anchor" href="#types-of-regression-discontinuity-designs"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<a href="sec-regression-discontinuity.html#sec-sharp-regression-discontinuity-design">Sharp RD</a>: Treatment probability jumps from 0 to 1 at the cutoff.</li>
<li>
<a href="sec-regression-discontinuity.html#sec-fuzzy-regression-discontinuity-design">Fuzzy RD</a>: Treatment probability changes discontinuously but does not reach 1.</li>
<li>
<a href="sec-regression-discontinuity.html#sec-regression-kink-design">Kink RD</a>: Discontinuity occurs in the slope rather than the level of the running variable <span class="citation">(<a href="references.html#ref-nielsen2010estimating">Nielsen, Sørensen, and Taber 2010</a>)</span> (see applications in <span class="citation">Böckerman, Kanninen, and Suoniemi (<a href="references.html#ref-bockerman2018kink">2018</a>)</span> and theoretical foundations in <span class="citation">Card et al. (<a href="references.html#ref-card2015inference">2015</a>)</span>).</li>
<li>Regression Discontinuity in Time (i.e., <a href="temporal-discontinuity-designs.html#sec-interrupted-time-series">Interrupted Time Series</a>): The running variable is time.</li>
</ol>
<p>Additional variations:</p>
<ul>
<li><p><a href="sec-regression-discontinuity.html#sec-multi-cutoff-regression-discontinuity-design">Multiple Cutoffs</a>: Different thresholds across subgroups.</p></li>
<li><p><a href="sec-regression-discontinuity.html#sec-multi-score-regression-discontinuity-design">Multiple Scores</a>: More than one running variable.</p></li>
<li><p>Geographic RD: Cutoff is spatially defined.</p></li>
<li><p>Dynamic Treatments: Treatment effects evolve over time.</p></li>
<li><p>Continuous Treatments: Instead of binary treatment, intensity varies.</p></li>
</ul>
<hr>
</div>
<div id="assumptions-for-rd-validity" class="section level3" number="27.1.2">
<h3>
<span class="header-section-number">27.1.2</span> Assumptions for RD Validity<a class="anchor" aria-label="anchor" href="#assumptions-for-rd-validity"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Independent Assignment:</strong> The treatment is assigned solely based on the running variable.</p></li>
<li>
<p><strong>Continuity of Conditional Expectations:</strong> The expected outcomes without treatment are continuous at the cutoff:</p>
<p><span class="math display">\[
E[Y(0)|X=x] \text{ and } E[Y(1)|X=x] \text{ are continuous at } x = c.
\]</span></p>
</li>
<li><p><strong>Exogeneity of the Cutoff:</strong> The cutoff should not be manipulable.</p></li>
<li><p><strong>No Discontinuity in Confounding Variables:</strong> Other covariates should be smooth at the threshold. A common test is to check for jumps in covariates unrelated to treatment.</p></li>
</ol>
<hr>
</div>
<div id="threats-to-rd-validity" class="section level3" number="27.1.3">
<h3>
<span class="header-section-number">27.1.3</span> Threats to RD Validity<a class="anchor" aria-label="anchor" href="#threats-to-rd-validity"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="violation-of-continuity-in-covariates" class="section level3" number="27.1.4">
<h3>
<span class="header-section-number">27.1.4</span> Violation of Continuity in Covariates<a class="anchor" aria-label="anchor" href="#violation-of-continuity-in-covariates"><i class="fas fa-link"></i></a>
</h3>
<p>If other variables besides treatment exhibit a discontinuity at the cutoff, the estimated effect may be biased.</p>
<p><strong>Solution:</strong> Conduct balance tests on pre-treatment covariates.</p>
</div>
<div id="multiple-discontinuities" class="section level3" number="27.1.5">
<h3>
<span class="header-section-number">27.1.5</span> Multiple Discontinuities<a class="anchor" aria-label="anchor" href="#multiple-discontinuities"><i class="fas fa-link"></i></a>
</h3>
<p>When multiple threshold effects exist, identification becomes more challenging.</p>
<p><strong>Solution:</strong> Use robustness checks with alternative model specifications.</p>
</div>
<div id="manipulation-of-the-running-variable" class="section level3" number="27.1.6">
<h3>
<span class="header-section-number">27.1.6</span> Manipulation of the Running Variable<a class="anchor" aria-label="anchor" href="#manipulation-of-the-running-variable"><i class="fas fa-link"></i></a>
</h3>
<p>Subjects may manipulate <span class="math inline">\(X_i\)</span> to qualify for treatment (e.g., strategic behavior in test scores).</p>
<p><strong>Solution:</strong> Implement McCrary’s density test to check for discontinuities in the distribution of <span class="math inline">\(X_i\)</span>.</p>
<hr>
</div>
</div>
<div id="model-estimation-strategies" class="section level2" number="27.2">
<h2>
<span class="header-section-number">27.2</span> Model Estimation Strategies<a class="anchor" aria-label="anchor" href="#model-estimation-strategies"><i class="fas fa-link"></i></a>
</h2>
<p>Under regression discontinuity framework, researchers can choose between <strong>parametric</strong> and <a href="sec-nonparametric-regression.html#sec-nonparametric-regression">nonparametric</a> models. The choice depends on assumptions about functional form, data availability, and the trade-off between flexibility and interpretability.</p>
<div id="parametric-models-polynomial-regression" class="section level3" number="27.2.1">
<h3>
<span class="header-section-number">27.2.1</span> Parametric Models: Polynomial Regression<a class="anchor" aria-label="anchor" href="#parametric-models-polynomial-regression"><i class="fas fa-link"></i></a>
</h3>
<p>Parametric models, such as linear regression, assume a specific functional form for the relationship between the dependent variable and predictors. One way to relax the strict linearity assumption is by incorporating <strong>polynomial functions</strong> of the forcing variable <span class="citation">(<a href="references.html#ref-lee2010regression">Lee and Lemieux 2010</a>)</span>. The choice of polynomial degree should be determined based on data characteristics.</p>
<p>However, using high-order polynomials comes with challenges. <span class="citation">Gelman and Imbens (<a href="references.html#ref-gelman2019high">2019</a>)</span> highlight three key issues associated with global high-degree polynomials:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Imprecise Estimates Due to Noise</strong>: Higher-degree polynomials can overfit, capturing noise instead of meaningful patterns.</li>
<li>
<strong>Sensitivity to Polynomial Degree</strong>: Estimates can vary significantly depending on the chosen degree, making the model less stable.</li>
<li>
<strong>Inadequate Confidence Interval Coverage</strong>: Confidence intervals tend to be misleading when using high-degree polynomials, leading to incorrect inference.</li>
</ol>
<p>For these reasons, researchers are often advised to avoid global high-order polynomials and instead rely on alternative approaches (i.e., <a href="sec-nonparametric-regression.html#sec-nonparametric-regression">nonparametric</a> version).</p>
</div>
<div id="nonparametric-models-local-regression" class="section level3" number="27.2.2">
<h3>
<span class="header-section-number">27.2.2</span> Nonparametric Models: Local Regression<a class="anchor" aria-label="anchor" href="#nonparametric-models-local-regression"><i class="fas fa-link"></i></a>
</h3>
<p><a href="sec-nonparametric-regression.html#sec-nonparametric-regression">Nonparametric models</a>, such as <a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">local polynomial regression</a>, offer greater flexibility by avoiding strong assumptions about functional form. Instead of fitting a single equation to the entire dataset, these methods estimate relationships <strong>locally</strong>—often using linear or quadratic polynomials within a neighborhood of each data point.</p>
<ul>
<li>Uses weighted observations near the cutoff.</li>
<li>More flexible than global polynomial regression.</li>
</ul>
<p>Local regression methods, such as <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a>, address the shortcomings of high-order global polynomials by:</p>
<ul>
<li>
<strong>Reducing overfitting</strong>, as they adapt to local patterns without excessive complexity.</li>
<li>
<strong>Providing stable estimates</strong>, since results are less sensitive to arbitrary choices of polynomial degree.</li>
<li>
<strong>Improving inference</strong>, ensuring more reliable confidence intervals.</li>
</ul>
<p>By balancing flexibility and robustness, local regression techniques are often preferred over global polynomial models in applied research.</p>
<p><strong>Best Practice:</strong> Use multiple model specifications to check for consistency in results.</p>
<hr>
</div>
</div>
<div id="formal-definition" class="section level2" number="27.3">
<h2>
<span class="header-section-number">27.3</span> Formal Definition<a class="anchor" aria-label="anchor" href="#formal-definition"><i class="fas fa-link"></i></a>
</h2>
<p>Let <span class="math inline">\(X_i\)</span> be the running variable, <span class="math inline">\(c\)</span> the cutoff, and <span class="math inline">\(D_i\)</span> the treatment indicator:</p>
<p><span class="math display">\[ D_i = 1_{X_i &gt; c} \]</span></p>
<p>or equivalently,</p>
<p><span class="math display">\[ D_i =  \begin{cases} 1, &amp; X_i &gt; c \\ 0, &amp; X_i &lt; c \end{cases} \]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(D_i\)</span>: Treatment assignment</p></li>
<li><p><span class="math inline">\(X_i\)</span>: Running variable (continuous)</p></li>
<li><p><span class="math inline">\(c\)</span>: Cutoff value</p></li>
</ul>
<div id="identification-assumptions" class="section level3" number="27.3.1">
<h3>
<span class="header-section-number">27.3.1</span> Identification Assumptions<a class="anchor" aria-label="anchor" href="#identification-assumptions"><i class="fas fa-link"></i></a>
</h3>
<div id="continuity-based-identification" class="section level4" number="27.3.1.1">
<h4>
<span class="header-section-number">27.3.1.1</span> Continuity-Based Identification<a class="anchor" aria-label="anchor" href="#continuity-based-identification"><i class="fas fa-link"></i></a>
</h4>
<p>RD estimates the [Local Average Treatment Effect] at the cutoff:</p>
<p><span class="math display">\[ \begin{aligned} \alpha_{SRDD} &amp;= E[Y_{1i} - Y_{0i} | X_i = c] \\ &amp;= E[Y_{1i}|X_i = c] - E[Y_{0i}|X_i = c] \\ &amp;= \lim_{x \to c^+} E[Y_{1i}|X_i = x] - \lim_{x \to c^-} E[Y_{0i}|X_i = x] \end{aligned} \]</span></p>
<p>This relies on the assumption that, in the absence of treatment, the conditional expectation of potential outcomes is <strong>continuous</strong> at the threshold <span class="math inline">\(c\)</span>.</p>
</div>
<div id="local-randomization-based-identification" class="section level4" number="27.3.1.2">
<h4>
<span class="header-section-number">27.3.1.2</span> Local Randomization-Based Identification<a class="anchor" aria-label="anchor" href="#local-randomization-based-identification"><i class="fas fa-link"></i></a>
</h4>
<p>Alternatively, identification can be achieved using local randomization within a small bandwidth <span class="math inline">\(W\)</span> (i.e., a neighborhood around the cutoff). The [Local Average Treatment Effect] in this case is:</p>
<p><span class="math display">\[ \begin{aligned} \alpha_{LR} &amp;= E[Y_{1i} - Y_{0i}|X_i \in W] \\ &amp;= \frac{1}{N_1} \sum_{X_i \in W, D_i = 1} Y_i - \frac{1}{N_0} \sum_{X_i \in W, D_i = 0} Y_i \end{aligned} \]</span></p>
<p>Since RD estimates are local, they may not generalize to the entire population. However, for many applications, <a href="sec-causal-inference.html#sec-internal-validity">internal validity</a> is of primary concern (rather than <a href="sec-causal-inference.html#sec-external-validity">external validity</a>).</p>
<hr>
</div>
</div>
</div>
<div id="estimation-and-inference" class="section level2" number="27.4">
<h2>
<span class="header-section-number">27.4</span> Estimation and Inference<a class="anchor" aria-label="anchor" href="#estimation-and-inference"><i class="fas fa-link"></i></a>
</h2>
<div id="local-randomization-based-approach" class="section level3" number="27.4.1">
<h3>
<span class="header-section-number">27.4.1</span> Local Randomization-Based Approach<a class="anchor" aria-label="anchor" href="#local-randomization-based-approach"><i class="fas fa-link"></i></a>
</h3>
<p>The local randomization approach additionally assumes that within the chosen window <span class="math inline">\(W = [c - w, c + w]\)</span>, treatment assignment is <strong>as good as random</strong>. This requires:</p>
<ol style="list-style-type: decimal">
<li>The joint probability distribution of running variable values inside <span class="math inline">\(W\)</span> to be known.</li>
<li>Potential outcomes to be independent of the running variable within <span class="math inline">\(W\)</span>.</li>
</ol>
<p>This is a stronger assumption than <a href="sec-regression-discontinuity.html#sec-continuity-based-approach">continuity-based identification</a>, as it requires that regression functions are smooth at <span class="math inline">\(c\)</span> and remain unaffected by <span class="math inline">\(X_i\)</span> within <span class="math inline">\(W\)</span>.</p>
<p>Since researchers can <strong>choose</strong> the window <span class="math inline">\(W\)</span> (where random assignment plausibly holds), the sample size can often be small.</p>
<p>The selection of <span class="math inline">\(W\)</span> can be based on:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Pre-treatment covariate balance:</strong> Ensure covariates are similar across the threshold.</li>
<li>
<strong>Independent tests:</strong> Check for independence between the outcome and the running variable.</li>
<li>
<strong>Domain knowledge:</strong> Use theoretical or empirical justification for the window choice.</li>
</ol>
<p>For inference, researchers can use:</p>
<ul>
<li><strong>(Fisher) randomization inference</strong></li>
<li><strong>(Neyman) design-based methods</strong></li>
</ul>
<hr>
</div>
<div id="sec-continuity-based-approach" class="section level3" number="27.4.2">
<h3>
<span class="header-section-number">27.4.2</span> Continuity-Based Approach<a class="anchor" aria-label="anchor" href="#sec-continuity-based-approach"><i class="fas fa-link"></i></a>
</h3>
<p>Also known as the <a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">local polynomial regression method</a>, this approach estimates treatment effects by fitting a polynomial model locally around the cutoff. Global polynomial regression is not recommended due to issues such as:</p>
<ul>
<li><strong>Lack of robustness</strong></li>
<li><strong>Overfitting</strong></li>
<li>
<strong>Runge’s phenomenon</strong> (oscillatory behavior at boundaries)</li>
</ul>
<p>Steps for <a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">Local Polynomial</a> Estimation</p>
<ol style="list-style-type: decimal">
<li>Choose the polynomial order and weighting scheme</li>
<li>Select an optimal bandwidth (minimizing MSE or coverage error)</li>
<li>Estimate the parameter of interest</li>
<li>Perform robust bias-corrected inference</li>
</ol>
<p>This method ensures that estimation remains local, capturing the treatment effect precisely at the cutoff.</p>
<hr>
</div>
</div>
<div id="specification-checks" class="section level2" number="27.5">
<h2>
<span class="header-section-number">27.5</span> Specification Checks<a class="anchor" aria-label="anchor" href="#specification-checks"><i class="fas fa-link"></i></a>
</h2>
<p>To validate the credibility of an RD design, researchers perform several specification checks:</p>
<ol style="list-style-type: decimal">
<li><a href="sec-regression-discontinuity.html#sec-balance-checks">Balance Checks</a></li>
<li><a href="sec-regression-discontinuity.html#sec-sorting-bunching-and-manipulation">Sorting, Bunching, and Manipulation</a></li>
<li><a href="sec-regression-discontinuity.html#placebo-tests">Placebo Tests</a></li>
<li><a href="sec-regression-discontinuity.html#sensitivity-to-bandwidth-choice">Sensitivity to Bandwidth Choice</a></li>
<li><a href="sec-regression-discontinuity.html#manipulation-robust-regression-discontinuity-bounds">Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ol>
<hr>
<div id="sec-balance-checks" class="section level3" number="27.5.1">
<h3>
<span class="header-section-number">27.5.1</span> Balance Checks<a class="anchor" aria-label="anchor" href="#sec-balance-checks"><i class="fas fa-link"></i></a>
</h3>
<p>Also known as <strong>checking for discontinuities in average covariates</strong>, this test examines whether covariates that should not be affected by treatment exhibit a discontinuity at the cutoff.</p>
<ul>
<li>Null Hypothesis (<span class="math inline">\(H_0\)</span>): The average effect of covariates on pseudo-outcomes (i.e., those that should not be influenced by treatment) is zero.</li>
<li>If rejected, this raises serious doubts about the RD design, necessitating a strong justification.</li>
</ul>
<hr>
</div>
<div id="sec-sorting-bunching-and-manipulation" class="section level3" number="27.5.2">
<h3>
<span class="header-section-number">27.5.2</span> Sorting, Bunching, and Manipulation<a class="anchor" aria-label="anchor" href="#sec-sorting-bunching-and-manipulation"><i class="fas fa-link"></i></a>
</h3>
<p>This test, also known as <strong>checking for discontinuities in the distribution of the forcing variable</strong>, detects whether subjects manipulate the running variable to sort into or out of treatment.</p>
<p>If individuals can manipulate the running variable—especially when the cutoff is known in advance—this can lead to bunching behavior (i.e., clustering just above or below the cutoff).</p>
<ul>
<li>If treatment is desirable, individuals will try to sort into treatment, leading to a gap just below the cutoff.</li>
<li>If treatment is undesirable, individuals will try to avoid it, leading to a gap just above the cutoff.</li>
</ul>
<p>Under RD, we assume that there is no manipulation in the running variable. However, bunching behavior, where firms or individuals strategically manipulate their position, violates this assumption.</p>
<ul>
<li><p>To address this issue, the bunching approach estimates the counterfactual distribution—what the density of individuals would have been in the absence of manipulation.</p></li>
<li><p>The fraction of individuals who engaged in manipulation is then calculated by comparing the observed distribution to this counterfactual distribution.</p></li>
<li><p>In a standard RD framework, this step is unnecessary because it assumes that the observed distribution and the counterfactual (manipulation-free) distribution are the same, implying no manipulation</p></li>
</ul>
<div id="mccrary-sorting-test" class="section level4" number="27.5.2.1">
<h4>
<span class="header-section-number">27.5.2.1</span> McCrary Sorting Test<a class="anchor" aria-label="anchor" href="#mccrary-sorting-test"><i class="fas fa-link"></i></a>
</h4>
<p>A widely used formal test is the McCrary density test <span class="citation">(<a href="references.html#ref-mccrary2008manipulation">McCrary 2008</a>)</span>, later refined by <span class="citation">Cattaneo, Idrobo, and Titiunik (<a href="references.html#ref-cattaneo2019practical">2019</a>)</span>.</p>
<ul>
<li>Null Hypothesis (<span class="math inline">\(H_0\)</span>): The density of the running variable is continuous at the cutoff.</li>
<li>Alternative Hypothesis (<span class="math inline">\(H_a\)</span>): A discontinuity (jump) in the density function at the cutoff, suggesting manipulation.</li>
<li>Interpretation:
<ul>
<li>A significant discontinuity suggests manipulation, violating RD assumptions.</li>
<li>A failure to reject <span class="math inline">\(H_0\)</span> does not necessarily confirm validity, as some forms of manipulation may remain undetected.</li>
<li>If there is two-sided manipulation, this test will fail to detect it.</li>
</ul>
</li>
</ul>
</div>
<div id="guidelines-for-assessing-manipulation" class="section level4" number="27.5.2.2">
<h4>
<span class="header-section-number">27.5.2.2</span> Guidelines for Assessing Manipulation<a class="anchor" aria-label="anchor" href="#guidelines-for-assessing-manipulation"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<span class="citation">J. L. Zhang and Rubin (<a href="references.html#ref-zhang2003estimation">2003</a>)</span>, <span class="citation">Lee (<a href="references.html#ref-lee2009training">2009</a>)</span>, and <span class="citation">Aronow, Baron, and Pinson (<a href="references.html#ref-aronow2019note">2019</a>)</span> provide criteria for evaluating manipulation risks.</li>
<li>Knowing your <strong>research design inside out</strong> is crucial to anticipating possible manipulation attempts.</li>
<li>Manipulation is often <strong>one-sided</strong>, meaning subjects shift only in one direction relative to the cutoff. In rare cases, two-sided manipulation may occur but often cancels out.</li>
<li>We could also observe partial manipulation in reality (e.g., when subjects can only imperfectly manipulate). However, since we typically treat it like a fuzzy RD, we would not encounter identification problems. In contrast, complete manipulation would lead to serious identification issues.</li>
</ul>
<p><strong>Bunching Methodology</strong></p>
<ul>
<li>Bunching occurs when individuals self-select into specific values of the running variable (e.g., policy thresholds). See <span class="citation">Kleven (<a href="references.html#ref-kleven2016bunching">2016</a>)</span> for a review.</li>
<li>The method helps estimate the counterfactual distribution—what the density would have been without manipulation.</li>
<li>The fraction of individuals who manipulated can be estimated by comparing observed densities to the counterfactual.</li>
</ul>
<p>If the running variable and outcome are <strong>simultaneously determined</strong>, a modified RD estimator can be used for consistent estimation <span class="citation">(<a href="references.html#ref-bajari2011regression">Bajari et al. 2011</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>One-sided manipulation</strong>: Individuals shift only in <strong>one direction</strong> relative to the cutoff (similar to the monotonicity assumption in instrumental variables).</li>
<li>
<strong>Bounded manipulation (regularity assumption)</strong>: The density of individuals far from the threshold remains unaffected <span class="citation">(<a href="references.html#ref-blomquist2021bunching">Blomquist et al. 2021</a>; <a href="references.html#ref-bertanha2021better">Bertanha, McCallum, and Seegert 2021</a>)</span>.</li>
</ol>
</div>
<div id="steps-for-bunching-analysis" class="section level4" number="27.5.2.3">
<h4>
<span class="header-section-number">27.5.2.3</span> Steps for Bunching Analysis<a class="anchor" aria-label="anchor" href="#steps-for-bunching-analysis"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Identify the window where bunching occurs (based on <span class="citation">Bosch, Dekker, and Strohmaier (<a href="references.html#ref-bosch2020data">2020</a>)</span>). Perform robustness checks by varying the manipulation window.</li>
<li>Estimate the manipulation-free counterfactual distribution.</li>
<li>Standard errors for inference can be calculated (following <span class="citation">Chetty, Hendren, and Katz (<a href="references.html#ref-chetty2016effects">2016</a>)</span>), where bootstrap resampling of residuals is used in estimating the counts of individuals within bins. However, this step may be unnecessary for large datasets.</li>
</ol>
<p>If the bunching test fails to detect manipulation, we proceed to the <a href="sec-difference-in-differences.html#placebo-test">Placebo Test</a>.</p>
<hr>
<p><strong>McCrary Density Test (Discontinuity in Forcing Variable)</strong></p>
<div class="sourceCode" id="cb721"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rdd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulated data without discontinuity</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rdd/man/DCdensity.html">DCdensity</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span><span class="op">)</span>  <span class="co"># No discontinuity</span></span></code></pre></div>
<div class="inline-figure"><img src="27-regression-discontinuity_files/figure-html/unnamed-chunk-1-1.png" width="90%" style="display: block; margin: auto;"></div>
<pre><code>#&gt; [1] 0.06355195

# Simulated data with discontinuity
x &lt;- runif(1000, -1, 1)
x &lt;- x + 2 * (runif(1000, -1, 1) &gt; 0 &amp; x &lt; 0)
DCdensity(x, 0)  # Discontinuity detected</code></pre>
<div class="inline-figure"><img src="27-regression-discontinuity_files/figure-html/unnamed-chunk-1-2.png" width="90%" style="display: block; margin: auto;"></div>
<pre><code>#&gt; [1] 0.001936782</code></pre>
<p><strong>Cattaneo Density Test (Improved Version)</strong></p>
<div class="sourceCode" id="cb724"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rddensity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulated continuous density</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">rdd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rddensity.html">rddensity</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">x</span>, vce <span class="op">=</span> <span class="st">"jackknife"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rdd</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Manipulation testing using local polynomial density estimation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of obs =       100</span></span>
<span><span class="co">#&gt; Model =               unrestricted</span></span>
<span><span class="co">#&gt; Kernel =              triangular</span></span>
<span><span class="co">#&gt; BW method =           estimated</span></span>
<span><span class="co">#&gt; VCE method =          jackknife</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c = 0                 Left of c           Right of c          </span></span>
<span><span class="co">#&gt; Number of obs         66                  34                  </span></span>
<span><span class="co">#&gt; Eff. Number of obs    38                  25                  </span></span>
<span><span class="co">#&gt; Order est. (p)        2                   2                   </span></span>
<span><span class="co">#&gt; Order bias (q)        3                   3                   </span></span>
<span><span class="co">#&gt; BW est. (h)           0.922               0.713               </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method                T                   P &gt; |T|             </span></span>
<span><span class="co">#&gt; Robust                0.6715              0.5019              </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-values of binomial tests (H0: p=0.5).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Window Length              &lt;c     &gt;=c    P&gt;|T|</span></span>
<span><span class="co">#&gt; 0.563     + 0.563          26      20    0.4614</span></span>
<span><span class="co">#&gt; 0.603     + 0.580          27      20    0.3817</span></span>
<span><span class="co">#&gt; 0.643     + 0.596          30      20    0.2026</span></span>
<span><span class="co">#&gt; 0.683     + 0.613          32      21    0.1690</span></span>
<span><span class="co">#&gt; 0.722     + 0.630          32      22    0.2203</span></span>
<span><span class="co">#&gt; 0.762     + 0.646          33      22    0.1770</span></span>
<span><span class="co">#&gt; 0.802     + 0.663          33      23    0.2288</span></span>
<span><span class="co">#&gt; 0.842     + 0.680          35      24    0.1925</span></span>
<span><span class="co">#&gt; 0.882     + 0.696          36      24    0.1550</span></span>
<span><span class="co">#&gt; 0.922     + 0.713          38      25    0.1299</span></span>
<span></span>
<span><span class="co"># Plot requires customization (refer to package documentation)</span></span></code></pre></div>
</div>
</div>
<div id="placebo-tests" class="section level3" number="27.5.3">
<h3>
<span class="header-section-number">27.5.3</span> Placebo Tests<a class="anchor" aria-label="anchor" href="#placebo-tests"><i class="fas fa-link"></i></a>
</h3>
<p>Placebo tests, also known as <strong>falsification checks</strong>, assess whether discontinuities appear at points other than the treatment cutoff. This helps verify that observed effects are causal rather than artifacts of the method or data.</p>
<ul>
<li>There should be no jumps in the outcome at values other than the cutoff (<span class="math inline">\(X_i &lt; c\)</span> or <span class="math inline">\(X_i \geq c\)</span>).</li>
<li>The test involves shifting the cutoff along the running variable while using the same bandwidth to check for discontinuities in the conditional mean of the outcome.</li>
<li>This approach is similar to <a href="sec-regression-discontinuity.html#sec-balance-checks">balance checks</a> in experimental design, ensuring no pre-existing differences. Remember, we can only test on observables, not unobservables.</li>
</ul>
<p>Under a valid RD design, <a href="sec-matching-methods.html#sec-matching-methods">matching methods</a> are unnecessary. Just as with <a href="sec-experimental-design.html#sec-the-gold-standard-randomized-controlled-trials">randomized experiments</a>, balance should naturally occur across the threshold. If adjustments are required, it suggests the <strong>RD assumptions may be invalid</strong>.</p>
<div id="applications-of-placebo-tests" class="section level4" number="27.5.3.1">
<h4>
<span class="header-section-number">27.5.3.1</span> Applications of Placebo Tests<a class="anchor" aria-label="anchor" href="#applications-of-placebo-tests"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Testing No Discontinuity in Predetermined Covariates:</strong> Covariates that should not be affected by treatment should not exhibit a jump at the cutoff.</li>
<li>
<strong>Testing Other Discontinuities:</strong> Checking for discontinuities at other arbitrary points along the running variable.</li>
<li>
<strong>Using Placebo Outcomes:</strong> If an outcome variable that should not be affected by treatment shows a significant discontinuity, this raises concerns about RD validity.</li>
<li>
<strong>Assessing Sensitivity to Covariates:</strong> RD estimates should not be highly sensitive to the inclusion or exclusion of covariates.</li>
</ol>
</div>
<div id="mathematical-specification" class="section level4" number="27.5.3.2">
<h4>
<span class="header-section-number">27.5.3.2</span> Mathematical Specification<a class="anchor" aria-label="anchor" href="#mathematical-specification"><i class="fas fa-link"></i></a>
</h4>
<p>The balance of observable characteristics on both sides of the threshold can be tested using:</p>
<p><span class="math display">\[
Z_i = \alpha_0 + \alpha_1 f(X_i) + I(X_i \geq c) \alpha_2 + [f(X_i) \times I(X_i \geq c)]\alpha_3 + u_i
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(X_i\)</span> = running variable</p></li>
<li><p><span class="math inline">\(Z_i\)</span> = predetermined characteristics (e.g., age, education, etc.)</p></li>
<li><p><span class="math inline">\(\alpha_2\)</span> should be zero if <span class="math inline">\(Z_i\)</span> is unaffected by treatment.</p></li>
</ul>
<p>If multiple covariates <span class="math inline">\(Z_i\)</span> are tested simultaneously, simulating their <strong>joint distribution</strong> avoids false positives due to multiple comparisons. This step is unnecessary if covariates are <strong>independent</strong>, but such independence is unlikely in practice.</p>
<hr>
</div>
</div>
<div id="sensitivity-to-bandwidth-choice" class="section level3" number="27.5.4">
<h3>
<span class="header-section-number">27.5.4</span> Sensitivity to Bandwidth Choice<a class="anchor" aria-label="anchor" href="#sensitivity-to-bandwidth-choice"><i class="fas fa-link"></i></a>
</h3>
<p>The choice of bandwidth is crucial in RD estimation. Different bandwidth selection methods exist:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Ad-hoc or Substantively Driven:</strong> Based on theoretical or empirical reasoning.</li>
<li>
<strong>Data-Driven Selection (Cross-Validation):</strong> Optimizes bandwidth to minimize prediction error.</li>
<li>
<strong>Conservative Approach:</strong> Uses robust optimal bandwidth selection methods (e.g., <span class="citation">(<a href="references.html#ref-calonico2020optimal">Calonico, Cattaneo, and Farrell 2020</a>)</span>).</li>
</ol>
<p>The objective is to <strong>minimize mean squared error (MSE)</strong> between estimated and actual treatment effects.</p>
</div>
<div id="assessing-sensitivity" class="section level3" number="27.5.5">
<h3>
<span class="header-section-number">27.5.5</span> Assessing Sensitivity<a class="anchor" aria-label="anchor" href="#assessing-sensitivity"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Results should be <strong>consistent</strong> across reasonable bandwidth choices.</li>
<li>The optimal bandwidth for estimating treatment effects may <strong>differ</strong> from the optimal bandwidth for testing covariates but should be fairly close.</li>
</ul>
<div class="sourceCode" id="cb725"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rdd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate some data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>  <span class="co"># Sample size</span></span>
<span></span>
<span><span class="co"># Running variable centered around 0</span></span>
<span><span class="va">running_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Treatment assigned at cutpoint 0</span></span>
<span><span class="va">treatment</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">running_var</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Outcome variable</span></span>
<span><span class="va">outcome_var</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">running_var</span> <span class="op">+</span> <span class="va">treatment</span> <span class="op">*</span> <span class="fl">1.5</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Compute the optimal Imbens-Kalyanaraman bandwidth</span></span>
<span><span class="va">bandwidth</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/rdd/man/IKbandwidth.html">IKbandwidth</a></span><span class="op">(</span><span class="va">running_var</span>,</span>
<span>                <span class="va">outcome_var</span>,</span>
<span>                cutpoint <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                kernel <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the bandwidth</span></span>
<span><span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html">print</a></span><span class="op">(</span><span class="va">bandwidth</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4374142</span></span></code></pre></div>
<hr>
</div>
<div id="manipulation-robust-regression-discontinuity-bounds" class="section level3" number="27.5.6">
<h3>
<span class="header-section-number">27.5.6</span> Manipulation-Robust Regression Discontinuity Bounds<a class="anchor" aria-label="anchor" href="#manipulation-robust-regression-discontinuity-bounds"><i class="fas fa-link"></i></a>
</h3>
<p>Regression Discontinuity designs rely on the assumption that the running variable <span class="math inline">\(X_i\)</span> is not manipulable by agents in the study. However, <span class="citation">McCrary (<a href="references.html#ref-mccrary2008manipulation">2008</a>)</span> showed that a discontinuity in the density of <span class="math inline">\(X_i\)</span> at the cutoff may indicate manipulation, potentially invalidating RD estimates. The common approach to handling detected manipulation is:</p>
<ul>
<li>If no manipulation is detected, proceed with RD analysis.</li>
<li>If manipulation is detected, use the “doughnut-hole” method (i.e., excluding near-cutoff observations), but this contradicts the RD principles.</li>
</ul>
<p>However, strict adherence to this rule can lead to two problems:</p>
<ol style="list-style-type: decimal">
<li>
<strong>False Negatives</strong>: A small sample size might fail to detect manipulation, leading to biased estimates if manipulation still affects the running variable.</li>
<li>
<strong>Loss of Informative Data</strong>: Even when manipulation is detected, the data may still contain valuable information for causal inference.</li>
</ol>
<p>To address these challenges, <span class="citation">Gerard, Rokkanen, and Rothe (<a href="references.html#ref-gerard2020bounds">2020</a>)</span> introduce a framework that accounts for manipulated observations rather than discarding them. This approach:</p>
<ul>
<li>Identifies the extent of manipulation.</li>
<li>Computes worst-case bounds on treatment effects.</li>
<li>Provides a systematic way to incorporate manipulated observations while maintaining the credibility of RD analysis.</li>
</ul>
<p>If manipulation is believed to be unlikely, an alternative approach is to conduct sensitivity analysis by:</p>
<ul>
<li><p>Testing how different hypothetical values of <span class="math inline">\(\tau\)</span> affect the bounds.</p></li>
<li><p>Comparing results across various <span class="math inline">\(\tau\)</span> assumptions to assess robustness.</p></li>
</ul>
<hr>
<p>Consider independent observations <span class="math inline">\((X_i, Y_i, D_i)\)</span>:</p>
<ul>
<li>
<span class="math inline">\(X_i\)</span>: Running variable.</li>
<li>
<span class="math inline">\(Y_i\)</span>: Outcome variable.</li>
<li>
<span class="math inline">\(D_i\)</span>: Treatment indicator (<span class="math inline">\(D_i = 1\)</span> if <span class="math inline">\(X_i \geq c\)</span>, and <span class="math inline">\(D_i = 0\)</span> otherwise).</li>
</ul>
<p>A <strong>sharp RD design</strong> satisfies <span class="math inline">\(D_i = I(X_i \geq c)\)</span>, while a <strong>fuzzy RD design</strong> allows probabilistic treatment assignment.</p>
<p>The population consists of two types of units:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Potentially-Assigned Units</strong> (<span class="math inline">\(M_i = 0\)</span>): These units follow the standard RD framework. They have potential outcomes <span class="math inline">\(Y_i(d)\)</span> and potential treatment states <span class="math inline">\(D_i(x)\)</span>.</li>
<li>
<strong>Always-Assigned Units</strong> (<span class="math inline">\(M_i = 1\)</span>): These units always appear on one side of the cutoff and do not require potential outcomes.</li>
</ol>
<p>If no always-assigned units exist (<span class="math inline">\(M_i = 1\)</span> for no units), the standard RD model holds.</p>
<hr>
<div id="key-assumptions" class="section level4" number="27.5.6.1">
<h4>
<span class="header-section-number">27.5.6.1</span> Key Assumptions<a class="anchor" aria-label="anchor" href="#key-assumptions"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Local Independence and Continuity</strong>:
<ul>
<li>Treatment probability jumps at <span class="math inline">\(c\)</span> among potentially-assigned units: <span class="math display">\[
P(D = 1|X = c^+, M = 0) &gt; P(D = 1|X = c^-, M = 0).
\]</span>
</li>
<li>No defiers: <span class="math inline">\(P(D^+ \geq D^- | X = c, M = 0) = 1\)</span>.</li>
<li>Potential outcomes and treatment states are continuous at <span class="math inline">\(c\)</span>.</li>
<li>The density of the running variable among potentially-assigned units, <span class="math inline">\(F_{X|M=0}(x)\)</span>, is differentiable at <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Smoothness of the Running Variable among Potentially-Assigned Units</strong>:
<ul>
<li>The derivative of <span class="math inline">\(F_{X|M=0}(x)\)</span> is continuous at <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Restrictions on Always-Assigned Units</strong>:
<ul>
<li>Always-assigned units satisfy <span class="math inline">\(P(X \geq c|M = 1) = 1\)</span>.</li>
<li>The density of the running variable among always-assigned units, <span class="math inline">\(F_{X|M=1}(x)\)</span>, is right-differentiable at <span class="math inline">\(c\)</span>.</li>
<li>This one-sided manipulation assumption allows identification of the proportion of always-assigned units.</li>
</ul>
</li>
</ol>
<p>When always-assigned units exist, the RD design effectively becomes <strong>fuzzy</strong>, since: 1. Some potentially-assigned units receive treatment while others do not. 2. Always-assigned units are always treated (or always untreated).</p>
</div>
<div id="estimating-treatment-effects" class="section level4" number="27.5.6.2">
<h4>
<span class="header-section-number">27.5.6.2</span> Estimating Treatment Effects<a class="anchor" aria-label="anchor" href="#estimating-treatment-effects"><i class="fas fa-link"></i></a>
</h4>
<p>For potentially-assigned units, the <strong>causal effect of interest</strong> is:</p>
<p><span class="math display">\[
\Gamma = E[Y(1) - Y(0) | X = c, D^+ &gt; D^-, M = 0].
\]</span></p>
<p>This parameter represents the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">local average treatment effect</a> for potentially-assigned compliers, i.e., those whose treatment status is affected by their running variable crossing the cutoff.</p>
</div>
<div id="bounding-treatment-effects" class="section level4" number="27.5.6.3">
<h4>
<span class="header-section-number">27.5.6.3</span> Bounding Treatment Effects<a class="anchor" aria-label="anchor" href="#bounding-treatment-effects"><i class="fas fa-link"></i></a>
</h4>
<p>The approach to bounding treatment effects consists of two key steps:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Estimating the Proportion of Always-Assigned Units</strong>:
<ul>
<li>This is done by measuring the discontinuity in the density of <span class="math inline">\(X\)</span> at <span class="math inline">\(c\)</span>.</li>
<li>The larger the discontinuity, the greater the fraction of always-assigned units.</li>
</ul>
</li>
<li>
<strong>Computing Worst-Case Bounds on Treatment Effects</strong>:
<ul>
<li>If manipulation exists, treatment effects must be inferred using extreme-case scenarios.</li>
<li>For <strong>sharp RD designs</strong>, bounds are estimated by trimming extreme outcomes near the cutoff.</li>
<li>For <strong>fuzzy RD designs</strong>, additional adjustments are required to account for the presence of always-assigned units.</li>
</ul>
</li>
</ol>
<p>Extensions of this approach use covariates and economic behavior assumptions to refine bounds further.</p>
<div class="inline-table"><table class="table table-sm">
<caption>Comparison with Doughnut-Hole RD Designs</caption>
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th><strong>Manipulation-Robust RD</strong></th>
<th><strong>Doughnut-Hole RD</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Uses actual observed data at the cutoff.</td>
<td>Excludes observations near the cutoff.</td>
</tr>
<tr class="even">
<td>Provides a direct estimate of causal effects.</td>
<td>Relies on extrapolation from other regions.</td>
</tr>
<tr class="odd">
<td>Accounts for manipulation explicitly.</td>
<td>Assumes a hypothetical counterfactual world.</td>
</tr>
<tr class="even">
<td>Less sensitive to assumptions about manipulation.</td>
<td>Requires strong assumptions about bias.</td>
</tr>
</tbody>
</table></div>
</div>
<div id="identification-challenges" class="section level4" number="27.5.6.4">
<h4>
<span class="header-section-number">27.5.6.4</span> Identification Challenges<a class="anchor" aria-label="anchor" href="#identification-challenges"><i class="fas fa-link"></i></a>
</h4>
<p>A central challenge in manipulation-robust RD designs is the inability to directly distinguish <strong>always-assigned</strong> from <strong>potentially-assigned</strong> units. As a result, the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE</a> <span class="math inline">\(\Gamma\)</span> is not point identified. Instead, we establish sharp bounds on <span class="math inline">\(\Gamma\)</span>.</p>
<p>These bounds leverage the stochastic dominance of potential outcome cumulative distribution functions over observed distributions. This allows us to infer treatment effects without making strong parametric assumptions.</p>
<p>To formalize the population structure, we define five types of units:</p>
<ul>
<li>
<strong>Potentially-Assigned Units</strong>:
<ul>
<li>
<span class="math inline">\(C_0\)</span> (Compliers): Receive treatment if and only if <span class="math inline">\(X \geq c\)</span>.</li>
<li>
<span class="math inline">\(A_0\)</span> (Always-Takers): Always receive treatment, regardless of <span class="math inline">\(X\)</span>.</li>
<li>
<span class="math inline">\(N_0\)</span> (Never-Takers): Never receive treatment, regardless of <span class="math inline">\(X\)</span>.</li>
</ul>
</li>
<li>
<strong>Always-Assigned Units</strong>:
<ul>
<li>
<span class="math inline">\(T_1\)</span> (Treated Always-Assigned Units): Always appear above the cutoff and receive treatment.</li>
<li>
<span class="math inline">\(U_1\)</span> (Untreated Always-Assigned Units): Always appear below the cutoff and do not receive treatment.</li>
</ul>
</li>
</ul>
<p>The measure <span class="math inline">\(\tau\)</span>, representing the proportion of always-assigned units near the cutoff, is point-identified using the discontinuity in the density of the running variable <span class="math inline">\(f_X\)</span> at <span class="math inline">\(c\)</span>.</p>
<div id="identification-in-sharp-rd" class="section level5" number="27.5.6.4.1">
<h5>
<span class="header-section-number">27.5.6.4.1</span> Identification in Sharp RD<a class="anchor" aria-label="anchor" href="#identification-in-sharp-rd"><i class="fas fa-link"></i></a>
</h5>
<p>In a sharp RD design:</p>
<ul>
<li>Units to the left of the cutoff are potentially-assigned units.</li>
<li>The observed distribution of untreated outcomes, <span class="math inline">\(Y(0)\)</span>, among these units corresponds to the outcomes of potentially-assigned compliers (<span class="math inline">\(C_0\)</span>) at the cutoff.</li>
<li>To estimate sharp bounds on <span class="math inline">\(\Gamma\)</span>, we need to assess the distribution of treated outcomes (<span class="math inline">\(Y(1)\)</span>) for compliers.</li>
</ul>
<p>However, information on treated outcomes (<span class="math inline">\(Y(1)\)</span>) at the cutoff is only available from the treated subpopulation, which includes:</p>
<ul>
<li><p>Potentially-assigned compliers (<span class="math inline">\(C_0\)</span>)</p></li>
<li><p>Always-assigned treated units (<span class="math inline">\(T_1\)</span>)</p></li>
</ul>
<p>Since <span class="math inline">\(\tau\)</span> is point-identified, we can construct sharp bounds on <span class="math inline">\(\Gamma\)</span> by adjusting for the presence of <span class="math inline">\(T_1\)</span>.</p>
</div>
<div id="identification-in-fuzzy-rd" class="section level5" number="27.5.6.4.2">
<h5>
<span class="header-section-number">27.5.6.4.2</span> Identification in Fuzzy RD<a class="anchor" aria-label="anchor" href="#identification-in-fuzzy-rd"><i class="fas fa-link"></i></a>
</h5>
<p>In fuzzy RD, treatment assignment is not deterministic. The subpopulations observed in each treatment-status group at the cutoff are:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th><strong>Subpopulation</strong></th>
<th><strong>Unit Types Present</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(X = c^+, D = 1\)</span></td>
<td><span class="math inline">\(C_0, A_0, T_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(X = c^-, D = 1\)</span></td>
<td><span class="math inline">\(A_0\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X= c^+, D = 0\)</span></td>
<td><span class="math inline">\(N_0, U_1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(X = c^-, D = 0\)</span></td>
<td><span class="math inline">\(C_0, N_0\)</span></td>
</tr>
</tbody>
</table></div>
<p><em>Source: Table on page 848 of <span class="citation">Gerard, Rokkanen, and Rothe (<a href="references.html#ref-gerard2020bounds">2020</a>)</span></em></p>
<p>Key Takeaways:</p>
<ul>
<li>
<strong>Unit Types and Combinations</strong>: There are five distinct unit types and four combinations of treatment assignments and decisions relevant to the analysis. These distinctions are important because they affect how potential outcomes are analyzed and bounded.</li>
<li>
<strong>Outcome Distributions</strong>: The analysis involves estimating the distribution of potential outcomes (both treated and untreated) among potentially-assigned compliers at the cutoff.</li>
<li>The goal is to estimate the distribution of potential outcomes (both treated and untreated) for potentially-assigned compliers at the cutoff.</li>
</ul>
</div>
</div>
<div id="three-step-process-for-bounding-treatment-effects" class="section level4" number="27.5.6.5">
<h4>
<span class="header-section-number">27.5.6.5</span> Three-Step Process for Bounding Treatment Effects<a class="anchor" aria-label="anchor" href="#three-step-process-for-bounding-treatment-effects"><i class="fas fa-link"></i></a>
</h4>
<p>The method to obtain sharp bounds on <span class="math inline">\(\Gamma\)</span> follows three steps:</p>
<ol style="list-style-type: decimal">
<li>Bounding Potential Outcomes Under Treatment:
<ul>
<li>Use observed treated outcomes to estimate the upper and lower bounds on <span class="math inline">\(F_{Y(1)}(y | X = c, M = 0)\)</span>.</li>
</ul>
</li>
<li>Bounding Potential Outcomes Under Non-Treatment:
<ul>
<li>Use observed untreated outcomes to estimate the upper and lower bounds on <span class="math inline">\(F_{Y(0)}(y | X = c, M = 0)\)</span>.</li>
</ul>
</li>
<li>Deriving Bounds on <span class="math inline">\(\Gamma\)</span>:
<ul>
<li>Using the bounds from Steps 1 and 2, compute sharp upper and lower bounds on the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">local average treatment effect</a>.</li>
</ul>
</li>
</ol>
<p><strong>Extreme Value Consideration:</strong></p>
<ul>
<li>The bounds account for worst-case scenarios by considering extreme assumptions about the distribution of potential outcomes.</li>
<li>These bounds are sharp (i.e., they cannot be tightened further without additional assumptions) but remain empirically relevant.</li>
</ul>
</div>
<div id="extensions" class="section level4" number="27.5.6.6">
<h4>
<span class="header-section-number">27.5.6.6</span> Extensions<a class="anchor" aria-label="anchor" href="#extensions"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Quantile Treatment Effects (QTEs)</li>
</ol>
<p>An alternative to average treatment effects is the quantile treatment effect (QTE), which focuses on different percentiles of the outcome distribution. Advantages of QTE bounds include:</p>
<ul>
<li>Less Sensitivity to Extreme Values: Unlike ATE bounds, QTE bounds are less affected by outliers in the outcome distribution.</li>
<li>More Informative for Policy Analysis: Helps determine whether effects are concentrated in certain segments of the population.</li>
</ul>
<p>QTE vs. ATE Under Manipulation:</p>
<ul>
<li>
<strong>ATE inference is highly sensitive</strong> to manipulation, with confidence intervals widening significantly as assumed manipulation increases.</li>
<li>
<strong>QTE inference remains meaningful</strong> even under substantial manipulation.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Discrete Outcome Extensions: The framework applies not only to continuous outcomes but also to <strong>discrete</strong> outcome variables.</li>
<li>Role of Behavioral Assumptions</li>
</ol>
<ul>
<li>Making behavioral assumptions about high treatment likelihood among always-assigned units can refine the bounds.</li>
<li>For example, assuming that most always-assigned units are treated allows for narrower bounds on treatment effects.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Incorporation of Covariates</li>
</ol>
<ul>
<li>Including pre-treatment covariates can refine treatment effect bounds.</li>
<li>Covariates help:
<ul>
<li>Distinguish between potentially-assigned and always-assigned units.</li>
<li>Improve inference on treatment effect heterogeneity.</li>
<li>Guide policy targeting by identifying unit types based on observed characteristics.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb726"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"francoisgerard/rdbounds/R"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb727"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://renkun-ken.github.io/formattable/">formattable</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.nber.org/papers/w22892">rdbounds</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rdbounds/man/rdbounds_sampledata.html">rdbounds_sampledata</a></span><span class="op">(</span><span class="fl">1000</span>, covs <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "True tau: 0.117999815082062"</span></span>
<span><span class="co">#&gt; [1] "True treatment effect on potentially-assigned: 2"</span></span>
<span><span class="co">#&gt; [1] "True treatment effect on right side of cutoff: 2.35399944524618"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;            x         y treatment</span></span>
<span><span class="co">#&gt; 1 -1.2532616  2.684827         0</span></span>
<span><span class="co">#&gt; 2 -0.5146925  5.845219         0</span></span>
<span><span class="co">#&gt; 3  3.4853777  6.166070         0</span></span>
<span><span class="co">#&gt; 4  0.1576616  3.227139         0</span></span>
<span><span class="co">#&gt; 5  0.2890962  7.031685         1</span></span>
<span><span class="co">#&gt; 6  3.8350019 10.238570         1</span></span>
<span></span>
<span><span class="va">rdbounds_est</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/rdbounds/man/rdbounds.html">rdbounds</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">y</span>,</span>
<span>        x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span>,</span>
<span>        <span class="co"># covs = as.factor(df$cov),</span></span>
<span>        treatment <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>        c <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        discrete_x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        discrete_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        bwsx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>        bwy <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        </span>
<span>        <span class="co"># for median effect use </span></span>
<span>        <span class="co"># type = "qte", </span></span>
<span>        <span class="co"># percentiles = .5, </span></span>
<span>        </span>
<span>        kernel <span class="op">=</span> <span class="st">"epanechnikov"</span>,</span>
<span>        orders <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        evaluation_ys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        refinement_A <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        refinement_B <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        right_effects <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        yextremes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>        num_bootstraps <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The proportion of always-assigned units just to the right of the cutoff is estimated to be 0.38047"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:09.865241 Estimating CDFs for point estimates"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:10.167795 .....Estimating CDFs for units just to the right of the cutoff"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:12.38372 Estimating CDFs with nudged tau (tau_star)"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:12.429188 .....Estimating CDFs for units just to the right of the cutoff"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:16.48029 Beginning parallelized output by bootstrap.."</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:20.764061 Computing Confidence Intervals"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:33.707395 Time taken:0.4 minutes"</span></span></code></pre></div>
<div class="sourceCode" id="cb728"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rdbounds/man/rdbounds_summary.html">rdbounds_summary</a></span><span class="op">(</span><span class="va">rdbounds_est</span>, title_prefix <span class="op">=</span> <span class="st">"Sample Data Results"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Time taken: 0.4 minutes"</span></span>
<span><span class="co">#&gt; [1] "Sample size: 1000"</span></span>
<span><span class="co">#&gt; [1] "Local Average Treatment Effect:"</span></span>
<span><span class="co">#&gt; $tau_hat</span></span>
<span><span class="co">#&gt; [1] 0.3804665</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tau_hat_CI</span></span>
<span><span class="co">#&gt; [1] 0.4180576 1.4333618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $takeup_increase</span></span>
<span><span class="co">#&gt; [1] 0.6106973</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $takeup_increase_CI</span></span>
<span><span class="co">#&gt; [1] 0.4332132 0.7881814</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_naive</span></span>
<span><span class="co">#&gt; [1] 1.589962</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_naive_CI</span></span>
<span><span class="co">#&gt; [1] 1.083977 2.095948</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_bounds</span></span>
<span><span class="co">#&gt; [1] 0.7165801 2.3454868</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_CI</span></span>
<span><span class="co">#&gt; [1] -1.200992  7.733214</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_covs_bounds</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_covs_CI</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_naive</span></span>
<span><span class="co">#&gt; [1] 2.583271</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_naive_CI</span></span>
<span><span class="co">#&gt; [1] 1.506573 3.659969</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_bounds</span></span>
<span><span class="co">#&gt; [1] 1.273896 3.684860</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_CI</span></span>
<span><span class="co">#&gt; [1] -1.266341 10.306116</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_bounds_refinementA</span></span>
<span><span class="co">#&gt; [1] 1.273896 3.684860</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_refinementA_CI</span></span>
<span><span class="co">#&gt; [1] -1.266341 10.306116</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_bounds_refinementB</span></span>
<span><span class="co">#&gt; [1] 1.420594 3.677963</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_refinementB_CI</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_covs_bounds</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_covs_CI</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_CIs_manipulation</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_CIs_manipulation</span></span>
<span><span class="co">#&gt; [1] NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_right_bounds</span></span>
<span><span class="co">#&gt; [1] -2.056178  3.650820</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_SRD_right_CI</span></span>
<span><span class="co">#&gt; [1] -11.044937   9.282217</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_right_bounds</span></span>
<span><span class="co">#&gt; [1] -2.900703  5.272370</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TE_FRD_right_CI</span></span>
<span><span class="co">#&gt; [1] -14.75421  15.58640</span></span></code></pre></div>
<div class="sourceCode" id="cb729"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rdbounds_est_tau</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/rdbounds/man/rdbounds.html">rdbounds</a></span><span class="op">(</span></span>
<span>        y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">y</span>,</span>
<span>        x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span>,</span>
<span>        <span class="co"># covs = as.factor(df$cov),</span></span>
<span>        treatment <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>        c <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        discrete_x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        discrete_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        bwsx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>        bwy <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        kernel <span class="op">=</span> <span class="st">"epanechnikov"</span>,</span>
<span>        orders <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        evaluation_ys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        refinement_A <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        refinement_B <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        right_effects <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        potential_taus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.2</span><span class="op">)</span>,</span>
<span>        yextremes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>        num_bootstraps <span class="op">=</span> <span class="fl">5</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The proportion of always-assigned units just to the right of the cutoff is estimated to be 0.38047"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:35.36151 Estimating CDFs for point estimates"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:35.578808 .....Estimating CDFs for units just to the right of the cutoff"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:37.519459 Estimating CDFs with nudged tau (tau_star)"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:37.590958 .....Estimating CDFs for units just to the right of the cutoff"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:40.652474 Beginning parallelized output by bootstrap.."</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:45.388902 Estimating CDFs with fixed tau value of: 0.025"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:45.460836 Estimating CDFs with fixed tau value of: 0.05"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:45.531103 Estimating CDFs with fixed tau value of: 0.1"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:45.590547 Estimating CDFs with fixed tau value of: 0.2"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:46.638509 Beginning parallelized output by bootstrap x fixed tau.."</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:06:50.52083 Computing Confidence Intervals"</span></span>
<span><span class="co">#&gt; [1] "2025-03-18 11:07:03.385809 Time taken:0.47 minutes"</span></span></code></pre></div>
<div class="sourceCode" id="cb730"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">causalverse</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/causalverse/man/plot_rd_aa_share.html">plot_rd_aa_share</a></span><span class="op">(</span><span class="va">rdbounds_est_tau</span><span class="op">)</span> <span class="co"># For SRD (default)</span></span></code></pre></div>
<div class="inline-figure"><img src="27-regression-discontinuity_files/figure-html/unnamed-chunk-8-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb731"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># causalverse::plot_rd_aa_share(rdbounds_est_tau, rd_type = "FRD")  # For FRD</span></span></code></pre></div>
</div>
</div>
</div>
<div id="sec-fuzzy-regression-discontinuity-design" class="section level2" number="27.6">
<h2>
<span class="header-section-number">27.6</span> Fuzzy Regression Discontinuity Design<a class="anchor" aria-label="anchor" href="#sec-fuzzy-regression-discontinuity-design"><i class="fas fa-link"></i></a>
</h2>
<p>A Fuzzy Regression Discontinuity Design occurs when the assignment rule at the cutoff does not perfectly determine treatment status but instead causes a discontinuity in the probability of treatment. Unlike a Sharp RD Design, where crossing the threshold fully determines treatment, in a fuzzy RD, some individuals on both sides of the threshold may or may not receive the treatment.</p>
<p>If treatment is not strictly assigned at the cutoff, the usual RD estimator (which assumes deterministic assignment) <strong>is not valid</strong>. Instead, we use the cutoff as an <strong>instrumental variable</strong> to estimate the treatment effect for <strong>compliers</strong>, i.e., individuals whose treatment status depends on whether they cross the threshold.</p>
<p>Define an indicator variable <span class="math inline">\(Z_i\)</span> (i.e., instrument for treatment assignment) that captures whether an individual is above or below the cutoff:</p>
<p><span class="math display">\[
Z_i =
\begin{cases}
1 &amp; \text{if } X_i \geq c \\
0 &amp; \text{if } X_i &lt; c
\end{cases}
\]</span></p>
<p>This variable <span class="math inline">\(Z_i\)</span> serves as an instrument for the treatment variable <span class="math inline">\(D_i\)</span> because:</p>
<ul>
<li><p>It strongly correlates with treatment (<span class="math inline">\(D_i\)</span>).</p></li>
<li><p>It is exogenous, meaning it affects the outcome only through its effect on treatment.</p></li>
</ul>
<div id="compliance-types" class="section level3" number="27.6.1">
<h3>
<span class="header-section-number">27.6.1</span> Compliance Types<a class="anchor" aria-label="anchor" href="#compliance-types"><i class="fas fa-link"></i></a>
</h3>
<p>Since treatment assignment is no longer deterministic, individuals can be classified into four groups based on how they respond to the cutoff:</p>
<ol style="list-style-type: decimal">
<li>Compliers (<span class="math inline">\(C_0\)</span>): Individuals who receive treatment if and only if <span class="math inline">\(X_i \geq c\)</span>.</li>
<li>Always-Takers (<span class="math inline">\(A_0\)</span>): Individuals who always receive treatment, regardless of whether <span class="math inline">\(X_i \geq c\)</span>.</li>
<li>Never-Takers (<span class="math inline">\(N_0\)</span>): Individuals who never receive treatment, even if <span class="math inline">\(X_i \geq c\)</span>.</li>
<li>Defiers (violating monotonicity, assumed to be zero): Individuals who receive treatment if <span class="math inline">\(X_i &lt; c\)</span> but not if <span class="math inline">\(X_i \geq c\)</span>.</li>
</ol>
<p>The <strong>Fuzzy RD estimator</strong> identifies the treatment effect <strong>only for compliers</strong>, because their treatment status depends on <span class="math inline">\(Z_i\)</span>.</p>
</div>
<div id="estimating-the-local-average-treatment-effect" class="section level3" number="27.6.2">
<h3>
<span class="header-section-number">27.6.2</span> Estimating the Local Average Treatment Effect<a class="anchor" aria-label="anchor" href="#estimating-the-local-average-treatment-effect"><i class="fas fa-link"></i></a>
</h3>
<p>We estimate the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE</a> using a <strong>ratio of discontinuities</strong>:</p>
<p><span class="math display">\[
\text{LATE} = \frac{\lim\limits_{x \downarrow c}E[Y|X = x] - \lim\limits_{x \uparrow c}E[Y|X = x]}{\lim\limits_{x \downarrow c } E[D |X = x] - \lim\limits_{x \uparrow c}E[D |X=x]}
\]</span></p>
<p>Intuitively, this formula represents:</p>
<p><span class="math display">\[
\text{LATE} = \frac{\text{Discontinuity in } E[Y|X]}{\text{Discontinuity in } E[D|X]}
\]</span></p>
<p>where:</p>
<ul>
<li><p>The numerator captures the jump in the expected outcome at the cutoff.</p></li>
<li><p>The denominator captures the jump in the probability of treatment at the cutoff.</p></li>
</ul>
<p>This ratio is valid under three key assumptions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Continuity in potential outcomes:</strong> <span class="math inline">\(E[Y(d)|X]\)</span> is continuous at <span class="math inline">\(X = c\)</span> for both <span class="math inline">\(d \in \{0,1\}\)</span>.</li>
<li>
<strong>Monotonicity:</strong> There are no defiers (<span class="math inline">\(P(D^+ \geq D^- | X = c) = 1\)</span>).</li>
<li>
<strong>First-stage relevance:</strong> There is a discontinuity in <span class="math inline">\(P(D = 1 | X)\)</span> at <span class="math inline">\(X = c\)</span>.</li>
</ol>
<p>If these conditions hold, the fuzzy RD estimator gives a valid estimate of the causal effect of treatment for compliers.</p>
</div>
<div id="equivalent-representation-using-expectations" class="section level3" number="27.6.3">
<h3>
<span class="header-section-number">27.6.3</span> Equivalent Representation Using Expectations<a class="anchor" aria-label="anchor" href="#equivalent-representation-using-expectations"><i class="fas fa-link"></i></a>
</h3>
<p>We can also define <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE</a> in terms of <strong>conditional expectations of treatment and outcome</strong>:</p>
<p><span class="math display">\[
\lim_{\epsilon \to 0} \frac{E[Y |Z = 1] - E[Y |Z=0]}{E[D|Z = 1] - E[D|Z = 0]}
\]</span></p>
<p>where <span class="math inline">\(Z\)</span> is the instrument (indicator for being above the cutoff). This approach highlights the IV nature of fuzzy RD.</p>
</div>
<div id="estimation-strategies" class="section level3" number="27.6.4">
<h3>
<span class="header-section-number">27.6.4</span> Estimation Strategies<a class="anchor" aria-label="anchor" href="#estimation-strategies"><i class="fas fa-link"></i></a>
</h3>
<p>There are two equivalent ways to estimate the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE</a> in practice:</p>
<p><strong>Approach 1: Two-Step Estimation</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Estimate Sharp RD for the Outcome</strong> <span class="math inline">\(Y\)</span>:
<ul>
<li>Regress <span class="math inline">\(Y\)</span> on <span class="math inline">\(X\)</span> using a <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a> on either side of <span class="math inline">\(c\)</span>.</li>
<li>Estimate the discontinuity in <span class="math inline">\(E[Y|X]\)</span> at <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Estimate Sharp RD for the Treatment</strong> <span class="math inline">\(D\)</span>:
<ul>
<li>Regress <span class="math inline">\(D\)</span> on <span class="math inline">\(X\)</span> using a <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a> on either side of <span class="math inline">\(c\)</span>.</li>
<li>Estimate the discontinuity in <span class="math inline">\(E[D|X]\)</span> at <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Compute the Ratio</strong>:
<ul>
<li>Divide the estimated discontinuity in <span class="math inline">\(E[Y|X]\)</span> by the estimated discontinuity in <span class="math inline">\(E[D|X]\)</span>.</li>
</ul>
</li>
</ol>
<p>Mathematically:</p>
<p><span class="math display">\[
\widehat{\text{LATE}} = \frac{\widehat{E[Y | X = c^+]} - \widehat{E[Y | X = c^-]}}{\widehat{E[D | X = c^+]} - \widehat{E[D | X = c^-]}}.
\]</span></p>
<p><strong>Approach 2: Instrumental Variables Regression</strong></p>
<ul>
<li><p>Subset the data to observations close to <span class="math inline">\(c\)</span>.</p></li>
<li>
<p>Use <span class="math inline">\(Z_i\)</span> (above/below cutoff indicator) as an instrument for <span class="math inline">\(D_i\)</span> in a two-stage least squares regression:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>First-stage regression (predicting treatment using the cutoff indicator):</strong></p>
<p><span class="math display">\[
D_i = \alpha + \beta Z_i + \gamma X_i + \epsilon_i
\]</span></p>
<ul>
<li>This captures the effect of the cutoff on treatment assignment.</li>
</ul>
</li>
<li>
<p><strong>Second-stage regression (estimating treatment effect using predicted</strong> <span class="math inline">\(D_i\)</span>):</p>
<p><span class="math display">\[
Y_i = \delta + \tau \widehat{D}_i + \lambda X_i + \nu_i
\]</span></p>
<ul>
<li>The coefficient <span class="math inline">\(\tau\)</span> gives the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE estimate</a>.</li>
</ul>
</li>
</ol>
</li>
</ul>
</div>
<div id="practical-considerations-6" class="section level3" number="27.6.5">
<h3>
<span class="header-section-number">27.6.5</span> Practical Considerations<a class="anchor" aria-label="anchor" href="#practical-considerations-6"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<strong>Bandwidth Selection</strong>: Only observations near the cutoff should be used. Methods like <strong>cross-validation</strong> or <span class="citation">Calonico, Cattaneo, and Farrell (<a href="references.html#ref-calonico2020optimal">2020</a>)</span> optimal bandwidth selection can help.</li>
<li>
<strong>Polynomial Order</strong>: A <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear model</a> is typically preferred, but higher-order polynomials may be used cautiously.</li>
<li>
<strong>Robust Inference</strong>: Standard errors should be computed using heteroskedasticity-robust and clustered standard errors if necessary.</li>
</ul>
</div>
<div id="steps-for-fuzzy-rd" class="section level3" number="27.6.6">
<h3>
<span class="header-section-number">27.6.6</span> Steps for Fuzzy RD<a class="anchor" aria-label="anchor" href="#steps-for-fuzzy-rd"><i class="fas fa-link"></i></a>
</h3>
<p>1. Visualization</p>
<ol style="list-style-type: decimal">
<li>Graph the Outcome Variable:
<ul>
<li>Compute the average outcome within bins of the running variable <span class="math inline">\(X_i\)</span>.</li>
<li>Choose bins large enough to display smooth trends but small enough to reveal discontinuities at the cutoff.</li>
<li>Overlay a smoothed regression line on either side of the cutoff to visualize any jumps.</li>
</ul>
</li>
<li>Graph the Probability of Treatment:
<ul>
<li>Compute the average treatment probability within the same bins.</li>
<li>Plot <span class="math inline">\(E[D|X]\)</span> to check for a discontinuity at <span class="math inline">\(X = c\)</span>, confirming the first-stage relevance of the instrument.</li>
</ul>
</li>
</ol>
<p>2. Estimation of Treatment Effect</p>
<p>Use <strong>Two-Stage Least Squares</strong> to estimate the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">Local Average Treatment Effect</a>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>First Stage (Predict Treatment Using Cutoff Indicator</strong> <span class="math inline">\(Z_i\)</span>): <span class="math display">\[
D_i = \alpha + \beta Z_i + \gamma X_i + \epsilon_i
\]</span>
<ul>
<li>This regression captures how treatment probability changes at the cutoff.</li>
<li>The coefficient <span class="math inline">\(\beta\)</span> measures the <strong>jump in treatment probability</strong> at <span class="math inline">\(X = c\)</span>.</li>
</ul>
</li>
<li>
<strong>Second Stage (Estimate Outcome Using Predicted Treatment)</strong>: <span class="math display">\[
Y_i = \delta + \tau \widehat{D}_i + \lambda X_i + \nu_i
\]</span>
<ul>
<li>The coefficient <span class="math inline">\(\tau\)</span> gives the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">LATE</a>, which estimates the treatment effect for <strong>compliers</strong>.</li>
</ul>
</li>
</ol>
<p>3. Robustness Checks</p>
<ol style="list-style-type: decimal">
<li>
<strong>Assess Possible Jumps in Other Covariates</strong>:
<ul>
<li>Check whether other pre-determined covariates (e.g., age, income) exhibit discontinuities at the cutoff.</li>
<li>If covariates jump, this may indicate endogenous sorting or omitted variable bias.</li>
</ul>
</li>
<li>
<strong>Hypothesis Testing for Bunching (McCrary Test)</strong>:
<ul>
<li>Test for manipulation of the running variable by examining whether the density of <span class="math inline">\(X_i\)</span> changes discontinuously at <span class="math inline">\(c\)</span>.</li>
<li>A significant density jump suggests sorting behavior, which could invalidate RD assumptions.</li>
</ul>
</li>
<li>
<strong>Placebo Tests</strong>:
<ul>
<li>Repeat the analysis at fake cutoffs (values of <span class="math inline">\(X\)</span> where no intervention occurs).</li>
<li>If a treatment effect appears at a placebo cutoff, this suggests a spurious RD effect.</li>
</ul>
</li>
<li>
<strong>Varying Bandwidth Sensitivity</strong>:
<ul>
<li>Re-run the analysis using different bandwidths around the cutoff.</li>
<li>Check whether estimates remain stable as the window narrows or expands.</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div id="sec-sharp-regression-discontinuity-design" class="section level2" number="27.7">
<h2>
<span class="header-section-number">27.7</span> Sharp Regression Discontinuity Design<a class="anchor" aria-label="anchor" href="#sec-sharp-regression-discontinuity-design"><i class="fas fa-link"></i></a>
</h2>
<p>A Sharp Regression Discontinuity Design occurs when treatment assignment follows a strict rule at a known cutoff. That is, units receive treatment <strong>if and only if</strong> their running variable <span class="math inline">\(X_i\)</span> crosses a threshold <span class="math inline">\(c\)</span>:</p>
<p><span class="math display">\[
D_i =
\begin{cases}
1 &amp; \text{if } X_i \geq c \\
0 &amp; \text{if } X_i &lt; c
\end{cases}
\]</span></p>
<p>Unlike <a href="sec-regression-discontinuity.html#sec-fuzzy-regression-discontinuity-design">Fuzzy RD</a>, where treatment probability changes discontinuously but is not deterministic, <a href="sec-regression-discontinuity.html#sec-sharp-regression-discontinuity-design">Sharp RD</a> ensures perfect compliance with the cutoff rule.</p>
<p>The key idea is that <strong>units just below and just above the cutoff are nearly identical in expectation</strong>, except for their treatment status. This mimics <a href="sec-experimental-design.html#sec-the-gold-standard-randomized-controlled-trials">randomized experiments</a> in a local neighborhood around <span class="math inline">\(X = c\)</span>.</p>
<div id="assumptions-for-identification" class="section level3" number="27.7.1">
<h3>
<span class="header-section-number">27.7.1</span> Assumptions for Identification<a class="anchor" aria-label="anchor" href="#assumptions-for-identification"><i class="fas fa-link"></i></a>
</h3>
<p>For a valid Sharp RD design, we assume:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Continuity of the Conditional Expectation of Potential Outcomes</strong>
<ul>
<li>The expected outcome given <span class="math inline">\(X\)</span> is <strong>smooth at</strong> <span class="math inline">\(c\)</span> in the absence of treatment: <span class="math display">\[
\lim_{x \uparrow c} E[Y(0) | X = x] = \lim_{x \downarrow c} E[Y(0) | X = x].
\]</span>
</li>
<li>This ensures that any observed discontinuity in <span class="math inline">\(E[Y | X]\)</span> at <span class="math inline">\(X = c\)</span> is due to treatment, not pre-existing differences.</li>
</ul>
</li>
<li>
<strong>No Manipulation of the Running Variable</strong>
<ul>
<li>Agents cannot perfectly sort themselves around the cutoff (e.g., students manipulating test scores to qualify for a scholarship).</li>
<li>This is typically checked using the McCrary density test to detect discontinuities in the density of <span class="math inline">\(X\)</span> at <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Local Randomization</strong>
<ul>
<li>Near the cutoff, individuals are <strong>as good as randomly assigned</strong> to treatment or control.</li>
</ul>
</li>
</ol>
<p>If these conditions hold, the Sharp RD estimator provides an unbiased estimate of the causal effect of treatment.</p>
</div>
<div id="estimating-the-local-average-treatment-effect-1" class="section level3" number="27.7.2">
<h3>
<span class="header-section-number">27.7.2</span> Estimating the Local Average Treatment Effect<a class="anchor" aria-label="anchor" href="#estimating-the-local-average-treatment-effect-1"><i class="fas fa-link"></i></a>
</h3>
<p>The treatment effect at the cutoff is given by:</p>
<p><span class="math display">\[
\tau = \lim_{x \downarrow c}E[Y | X = x] - \lim_{x \uparrow c} E[Y | X = x].
\]</span></p>
<p>This represents the jump in the expected outcome at the cutoff.</p>
</div>
<div id="estimation-methods" class="section level3" number="27.7.3">
<h3>
<span class="header-section-number">27.7.3</span> Estimation Methods<a class="anchor" aria-label="anchor" href="#estimation-methods"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">Local Linear Regression</a></li>
</ol>
<p>A common approach is to estimate separate linear regressions on <strong>each side of the cutoff</strong>:</p>
<p>For observations <strong>below</strong> the cutoff <span class="math inline">\((X &lt; c)\)</span>:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta (X_i - c) + \epsilon_i.
\]</span></p>
<p>For observations <strong>above</strong> the cutoff <span class="math inline">\((X \geq c)\)</span>:</p>
<p><span class="math display">\[
Y_i = \gamma + \delta (X_i - c) + \tau D_i + \nu_i.
\]</span></p>
<p>Here, the coefficient <span class="math inline">\(\tau\)</span> captures the <strong>treatment effect at</strong> <span class="math inline">\(X = c\)</span>.</p>
<p>In practice, we estimate:</p>
<p><span class="math display">\[
\hat{\tau} = \hat{E}[Y | X = c^+] - \hat{E}[Y | X = c^-].
\]</span></p>
<p>This can be implemented using <a href="linear-regression.html#weighted-least-squares">Weighted Least Squares</a> with observations near the cutoff receiving higher weights.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Global Polynomial Regression</strong></li>
</ol>
<p>An alternative approach is to use a polynomial regression:</p>
<p><span class="math display">\[
Y_i = \alpha + \sum_{k=1}^{K} \beta_k (X_i - c)^k + \tau D_i + \epsilon_i.
\]</span></p>
<p>where:</p>
<ul>
<li><p>Higher-order terms <span class="math inline">\((X_i - c)^k\)</span> capture nonlinear relationships.</p></li>
<li><p>Typical choices for <span class="math inline">\(K\)</span> are 2 or 3, but higher orders may lead to overfitting.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Nonparametric Local Regression</strong></li>
</ol>
<p>Instead of assuming a linear or polynomial relationship, a local regression (kernel-based) method estimates:</p>
<p><span class="math display">\[
E[Y | X = x] = \sum_{i=1}^{n} K_h (X_i - x) Y_i.
\]</span></p>
<p>where <span class="math inline">\(K_h\)</span> is a kernel function (e.g., Epanechnikov), and <span class="math inline">\(h\)</span> is the bandwidth.</p>
<ul>
<li>A smaller <span class="math inline">\(h\)</span> captures local variation but increases variance.</li>
<li>A larger <span class="math inline">\(h\)</span> smooths noise but risks bias.</li>
</ul>
</div>
<div id="steps-for-sharp-rd" class="section level3" number="27.7.4">
<h3>
<span class="header-section-number">27.7.4</span> Steps for Sharp RD<a class="anchor" aria-label="anchor" href="#steps-for-sharp-rd"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><strong>Visualization</strong></li>
</ol>
<ul>
<li>
<strong>Graph the outcome variable</strong>:
<ul>
<li>Compute binned averages of <span class="math inline">\(Y_i\)</span> over intervals of <span class="math inline">\(X\)</span>.</li>
<li>Choose bin sizes that balance smoothness and clarity.</li>
<li>Overlay a smoothed regression line on each side of <span class="math inline">\(c\)</span>.</li>
</ul>
</li>
<li>
<strong>Graph the running variable’s density</strong>:
<ul>
<li>Use histograms to check for manipulation.</li>
<li>Conduct a McCrary density test to detect discontinuities.</li>
</ul>
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Estimation of the Treatment Effect</strong></li>
</ol>
<ul>
<li>Run <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a> separately on both sides of the cutoff.</li>
<li>Use <a href="sec-nonparametric-regression.html#sec-nonparametric-regression">nonparametric methods</a> (e.g., kernel regression) for robustness.</li>
<li>Estimate treatment effect using: <span class="math display">\[
\hat{\tau} = \hat{E}[Y | X = c^+] - \hat{E}[Y | X = c^-].
\]</span>
</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Robustness Checks</strong></li>
</ol>
<!-- --><ol style="list-style-type: decimal">
<li>Check for Jumps in Other Covariates</li>
</ol>
<ul>
<li><p>If any pre-determined covariate jumps at the cutoff, it suggests sorting or omitted variable bias.</p></li>
<li>
<p>Run RD regressions for each covariate:</p>
<p><span class="math display">\[
W_i = \alpha + \beta (X_i - c) + \gamma D_i + \epsilon_i.
\]</span></p>
</li>
<li><p>A significant <span class="math inline">\(\gamma\)</span> suggests a violation of continuity assumptions.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>McCrary Density Test (Checking for Manipulation)</li>
</ol>
<ul>
<li>Run the McCrary test to examine whether the density of <span class="math inline">\(X_i\)</span> exhibits a discontinuity at <span class="math inline">\(c\)</span>.</li>
<li>A significant jump indicates sorting behavior, which can invalidate the RD design.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Placebo Tests</li>
</ol>
<ul>
<li>Perform fake cutoff tests by estimating RD effects at arbitrary points <span class="math inline">\(c^*\)</span>.</li>
<li>If significant effects appear at non-cutoff points, the RD design may be picking up spurious trends.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Varying Bandwidth</li>
</ol>
<ul>
<li>Re-run RD analysis using different bandwidths <span class="math inline">\(h\)</span>.</li>
<li>If results change dramatically, treatment effects may be highly sensitive to bandwidth choice.</li>
<li>Use data-driven bandwidth selection methods (e.g., <span class="citation">G. Imbens and Kalyanaraman (<a href="references.html#ref-imbens2012optimal">2012</a>)</span>).</li>
</ul>
<hr>
</div>
</div>
<div id="sec-regression-kink-design" class="section level2" number="27.8">
<h2>
<span class="header-section-number">27.8</span> Regression Kink Design<a class="anchor" aria-label="anchor" href="#sec-regression-kink-design"><i class="fas fa-link"></i></a>
</h2>
<p>The Regression Kink Design (RKD) extends the logic of RD by exploiting <strong>changes in the slope</strong> of the treatment intensity function at a known threshold rather than a discontinuous jump in treatment assignment.</p>
<p>Instead of an RD jump in treatment probability at <span class="math inline">\(X = c\)</span>, the treatment function <span class="math inline">\(b(X)\)</span> exhibits a <strong>kink</strong> at the cutoff:</p>
<ul>
<li>In <a href="sec-regression-discontinuity.html#sec-identification-in-sharp-regression-kink-design">Sharp RKD</a>, the kink is deterministic, meaning the treatment function <span class="math inline">\(b(X)\)</span> changes its slope exactly at <span class="math inline">\(X = c\)</span>.</li>
<li>In <a href="sec-regression-discontinuity.html#sec-identification-in-fuzzy-regression-kink-design">Fuzzy RKD</a>, treatment assignment remains probabilistic, requiring an <strong>instrumental variable approach</strong> similar to Fuzzy RD.</li>
</ul>
<p>Example: Unemployment Benefits</p>
<p>Consider an unemployment insurance program where benefits increase at a diminishing rate as prior earnings increase. The function governing benefits, <span class="math inline">\(b(X)\)</span>, exhibits a kink at a threshold <span class="math inline">\(X = c\)</span>. The RKD framework allows us to estimate the marginal causal effect of additional benefits on employment duration.</p>
<div id="sec-identification-in-sharp-regression-kink-design" class="section level3" number="27.8.1">
<h3>
<span class="header-section-number">27.8.1</span> Identification in Sharp Regression Kink Design<a class="anchor" aria-label="anchor" href="#sec-identification-in-sharp-regression-kink-design"><i class="fas fa-link"></i></a>
</h3>
<p>In a Sharp RKD, the treatment intensity function <span class="math inline">\(b(X)\)</span> exhibits a known change in slope at <span class="math inline">\(X = c\)</span>, formally:</p>
<p><span class="math display">\[
D_i = b(X_i), \quad \text{where } b(X) \text{ has a kink at } X = c.
\]</span></p>
<p>The key identification assumption is that the potential outcome function <span class="math inline">\(E[Y(d) | X]\)</span> is smooth in <span class="math inline">\(X\)</span>. Thus, any observed change in the slope of <span class="math inline">\(E[Y | X]\)</span> at <span class="math inline">\(X = c\)</span> can be attributed to the change in <span class="math inline">\(b(X)\)</span>.</p>
<p>The causal effect of interest is:</p>
<p><span class="math display">\[
\alpha_{KRD} = \frac{\lim\limits_{x \downarrow c} \frac{d}{dx}E[Y |X = x]- \lim\limits_{x \uparrow c} \frac{d}{dx}E[Y |X = x]}{\lim\limits_{x \downarrow c} \frac{d}{dx}b(x) - \lim\limits_{x \uparrow c} \frac{d}{dx}b(x)}.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(b(X)\)</span> is a known function determining treatment intensity.</p></li>
<li><p>The numerator captures the discontinuous change in the slope of the expected outcome at <span class="math inline">\(X = c\)</span>.</p></li>
<li><p>The denominator captures the change in the slope of the treatment function at <span class="math inline">\(X = c\)</span>.</p></li>
</ul>
<p>If <span class="math inline">\(b(X)\)</span> is known and deterministic, the denominator is non-random, allowing for precise estimation of <span class="math inline">\(\alpha_{KRD}\)</span>.</p>
<p><strong>Assumptions for Identification</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Continuity of Potential Outcomes</strong>
<ul>
<li>The expected potential outcomes <span class="math inline">\(E[Y(d)|X]\)</span> are smooth in <span class="math inline">\(X\)</span> (no jumps).</li>
</ul>
</li>
<li>
<strong>No Manipulation of the Running Variable</strong>
<ul>
<li>The density of <span class="math inline">\(X\)</span> is continuous at <span class="math inline">\(X = c\)</span>, implying that agents cannot sort themselves based on the kink.</li>
</ul>
</li>
<li>
<strong>First-Stage Validity</strong>
<ul>
<li>The slope of <span class="math inline">\(b(X)\)</span> must change at <span class="math inline">\(X = c\)</span> (i.e., the kink must exist).</li>
</ul>
</li>
</ol>
<p>If these assumptions hold, <span class="math inline">\(\alpha_{KRD}\)</span> represents the marginal causal effect of treatment intensity on the outcome.</p>
</div>
<div id="sec-identification-in-fuzzy-regression-kink-design" class="section level3" number="27.8.2">
<h3>
<span class="header-section-number">27.8.2</span> Identification in Fuzzy Regression Kink Design<a class="anchor" aria-label="anchor" href="#sec-identification-in-fuzzy-regression-kink-design"><i class="fas fa-link"></i></a>
</h3>
<p>In Fuzzy RKD, the treatment function <span class="math inline">\(D_i\)</span> does not directly follow a deterministic function <span class="math inline">\(b(X)\)</span> but instead exhibits a kink in its probability distribution:</p>
<p><span class="math display">\[
E[D | X] \text{ has a kink at } X = c.
\]</span></p>
<p>The treatment intensity function is unknown, requiring an instrumental variable (IV) strategy, analogous to Fuzzy RD.</p>
<p>The causal effect is given by:</p>
<p><span class="math display">\[
\alpha_{KRD} = \frac{\lim\limits_{x \downarrow c} \frac{d}{dx}E[Y |X = x]- \lim\limits_{x \uparrow c} \frac{d}{dx}E[Y |X = x]}{\lim\limits_{x \downarrow c} \frac{d}{dx}E[D |X = x]- \lim\limits_{x \uparrow c} \frac{d}{dx}E[D |X = x]}.
\]</span></p>
<p>where:</p>
<ul>
<li><p>The numerator measures the kink in the expected outcome.</p></li>
<li><p>The denominator measures the kink in the probability of treatment.</p></li>
<li><p>The ratio provides a local instrumental variable estimate of the causal effect for compliers.</p></li>
</ul>
<p><strong>Identification Assumptions</strong></p>
<p>In addition to the Sharp RKD assumptions, Fuzzy RKD requires:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Monotonicity</strong>
<ul>
<li>No individuals decrease their treatment intensity while others increase at the kink (analogous to Fuzzy RD monotonicity).</li>
</ul>
</li>
<li>
<strong>Relevance of the Kink</strong>
<ul>
<li>There must be a statistically significant slope change in <span class="math inline">\(E[D | X]\)</span> at <span class="math inline">\(X = c\)</span>.</li>
</ul>
</li>
</ol>
<p>If these assumptions hold, the Fuzzy RKD estimator identifies a local treatment effect.</p>
</div>
<div id="estimation-of-rkd-effects" class="section level3" number="27.8.3">
<h3>
<span class="header-section-number">27.8.3</span> Estimation of RKD Effects<a class="anchor" aria-label="anchor" href="#estimation-of-rkd-effects"><i class="fas fa-link"></i></a>
</h3>
<p>RKD estimation involves three main steps:</p>
<p><strong>Step 1: Estimating the Kink in the Outcome Function</strong></p>
<p>Estimate the left- and right-hand derivatives of <span class="math inline">\(E[Y | X]\)</span>:</p>
<p><span class="math display">\[
\frac{d}{dx}E[Y | X] = \lim_{h \to 0} \frac{E[Y | X = c + h] - E[Y | X = c - h]}{h}.
\]</span></p>
<p>This can be done using:</p>
<ul>
<li><p><a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">Local linear regression</a> on either side of the kink.</p></li>
<li><p><a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">Higher-order polynomial regression</a> for improved flexibility.</p></li>
</ul>
<p><strong>Step 2: Estimating the Kink in the Treatment Function</strong></p>
<p>For <a href="sec-regression-discontinuity.html#sec-identification-in-sharp-regression-kink-design">Sharp RKD</a>, the kink in <span class="math inline">\(b(X)\)</span> is known.</p>
<p>For <a href="sec-regression-discontinuity.html#sec-identification-in-fuzzy-regression-kink-design">Fuzzy RKD</a>, estimate the kink in <span class="math inline">\(E[D | X]\)</span>:</p>
<p><span class="math display">\[
\frac{d}{dx}E[D | X] = \lim_{h \to 0} \frac{E[D | X = c + h] - E[D | X = c - h]}{h}.
\]</span></p>
<p>Use <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local regression</a> or <a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">piecewise polynomials</a> to estimate this slope.</p>
<p><strong>Step 3: Compute RKD Estimator</strong></p>
<p>For <a href="sec-regression-discontinuity.html#sec-identification-in-sharp-regression-kink-design">Sharp RKD</a>:</p>
<p><span class="math display">\[
\hat{\alpha}_{KRD} = \frac{\hat{\tau}_Y}{\tau_b},
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\hat{\tau}_Y\)</span> is the estimated kink in <span class="math inline">\(E[Y | X]\)</span>.</p></li>
<li><p><span class="math inline">\(\tau_b\)</span> is the known slope change in <span class="math inline">\(b(X)\)</span>.</p></li>
</ul>
<p>For <a href="sec-regression-discontinuity.html#sec-identification-in-fuzzy-regression-kink-design">Fuzzy RKD</a>:</p>
<p><span class="math display">\[
\hat{\alpha}_{KRD} = \frac{\hat{\tau}_Y}{\hat{\tau}_D}.
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(\hat{\tau}_D\)</span> is the estimated kink in <span class="math inline">\(E[D | X]\)</span>.</li>
</ul>
</div>
<div id="robustness-checks-1" class="section level3" number="27.8.4">
<h3>
<span class="header-section-number">27.8.4</span> Robustness Checks<a class="anchor" aria-label="anchor" href="#robustness-checks-1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Assess Covariate Smoothness</strong>
<ul>
<li>Verify that pre-determined covariates (e.g., age, education) do not exhibit kinks at <span class="math inline">\(X = c\)</span>.</li>
</ul>
</li>
<li>
<strong>Check for Manipulation of the Running Variable</strong>
<ul>
<li>Perform a McCrary test to ensure the density of <span class="math inline">\(X\)</span> is continuous at <span class="math inline">\(X = c\)</span>.</li>
</ul>
</li>
<li>
<strong>Placebo Kinks</strong>
<ul>
<li>Test for spurious kinks at other arbitrary values of <span class="math inline">\(X\)</span>.</li>
</ul>
</li>
<li>
<strong>Bandwidth Sensitivity</strong>
<ul>
<li>Estimate RKD effects with varying bandwidths to check for consistency.</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div id="sec-multi-cutoff-regression-discontinuity-design" class="section level2" number="27.9">
<h2>
<span class="header-section-number">27.9</span> Multi-Cutoff Regression Discontinuity Design<a class="anchor" aria-label="anchor" href="#sec-multi-cutoff-regression-discontinuity-design"><i class="fas fa-link"></i></a>
</h2>
<p>The Multi-Cutoff Regression Discontinuity Design extends the standard RD framework by allowing for <strong>multiple cutoff points</strong> across different groups or geographic regions. Instead of a single threshold <span class="math inline">\(c\)</span>, different subgroups are assigned different cutoffs <span class="math inline">\(C_i\)</span>. This framework allows for a <strong>heterogeneous treatment effect</strong> function:</p>
<p><span class="math display">\[
\tau (x,c)= E[Y_{1i} - Y_{0i}|X_i = x, C_i = c].
\]</span></p>
<p><strong>Why Use Multi-Cutoff RD?</strong></p>
<ul>
<li>
<strong>Policy Variation</strong>: Policies often implement different cutoffs across regions or institutions (e.g., different states setting different minimum test scores for scholarship eligibility).</li>
<li>
<strong>Generalizability</strong>: Allows estimation of treatment effects across multiple populations instead of relying on a single threshold.</li>
<li>
<strong>Improved Precision</strong>: Leveraging multiple thresholds can enhance statistical power compared to a single-cutoff RD.</li>
</ul>
<p>The multi-cutoff RD framework provides several advantages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Estimation of Local Heterogeneous Effects</strong>
<ul>
<li>Unlike standard RD, which estimates a single treatment effect, multi-cutoff RD allows heterogeneity in effects across groups.</li>
</ul>
</li>
<li>
<strong>Improved Precision</strong>
<ul>
<li>More observations across different thresholds can increase statistical power.</li>
</ul>
</li>
<li>
<strong>Policy Implications</strong>
<ul>
<li>Useful in settings where policy thresholds vary (e.g., different states setting different income eligibility limits for welfare programs).</li>
</ul>
</li>
</ol>
<div id="identification" class="section level3" number="27.9.1">
<h3>
<span class="header-section-number">27.9.1</span> Identification<a class="anchor" aria-label="anchor" href="#identification"><i class="fas fa-link"></i></a>
</h3>
<p>Under the potential outcomes framework, each unit <span class="math inline">\(i\)</span> has:</p>
<ul>
<li><p>A running variable <span class="math inline">\(X_i\)</span>.</p></li>
<li><p>A cutoff specific to their group <span class="math inline">\(C_i\)</span>.</p></li>
<li><p>A binary treatment indicator:</p></li>
</ul>
<p><span class="math display">\[
D_i = I(X_i \geq C_i).
\]</span></p>
<p>The observed outcome is:</p>
<p><span class="math display">\[
Y_i = D_i Y_{1i} + (1 - D_i) Y_{0i}.
\]</span></p>
<p>The treatment effect is the expected difference in potential outcomes:</p>
<p><span class="math display">\[
\tau(x, c) = E[Y_{1i} - Y_{0i} | X_i = x, C_i = c].
\]</span></p>
</div>
<div id="key-assumptions-1" class="section level3" number="27.9.2">
<h3>
<span class="header-section-number">27.9.2</span> Key Assumptions<a class="anchor" aria-label="anchor" href="#key-assumptions-1"><i class="fas fa-link"></i></a>
</h3>
<p>To ensure causal identification, we extend the standard RD assumptions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Continuity of Potential Outcomes</strong>
<ul>
<li>The expected potential outcomes <span class="math inline">\(E[Y(0)|X]\)</span> and <span class="math inline">\(E[Y(1)|X]\)</span> are smooth functions of <span class="math inline">\(X\)</span> at each cutoff <span class="math inline">\(C_i\)</span>.</li>
<li>Formally: <span class="math display">\[
\lim_{x \uparrow C_i} E[Y(0)|X=x, C_i=c] = \lim_{x \downarrow C_i} E[Y(0)|X=x, C_i=c].
\]</span>
</li>
</ul>
</li>
<li>
<strong>No Manipulation of the Running Variable</strong>
<ul>
<li>The density of <span class="math inline">\(X_i\)</span> must be continuous at each <span class="math inline">\(C_i\)</span>, ensuring that individuals cannot selectively sort above or below their assigned cutoff.</li>
</ul>
</li>
<li>
<strong>Local Randomization</strong>
<ul>
<li>Near each cutoff, units are <strong>as-good-as-randomly assigned</strong> to treatment or control.</li>
</ul>
</li>
<li>
<strong>Independence Across Cutoffs</strong>
<ul>
<li>The cutoff assignment rule should be exogenous and not correlated with unobserved determinants of <span class="math inline">\(Y\)</span>.</li>
</ul>
</li>
</ol>
<p>If these assumptions hold, each cutoff provides a valid local treatment effect estimate.</p>
</div>
<div id="estimation-approaches" class="section level3" number="27.9.3">
<h3>
<span class="header-section-number">27.9.3</span> Estimation Approaches<a class="anchor" aria-label="anchor" href="#estimation-approaches"><i class="fas fa-link"></i></a>
</h3>
<div id="pooling-cutoffs-with-fixed-effects" class="section level4" number="27.9.3.1">
<h4>
<span class="header-section-number">27.9.3.1</span> Pooling Cutoffs with Fixed Effects<a class="anchor" aria-label="anchor" href="#pooling-cutoffs-with-fixed-effects"><i class="fas fa-link"></i></a>
</h4>
<p>A straightforward way to estimate multi-cutoff RD is to include <strong>cutoff fixed effects</strong>:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta (X_i - C_i) + \tau D_i + \gamma C_i + \epsilon_i.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\tau\)</span> captures the <strong>average treatment effect across all cutoffs</strong>.</p></li>
<li><p><span class="math inline">\(C_i\)</span> is included as a <strong>fixed effect</strong> to account for different intercepts across groups.</p></li>
</ul>
</div>
<div id="separate-rd-estimation-for-each-cutoff" class="section level4" number="27.9.3.2">
<h4>
<span class="header-section-number">27.9.3.2</span> Separate RD Estimation for Each Cutoff<a class="anchor" aria-label="anchor" href="#separate-rd-estimation-for-each-cutoff"><i class="fas fa-link"></i></a>
</h4>
<p>Instead of pooling, we can estimate <strong>separate RD effects for each</strong> <span class="math inline">\(C_i\)</span>:</p>
<p><span class="math display">\[
\tau_c = \lim_{x \downarrow C_i}E[Y|X = x, C_i = c] - \lim_{x \uparrow C_i} E[Y|X = x, C_i = c].
\]</span></p>
<p>This approach allows for <strong>heterogeneous treatment effects</strong>.</p>
</div>
<div id="interaction-model-for-heterogeneous-effects" class="section level4" number="27.9.3.3">
<h4>
<span class="header-section-number">27.9.3.3</span> Interaction Model for Heterogeneous Effects<a class="anchor" aria-label="anchor" href="#interaction-model-for-heterogeneous-effects"><i class="fas fa-link"></i></a>
</h4>
<p>To estimate how treatment effects vary with <span class="math inline">\(C_i\)</span>, we interact <span class="math inline">\(D_i\)</span> with <span class="math inline">\(C_i\)</span>:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta (X_i - C_i) + \tau D_i + \lambda D_i C_i + \epsilon_i.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\lambda\)</span> captures how the treatment effect varies with the cutoff.</p></li>
<li><p>A significant <span class="math inline">\(\lambda\)</span> implies that <span class="math inline">\(\tau(x, c)\)</span> is not constant across cutoffs.</p></li>
</ul>
</div>
<div id="nonparametric-local-estimation" class="section level4" number="27.9.3.4">
<h4>
<span class="header-section-number">27.9.3.4</span> Nonparametric Local Estimation<a class="anchor" aria-label="anchor" href="#nonparametric-local-estimation"><i class="fas fa-link"></i></a>
</h4>
<p>A fully flexible approach estimates <span class="math inline">\(\tau(x, c)\)</span> separately at each cutoff using kernel-based methods:</p>
<p><span class="math display">\[
\hat{\tau}(c) = \frac{\sum_{i=1}^{n} K_h (X_i - C_i) D_i Y_i}{\sum_{i=1}^{n} K_h (X_i - C_i) D_i} - \frac{\sum_{i=1}^{n} K_h (X_i - C_i) (1 - D_i) Y_i}{\sum_{i=1}^{n} K_h (X_i - C_i) (1 - D_i)}.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(K_h(\cdot)\)</span> is a kernel function (e.g., Epanechnikov).</p></li>
<li><p><span class="math inline">\(h\)</span> is the bandwidth, chosen via cross-validation.</p></li>
</ul>
</div>
</div>
<div id="robustness-checks-2" class="section level3" number="27.9.4">
<h3>
<span class="header-section-number">27.9.4</span> Robustness Checks<a class="anchor" aria-label="anchor" href="#robustness-checks-2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li><strong>Covariate Balance at Each Cutoff</strong></li>
</ol>
<ul>
<li><p>Test whether pre-treatment covariates show jumps at each <span class="math inline">\(C_i\)</span>.</p></li>
<li>
<p>Run placebo RD regressions on covariates:</p>
<p><span class="math display">\[
W_i = \alpha + \beta (X_i - C_i) + \gamma D_i + \epsilon_i.
\]</span></p>
</li>
<li><p>A significant <span class="math inline">\(\gamma\)</span> suggests that RD assumptions are violated.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>McCrary Density Test</strong></li>
</ol>
<ul>
<li>
<p>Perform a McCrary test separately at each cutoff to check for manipulation:</p>
<p><span class="math display">\[
f(X) \text{ should be continuous at } X = C_i.
\]</span></p>
</li>
<li><p>If discontinuities exist, individuals may be sorting around cutoffs.</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><strong>Placebo Cutoffs</strong></li>
</ol>
<ul>
<li>Implement fake cutoffs and re-estimate <span class="math inline">\(\tau(x, c)\)</span>.</li>
<li>If significant effects appear, the RD estimates may be biased.</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li><strong>Varying Bandwidths</strong></li>
</ol>
<ul>
<li>Re-estimate treatment effects using different bandwidths.</li>
<li>If <span class="math inline">\(\hat{\tau}(x,c)\)</span> changes drastically, it suggests sensitivity to bandwidth choice.</li>
</ul>
</div>
</div>
<div id="sec-multi-score-regression-discontinuity-design" class="section level2" number="27.10">
<h2>
<span class="header-section-number">27.10</span> Multi-Score Regression Discontinuity Design<a class="anchor" aria-label="anchor" href="#sec-multi-score-regression-discontinuity-design"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>Multi-Score Regression Discontinuity Design</strong> extends the <strong>standard single-score RD</strong> and <a href="sec-regression-discontinuity.html#sec-multi-cutoff-regression-discontinuity-design">the multi-cutoff RD</a> by introducing multiple running variables that simultaneously determine treatment eligibility. Instead of relying on a single threshold for assignment, treatment now depends on a <strong>combination of multiple continuous scores</strong> crossing predetermined cutoffs.</p>
<p>Multi-score RD is relevant when policy eligibility is based on multiple criteria, such as:</p>
<ul>
<li><p><strong>Education</strong>: Honors program admission based on both math and English scores.</p></li>
<li><p><strong>Healthcare</strong>: Medical trial eligibility based on both BMI and blood pressure levels.</p></li>
<li><p><strong>Taxation</strong>: Tax incentives based on income level and household size.</p></li>
</ul>
<div id="general-framework" class="section level3" number="27.10.1">
<h3>
<span class="header-section-number">27.10.1</span> General Framework<a class="anchor" aria-label="anchor" href="#general-framework"><i class="fas fa-link"></i></a>
</h3>
<p>Each individual <span class="math inline">\(i\)</span> has:</p>
<ul>
<li><p>Two running variables, <span class="math inline">\(X_{1i}\)</span> and <span class="math inline">\(X_{2i}\)</span>.</p></li>
<li><p>Two predetermined cutoffs, <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_2\)</span>.</p></li>
<li><p>A binary treatment indicator <span class="math inline">\(D_i\)</span>, assigned based on whether the individual’s scores exceed both thresholds.</p></li>
</ul>
<p>The treatment effect is defined as:</p>
<p><span class="math display">\[
\tau (x_1, x_2) = E[Y_{1i} - Y_{0i} | X_{1i} = x_1, X_{2i} = x_2].
\]</span></p>
<p>This represents the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">local average treatment effect</a> in a two-dimensional RD setting.</p>
</div>
<div id="identification-1" class="section level3" number="27.10.2">
<h3>
<span class="header-section-number">27.10.2</span> Identification<a class="anchor" aria-label="anchor" href="#identification-1"><i class="fas fa-link"></i></a>
</h3>
<p>Under the potential outcomes framework, for each individual <span class="math inline">\(i\)</span>, we define:</p>
<ul>
<li><p><span class="math inline">\(Y_{1i}\)</span>: Potential outcome under treatment.</p></li>
<li><p><span class="math inline">\(Y_{0i}\)</span>: Potential outcome under control.</p></li>
<li><p><span class="math inline">\(D_i\)</span>: Treatment assignment rule.</p></li>
</ul>
<p>The observed outcome is:</p>
<p><span class="math display">\[
Y_i = D_i Y_{1i} + (1 - D_i) Y_{0i}.
\]</span></p>
<p>The treatment assignment mechanism follows:</p>
<p><span class="math display">\[
D_i =
\begin{cases}
1 &amp; \text{if } X_{1i} \geq C_1 \text{ and } X_{2i} \geq C_2, \\
0 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
</div>
<div id="key-assumptions-2" class="section level3" number="27.10.3">
<h3>
<span class="header-section-number">27.10.3</span> Key Assumptions<a class="anchor" aria-label="anchor" href="#key-assumptions-2"><i class="fas fa-link"></i></a>
</h3>
<p>To ensure valid causal inference, the multi-score RD framework extends the standard RD assumptions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Continuity of Potential Outcomes in Both Running Variables</strong>
<ul>
<li>The expected potential outcomes <span class="math inline">\(E[Y(0) | X_1, X_2]\)</span> and <span class="math inline">\(E[Y(1) | X_1, X_2]\)</span> are smooth in both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</li>
<li>Formally: <span class="math display">\[
\lim_{(x_1, x_2) \to (C_1, C_2)^-} E[Y(0) | X_1 = x_1, X_2 = x_2] = \lim_{(x_1, x_2) \to (C_1, C_2)^+} E[Y(0) | X_1 = x_1, X_2 = x_2].
\]</span>
</li>
<li>Ensures that any observed discontinuity in <span class="math inline">\(E[Y | X_1, X_2]\)</span> is attributable to treatment.</li>
</ul>
</li>
<li>
<strong>No Manipulation of Running Variables</strong>
<ul>
<li>The density of <span class="math inline">\((X_1, X_2)\)</span> must be continuous at <span class="math inline">\((C_1, C_2)\)</span>.</li>
<li>No agents should be able to precisely manipulate both scores to cross the threshold.</li>
</ul>
</li>
<li>
<strong>Local Randomization</strong>
<ul>
<li>Near <span class="math inline">\((C_1, C_2)\)</span>, units are <strong>as good as randomly assigned</strong> to treatment or control.</li>
</ul>
</li>
<li>
<strong>No Interaction Effects in Running Variables</strong> (optional)
<ul>
<li>In some models, we assume that the effect of crossing <span class="math inline">\(C_1\)</span> does not depend on <span class="math inline">\(C_2\)</span> and vice versa.</li>
</ul>
</li>
</ol>
<p>If these assumptions hold, the treatment effect is identified as the discontinuity in <span class="math inline">\(E[Y | X_1, X_2]\)</span> at <span class="math inline">\((C_1, C_2)\)</span>.</p>
</div>
<div id="estimation-approaches-1" class="section level3" number="27.10.4">
<h3>
<span class="header-section-number">27.10.4</span> Estimation Approaches<a class="anchor" aria-label="anchor" href="#estimation-approaches-1"><i class="fas fa-link"></i></a>
</h3>
<div id="local-linear-regression-in-two-dimensions" class="section level4" number="27.10.4.1">
<h4>
<span class="header-section-number">27.10.4.1</span> Local Linear Regression in Two Dimensions<a class="anchor" aria-label="anchor" href="#local-linear-regression-in-two-dimensions"><i class="fas fa-link"></i></a>
</h4>
<p>The simplest approach is to estimate separate regressions <strong>on each side of the cutoff in both dimensions</strong>:</p>
<p>For observations <strong>below the threshold</strong> <span class="math inline">\((C_1, C_2)\)</span>:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta_1 (X_{1i} - C_1) + \beta_2 (X_{2i} - C_2) + \epsilon_i.
\]</span></p>
<p>For observations <strong>above the threshold</strong> <span class="math inline">\((C_1, C_2)\)</span>:</p>
<p><span class="math display">\[
Y_i = \gamma + \delta_1 (X_{1i} - C_1) + \delta_2 (X_{2i} - C_2) + \tau D_i + \nu_i.
\]</span></p>
<p>The treatment effect <span class="math inline">\(\tau\)</span> is estimated as:</p>
<p><span class="math display">\[
\hat{\tau} = \hat{E}[Y | X_1 = C_1^+, X_2 = C_2^+] - \hat{E}[Y | X_1 = C_1^-, X_2 = C_2^-].
\]</span></p>
<p>This approach assumes <strong>local linearity</strong>, but higher-order polynomials can be used:</p>
<p><span class="math display">\[
Y_i = \alpha + \sum_{k=1}^{K} \beta_k (X_{1i} - C_1)^k + \sum_{k=1}^{K} \gamma_k (X_{2i} - C_2)^k + \tau D_i + \epsilon_i.
\]</span></p>
</div>
<div id="kernel-weighted-estimation" class="section level4" number="27.10.4.2">
<h4>
<span class="header-section-number">27.10.4.2</span> Kernel-Weighted Estimation<a class="anchor" aria-label="anchor" href="#kernel-weighted-estimation"><i class="fas fa-link"></i></a>
</h4>
<p>A more flexible approach estimates <span class="math inline">\(\tau(x_1, x_2)\)</span> using nonparametric local regression:</p>
<p><span class="math display">\[
\hat{\tau}(x_1, x_2) = \frac{\sum_{i=1}^{n} K_h (X_{1i} - x_1) K_h (X_{2i} - x_2) D_i Y_i}{\sum_{i=1}^{n} K_h (X_{1i} - x_1) K_h (X_{2i} - x_2) D_i}
- \frac{\sum_{i=1}^{n} K_h (X_{1i} - x_1) K_h (X_{2i} - x_2) (1 - D_i) Y_i}{\sum_{i=1}^{n} K_h (X_{1i} - x_1) K_h (X_{2i} - x_2) (1 - D_i)}.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(K_h(\cdot)\)</span> is a kernel function (e.g., Epanechnikov).</p></li>
<li><p><span class="math inline">\(h\)</span> is the bandwidth, selected via cross-validation.</p></li>
</ul>
</div>
<div id="interaction-model-for-heterogeneous-effects-1" class="section level4" number="27.10.4.3">
<h4>
<span class="header-section-number">27.10.4.3</span> Interaction Model for Heterogeneous Effects<a class="anchor" aria-label="anchor" href="#interaction-model-for-heterogeneous-effects-1"><i class="fas fa-link"></i></a>
</h4>
<p>To assess <strong>interaction effects between running variables</strong>, estimate:</p>
<p><span class="math display">\[
Y_i = \alpha + \beta_1 (X_{1i} - C_1) + \beta_2 (X_{2i} - C_2) + \tau D_i + \lambda D_i (X_{1i} - C_1)(X_{2i} - C_2) + \epsilon_i.
\]</span></p>
<ul>
<li>
<span class="math inline">\(\lambda\)</span> captures whether the treatment effect depends on both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</li>
</ul>
</div>
</div>
<div id="robustness-checks-3" class="section level3" number="27.10.5">
<h3>
<span class="header-section-number">27.10.5</span> Robustness Checks<a class="anchor" aria-label="anchor" href="#robustness-checks-3"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Covariate Balance in Both Dimensions</strong>
<ul>
<li>Test whether pre-treatment covariates jump at <span class="math inline">\((C_1, C_2)\)</span>.</li>
</ul>
</li>
<li>
<strong>McCrary Density Test in Two Dimensions</strong>
<ul>
<li>Verify that density of <span class="math inline">\((X_1, X_2)\)</span> is smooth at <span class="math inline">\((C_1, C_2)\)</span>.</li>
</ul>
</li>
<li>
<strong>Placebo Cutoffs</strong>
<ul>
<li>Implement fake cutoffs and re-estimate <span class="math inline">\(\tau(x_1, x_2)\)</span>.</li>
</ul>
</li>
<li>
<strong>Varying Bandwidths</strong>
<ul>
<li>Re-estimate using different bandwidths for robustness.</li>
</ul>
</li>
</ol>
</div>
</div>
<div id="evaluation-of-a-regression-discontinuity-design" class="section level2" number="27.11">
<h2>
<span class="header-section-number">27.11</span> Evaluation of a Regression Discontinuity Design<a class="anchor" aria-label="anchor" href="#evaluation-of-a-regression-discontinuity-design"><i class="fas fa-link"></i></a>
</h2>
<p>After estimating an RD model, it is crucial to evaluate whether the assumptions hold and whether the results are robust to different specifications. The key aspects of RD evaluation include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Graphical and formal evidence</strong> for a discontinuity in treatment and outcome variables.</li>
<li>
<strong>Validation of RD assumptions</strong>, including:
<ul>
<li>The absence of discontinuities in pre-treatment covariates.</li>
<li>No manipulation of the assignment variable.</li>
</ul>
</li>
<li>
<strong>Robustness checks</strong> for functional form and bandwidth choice.</li>
<li>
<strong>External validity</strong>: assessing whether results generalize beyond the cutoff.</li>
</ol>
<p>A well-implemented RD should demonstrate a clear treatment effect at the cutoff while ensuring that no other discontinuous changes confound the effect.</p>
<div id="graphical-and-formal-evidence" class="section level3" number="27.11.1">
<h3>
<span class="header-section-number">27.11.1</span> Graphical and Formal Evidence<a class="anchor" aria-label="anchor" href="#graphical-and-formal-evidence"><i class="fas fa-link"></i></a>
</h3>
<div id="visual-inspection-of-the-rd-effect" class="section level4" number="27.11.1.1">
<h4>
<span class="header-section-number">27.11.1.1</span> Visual Inspection of the RD Effect<a class="anchor" aria-label="anchor" href="#visual-inspection-of-the-rd-effect"><i class="fas fa-link"></i></a>
</h4>
<p>A fundamental step in RD analysis is to plot the outcome variable against the running variable:</p>
<ul>
<li>Compute binned averages of <span class="math inline">\(Y_i\)</span> for small intervals of <span class="math inline">\(X_i\)</span>.</li>
<li>Overlay a smoothed polynomial regression separately for <span class="math inline">\(X &lt; c\)</span> and <span class="math inline">\(X \geq c\)</span>.</li>
<li>A visible jump at <span class="math inline">\(X = c\)</span> provides initial evidence of a treatment effect.</li>
</ul>
<p>Additionally, plotting treatment probability <span class="math inline">\(P(D = 1 | X)\)</span> ensures that assignment follows the expected RD rule.</p>
</div>
<div id="no-discontinuity-in-pre-treatment-covariates" class="section level4" number="27.11.1.2">
<h4>
<span class="header-section-number">27.11.1.2</span> No Discontinuity in Pre-Treatment Covariates<a class="anchor" aria-label="anchor" href="#no-discontinuity-in-pre-treatment-covariates"><i class="fas fa-link"></i></a>
</h4>
<p>To rule out omitted variable bias, we check whether other covariates (age, education, prior test scores, etc.) exhibit jumps at the cutoff.</p>
<p>For each covariate <span class="math inline">\(W_i\)</span>, estimate:</p>
<p><span class="math display">\[
W_i = \alpha + f(X_i) \beta + \tau D_i + \epsilon_i.
\]</span></p>
<ul>
<li>If <span class="math inline">\(\tau\)</span> is statistically significant, it suggests a violation of RD assumptions.</li>
<li>Covariate jumps imply that factors other than treatment may be driving the observed outcome change.</li>
</ul>
</div>
<div id="manipulation-test-mccrary-density-test" class="section level4" number="27.11.1.3">
<h4>
<span class="header-section-number">27.11.1.3</span> Manipulation Test (McCrary Density Test)<a class="anchor" aria-label="anchor" href="#manipulation-test-mccrary-density-test"><i class="fas fa-link"></i></a>
</h4>
<p>A critical assumption in RD is that units cannot precisely manipulate their values of <span class="math inline">\(X_i\)</span>. If individuals can selectively sort around <span class="math inline">\(c\)</span> (e.g., students altering test scores to qualify for a scholarship), RD estimates become invalid.</p>
<p>To test for manipulation, we estimate the density function of <span class="math inline">\(X\)</span> and test for a discontinuity at <span class="math inline">\(c\)</span>:</p>
<p><span class="math display">\[
\hat{f}(X) = \lim_{x \uparrow c} f(X) - \lim_{x \downarrow c} f(X).
\]</span></p>
<p>A significant difference suggests sorting behavior, which violates RD assumptions.</p>
</div>
</div>
<div id="functional-form-of-the-running-variable" class="section level3" number="27.11.2">
<h3>
<span class="header-section-number">27.11.2</span> Functional Form of the Running Variable<a class="anchor" aria-label="anchor" href="#functional-form-of-the-running-variable"><i class="fas fa-link"></i></a>
</h3>
<div id="general-rd-model" class="section level4" number="27.11.2.1">
<h4>
<span class="header-section-number">27.11.2.1</span> General RD Model<a class="anchor" aria-label="anchor" href="#general-rd-model"><i class="fas fa-link"></i></a>
</h4>
<p>The most flexible RD specification includes:</p>
<ul>
<li><p>A functional form <span class="math inline">\(f(X_i)\)</span> to account for trends.</p></li>
<li><p>An indicator for treatment <span class="math inline">\(D_i\)</span>. - An interaction term <span class="math inline">\(D_i f(X_i)\)</span> allowing for different slopes on each side.</p></li>
</ul>
<p><span class="math display">\[
Y_i = \alpha_0 + f(X_i) \alpha_1 + I(X_i \geq c) \alpha_2 + f(X_i) I(X_i \geq c) \alpha_3 + u_i.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\alpha_2\)</span> captures the treatment effect at <span class="math inline">\(X = c\)</span>.</p></li>
<li><p><span class="math inline">\(\alpha_3\)</span> tests for differences in slopes across the threshold.</p></li>
</ul>
</div>
<div id="simple-case-linear-rd" class="section level4" number="27.11.2.2">
<h4>
<span class="header-section-number">27.11.2.2</span> Simple Case: Linear RD<a class="anchor" aria-label="anchor" href="#simple-case-linear-rd"><i class="fas fa-link"></i></a>
</h4>
<p>If <span class="math inline">\(f(X_i)\)</span> is a linear function, we estimate:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + I(X_i \geq c) \beta_2 + \epsilon_i.
\]</span></p>
<div class="inline-figure"><img src="images/rd1.PNG" style="display: block; margin: 1em auto" width="600" height="300"></div>
<p>RD gives you <span class="math inline">\(\beta_2\)</span> (causal effect) of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> at the cutoff point</p>
<p>In practice, everyone does</p>
<p><span class="math display">\[ Y_i = \alpha_0 + f(x) \alpha _1 + [I(x_i \ge c)]\alpha_2 + [f(x_i)\times [I(x_i \ge c)]\alpha_3 + u_i \]</span></p>
<div class="inline-figure"><img src="images/rd2.PNG" style="display: block; margin: 1em auto" width="600" height="300"></div>
<p>where we estimate different slope on different sides of the line. And if you estimate <span class="math inline">\(\alpha_3\)</span> to be no different from 0 then we return to the simple case.</p>
</div>
<div id="higher-order-polynomials" class="section level4" number="27.11.2.3">
<h4>
<span class="header-section-number">27.11.2.3</span> Higher-Order Polynomials<a class="anchor" aria-label="anchor" href="#higher-order-polynomials"><i class="fas fa-link"></i></a>
</h4>
<p>A more flexible specification allows for nonlinear relationships:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \beta_2 X_i^2 + \beta_3 X_i^3 + \tau D_i + \epsilon_i.
\]</span></p>
<ul>
<li>Higher-order polynomials reduce bias but increase variance.</li>
<li>Overfitting is a risk, especially with limited data near <span class="math inline">\(c\)</span>.</li>
</ul>
</div>
<div id="nonparametric-estimation" class="section level4" number="27.11.2.4">
<h4>
<span class="header-section-number">27.11.2.4</span> Nonparametric Estimation<a class="anchor" aria-label="anchor" href="#nonparametric-estimation"><i class="fas fa-link"></i></a>
</h4>
<p>When polynomial models are too restrictive, we use nonparametric <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a>:</p>
<p><span class="math display">\[
\hat{E}[Y | X] = \sum_{i=1}^{n} K_h(X_i - c) Y_i.
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(K_h(X)\)</span> is a kernel function (e.g., Epanechnikov).</p></li>
<li><p><span class="math inline">\(h\)</span> is the bandwidth, chosen to optimize bias-variance tradeoff.</p></li>
</ul>
</div>
</div>
<div id="bandwidth-selection-2" class="section level3" number="27.11.3">
<h3>
<span class="header-section-number">27.11.3</span> Bandwidth Selection<a class="anchor" aria-label="anchor" href="#bandwidth-selection-2"><i class="fas fa-link"></i></a>
</h3>
<div id="tradeoff-between-bias-and-efficiency" class="section level4" number="27.11.3.1">
<h4>
<span class="header-section-number">27.11.3.1</span> Tradeoff Between Bias and Efficiency<a class="anchor" aria-label="anchor" href="#tradeoff-between-bias-and-efficiency"><i class="fas fa-link"></i></a>
</h4>
<p>Choosing an appropriate bandwidth <span class="math inline">\(h\)</span> is crucial:</p>
<ul>
<li><p>Narrow <span class="math inline">\(h\)</span> (close to <span class="math inline">\(c\)</span>): Lower bias, but high variance.</p></li>
<li><p>Wider <span class="math inline">\(h\)</span>: More efficient estimates but potential bias.</p></li>
</ul>
</div>
<div id="optimal-bandwidth-selection" class="section level4" number="27.11.3.2">
<h4>
<span class="header-section-number">27.11.3.2</span> Optimal Bandwidth Selection<a class="anchor" aria-label="anchor" href="#optimal-bandwidth-selection"><i class="fas fa-link"></i></a>
</h4>
<p>Several methods exist for selecting <span class="math inline">\(h\)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Cross-validation</strong>: Minimizing mean squared error (MSE).</li>
<li>
<span class="citation">G. Imbens and Kalyanaraman (<a href="references.html#ref-imbens2012optimal">2012</a>)</span> bandwidth selection:
<ul>
<li>Balances bias-variance tradeoff.</li>
<li>Often reported in RD studies.</li>
</ul>
</li>
<li>
<span class="citation">Cattaneo, Idrobo, and Titiunik (<a href="references.html#ref-cattaneo2019practical">2019</a>)</span> robust bandwidth selection:
<ul>
<li>Focuses on valid inference, not just point estimation.</li>
</ul>
</li>
</ol>
</div>
<div id="bandwidth-sensitivity-analysis" class="section level4" number="27.11.3.3">
<h4>
<span class="header-section-number">27.11.3.3</span> Bandwidth Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#bandwidth-sensitivity-analysis"><i class="fas fa-link"></i></a>
</h4>
<p>A standard robustness check is estimating <span class="math inline">\(\tau\)</span> for different <span class="math inline">\(h\)</span> values:</p>
<ul>
<li>If results change drastically, estimates may be sensitive to bandwidth choice.</li>
<li>If estimates remain stable, findings are more credible.</li>
</ul>
</div>
</div>
<div id="addressing-potential-confounders" class="section level3" number="27.11.4">
<h3>
<span class="header-section-number">27.11.4</span> Addressing Potential Confounders<a class="anchor" aria-label="anchor" href="#addressing-potential-confounders"><i class="fas fa-link"></i></a>
</h3>
<div id="multiple-running-variables" class="section level4" number="27.11.4.1">
<h4>
<span class="header-section-number">27.11.4.1</span> Multiple Running Variables<a class="anchor" aria-label="anchor" href="#multiple-running-variables"><i class="fas fa-link"></i></a>
</h4>
<p>If multiple forcing variables influence treatment (e.g., both math and English scores for honors eligibility), failing to account for them may introduce confounding.</p>
<p>A solution is to extend RD to a <a href="sec-regression-discontinuity.html#sec-multi-score-regression-discontinuity-design">multi-score framework</a>:</p>
<p><span class="math display">\[
Y_i = \alpha_0 + f(X_{1i}, X_{2i}) \alpha_1 + I(X_{1i} \geq c_1, X_{2i} \geq c_2) \alpha_2 + \epsilon_i.
\]</span></p>
<ul>
<li>Controls for both scores simultaneously.</li>
<li>Allows for interactions between assignment variables.</li>
</ul>
</div>
<div id="bundling-of-institutions" class="section level4" number="27.11.4.2">
<h4>
<span class="header-section-number">27.11.4.2</span> Bundling of Institutions<a class="anchor" aria-label="anchor" href="#bundling-of-institutions"><i class="fas fa-link"></i></a>
</h4>
<p>In cases where policies change at institutional levels (e.g., different states implementing varying minimum wages), treatment effects may reflect <strong>institutional bundling</strong> rather than individual cutoff effects.</p>
<p>One solution is to include <strong>institution fixed effects</strong>:</p>
<p><span class="math display">\[
Y_i = \alpha + f(X_i) \beta + \tau D_i + \gamma C_j + \epsilon_i.
\]</span></p>
<p>where <span class="math inline">\(C_j\)</span> is a categorical variable for institution <span class="math inline">\(j\)</span>.</p>
</div>
</div>
<div id="external-validity-in-rd" class="section level3" number="27.11.5">
<h3>
<span class="header-section-number">27.11.5</span> External Validity in RD<a class="anchor" aria-label="anchor" href="#external-validity-in-rd"><i class="fas fa-link"></i></a>
</h3>
<p>While RD provides strong internal validity, its generalizability is often limited:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Local Nature of RD Estimates</strong>
<ul>
<li>RD estimates apply only at the cutoff.</li>
<li>Effects may not extrapolate to other values of <span class="math inline">\(X\)</span>.</li>
</ul>
</li>
<li>
<strong>Heterogeneous Treatment Effects</strong>
<ul>
<li>If <span class="math inline">\(\tau\)</span> varies across subgroups, RD estimates may not generalize.</li>
</ul>
</li>
<li>
<strong>Spillover Effects</strong>
<ul>
<li>If treatment effects extend beyond the threshold (e.g., peer effects), RD assumptions may be violated.</li>
</ul>
</li>
</ol>
</div>
</div>
<div id="applications-of-rd-designs" class="section level2" number="27.12">
<h2>
<span class="header-section-number">27.12</span> Applications of RD Designs<a class="anchor" aria-label="anchor" href="#applications-of-rd-designs"><i class="fas fa-link"></i></a>
</h2>
<p>Regression Discontinuity (RD) designs have widespread applications in empirical research across <strong>economics, political science, marketing, and public policy</strong>. These applications leverage <strong>threshold-based decision rules</strong> to identify causal effects in real-world settings where <strong>randomized experiments</strong> are infeasible.</p>
<p>Key applications include:</p>
<ul>
<li><p><strong>Marketing</strong>: Estimating the causal effects of promotions and advertising intensity.</p></li>
<li><p><strong>Education</strong>: Evaluating the impact of financial aid or merit scholarships.</p></li>
<li><p><strong>Healthcare</strong>: Assessing the effect of medical interventions assigned based on eligibility thresholds.</p></li>
<li><p><strong>Labor Economics</strong>: Studying unemployment benefits and wage policies.</p></li>
</ul>
<div id="applications-in-marketing" class="section level3" number="27.12.1">
<h3>
<span class="header-section-number">27.12.1</span> Applications in Marketing<a class="anchor" aria-label="anchor" href="#applications-in-marketing"><i class="fas fa-link"></i></a>
</h3>
<p>RD has been widely applied in marketing research to estimate <strong>causal effects of pricing, advertising, and product positioning</strong>.</p>
<ol style="list-style-type: decimal">
<li><strong>Position Effects in Advertising</strong></li>
</ol>
<p><span class="citation">(<a href="references.html#ref-narayanan2015position">Narayanan and Kalyanam 2015</a>)</span> uses an RD approach to estimate the causal impact of advertisement placement in search engines. Since ad placement follows an auction-based system, a discontinuity occurs where the top-ranked ad receives disproportionately more clicks than lower-ranked ads.</p>
<p>Key insights:</p>
<ul>
<li><p>Higher-ranked ads generate more click-throughs, but this does not always translate into higher conversion rates.</p></li>
<li><p>The RD framework helps distinguish correlation from causation by leveraging the rank cutoff.</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><strong>Identifying Causal Marketing Mix Effects</strong></li>
</ol>
<p><span class="citation">(<a href="references.html#ref-hartmann2011identifying">Hartmann, Nair, and Narayanan 2011</a>)</span> presents a nonparametric RD estimation approach to identify causal effects of marketing mix variables, such as:</p>
<ul>
<li><p>Advertising budgets</p></li>
<li><p>Price changes</p></li>
<li><p>Promotional campaigns</p></li>
</ul>
<p>By comparing firms just above and below an expenditure threshold, the RD framework isolates the true causal impact of marketing spending on consumer behavior.</p>
</div>
<div id="r-packages-for-rd-estimation" class="section level3" number="27.12.2">
<h3>
<span class="header-section-number">27.12.2</span> R Packages for RD Estimation<a class="anchor" aria-label="anchor" href="#r-packages-for-rd-estimation"><i class="fas fa-link"></i></a>
</h3>
<p><strong>Key RD <a href="https://rdpackages.github.io/">Packages</a> in R</strong></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="22%">
<col width="22%">
<col width="31%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th><strong>Feature</strong></th>
<th><strong>rdd</strong></th>
<th><strong>rdrobust</strong></th>
<th><strong>rddtools</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Estimator</strong></td>
<td>Local linear regression</td>
<td>Local polynomial regression</td>
<td>Local polynomial regression</td>
</tr>
<tr class="even">
<td><strong>Bandwidth Selection</strong></td>
<td><span class="citation">(<a href="references.html#ref-imbens2012optimal">G. Imbens and Kalyanaraman 2012</a>)</span></td>
<td><span class="citation">(<a href="references.html#ref-calonico2014robust">Calonico, Cattaneo, and Titiunik 2014</a>; <a href="references.html#ref-imbens2012optimal">G. Imbens and Kalyanaraman 2012</a> ; <a href="references.html#ref-calonico2020optimal">Calonico, Cattaneo, and Farrell 2020</a>)</span></td>
<td><span class="citation">(<a href="references.html#ref-imbens2012optimal">G. Imbens and Kalyanaraman 2012</a>)</span></td>
</tr>
<tr class="odd">
<td><strong>Kernel Functions</strong></td>
<td>Epanechnikov, Gaussian</td>
<td>Epanechnikov</td>
<td>Gaussian</td>
</tr>
<tr class="even">
<td><strong>Bias Correction</strong></td>
<td>No</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="odd">
<td><strong>Covariate Inclusion</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="even">
<td><strong>Assumption Testing</strong></td>
<td>McCrary Sorting Test</td>
<td>No</td>
<td>McCrary Sorting, Covariate Distribution Tests</td>
</tr>
</tbody>
</table></div>
<p>For a detailed comparison, see <span class="citation">(<a href="references.html#ref-thoemmes2017analysis">Thoemmes, Liao, and Jin 2017</a>)</span> (Table 1, p. 347).</p>
<div id="specialized-rd-packages" class="section level4" number="27.12.2.1">
<h4>
<span class="header-section-number">27.12.2.1</span> Specialized RD Packages<a class="anchor" aria-label="anchor" href="#specialized-rd-packages"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code>rddensity</code>: Tests for discontinuities in the density of the running variable (useful for manipulation/bunching detection).</li>
<li>
<code>rdlocrand</code>: Implements randomization-based inference for RD.</li>
<li>
<code>rdmulti</code>: Extends RD to multiple cutoffs and multiple scores.</li>
<li>
<code>rdpower</code>: Conducts power calculations and sample selection for RD designs.</li>
</ul>
<p><strong>Why Use <code>rdrobust</code>?</strong></p>
<ul>
<li>Implements <a href="sec-nonparametric-regression.html#sec-local-polynomial-regression">local polynomial regression</a>, providing bias correction and robust standard errors.</li>
<li>Uses state-of-the-art bandwidth selection methods.</li>
<li>Produces automatic RD plots for visualization.</li>
</ul>
</div>
</div>
<div id="example-of-regression-discontinuity-in-education" class="section level3" number="27.12.3">
<h3>
<span class="header-section-number">27.12.3</span> Example of Regression Discontinuity in Education<a class="anchor" aria-label="anchor" href="#example-of-regression-discontinuity-in-education"><i class="fas fa-link"></i></a>
</h3>
<p>We illustrate a Sharp RD using a simulated example of college GPA and future career success.</p>
<p>Setup:</p>
<ul>
<li><p>Students qualify for a prestigious internship if their GPA ≥ 3.5.</p></li>
<li><p>The outcome variable is future career success (e.g., salary).</p></li>
<li><p>RD estimates the causal impact of the internship program on earnings.</p></li>
</ul>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \beta_2 W_i + u_i
\]</span></p>
<p><span class="math display">\[
X_i =
\begin{cases}
1, W_i \ge c \\
0, W_i &lt; c
\end{cases}
\]</span></p>
<p>We simulate 100 observations, where GPA is the forcing variable and career success depends on GPA and the treatment effect.</p>
<div class="sourceCode" id="cb732"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Simulate GPA scores (0-4 scale)</span></span>
<span><span class="va">GPA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate future success with treatment effect at GPA &gt;= 3.5</span></span>
<span><span class="va">future_success</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">GPA</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="op">(</span><span class="va">GPA</span> <span class="op">&gt;=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load RD package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://qua.st/rddtools/">rddtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Format data for RD analysis</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddtools/man/rdd_data.html">rdd_data</a></span><span class="op">(</span><span class="va">future_success</span>, <span class="va">GPA</span>, cutpoint <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot RD scatterplot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, xlab <span class="op">=</span> <span class="st">"GPA"</span>, ylab <span class="op">=</span> <span class="st">"Future Success"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="27-regression-discontinuity_files/figure-html/unnamed-chunk-9-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>We estimate the Sharp RD treatment effect using <a href="sec-nonparametric-regression.html#sec-special-case-local-linear-regression">local linear regression</a>:</p>
<div class="sourceCode" id="cb733"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate the sharp RDD model</span></span>
<span><span class="va">rdd_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddtools/man/rdd_reg_lm.html">rdd_reg_lm</a></span><span class="op">(</span>rdd_object <span class="op">=</span> <span class="va">data</span>, slope <span class="op">=</span> <span class="st">"same"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rdd_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ ., data = dat_step1, weights = weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -3.08072 -0.54182  0.05352  0.54135  2.51267 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 17.21703    0.20060   85.83   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; D            9.79856    0.31716   30.89   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; x            2.14839    0.09914   21.67   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9284 on 97 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9746, Adjusted R-squared:  0.9741 </span></span>
<span><span class="co">#&gt; F-statistic:  1863 on 2 and 97 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Plot the RD regression line with binned observations:</p>
<div class="sourceCode" id="cb734"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot RD regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">rdd_mod</span>, cex <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlab <span class="op">=</span> <span class="st">"GPA"</span>, ylab <span class="op">=</span> <span class="st">"Future Success"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="27-regression-discontinuity_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>We verify whether results hold under different bandwidths and functional forms:</p>
<ol style="list-style-type: decimal">
<li>Varying the Bandwidth</li>
</ol>
<div class="sourceCode" id="cb735"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using rdrobust for robust estimation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rdrobust</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate RD with optimal bandwidth</span></span>
<span><span class="va">rd_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rdrobust/man/rdrobust.html">rdrobust</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">future_success</span>, x <span class="op">=</span> <span class="va">GPA</span>, c <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rd_out</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sharp RD estimates using local polynomial regression.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Obs.                  100</span></span>
<span><span class="co">#&gt; BW type                       mserd</span></span>
<span><span class="co">#&gt; Kernel                   Triangular</span></span>
<span><span class="co">#&gt; VCE method                       NN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Obs.                   83           17</span></span>
<span><span class="co">#&gt; Eff. Number of Obs.               7           12</span></span>
<span><span class="co">#&gt; Order est. (p)                    1            1</span></span>
<span><span class="co">#&gt; Order bias  (q)                   2            2</span></span>
<span><span class="co">#&gt; BW est. (h)                   0.361        0.361</span></span>
<span><span class="co">#&gt; BW bias (b)                   0.670        0.670</span></span>
<span><span class="co">#&gt; rho (h/b)                     0.540        0.540</span></span>
<span><span class="co">#&gt; Unique Obs.                      83           17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============================================================================</span></span>
<span><span class="co">#&gt;         Method     Coef. Std. Err.         z     P&gt;|z|      [ 95% C.I. ]       </span></span>
<span><span class="co">#&gt; =============================================================================</span></span>
<span><span class="co">#&gt;   Conventional    12.836     2.495     5.144     0.000     [7.945 , 17.727]    </span></span>
<span><span class="co">#&gt;         Robust         -         -     4.473     0.000     [7.677 , 19.653]    </span></span>
<span><span class="co">#&gt; =============================================================================</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>McCrary Test for Manipulation</li>
</ol>
<div class="sourceCode" id="cb736"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rddensity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for discontinuities in GPA distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rddensity/man/rddensity.html">rddensity</a></span><span class="op">(</span><span class="va">GPA</span>, c <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; rddensity.</span></span>
<span><span class="co">#&gt; Sample size: 100. Cutoff: 3.5.</span></span>
<span><span class="co">#&gt; Model: unrestricted. Kernel: triangular. VCE: jackknife</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Polynomial Functional Forms</li>
</ol>
<p>We compare linear and quadratic specifications:</p>
<div class="sourceCode" id="cb737"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate RD with a quadratic polynomial</span></span>
<span><span class="va">rdd_mod_quad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rddtools/man/rdd_reg_lm.html">rdd_reg_lm</a></span><span class="op">(</span>rdd_object <span class="op">=</span> <span class="va">data</span>, slope <span class="op">=</span> <span class="st">"separate"</span>, order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rdd_mod_quad</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = y ~ ., data = dat_step1, weights = weights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -3.06894 -0.52799  0.01642  0.55260  2.45318 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 17.30296    0.32241  53.667  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; D            9.14439    1.13752   8.039 2.65e-12 ***</span></span>
<span><span class="co">#&gt; x            2.29753    0.41955   5.476 3.61e-07 ***</span></span>
<span><span class="co">#&gt; `x^2`        0.04253    0.11228   0.379    0.706    </span></span>
<span><span class="co">#&gt; x_right      2.51976    9.23566   0.273    0.786    </span></span>
<span><span class="co">#&gt; `x^2_right` -1.61694   17.10035  -0.095    0.925    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9376 on 94 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9749, Adjusted R-squared:  0.9736 </span></span>
<span><span class="co">#&gt; F-statistic:   731 on 5 and 94 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
</div>
<div id="example-of-occupational-licensing-and-market-efficiency" class="section level3" number="27.12.4">
<h3>
<span class="header-section-number">27.12.4</span> Example of Occupational Licensing and Market Efficiency<a class="anchor" aria-label="anchor" href="#example-of-occupational-licensing-and-market-efficiency"><i class="fas fa-link"></i></a>
</h3>
<p>Occupational licensing is a form of labor market regulation that requires workers to obtain licenses or certifications before being allowed to work in specific professions. The debate around occupational licensing revolves around two competing effects:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Efficiency-enhancing effect</strong>:
<ul>
<li>Licensing ensures that workers meet minimum quality standards, reducing information asymmetries between firms and consumers.</li>
<li>Higher-quality service providers are selected into the labor market.</li>
</ul>
</li>
<li>
<strong>Barrier-to-entry effect</strong>:
<ul>
<li>Licensing requirements impose costs on potential entrants, reducing labor supply.</li>
<li>This creates frictions in the market, potentially leading to inefficiencies.</li>
</ul>
</li>
</ol>
<p><span class="citation">Bowblis and Smith (<a href="references.html#ref-bowblis2021occupational">2021</a>)</span> investigates this tradeoff using a <a href="sec-regression-discontinuity.html#sec-fuzzy-regression-discontinuity-design">Fuzzy RD</a> based on a threshold rule:</p>
<ul>
<li><p>Nursing homes with 120 or more beds are required to hire a certain fraction of licensed/certified workers.</p></li>
<li><p>The study examines whether this policy improves quality of care or merely restricts labor market competition.</p></li>
</ul>
<hr>
<div id="ols-estimation-naïve-approach-and-its-bias" class="section level4" number="27.12.4.1">
<h4>
<span class="header-section-number">27.12.4.1</span> <strong>OLS Estimation: Naïve Approach and Its Bias</strong><a class="anchor" aria-label="anchor" href="#ols-estimation-na%C3%AFve-approach-and-its-bias"><i class="fas fa-link"></i></a>
</h4>
<p>A simple <a href="linear-regression.html#ordinary-least-squares">Ordinary Least Squares</a> regression can be used to estimate the effect of licensed workers on quality of service:</p>
<p><span class="math display">\[
Y_i = \alpha_0 + X_i \alpha_1 + LW_i \alpha_2 + \epsilon_i
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> = Quality of service at facility <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(LW_i\)</span> = Proportion of licensed workers at facility <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(X_i\)</span> = Facility characteristics (e.g., size, staffing levels).</p></li>
</ul>
</div>
<div id="potential-bias-in-alpha_2" class="section level4" number="27.12.4.2">
<h4>
<span class="header-section-number">27.12.4.2</span> Potential Bias in <span class="math inline">\(\alpha_2\)</span><a class="anchor" aria-label="anchor" href="#potential-bias-in-alpha_2"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Mitigation-Based Bias:
<ul>
<li>Facilities with poor quality outcomes may hire more licensed workers in response to bad performance.</li>
<li>This induces a negative correlation between <span class="math inline">\(LW_i\)</span> and <span class="math inline">\(Y_i\)</span>, biasing <span class="math inline">\(\alpha_2\)</span> downward.</li>
</ul>
</li>
<li>Preference-Based Bias:
<ul>
<li>Higher-quality facilities may have greater incentives to hire certified workers.</li>
<li>This induces a positive correlation between <span class="math inline">\(LW_i\)</span> and <span class="math inline">\(Y_i\)</span>, biasing <span class="math inline">\(\alpha_2\)</span> upward.</li>
</ul>
</li>
</ol>
</div>
<div id="fuzzy-rd-framework" class="section level4" number="27.12.4.3">
<h4>
<span class="header-section-number">27.12.4.3</span> <strong>Fuzzy RD Framework</strong><a class="anchor" aria-label="anchor" href="#fuzzy-rd-framework"><i class="fas fa-link"></i></a>
</h4>
<p>The OLS model is endogenous, so we implement a <a href="sec-regression-discontinuity.html#sec-fuzzy-regression-discontinuity-design">Fuzzy RD Design</a> that exploits a discontinuity in licensing requirements at 120 beds.</p>
<p><span class="math display">\[
Y_{ist} = \beta_0 + [I(Bed \geq 121)_{ist}]\beta_1 + f(Size_{ist}) \beta_2 + [f(Size_{ist}) \times I(Bed \geq 121)_{ist}] \beta_3 + X_{it} \delta + \gamma_s + \theta_t + \epsilon_{ist}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(I(Bed \geq 121)\)</span> = Indicator for treatment eligibility (having at least 120 beds).</p></li>
<li><p><span class="math inline">\(f(Size_{ist})\)</span> = Flexible functional form of facility size.</p></li>
<li><p><span class="math inline">\(X_{it}\)</span> = Other control variables.</p></li>
<li><p><span class="math inline">\(\gamma_s\)</span> = State fixed effects (accounts for state-level regulations).</p></li>
<li><p><span class="math inline">\(\theta_t\)</span> = Time fixed effects (accounts for temporal shocks).</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> = Intent-to-treat (ITT) effect.</p></li>
</ul>
<p>This model estimates discontinuities in quality outcomes at the 120-bed threshold.</p>
<hr>
</div>
<div id="why-this-rd-is-fuzzy" class="section level4" number="27.12.4.4">
<h4>
<span class="header-section-number">27.12.4.4</span> <strong>Why This RD is Fuzzy</strong><a class="anchor" aria-label="anchor" href="#why-this-rd-is-fuzzy"><i class="fas fa-link"></i></a>
</h4>
<p>Unlike a <a href="sec-regression-discontinuity.html#sec-sharp-regression-discontinuity-design">Sharp RD</a>, treatment is not fully determined at the cutoff:</p>
<ul>
<li><p>Some facilities with fewer than 120 beds voluntarily hire licensed workers.</p></li>
<li><p>Some facilities with more than 120 beds may not comply fully.</p></li>
</ul>
<p>Thus, the RD framework must be modified:</p>
<ol style="list-style-type: decimal">
<li>Fixed-Effect Considerations:
<ul>
<li>If states sort differently near the threshold, state fixed effects (<span class="math inline">\(\gamma_s\)</span>) may be needed.</li>
<li>However, if sorting is non-random, the RD assumption fails.</li>
</ul>
</li>
</ol>
<!-- --><ol start="2" style="list-style-type: decimal">
<li>Panel Data Implications:
<ul>
<li>Fixed-effects models are not preferred in RD, as they are lower in the causal inference hierarchy.</li>
<li>RD typically excludes pre-treatment periods, whereas fixed-effects require before-and-after comparisons.</li>
</ul>
</li>
<li>Variation in Facility Size:
<ul>
<li>Hospitals rarely change bed capacity, so including hospital-specific fixed effects removes variation necessary for RD estimation.</li>
</ul>
</li>
</ol>
<hr>
</div>
<div id="instrumental-variable-approach" class="section level4" number="27.12.4.5">
<h4>
<span class="header-section-number">27.12.4.5</span> <strong>Instrumental Variable Approach</strong><a class="anchor" aria-label="anchor" href="#instrumental-variable-approach"><i class="fas fa-link"></i></a>
</h4>
<p>To correct for endogeneity, we use a two-stage least squares IV approach, where the running variable serves as an instrument for treatment intensity.</p>
<p><strong>Stage 1: First-Stage Regression</strong></p>
<p>Estimate the probability of hiring licensed workers based on the 120-bed threshold:</p>
<p><span class="math display">\[
QSW_{ist} = \alpha_0 + [I(Bed \geq 121)_{ist}]\alpha_1 + f(Size_{ist}) \alpha_2 + [f(Size_{ist}) \times I(Bed \geq 121)_{ist}] \alpha_3 + X_{it} \delta + \gamma_s + \theta_t + \epsilon_{ist}
\]</span></p>
<p>where:</p>
<ul>
<li>
<span class="math inline">\(QSW_{ist}\)</span> = Predicted proportion of licensed workers at facility <span class="math inline">\(i\)</span> in state <span class="math inline">\(s\)</span> at time <span class="math inline">\(t\)</span>.</li>
</ul>
<p><strong>Stage 2: Second-Stage Regression</strong></p>
<p>Estimate the causal effect of hiring licensed workers on quality of service:</p>
<p><span class="math display">\[
Y_{ist} = \gamma_0 + \gamma_1 \hat{QWS}_{ist} + f(Size_{ist}) \delta_2 + [f(Size_{ist}) \times I(Bed \geq 121)] \delta_3 + X_{it} \lambda + \eta_s + \tau_t + u_{ist}
\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\hat{QWS}_{ist}\)</span> = Instrumented proportion of licensed workers.</p></li>
<li><p><span class="math inline">\(\gamma_1\)</span> = Causal effect of certified staffing on quality outcomes.</p></li>
</ul>
<p><strong>Key Observations</strong></p>
<ul>
<li>The larger the discontinuity at 120 beds, the closer <span class="math inline">\(\gamma_1 \approx \beta_1\)</span>.</li>
<li>The ITT effect (<span class="math inline">\(\beta_1\)</span>) will always be weaker than the <a href="sec-causal-inference.html#sec-local-average-treatment-effects">local average treatment effect</a> (<span class="math inline">\(\gamma_1\)</span>).</li>
</ul>
<hr>
</div>
<div id="empirical-challenges" class="section level4" number="27.12.4.6">
<h4>
<span class="header-section-number">27.12.4.6</span> <strong>Empirical Challenges</strong><a class="anchor" aria-label="anchor" href="#empirical-challenges"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Bunching at Round Numbers</strong>:
<ul>
<li>Figure 1 shows facilities clustering at every 5-bed increment.</li>
<li>If manipulation occurs, we expect underrepresentation at 130 beds.</li>
</ul>
</li>
<li>
<strong>Clustering Standard Errors</strong>:
<ul>
<li>Due to limited unique mass points (facilities at specific sizes), errors should be clustered by mass point instead of individual facilities.</li>
</ul>
</li>
<li>
<strong>Noncompliance and Selection Bias</strong>:
<ul>
<li>Fuzzy RD requires that we do not drop non-compliers (as it would introduce selection bias).</li>
<li>However, we can drop manipulators if there is clear evidence of behavioral bias (e.g., preference for round numbers).</li>
</ul>
</li>
</ol>
<hr>
</div>
</div>
<div id="replicating-carpenter2009effect" class="section level3" number="27.12.5">
<h3>
<span class="header-section-number">27.12.5</span> Replicating <span class="citation">(<a href="references.html#ref-carpenter2009effect">Carpenter and Dobkin 2009</a>)</span><a class="anchor" aria-label="anchor" href="#replicating-carpenter2009effect"><i class="fas fa-link"></i></a>
</h3>
<p>A well-known RD study by <span class="citation">(<a href="references.html#ref-carpenter2009effect">Carpenter and Dobkin 2009</a>)</span> investigates the causal effect of legal drinking age on mortality rates.</p>
<p>Replication available at: <a href="https://rpubs.com/phle/r_tutorial_regression_discontinuity_design">Philipp Leppert</a>.</p>
<p>Data available at: <a href="https://www.openicpsr.org/openicpsr/project/113550/version/V1/view?flag=follow&amp;pageSize=100&amp;sortOrder=(?title)&amp;sortAsc=true">OpenICPSR</a>.</p>
<hr>
</div>
<div id="additional-rd-applications" class="section level3" number="27.12.6">
<h3>
<span class="header-section-number">27.12.6</span> Additional RD Applications<a class="anchor" aria-label="anchor" href="#additional-rd-applications"><i class="fas fa-link"></i></a>
</h3>
<p>For a comprehensive empirical RD application, see <span class="citation">(<a href="references.html#ref-thoemmes2017analysis">Thoemmes, Liao, and Jin 2017</a>)</span>, where:</p>
<ul>
<li><p>Multiple RD packages (<code>rdd</code>, <code>rdrobust</code>, <code>rddtools</code>) are tested.</p></li>
<li><p>Robustness checks are performed across bandwidth selection and polynomial orders.</p></li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="sec-quasi-experimental.html"><span class="header-section-number">26</span> Quasi-Experimental Methods</a></div>
<div class="next"><a href="temporal-discontinuity-designs.html"><span class="header-section-number">28</span> Temporal Discontinuity Designs</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-regression-discontinuity"><span class="header-section-number">27</span> Regression Discontinuity</a></li>
<li>
<a class="nav-link" href="#conceptual-framework"><span class="header-section-number">27.1</span> Conceptual Framework</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#types-of-regression-discontinuity-designs"><span class="header-section-number">27.1.1</span> Types of Regression Discontinuity Designs</a></li>
<li><a class="nav-link" href="#assumptions-for-rd-validity"><span class="header-section-number">27.1.2</span> Assumptions for RD Validity</a></li>
<li><a class="nav-link" href="#threats-to-rd-validity"><span class="header-section-number">27.1.3</span> Threats to RD Validity</a></li>
<li><a class="nav-link" href="#violation-of-continuity-in-covariates"><span class="header-section-number">27.1.4</span> Violation of Continuity in Covariates</a></li>
<li><a class="nav-link" href="#multiple-discontinuities"><span class="header-section-number">27.1.5</span> Multiple Discontinuities</a></li>
<li><a class="nav-link" href="#manipulation-of-the-running-variable"><span class="header-section-number">27.1.6</span> Manipulation of the Running Variable</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#model-estimation-strategies"><span class="header-section-number">27.2</span> Model Estimation Strategies</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#parametric-models-polynomial-regression"><span class="header-section-number">27.2.1</span> Parametric Models: Polynomial Regression</a></li>
<li><a class="nav-link" href="#nonparametric-models-local-regression"><span class="header-section-number">27.2.2</span> Nonparametric Models: Local Regression</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#formal-definition"><span class="header-section-number">27.3</span> Formal Definition</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#identification-assumptions"><span class="header-section-number">27.3.1</span> Identification Assumptions</a></li></ul>
</li>
<li>
<a class="nav-link" href="#estimation-and-inference"><span class="header-section-number">27.4</span> Estimation and Inference</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#local-randomization-based-approach"><span class="header-section-number">27.4.1</span> Local Randomization-Based Approach</a></li>
<li><a class="nav-link" href="#sec-continuity-based-approach"><span class="header-section-number">27.4.2</span> Continuity-Based Approach</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#specification-checks"><span class="header-section-number">27.5</span> Specification Checks</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-balance-checks"><span class="header-section-number">27.5.1</span> Balance Checks</a></li>
<li><a class="nav-link" href="#sec-sorting-bunching-and-manipulation"><span class="header-section-number">27.5.2</span> Sorting, Bunching, and Manipulation</a></li>
<li><a class="nav-link" href="#placebo-tests"><span class="header-section-number">27.5.3</span> Placebo Tests</a></li>
<li><a class="nav-link" href="#sensitivity-to-bandwidth-choice"><span class="header-section-number">27.5.4</span> Sensitivity to Bandwidth Choice</a></li>
<li><a class="nav-link" href="#assessing-sensitivity"><span class="header-section-number">27.5.5</span> Assessing Sensitivity</a></li>
<li><a class="nav-link" href="#manipulation-robust-regression-discontinuity-bounds"><span class="header-section-number">27.5.6</span> Manipulation-Robust Regression Discontinuity Bounds</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-fuzzy-regression-discontinuity-design"><span class="header-section-number">27.6</span> Fuzzy Regression Discontinuity Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#compliance-types"><span class="header-section-number">27.6.1</span> Compliance Types</a></li>
<li><a class="nav-link" href="#estimating-the-local-average-treatment-effect"><span class="header-section-number">27.6.2</span> Estimating the Local Average Treatment Effect</a></li>
<li><a class="nav-link" href="#equivalent-representation-using-expectations"><span class="header-section-number">27.6.3</span> Equivalent Representation Using Expectations</a></li>
<li><a class="nav-link" href="#estimation-strategies"><span class="header-section-number">27.6.4</span> Estimation Strategies</a></li>
<li><a class="nav-link" href="#practical-considerations-6"><span class="header-section-number">27.6.5</span> Practical Considerations</a></li>
<li><a class="nav-link" href="#steps-for-fuzzy-rd"><span class="header-section-number">27.6.6</span> Steps for Fuzzy RD</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-sharp-regression-discontinuity-design"><span class="header-section-number">27.7</span> Sharp Regression Discontinuity Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assumptions-for-identification"><span class="header-section-number">27.7.1</span> Assumptions for Identification</a></li>
<li><a class="nav-link" href="#estimating-the-local-average-treatment-effect-1"><span class="header-section-number">27.7.2</span> Estimating the Local Average Treatment Effect</a></li>
<li><a class="nav-link" href="#estimation-methods"><span class="header-section-number">27.7.3</span> Estimation Methods</a></li>
<li><a class="nav-link" href="#steps-for-sharp-rd"><span class="header-section-number">27.7.4</span> Steps for Sharp RD</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-regression-kink-design"><span class="header-section-number">27.8</span> Regression Kink Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#sec-identification-in-sharp-regression-kink-design"><span class="header-section-number">27.8.1</span> Identification in Sharp Regression Kink Design</a></li>
<li><a class="nav-link" href="#sec-identification-in-fuzzy-regression-kink-design"><span class="header-section-number">27.8.2</span> Identification in Fuzzy Regression Kink Design</a></li>
<li><a class="nav-link" href="#estimation-of-rkd-effects"><span class="header-section-number">27.8.3</span> Estimation of RKD Effects</a></li>
<li><a class="nav-link" href="#robustness-checks-1"><span class="header-section-number">27.8.4</span> Robustness Checks</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-multi-cutoff-regression-discontinuity-design"><span class="header-section-number">27.9</span> Multi-Cutoff Regression Discontinuity Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#identification"><span class="header-section-number">27.9.1</span> Identification</a></li>
<li><a class="nav-link" href="#key-assumptions-1"><span class="header-section-number">27.9.2</span> Key Assumptions</a></li>
<li><a class="nav-link" href="#estimation-approaches"><span class="header-section-number">27.9.3</span> Estimation Approaches</a></li>
<li><a class="nav-link" href="#robustness-checks-2"><span class="header-section-number">27.9.4</span> Robustness Checks</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sec-multi-score-regression-discontinuity-design"><span class="header-section-number">27.10</span> Multi-Score Regression Discontinuity Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#general-framework"><span class="header-section-number">27.10.1</span> General Framework</a></li>
<li><a class="nav-link" href="#identification-1"><span class="header-section-number">27.10.2</span> Identification</a></li>
<li><a class="nav-link" href="#key-assumptions-2"><span class="header-section-number">27.10.3</span> Key Assumptions</a></li>
<li><a class="nav-link" href="#estimation-approaches-1"><span class="header-section-number">27.10.4</span> Estimation Approaches</a></li>
<li><a class="nav-link" href="#robustness-checks-3"><span class="header-section-number">27.10.5</span> Robustness Checks</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#evaluation-of-a-regression-discontinuity-design"><span class="header-section-number">27.11</span> Evaluation of a Regression Discontinuity Design</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#graphical-and-formal-evidence"><span class="header-section-number">27.11.1</span> Graphical and Formal Evidence</a></li>
<li><a class="nav-link" href="#functional-form-of-the-running-variable"><span class="header-section-number">27.11.2</span> Functional Form of the Running Variable</a></li>
<li><a class="nav-link" href="#bandwidth-selection-2"><span class="header-section-number">27.11.3</span> Bandwidth Selection</a></li>
<li><a class="nav-link" href="#addressing-potential-confounders"><span class="header-section-number">27.11.4</span> Addressing Potential Confounders</a></li>
<li><a class="nav-link" href="#external-validity-in-rd"><span class="header-section-number">27.11.5</span> External Validity in RD</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#applications-of-rd-designs"><span class="header-section-number">27.12</span> Applications of RD Designs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#applications-in-marketing"><span class="header-section-number">27.12.1</span> Applications in Marketing</a></li>
<li><a class="nav-link" href="#r-packages-for-rd-estimation"><span class="header-section-number">27.12.2</span> R Packages for RD Estimation</a></li>
<li><a class="nav-link" href="#example-of-regression-discontinuity-in-education"><span class="header-section-number">27.12.3</span> Example of Regression Discontinuity in Education</a></li>
<li><a class="nav-link" href="#example-of-occupational-licensing-and-market-efficiency"><span class="header-section-number">27.12.4</span> Example of Occupational Licensing and Market Efficiency</a></li>
<li><a class="nav-link" href="#replicating-carpenter2009effect"><span class="header-section-number">27.12.5</span> Replicating (Carpenter and Dobkin 2009)</a></li>
<li><a class="nav-link" href="#additional-rd-applications"><span class="header-section-number">27.12.6</span> Additional RD Applications</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mikenguyen13/data_analysis/blob/main/27-regression-discontinuity.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mikenguyen13/data_analysis/edit/main/27-regression-discontinuity.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>A Guide on Data Analysis</strong>" was written by Mike Nguyen. It was last built on 2025-03-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
