<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>33.2 Endogenous Sample Selection | A Guide on Data Analysis</title>
  <meta name="description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="33.2 Endogenous Sample Selection | A Guide on Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />
  <meta property="og:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="github-repo" content="mikenguyen13/data_analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="33.2 Endogenous Sample Selection | A Guide on Data Analysis" />
  
  <meta name="twitter:description" content="This is a guide on how to conduct data analysis in the field of data science, statistics, or machine learning." />
  <meta name="twitter:image" content="https://bookdown.org/mike/data_analysis//images/cover.jpg" />

<meta name="author" content="Mike Nguyen" />


<meta name="date" content="2024-12-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="logo.png" />
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="endogenous-treatment.html"/>
<link rel="next" href="other-biases.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-DMNX2X65HQ');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Guide on Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="how-to-cite-this-book.html"><a href="how-to-cite-this-book.html"><i class="fa fa-check"></i>How to cite this book</a></li>
<li class="chapter" data-level="" data-path="more-books.html"><a href="more-books.html"><i class="fa fa-check"></i>More books</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="general-recommendations.html"><a href="general-recommendations.html"><i class="fa fa-check"></i><b>1.1</b> General Recommendations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="matrix-theory.html"><a href="matrix-theory.html"><i class="fa fa-check"></i><b>2.1</b> Matrix Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="matrix-theory.html"><a href="matrix-theory.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.1.1</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.1.2" data-path="matrix-theory.html"><a href="matrix-theory.html#inverse-of-a-matrix"><i class="fa fa-check"></i><b>2.1.2</b> Inverse of a Matrix</a></li>
<li class="chapter" data-level="2.1.3" data-path="matrix-theory.html"><a href="matrix-theory.html#definiteness-of-a-matrix"><i class="fa fa-check"></i><b>2.1.3</b> Definiteness of a Matrix</a></li>
<li class="chapter" data-level="2.1.4" data-path="matrix-theory.html"><a href="matrix-theory.html#matrix-calculus"><i class="fa fa-check"></i><b>2.1.4</b> Matrix Calculus</a></li>
<li class="chapter" data-level="2.1.5" data-path="matrix-theory.html"><a href="matrix-theory.html#optimization-in-scalar-and-vector-spaces"><i class="fa fa-check"></i><b>2.1.5</b> Optimization in Scalar and Vector Spaces</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>2.2</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="probability-theory.html"><a href="probability-theory.html#axioms-and-theorems-of-probability"><i class="fa fa-check"></i><b>2.2.1</b> Axioms and Theorems of Probability</a></li>
<li class="chapter" data-level="2.2.2" data-path="probability-theory.html"><a href="probability-theory.html#central-limit-theorem"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.3" data-path="probability-theory.html"><a href="probability-theory.html#random-variable"><i class="fa fa-check"></i><b>2.2.3</b> Random Variable</a></li>
<li class="chapter" data-level="2.2.4" data-path="probability-theory.html"><a href="probability-theory.html#moment-generating-function"><i class="fa fa-check"></i><b>2.2.4</b> Moment Generating Function</a></li>
<li class="chapter" data-level="2.2.5" data-path="probability-theory.html"><a href="probability-theory.html#moments"><i class="fa fa-check"></i><b>2.2.5</b> Moments</a></li>
<li class="chapter" data-level="2.2.6" data-path="probability-theory.html"><a href="probability-theory.html#skewness"><i class="fa fa-check"></i><b>2.2.6</b> Skewness</a></li>
<li class="chapter" data-level="2.2.7" data-path="probability-theory.html"><a href="probability-theory.html#kurtosis"><i class="fa fa-check"></i><b>2.2.7</b> Kurtosis</a></li>
<li class="chapter" data-level="2.2.8" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>2.2.8</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="general-math.html"><a href="general-math.html"><i class="fa fa-check"></i><b>2.3</b> General Math</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="general-math.html"><a href="general-math.html#number-sets"><i class="fa fa-check"></i><b>2.3.1</b> Number Sets</a></li>
<li class="chapter" data-level="2.3.2" data-path="general-math.html"><a href="general-math.html#summation-notation-and-series"><i class="fa fa-check"></i><b>2.3.2</b> Summation Notation and Series</a></li>
<li class="chapter" data-level="2.3.3" data-path="general-math.html"><a href="general-math.html#taylor-expansion"><i class="fa fa-check"></i><b>2.3.3</b> Taylor Expansion</a></li>
<li class="chapter" data-level="2.3.4" data-path="general-math.html"><a href="general-math.html#law-of-large-numbers"><i class="fa fa-check"></i><b>2.3.4</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.3.5" data-path="general-math.html"><a href="general-math.html#law-of-iterated-expectation"><i class="fa fa-check"></i><b>2.3.5</b> Law of Iterated Expectation</a></li>
<li class="chapter" data-level="2.3.6" data-path="general-math.html"><a href="general-math.html#convergence"><i class="fa fa-check"></i><b>2.3.6</b> Convergence</a></li>
<li class="chapter" data-level="2.3.7" data-path="general-math.html"><a href="general-math.html#sufficient-statistics-and-likelihood"><i class="fa fa-check"></i><b>2.3.7</b> Sufficient Statistics and Likelihood</a></li>
<li class="chapter" data-level="2.3.8" data-path="general-math.html"><a href="general-math.html#parameter-transformations"><i class="fa fa-check"></i><b>2.3.8</b> Parameter Transformations</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-importexport.html"><a href="data-importexport.html"><i class="fa fa-check"></i><b>2.4</b> Data Import/Export</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-importexport.html"><a href="data-importexport.html#medium-size"><i class="fa fa-check"></i><b>2.4.1</b> Medium size</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-importexport.html"><a href="data-importexport.html#large-size"><i class="fa fa-check"></i><b>2.4.2</b> Large size</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-manipulation.html"><a href="data-manipulation.html"><i class="fa fa-check"></i><b>2.5</b> Data Manipulation</a></li>
</ul></li>
<li class="part"><span><b>I. BASIC</b></span></li>
<li class="chapter" data-level="3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>3</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="numerical-measures.html"><a href="numerical-measures.html"><i class="fa fa-check"></i><b>3.1</b> Numerical Measures</a></li>
<li class="chapter" data-level="3.2" data-path="graphical-measures.html"><a href="graphical-measures.html"><i class="fa fa-check"></i><b>3.2</b> Graphical Measures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="graphical-measures.html"><a href="graphical-measures.html#shape"><i class="fa fa-check"></i><b>3.2.1</b> Shape</a></li>
<li class="chapter" data-level="3.2.2" data-path="graphical-measures.html"><a href="graphical-measures.html#scatterplot"><i class="fa fa-check"></i><b>3.2.2</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="normality-assessment.html"><a href="normality-assessment.html"><i class="fa fa-check"></i><b>3.3</b> Normality Assessment</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="normality-assessment.html"><a href="normality-assessment.html#graphical-assessment"><i class="fa fa-check"></i><b>3.3.1</b> Graphical Assessment</a></li>
<li class="chapter" data-level="3.3.2" data-path="normality-assessment.html"><a href="normality-assessment.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.2</b> Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html"><i class="fa fa-check"></i><b>3.4</b> Bivariate Statistics</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-continuous"><i class="fa fa-check"></i><b>3.4.1</b> Two Continuous</a></li>
<li class="chapter" data-level="3.4.2" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#categorical-and-continuous"><i class="fa fa-check"></i><b>3.4.2</b> Categorical and Continuous</a></li>
<li class="chapter" data-level="3.4.3" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#two-discrete"><i class="fa fa-check"></i><b>3.4.3</b> Two Discrete</a></li>
<li class="chapter" data-level="3.4.4" data-path="bivariate-statistics.html"><a href="bivariate-statistics.html#general-approach-to-bivariate-statistics"><i class="fa fa-check"></i><b>3.4.4</b> General Approach to Bivariate Statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-statistical-inference.html"><a href="basic-statistical-inference.html"><i class="fa fa-check"></i><b>4</b> Basic Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html"><i class="fa fa-check"></i><b>4.1</b> Hypothesis Testing Framework</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#null-and-alternative-hypotheses"><i class="fa fa-check"></i><b>4.1.1</b> Null and Alternative Hypotheses</a></li>
<li class="chapter" data-level="4.1.2" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#errors-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.2</b> Errors in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.3" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-role-of-distributions-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.3</b> The Role of Distributions in Hypothesis Testing</a></li>
<li class="chapter" data-level="4.1.4" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#the-test-statistic"><i class="fa fa-check"></i><b>4.1.4</b> The Test Statistic</a></li>
<li class="chapter" data-level="4.1.5" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#critical-values-and-rejection-regions-1"><i class="fa fa-check"></i><b>4.1.5</b> Critical Values and Rejection Regions</a></li>
<li class="chapter" data-level="4.1.6" data-path="hypothesis-testing-framework.html"><a href="hypothesis-testing-framework.html#visualizing-hypothesis-testing"><i class="fa fa-check"></i><b>4.1.6</b> Visualizing Hypothesis Testing</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html"><i class="fa fa-check"></i><b>4.2</b> Key Concepts and Definitions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#random-sample"><i class="fa fa-check"></i><b>4.2.1</b> Random Sample</a></li>
<li class="chapter" data-level="4.2.2" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#sample-statistics"><i class="fa fa-check"></i><b>4.2.2</b> Sample Statistics</a></li>
<li class="chapter" data-level="4.2.3" data-path="key-concepts-and-definitions.html"><a href="key-concepts-and-definitions.html#distribution-of-the-sample-mean"><i class="fa fa-check"></i><b>4.2.3</b> Distribution of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html"><i class="fa fa-check"></i><b>4.3</b> One-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-mean"><i class="fa fa-check"></i><b>4.3.1</b> For Single Mean</a></li>
<li class="chapter" data-level="4.3.2" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-independent-samples"><i class="fa fa-check"></i><b>4.3.2</b> For Difference of Means, Independent Samples</a></li>
<li class="chapter" data-level="4.3.3" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-means-paired-samples"><i class="fa fa-check"></i><b>4.3.3</b> For Difference of Means, Paired Samples</a></li>
<li class="chapter" data-level="4.3.4" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-difference-of-two-proportions"><i class="fa fa-check"></i><b>4.3.4</b> For Difference of Two Proportions</a></li>
<li class="chapter" data-level="4.3.5" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-proportion"><i class="fa fa-check"></i><b>4.3.5</b> For Single Proportion</a></li>
<li class="chapter" data-level="4.3.6" data-path="one-sample-inference.html"><a href="one-sample-inference.html#for-single-variance"><i class="fa fa-check"></i><b>4.3.6</b> For Single Variance</a></li>
<li class="chapter" data-level="4.3.7" data-path="one-sample-inference.html"><a href="one-sample-inference.html#non-parametric-tests"><i class="fa fa-check"></i><b>4.3.7</b> Non-parametric Tests</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html"><i class="fa fa-check"></i><b>4.4</b> Two-Sample Inference</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-means"><i class="fa fa-check"></i><b>4.4.1</b> For Means</a></li>
<li class="chapter" data-level="4.4.2" data-path="two-sample-inference.html"><a href="two-sample-inference.html#for-variances"><i class="fa fa-check"></i><b>4.4.2</b> For Variances</a></li>
<li class="chapter" data-level="4.4.3" data-path="two-sample-inference.html"><a href="two-sample-inference.html#power"><i class="fa fa-check"></i><b>4.4.3</b> Power</a></li>
<li class="chapter" data-level="4.4.4" data-path="two-sample-inference.html"><a href="two-sample-inference.html#matched-pair-designs"><i class="fa fa-check"></i><b>4.4.4</b> Matched Pair Designs</a></li>
<li class="chapter" data-level="4.4.5" data-path="two-sample-inference.html"><a href="two-sample-inference.html#nonparametric-tests-for-two-samples"><i class="fa fa-check"></i><b>4.4.5</b> Nonparametric Tests for Two Samples</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html"><i class="fa fa-check"></i><b>4.5</b> Categorical Data Analysis</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#association-tests"><i class="fa fa-check"></i><b>4.5.1</b> Association Tests</a></li>
<li class="chapter" data-level="4.5.2" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-association"><i class="fa fa-check"></i><b>4.5.2</b> Ordinal Association</a></li>
<li class="chapter" data-level="4.5.3" data-path="categorical-data-analysis.html"><a href="categorical-data-analysis.html#ordinal-trend"><i class="fa fa-check"></i><b>4.5.3</b> Ordinal Trend</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html"><i class="fa fa-check"></i><b>4.6</b> Divergence Metrics and Tests for Comparing Distributions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kolmogorov-smirnov-test-1"><i class="fa fa-check"></i><b>4.6.1</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="4.6.2" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#anderson-darling-test-1"><i class="fa fa-check"></i><b>4.6.2</b> Anderson-Darling Test</a></li>
<li class="chapter" data-level="4.6.3" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>4.6.3</b> Chi-Square Goodness-of-Fit Test</a></li>
<li class="chapter" data-level="4.6.4" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#cramér-von-mises-test"><i class="fa fa-check"></i><b>4.6.4</b> Cramér-von Mises Test</a></li>
<li class="chapter" data-level="4.6.5" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#kullback-leibler-divergence"><i class="fa fa-check"></i><b>4.6.5</b> Kullback-Leibler Divergence</a></li>
<li class="chapter" data-level="4.6.6" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#jensen-shannon-divergence"><i class="fa fa-check"></i><b>4.6.6</b> Jensen-Shannon Divergence</a></li>
<li class="chapter" data-level="4.6.7" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#hellinger-distance"><i class="fa fa-check"></i><b>4.6.7</b> Hellinger Distance</a></li>
<li class="chapter" data-level="4.6.8" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#bhattacharyya-distance"><i class="fa fa-check"></i><b>4.6.8</b> Bhattacharyya Distance</a></li>
<li class="chapter" data-level="4.6.9" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#wasserstein-distance"><i class="fa fa-check"></i><b>4.6.9</b> Wasserstein Distance</a></li>
<li class="chapter" data-level="4.6.10" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#energy-distance"><i class="fa fa-check"></i><b>4.6.10</b> Energy Distance</a></li>
<li class="chapter" data-level="4.6.11" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#total-variation-distance"><i class="fa fa-check"></i><b>4.6.11</b> Total Variation Distance</a></li>
<li class="chapter" data-level="4.6.12" data-path="divergence-metrics-and-tests-for-comparing-distributions.html"><a href="divergence-metrics-and-tests-for-comparing-distributions.html#summary"><i class="fa fa-check"></i><b>4.6.12</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II. REGRESSION</b></span></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html"><i class="fa fa-check"></i><b>5.1</b> Ordinary Least Squares</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#simple-regression-basic-model"><i class="fa fa-check"></i><b>5.1.1</b> Simple Regression (Basic Model)</a></li>
<li class="chapter" data-level="5.1.2" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.1.2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="5.1.3" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#ols-assumptions"><i class="fa fa-check"></i><b>5.1.3</b> OLS Assumptions</a></li>
<li class="chapter" data-level="5.1.4" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#theorems"><i class="fa fa-check"></i><b>5.1.4</b> Theorems</a></li>
<li class="chapter" data-level="5.1.5" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#variable-selection"><i class="fa fa-check"></i><b>5.1.5</b> Variable Selection</a></li>
<li class="chapter" data-level="5.1.6" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#diagnostics-1"><i class="fa fa-check"></i><b>5.1.6</b> Diagnostics</a></li>
<li class="chapter" data-level="5.1.7" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#model-validation"><i class="fa fa-check"></i><b>5.1.7</b> Model Validation</a></li>
<li class="chapter" data-level="5.1.8" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#finite-sample-properties"><i class="fa fa-check"></i><b>5.1.8</b> Finite Sample Properties</a></li>
<li class="chapter" data-level="5.1.9" data-path="ordinary-least-squares.html"><a href="ordinary-least-squares.html#large-sample-properties"><i class="fa fa-check"></i><b>5.1.9</b> Large Sample Properties</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html"><i class="fa fa-check"></i><b>5.2</b> Feasible Generalized Least Squares</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#heteroskedasticity"><i class="fa fa-check"></i><b>5.2.1</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="5.2.2" data-path="feasible-generalized-least-squares.html"><a href="feasible-generalized-least-squares.html#serial-correlation"><i class="fa fa-check"></i><b>5.2.2</b> Serial Correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="weighted-least-squares.html"><a href="weighted-least-squares.html"><i class="fa fa-check"></i><b>5.3</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="5.4" data-path="generalized-least-squares.html"><a href="generalized-least-squares.html"><i class="fa fa-check"></i><b>5.4</b> Generalized Least Squares</a></li>
<li class="chapter" data-level="5.5" data-path="feasiable-prais-winsten.html"><a href="feasiable-prais-winsten.html"><i class="fa fa-check"></i><b>5.5</b> Feasible Prais Winsten</a></li>
<li class="chapter" data-level="5.6" data-path="feasible-group-level-random-effects.html"><a href="feasible-group-level-random-effects.html"><i class="fa fa-check"></i><b>5.6</b> Feasible group level Random Effects</a></li>
<li class="chapter" data-level="5.7" data-path="ridge-regression.html"><a href="ridge-regression.html"><i class="fa fa-check"></i><b>5.7</b> Ridge Regression</a></li>
<li class="chapter" data-level="5.8" data-path="principal-component-regression.html"><a href="principal-component-regression.html"><i class="fa fa-check"></i><b>5.8</b> Principal Component Regression</a></li>
<li class="chapter" data-level="5.9" data-path="robust-regression.html"><a href="robust-regression.html"><i class="fa fa-check"></i><b>5.9</b> Robust Regression</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="robust-regression.html"><a href="robust-regression.html#least-absolute-residuals-lar-regression"><i class="fa fa-check"></i><b>5.9.1</b> Least Absolute Residuals (LAR) Regression</a></li>
<li class="chapter" data-level="5.9.2" data-path="robust-regression.html"><a href="robust-regression.html#least-median-of-squares-lms-regression"><i class="fa fa-check"></i><b>5.9.2</b> Least Median of Squares (LMS) Regression</a></li>
<li class="chapter" data-level="5.9.3" data-path="robust-regression.html"><a href="robust-regression.html#iteratively-reweighted-least-squares-irls-robust-regression"><i class="fa fa-check"></i><b>5.9.3</b> Iteratively Reweighted Least Squares (IRLS) Robust Regression</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html"><i class="fa fa-check"></i><b>5.10</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#motivation-for-mle"><i class="fa fa-check"></i><b>5.10.1</b> Motivation for MLE</a></li>
<li class="chapter" data-level="5.10.2" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#assumption"><i class="fa fa-check"></i><b>5.10.2</b> Assumption</a></li>
<li class="chapter" data-level="5.10.3" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#properties"><i class="fa fa-check"></i><b>5.10.3</b> Properties</a></li>
<li class="chapter" data-level="5.10.4" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#compare-to-ols"><i class="fa fa-check"></i><b>5.10.4</b> Compare to OLS</a></li>
<li class="chapter" data-level="5.10.5" data-path="maximum-likelihood-regression.html"><a href="maximum-likelihood-regression.html#application"><i class="fa fa-check"></i><b>5.10.5</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="non-linear-regression.html"><a href="non-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Non-linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference-1.html"><a href="inference-1.html"><i class="fa fa-check"></i><b>6.1</b> Inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference-1.html"><a href="inference-1.html#linear-function-of-the-parameters"><i class="fa fa-check"></i><b>6.1.1</b> Linear Function of the Parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference-1.html"><a href="inference-1.html#nonlinear"><i class="fa fa-check"></i><b>6.1.2</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html"><i class="fa fa-check"></i><b>6.2</b> Non-linear Least Squares</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#alternative-of-gauss-newton-algorithm"><i class="fa fa-check"></i><b>6.2.1</b> Alternative of Gauss-Newton Algorithm</a></li>
<li class="chapter" data-level="6.2.2" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#practical-considerations"><i class="fa fa-check"></i><b>6.2.2</b> Practical Considerations</a></li>
<li class="chapter" data-level="6.2.3" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#modelestimation-adequacy"><i class="fa fa-check"></i><b>6.2.3</b> Model/Estimation Adequacy</a></li>
<li class="chapter" data-level="6.2.4" data-path="non-linear-least-squares.html"><a href="non-linear-least-squares.html#application-1"><i class="fa fa-check"></i><b>6.2.4</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression-1.html"><a href="logistic-regression-1.html"><i class="fa fa-check"></i><b>7.1</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-regression-1.html"><a href="logistic-regression-1.html#application-2"><i class="fa fa-check"></i><b>7.1.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="probit-regression.html"><a href="probit-regression.html"><i class="fa fa-check"></i><b>7.2</b> Probit Regression</a></li>
<li class="chapter" data-level="7.3" data-path="binomial-regression.html"><a href="binomial-regression.html"><i class="fa fa-check"></i><b>7.3</b> Binomial Regression</a></li>
<li class="chapter" data-level="7.4" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>7.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="poisson-regression.html"><a href="poisson-regression.html#application-3"><i class="fa fa-check"></i><b>7.4.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="negative-binomial-regression.html"><a href="negative-binomial-regression.html"><i class="fa fa-check"></i><b>7.5</b> Negative Binomial Regression</a></li>
<li class="chapter" data-level="7.6" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i><b>7.6</b> Multinomial</a></li>
<li class="chapter" data-level="7.7" data-path="generalization.html"><a href="generalization.html"><i class="fa fa-check"></i><b>7.7</b> Generalization</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="generalization.html"><a href="generalization.html#estimation-1"><i class="fa fa-check"></i><b>7.7.1</b> Estimation</a></li>
<li class="chapter" data-level="7.7.2" data-path="generalization.html"><a href="generalization.html#inference-2"><i class="fa fa-check"></i><b>7.7.2</b> Inference</a></li>
<li class="chapter" data-level="7.7.3" data-path="generalization.html"><a href="generalization.html#deviance"><i class="fa fa-check"></i><b>7.7.3</b> Deviance</a></li>
<li class="chapter" data-level="7.7.4" data-path="generalization.html"><a href="generalization.html#diagnostic-plots"><i class="fa fa-check"></i><b>7.7.4</b> Diagnostic Plots</a></li>
<li class="chapter" data-level="7.7.5" data-path="generalization.html"><a href="generalization.html#goodness-of-fit"><i class="fa fa-check"></i><b>7.7.5</b> Goodness of Fit</a></li>
<li class="chapter" data-level="7.7.6" data-path="generalization.html"><a href="generalization.html#over-dispersion"><i class="fa fa-check"></i><b>7.7.6</b> Over-Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>8</b> Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dependent-data.html"><a href="dependent-data.html"><i class="fa fa-check"></i><b>8.1</b> Dependent Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dependent-data.html"><a href="dependent-data.html#random-intercepts-model"><i class="fa fa-check"></i><b>8.1.1</b> Random-Intercepts Model</a></li>
<li class="chapter" data-level="8.1.2" data-path="dependent-data.html"><a href="dependent-data.html#covariance-models"><i class="fa fa-check"></i><b>8.1.2</b> Covariance Models</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimation-2.html"><a href="estimation-2.html"><i class="fa fa-check"></i><b>8.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="estimation-2.html"><a href="estimation-2.html#estimating-mathbfv"><i class="fa fa-check"></i><b>8.2.1</b> Estimating <span class="math inline">\(\mathbf{V}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="inference-3.html"><a href="inference-3.html"><i class="fa fa-check"></i><b>8.3</b> Inference</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="inference-3.html"><a href="inference-3.html#parameters-beta"><i class="fa fa-check"></i><b>8.3.1</b> Parameters <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="inference-3.html"><a href="inference-3.html#variance-components"><i class="fa fa-check"></i><b>8.3.2</b> Variance Components</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="information-criteria.html"><a href="information-criteria.html"><i class="fa fa-check"></i><b>8.4</b> Information Criteria</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="information-criteria.html"><a href="information-criteria.html#akaikes-information-criteria-aic"><i class="fa fa-check"></i><b>8.4.1</b> Akaike’s Information Criteria (AIC)</a></li>
<li class="chapter" data-level="8.4.2" data-path="information-criteria.html"><a href="information-criteria.html#corrected-aic-aicc"><i class="fa fa-check"></i><b>8.4.2</b> Corrected AIC (AICC)</a></li>
<li class="chapter" data-level="8.4.3" data-path="information-criteria.html"><a href="information-criteria.html#bayesian-information-criteria-bic"><i class="fa fa-check"></i><b>8.4.3</b> Bayesian Information Criteria (BIC)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="split-plot-designs.html"><a href="split-plot-designs.html"><i class="fa fa-check"></i><b>8.5</b> Split-Plot Designs</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="split-plot-designs.html"><a href="split-plot-designs.html#application-4"><i class="fa fa-check"></i><b>8.5.1</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="repeated-measures-in-mixed-models.html"><a href="repeated-measures-in-mixed-models.html"><i class="fa fa-check"></i><b>8.6</b> Repeated Measures in Mixed Models</a></li>
<li class="chapter" data-level="8.7" data-path="unbalanced-or-unequally-spaced-data.html"><a href="unbalanced-or-unequally-spaced-data.html"><i class="fa fa-check"></i><b>8.7</b> Unbalanced or Unequally Spaced Data</a></li>
<li class="chapter" data-level="8.8" data-path="application-5.html"><a href="application-5.html"><i class="fa fa-check"></i><b>8.8</b> Application</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="application-5.html"><a href="application-5.html#example-1-pulps"><i class="fa fa-check"></i><b>8.8.1</b> Example 1 (Pulps)</a></li>
<li class="chapter" data-level="8.8.2" data-path="application-5.html"><a href="application-5.html#example-2-rats"><i class="fa fa-check"></i><b>8.8.2</b> Example 2 (Rats)</a></li>
<li class="chapter" data-level="8.8.3" data-path="application-5.html"><a href="application-5.html#example-3-agridat"><i class="fa fa-check"></i><b>8.8.3</b> Example 3 (Agridat)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="nonlinear-and-generalized-linear-mixed-models.html"><a href="nonlinear-and-generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>9</b> Nonlinear and Generalized Linear Mixed Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="estimation-3.html"><a href="estimation-3.html"><i class="fa fa-check"></i><b>9.1</b> Estimation</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-numerical-integration"><i class="fa fa-check"></i><b>9.1.1</b> Estimation by Numerical Integration</a></li>
<li class="chapter" data-level="9.1.2" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-linearization"><i class="fa fa-check"></i><b>9.1.2</b> Estimation by Linearization</a></li>
<li class="chapter" data-level="9.1.3" data-path="estimation-3.html"><a href="estimation-3.html#estimation-by-bayesian-hierarchical-models"><i class="fa fa-check"></i><b>9.1.3</b> Estimation by Bayesian Hierarchical Models</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="application-6.html"><a href="application-6.html"><i class="fa fa-check"></i><b>9.2</b> Application</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="application-6.html"><a href="application-6.html#binomial-cbpp-data"><i class="fa fa-check"></i><b>9.2.1</b> Binomial (CBPP Data)</a></li>
<li class="chapter" data-level="9.2.2" data-path="application-6.html"><a href="application-6.html#count-owl-data"><i class="fa fa-check"></i><b>9.2.2</b> Count (Owl Data)</a></li>
<li class="chapter" data-level="9.2.3" data-path="application-6.html"><a href="application-6.html#binomial"><i class="fa fa-check"></i><b>9.2.3</b> Binomial</a></li>
<li class="chapter" data-level="9.2.4" data-path="application-6.html"><a href="application-6.html#example-from-schabenberger_2001-section-8.4.1"><i class="fa fa-check"></i><b>9.2.4</b> Example from <span class="citation">(Schabenberger and Pierce 2001)</span> section 8.4.1</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>9.3</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>III. RAMIFICATIONS</b></span></li>
<li class="chapter" data-level="10" data-path="model-specification.html"><a href="model-specification.html"><i class="fa fa-check"></i><b>10</b> Model Specification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="nested-model.html"><a href="nested-model.html"><i class="fa fa-check"></i><b>10.1</b> Nested Model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="nested-model.html"><a href="nested-model.html#chow-test"><i class="fa fa-check"></i><b>10.1.1</b> Chow test</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="non-nested-model.html"><a href="non-nested-model.html"><i class="fa fa-check"></i><b>10.2</b> Non-Nested Model</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="non-nested-model.html"><a href="non-nested-model.html#davidson-mackinnon-test"><i class="fa fa-check"></i><b>10.2.1</b> Davidson-Mackinnon test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html"><i class="fa fa-check"></i><b>10.3</b> Heteroskedasticity</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#breusch-pagan-test"><i class="fa fa-check"></i><b>10.3.1</b> Breusch-Pagan test</a></li>
<li class="chapter" data-level="10.3.2" data-path="heteroskedasticity-1.html"><a href="heteroskedasticity-1.html#white-test"><i class="fa fa-check"></i><b>10.3.2</b> White test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="imputation-missing-data.html"><a href="imputation-missing-data.html"><i class="fa fa-check"></i><b>11</b> Imputation (Missing Data)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html"><i class="fa fa-check"></i><b>11.1</b> Introduction to Missing Data</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#types-of-imputation"><i class="fa fa-check"></i><b>11.1.1</b> Types of Imputation</a></li>
<li class="chapter" data-level="11.1.2" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#when-and-why-to-use-imputation"><i class="fa fa-check"></i><b>11.1.2</b> When and Why to Use Imputation</a></li>
<li class="chapter" data-level="11.1.3" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#importance-of-missing-data-treatment-in-statistical-modeling"><i class="fa fa-check"></i><b>11.1.3</b> Importance of Missing Data Treatment in Statistical Modeling</a></li>
<li class="chapter" data-level="11.1.4" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#prevalence-of-missing-data-across-domains"><i class="fa fa-check"></i><b>11.1.4</b> Prevalence of Missing Data Across Domains</a></li>
<li class="chapter" data-level="11.1.5" data-path="introduction-to-missing-data.html"><a href="introduction-to-missing-data.html#practical-considerations-for-imputation"><i class="fa fa-check"></i><b>11.1.5</b> Practical Considerations for Imputation</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html"><i class="fa fa-check"></i><b>11.2</b> Theoretical Foundations of Missing Data</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#definition-and-classification-of-missing-data"><i class="fa fa-check"></i><b>11.2.1</b> Definition and Classification of Missing Data</a></li>
<li class="chapter" data-level="11.2.2" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#missing-data-mechanisms"><i class="fa fa-check"></i><b>11.2.2</b> Missing Data Mechanisms</a></li>
<li class="chapter" data-level="11.2.3" data-path="theoretical-foundations-of-missing-data.html"><a href="theoretical-foundations-of-missing-data.html#relationship-between-mechanisms-and-ignorability"><i class="fa fa-check"></i><b>11.2.3</b> Relationship Between Mechanisms and Ignorability</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html"><i class="fa fa-check"></i><b>11.3</b> Diagnosing the Missing Data Mechanism</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#descriptive-methods"><i class="fa fa-check"></i><b>11.3.1</b> Descriptive Methods</a></li>
<li class="chapter" data-level="11.3.2" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#statistical-tests-for-missing-data-mechanisms"><i class="fa fa-check"></i><b>11.3.2</b> Statistical Tests for Missing Data Mechanisms</a></li>
<li class="chapter" data-level="11.3.3" data-path="diagnosing-the-missing-data-mechanism.html"><a href="diagnosing-the-missing-data-mechanism.html#assessing-mar-and-mnar"><i class="fa fa-check"></i><b>11.3.3</b> Assessing MAR and MNAR</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html"><i class="fa fa-check"></i><b>11.4</b> Methods for Handling Missing Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#basic-methods"><i class="fa fa-check"></i><b>11.4.1</b> Basic Methods</a></li>
<li class="chapter" data-level="11.4.2" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#single-imputation-techniques"><i class="fa fa-check"></i><b>11.4.2</b> Single Imputation Techniques</a></li>
<li class="chapter" data-level="11.4.3" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#machine-learning-and-modern-approaches"><i class="fa fa-check"></i><b>11.4.3</b> Machine Learning and Modern Approaches</a></li>
<li class="chapter" data-level="11.4.4" data-path="methods-for-handling-missing-data.html"><a href="methods-for-handling-missing-data.html#multiple-imputation"><i class="fa fa-check"></i><b>11.4.4</b> Multiple Imputation</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html"><i class="fa fa-check"></i><b>11.5</b> Evaluation of Imputation Methods</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#statistical-metrics-for-assessing-imputation-quality"><i class="fa fa-check"></i><b>11.5.1</b> Statistical Metrics for Assessing Imputation Quality</a></li>
<li class="chapter" data-level="11.5.2" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#bias-variance-tradeoff-in-imputation"><i class="fa fa-check"></i><b>11.5.2</b> Bias-Variance Tradeoff in Imputation</a></li>
<li class="chapter" data-level="11.5.3" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#sensitivity-analysis-1"><i class="fa fa-check"></i><b>11.5.3</b> Sensitivity Analysis</a></li>
<li class="chapter" data-level="11.5.4" data-path="evaluation-of-imputation-methods.html"><a href="evaluation-of-imputation-methods.html#validation-using-simulated-data-and-real-world-case-studies"><i class="fa fa-check"></i><b>11.5.4</b> Validation Using Simulated Data and Real-World Case Studies</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="criteria-for-choosing-an-effective-approach.html"><a href="criteria-for-choosing-an-effective-approach.html"><i class="fa fa-check"></i><b>11.6</b> Criteria for Choosing an Effective Approach</a></li>
<li class="chapter" data-level="11.7" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html"><i class="fa fa-check"></i><b>11.7</b> Challenges and Ethical Considerations</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#challenges-in-high-dimensional-data"><i class="fa fa-check"></i><b>11.7.1</b> Challenges in High-Dimensional Data</a></li>
<li class="chapter" data-level="11.7.2" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#missing-data-in-big-data-contexts"><i class="fa fa-check"></i><b>11.7.2</b> Missing Data in Big Data Contexts</a></li>
<li class="chapter" data-level="11.7.3" data-path="challenges-and-ethical-considerations.html"><a href="challenges-and-ethical-considerations.html#ethical-concerns"><i class="fa fa-check"></i><b>11.7.3</b> Ethical Concerns</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html"><i class="fa fa-check"></i><b>11.8</b> Emerging Trends in Missing Data Handling</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#advances-in-neural-network-approaches"><i class="fa fa-check"></i><b>11.8.1</b> Advances in Neural Network Approaches</a></li>
<li class="chapter" data-level="11.8.2" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#integration-with-reinforcement-learning"><i class="fa fa-check"></i><b>11.8.2</b> Integration with Reinforcement Learning</a></li>
<li class="chapter" data-level="11.8.3" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#synthetic-data-generation-for-missing-data"><i class="fa fa-check"></i><b>11.8.3</b> Synthetic Data Generation for Missing Data</a></li>
<li class="chapter" data-level="11.8.4" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#federated-learning-and-privacy-preserving-imputation"><i class="fa fa-check"></i><b>11.8.4</b> Federated Learning and Privacy-Preserving Imputation</a></li>
<li class="chapter" data-level="11.8.5" data-path="emerging-trends-in-missing-data-handling.html"><a href="emerging-trends-in-missing-data-handling.html#imputation-in-streaming-and-online-data-environments"><i class="fa fa-check"></i><b>11.8.5</b> Imputation in Streaming and Online Data Environments</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html"><i class="fa fa-check"></i><b>11.9</b> Application of Imputation in R</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#visualizing-missing-data"><i class="fa fa-check"></i><b>11.9.1</b> Visualizing Missing Data</a></li>
<li class="chapter" data-level="11.9.2" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#how-many-imputations"><i class="fa fa-check"></i><b>11.9.2</b> How Many Imputations?</a></li>
<li class="chapter" data-level="11.9.3" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#generating-missing-data-for-demonstration"><i class="fa fa-check"></i><b>11.9.3</b> Generating Missing Data for Demonstration</a></li>
<li class="chapter" data-level="11.9.4" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#imputation-with-mean-median-and-mode"><i class="fa fa-check"></i><b>11.9.4</b> Imputation with Mean, Median, and Mode</a></li>
<li class="chapter" data-level="11.9.5" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#k-nearest-neighbors-knn-imputation"><i class="fa fa-check"></i><b>11.9.5</b> K-Nearest Neighbors (KNN) Imputation</a></li>
<li class="chapter" data-level="11.9.6" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#imputation-with-decision-trees-rpart"><i class="fa fa-check"></i><b>11.9.6</b> Imputation with Decision Trees (rpart)</a></li>
<li class="chapter" data-level="11.9.7" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#mice-multivariate-imputation-via-chained-equations"><i class="fa fa-check"></i><b>11.9.7</b> MICE (Multivariate Imputation via Chained Equations)</a></li>
<li class="chapter" data-level="11.9.8" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#amelia"><i class="fa fa-check"></i><b>11.9.8</b> Amelia</a></li>
<li class="chapter" data-level="11.9.9" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#missforest"><i class="fa fa-check"></i><b>11.9.9</b> missForest</a></li>
<li class="chapter" data-level="11.9.10" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#hmisc"><i class="fa fa-check"></i><b>11.9.10</b> Hmisc</a></li>
<li class="chapter" data-level="11.9.11" data-path="application-of-imputation-in-r.html"><a href="application-of-imputation-in-r.html#mi"><i class="fa fa-check"></i><b>11.9.11</b> mi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>12</b> Data</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cross-sectional.html"><a href="cross-sectional.html"><i class="fa fa-check"></i><b>12.1</b> Cross-Sectional</a></li>
<li class="chapter" data-level="12.2" data-path="time-series-1.html"><a href="time-series-1.html"><i class="fa fa-check"></i><b>12.2</b> Time Series</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="time-series-1.html"><a href="time-series-1.html#deterministic-time-trend"><i class="fa fa-check"></i><b>12.2.1</b> Deterministic Time trend</a></li>
<li class="chapter" data-level="12.2.2" data-path="time-series-1.html"><a href="time-series-1.html#feedback-effect"><i class="fa fa-check"></i><b>12.2.2</b> Feedback Effect</a></li>
<li class="chapter" data-level="12.2.3" data-path="time-series-1.html"><a href="time-series-1.html#dynamic-specification"><i class="fa fa-check"></i><b>12.2.3</b> Dynamic Specification</a></li>
<li class="chapter" data-level="12.2.4" data-path="time-series-1.html"><a href="time-series-1.html#dynamically-complete"><i class="fa fa-check"></i><b>12.2.4</b> Dynamically Complete</a></li>
<li class="chapter" data-level="12.2.5" data-path="time-series-1.html"><a href="time-series-1.html#highly-persistent-data"><i class="fa fa-check"></i><b>12.2.5</b> Highly Persistent Data</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html"><i class="fa fa-check"></i><b>12.3</b> Repeated Cross Sections</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="repeated-cross-sections.html"><a href="repeated-cross-sections.html#pooled-cross-section"><i class="fa fa-check"></i><b>12.3.1</b> Pooled Cross Section</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>12.4</b> Panel Data</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="panel-data.html"><a href="panel-data.html#pooled-ols-estimator"><i class="fa fa-check"></i><b>12.4.1</b> Pooled OLS Estimator</a></li>
<li class="chapter" data-level="12.4.2" data-path="panel-data.html"><a href="panel-data.html#individual-specific-effects-model"><i class="fa fa-check"></i><b>12.4.2</b> Individual-specific effects model</a></li>
<li class="chapter" data-level="12.4.3" data-path="panel-data.html"><a href="panel-data.html#tests-for-assumptions"><i class="fa fa-check"></i><b>12.4.3</b> Tests for Assumptions</a></li>
<li class="chapter" data-level="12.4.4" data-path="panel-data.html"><a href="panel-data.html#model-selection"><i class="fa fa-check"></i><b>12.4.4</b> Model Selection</a></li>
<li class="chapter" data-level="12.4.5" data-path="panel-data.html"><a href="panel-data.html#summary-2"><i class="fa fa-check"></i><b>12.4.5</b> Summary</a></li>
<li class="chapter" data-level="12.4.6" data-path="panel-data.html"><a href="panel-data.html#application-7"><i class="fa fa-check"></i><b>12.4.6</b> Application</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="variable-transformation.html"><a href="variable-transformation.html"><i class="fa fa-check"></i><b>13</b> Variable Transformation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="continuous-variables.html"><a href="continuous-variables.html"><i class="fa fa-check"></i><b>13.1</b> Continuous Variables</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="continuous-variables.html"><a href="continuous-variables.html#standardization"><i class="fa fa-check"></i><b>13.1.1</b> Standardization</a></li>
<li class="chapter" data-level="13.1.2" data-path="continuous-variables.html"><a href="continuous-variables.html#min-max-scaling"><i class="fa fa-check"></i><b>13.1.2</b> Min-max scaling</a></li>
<li class="chapter" data-level="13.1.3" data-path="continuous-variables.html"><a href="continuous-variables.html#square-rootcube-root"><i class="fa fa-check"></i><b>13.1.3</b> Square Root/Cube Root</a></li>
<li class="chapter" data-level="13.1.4" data-path="continuous-variables.html"><a href="continuous-variables.html#logarithmic"><i class="fa fa-check"></i><b>13.1.4</b> Logarithmic</a></li>
<li class="chapter" data-level="13.1.5" data-path="continuous-variables.html"><a href="continuous-variables.html#exponential"><i class="fa fa-check"></i><b>13.1.5</b> Exponential</a></li>
<li class="chapter" data-level="13.1.6" data-path="continuous-variables.html"><a href="continuous-variables.html#power-1"><i class="fa fa-check"></i><b>13.1.6</b> Power</a></li>
<li class="chapter" data-level="13.1.7" data-path="continuous-variables.html"><a href="continuous-variables.html#inversereciprocal"><i class="fa fa-check"></i><b>13.1.7</b> Inverse/Reciprocal</a></li>
<li class="chapter" data-level="13.1.8" data-path="continuous-variables.html"><a href="continuous-variables.html#hyperbolic-arcsine"><i class="fa fa-check"></i><b>13.1.8</b> Hyperbolic arcsine</a></li>
<li class="chapter" data-level="13.1.9" data-path="continuous-variables.html"><a href="continuous-variables.html#ordered-quantile-norm"><i class="fa fa-check"></i><b>13.1.9</b> Ordered Quantile Norm</a></li>
<li class="chapter" data-level="13.1.10" data-path="continuous-variables.html"><a href="continuous-variables.html#arcsinh"><i class="fa fa-check"></i><b>13.1.10</b> Arcsinh</a></li>
<li class="chapter" data-level="13.1.11" data-path="continuous-variables.html"><a href="continuous-variables.html#lambert-w-x-f-transformation"><i class="fa fa-check"></i><b>13.1.11</b> Lambert W x F Transformation</a></li>
<li class="chapter" data-level="13.1.12" data-path="continuous-variables.html"><a href="continuous-variables.html#inverse-hyperbolic-sine-ihs-transformation"><i class="fa fa-check"></i><b>13.1.12</b> Inverse Hyperbolic Sine (IHS) transformation</a></li>
<li class="chapter" data-level="13.1.13" data-path="continuous-variables.html"><a href="continuous-variables.html#box-cox-transformation"><i class="fa fa-check"></i><b>13.1.13</b> Box-Cox Transformation</a></li>
<li class="chapter" data-level="13.1.14" data-path="continuous-variables.html"><a href="continuous-variables.html#yeo-johnson-transformation"><i class="fa fa-check"></i><b>13.1.14</b> Yeo-Johnson Transformation</a></li>
<li class="chapter" data-level="13.1.15" data-path="continuous-variables.html"><a href="continuous-variables.html#rankgauss"><i class="fa fa-check"></i><b>13.1.15</b> RankGauss</a></li>
<li class="chapter" data-level="13.1.16" data-path="continuous-variables.html"><a href="continuous-variables.html#summary-3"><i class="fa fa-check"></i><b>13.1.16</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="categorical-variables.html"><a href="categorical-variables.html"><i class="fa fa-check"></i><b>13.2</b> Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>14</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="14.1" data-path="types-of-hypothesis-testing.html"><a href="types-of-hypothesis-testing.html"><i class="fa fa-check"></i><b>14.1</b> Types of hypothesis testing</a></li>
<li class="chapter" data-level="14.2" data-path="wald-test.html"><a href="wald-test.html"><i class="fa fa-check"></i><b>14.2</b> Wald test</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="wald-test.html"><a href="wald-test.html#multiple-hypothesis"><i class="fa fa-check"></i><b>14.2.1</b> Multiple Hypothesis</a></li>
<li class="chapter" data-level="14.2.2" data-path="wald-test.html"><a href="wald-test.html#linear-combination"><i class="fa fa-check"></i><b>14.2.2</b> Linear Combination</a></li>
<li class="chapter" data-level="14.2.3" data-path="wald-test.html"><a href="wald-test.html#estimate-difference-in-coefficients"><i class="fa fa-check"></i><b>14.2.3</b> Estimate Difference in Coefficients</a></li>
<li class="chapter" data-level="14.2.4" data-path="wald-test.html"><a href="wald-test.html#application-8"><i class="fa fa-check"></i><b>14.2.4</b> Application</a></li>
<li class="chapter" data-level="14.2.5" data-path="wald-test.html"><a href="wald-test.html#nonlinear-1"><i class="fa fa-check"></i><b>14.2.5</b> Nonlinear</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="the-likelihood-ratio-test.html"><a href="the-likelihood-ratio-test.html"><i class="fa fa-check"></i><b>14.3</b> The likelihood ratio test</a></li>
<li class="chapter" data-level="14.4" data-path="lagrange-multiplier-score.html"><a href="lagrange-multiplier-score.html"><i class="fa fa-check"></i><b>14.4</b> Lagrange Multiplier (Score)</a></li>
<li class="chapter" data-level="14.5" data-path="two-one-sided-tests-tost-equivalence-testing.html"><a href="two-one-sided-tests-tost-equivalence-testing.html"><i class="fa fa-check"></i><b>14.5</b> Two One-Sided Tests (TOST) Equivalence Testing</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="marginal-effects.html"><a href="marginal-effects.html"><i class="fa fa-check"></i><b>15</b> Marginal Effects</a>
<ul>
<li class="chapter" data-level="15.1" data-path="delta-method.html"><a href="delta-method.html"><i class="fa fa-check"></i><b>15.1</b> Delta Method</a></li>
<li class="chapter" data-level="15.2" data-path="average-marginal-effect-algorithm.html"><a href="average-marginal-effect-algorithm.html"><i class="fa fa-check"></i><b>15.2</b> Average Marginal Effect Algorithm</a></li>
<li class="chapter" data-level="15.3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>15.3</b> Packages</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="packages.html"><a href="packages.html#marginaleffects"><i class="fa fa-check"></i><b>15.3.1</b> MarginalEffects</a></li>
<li class="chapter" data-level="15.3.2" data-path="packages.html"><a href="packages.html#margins"><i class="fa fa-check"></i><b>15.3.2</b> margins</a></li>
<li class="chapter" data-level="15.3.3" data-path="packages.html"><a href="packages.html#mfx"><i class="fa fa-check"></i><b>15.3.3</b> mfx</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="prediction-and-estimation.html"><a href="prediction-and-estimation.html"><i class="fa fa-check"></i><b>16</b> Prediction and Estimation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="prediction-2.html"><a href="prediction-2.html"><i class="fa fa-check"></i><b>16.1</b> Prediction</a></li>
<li class="chapter" data-level="16.2" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>16.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="16.3" data-path="causation-versus-prediction.html"><a href="causation-versus-prediction.html"><i class="fa fa-check"></i><b>16.3</b> Causation versus Prediction</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>17</b> Moderation</a>
<ul>
<li class="chapter" data-level="17.1" data-path="emmeans-package.html"><a href="emmeans-package.html"><i class="fa fa-check"></i><b>17.1</b> emmeans package</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="emmeans-package.html"><a href="emmeans-package.html#continuous-by-continuous"><i class="fa fa-check"></i><b>17.1.1</b> Continuous by continuous</a></li>
<li class="chapter" data-level="17.1.2" data-path="emmeans-package.html"><a href="emmeans-package.html#continuous-by-categorical"><i class="fa fa-check"></i><b>17.1.2</b> Continuous by categorical</a></li>
<li class="chapter" data-level="17.1.3" data-path="emmeans-package.html"><a href="emmeans-package.html#categorical-by-categorical"><i class="fa fa-check"></i><b>17.1.3</b> Categorical by categorical</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="probmod-package.html"><a href="probmod-package.html"><i class="fa fa-check"></i><b>17.2</b> probmod package</a></li>
<li class="chapter" data-level="17.3" data-path="interactions-package.html"><a href="interactions-package.html"><i class="fa fa-check"></i><b>17.3</b> interactions package</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="interactions-package.html"><a href="interactions-package.html#continuous-interaction"><i class="fa fa-check"></i><b>17.3.1</b> Continuous interaction</a></li>
<li class="chapter" data-level="17.3.2" data-path="interactions-package.html"><a href="interactions-package.html#categorical-interaction"><i class="fa fa-check"></i><b>17.3.2</b> Categorical interaction</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="interactionr-package.html"><a href="interactionr-package.html"><i class="fa fa-check"></i><b>17.4</b> interactionR package</a></li>
<li class="chapter" data-level="17.5" data-path="sjplot-package.html"><a href="sjplot-package.html"><i class="fa fa-check"></i><b>17.5</b> sjPlot package</a></li>
</ul></li>
<li class="part"><span><b>IV. CAUSAL INFERENCE</b></span></li>
<li class="chapter" data-level="18" data-path="causal-inference.html"><a href="causal-inference.html"><i class="fa fa-check"></i><b>18</b> Causal Inference</a>
<ul>
<li class="chapter" data-level="18.1" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html"><i class="fa fa-check"></i><b>18.1</b> Treatment effect types</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#average-treatment-effects"><i class="fa fa-check"></i><b>18.1.1</b> Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.2" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#conditional-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.2</b> Conditional Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.3" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#intent-to-treat-effects"><i class="fa fa-check"></i><b>18.1.3</b> Intent-to-treat Effects</a></li>
<li class="chapter" data-level="18.1.4" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#local-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.4</b> Local Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.5" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#population-vs.-sample-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.5</b> Population vs. Sample Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.6" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#average-treatment-effects-on-the-treated-and-control"><i class="fa fa-check"></i><b>18.1.6</b> Average Treatment Effects on the Treated and Control</a></li>
<li class="chapter" data-level="18.1.7" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#quantile-average-treatment-effects"><i class="fa fa-check"></i><b>18.1.7</b> Quantile Average Treatment Effects</a></li>
<li class="chapter" data-level="18.1.8" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#mediation-effects"><i class="fa fa-check"></i><b>18.1.8</b> Mediation Effects</a></li>
<li class="chapter" data-level="18.1.9" data-path="treatment-effect-types.html"><a href="treatment-effect-types.html#log-odds-treatment-effects"><i class="fa fa-check"></i><b>18.1.9</b> Log-odds Treatment Effects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>A. EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="19" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i><b>19</b> Experimental Design</a>
<ul>
<li class="chapter" data-level="19.1" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>19.1</b> Notes</a></li>
<li class="chapter" data-level="19.2" data-path="semi-random-experiment.html"><a href="semi-random-experiment.html"><i class="fa fa-check"></i><b>19.2</b> Semi-random Experiment</a></li>
<li class="chapter" data-level="19.3" data-path="rerandomization.html"><a href="rerandomization.html"><i class="fa fa-check"></i><b>19.3</b> Rerandomization</a></li>
<li class="chapter" data-level="19.4" data-path="two-stage-randomized-experiments-with-interference-and-noncompliance.html"><a href="two-stage-randomized-experiments-with-interference-and-noncompliance.html"><i class="fa fa-check"></i><b>19.4</b> Two-Stage Randomized Experiments with Interference and Noncompliance</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>20</b> Sampling</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simple-sampling.html"><a href="simple-sampling.html"><i class="fa fa-check"></i><b>20.1</b> Simple Sampling</a></li>
<li class="chapter" data-level="20.2" data-path="stratified-sampling.html"><a href="stratified-sampling.html"><i class="fa fa-check"></i><b>20.2</b> Stratified Sampling</a></li>
<li class="chapter" data-level="20.3" data-path="unequal-probability-sampling.html"><a href="unequal-probability-sampling.html"><i class="fa fa-check"></i><b>20.3</b> Unequal Probability Sampling</a></li>
<li class="chapter" data-level="20.4" data-path="balanced-sampling.html"><a href="balanced-sampling.html"><i class="fa fa-check"></i><b>20.4</b> Balanced Sampling</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="balanced-sampling.html"><a href="balanced-sampling.html#cube"><i class="fa fa-check"></i><b>20.4.1</b> Cube</a></li>
<li class="chapter" data-level="20.4.2" data-path="balanced-sampling.html"><a href="balanced-sampling.html#stratification"><i class="fa fa-check"></i><b>20.4.2</b> Stratification</a></li>
<li class="chapter" data-level="20.4.3" data-path="balanced-sampling.html"><a href="balanced-sampling.html#cluster-1"><i class="fa fa-check"></i><b>20.4.3</b> Cluster</a></li>
<li class="chapter" data-level="20.4.4" data-path="balanced-sampling.html"><a href="balanced-sampling.html#two-stage"><i class="fa fa-check"></i><b>20.4.4</b> Two-stage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="analysis-of-variance-anova.html"><a href="analysis-of-variance-anova.html"><i class="fa fa-check"></i><b>21</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="21.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html"><i class="fa fa-check"></i><b>21.1</b> Completely Randomized Design (CRD)</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-fixed-effects-model"><i class="fa fa-check"></i><b>21.1.1</b> Single Factor Fixed Effects Model</a></li>
<li class="chapter" data-level="21.1.2" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#single-factor-random-effects-model"><i class="fa fa-check"></i><b>21.1.2</b> Single Factor Random Effects Model</a></li>
<li class="chapter" data-level="21.1.3" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-factor-fixed-effect-anova"><i class="fa fa-check"></i><b>21.1.3</b> Two Factor Fixed Effect ANOVA</a></li>
<li class="chapter" data-level="21.1.4" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-random-effects-anova"><i class="fa fa-check"></i><b>21.1.4</b> Two-Way Random Effects ANOVA</a></li>
<li class="chapter" data-level="21.1.5" data-path="completely-randomized-design-crd.html"><a href="completely-randomized-design-crd.html#two-way-mixed-effects-anova"><i class="fa fa-check"></i><b>21.1.5</b> Two-Way Mixed Effects ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html"><i class="fa fa-check"></i><b>21.2</b> Nonparametric ANOVA</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#kruskal-wallis"><i class="fa fa-check"></i><b>21.2.1</b> Kruskal-Wallis</a></li>
<li class="chapter" data-level="21.2.2" data-path="nonparametric-anova.html"><a href="nonparametric-anova.html#friedman-test"><i class="fa fa-check"></i><b>21.2.2</b> Friedman Test</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html"><i class="fa fa-check"></i><b>21.3</b> Sample Size Planning for ANOVA</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#balanced-designs"><i class="fa fa-check"></i><b>21.3.1</b> Balanced Designs</a></li>
<li class="chapter" data-level="21.3.2" data-path="sample-size-planning-for-anova.html"><a href="sample-size-planning-for-anova.html#randomized-block-experiments"><i class="fa fa-check"></i><b>21.3.2</b> Randomized Block Experiments</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html"><i class="fa fa-check"></i><b>21.4</b> Randomized Block Designs</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="randomized-block-designs.html"><a href="randomized-block-designs.html#tukey-test-of-additivity"><i class="fa fa-check"></i><b>21.4.1</b> Tukey Test of Additivity</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="nested-designs.html"><a href="nested-designs.html"><i class="fa fa-check"></i><b>21.5</b> Nested Designs</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="nested-designs.html"><a href="nested-designs.html#two-factor-nested-designs"><i class="fa fa-check"></i><b>21.5.1</b> Two-Factor Nested Designs</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="single-factor-covariance-model.html"><a href="single-factor-covariance-model.html"><i class="fa fa-check"></i><b>21.6</b> Single Factor Covariance Model</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>22</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="22.0.1" data-path="multivariate-methods.html"><a href="multivariate-methods.html#properties-of-mvn"><i class="fa fa-check"></i><b>22.0.1</b> Properties of MVN</a></li>
<li class="chapter" data-level="22.0.2" data-path="multivariate-methods.html"><a href="multivariate-methods.html#mean-vector-inference"><i class="fa fa-check"></i><b>22.0.2</b> Mean Vector Inference</a></li>
<li class="chapter" data-level="22.0.3" data-path="multivariate-methods.html"><a href="multivariate-methods.html#general-hypothesis-testing"><i class="fa fa-check"></i><b>22.0.3</b> General Hypothesis Testing</a></li>
<li class="chapter" data-level="22.1" data-path="manova.html"><a href="manova.html"><i class="fa fa-check"></i><b>22.1</b> MANOVA</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="manova.html"><a href="manova.html#testing-general-hypotheses"><i class="fa fa-check"></i><b>22.1.1</b> Testing General Hypotheses</a></li>
<li class="chapter" data-level="22.1.2" data-path="manova.html"><a href="manova.html#profile-analysis"><i class="fa fa-check"></i><b>22.1.2</b> Profile Analysis</a></li>
<li class="chapter" data-level="22.1.3" data-path="manova.html"><a href="manova.html#summary-5"><i class="fa fa-check"></i><b>22.1.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="principal-components.html"><a href="principal-components.html"><i class="fa fa-check"></i><b>22.2</b> Principal Components</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="principal-components.html"><a href="principal-components.html#population-principal-components"><i class="fa fa-check"></i><b>22.2.1</b> Population Principal Components</a></li>
<li class="chapter" data-level="22.2.2" data-path="principal-components.html"><a href="principal-components.html#sample-principal-components"><i class="fa fa-check"></i><b>22.2.2</b> Sample Principal Components</a></li>
<li class="chapter" data-level="22.2.3" data-path="principal-components.html"><a href="principal-components.html#application-9"><i class="fa fa-check"></i><b>22.2.3</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>22.3</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="factor-analysis.html"><a href="factor-analysis.html#methods-of-estimation"><i class="fa fa-check"></i><b>22.3.1</b> Methods of Estimation</a></li>
<li class="chapter" data-level="22.3.2" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-rotation"><i class="fa fa-check"></i><b>22.3.2</b> Factor Rotation</a></li>
<li class="chapter" data-level="22.3.3" data-path="factor-analysis.html"><a href="factor-analysis.html#estimation-of-factor-scores"><i class="fa fa-check"></i><b>22.3.3</b> Estimation of Factor Scores</a></li>
<li class="chapter" data-level="22.3.4" data-path="factor-analysis.html"><a href="factor-analysis.html#model-diagnostic"><i class="fa fa-check"></i><b>22.3.4</b> Model Diagnostic</a></li>
<li class="chapter" data-level="22.3.5" data-path="factor-analysis.html"><a href="factor-analysis.html#application-10"><i class="fa fa-check"></i><b>22.3.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html"><i class="fa fa-check"></i><b>22.4</b> Discriminant Analysis</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#known-populations"><i class="fa fa-check"></i><b>22.4.1</b> Known Populations</a></li>
<li class="chapter" data-level="22.4.2" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#probabilities-of-misclassification"><i class="fa fa-check"></i><b>22.4.2</b> Probabilities of Misclassification</a></li>
<li class="chapter" data-level="22.4.3" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#unknown-populations-nonparametric-discrimination"><i class="fa fa-check"></i><b>22.4.3</b> Unknown Populations/ Nonparametric Discrimination</a></li>
<li class="chapter" data-level="22.4.4" data-path="discriminant-analysis.html"><a href="discriminant-analysis.html#application-11"><i class="fa fa-check"></i><b>22.4.4</b> Application</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>B. QUASI-EXPERIMENTAL DESIGN</b></span></li>
<li class="chapter" data-level="23" data-path="quasi-experimental.html"><a href="quasi-experimental.html"><i class="fa fa-check"></i><b>23</b> Quasi-experimental</a>
<ul>
<li class="chapter" data-level="23.1" data-path="natural-experiments.html"><a href="natural-experiments.html"><i class="fa fa-check"></i><b>23.1</b> Natural Experiments</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="regression-discontinuity.html"><a href="regression-discontinuity.html"><i class="fa fa-check"></i><b>24</b> Regression Discontinuity</a>
<ul>
<li class="chapter" data-level="24.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html"><i class="fa fa-check"></i><b>24.1</b> Estimation and Inference</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#local-randomization-based"><i class="fa fa-check"></i><b>24.1.1</b> Local Randomization-based</a></li>
<li class="chapter" data-level="24.1.2" data-path="estimation-and-inference.html"><a href="estimation-and-inference.html#continuity-based"><i class="fa fa-check"></i><b>24.1.2</b> Continuity-based</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="specification-checks.html"><a href="specification-checks.html"><i class="fa fa-check"></i><b>24.2</b> Specification Checks</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="specification-checks.html"><a href="specification-checks.html#balance-checks"><i class="fa fa-check"></i><b>24.2.1</b> Balance Checks</a></li>
<li class="chapter" data-level="24.2.2" data-path="specification-checks.html"><a href="specification-checks.html#sortingbunchingmanipulation"><i class="fa fa-check"></i><b>24.2.2</b> Sorting/Bunching/Manipulation</a></li>
<li class="chapter" data-level="24.2.3" data-path="specification-checks.html"><a href="specification-checks.html#placebo-tests"><i class="fa fa-check"></i><b>24.2.3</b> Placebo Tests</a></li>
<li class="chapter" data-level="24.2.4" data-path="specification-checks.html"><a href="specification-checks.html#sensitivity-to-bandwidth-choice"><i class="fa fa-check"></i><b>24.2.4</b> Sensitivity to Bandwidth Choice</a></li>
<li class="chapter" data-level="24.2.5" data-path="specification-checks.html"><a href="specification-checks.html#manipulation-robust-regression-discontinuity-bounds"><i class="fa fa-check"></i><b>24.2.5</b> Manipulation Robust Regression Discontinuity Bounds</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="fuzzy-rd-design.html"><a href="fuzzy-rd-design.html"><i class="fa fa-check"></i><b>24.3</b> Fuzzy RD Design</a></li>
<li class="chapter" data-level="24.4" data-path="regression-kink-design.html"><a href="regression-kink-design.html"><i class="fa fa-check"></i><b>24.4</b> Regression Kink Design</a></li>
<li class="chapter" data-level="24.5" data-path="multi-cutoff.html"><a href="multi-cutoff.html"><i class="fa fa-check"></i><b>24.5</b> Multi-cutoff</a></li>
<li class="chapter" data-level="24.6" data-path="multi-score.html"><a href="multi-score.html"><i class="fa fa-check"></i><b>24.6</b> Multi-score</a></li>
<li class="chapter" data-level="24.7" data-path="steps-for-sharp-rd.html"><a href="steps-for-sharp-rd.html"><i class="fa fa-check"></i><b>24.7</b> Steps for Sharp RD</a></li>
<li class="chapter" data-level="24.8" data-path="steps-for-fuzzy-rd.html"><a href="steps-for-fuzzy-rd.html"><i class="fa fa-check"></i><b>24.8</b> Steps for Fuzzy RD</a></li>
<li class="chapter" data-level="24.9" data-path="steps-for-rdit-regression-discontinuity-in-time.html"><a href="steps-for-rdit-regression-discontinuity-in-time.html"><i class="fa fa-check"></i><b>24.9</b> Steps for RDiT (Regression Discontinuity in Time)</a></li>
<li class="chapter" data-level="24.10" data-path="evaluation-of-an-rd.html"><a href="evaluation-of-an-rd.html"><i class="fa fa-check"></i><b>24.10</b> Evaluation of an RD</a></li>
<li class="chapter" data-level="24.11" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>24.11</b> Applications</a>
<ul>
<li class="chapter" data-level="24.11.1" data-path="applications.html"><a href="applications.html#example-1-1"><i class="fa fa-check"></i><b>24.11.1</b> Example 1</a></li>
<li class="chapter" data-level="24.11.2" data-path="applications.html"><a href="applications.html#example-2"><i class="fa fa-check"></i><b>24.11.2</b> Example 2</a></li>
<li class="chapter" data-level="24.11.3" data-path="applications.html"><a href="applications.html#example-3"><i class="fa fa-check"></i><b>24.11.3</b> Example 3</a></li>
<li class="chapter" data-level="24.11.4" data-path="applications.html"><a href="applications.html#example-4"><i class="fa fa-check"></i><b>24.11.4</b> Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="synthetic-difference-in-differences.html"><a href="synthetic-difference-in-differences.html"><i class="fa fa-check"></i><b>25</b> Synthetic Difference-in-Differences</a>
<ul>
<li class="chapter" data-level="25.1" data-path="understanding.html"><a href="understanding.html"><i class="fa fa-check"></i><b>25.1</b> Understanding</a></li>
<li class="chapter" data-level="25.2" data-path="application-12.html"><a href="application-12.html"><i class="fa fa-check"></i><b>25.2</b> Application</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="application-12.html"><a href="application-12.html#block-treatment"><i class="fa fa-check"></i><b>25.2.1</b> Block Treatment</a></li>
<li class="chapter" data-level="25.2.2" data-path="application-12.html"><a href="application-12.html#staggered-adoption"><i class="fa fa-check"></i><b>25.2.2</b> Staggered Adoption</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="difference-in-differences.html"><a href="difference-in-differences.html"><i class="fa fa-check"></i><b>26</b> Difference-in-differences</a>
<ul>
<li class="chapter" data-level="26.1" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>26.1</b> Visualization</a></li>
<li class="chapter" data-level="26.2" data-path="simple-dif-n-dif.html"><a href="simple-dif-n-dif.html"><i class="fa fa-check"></i><b>26.2</b> Simple Dif-n-dif</a></li>
<li class="chapter" data-level="26.3" data-path="notes-1.html"><a href="notes-1.html"><i class="fa fa-check"></i><b>26.3</b> Notes</a></li>
<li class="chapter" data-level="26.4" data-path="standard-errors-2.html"><a href="standard-errors-2.html"><i class="fa fa-check"></i><b>26.4</b> Standard Errors</a></li>
<li class="chapter" data-level="26.5" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>26.5</b> Examples</a>
<ul>
<li class="chapter" data-level="26.5.1" data-path="examples.html"><a href="examples.html#example-by-doleac2020unintended"><i class="fa fa-check"></i><b>26.5.1</b> Example by <span class="citation">Doleac and Hansen (2020)</span></a></li>
<li class="chapter" data-level="26.5.2" data-path="examples.html"><a href="examples.html#example-from-princeton"><i class="fa fa-check"></i><b>26.5.2</b> Example from Princeton</a></li>
<li class="chapter" data-level="26.5.3" data-path="examples.html"><a href="examples.html#example-by-card1993minimum"><i class="fa fa-check"></i><b>26.5.3</b> Example by <span class="citation">Card and Krueger (1993)</span></a></li>
<li class="chapter" data-level="26.5.4" data-path="examples.html"><a href="examples.html#example-by-butcher2014effects"><i class="fa fa-check"></i><b>26.5.4</b> Example by <span class="citation">Butcher, McEwan, and Weerapana (2014)</span></a></li>
</ul></li>
<li class="chapter" data-level="26.6" data-path="one-difference.html"><a href="one-difference.html"><i class="fa fa-check"></i><b>26.6</b> One Difference</a></li>
<li class="chapter" data-level="26.7" data-path="two-way-fixed-effects.html"><a href="two-way-fixed-effects.html"><i class="fa fa-check"></i><b>26.7</b> Two-way Fixed-effects</a></li>
<li class="chapter" data-level="26.8" data-path="multiple-periods-and-variation-in-treatment-timing.html"><a href="multiple-periods-and-variation-in-treatment-timing.html"><i class="fa fa-check"></i><b>26.8</b> Multiple periods and variation in treatment timing</a></li>
<li class="chapter" data-level="26.9" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html"><i class="fa fa-check"></i><b>26.9</b> Staggered Dif-n-dif</a>
<ul>
<li class="chapter" data-level="26.9.1" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#stacked-did"><i class="fa fa-check"></i><b>26.9.1</b> Stacked DID</a></li>
<li class="chapter" data-level="26.9.2" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#goodman-bacon-decomposition"><i class="fa fa-check"></i><b>26.9.2</b> Goodman-Bacon Decomposition</a></li>
<li class="chapter" data-level="26.9.3" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#did-with-in-and-out-treatment-condition"><i class="fa fa-check"></i><b>26.9.3</b> DID with in and out treatment condition</a></li>
<li class="chapter" data-level="26.9.4" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#gardner2022two-and-borusyak2021revisiting"><i class="fa fa-check"></i><b>26.9.4</b> <span class="citation">Gardner (2022)</span> and <span class="citation">Borusyak, Jaravel, and Spiess (2021)</span></a></li>
<li class="chapter" data-level="26.9.5" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#de2020two"><i class="fa fa-check"></i><b>26.9.5</b> <span class="citation">Clément De Chaisemartin and d’Haultfoeuille (2020)</span></a></li>
<li class="chapter" data-level="26.9.6" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#callaway2021difference"><i class="fa fa-check"></i><b>26.9.6</b> <span class="citation">Callaway and Sant’Anna (2021)</span></a></li>
<li class="chapter" data-level="26.9.7" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#sun2021estimating"><i class="fa fa-check"></i><b>26.9.7</b> <span class="citation">L. Sun and Abraham (2021)</span></a></li>
<li class="chapter" data-level="26.9.8" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#wooldridge2022simple"><i class="fa fa-check"></i><b>26.9.8</b> <span class="citation">Wooldridge (2022)</span></a></li>
<li class="chapter" data-level="26.9.9" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#doubly-robust-did"><i class="fa fa-check"></i><b>26.9.9</b> Doubly Robust DiD</a></li>
<li class="chapter" data-level="26.9.10" data-path="staggered-dif-n-dif.html"><a href="staggered-dif-n-dif.html#augmentedforward-did"><i class="fa fa-check"></i><b>26.9.10</b> Augmented/Forward DID</a></li>
</ul></li>
<li class="chapter" data-level="26.10" data-path="multiple-treatments.html"><a href="multiple-treatments.html"><i class="fa fa-check"></i><b>26.10</b> Multiple Treatments</a></li>
<li class="chapter" data-level="26.11" data-path="mediation-under-did.html"><a href="mediation-under-did.html"><i class="fa fa-check"></i><b>26.11</b> Mediation Under DiD</a></li>
<li class="chapter" data-level="26.12" data-path="assumptions-2.html"><a href="assumptions-2.html"><i class="fa fa-check"></i><b>26.12</b> Assumptions</a>
<ul>
<li class="chapter" data-level="26.12.1" data-path="assumptions-2.html"><a href="assumptions-2.html#prior-parallel-trends-test"><i class="fa fa-check"></i><b>26.12.1</b> Prior Parallel Trends Test</a></li>
<li class="chapter" data-level="26.12.2" data-path="assumptions-2.html"><a href="assumptions-2.html#placebo-test-1"><i class="fa fa-check"></i><b>26.12.2</b> Placebo Test</a></li>
<li class="chapter" data-level="26.12.3" data-path="assumptions-2.html"><a href="assumptions-2.html#assumption-violations"><i class="fa fa-check"></i><b>26.12.3</b> Assumption Violations</a></li>
<li class="chapter" data-level="26.12.4" data-path="assumptions-2.html"><a href="assumptions-2.html#robustness-checks"><i class="fa fa-check"></i><b>26.12.4</b> Robustness Checks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="changes-in-changes.html"><a href="changes-in-changes.html"><i class="fa fa-check"></i><b>27</b> Changes-in-Changes</a>
<ul>
<li class="chapter" data-level="27.1" data-path="application-13.html"><a href="application-13.html"><i class="fa fa-check"></i><b>27.1</b> Application</a>
<ul>
<li class="chapter" data-level="27.1.1" data-path="application-13.html"><a href="application-13.html#ecic-package"><i class="fa fa-check"></i><b>27.1.1</b> ECIC package</a></li>
<li class="chapter" data-level="27.1.2" data-path="application-13.html"><a href="application-13.html#qte-package"><i class="fa fa-check"></i><b>27.1.2</b> QTE package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="synthetic-control.html"><a href="synthetic-control.html"><i class="fa fa-check"></i><b>28</b> Synthetic Control</a>
<ul>
<li class="chapter" data-level="28.1" data-path="applications-1.html"><a href="applications-1.html"><i class="fa fa-check"></i><b>28.1</b> Applications</a>
<ul>
<li class="chapter" data-level="28.1.1" data-path="applications-1.html"><a href="applications-1.html#example-1-2"><i class="fa fa-check"></i><b>28.1.1</b> Example 1</a></li>
<li class="chapter" data-level="28.1.2" data-path="applications-1.html"><a href="applications-1.html#example-2-1"><i class="fa fa-check"></i><b>28.1.2</b> Example 2</a></li>
<li class="chapter" data-level="28.1.3" data-path="applications-1.html"><a href="applications-1.html#example-3-1"><i class="fa fa-check"></i><b>28.1.3</b> Example 3</a></li>
<li class="chapter" data-level="28.1.4" data-path="applications-1.html"><a href="applications-1.html#example-4-1"><i class="fa fa-check"></i><b>28.1.4</b> Example 4</a></li>
</ul></li>
<li class="chapter" data-level="28.2" data-path="augmented-synthetic-control-method.html"><a href="augmented-synthetic-control-method.html"><i class="fa fa-check"></i><b>28.2</b> Augmented Synthetic Control Method</a></li>
<li class="chapter" data-level="28.3" data-path="synthetic-control-with-staggered-adoption.html"><a href="synthetic-control-with-staggered-adoption.html"><i class="fa fa-check"></i><b>28.3</b> Synthetic Control with Staggered Adoption</a></li>
<li class="chapter" data-level="28.4" data-path="bayesian-synthetic-control.html"><a href="bayesian-synthetic-control.html"><i class="fa fa-check"></i><b>28.4</b> Bayesian Synthetic Control</a></li>
<li class="chapter" data-level="28.5" data-path="generalized-synthetic-control.html"><a href="generalized-synthetic-control.html"><i class="fa fa-check"></i><b>28.5</b> Generalized Synthetic Control</a></li>
<li class="chapter" data-level="28.6" data-path="other-advances.html"><a href="other-advances.html"><i class="fa fa-check"></i><b>28.6</b> Other Advances</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="event-studies.html"><a href="event-studies.html"><i class="fa fa-check"></i><b>29</b> Event Studies</a>
<ul>
<li class="chapter" data-level="29.1" data-path="other-issues.html"><a href="other-issues.html"><i class="fa fa-check"></i><b>29.1</b> Other Issues</a>
<ul>
<li class="chapter" data-level="29.1.1" data-path="other-issues.html"><a href="other-issues.html#event-studies-in-marketing"><i class="fa fa-check"></i><b>29.1.1</b> Event Studies in marketing</a></li>
<li class="chapter" data-level="29.1.2" data-path="other-issues.html"><a href="other-issues.html#economic-significance"><i class="fa fa-check"></i><b>29.1.2</b> Economic significance</a></li>
<li class="chapter" data-level="29.1.3" data-path="other-issues.html"><a href="other-issues.html#statistical-power"><i class="fa fa-check"></i><b>29.1.3</b> Statistical Power</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="testing.html"><a href="testing.html"><i class="fa fa-check"></i><b>29.2</b> Testing</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="testing.html"><a href="testing.html#parametric-test"><i class="fa fa-check"></i><b>29.2.1</b> Parametric Test</a></li>
<li class="chapter" data-level="29.2.2" data-path="testing.html"><a href="testing.html#non-parametric-test"><i class="fa fa-check"></i><b>29.2.2</b> Non-parametric Test</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="sample.html"><a href="sample.html"><i class="fa fa-check"></i><b>29.3</b> Sample</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="sample.html"><a href="sample.html#confounders"><i class="fa fa-check"></i><b>29.3.1</b> Confounders</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="biases.html"><a href="biases.html"><i class="fa fa-check"></i><b>29.4</b> Biases</a></li>
<li class="chapter" data-level="29.5" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html"><i class="fa fa-check"></i><b>29.5</b> Long-run event studies</a>
<ul>
<li class="chapter" data-level="29.5.1" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#buy-and-hold-abnormal-returns-bhar"><i class="fa fa-check"></i><b>29.5.1</b> Buy and Hold Abnormal Returns (BHAR)</a></li>
<li class="chapter" data-level="29.5.2" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#long-term-cumulative-abnormal-returns-lcars"><i class="fa fa-check"></i><b>29.5.2</b> Long-term Cumulative Abnormal Returns (LCARs)</a></li>
<li class="chapter" data-level="29.5.3" data-path="long-run-event-studies.html"><a href="long-run-event-studies.html#calendar-time-portfolio-abnormal-returns-ctars"><i class="fa fa-check"></i><b>29.5.3</b> Calendar-time Portfolio Abnormal Returns (CTARs)</a></li>
</ul></li>
<li class="chapter" data-level="29.6" data-path="aggregation.html"><a href="aggregation.html"><i class="fa fa-check"></i><b>29.6</b> Aggregation</a>
<ul>
<li class="chapter" data-level="29.6.1" data-path="aggregation.html"><a href="aggregation.html#over-time"><i class="fa fa-check"></i><b>29.6.1</b> Over Time</a></li>
<li class="chapter" data-level="29.6.2" data-path="aggregation.html"><a href="aggregation.html#across-firms-over-time"><i class="fa fa-check"></i><b>29.6.2</b> Across Firms + Over Time</a></li>
</ul></li>
<li class="chapter" data-level="29.7" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html"><i class="fa fa-check"></i><b>29.7</b> Heterogeneity in the event effect</a>
<ul>
<li class="chapter" data-level="29.7.1" data-path="heterogeneity-in-the-event-effect.html"><a href="heterogeneity-in-the-event-effect.html#common-variables-in-marketing"><i class="fa fa-check"></i><b>29.7.1</b> Common variables in marketing</a></li>
</ul></li>
<li class="chapter" data-level="29.8" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html"><i class="fa fa-check"></i><b>29.8</b> Expected Return Calculation</a>
<ul>
<li class="chapter" data-level="29.8.1" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#statistical-models"><i class="fa fa-check"></i><b>29.8.1</b> Statistical Models</a></li>
<li class="chapter" data-level="29.8.2" data-path="expected-return-calculation.html"><a href="expected-return-calculation.html#economic-model"><i class="fa fa-check"></i><b>29.8.2</b> Economic Model</a></li>
</ul></li>
<li class="chapter" data-level="29.9" data-path="application-14.html"><a href="application-14.html"><i class="fa fa-check"></i><b>29.9</b> Application</a>
<ul>
<li class="chapter" data-level="29.9.1" data-path="application-14.html"><a href="application-14.html#eventus"><i class="fa fa-check"></i><b>29.9.1</b> Eventus</a></li>
<li class="chapter" data-level="29.9.2" data-path="application-14.html"><a href="application-14.html#evenstudies"><i class="fa fa-check"></i><b>29.9.2</b> Evenstudies</a></li>
<li class="chapter" data-level="29.9.3" data-path="application-14.html"><a href="application-14.html#eventstudy"><i class="fa fa-check"></i><b>29.9.3</b> EventStudy</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="instrumental-variables.html"><a href="instrumental-variables.html"><i class="fa fa-check"></i><b>30</b> Instrumental Variables</a>
<ul>
<li class="chapter" data-level="30.1" data-path="framework.html"><a href="framework.html"><i class="fa fa-check"></i><b>30.1</b> Framework</a></li>
<li class="chapter" data-level="30.2" data-path="estimation-4.html"><a href="estimation-4.html"><i class="fa fa-check"></i><b>30.2</b> Estimation</a>
<ul>
<li class="chapter" data-level="30.2.1" data-path="estimation-4.html"><a href="estimation-4.html#sls-estimation"><i class="fa fa-check"></i><b>30.2.1</b> 2SLS Estimation</a></li>
<li class="chapter" data-level="30.2.2" data-path="estimation-4.html"><a href="estimation-4.html#iv-gmm"><i class="fa fa-check"></i><b>30.2.2</b> IV-GMM</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="inference-4.html"><a href="inference-4.html"><i class="fa fa-check"></i><b>30.3</b> Inference</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="inference-4.html"><a href="inference-4.html#ar-approach"><i class="fa fa-check"></i><b>30.3.1</b> AR approach</a></li>
<li class="chapter" data-level="30.3.2" data-path="inference-4.html"><a href="inference-4.html#tf-procedure"><i class="fa fa-check"></i><b>30.3.2</b> tF Procedure</a></li>
<li class="chapter" data-level="30.3.3" data-path="inference-4.html"><a href="inference-4.html#ak-approach"><i class="fa fa-check"></i><b>30.3.3</b> AK approach</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="testing-assumptions.html"><a href="testing-assumptions.html"><i class="fa fa-check"></i><b>30.4</b> Testing Assumptions</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="testing-assumptions.html"><a href="testing-assumptions.html#relevance-assumption"><i class="fa fa-check"></i><b>30.4.1</b> Relevance Assumption</a></li>
<li class="chapter" data-level="30.4.2" data-path="testing-assumptions.html"><a href="testing-assumptions.html#exogeneity-assumption"><i class="fa fa-check"></i><b>30.4.2</b> Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="negative-r2.html"><a href="negative-r2.html"><i class="fa fa-check"></i><b>30.5</b> Negative <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="30.6" data-path="treatment-intensity.html"><a href="treatment-intensity.html"><i class="fa fa-check"></i><b>30.6</b> Treatment Intensity</a></li>
<li class="chapter" data-level="30.7" data-path="control-function.html"><a href="control-function.html"><i class="fa fa-check"></i><b>30.7</b> Control Function</a>
<ul>
<li class="chapter" data-level="30.7.1" data-path="control-function.html"><a href="control-function.html#simulation"><i class="fa fa-check"></i><b>30.7.1</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="30.8" data-path="new-advances.html"><a href="new-advances.html"><i class="fa fa-check"></i><b>30.8</b> New Advances</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="matching-methods.html"><a href="matching-methods.html"><i class="fa fa-check"></i><b>31</b> Matching Methods</a>
<ul>
<li class="chapter" data-level="31.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html"><i class="fa fa-check"></i><b>31.1</b> Selection on Observables</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchit"><i class="fa fa-check"></i><b>31.1.1</b> MatchIt</a></li>
<li class="chapter" data-level="31.1.2" data-path="selection-on-observables.html"><a href="selection-on-observables.html#designmatch"><i class="fa fa-check"></i><b>31.1.2</b> designmatch</a></li>
<li class="chapter" data-level="31.1.3" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matchingfrontier"><i class="fa fa-check"></i><b>31.1.3</b> MatchingFrontier</a></li>
<li class="chapter" data-level="31.1.4" data-path="selection-on-observables.html"><a href="selection-on-observables.html#propensity-scores"><i class="fa fa-check"></i><b>31.1.4</b> Propensity Scores</a></li>
<li class="chapter" data-level="31.1.5" data-path="selection-on-observables.html"><a href="selection-on-observables.html#mahalanobis-distance"><i class="fa fa-check"></i><b>31.1.5</b> Mahalanobis Distance</a></li>
<li class="chapter" data-level="31.1.6" data-path="selection-on-observables.html"><a href="selection-on-observables.html#coarsened-exact-matching"><i class="fa fa-check"></i><b>31.1.6</b> Coarsened Exact Matching</a></li>
<li class="chapter" data-level="31.1.7" data-path="selection-on-observables.html"><a href="selection-on-observables.html#genetic-matching"><i class="fa fa-check"></i><b>31.1.7</b> Genetic Matching</a></li>
<li class="chapter" data-level="31.1.8" data-path="selection-on-observables.html"><a href="selection-on-observables.html#entropy-balancing"><i class="fa fa-check"></i><b>31.1.8</b> Entropy Balancing</a></li>
<li class="chapter" data-level="31.1.9" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-high-dimensional-data"><i class="fa fa-check"></i><b>31.1.9</b> Matching for high-dimensional data</a></li>
<li class="chapter" data-level="31.1.10" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-time-series-cross-section-data"><i class="fa fa-check"></i><b>31.1.10</b> Matching for time series-cross-section data</a></li>
<li class="chapter" data-level="31.1.11" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multiple-treatments"><i class="fa fa-check"></i><b>31.1.11</b> Matching for multiple treatments</a></li>
<li class="chapter" data-level="31.1.12" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-multi-level-treatments"><i class="fa fa-check"></i><b>31.1.12</b> Matching for multi-level treatments</a></li>
<li class="chapter" data-level="31.1.13" data-path="selection-on-observables.html"><a href="selection-on-observables.html#matching-for-repeated-treatments"><i class="fa fa-check"></i><b>31.1.13</b> Matching for repeated treatments</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html"><i class="fa fa-check"></i><b>31.2</b> Selection on Unobservables</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#rosenbaum-bounds"><i class="fa fa-check"></i><b>31.2.1</b> Rosenbaum Bounds</a></li>
<li class="chapter" data-level="31.2.2" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#relative-correlation-restrictions"><i class="fa fa-check"></i><b>31.2.2</b> Relative Correlation Restrictions</a></li>
<li class="chapter" data-level="31.2.3" data-path="selection-on-unobservables.html"><a href="selection-on-unobservables.html#coefficient-stability-bounds"><i class="fa fa-check"></i><b>31.2.3</b> Coefficient-stability Bounds</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="interrupted-time-series.html"><a href="interrupted-time-series.html"><i class="fa fa-check"></i><b>32</b> Interrupted Time Series</a>
<ul>
<li class="chapter" data-level="32.1" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>32.1</b> Autocorrelation</a></li>
<li class="chapter" data-level="32.2" data-path="multiple-groups.html"><a href="multiple-groups.html"><i class="fa fa-check"></i><b>32.2</b> Multiple Groups</a></li>
</ul></li>
<li class="part"><span><b>C. OTHER CONCERNS</b></span></li>
<li class="chapter" data-level="33" data-path="endogeneity.html"><a href="endogeneity.html"><i class="fa fa-check"></i><b>33</b> Endogeneity</a>
<ul>
<li class="chapter" data-level="33.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html"><i class="fa fa-check"></i><b>33.1</b> Endogenous Treatment</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#measurement-error"><i class="fa fa-check"></i><b>33.1.1</b> Measurement Error</a></li>
<li class="chapter" data-level="33.1.2" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#simultaneity"><i class="fa fa-check"></i><b>33.1.2</b> Simultaneity</a></li>
<li class="chapter" data-level="33.1.3" data-path="endogenous-treatment.html"><a href="endogenous-treatment.html#endogenous-treatment-solutions"><i class="fa fa-check"></i><b>33.1.3</b> Endogenous Treatment Solutions</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html"><i class="fa fa-check"></i><b>33.2</b> Endogenous Sample Selection</a>
<ul>
<li class="chapter" data-level="33.2.1" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-2"><i class="fa fa-check"></i><b>33.2.1</b> Tobit-2</a></li>
<li class="chapter" data-level="33.2.2" data-path="endogenous-sample-selection.html"><a href="endogenous-sample-selection.html#tobit-5"><i class="fa fa-check"></i><b>33.2.2</b> Tobit-5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="other-biases.html"><a href="other-biases.html"><i class="fa fa-check"></i><b>34</b> Other Biases</a>
<ul>
<li class="chapter" data-level="34.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html"><i class="fa fa-check"></i><b>34.1</b> Aggregation Bias</a>
<ul>
<li class="chapter" data-level="34.1.1" data-path="aggregation-bias.html"><a href="aggregation-bias.html#simpsons-paradox"><i class="fa fa-check"></i><b>34.1.1</b> Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="34.2" data-path="contamination-bias.html"><a href="contamination-bias.html"><i class="fa fa-check"></i><b>34.2</b> Contamination Bias</a></li>
<li class="chapter" data-level="34.3" data-path="survivorship-bias.html"><a href="survivorship-bias.html"><i class="fa fa-check"></i><b>34.3</b> Survivorship Bias</a></li>
<li class="chapter" data-level="34.4" data-path="publication-bias.html"><a href="publication-bias.html"><i class="fa fa-check"></i><b>34.4</b> Publication Bias</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="controls.html"><a href="controls.html"><i class="fa fa-check"></i><b>35</b> Controls</a>
<ul>
<li class="chapter" data-level="35.1" data-path="bad-controls.html"><a href="bad-controls.html"><i class="fa fa-check"></i><b>35.1</b> Bad Controls</a>
<ul>
<li class="chapter" data-level="35.1.1" data-path="bad-controls.html"><a href="bad-controls.html#m-bias"><i class="fa fa-check"></i><b>35.1.1</b> M-bias</a></li>
<li class="chapter" data-level="35.1.2" data-path="bad-controls.html"><a href="bad-controls.html#bias-amplification-1"><i class="fa fa-check"></i><b>35.1.2</b> Bias Amplification</a></li>
<li class="chapter" data-level="35.1.3" data-path="bad-controls.html"><a href="bad-controls.html#overcontrol-bias"><i class="fa fa-check"></i><b>35.1.3</b> Overcontrol bias</a></li>
<li class="chapter" data-level="35.1.4" data-path="bad-controls.html"><a href="bad-controls.html#selection-bias"><i class="fa fa-check"></i><b>35.1.4</b> Selection Bias</a></li>
<li class="chapter" data-level="35.1.5" data-path="bad-controls.html"><a href="bad-controls.html#case-control-bias"><i class="fa fa-check"></i><b>35.1.5</b> Case-control Bias</a></li>
</ul></li>
<li class="chapter" data-level="35.2" data-path="good-controls.html"><a href="good-controls.html"><i class="fa fa-check"></i><b>35.2</b> Good Controls</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-correction"><i class="fa fa-check"></i><b>35.2.1</b> Omitted Variable Bias Correction</a></li>
<li class="chapter" data-level="35.2.2" data-path="good-controls.html"><a href="good-controls.html#omitted-variable-bias-in-mediation-correction"><i class="fa fa-check"></i><b>35.2.2</b> Omitted Variable Bias in Mediation Correction</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="neutral-controls.html"><a href="neutral-controls.html"><i class="fa fa-check"></i><b>35.3</b> Neutral Controls</a>
<ul>
<li class="chapter" data-level="35.3.1" data-path="neutral-controls.html"><a href="neutral-controls.html#good-predictive-controls"><i class="fa fa-check"></i><b>35.3.1</b> Good Predictive Controls</a></li>
<li class="chapter" data-level="35.3.2" data-path="neutral-controls.html"><a href="neutral-controls.html#good-selection-bias"><i class="fa fa-check"></i><b>35.3.2</b> Good Selection Bias</a></li>
<li class="chapter" data-level="35.3.3" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-predictive-controls"><i class="fa fa-check"></i><b>35.3.3</b> Bad Predictive Controls</a></li>
<li class="chapter" data-level="35.3.4" data-path="neutral-controls.html"><a href="neutral-controls.html#bad-selection-bias"><i class="fa fa-check"></i><b>35.3.4</b> Bad Selection Bias</a></li>
</ul></li>
<li class="chapter" data-level="35.4" data-path="choosing-controls.html"><a href="choosing-controls.html"><i class="fa fa-check"></i><b>35.4</b> Choosing Controls</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="mediation.html"><a href="mediation.html"><i class="fa fa-check"></i><b>36</b> Mediation</a>
<ul>
<li class="chapter" data-level="36.1" data-path="traditional-approach.html"><a href="traditional-approach.html"><i class="fa fa-check"></i><b>36.1</b> Traditional Approach</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="traditional-approach.html"><a href="traditional-approach.html#assumptions-3"><i class="fa fa-check"></i><b>36.1.1</b> Assumptions</a></li>
<li class="chapter" data-level="36.1.2" data-path="traditional-approach.html"><a href="traditional-approach.html#indirect-effect-tests"><i class="fa fa-check"></i><b>36.1.2</b> Indirect Effect Tests</a></li>
<li class="chapter" data-level="36.1.3" data-path="traditional-approach.html"><a href="traditional-approach.html#multiple-mediation"><i class="fa fa-check"></i><b>36.1.3</b> Multiple Mediation</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="causal-inference-approach.html"><a href="causal-inference-approach.html"><i class="fa fa-check"></i><b>36.2</b> Causal Inference Approach</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="causal-inference-approach.html"><a href="causal-inference-approach.html#example-1-mediation-traditional"><i class="fa fa-check"></i><b>36.2.1</b> Example 1</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="model-based-causal-mediation-analysis.html"><a href="model-based-causal-mediation-analysis.html"><i class="fa fa-check"></i><b>36.3</b> Model-based causal mediation analysis</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="directed-acyclic-graph.html"><a href="directed-acyclic-graph.html"><i class="fa fa-check"></i><b>37</b> Directed Acyclic Graph</a>
<ul>
<li class="chapter" data-level="37.1" data-path="basic-notations.html"><a href="basic-notations.html"><i class="fa fa-check"></i><b>37.1</b> Basic Notations</a></li>
</ul></li>
<li class="part"><span><b>V. MISCELLANEOUS</b></span></li>
<li class="chapter" data-level="38" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>38</b> Report</a>
<ul>
<li class="chapter" data-level="38.1" data-path="one-summary-table.html"><a href="one-summary-table.html"><i class="fa fa-check"></i><b>38.1</b> One summary table</a></li>
<li class="chapter" data-level="38.2" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>38.2</b> Model Comparison</a></li>
<li class="chapter" data-level="38.3" data-path="changes-in-an-estimate.html"><a href="changes-in-an-estimate.html"><i class="fa fa-check"></i><b>38.3</b> Changes in an estimate</a></li>
<li class="chapter" data-level="38.4" data-path="standard-errors-3.html"><a href="standard-errors-3.html"><i class="fa fa-check"></i><b>38.4</b> Standard Errors</a></li>
<li class="chapter" data-level="38.5" data-path="coefficient-uncertainty-and-distribution.html"><a href="coefficient-uncertainty-and-distribution.html"><i class="fa fa-check"></i><b>38.5</b> Coefficient Uncertainty and Distribution</a></li>
<li class="chapter" data-level="38.6" data-path="descriptive-tables.html"><a href="descriptive-tables.html"><i class="fa fa-check"></i><b>38.6</b> Descriptive Tables</a></li>
<li class="chapter" data-level="38.7" data-path="visualizations-and-plots.html"><a href="visualizations-and-plots.html"><i class="fa fa-check"></i><b>38.7</b> Visualizations and Plots</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>39</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="40" data-path="sensitivity-analysis-robustness-check.html"><a href="sensitivity-analysis-robustness-check.html"><i class="fa fa-check"></i><b>40</b> Sensitivity Analysis/ Robustness Check</a>
<ul>
<li class="chapter" data-level="40.1" data-path="specification-curve.html"><a href="specification-curve.html"><i class="fa fa-check"></i><b>40.1</b> Specification curve</a>
<ul>
<li class="chapter" data-level="40.1.1" data-path="specification-curve.html"><a href="specification-curve.html#starbility"><i class="fa fa-check"></i><b>40.1.1</b> starbility</a></li>
<li class="chapter" data-level="40.1.2" data-path="specification-curve.html"><a href="specification-curve.html#rdfanalysis"><i class="fa fa-check"></i><b>40.1.2</b> rdfanalysis</a></li>
</ul></li>
<li class="chapter" data-level="40.2" data-path="coefficient-stability.html"><a href="coefficient-stability.html"><i class="fa fa-check"></i><b>40.2</b> Coefficient stability</a></li>
<li class="chapter" data-level="40.3" data-path="omitted-variable-bias-quantification.html"><a href="omitted-variable-bias-quantification.html"><i class="fa fa-check"></i><b>40.3</b> Omitted Variable Bias Quantification</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="replication-and-synthetic-data.html"><a href="replication-and-synthetic-data.html"><i class="fa fa-check"></i><b>41</b> Replication and Synthetic Data</a>
<ul>
<li class="chapter" data-level="41.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html"><i class="fa fa-check"></i><b>41.1</b> The Replication Standard</a>
<ul>
<li class="chapter" data-level="41.1.1" data-path="the-replication-standard.html"><a href="the-replication-standard.html#solutions-for-empirical-replication"><i class="fa fa-check"></i><b>41.1.1</b> Solutions for Empirical Replication</a></li>
<li class="chapter" data-level="41.1.2" data-path="the-replication-standard.html"><a href="the-replication-standard.html#free-data-repositories"><i class="fa fa-check"></i><b>41.1.2</b> Free Data Repositories</a></li>
<li class="chapter" data-level="41.1.3" data-path="the-replication-standard.html"><a href="the-replication-standard.html#exceptions-to-replication"><i class="fa fa-check"></i><b>41.1.3</b> Exceptions to Replication</a></li>
</ul></li>
<li class="chapter" data-level="41.2" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html"><i class="fa fa-check"></i><b>41.2</b> Synthetic Data: An Overview</a>
<ul>
<li class="chapter" data-level="41.2.1" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#benefits"><i class="fa fa-check"></i><b>41.2.1</b> Benefits</a></li>
<li class="chapter" data-level="41.2.2" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#concerns"><i class="fa fa-check"></i><b>41.2.2</b> Concerns</a></li>
<li class="chapter" data-level="41.2.3" data-path="synthetic-data-an-overview.html"><a href="synthetic-data-an-overview.html#further-insights-on-synthetic-data"><i class="fa fa-check"></i><b>41.2.3</b> Further Insights on Synthetic Data</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="application-15.html"><a href="application-15.html"><i class="fa fa-check"></i><b>41.3</b> Application</a></li>
</ul></li>
<li class="appendix"><span><b>APPENDIX</b></span></li>
<li class="chapter" data-level="A" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>A</b> Appendix</a>
<ul>
<li class="chapter" data-level="A.1" data-path="git.html"><a href="git.html"><i class="fa fa-check"></i><b>A.1</b> Git</a></li>
<li class="chapter" data-level="A.2" data-path="short-cut.html"><a href="short-cut.html"><i class="fa fa-check"></i><b>A.2</b> Short-cut</a></li>
<li class="chapter" data-level="A.3" data-path="function-short-cut.html"><a href="function-short-cut.html"><i class="fa fa-check"></i><b>A.3</b> Function short-cut</a></li>
<li class="chapter" data-level="A.4" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>A.4</b> Citation</a></li>
<li class="chapter" data-level="A.5" data-path="install-all-necessary-packageslibaries-on-your-local-machine.html"><a href="install-all-necessary-packageslibaries-on-your-local-machine.html"><i class="fa fa-check"></i><b>A.5</b> Install all necessary packages/libaries on your local machine</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="bookdown-cheat-sheet.html"><a href="bookdown-cheat-sheet.html"><i class="fa fa-check"></i><b>B</b> Bookdown cheat sheet</a>
<ul>
<li class="chapter" data-level="B.1" data-path="operation.html"><a href="operation.html"><i class="fa fa-check"></i><b>B.1</b> Operation</a></li>
<li class="chapter" data-level="B.2" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html"><i class="fa fa-check"></i><b>B.2</b> Math Expression/ Syntax</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="math-expression-syntax.html"><a href="math-expression-syntax.html#statistics-notation"><i class="fa fa-check"></i><b>B.2.1</b> Statistics Notation</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>B.3</b> Table</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Guide on Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="endogenous-sample-selection" class="section level2 hasAnchor" number="33.2">
<h2><span class="header-section-number">33.2</span> Endogenous Sample Selection<a href="endogenous-sample-selection.html#endogenous-sample-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Also known as sample selection or self-selection problem or incidental truncation.</p></li>
<li><p>The omitted variable is how people were selected into the sample</p></li>
</ul>
<p>Some disciplines consider nonresponse bias and selection bias as sample selection.</p>
<ul>
<li>When unobservable factors that affect who is in the sample are independent of unobservable factors that affect the outcome, the sample selection is not endogenous. Hence, the sample selection is ignorable and estimator that ignores sample selection is still consistent.</li>
<li>when the unobservable factors that affect who is included in the sample are correlated with the unobservable factors that affect the outcome, the sample selection is endogenous and not ignorable, because estimators that ignore endogenous sample selection are not consistent (we don’t know which part of the observable outcome is related to the causal relationship and which part is due to different people were selected for the treatment and control groups).</li>
</ul>
<p>Assumptions: - The unobservables that affect the treatment selection and the outcome are jointly distributed as bivariate normal.</p>
<p><strong>Notes</strong>:</p>
<ul>
<li><p>If you don’t have strong exclusion restriction, identification is driven by the assumed non linearity in the functional form (through inverse Mills ratio). E.g., the estimate depend on the bivariate normal distribution of the error structure:</p>
<ul>
<li>With strong exclusion restriction for the covariate in the correction equation, the variation in this variable can help identify the control for selection</li>
<li>With weak exclusion restriction, and the variable exists in both steps, it’s the assumed error structure that identifies the control for selection <span class="citation">(<a href="#ref-heckman2004using">J. Heckman and Navarro-Lozano 2004</a>)</span>.</li>
</ul></li>
<li><p>In management, <span class="citation">Wolfolds and Siegel (<a href="#ref-wolfolds2019misaccounting">2019</a>)</span> found that papers should have valid exclusion conditions, because without these, simulations show that results using the Heckman method are less reliable than those obtained with OLS.</p></li>
<li><p>There are differences between Heckman Sample Selection vs. Heckman-type correction</p></li>
</ul>
<table>
<colgroup>
<col width="23%" />
<col width="29%" />
<col width="47%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Heckman Sample Selection Model</strong></th>
<th><strong>Heckman-Type Corrections</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>When</td>
<td>Only observes one sample (treated), addressing selection bias directly.</td>
<td>Two samples are observed (treated and untreated), known as the control function approach.</td>
</tr>
<tr class="even">
<td>Model</td>
<td>Probit</td>
<td>OLS (even for dummy endogenous variable)</td>
</tr>
<tr class="odd">
<td>Integration of 1st stage</td>
<td>Also include a term (called Inverse Mills ratio) besides the endogenous variable.</td>
<td>Decompose the endogenous variable to get the part that is uncorrelated with the error terms of the outcome equation. Either use the predicted endogenous variable directly or include the residual from the first-stage equation.</td>
</tr>
<tr class="even">
<td>Advantages and Assumptions</td>
<td>Provides a direct test for endogeneity via the coefficient of the inverse Mills ratio but requires the assumption of joint normality of errors.</td>
<td>Does not require the assumption of joint normality, but can’t test for endogeneity directly.</td>
</tr>
</tbody>
</table>
<p>To deal with [Sample Selection], we can</p>
<ul>
<li>Randomization: participants are randomly selected into treatment and control.</li>
<li>Instruments that determine the treatment status (i.e., treatment vs. control) but not the outcome (<span class="math inline">\(Y\)</span>)</li>
<li>Functional form of the selection and outcome processes: originated from <span class="citation">(<a href="#ref-Heckman_1976">James J. Heckman 1976</a>)</span>, later on generalize by <span class="citation">(<a href="#ref-amemiya1984tobit">Amemiya 1984</a>)</span></li>
</ul>
<p>We have our main model</p>
<p><span class="math display">\[
\mathbf{y^* = xb + \epsilon}
\]</span></p>
<p>However, the pattern of missingness (i.e., censored) is related to the unobserved (latent) process:</p>
<p><span class="math display">\[
\mathbf{z^* = w \gamma + u}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
z_i =
\begin{cases}
1&amp; \text{if } z_i^*&gt;0 \\
0&amp;\text{if } z_i^*\le0\\
\end{cases}
\]</span></p>
<p>Equivalently, <span class="math inline">\(z_i = 1\)</span> (<span class="math inline">\(y_i\)</span> is observed) when</p>
<p><span class="math display">\[
u_i \ge -w_i \gamma
\]</span></p>
<p>Hence, the probability of observed <span class="math inline">\(y_i\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
P(u_i \ge -w_i \gamma) &amp;= 1 - \Phi(-w_i \gamma) \\
&amp;= \Phi(w_i \gamma) &amp; \text{symmetry of the standard normal distribution}
\end{aligned}
\]</span></p>
<p>We will <strong>assume</strong></p>
<ul>
<li>the error term of the selection <span class="math inline">\(\mathbf{u \sim N(0,I)}\)</span></li>
<li><span class="math inline">\(Var(u_i) = 1\)</span> for identification purposes</li>
</ul>
<p>Visually, <span class="math inline">\(P(u_i \ge -w_i \gamma)\)</span> is the shaded area.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="endogenous-sample-selection.html#cb687-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">200</span>)</span>
<span id="cb687-2"><a href="endogenous-sample-selection.html#cb687-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb687-3"><a href="endogenous-sample-selection.html#cb687-3" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb687-4"><a href="endogenous-sample-selection.html#cb687-4" tabindex="-1"></a>     y,</span>
<span id="cb687-5"><a href="endogenous-sample-selection.html#cb687-5" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb687-6"><a href="endogenous-sample-selection.html#cb687-6" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">&quot;Probabibility distribution of&quot;</span> <span class="sc">~</span> u[i]))</span>
<span id="cb687-7"><a href="endogenous-sample-selection.html#cb687-7" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb687-8"><a href="endogenous-sample-selection.html#cb687-8" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb687-9"><a href="endogenous-sample-selection.html#cb687-9" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, x, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">0</span>, y, <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb687-10"><a href="endogenous-sample-selection.html#cb687-10" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fu">bquote</span>(<span class="dv">1</span> <span class="sc">-</span> Phi <span class="sc">~</span> (<span class="sc">-</span>w[i] <span class="sc">~</span> gamma)))</span>
<span id="cb687-11"><a href="endogenous-sample-selection.html#cb687-11" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="dv">0</span>, <span class="at">length =</span> .<span class="dv">15</span>)</span>
<span id="cb687-12"><a href="endogenous-sample-selection.html#cb687-12" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.12</span>, <span class="fu">bquote</span>(<span class="sc">-</span>w[i] <span class="sc">~</span> gamma))</span>
<span id="cb687-13"><a href="endogenous-sample-selection.html#cb687-13" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb687-14"><a href="endogenous-sample-selection.html#cb687-14" tabindex="-1"></a>    <span class="st">&quot;topright&quot;</span>,</span>
<span id="cb687-15"><a href="endogenous-sample-selection.html#cb687-15" tabindex="-1"></a>    <span class="st">&quot;Gray = Prob of Observed&quot;</span>,</span>
<span id="cb687-16"><a href="endogenous-sample-selection.html#cb687-16" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">1</span>,</span>
<span id="cb687-17"><a href="endogenous-sample-selection.html#cb687-17" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;legend&quot;</span>,</span>
<span id="cb687-18"><a href="endogenous-sample-selection.html#cb687-18" tabindex="-1"></a>    <span class="at">inset =</span> .<span class="dv">02</span></span>
<span id="cb687-19"><a href="endogenous-sample-selection.html#cb687-19" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="33-endogeneity_files/figure-html/unnamed-chunk-12-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Hence in our observed model, we see</p>
<span class="math display">\[\begin{equation}
y_i = x_i\beta + \epsilon_i \text{when $z_i=1$}
\end{equation}\]</span>
<p>and the joint distribution of the selection model (<span class="math inline">\(u_i\)</span>), and the observed equation (<span class="math inline">\(\epsilon_i\)</span>) as</p>
<p><span class="math display">\[
\left[
\begin{array}
{c}
u \\
\epsilon \\
\end{array}
\right]
\sim^{iid}N
\left(
\left[
\begin{array}
{c}
0 \\
0 \\
\end{array}
\right],
\left[
\begin{array}
{cc}
1 &amp; \rho \\
\rho &amp; \sigma^2_{\epsilon} \\
\end{array}
\right]
\right)
\]</span></p>
<p>The relation between the observed and selection models:</p>
<p><span class="math display">\[
\begin{aligned}
E(y_i | y_i \text{ observed}) &amp;= E(y_i| z^*&gt;0) \\
&amp;= E(y_i| -w_i \gamma) \\
&amp;= \mathbf{x}_i \beta + E(\epsilon_i | u_i &gt; -w_i \gamma) \\
&amp;= \mathbf{x}_i \beta + \rho \sigma_\epsilon \frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)}\)</span> is the Inverse Mills Ratio. and <span class="math inline">\(\rho \sigma_\epsilon \frac{\phi(w_i \gamma)}{\Phi(w_i \gamma)} \ge 0\)</span></p>
<p>A property of IMR: Its derivative is: <span class="math inline">\(IMR&#39;(x) = -x IMR(x) - IMR(x)^2\)</span></p>
<p>Great visualization of special cases of correlation patterns among data and errors by professor <a href="https://rlhick.people.wm.edu/stories/econ_407_notes_heckman.html">Rob Hick</a></p>
<p>Note:</p>
<p><span class="citation">(<a href="#ref-bareinboim2014transportability">Bareinboim and Pearl 2014</a>)</span> is an excellent summary of cases that we can still do causal inference in case of selection bias. I’ll try to summarize their idea here:</p>
<p>Let <span class="math inline">\(X\)</span> be an action, <span class="math inline">\(Y\)</span> be an outcome, and S be a binary indicator of entry into the data pool where (<span class="math inline">\(S = 1 =\)</span> in the sample, <span class="math inline">\(S = 0 =\)</span> out of sample) and Q be the conditional distribution <span class="math inline">\(Q = P(y|x)\)</span>.</p>
<p>Usually we want to understand , but because of <span class="math inline">\(S\)</span>, we only have <span class="math inline">\(P(y, x|S = 1)\)</span>. Hence, we’d like to recover <span class="math inline">\(P(y|x)\)</span> from <span class="math inline">\(P(y, x|S = 1)\)</span></p>
<ul>
<li>If both X and Y affect S, we can’t unbiasedly estimate <span class="math inline">\(P(y|x)\)</span></li>
</ul>
<p>In the case of Omitted variable bias (<span class="math inline">\(U\)</span>) and sample selection bias (<span class="math inline">\(S\)</span>), you have unblocked extraneous “flow” of information between X and <span class="math inline">\(Y\)</span>, which causes spurious correlation for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Traditionally, we would recover <span class="math inline">\(Q\)</span> by parametric assumption of</p>
<ol style="list-style-type: decimal">
<li>The data generating process (e.g., Heckman 2-step)</li>
<li>Type of data-generating model (e..g, treatment-dependent or outcome-dependent)</li>
<li>Selection’s probability <span class="math inline">\(P(S = 1|P a_s)\)</span> with non-parametrically based causal graphical models, the authors proposed more robust way to model misspecification regardless of the type of data-generating model, and do not require selection’s probability. Hence, you can recover Q
<ul>
<li>Without external data</li>
<li>With external data</li>
<li>Causal effects with the Selection-backdoor criterion</li>
</ul></li>
</ol>
<div id="tobit-2" class="section level3 hasAnchor" number="33.2.1">
<h3><span class="header-section-number">33.2.1</span> Tobit-2<a href="endogenous-sample-selection.html#tobit-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>also known as Heckman’s standard sample selection model<br />
Assumption: joint normality of the errors</p>
<p>Data here is taken from <span class="citation">Mroz (<a href="#ref-mroz1984sensitivity">1984</a>)</span>.</p>
<p>We want to estimate the log(wage) for married women, with education, experience, experience squared, and a dummy variable for living in a big city. But we can only observe the wage for women who are working, which means a lot of married women in 1975 who were out of the labor force are unaccounted for. Hence, an OLS estimate of the wage equation would be bias due to sample selection. Since we have data on non-participants (i.e., those who are not working for pay), we can correct for the selection process.</p>
<p>The Tobit-2 estimates are consistent</p>
<div id="example-1-3" class="section level4 hasAnchor" number="33.2.1.1">
<h4><span class="header-section-number">33.2.1.1</span> Example 1<a href="endogenous-sample-selection.html#example-1-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="endogenous-sample-selection.html#cb688-1" tabindex="-1"></a><span class="fu">library</span>(sampleSelection)</span>
<span id="cb688-2"><a href="endogenous-sample-selection.html#cb688-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb688-3"><a href="endogenous-sample-selection.html#cb688-3" tabindex="-1"></a><span class="co"># 1975 data on married women’s pay and labor-force participation </span></span>
<span id="cb688-4"><a href="endogenous-sample-selection.html#cb688-4" tabindex="-1"></a><span class="co"># from the Panel Study of Income Dynamics (PSID)</span></span>
<span id="cb688-5"><a href="endogenous-sample-selection.html#cb688-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Mroz87&quot;</span>) </span>
<span id="cb688-6"><a href="endogenous-sample-selection.html#cb688-6" tabindex="-1"></a><span class="fu">head</span>(Mroz87)</span>
<span id="cb688-7"><a href="endogenous-sample-selection.html#cb688-7" tabindex="-1"></a><span class="co">#&gt;   lfp hours kids5 kids618 age educ   wage repwage hushrs husage huseduc huswage</span></span>
<span id="cb688-8"><a href="endogenous-sample-selection.html#cb688-8" tabindex="-1"></a><span class="co">#&gt; 1   1  1610     1       0  32   12 3.3540    2.65   2708     34      12  4.0288</span></span>
<span id="cb688-9"><a href="endogenous-sample-selection.html#cb688-9" tabindex="-1"></a><span class="co">#&gt; 2   1  1656     0       2  30   12 1.3889    2.65   2310     30       9  8.4416</span></span>
<span id="cb688-10"><a href="endogenous-sample-selection.html#cb688-10" tabindex="-1"></a><span class="co">#&gt; 3   1  1980     1       3  35   12 4.5455    4.04   3072     40      12  3.5807</span></span>
<span id="cb688-11"><a href="endogenous-sample-selection.html#cb688-11" tabindex="-1"></a><span class="co">#&gt; 4   1   456     0       3  34   12 1.0965    3.25   1920     53      10  3.5417</span></span>
<span id="cb688-12"><a href="endogenous-sample-selection.html#cb688-12" tabindex="-1"></a><span class="co">#&gt; 5   1  1568     1       2  31   14 4.5918    3.60   2000     32      12 10.0000</span></span>
<span id="cb688-13"><a href="endogenous-sample-selection.html#cb688-13" tabindex="-1"></a><span class="co">#&gt; 6   1  2032     0       0  54   12 4.7421    4.70   1040     57      11  6.7106</span></span>
<span id="cb688-14"><a href="endogenous-sample-selection.html#cb688-14" tabindex="-1"></a><span class="co">#&gt;   faminc    mtr motheduc fatheduc unem city exper  nwifeinc wifecoll huscoll</span></span>
<span id="cb688-15"><a href="endogenous-sample-selection.html#cb688-15" tabindex="-1"></a><span class="co">#&gt; 1  16310 0.7215       12        7  5.0    0    14 10.910060    FALSE   FALSE</span></span>
<span id="cb688-16"><a href="endogenous-sample-selection.html#cb688-16" tabindex="-1"></a><span class="co">#&gt; 2  21800 0.6615        7        7 11.0    1     5 19.499981    FALSE   FALSE</span></span>
<span id="cb688-17"><a href="endogenous-sample-selection.html#cb688-17" tabindex="-1"></a><span class="co">#&gt; 3  21040 0.6915       12        7  5.0    0    15 12.039910    FALSE   FALSE</span></span>
<span id="cb688-18"><a href="endogenous-sample-selection.html#cb688-18" tabindex="-1"></a><span class="co">#&gt; 4   7300 0.7815        7        7  5.0    0     6  6.799996    FALSE   FALSE</span></span>
<span id="cb688-19"><a href="endogenous-sample-selection.html#cb688-19" tabindex="-1"></a><span class="co">#&gt; 5  27300 0.6215       12       14  9.5    1     7 20.100058     TRUE   FALSE</span></span>
<span id="cb688-20"><a href="endogenous-sample-selection.html#cb688-20" tabindex="-1"></a><span class="co">#&gt; 6  19495 0.6915       14        7  7.5    1    33  9.859054    FALSE   FALSE</span></span>
<span id="cb688-21"><a href="endogenous-sample-selection.html#cb688-21" tabindex="-1"></a>Mroz87 <span class="ot">=</span> Mroz87 <span class="sc">%&gt;%</span></span>
<span id="cb688-22"><a href="endogenous-sample-selection.html#cb688-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">kids =</span> kids5 <span class="sc">+</span> kids618)</span>
<span id="cb688-23"><a href="endogenous-sample-selection.html#cb688-23" tabindex="-1"></a></span>
<span id="cb688-24"><a href="endogenous-sample-selection.html#cb688-24" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb688-25"><a href="endogenous-sample-selection.html#cb688-25" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb688-26"><a href="endogenous-sample-selection.html#cb688-26" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<p>2-stage Heckman’s model:</p>
<ol style="list-style-type: decimal">
<li>probit equation estimates the selection process (who is in the labor force?)</li>
<li>the results from 1st stage are used to construct a variable that captures the selection effect in the wage equation. This correction variable is called the <strong>inverse Mills ratio</strong>.</li>
</ol>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="endogenous-sample-selection.html#cb689-1" tabindex="-1"></a><span class="co"># OLS: log wage regression on LF participants only</span></span>
<span id="cb689-2"><a href="endogenous-sample-selection.html#cb689-2" tabindex="-1"></a>ols1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city, </span>
<span id="cb689-3"><a href="endogenous-sample-selection.html#cb689-3" tabindex="-1"></a>          <span class="at">data =</span> <span class="fu">subset</span>(Mroz87, lfp <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb689-4"><a href="endogenous-sample-selection.html#cb689-4" tabindex="-1"></a><span class="co"># Heckman&#39;s Two-step estimation with LFP selection equation</span></span>
<span id="cb689-5"><a href="endogenous-sample-selection.html#cb689-5" tabindex="-1"></a>heck1 <span class="ot">=</span> <span class="fu">heckit</span>(</span>
<span id="cb689-6"><a href="endogenous-sample-selection.html#cb689-6" tabindex="-1"></a>    <span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb689-7"><a href="endogenous-sample-selection.html#cb689-7" tabindex="-1"></a>    <span class="co"># the selection process, l</span></span>
<span id="cb689-8"><a href="endogenous-sample-selection.html#cb689-8" tabindex="-1"></a>    <span class="co"># fp = 1 if the woman is participating in the labor force</span></span>
<span id="cb689-9"><a href="endogenous-sample-selection.html#cb689-9" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city,</span>
<span id="cb689-10"><a href="endogenous-sample-selection.html#cb689-10" tabindex="-1"></a>    <span class="at">data =</span> Mroz87</span>
<span id="cb689-11"><a href="endogenous-sample-selection.html#cb689-11" tabindex="-1"></a>)</span>
<span id="cb689-12"><a href="endogenous-sample-selection.html#cb689-12" tabindex="-1"></a></span>
<span id="cb689-13"><a href="endogenous-sample-selection.html#cb689-13" tabindex="-1"></a><span class="fu">summary</span>(heck1<span class="sc">$</span>probit)</span>
<span id="cb689-14"><a href="endogenous-sample-selection.html#cb689-14" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb689-15"><a href="endogenous-sample-selection.html#cb689-15" tabindex="-1"></a><span class="co">#&gt; Probit binary choice model/Maximum Likelihood estimation</span></span>
<span id="cb689-16"><a href="endogenous-sample-selection.html#cb689-16" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb689-17"><a href="endogenous-sample-selection.html#cb689-17" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb689-18"><a href="endogenous-sample-selection.html#cb689-18" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -482.8212 </span></span>
<span id="cb689-19"><a href="endogenous-sample-selection.html#cb689-19" tabindex="-1"></a><span class="co">#&gt; Model: Y == &#39;1&#39; in contrary to &#39;0&#39;</span></span>
<span id="cb689-20"><a href="endogenous-sample-selection.html#cb689-20" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 &#39;negative&#39; and 428 &#39;positive&#39;) and 6 free parameters (df = 747)</span></span>
<span id="cb689-21"><a href="endogenous-sample-selection.html#cb689-21" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb689-22"><a href="endogenous-sample-selection.html#cb689-22" tabindex="-1"></a><span class="co">#&gt;                  Estimate  Std. error t value   Pr(&gt; t)    </span></span>
<span id="cb689-23"><a href="endogenous-sample-selection.html#cb689-23" tabindex="-1"></a><span class="co">#&gt; XS(Intercept) -4.18146681  1.40241567 -2.9816  0.002867 ** </span></span>
<span id="cb689-24"><a href="endogenous-sample-selection.html#cb689-24" tabindex="-1"></a><span class="co">#&gt; XSage          0.18608901  0.06517476  2.8552  0.004301 ** </span></span>
<span id="cb689-25"><a href="endogenous-sample-selection.html#cb689-25" tabindex="-1"></a><span class="co">#&gt; XSI(age^2)    -0.00241491  0.00075857 -3.1835  0.001455 ** </span></span>
<span id="cb689-26"><a href="endogenous-sample-selection.html#cb689-26" tabindex="-1"></a><span class="co">#&gt; XSkids        -0.14955977  0.03825079 -3.9100 9.230e-05 ***</span></span>
<span id="cb689-27"><a href="endogenous-sample-selection.html#cb689-27" tabindex="-1"></a><span class="co">#&gt; XShuswage     -0.04303635  0.01220791 -3.5253  0.000423 ***</span></span>
<span id="cb689-28"><a href="endogenous-sample-selection.html#cb689-28" tabindex="-1"></a><span class="co">#&gt; XSeduc         0.12502818  0.02277645  5.4894 4.034e-08 ***</span></span>
<span id="cb689-29"><a href="endogenous-sample-selection.html#cb689-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb689-30"><a href="endogenous-sample-selection.html#cb689-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb689-31"><a href="endogenous-sample-selection.html#cb689-31" tabindex="-1"></a><span class="co">#&gt; Significance test:</span></span>
<span id="cb689-32"><a href="endogenous-sample-selection.html#cb689-32" tabindex="-1"></a><span class="co">#&gt; chi2(5) = 64.10407 (p=1.719042e-12)</span></span>
<span id="cb689-33"><a href="endogenous-sample-selection.html#cb689-33" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb689-34"><a href="endogenous-sample-selection.html#cb689-34" tabindex="-1"></a><span class="fu">summary</span>(heck1<span class="sc">$</span>lm)</span>
<span id="cb689-35"><a href="endogenous-sample-selection.html#cb689-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb689-36"><a href="endogenous-sample-selection.html#cb689-36" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb689-37"><a href="endogenous-sample-selection.html#cb689-37" tabindex="-1"></a><span class="co">#&gt; lm(formula = YO ~ -1 + XO + imrData$IMR1, subset = YS == 1, weights = weightsNoNA)</span></span>
<span id="cb689-38"><a href="endogenous-sample-selection.html#cb689-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb689-39"><a href="endogenous-sample-selection.html#cb689-39" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb689-40"><a href="endogenous-sample-selection.html#cb689-40" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb689-41"><a href="endogenous-sample-selection.html#cb689-41" tabindex="-1"></a><span class="co">#&gt; -3.09494 -0.30953  0.05341  0.36530  2.34770 </span></span>
<span id="cb689-42"><a href="endogenous-sample-selection.html#cb689-42" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb689-43"><a href="endogenous-sample-selection.html#cb689-43" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb689-44"><a href="endogenous-sample-selection.html#cb689-44" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb689-45"><a href="endogenous-sample-selection.html#cb689-45" tabindex="-1"></a><span class="co">#&gt; XO(Intercept) -0.6143381  0.3768796  -1.630  0.10383    </span></span>
<span id="cb689-46"><a href="endogenous-sample-selection.html#cb689-46" tabindex="-1"></a><span class="co">#&gt; XOeduc         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb689-47"><a href="endogenous-sample-selection.html#cb689-47" tabindex="-1"></a><span class="co">#&gt; XOexper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb689-48"><a href="endogenous-sample-selection.html#cb689-48" tabindex="-1"></a><span class="co">#&gt; XOI(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb689-49"><a href="endogenous-sample-selection.html#cb689-49" tabindex="-1"></a><span class="co">#&gt; XOcity         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb689-50"><a href="endogenous-sample-selection.html#cb689-50" tabindex="-1"></a><span class="co">#&gt; imrData$IMR1   0.0551177  0.2111916   0.261  0.79423    </span></span>
<span id="cb689-51"><a href="endogenous-sample-selection.html#cb689-51" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb689-52"><a href="endogenous-sample-selection.html#cb689-52" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb689-53"><a href="endogenous-sample-selection.html#cb689-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb689-54"><a href="endogenous-sample-selection.html#cb689-54" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6674 on 422 degrees of freedom</span></span>
<span id="cb689-55"><a href="endogenous-sample-selection.html#cb689-55" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.7734, Adjusted R-squared:  0.7702 </span></span>
<span id="cb689-56"><a href="endogenous-sample-selection.html#cb689-56" tabindex="-1"></a><span class="co">#&gt; F-statistic:   240 on 6 and 422 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<p>Use only variables that affect the selection process in the selection equation. Technically, the selection equation and the equation of interest could have the same set of regressors. But it is not recommended because we should only use variables (or at least one) in the selection equation that affect the selection process, but not the wage process (i.e., instruments). Here, variable <code>kids</code> fulfill that role: women with kids may be more likely to stay home, but working moms with kids would not have their wages change.</p>
<p>Alternatively,</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="endogenous-sample-selection.html#cb690-1" tabindex="-1"></a><span class="co"># ML estimation of selection model</span></span>
<span id="cb690-2"><a href="endogenous-sample-selection.html#cb690-2" tabindex="-1"></a>ml1 <span class="ot">=</span> <span class="fu">selection</span>(</span>
<span id="cb690-3"><a href="endogenous-sample-selection.html#cb690-3" tabindex="-1"></a>    <span class="at">selection =</span> lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>(age <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb690-4"><a href="endogenous-sample-selection.html#cb690-4" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city,</span>
<span id="cb690-5"><a href="endogenous-sample-selection.html#cb690-5" tabindex="-1"></a>    <span class="at">data =</span> Mroz87</span>
<span id="cb690-6"><a href="endogenous-sample-selection.html#cb690-6" tabindex="-1"></a>) </span>
<span id="cb690-7"><a href="endogenous-sample-selection.html#cb690-7" tabindex="-1"></a><span class="fu">summary</span>(ml1)</span>
<span id="cb690-8"><a href="endogenous-sample-selection.html#cb690-8" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb690-9"><a href="endogenous-sample-selection.html#cb690-9" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb690-10"><a href="endogenous-sample-selection.html#cb690-10" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb690-11"><a href="endogenous-sample-selection.html#cb690-11" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 3 iterations</span></span>
<span id="cb690-12"><a href="endogenous-sample-selection.html#cb690-12" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb690-13"><a href="endogenous-sample-selection.html#cb690-13" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -914.0777 </span></span>
<span id="cb690-14"><a href="endogenous-sample-selection.html#cb690-14" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 censored and 428 observed)</span></span>
<span id="cb690-15"><a href="endogenous-sample-selection.html#cb690-15" tabindex="-1"></a><span class="co">#&gt; 13 free parameters (df = 740)</span></span>
<span id="cb690-16"><a href="endogenous-sample-selection.html#cb690-16" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb690-17"><a href="endogenous-sample-selection.html#cb690-17" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb690-18"><a href="endogenous-sample-selection.html#cb690-18" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.1484037  1.4109302  -2.940 0.003382 ** </span></span>
<span id="cb690-19"><a href="endogenous-sample-selection.html#cb690-19" tabindex="-1"></a><span class="co">#&gt; age          0.1842132  0.0658041   2.799 0.005253 ** </span></span>
<span id="cb690-20"><a href="endogenous-sample-selection.html#cb690-20" tabindex="-1"></a><span class="co">#&gt; I(age^2)    -0.0023925  0.0007664  -3.122 0.001868 ** </span></span>
<span id="cb690-21"><a href="endogenous-sample-selection.html#cb690-21" tabindex="-1"></a><span class="co">#&gt; kids        -0.1488158  0.0384888  -3.866 0.000120 ***</span></span>
<span id="cb690-22"><a href="endogenous-sample-selection.html#cb690-22" tabindex="-1"></a><span class="co">#&gt; huswage     -0.0434253  0.0123229  -3.524 0.000451 ***</span></span>
<span id="cb690-23"><a href="endogenous-sample-selection.html#cb690-23" tabindex="-1"></a><span class="co">#&gt; educ         0.1255639  0.0229229   5.478 5.91e-08 ***</span></span>
<span id="cb690-24"><a href="endogenous-sample-selection.html#cb690-24" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb690-25"><a href="endogenous-sample-selection.html#cb690-25" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb690-26"><a href="endogenous-sample-selection.html#cb690-26" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.5814781  0.3052031  -1.905  0.05714 .  </span></span>
<span id="cb690-27"><a href="endogenous-sample-selection.html#cb690-27" tabindex="-1"></a><span class="co">#&gt; educ         0.1078481  0.0172998   6.234 7.63e-10 ***</span></span>
<span id="cb690-28"><a href="endogenous-sample-selection.html#cb690-28" tabindex="-1"></a><span class="co">#&gt; exper        0.0415752  0.0133269   3.120  0.00188 ** </span></span>
<span id="cb690-29"><a href="endogenous-sample-selection.html#cb690-29" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008125  0.0003974  -2.044  0.04129 *  </span></span>
<span id="cb690-30"><a href="endogenous-sample-selection.html#cb690-30" tabindex="-1"></a><span class="co">#&gt; city         0.0522990  0.0682652   0.766  0.44385    </span></span>
<span id="cb690-31"><a href="endogenous-sample-selection.html#cb690-31" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb690-32"><a href="endogenous-sample-selection.html#cb690-32" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb690-33"><a href="endogenous-sample-selection.html#cb690-33" tabindex="-1"></a><span class="co">#&gt; sigma  0.66326    0.02309  28.729   &lt;2e-16 ***</span></span>
<span id="cb690-34"><a href="endogenous-sample-selection.html#cb690-34" tabindex="-1"></a><span class="co">#&gt; rho    0.05048    0.23169   0.218    0.828    </span></span>
<span id="cb690-35"><a href="endogenous-sample-selection.html#cb690-35" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb690-36"><a href="endogenous-sample-selection.html#cb690-36" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb690-37"><a href="endogenous-sample-selection.html#cb690-37" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb690-38"><a href="endogenous-sample-selection.html#cb690-38" tabindex="-1"></a><span class="co"># summary(ml1$twoStep)</span></span></code></pre></div>
<p>Manual</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="endogenous-sample-selection.html#cb691-1" tabindex="-1"></a>myprob <span class="ot">&lt;-</span> <span class="fu">probit</span>(lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>( age<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ, </span>
<span id="cb691-2"><a href="endogenous-sample-selection.html#cb691-2" tabindex="-1"></a>                 <span class="co"># x = TRUE, </span></span>
<span id="cb691-3"><a href="endogenous-sample-selection.html#cb691-3" tabindex="-1"></a>                 <span class="co"># iterlim = 30, </span></span>
<span id="cb691-4"><a href="endogenous-sample-selection.html#cb691-4" tabindex="-1"></a>                 <span class="at">data =</span> Mroz87)</span>
<span id="cb691-5"><a href="endogenous-sample-selection.html#cb691-5" tabindex="-1"></a><span class="fu">summary</span>(myprob)</span>
<span id="cb691-6"><a href="endogenous-sample-selection.html#cb691-6" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb691-7"><a href="endogenous-sample-selection.html#cb691-7" tabindex="-1"></a><span class="co">#&gt; Probit binary choice model/Maximum Likelihood estimation</span></span>
<span id="cb691-8"><a href="endogenous-sample-selection.html#cb691-8" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb691-9"><a href="endogenous-sample-selection.html#cb691-9" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb691-10"><a href="endogenous-sample-selection.html#cb691-10" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -482.8212 </span></span>
<span id="cb691-11"><a href="endogenous-sample-selection.html#cb691-11" tabindex="-1"></a><span class="co">#&gt; Model: Y == &#39;1&#39; in contrary to &#39;0&#39;</span></span>
<span id="cb691-12"><a href="endogenous-sample-selection.html#cb691-12" tabindex="-1"></a><span class="co">#&gt; 753 observations (325 &#39;negative&#39; and 428 &#39;positive&#39;) and 6 free parameters (df = 747)</span></span>
<span id="cb691-13"><a href="endogenous-sample-selection.html#cb691-13" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb691-14"><a href="endogenous-sample-selection.html#cb691-14" tabindex="-1"></a><span class="co">#&gt;                Estimate  Std. error t value   Pr(&gt; t)    </span></span>
<span id="cb691-15"><a href="endogenous-sample-selection.html#cb691-15" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.18146681  1.40241567 -2.9816  0.002867 ** </span></span>
<span id="cb691-16"><a href="endogenous-sample-selection.html#cb691-16" tabindex="-1"></a><span class="co">#&gt; age          0.18608901  0.06517476  2.8552  0.004301 ** </span></span>
<span id="cb691-17"><a href="endogenous-sample-selection.html#cb691-17" tabindex="-1"></a><span class="co">#&gt; I(age^2)    -0.00241491  0.00075857 -3.1835  0.001455 ** </span></span>
<span id="cb691-18"><a href="endogenous-sample-selection.html#cb691-18" tabindex="-1"></a><span class="co">#&gt; kids        -0.14955977  0.03825079 -3.9100 9.230e-05 ***</span></span>
<span id="cb691-19"><a href="endogenous-sample-selection.html#cb691-19" tabindex="-1"></a><span class="co">#&gt; huswage     -0.04303635  0.01220791 -3.5253  0.000423 ***</span></span>
<span id="cb691-20"><a href="endogenous-sample-selection.html#cb691-20" tabindex="-1"></a><span class="co">#&gt; educ         0.12502818  0.02277645  5.4894 4.034e-08 ***</span></span>
<span id="cb691-21"><a href="endogenous-sample-selection.html#cb691-21" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb691-22"><a href="endogenous-sample-selection.html#cb691-22" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb691-23"><a href="endogenous-sample-selection.html#cb691-23" tabindex="-1"></a><span class="co">#&gt; Significance test:</span></span>
<span id="cb691-24"><a href="endogenous-sample-selection.html#cb691-24" tabindex="-1"></a><span class="co">#&gt; chi2(5) = 64.10407 (p=1.719042e-12)</span></span>
<span id="cb691-25"><a href="endogenous-sample-selection.html#cb691-25" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb691-26"><a href="endogenous-sample-selection.html#cb691-26" tabindex="-1"></a></span>
<span id="cb691-27"><a href="endogenous-sample-selection.html#cb691-27" tabindex="-1"></a>imr <span class="ot">&lt;-</span> <span class="fu">invMillsRatio</span>(myprob)</span>
<span id="cb691-28"><a href="endogenous-sample-selection.html#cb691-28" tabindex="-1"></a>Mroz87<span class="sc">$</span>IMR1 <span class="ot">&lt;-</span> imr<span class="sc">$</span>IMR1</span>
<span id="cb691-29"><a href="endogenous-sample-selection.html#cb691-29" tabindex="-1"></a></span>
<span id="cb691-30"><a href="endogenous-sample-selection.html#cb691-30" tabindex="-1"></a>manually_est <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>( exper<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> city <span class="sc">+</span> IMR1,</span>
<span id="cb691-31"><a href="endogenous-sample-selection.html#cb691-31" tabindex="-1"></a>                   <span class="at">data =</span> Mroz87, </span>
<span id="cb691-32"><a href="endogenous-sample-selection.html#cb691-32" tabindex="-1"></a>                   <span class="at">subset =</span> (lfp <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb691-33"><a href="endogenous-sample-selection.html#cb691-33" tabindex="-1"></a></span>
<span id="cb691-34"><a href="endogenous-sample-selection.html#cb691-34" tabindex="-1"></a><span class="fu">summary</span>(manually_est)</span>
<span id="cb691-35"><a href="endogenous-sample-selection.html#cb691-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb691-36"><a href="endogenous-sample-selection.html#cb691-36" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb691-37"><a href="endogenous-sample-selection.html#cb691-37" tabindex="-1"></a><span class="co">#&gt; lm(formula = log(wage) ~ educ + exper + I(exper^2) + city + IMR1, </span></span>
<span id="cb691-38"><a href="endogenous-sample-selection.html#cb691-38" tabindex="-1"></a><span class="co">#&gt;     data = Mroz87, subset = (lfp == 1))</span></span>
<span id="cb691-39"><a href="endogenous-sample-selection.html#cb691-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb691-40"><a href="endogenous-sample-selection.html#cb691-40" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb691-41"><a href="endogenous-sample-selection.html#cb691-41" tabindex="-1"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb691-42"><a href="endogenous-sample-selection.html#cb691-42" tabindex="-1"></a><span class="co">#&gt; -3.09494 -0.30953  0.05341  0.36530  2.34770 </span></span>
<span id="cb691-43"><a href="endogenous-sample-selection.html#cb691-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb691-44"><a href="endogenous-sample-selection.html#cb691-44" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb691-45"><a href="endogenous-sample-selection.html#cb691-45" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb691-46"><a href="endogenous-sample-selection.html#cb691-46" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.6143381  0.3768796  -1.630  0.10383    </span></span>
<span id="cb691-47"><a href="endogenous-sample-selection.html#cb691-47" tabindex="-1"></a><span class="co">#&gt; educ         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb691-48"><a href="endogenous-sample-selection.html#cb691-48" tabindex="-1"></a><span class="co">#&gt; exper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb691-49"><a href="endogenous-sample-selection.html#cb691-49" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb691-50"><a href="endogenous-sample-selection.html#cb691-50" tabindex="-1"></a><span class="co">#&gt; city         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb691-51"><a href="endogenous-sample-selection.html#cb691-51" tabindex="-1"></a><span class="co">#&gt; IMR1         0.0551177  0.2111916   0.261  0.79423    </span></span>
<span id="cb691-52"><a href="endogenous-sample-selection.html#cb691-52" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb691-53"><a href="endogenous-sample-selection.html#cb691-53" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb691-54"><a href="endogenous-sample-selection.html#cb691-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb691-55"><a href="endogenous-sample-selection.html#cb691-55" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.6674 on 422 degrees of freedom</span></span>
<span id="cb691-56"><a href="endogenous-sample-selection.html#cb691-56" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.1582, Adjusted R-squared:  0.1482 </span></span>
<span id="cb691-57"><a href="endogenous-sample-selection.html#cb691-57" tabindex="-1"></a><span class="co">#&gt; F-statistic: 15.86 on 5 and 422 DF,  p-value: 2.505e-14</span></span></code></pre></div>
<p>Similarly,</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="endogenous-sample-selection.html#cb692-1" tabindex="-1"></a>probit_selection <span class="ot">&lt;-</span></span>
<span id="cb692-2"><a href="endogenous-sample-selection.html#cb692-2" tabindex="-1"></a>    <span class="fu">glm</span>(lfp <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">I</span>( age<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">+</span> kids <span class="sc">+</span> huswage <span class="sc">+</span> educ,</span>
<span id="cb692-3"><a href="endogenous-sample-selection.html#cb692-3" tabindex="-1"></a>        <span class="at">data =</span> Mroz87,</span>
<span id="cb692-4"><a href="endogenous-sample-selection.html#cb692-4" tabindex="-1"></a>        <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&#39;probit&#39;</span>))</span>
<span id="cb692-5"><a href="endogenous-sample-selection.html#cb692-5" tabindex="-1"></a></span>
<span id="cb692-6"><a href="endogenous-sample-selection.html#cb692-6" tabindex="-1"></a><span class="co"># library(fixest)</span></span>
<span id="cb692-7"><a href="endogenous-sample-selection.html#cb692-7" tabindex="-1"></a><span class="co"># probit_selection &lt;-</span></span>
<span id="cb692-8"><a href="endogenous-sample-selection.html#cb692-8" tabindex="-1"></a><span class="co">#     fixest::feglm(lfp ~ age + I( age^2 ) + kids + huswage + educ,</span></span>
<span id="cb692-9"><a href="endogenous-sample-selection.html#cb692-9" tabindex="-1"></a><span class="co">#         data = Mroz87,</span></span>
<span id="cb692-10"><a href="endogenous-sample-selection.html#cb692-10" tabindex="-1"></a><span class="co">#         family = binomial(link = &#39;probit&#39;))</span></span>
<span id="cb692-11"><a href="endogenous-sample-selection.html#cb692-11" tabindex="-1"></a></span>
<span id="cb692-12"><a href="endogenous-sample-selection.html#cb692-12" tabindex="-1"></a>probit_lp <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">predict</span>(probit_selection)</span>
<span id="cb692-13"><a href="endogenous-sample-selection.html#cb692-13" tabindex="-1"></a>inv_mills <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(probit_lp) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(probit_lp))</span>
<span id="cb692-14"><a href="endogenous-sample-selection.html#cb692-14" tabindex="-1"></a>Mroz87<span class="sc">$</span>inv_mills <span class="ot">&lt;-</span> inv_mills</span>
<span id="cb692-15"><a href="endogenous-sample-selection.html#cb692-15" tabindex="-1"></a></span>
<span id="cb692-16"><a href="endogenous-sample-selection.html#cb692-16" tabindex="-1"></a></span>
<span id="cb692-17"><a href="endogenous-sample-selection.html#cb692-17" tabindex="-1"></a>probit_outcome <span class="ot">&lt;-</span></span>
<span id="cb692-18"><a href="endogenous-sample-selection.html#cb692-18" tabindex="-1"></a>    <span class="fu">glm</span>(</span>
<span id="cb692-19"><a href="endogenous-sample-selection.html#cb692-19" tabindex="-1"></a>        <span class="fu">log</span>(wage) <span class="sc">~</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">+</span> city <span class="sc">+</span> inv_mills,</span>
<span id="cb692-20"><a href="endogenous-sample-selection.html#cb692-20" tabindex="-1"></a>        <span class="at">data =</span> Mroz87,</span>
<span id="cb692-21"><a href="endogenous-sample-selection.html#cb692-21" tabindex="-1"></a>        <span class="at">subset =</span> (lfp <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb692-22"><a href="endogenous-sample-selection.html#cb692-22" tabindex="-1"></a>    )</span>
<span id="cb692-23"><a href="endogenous-sample-selection.html#cb692-23" tabindex="-1"></a><span class="fu">summary</span>(probit_outcome)</span>
<span id="cb692-24"><a href="endogenous-sample-selection.html#cb692-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-25"><a href="endogenous-sample-selection.html#cb692-25" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb692-26"><a href="endogenous-sample-selection.html#cb692-26" tabindex="-1"></a><span class="co">#&gt; glm(formula = log(wage) ~ educ + exper + I(exper^2) + city + </span></span>
<span id="cb692-27"><a href="endogenous-sample-selection.html#cb692-27" tabindex="-1"></a><span class="co">#&gt;     inv_mills, data = Mroz87, subset = (lfp == 1))</span></span>
<span id="cb692-28"><a href="endogenous-sample-selection.html#cb692-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-29"><a href="endogenous-sample-selection.html#cb692-29" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb692-30"><a href="endogenous-sample-selection.html#cb692-30" tabindex="-1"></a><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb692-31"><a href="endogenous-sample-selection.html#cb692-31" tabindex="-1"></a><span class="co">#&gt; -3.09494  -0.30953   0.05341   0.36530   2.34770  </span></span>
<span id="cb692-32"><a href="endogenous-sample-selection.html#cb692-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-33"><a href="endogenous-sample-selection.html#cb692-33" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb692-34"><a href="endogenous-sample-selection.html#cb692-34" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb692-35"><a href="endogenous-sample-selection.html#cb692-35" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.6143383  0.3768798  -1.630  0.10383    </span></span>
<span id="cb692-36"><a href="endogenous-sample-selection.html#cb692-36" tabindex="-1"></a><span class="co">#&gt; educ         0.1092363  0.0197062   5.543 5.24e-08 ***</span></span>
<span id="cb692-37"><a href="endogenous-sample-selection.html#cb692-37" tabindex="-1"></a><span class="co">#&gt; exper        0.0419205  0.0136176   3.078  0.00222 ** </span></span>
<span id="cb692-38"><a href="endogenous-sample-selection.html#cb692-38" tabindex="-1"></a><span class="co">#&gt; I(exper^2)  -0.0008226  0.0004059  -2.026  0.04335 *  </span></span>
<span id="cb692-39"><a href="endogenous-sample-selection.html#cb692-39" tabindex="-1"></a><span class="co">#&gt; city         0.0510492  0.0692414   0.737  0.46137    </span></span>
<span id="cb692-40"><a href="endogenous-sample-selection.html#cb692-40" tabindex="-1"></a><span class="co">#&gt; inv_mills    0.0551179  0.2111918   0.261  0.79423    </span></span>
<span id="cb692-41"><a href="endogenous-sample-selection.html#cb692-41" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb692-42"><a href="endogenous-sample-selection.html#cb692-42" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb692-43"><a href="endogenous-sample-selection.html#cb692-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-44"><a href="endogenous-sample-selection.html#cb692-44" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 0.4454809)</span></span>
<span id="cb692-45"><a href="endogenous-sample-selection.html#cb692-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-46"><a href="endogenous-sample-selection.html#cb692-46" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 223.33  on 427  degrees of freedom</span></span>
<span id="cb692-47"><a href="endogenous-sample-selection.html#cb692-47" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 187.99  on 422  degrees of freedom</span></span>
<span id="cb692-48"><a href="endogenous-sample-selection.html#cb692-48" tabindex="-1"></a><span class="co">#&gt; AIC: 876.49</span></span>
<span id="cb692-49"><a href="endogenous-sample-selection.html#cb692-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb692-50"><a href="endogenous-sample-selection.html#cb692-50" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="endogenous-sample-selection.html#cb693-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stargazer&quot;</span>)</span>
<span id="cb693-2"><a href="endogenous-sample-selection.html#cb693-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Mediana&quot;</span>)</span>
<span id="cb693-3"><a href="endogenous-sample-selection.html#cb693-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;plm&quot;</span>)</span>
<span id="cb693-4"><a href="endogenous-sample-selection.html#cb693-4" tabindex="-1"></a><span class="co"># function to calculate corrected SEs for regression </span></span>
<span id="cb693-5"><a href="endogenous-sample-selection.html#cb693-5" tabindex="-1"></a>cse <span class="ot">=</span> <span class="cf">function</span>(reg) {</span>
<span id="cb693-6"><a href="endogenous-sample-selection.html#cb693-6" tabindex="-1"></a>  rob <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(reg, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)))</span>
<span id="cb693-7"><a href="endogenous-sample-selection.html#cb693-7" tabindex="-1"></a>  <span class="fu">return</span>(rob)</span>
<span id="cb693-8"><a href="endogenous-sample-selection.html#cb693-8" tabindex="-1"></a>}</span>
<span id="cb693-9"><a href="endogenous-sample-selection.html#cb693-9" tabindex="-1"></a></span>
<span id="cb693-10"><a href="endogenous-sample-selection.html#cb693-10" tabindex="-1"></a><span class="co"># stargazer table</span></span>
<span id="cb693-11"><a href="endogenous-sample-selection.html#cb693-11" tabindex="-1"></a><span class="fu">stargazer</span>(</span>
<span id="cb693-12"><a href="endogenous-sample-selection.html#cb693-12" tabindex="-1"></a>    <span class="co"># ols1,</span></span>
<span id="cb693-13"><a href="endogenous-sample-selection.html#cb693-13" tabindex="-1"></a>    heck1,</span>
<span id="cb693-14"><a href="endogenous-sample-selection.html#cb693-14" tabindex="-1"></a>    ml1,</span>
<span id="cb693-15"><a href="endogenous-sample-selection.html#cb693-15" tabindex="-1"></a>    <span class="co"># manually_est,</span></span>
<span id="cb693-16"><a href="endogenous-sample-selection.html#cb693-16" tabindex="-1"></a>    </span>
<span id="cb693-17"><a href="endogenous-sample-selection.html#cb693-17" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">list</span>(<span class="fu">cse</span>(ols1), <span class="cn">NULL</span>, <span class="cn">NULL</span>),</span>
<span id="cb693-18"><a href="endogenous-sample-selection.html#cb693-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Married women&#39;s wage regressions&quot;</span>,</span>
<span id="cb693-19"><a href="endogenous-sample-selection.html#cb693-19" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb693-20"><a href="endogenous-sample-selection.html#cb693-20" tabindex="-1"></a>    <span class="at">df =</span> <span class="cn">FALSE</span>,</span>
<span id="cb693-21"><a href="endogenous-sample-selection.html#cb693-21" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb693-22"><a href="endogenous-sample-selection.html#cb693-22" tabindex="-1"></a>    <span class="at">selection.equation =</span> T</span>
<span id="cb693-23"><a href="endogenous-sample-selection.html#cb693-23" tabindex="-1"></a>)</span>
<span id="cb693-24"><a href="endogenous-sample-selection.html#cb693-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb693-25"><a href="endogenous-sample-selection.html#cb693-25" tabindex="-1"></a><span class="co">#&gt; Married women&#39;s wage regressions</span></span>
<span id="cb693-26"><a href="endogenous-sample-selection.html#cb693-26" tabindex="-1"></a><span class="co">#&gt; ===================================================</span></span>
<span id="cb693-27"><a href="endogenous-sample-selection.html#cb693-27" tabindex="-1"></a><span class="co">#&gt;                           Dependent variable:      </span></span>
<span id="cb693-28"><a href="endogenous-sample-selection.html#cb693-28" tabindex="-1"></a><span class="co">#&gt;                     -------------------------------</span></span>
<span id="cb693-29"><a href="endogenous-sample-selection.html#cb693-29" tabindex="-1"></a><span class="co">#&gt;                                   lfp              </span></span>
<span id="cb693-30"><a href="endogenous-sample-selection.html#cb693-30" tabindex="-1"></a><span class="co">#&gt;                         Heckman        selection   </span></span>
<span id="cb693-31"><a href="endogenous-sample-selection.html#cb693-31" tabindex="-1"></a><span class="co">#&gt;                        selection                   </span></span>
<span id="cb693-32"><a href="endogenous-sample-selection.html#cb693-32" tabindex="-1"></a><span class="co">#&gt;                           (1)             (2)      </span></span>
<span id="cb693-33"><a href="endogenous-sample-selection.html#cb693-33" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb693-34"><a href="endogenous-sample-selection.html#cb693-34" tabindex="-1"></a><span class="co">#&gt; age                    0.1861***       0.1842***   </span></span>
<span id="cb693-35"><a href="endogenous-sample-selection.html#cb693-35" tabindex="-1"></a><span class="co">#&gt;                                        (0.0658)    </span></span>
<span id="cb693-36"><a href="endogenous-sample-selection.html#cb693-36" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-37"><a href="endogenous-sample-selection.html#cb693-37" tabindex="-1"></a><span class="co">#&gt; I(age2)                 -0.0024       -0.0024***   </span></span>
<span id="cb693-38"><a href="endogenous-sample-selection.html#cb693-38" tabindex="-1"></a><span class="co">#&gt;                                        (0.0008)    </span></span>
<span id="cb693-39"><a href="endogenous-sample-selection.html#cb693-39" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-40"><a href="endogenous-sample-selection.html#cb693-40" tabindex="-1"></a><span class="co">#&gt; kids                  -0.1496***      -0.1488***   </span></span>
<span id="cb693-41"><a href="endogenous-sample-selection.html#cb693-41" tabindex="-1"></a><span class="co">#&gt;                                        (0.0385)    </span></span>
<span id="cb693-42"><a href="endogenous-sample-selection.html#cb693-42" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-43"><a href="endogenous-sample-selection.html#cb693-43" tabindex="-1"></a><span class="co">#&gt; huswage                 -0.0430       -0.0434***   </span></span>
<span id="cb693-44"><a href="endogenous-sample-selection.html#cb693-44" tabindex="-1"></a><span class="co">#&gt;                                        (0.0123)    </span></span>
<span id="cb693-45"><a href="endogenous-sample-selection.html#cb693-45" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-46"><a href="endogenous-sample-selection.html#cb693-46" tabindex="-1"></a><span class="co">#&gt; educ                    0.1250         0.1256***   </span></span>
<span id="cb693-47"><a href="endogenous-sample-selection.html#cb693-47" tabindex="-1"></a><span class="co">#&gt;                        (0.0130)        (0.0229)    </span></span>
<span id="cb693-48"><a href="endogenous-sample-selection.html#cb693-48" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-49"><a href="endogenous-sample-selection.html#cb693-49" tabindex="-1"></a><span class="co">#&gt; Constant              -4.1815***      -4.1484***   </span></span>
<span id="cb693-50"><a href="endogenous-sample-selection.html#cb693-50" tabindex="-1"></a><span class="co">#&gt;                        (0.2032)        (1.4109)    </span></span>
<span id="cb693-51"><a href="endogenous-sample-selection.html#cb693-51" tabindex="-1"></a><span class="co">#&gt;                                                    </span></span>
<span id="cb693-52"><a href="endogenous-sample-selection.html#cb693-52" tabindex="-1"></a><span class="co">#&gt; ---------------------------------------------------</span></span>
<span id="cb693-53"><a href="endogenous-sample-selection.html#cb693-53" tabindex="-1"></a><span class="co">#&gt; Observations              753             753      </span></span>
<span id="cb693-54"><a href="endogenous-sample-selection.html#cb693-54" tabindex="-1"></a><span class="co">#&gt; R2                      0.1582                     </span></span>
<span id="cb693-55"><a href="endogenous-sample-selection.html#cb693-55" tabindex="-1"></a><span class="co">#&gt; Adjusted R2             0.1482                     </span></span>
<span id="cb693-56"><a href="endogenous-sample-selection.html#cb693-56" tabindex="-1"></a><span class="co">#&gt; Log Likelihood                         -914.0777   </span></span>
<span id="cb693-57"><a href="endogenous-sample-selection.html#cb693-57" tabindex="-1"></a><span class="co">#&gt; rho                     0.0830      0.0505 (0.2317)</span></span>
<span id="cb693-58"><a href="endogenous-sample-selection.html#cb693-58" tabindex="-1"></a><span class="co">#&gt; Inverse Mills Ratio 0.0551 (0.2099)                </span></span>
<span id="cb693-59"><a href="endogenous-sample-selection.html#cb693-59" tabindex="-1"></a><span class="co">#&gt; ===================================================</span></span>
<span id="cb693-60"><a href="endogenous-sample-selection.html#cb693-60" tabindex="-1"></a><span class="co">#&gt; Note:                   *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span>
<span id="cb693-61"><a href="endogenous-sample-selection.html#cb693-61" tabindex="-1"></a></span>
<span id="cb693-62"><a href="endogenous-sample-selection.html#cb693-62" tabindex="-1"></a></span>
<span id="cb693-63"><a href="endogenous-sample-selection.html#cb693-63" tabindex="-1"></a><span class="fu">stargazer</span>(</span>
<span id="cb693-64"><a href="endogenous-sample-selection.html#cb693-64" tabindex="-1"></a>    ols1,</span>
<span id="cb693-65"><a href="endogenous-sample-selection.html#cb693-65" tabindex="-1"></a>    <span class="co"># heck1,</span></span>
<span id="cb693-66"><a href="endogenous-sample-selection.html#cb693-66" tabindex="-1"></a>    <span class="co"># ml1,</span></span>
<span id="cb693-67"><a href="endogenous-sample-selection.html#cb693-67" tabindex="-1"></a>    manually_est,</span>
<span id="cb693-68"><a href="endogenous-sample-selection.html#cb693-68" tabindex="-1"></a>    </span>
<span id="cb693-69"><a href="endogenous-sample-selection.html#cb693-69" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">list</span>(<span class="fu">cse</span>(ols1), <span class="cn">NULL</span>, <span class="cn">NULL</span>),</span>
<span id="cb693-70"><a href="endogenous-sample-selection.html#cb693-70" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Married women&#39;s wage regressions&quot;</span>,</span>
<span id="cb693-71"><a href="endogenous-sample-selection.html#cb693-71" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb693-72"><a href="endogenous-sample-selection.html#cb693-72" tabindex="-1"></a>    <span class="at">df =</span> <span class="cn">FALSE</span>,</span>
<span id="cb693-73"><a href="endogenous-sample-selection.html#cb693-73" tabindex="-1"></a>    <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb693-74"><a href="endogenous-sample-selection.html#cb693-74" tabindex="-1"></a>    <span class="at">selection.equation =</span> T</span>
<span id="cb693-75"><a href="endogenous-sample-selection.html#cb693-75" tabindex="-1"></a>)</span>
<span id="cb693-76"><a href="endogenous-sample-selection.html#cb693-76" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb693-77"><a href="endogenous-sample-selection.html#cb693-77" tabindex="-1"></a><span class="co">#&gt; Married women&#39;s wage regressions</span></span>
<span id="cb693-78"><a href="endogenous-sample-selection.html#cb693-78" tabindex="-1"></a><span class="co">#&gt; ================================================</span></span>
<span id="cb693-79"><a href="endogenous-sample-selection.html#cb693-79" tabindex="-1"></a><span class="co">#&gt;                         Dependent variable:     </span></span>
<span id="cb693-80"><a href="endogenous-sample-selection.html#cb693-80" tabindex="-1"></a><span class="co">#&gt;                     ----------------------------</span></span>
<span id="cb693-81"><a href="endogenous-sample-selection.html#cb693-81" tabindex="-1"></a><span class="co">#&gt;                              log(wage)          </span></span>
<span id="cb693-82"><a href="endogenous-sample-selection.html#cb693-82" tabindex="-1"></a><span class="co">#&gt;                          (1)            (2)     </span></span>
<span id="cb693-83"><a href="endogenous-sample-selection.html#cb693-83" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------</span></span>
<span id="cb693-84"><a href="endogenous-sample-selection.html#cb693-84" tabindex="-1"></a><span class="co">#&gt; educ                  0.1057***      0.1092***  </span></span>
<span id="cb693-85"><a href="endogenous-sample-selection.html#cb693-85" tabindex="-1"></a><span class="co">#&gt;                        (0.0130)      (0.0197)   </span></span>
<span id="cb693-86"><a href="endogenous-sample-selection.html#cb693-86" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-87"><a href="endogenous-sample-selection.html#cb693-87" tabindex="-1"></a><span class="co">#&gt; exper                 0.0411***      0.0419***  </span></span>
<span id="cb693-88"><a href="endogenous-sample-selection.html#cb693-88" tabindex="-1"></a><span class="co">#&gt;                        (0.0154)      (0.0136)   </span></span>
<span id="cb693-89"><a href="endogenous-sample-selection.html#cb693-89" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-90"><a href="endogenous-sample-selection.html#cb693-90" tabindex="-1"></a><span class="co">#&gt; I(exper2)              -0.0008*      -0.0008**  </span></span>
<span id="cb693-91"><a href="endogenous-sample-selection.html#cb693-91" tabindex="-1"></a><span class="co">#&gt;                        (0.0004)      (0.0004)   </span></span>
<span id="cb693-92"><a href="endogenous-sample-selection.html#cb693-92" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-93"><a href="endogenous-sample-selection.html#cb693-93" tabindex="-1"></a><span class="co">#&gt; city                    0.0542        0.0510    </span></span>
<span id="cb693-94"><a href="endogenous-sample-selection.html#cb693-94" tabindex="-1"></a><span class="co">#&gt;                        (0.0653)      (0.0692)   </span></span>
<span id="cb693-95"><a href="endogenous-sample-selection.html#cb693-95" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-96"><a href="endogenous-sample-selection.html#cb693-96" tabindex="-1"></a><span class="co">#&gt; IMR1                                  0.0551    </span></span>
<span id="cb693-97"><a href="endogenous-sample-selection.html#cb693-97" tabindex="-1"></a><span class="co">#&gt;                                      (0.2112)   </span></span>
<span id="cb693-98"><a href="endogenous-sample-selection.html#cb693-98" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-99"><a href="endogenous-sample-selection.html#cb693-99" tabindex="-1"></a><span class="co">#&gt; Constant              -0.5308***      -0.6143   </span></span>
<span id="cb693-100"><a href="endogenous-sample-selection.html#cb693-100" tabindex="-1"></a><span class="co">#&gt;                        (0.2032)      (0.3769)   </span></span>
<span id="cb693-101"><a href="endogenous-sample-selection.html#cb693-101" tabindex="-1"></a><span class="co">#&gt;                                                 </span></span>
<span id="cb693-102"><a href="endogenous-sample-selection.html#cb693-102" tabindex="-1"></a><span class="co">#&gt; ------------------------------------------------</span></span>
<span id="cb693-103"><a href="endogenous-sample-selection.html#cb693-103" tabindex="-1"></a><span class="co">#&gt; Observations             428            428     </span></span>
<span id="cb693-104"><a href="endogenous-sample-selection.html#cb693-104" tabindex="-1"></a><span class="co">#&gt; R2                      0.1581        0.1582    </span></span>
<span id="cb693-105"><a href="endogenous-sample-selection.html#cb693-105" tabindex="-1"></a><span class="co">#&gt; Adjusted R2             0.1501        0.1482    </span></span>
<span id="cb693-106"><a href="endogenous-sample-selection.html#cb693-106" tabindex="-1"></a><span class="co">#&gt; Residual Std. Error     0.6667        0.6674    </span></span>
<span id="cb693-107"><a href="endogenous-sample-selection.html#cb693-107" tabindex="-1"></a><span class="co">#&gt; F Statistic           19.8561***    15.8635***  </span></span>
<span id="cb693-108"><a href="endogenous-sample-selection.html#cb693-108" tabindex="-1"></a><span class="co">#&gt; ================================================</span></span>
<span id="cb693-109"><a href="endogenous-sample-selection.html#cb693-109" tabindex="-1"></a><span class="co">#&gt; Note:                *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</span></span></code></pre></div>
<p>Rho is an estimate of the correlation of the errors between the selection and wage equations. In the lower panel, the estimated coefficient on the inverse Mills ratio is given for the Heckman model. The fact that it is not statistically different from zero is consistent with the idea that selection bias was not a serious problem in this case.</p>
<p>If the estimated coefficient of the inverse Mills ratio in the Heckman model is not statistically different from zero, then selection bias was not a serious problem.</p>
</div>
<div id="example-2-2" class="section level4 hasAnchor" number="33.2.1.2">
<h4><span class="header-section-number">33.2.1.2</span> Example 2<a href="endogenous-sample-selection.html#example-2-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This code is from <a href="https://cran.r-project.org/web/packages/sampleSelection/vignettes/selection.pdf">R package sampleSelection</a></p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="endogenous-sample-selection.html#cb694-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb694-2"><a href="endogenous-sample-selection.html#cb694-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sampleSelection&quot;</span>)</span>
<span id="cb694-3"><a href="endogenous-sample-selection.html#cb694-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;mvtnorm&quot;</span>)</span>
<span id="cb694-4"><a href="endogenous-sample-selection.html#cb694-4" tabindex="-1"></a><span class="co"># bivariate normal disturbances</span></span>
<span id="cb694-5"><a href="endogenous-sample-selection.html#cb694-5" tabindex="-1"></a>eps <span class="ot">&lt;-</span></span>
<span id="cb694-6"><a href="endogenous-sample-selection.html#cb694-6" tabindex="-1"></a>    <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="sc">-</span><span class="fl">0.7</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)) </span>
<span id="cb694-7"><a href="endogenous-sample-selection.html#cb694-7" tabindex="-1"></a></span>
<span id="cb694-8"><a href="endogenous-sample-selection.html#cb694-8" tabindex="-1"></a><span class="co"># uniformly distributed explanatory variable </span></span>
<span id="cb694-9"><a href="endogenous-sample-selection.html#cb694-9" tabindex="-1"></a><span class="co"># (vectors of explanatory variables for the selection)</span></span>
<span id="cb694-10"><a href="endogenous-sample-selection.html#cb694-10" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>)</span>
<span id="cb694-11"><a href="endogenous-sample-selection.html#cb694-11" tabindex="-1"></a></span>
<span id="cb694-12"><a href="endogenous-sample-selection.html#cb694-12" tabindex="-1"></a><span class="co"># probit data generating process</span></span>
<span id="cb694-13"><a href="endogenous-sample-selection.html#cb694-13" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[, <span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span> </span>
<span id="cb694-14"><a href="endogenous-sample-selection.html#cb694-14" tabindex="-1"></a></span>
<span id="cb694-15"><a href="endogenous-sample-selection.html#cb694-15" tabindex="-1"></a><span class="co"># vectors of explanatory variables for outcome equation</span></span>
<span id="cb694-16"><a href="endogenous-sample-selection.html#cb694-16" tabindex="-1"></a>xo <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) </span>
<span id="cb694-17"><a href="endogenous-sample-selection.html#cb694-17" tabindex="-1"></a>yoX <span class="ot">&lt;-</span> xo <span class="sc">+</span> eps[, <span class="dv">2</span>] <span class="co"># latent outcome</span></span>
<span id="cb694-18"><a href="endogenous-sample-selection.html#cb694-18" tabindex="-1"></a>yo <span class="ot">&lt;-</span> yoX <span class="sc">*</span> (ys <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="co"># observable outcome</span></span>
<span id="cb694-19"><a href="endogenous-sample-selection.html#cb694-19" tabindex="-1"></a><span class="co"># true intercepts = 0 and our true slopes = 1</span></span>
<span id="cb694-20"><a href="endogenous-sample-selection.html#cb694-20" tabindex="-1"></a><span class="co"># xs and xo are independent. </span></span>
<span id="cb694-21"><a href="endogenous-sample-selection.html#cb694-21" tabindex="-1"></a><span class="co"># Hence, exclusion restriction is fulfilled</span></span>
<span id="cb694-22"><a href="endogenous-sample-selection.html#cb694-22" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys <span class="sc">~</span> xs, yo <span class="sc">~</span> xo))</span>
<span id="cb694-23"><a href="endogenous-sample-selection.html#cb694-23" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb694-24"><a href="endogenous-sample-selection.html#cb694-24" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb694-25"><a href="endogenous-sample-selection.html#cb694-25" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb694-26"><a href="endogenous-sample-selection.html#cb694-26" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 5 iterations</span></span>
<span id="cb694-27"><a href="endogenous-sample-selection.html#cb694-27" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb694-28"><a href="endogenous-sample-selection.html#cb694-28" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.3163 </span></span>
<span id="cb694-29"><a href="endogenous-sample-selection.html#cb694-29" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb694-30"><a href="endogenous-sample-selection.html#cb694-30" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb694-31"><a href="endogenous-sample-selection.html#cb694-31" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb694-32"><a href="endogenous-sample-selection.html#cb694-32" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb694-33"><a href="endogenous-sample-selection.html#cb694-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.2228     0.1081  -2.061   0.0399 *  </span></span>
<span id="cb694-34"><a href="endogenous-sample-selection.html#cb694-34" tabindex="-1"></a><span class="co">#&gt; xs            1.3377     0.2014   6.642 8.18e-11 ***</span></span>
<span id="cb694-35"><a href="endogenous-sample-selection.html#cb694-35" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb694-36"><a href="endogenous-sample-selection.html#cb694-36" tabindex="-1"></a><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb694-37"><a href="endogenous-sample-selection.html#cb694-37" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.0002265  0.1294178  -0.002    0.999    </span></span>
<span id="cb694-38"><a href="endogenous-sample-selection.html#cb694-38" tabindex="-1"></a><span class="co">#&gt; xo           0.7299070  0.1635925   4.462 1.01e-05 ***</span></span>
<span id="cb694-39"><a href="endogenous-sample-selection.html#cb694-39" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb694-40"><a href="endogenous-sample-selection.html#cb694-40" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb694-41"><a href="endogenous-sample-selection.html#cb694-41" tabindex="-1"></a><span class="co">#&gt; sigma   0.9190     0.0574  16.009  &lt; 2e-16 ***</span></span>
<span id="cb694-42"><a href="endogenous-sample-selection.html#cb694-42" tabindex="-1"></a><span class="co">#&gt; rho    -0.5392     0.1521  -3.544 0.000431 ***</span></span>
<span id="cb694-43"><a href="endogenous-sample-selection.html#cb694-43" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb694-44"><a href="endogenous-sample-selection.html#cb694-44" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb694-45"><a href="endogenous-sample-selection.html#cb694-45" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>without the exclusion restriction, we generate yo using xs instead of xo.</p>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="endogenous-sample-selection.html#cb695-1" tabindex="-1"></a>yoX <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb695-2"><a href="endogenous-sample-selection.html#cb695-2" tabindex="-1"></a>yo <span class="ot">&lt;-</span> yoX<span class="sc">*</span>(ys <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb695-3"><a href="endogenous-sample-selection.html#cb695-3" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys <span class="sc">~</span> xs, yo <span class="sc">~</span> xs))</span>
<span id="cb695-4"><a href="endogenous-sample-selection.html#cb695-4" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb695-5"><a href="endogenous-sample-selection.html#cb695-5" tabindex="-1"></a><span class="co">#&gt; Tobit 2 model (sample selection model)</span></span>
<span id="cb695-6"><a href="endogenous-sample-selection.html#cb695-6" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb695-7"><a href="endogenous-sample-selection.html#cb695-7" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 14 iterations</span></span>
<span id="cb695-8"><a href="endogenous-sample-selection.html#cb695-8" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb695-9"><a href="endogenous-sample-selection.html#cb695-9" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -712.8298 </span></span>
<span id="cb695-10"><a href="endogenous-sample-selection.html#cb695-10" tabindex="-1"></a><span class="co">#&gt; 500 observations (172 censored and 328 observed)</span></span>
<span id="cb695-11"><a href="endogenous-sample-selection.html#cb695-11" tabindex="-1"></a><span class="co">#&gt; 6 free parameters (df = 494)</span></span>
<span id="cb695-12"><a href="endogenous-sample-selection.html#cb695-12" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb695-13"><a href="endogenous-sample-selection.html#cb695-13" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb695-14"><a href="endogenous-sample-selection.html#cb695-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1984     0.1114  -1.781   0.0756 .  </span></span>
<span id="cb695-15"><a href="endogenous-sample-selection.html#cb695-15" tabindex="-1"></a><span class="co">#&gt; xs            1.2907     0.2085   6.191 1.25e-09 ***</span></span>
<span id="cb695-16"><a href="endogenous-sample-selection.html#cb695-16" tabindex="-1"></a><span class="co">#&gt; Outcome equation:</span></span>
<span id="cb695-17"><a href="endogenous-sample-selection.html#cb695-17" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span id="cb695-18"><a href="endogenous-sample-selection.html#cb695-18" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.5499     0.5644  -0.974  0.33038   </span></span>
<span id="cb695-19"><a href="endogenous-sample-selection.html#cb695-19" tabindex="-1"></a><span class="co">#&gt; xs            1.3987     0.4482   3.120  0.00191 **</span></span>
<span id="cb695-20"><a href="endogenous-sample-selection.html#cb695-20" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb695-21"><a href="endogenous-sample-selection.html#cb695-21" tabindex="-1"></a><span class="co">#&gt;       Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb695-22"><a href="endogenous-sample-selection.html#cb695-22" tabindex="-1"></a><span class="co">#&gt; sigma  0.85091    0.05352  15.899   &lt;2e-16 ***</span></span>
<span id="cb695-23"><a href="endogenous-sample-selection.html#cb695-23" tabindex="-1"></a><span class="co">#&gt; rho   -0.13226    0.72684  -0.182    0.856    </span></span>
<span id="cb695-24"><a href="endogenous-sample-selection.html#cb695-24" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb695-25"><a href="endogenous-sample-selection.html#cb695-25" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb695-26"><a href="endogenous-sample-selection.html#cb695-26" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>We can see that our estimates are still unbiased but standard errors are substantially larger. The exclusion restriction (i.e., independent information about the selection process) has a certain identifying power that we desire. Hence, it’s better to have different set of variable for the selection process from the interested equation. Without the exclusion restriction, we solely rely on the functional form identification.</p>
</div>
</div>
<div id="tobit-5" class="section level3 hasAnchor" number="33.2.2">
<h3><span class="header-section-number">33.2.2</span> Tobit-5<a href="endogenous-sample-selection.html#tobit-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Also known as the switching regression model<br />
Condition: There is at least one variable in X in the selection process not included in the observed process. Used when there are separate models for participants, and non-participants.</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="endogenous-sample-selection.html#cb696-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb696-2"><a href="endogenous-sample-selection.html#cb696-2" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb696-3"><a href="endogenous-sample-selection.html#cb696-3" tabindex="-1"></a>vc[<span class="fu">lower.tri</span>(vc)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>)</span>
<span id="cb696-4"><a href="endogenous-sample-selection.html#cb696-4" tabindex="-1"></a>vc[<span class="fu">upper.tri</span>(vc)] <span class="ot">&lt;-</span> vc[<span class="fu">lower.tri</span>(vc)]</span>
<span id="cb696-5"><a href="endogenous-sample-selection.html#cb696-5" tabindex="-1"></a></span>
<span id="cb696-6"><a href="endogenous-sample-selection.html#cb696-6" tabindex="-1"></a><span class="co"># 3 disturbance vectors by a 3-dimensional normal distribution</span></span>
<span id="cb696-7"><a href="endogenous-sample-selection.html#cb696-7" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">500</span>, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), vc) </span>
<span id="cb696-8"><a href="endogenous-sample-selection.html#cb696-8" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb696-9"><a href="endogenous-sample-selection.html#cb696-9" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb696-10"><a href="endogenous-sample-selection.html#cb696-10" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb696-11"><a href="endogenous-sample-selection.html#cb696-11" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb696-12"><a href="endogenous-sample-selection.html#cb696-12" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">500</span>) <span class="co"># uniformly distributed on [0, 1]</span></span>
<span id="cb696-13"><a href="endogenous-sample-selection.html#cb696-13" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[,<span class="dv">3</span>]</span></code></pre></div>
<p>exclusion restriction is fulfilled when <span class="math inline">\(x\)</span>’s are independent.</p>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="endogenous-sample-selection.html#cb697-1" tabindex="-1"></a><span class="co"># one selection equation and a list of two outcome equations</span></span>
<span id="cb697-2"><a href="endogenous-sample-selection.html#cb697-2" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2))) </span>
<span id="cb697-3"><a href="endogenous-sample-selection.html#cb697-3" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb697-4"><a href="endogenous-sample-selection.html#cb697-4" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb697-5"><a href="endogenous-sample-selection.html#cb697-5" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb697-6"><a href="endogenous-sample-selection.html#cb697-6" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 11 iterations</span></span>
<span id="cb697-7"><a href="endogenous-sample-selection.html#cb697-7" tabindex="-1"></a><span class="co">#&gt; Return code 1: gradient close to zero (gradtol)</span></span>
<span id="cb697-8"><a href="endogenous-sample-selection.html#cb697-8" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -895.8201 </span></span>
<span id="cb697-9"><a href="endogenous-sample-selection.html#cb697-9" tabindex="-1"></a><span class="co">#&gt; 500 observations: 172 selection 1 (FALSE) and 328 selection 2 (TRUE)</span></span>
<span id="cb697-10"><a href="endogenous-sample-selection.html#cb697-10" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 490)</span></span>
<span id="cb697-11"><a href="endogenous-sample-selection.html#cb697-11" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb697-12"><a href="endogenous-sample-selection.html#cb697-12" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb697-13"><a href="endogenous-sample-selection.html#cb697-13" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1550     0.1051  -1.474    0.141    </span></span>
<span id="cb697-14"><a href="endogenous-sample-selection.html#cb697-14" tabindex="-1"></a><span class="co">#&gt; xs            1.1408     0.1785   6.390 3.86e-10 ***</span></span>
<span id="cb697-15"><a href="endogenous-sample-selection.html#cb697-15" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb697-16"><a href="endogenous-sample-selection.html#cb697-16" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb697-17"><a href="endogenous-sample-selection.html#cb697-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.02708    0.16395   0.165    0.869    </span></span>
<span id="cb697-18"><a href="endogenous-sample-selection.html#cb697-18" tabindex="-1"></a><span class="co">#&gt; xo1          0.83959    0.14968   5.609  3.4e-08 ***</span></span>
<span id="cb697-19"><a href="endogenous-sample-selection.html#cb697-19" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb697-20"><a href="endogenous-sample-selection.html#cb697-20" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb697-21"><a href="endogenous-sample-selection.html#cb697-21" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.1583     0.1885   0.840    0.401    </span></span>
<span id="cb697-22"><a href="endogenous-sample-selection.html#cb697-22" tabindex="-1"></a><span class="co">#&gt; xo2           0.8375     0.1707   4.908 1.26e-06 ***</span></span>
<span id="cb697-23"><a href="endogenous-sample-selection.html#cb697-23" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb697-24"><a href="endogenous-sample-selection.html#cb697-24" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb697-25"><a href="endogenous-sample-selection.html#cb697-25" tabindex="-1"></a><span class="co">#&gt; sigma1  0.93191    0.09211  10.118   &lt;2e-16 ***</span></span>
<span id="cb697-26"><a href="endogenous-sample-selection.html#cb697-26" tabindex="-1"></a><span class="co">#&gt; sigma2  0.90697    0.04434  20.455   &lt;2e-16 ***</span></span>
<span id="cb697-27"><a href="endogenous-sample-selection.html#cb697-27" tabindex="-1"></a><span class="co">#&gt; rho1    0.88988    0.05353  16.623   &lt;2e-16 ***</span></span>
<span id="cb697-28"><a href="endogenous-sample-selection.html#cb697-28" tabindex="-1"></a><span class="co">#&gt; rho2    0.17695    0.33139   0.534    0.594    </span></span>
<span id="cb697-29"><a href="endogenous-sample-selection.html#cb697-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb697-30"><a href="endogenous-sample-selection.html#cb697-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb697-31"><a href="endogenous-sample-selection.html#cb697-31" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>All the estimates are close to the true values.</p>
<p>Example of functional form misspecification</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="endogenous-sample-selection.html#cb698-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb698-2"><a href="endogenous-sample-selection.html#cb698-2" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), vc)</span>
<span id="cb698-3"><a href="endogenous-sample-selection.html#cb698-3" tabindex="-1"></a>eps <span class="ot">&lt;-</span> eps<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co"># subtract 1 in order to get the mean zero disturbances</span></span>
<span id="cb698-4"><a href="endogenous-sample-selection.html#cb698-4" tabindex="-1"></a></span>
<span id="cb698-5"><a href="endogenous-sample-selection.html#cb698-5" tabindex="-1"></a><span class="co"># interval [−1, 0] to get an asymmetric distribution over observed choices</span></span>
<span id="cb698-6"><a href="endogenous-sample-selection.html#cb698-6" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>) </span>
<span id="cb698-7"><a href="endogenous-sample-selection.html#cb698-7" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb698-8"><a href="endogenous-sample-selection.html#cb698-8" tabindex="-1"></a>xo1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb698-9"><a href="endogenous-sample-selection.html#cb698-9" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xo1 <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb698-10"><a href="endogenous-sample-selection.html#cb698-10" tabindex="-1"></a>xo2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb698-11"><a href="endogenous-sample-selection.html#cb698-11" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xo2 <span class="sc">+</span> eps[,<span class="dv">3</span>]</span>
<span id="cb698-12"><a href="endogenous-sample-selection.html#cb698-12" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xo1, yo2 <span class="sc">~</span> xo2), <span class="at">iterlim=</span><span class="dv">20</span>))</span>
<span id="cb698-13"><a href="endogenous-sample-selection.html#cb698-13" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb698-14"><a href="endogenous-sample-selection.html#cb698-14" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb698-15"><a href="endogenous-sample-selection.html#cb698-15" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb698-16"><a href="endogenous-sample-selection.html#cb698-16" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 4 iterations</span></span>
<span id="cb698-17"><a href="endogenous-sample-selection.html#cb698-17" tabindex="-1"></a><span class="co">#&gt; Return code 3: Last step could not find a value above the current.</span></span>
<span id="cb698-18"><a href="endogenous-sample-selection.html#cb698-18" tabindex="-1"></a><span class="co">#&gt; Boundary of parameter space?  </span></span>
<span id="cb698-19"><a href="endogenous-sample-selection.html#cb698-19" tabindex="-1"></a><span class="co">#&gt; Consider switching to a more robust optimisation method temporarily.</span></span>
<span id="cb698-20"><a href="endogenous-sample-selection.html#cb698-20" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1665.936 </span></span>
<span id="cb698-21"><a href="endogenous-sample-selection.html#cb698-21" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 760 selection 1 (FALSE) and 240 selection 2 (TRUE)</span></span>
<span id="cb698-22"><a href="endogenous-sample-selection.html#cb698-22" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb698-23"><a href="endogenous-sample-selection.html#cb698-23" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb698-24"><a href="endogenous-sample-selection.html#cb698-24" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb698-25"><a href="endogenous-sample-selection.html#cb698-25" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.53698    0.05808  -9.245  &lt; 2e-16 ***</span></span>
<span id="cb698-26"><a href="endogenous-sample-selection.html#cb698-26" tabindex="-1"></a><span class="co">#&gt; xs           0.31268    0.09395   3.328 0.000906 ***</span></span>
<span id="cb698-27"><a href="endogenous-sample-selection.html#cb698-27" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb698-28"><a href="endogenous-sample-selection.html#cb698-28" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb698-29"><a href="endogenous-sample-selection.html#cb698-29" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.70679    0.03573  -19.78   &lt;2e-16 ***</span></span>
<span id="cb698-30"><a href="endogenous-sample-selection.html#cb698-30" tabindex="-1"></a><span class="co">#&gt; xo1          0.91603    0.05626   16.28   &lt;2e-16 ***</span></span>
<span id="cb698-31"><a href="endogenous-sample-selection.html#cb698-31" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb698-32"><a href="endogenous-sample-selection.html#cb698-32" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb698-33"><a href="endogenous-sample-selection.html#cb698-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.1446        NaN     NaN      NaN  </span></span>
<span id="cb698-34"><a href="endogenous-sample-selection.html#cb698-34" tabindex="-1"></a><span class="co">#&gt; xo2           1.1196     0.5014   2.233   0.0258 *</span></span>
<span id="cb698-35"><a href="endogenous-sample-selection.html#cb698-35" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb698-36"><a href="endogenous-sample-selection.html#cb698-36" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb698-37"><a href="endogenous-sample-selection.html#cb698-37" tabindex="-1"></a><span class="co">#&gt; sigma1  0.67770    0.01760   38.50   &lt;2e-16 ***</span></span>
<span id="cb698-38"><a href="endogenous-sample-selection.html#cb698-38" tabindex="-1"></a><span class="co">#&gt; sigma2  2.31432    0.07615   30.39   &lt;2e-16 ***</span></span>
<span id="cb698-39"><a href="endogenous-sample-selection.html#cb698-39" tabindex="-1"></a><span class="co">#&gt; rho1   -0.97137        NaN     NaN      NaN    </span></span>
<span id="cb698-40"><a href="endogenous-sample-selection.html#cb698-40" tabindex="-1"></a><span class="co">#&gt; rho2    0.17039        NaN     NaN      NaN    </span></span>
<span id="cb698-41"><a href="endogenous-sample-selection.html#cb698-41" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb698-42"><a href="endogenous-sample-selection.html#cb698-42" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb698-43"><a href="endogenous-sample-selection.html#cb698-43" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Although we still have an exclusion restriction (xo1 and xo2 are independent), we now have problems with the intercepts (i.e., they are statistically significantly different from the true values zero), and convergence problems.</p>
<p>If we don’t have the exclusion restriction, we will have a larger variance of xs</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="endogenous-sample-selection.html#cb699-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6</span>)</span>
<span id="cb699-2"><a href="endogenous-sample-selection.html#cb699-2" tabindex="-1"></a>xs <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb699-3"><a href="endogenous-sample-selection.html#cb699-3" tabindex="-1"></a>ys <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb699-4"><a href="endogenous-sample-selection.html#cb699-4" tabindex="-1"></a>yo1 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">2</span>]</span>
<span id="cb699-5"><a href="endogenous-sample-selection.html#cb699-5" tabindex="-1"></a>yo2 <span class="ot">&lt;-</span> xs <span class="sc">+</span> eps[,<span class="dv">3</span>]</span>
<span id="cb699-6"><a href="endogenous-sample-selection.html#cb699-6" tabindex="-1"></a><span class="fu">summary</span>(tmp <span class="ot">&lt;-</span> <span class="fu">selection</span>(ys<span class="sc">~</span>xs, <span class="fu">list</span>(yo1 <span class="sc">~</span> xs, yo2 <span class="sc">~</span> xs), <span class="at">iterlim=</span><span class="dv">20</span>))</span>
<span id="cb699-7"><a href="endogenous-sample-selection.html#cb699-7" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span>
<span id="cb699-8"><a href="endogenous-sample-selection.html#cb699-8" tabindex="-1"></a><span class="co">#&gt; Tobit 5 model (switching regression model)</span></span>
<span id="cb699-9"><a href="endogenous-sample-selection.html#cb699-9" tabindex="-1"></a><span class="co">#&gt; Maximum Likelihood estimation</span></span>
<span id="cb699-10"><a href="endogenous-sample-selection.html#cb699-10" tabindex="-1"></a><span class="co">#&gt; Newton-Raphson maximisation, 16 iterations</span></span>
<span id="cb699-11"><a href="endogenous-sample-selection.html#cb699-11" tabindex="-1"></a><span class="co">#&gt; Return code 8: successive function values within relative tolerance limit (reltol)</span></span>
<span id="cb699-12"><a href="endogenous-sample-selection.html#cb699-12" tabindex="-1"></a><span class="co">#&gt; Log-Likelihood: -1936.431 </span></span>
<span id="cb699-13"><a href="endogenous-sample-selection.html#cb699-13" tabindex="-1"></a><span class="co">#&gt; 1000 observations: 626 selection 1 (FALSE) and 374 selection 2 (TRUE)</span></span>
<span id="cb699-14"><a href="endogenous-sample-selection.html#cb699-14" tabindex="-1"></a><span class="co">#&gt; 10 free parameters (df = 990)</span></span>
<span id="cb699-15"><a href="endogenous-sample-selection.html#cb699-15" tabindex="-1"></a><span class="co">#&gt; Probit selection equation:</span></span>
<span id="cb699-16"><a href="endogenous-sample-selection.html#cb699-16" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb699-17"><a href="endogenous-sample-selection.html#cb699-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.3528     0.0424  -8.321 2.86e-16 ***</span></span>
<span id="cb699-18"><a href="endogenous-sample-selection.html#cb699-18" tabindex="-1"></a><span class="co">#&gt; xs            0.8354     0.0756  11.050  &lt; 2e-16 ***</span></span>
<span id="cb699-19"><a href="endogenous-sample-selection.html#cb699-19" tabindex="-1"></a><span class="co">#&gt; Outcome equation 1:</span></span>
<span id="cb699-20"><a href="endogenous-sample-selection.html#cb699-20" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb699-21"><a href="endogenous-sample-selection.html#cb699-21" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.55448    0.06339  -8.748   &lt;2e-16 ***</span></span>
<span id="cb699-22"><a href="endogenous-sample-selection.html#cb699-22" tabindex="-1"></a><span class="co">#&gt; xs           0.81764    0.06048  13.519   &lt;2e-16 ***</span></span>
<span id="cb699-23"><a href="endogenous-sample-selection.html#cb699-23" tabindex="-1"></a><span class="co">#&gt; Outcome equation 2:</span></span>
<span id="cb699-24"><a href="endogenous-sample-selection.html#cb699-24" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb699-25"><a href="endogenous-sample-selection.html#cb699-25" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.6457     0.4994   1.293    0.196</span></span>
<span id="cb699-26"><a href="endogenous-sample-selection.html#cb699-26" tabindex="-1"></a><span class="co">#&gt; xs            0.3520     0.3197   1.101    0.271</span></span>
<span id="cb699-27"><a href="endogenous-sample-selection.html#cb699-27" tabindex="-1"></a><span class="co">#&gt;    Error terms:</span></span>
<span id="cb699-28"><a href="endogenous-sample-selection.html#cb699-28" tabindex="-1"></a><span class="co">#&gt;        Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb699-29"><a href="endogenous-sample-selection.html#cb699-29" tabindex="-1"></a><span class="co">#&gt; sigma1  0.59187    0.01853  31.935   &lt;2e-16 ***</span></span>
<span id="cb699-30"><a href="endogenous-sample-selection.html#cb699-30" tabindex="-1"></a><span class="co">#&gt; sigma2  1.97257    0.07228  27.289   &lt;2e-16 ***</span></span>
<span id="cb699-31"><a href="endogenous-sample-selection.html#cb699-31" tabindex="-1"></a><span class="co">#&gt; rho1    0.15568    0.15914   0.978    0.328    </span></span>
<span id="cb699-32"><a href="endogenous-sample-selection.html#cb699-32" tabindex="-1"></a><span class="co">#&gt; rho2   -0.01541    0.23370  -0.066    0.947    </span></span>
<span id="cb699-33"><a href="endogenous-sample-selection.html#cb699-33" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb699-34"><a href="endogenous-sample-selection.html#cb699-34" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb699-35"><a href="endogenous-sample-selection.html#cb699-35" tabindex="-1"></a><span class="co">#&gt; --------------------------------------------</span></span></code></pre></div>
<p>Usually it will not converge. Even if it does, the results may be seriously biased.</p>
<p><strong>Note</strong></p>
<p>The log-likelihood function of the models might not be globally concave. Hence, it might not converge, or converge to a local maximum. To combat this, we can use</p>
<ul>
<li>Different starting value</li>
<li>Different maximization methods.</li>
<li>refer to <a href="non-linear-least-squares.html#non-linear-least-squares">Non-linear Least Squares</a> for suggestions.</li>
</ul>
<div id="pattern-mixture-models" class="section level5 hasAnchor" number="33.2.2.0.1">
<h5><span class="header-section-number">33.2.2.0.1</span> Pattern-Mixture Models<a href="endogenous-sample-selection.html#pattern-mixture-models" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>compared to the Heckman’s model where it assumes the value of the missing data is predetermined, pattern-mixture models assume missingness affect the distribution of variable of interest (e.g., Y)</li>
<li>To read more, you can check <a href="https://www4.stat.ncsu.edu/~davidian/st790/notes/chap6.pdf">NCSU</a>, <a href="https://stefvanbuuren.name/fimd/sec-nonignorable.html">stefvanbuuren</a>.</li>
</ul>

</div>
</div>
</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-amemiya1984tobit" class="csl-entry">
———. 1984. <span>“Tobit Models: A Survey.”</span> <em>Journal of Econometrics</em> 24 (1-2): 3–61.
</div>
<div id="ref-bareinboim2014transportability" class="csl-entry">
Bareinboim, Elias, and Judea Pearl. 2014. <span>“Transportability from Multiple Environments with Limited Experiments: Completeness Results.”</span> <em>Advances in Neural Information Processing Systems</em> 27.
</div>
<div id="ref-Heckman_1976" class="csl-entry">
Heckman, James J. 1976. <span>“The Common Structure of Statistical Models of Truncation, Sample Selection and Limited Dependent Variables and a Simple Estimator for Such Models.”</span> In <em>Annals of Economic and Social Measurement, Volume 5, Number 4</em>, 475–92. NBER.
</div>
<div id="ref-heckman2004using" class="csl-entry">
Heckman, James, and Salvador Navarro-Lozano. 2004. <span>“Using Matching, Instrumental Variables, and Control Functions to Estimate Economic Choice Models.”</span> <em>Review of Economics and Statistics</em> 86 (1): 30–57.
</div>
<div id="ref-mroz1984sensitivity" class="csl-entry">
Mroz, Thomas Alvin. 1984. <em>The Sensitivity of an Empirical Model of Married Women’s Hours of Work to Economic and Statistical Assumptions</em>. Stanford University.
</div>
<div id="ref-wolfolds2019misaccounting" class="csl-entry">
Wolfolds, Sarah E, and Jordan Siegel. 2019. <span>“Misaccounting for Endogeneity: The Peril of Relying on the Heckman Two-Step Method Without a Valid Instrument.”</span> <em>Strategic Management Journal</em> 40 (3): 432–62.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="endogenous-treatment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-biases.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mikenguyen13/data_analysis/edit/main/33-endogeneity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mikenguyen13/data_analysis/blob/main/33-endogeneity.Rmd",
"text": null
},
"download": ["data_analysis.pdf", "data_analysis.epub", "data_analysis.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true,
"sharing": {
"facebook": true,
"github": true,
"twitter": true,
"linkedin": true
},
"info": true,
"edit": "https://github.com/mikenguyen13/data_analysis/edit/main/%s"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
